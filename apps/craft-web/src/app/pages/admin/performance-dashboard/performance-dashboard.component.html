<div class="performance-dashboard">
  <header class="section-header">
    <div>
      <p class="eyebrow">Live telemetry</p>
      <h3>Performance pulse</h3>
      <p class="subtitle">Realtime latency, throughput, and headroom across services.</p>
    </div>
    <span class="pill live">Streaming</span>
  </header>

  <div class="metric-grid">
    <article class="metric-card memory">
      <div class="metric-top">
        <p class="eyebrow">Memory</p>
        <mat-icon>memory</mat-icon>
      </div>
      <div class="metric-value">{{ performanceMetrics.memoryUsage }}</div>
      <p class="metric-sub">In use across services</p>
    </article>

    <article class="metric-card cpu">
      <div class="metric-top">
        <p class="eyebrow">CPU</p>
        <mat-icon>speed</mat-icon>
      </div>
      <div class="metric-value">{{ performanceMetrics.cpuLoad }}</div>
      <p class="metric-sub">Weighted by load average</p>
    </article>

    <article class="metric-card uptime">
      <div class="metric-top">
        <p class="eyebrow">Uptime</p>
        <mat-icon>schedule</mat-icon>
      </div>
      <div class="metric-value">{{ performanceMetrics.appUptime }}</div>
      <p class="metric-sub">Process lifetime</p>
    </article>

    <article class="metric-card network">
      <div class="metric-top">
        <p class="eyebrow">Network</p>
        <mat-icon>network_check</mat-icon>
      </div>
      <div class="metric-value">{{ performanceMetrics.networkLatency }}</div>
      <p class="metric-sub">Average response latency</p>
    </article>
  </div>

  <div class="chart-panel">
    <div class="panel-head">
      <div>
        <p class="eyebrow">Latency distribution</p>
        <h4>Service response times</h4>
      </div>
      <div class="legend">
        <span class="chip good">Stable</span>
        <span class="chip watch">Watch</span>
      </div>
    </div>
    <div class="chart-shell">
      <canvas #systemCanvas></canvas>
    </div>
  </div>

  <div class="services-panel">
    <div class="panel-head">
      <div>
        <p class="eyebrow">Service health</p>
        <h4>Individual service monitoring</h4>
      </div>
      <span class="pill services-active">{{ activeServicesCount }}/{{ totalServicesCount }} Active</span>
    </div>
    
    <div class="services-grid">
      <article 
        *ngFor="let service of servicesData; trackBy: trackByServiceName" 
        class="service-card" 
        [ngClass]="{
          'active': service.active,
          'inactive': !service.active,
          'warning': service.avgResponseTime > 500,
          'updating': service.updating
        }">
        <div class="service-header">
          <div class="service-icon-wrapper">
            <mat-icon class="service-icon">{{ service.icon }}</mat-icon>
          </div>
          <div class="service-status">
            <span class="status-dot" [ngClass]="service.active ? 'active' : 'inactive'"></span>
            <span class="status-text">{{ service.active ? 'Active' : 'Idle' }}</span>
          </div>
        </div>
        <div class="service-body">
          <h5 class="service-name">{{ service.name }}</h5>
          <p class="service-description">{{ service.description }}</p>
        </div>
        <div class="service-metrics">
          <div class="metric-item">
            <span class="metric-label">Latency</span>
            <span class="metric-value" [ngClass]="{
              'good': service.avgResponseTime < 200,
              'warning': service.avgResponseTime >= 200 && service.avgResponseTime < 500,
              'critical': service.avgResponseTime >= 500
            }">{{ service.avgResponseTime }}ms</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">Calls</span>
            <span class="metric-value">{{ service.callCount }}</span>
          </div>
          <div class="metric-item">
            <span class="metric-label">Success</span>
            <span class="metric-value" [ngClass]="{
              'good': service.successRate >= 95,
              'warning': service.successRate >= 80 && service.successRate < 95,
              'critical': service.successRate < 80
            }">{{ service.successRate }}%</span>
          </div>
        </div>
      </article>
    </div>
  </div>
</div>
