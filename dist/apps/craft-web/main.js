(self.webpackChunkcraft_web=self.webpackChunkcraft_web||[]).push([[792],{340:(lw,Wm,op)=>{"use strict";function Zm(e,n,t,i,r,a,h){try{var v=e[a](h),C=v.value}catch(P){return void t(P)}v.done?n(C):Promise.resolve(C).then(i,r)}function Ph(e){return function(){var n=this,t=arguments;return new Promise(function(i,r){var a=e.apply(n,t);function h(C){Zm(a,i,r,h,v,"next",C)}function v(C){Zm(a,i,r,h,v,"throw",C)}h(void 0)})}}function kT(e,n){return Object.is(e,n)}let f=null,To=!1,Gs=1;const xi=Symbol("SIGNAL");function Xn(e){const n=f;return f=e,n}const Oi={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function ss(e){if(To)throw new Error("");if(null===f)return;f.consumerOnSignalRead(e);const n=f.nextProducerIndex++;vu(f),n<f.producerNode.length&&f.producerNode[n]!==e&&nl(f)&&ac(f.producerNode[n],f.producerIndexOfThis[n]),f.producerNode[n]!==e&&(f.producerNode[n]=e,f.producerIndexOfThis[n]=nl(f)?Sn(e,f,n):0),f.producerLastReadVersion[n]=e.version}function wd(e){if((!nl(e)||e.dirty)&&(e.dirty||e.lastCleanEpoch!==Gs)){if(!e.producerMustRecompute(e)&&!tl(e))return void sc(e);e.producerRecomputeValue(e),sc(e)}}function Oh(e){if(void 0===e.liveConsumerNode)return;const n=To;To=!0;try{for(const t of e.liveConsumerNode)t.dirty||Fh(t)}finally{To=n}}function $i(){return!1!==f?.consumerAllowSignalWrites}function Fh(e){e.dirty=!0,Oh(e),e.consumerMarkedDirty?.(e)}function sc(e){e.dirty=!1,e.lastCleanEpoch=Gs}function bn(e){return e&&(e.nextProducerIndex=0),Xn(e)}function el(e,n){if(Xn(n),e&&void 0!==e.producerNode&&void 0!==e.producerIndexOfThis&&void 0!==e.producerLastReadVersion){if(nl(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)ac(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function tl(e){vu(e);for(let n=0;n<e.producerNode.length;n++){const t=e.producerNode[n],i=e.producerLastReadVersion[n];if(i!==t.version||(wd(t),i!==t.version))return!0}return!1}function xn(e){if(vu(e),nl(e))for(let n=0;n<e.producerNode.length;n++)ac(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function Sn(e,n,t){if(ei(e),0===e.liveConsumerNode.length&&bs(e))for(let i=0;i<e.producerNode.length;i++)e.producerIndexOfThis[i]=Sn(e.producerNode[i],e,i);return e.liveConsumerIndexOfThis.push(t),e.liveConsumerNode.push(n)-1}function ac(e,n){if(ei(e),1===e.liveConsumerNode.length&&bs(e))for(let i=0;i<e.producerNode.length;i++)ac(e.producerNode[i],e.producerIndexOfThis[i]);const t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){const i=e.liveConsumerIndexOfThis[n],r=e.liveConsumerNode[n];vu(r),r.producerIndexOfThis[i]=n}}function nl(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function vu(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}function ei(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}function bs(e){return void 0!==e.producerNode}function El(e){const n=Object.create(sp);n.computation=e;const t=()=>{if(wd(n),ss(n),n.value===lc)throw n.error;return n.value};return t[xi]=n,t}const Cd=Symbol("UNSET"),Un=Symbol("COMPUTING"),lc=Symbol("ERRORED"),sp={...Oi,value:Cd,dirty:!0,error:null,equal:kT,producerMustRecompute:e=>e.value===Cd||e.value===Un,producerRecomputeValue(e){if(e.value===Un)throw new Error("Detected cycle in computations.");const n=e.value;e.value=Un;const t=bn(e);let i;try{i=e.computation()}catch(r){i=lc,e.error=r}finally{el(e,t)}n!==Cd&&n!==lc&&i!==lc&&e.equal(n,i)?e.value=n:(e.value=i,e.version++)}};let Fn=function Lh(){throw new Error};function Nh(){Fn()}function Oe(e,n){$i()||Nh(),e.equal(e.value,n)||(e.value=n,function Ft(e){e.version++,function Ji(){Gs++}(),Oh(e)}(e))}const xu={...Oi,equal:kT,value:void 0};const Ho=()=>{};function pi(e){return"function"==typeof e}function Fa(e){const t=e(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Vc=Fa(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Il(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class Ni{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const a of t)a.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(pi(i))try{i()}catch(a){n=a instanceof Vc?a.errors:[a]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const a of r)try{cc(a)}catch(h){n=n??[],h instanceof Vc?n=[...n,...h.errors]:n.push(h)}}if(n)throw new Vc(n)}}add(n){var t;if(n&&n!==this)if(this.closed)cc(n);else{if(n instanceof Ni){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&Il(t,n)}remove(n){const{_finalizers:t}=this;t&&Il(t,n),n instanceof Ni&&n._removeParent(this)}}Ni.EMPTY=(()=>{const e=new Ni;return e.closed=!0,e})();const En=Ni.EMPTY;function wu(e){return e instanceof Ni||e&&"closed"in e&&pi(e.remove)&&pi(e.add)&&pi(e.unsubscribe)}function cc(e){pi(e)?e():e.unsubscribe()}const La={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},$o={setTimeout(e,n,...t){const{delegate:i}=$o;return i?.setTimeout?i.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=$o;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function ga(e){$o.setTimeout(()=>{const{onUnhandledError:n}=La;if(!n)throw e;n(e)})}function Cu(){}const ap=jc("C",void 0,void 0);function jc(e,n,t){return{kind:e,value:n,error:t}}let il=null;function Ws(e){if(La.useDeprecatedSynchronousErrorHandling){const n=!il;if(n&&(il={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:i}=il;if(il=null,t)throw i}}else e()}class Yn extends Ni{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,wu(n)&&n.add(this)):this.destination=dp}static create(n,t,i){return new kl(n,t,i)}next(n){this.isStopped?Md(function Uc(e){return jc("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?Md(function Vh(e){return jc("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?Md(ap,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const dc=Function.prototype.bind;function Uh(e,n){return dc.call(e,n)}class Zs{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(i){Td(i)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(i){Td(i)}else Td(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){Td(t)}}}class kl extends Yn{constructor(n,t,i){let r;if(super(),pi(n)||!n)r={next:n??void 0,error:t??void 0,complete:i??void 0};else{let a;this&&La.useDeprecatedNextContext?(a=Object.create(n),a.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&Uh(n.next,a),error:n.error&&Uh(n.error,a),complete:n.complete&&Uh(n.complete,a)}):r=n}this.destination=new Zs(r)}}function Td(e){La.useDeprecatedSynchronousErrorHandling?function lp(e){La.useDeprecatedSynchronousErrorHandling&&il&&(il.errorThrown=!0,il.error=e)}(e):ga(e)}function Md(e,n){const{onStoppedNotification:t}=La;t&&$o.setTimeout(()=>t(e,n))}const dp={closed:!0,next:Cu,error:function cp(e){throw e},complete:Cu},tt="function"==typeof Symbol&&Symbol.observable||"@@observable";function ie(e){return e}function ge(e){return 0===e.length?ie:1===e.length?e[0]:function(t){return e.reduce((i,r)=>r(i),t)}}let Ce=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new e;return i.source=this,i.operator=t,i}subscribe(t,i,r){const a=function We(e){return e&&e instanceof Yn||function ze(e){return e&&pi(e.next)&&pi(e.error)&&pi(e.complete)}(e)&&wu(e)}(t)?t:new kl(t,i,r);return Ws(()=>{const{operator:h,source:v}=this;a.add(h?h.call(a,v):v?this._subscribe(a):this._trySubscribe(a))}),a}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=Me(i))((r,a)=>{const h=new kl({next:v=>{try{t(v)}catch(C){a(C),h.unsubscribe()}},error:a,complete:r});this.subscribe(h)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[tt](){return this}pipe(...t){return ge(t)(this)}toPromise(t){return new(t=Me(t))((i,r)=>{let a;this.subscribe(h=>a=h,h=>r(h),()=>i(a))})}}return e.create=n=>new e(n),e})();function Me(e){var n;return null!==(n=e??La.Promise)&&void 0!==n?n:Promise}const Ve=Fa(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ie=(()=>{class e extends Ce{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new nt(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Ve}next(t){Ws(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){Ws(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){Ws(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:a}=this;return i||r?En:(this.currentObservers=null,a.push(t),new Ni(()=>{this.currentObservers=null,Il(a,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:a}=this;i?t.error(r):a&&t.complete()}asObservable(){const t=new Ce;return t.source=this,t}}return e.create=(n,t)=>new nt(n,t),e})();class nt extends Ie{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,n)}error(n){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==i?i:En}}class Je extends Ie{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:i}=this;if(n)throw t;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function xt(e){return pi(e?.lift)}function Tt(e){return n=>{if(xt(n))return n.lift(function(t){try{return e(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Mt(e,n,t,i,r){return new yn(e,n,t,i,r)}class yn extends Yn{constructor(n,t,i,r,a,h){super(n),this.onFinalize=a,this.shouldUnsubscribe=h,this._next=t?function(v){try{t(v)}catch(C){n.error(C)}}:super._next,this._error=r?function(v){try{r(v)}catch(C){n.error(C)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(v){n.error(v)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function $t(e,n){return Tt((t,i)=>{let r=0;t.subscribe(Mt(i,a=>{i.next(e.call(n,a,r++))}))})}const wn="https://g.co/ng/security#xss";class ot extends Error{code;constructor(n,t){super(function mi(e,n){return`NG0${Math.abs(e)}${n?": "+n:""}`}(n,t)),this.code=n}}const Kn=Symbol("InputSignalNode#UNSET"),Gi={...xu,transformFn:void 0,applyValueToInputSignal(e,n){Oe(e,n)}};function xs(e,n){const t=Object.create(Gi);function i(){if(ss(t),t.value===Kn)throw new ot(-950,!1);return t.value}return t.value=e,t.transformFn=n?.transform,i[xi]=t,i}function Br(e){return{toString:e}.toString()}const rl="__parameters__";function ol(e,n,t){return Br(()=>{const i=function jh(e){return function(...t){if(e){const i=e(...t);for(const r in i)this[r]=i[r]}}}(n);function r(...a){if(this instanceof r)return i.apply(this,a),this;const h=new r(...a);return v.annotation=h,v;function v(C,P,L){const V=C.hasOwnProperty(rl)?C[rl]:Object.defineProperty(C,rl,{value:[]})[rl];for(;V.length<=L;)V.push(null);return(V[L]=V[L]||[]).push(h),C}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}const Rr=globalThis;function xr(e){for(let n in e)if(e[n]===xr)return n;throw Error("Could not find renamed property on target object.")}function hb(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function So(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(So).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function Tu(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const U_=xr({__forward_ref__:xr});function zi(e){return e.__forward_ref__=zi,e.toString=function(){return So(this())},e}function qn(e){return Xs(e)?e():e}function Xs(e){return"function"==typeof e&&e.hasOwnProperty(U_)&&e.__forward_ref__===zi}function Nt(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Qt(e){return{providers:e.providers||[],imports:e.imports||[]}}function gi(e){return Dd(e,al)||Dd(e,as)}function Dd(e,n){return e.hasOwnProperty(n)?e[n]:null}function Su(e){return e&&(e.hasOwnProperty(Hc)||e.hasOwnProperty(ur))?e[Hc]:null}const al=xr({\u0275prov:xr}),Hc=xr({\u0275inj:xr}),as=xr({ngInjectableDef:xr}),ur=xr({ngInjectorDef:xr});class ct{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(n,t){this._desc=n,this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Nt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function gr(e){return e&&!!e.\u0275providers}const Qs=xr({\u0275cmp:xr}),va=xr({\u0275dir:xr}),Xr=xr({\u0275pipe:xr}),Zh=xr({\u0275mod:xr}),Go=xr({\u0275fac:xr}),Na=xr({__NG_ELEMENT_ID__:xr}),Iu=xr({__NG_ENV_ID__:xr});function hi(e){return"string"==typeof e?e:null==e?"":String(e)}function Yh(e,n){throw new ot(-201,!1)}var Xi=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(Xi||{});let ku;function _b(){return ku}function ba(e){const n=ku;return ku=e,n}function Xh(e,n,t){const i=gi(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Xi.Optional?null:void 0!==n?n:void Yh()}const Js={},ig="__NG_DI_FLAG__",Au="ngTempTokenPath",dw=/\n/gm,yb="__source";let Ru;function An(e){const n=Ru;return Ru=e,n}function on(e,n=Xi.Default){if(void 0===Ru)throw new ot(-203,!1);return null===Ru?Xh(e,void 0,n):Ru.get(e,n&Xi.Optional?null:void 0,n)}function un(e,n=Xi.Default){return(_b()||on)(qn(e),n)}function re(e,n=Xi.Default){return un(e,ll(n))}function ll(e){return typeof e>"u"||"number"==typeof e?e:(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function mn(e){const n=[];for(let t=0;t<e.length;t++){const i=qn(e[t]);if(Array.isArray(i)){if(0===i.length)throw new ot(900,!1);let r,a=Xi.Default;for(let h=0;h<i.length;h++){const v=i[h],C=rg(v);"number"==typeof C?-1===C?r=v.token:a|=C:r=v}n.push(un(r,a))}else n.push(un(i))}return n}function Pu(e,n){return e[ig]=n,e.prototype[ig]=n,e}function rg(e){return e[ig]}const Kr=Pu(ol("Optional"),8),hc=Pu(ol("SkipSelf"),4);function fc(e,n){return e.hasOwnProperty(Go)?e[Go]:null}function Ou(e,n){e.forEach(t=>Array.isArray(t)?Ou(t,n):n(t))}function pp(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function cl(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function Ba(e,n,t){let i=Lu(e,n);return i>=0?e[1|i]=t:(i=~i,function Fu(e,n,t,i){let r=e.length;if(r==n)e.push(t,i);else if(1===r)e.push(i,e[0]),e[0]=t;else{for(r--,e.push(e[r-1],e[r]);r>n;)e[r]=e[r-2],r--;e[n]=t,e[n+1]=i}}(e,i,n,t)),i}function gp(e,n){const t=Lu(e,n);if(t>=0)return e[1|t]}function Lu(e,n){return function G_(e,n,t){let i=0,r=e.length>>t;for(;r!==i;){const a=i+(r-i>>1),h=e[a<<t];if(n===h)return a<<t;h>n?r=a:i=a+1}return~(r<<t)}(e,n,1)}const ls={},vr=[],dl=new ct(""),og=new ct("",-1),sg=new ct("");class ef{get(n,t=Js){if(t===Js){const i=new Error(`NullInjectorError: No provider for ${So(n)}!`);throw i.name="NullInjectorError",i}return t}}function Qr(e,n){const t=e[Zh]||null;if(!t&&!0===n)throw new Error(`Type ${So(e)} does not have '\u0275mod' property.`);return t}function Ai(e){return e[Qs]||null}function qo(e){return e[va]||null}function Qo(e){return e[Xr]||null}function Va(e){return{\u0275providers:e}}function kd(...e){return{\u0275providers:tf(0,e),\u0275fromNgModule:!0}}function tf(e,...n){const t=[],i=new Set;let r;const a=h=>{t.push(h)};return Ou(n,h=>{const v=h;mc(v,a,[],i)&&(r||=[],r.push(v))}),void 0!==r&&ag(r,a),t}function ag(e,n){for(let t=0;t<e.length;t++){const{ngModule:i,providers:r}=e[t];Wc(r,a=>{n(a,i)})}}function mc(e,n,t,i){if(!(e=qn(e)))return!1;let r=null,a=Su(e);const h=!a&&Ai(e);if(a||h){if(h&&!h.standalone)return!1;r=e}else{const C=e.ngModule;if(a=Su(C),!a)return!1;r=C}const v=i.has(r);if(h){if(v)return!1;if(i.add(r),h.dependencies){const C="function"==typeof h.dependencies?h.dependencies():h.dependencies;for(const P of C)mc(P,n,t,i)}}else{if(!a)return!1;{if(null!=a.imports&&!v){let P;i.add(r);try{Ou(a.imports,L=>{mc(L,n,t,i)&&(P||=[],P.push(L))})}finally{}void 0!==P&&ag(P,n)}if(!v){const P=fc(r)||(()=>new r);n({provide:r,useFactory:P,deps:vr},r),n({provide:sg,useValue:r,multi:!0},r),n({provide:dl,useValue:()=>un(r),multi:!0},r)}const C=a.providers;if(null!=C&&!v){const P=e;Wc(C,L=>{n(L,P)})}}}return r!==e&&void 0!==e.providers}function Wc(e,n){for(let t of e)gr(t)&&(t=t.\u0275providers),Array.isArray(t)?Wc(t,n):n(t)}const Nu=xr({provide:String,useValue:xr});function Pl(e){return null!==e&&"object"==typeof e&&Nu in e}function Zc(e){return"function"==typeof e}const li=new ct(""),Rd={},vb={};let lg;function rf(){return void 0===lg&&(lg=new ef),lg}class Eo{}class tr extends Eo{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(n,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,Y_(n,h=>this.processProvider(h)),this.records.set(og,Pd(void 0,this)),r.has("environment")&&this.records.set(Eo,Pd(void 0,this));const a=this.records.get(li);null!=a&&"string"==typeof a.value&&this.scopes.add(a.value),this.injectorDefTypes=new Set(this.get(sg,vr,Xi.Self))}destroy(){zu(this),this._destroyed=!0;const n=Xn(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const t=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of t)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Xn(n)}}onDestroy(n){return zu(this),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){zu(this);const t=An(this),i=ba(void 0);try{return n()}finally{An(t),ba(i)}}get(n,t=Js,i=Xi.Default){if(zu(this),n.hasOwnProperty(Iu))return n[Iu](this);i=ll(i);const a=An(this),h=ba(void 0);try{if(!(i&Xi.SkipSelf)){let C=this.records.get(n);if(void 0===C){const P=function xb(e){return"function"==typeof e||"object"==typeof e&&e instanceof ct}(n)&&gi(n);C=P&&this.injectableDefInScope(P)?Pd(W_(n),Rd):null,this.records.set(n,C)}if(null!=C)return this.hydrate(n,C)}return(i&Xi.Self?rf():this.parent).get(n,t=i&Xi.Optional&&t===Js?null:t)}catch(v){if("NullInjectorError"===v.name){if((v[Au]=v[Au]||[]).unshift(So(n)),a)throw v;return function Qh(e,n,t,i){const r=e[Au];throw n[yb]&&r.unshift(n[yb]),e.message=function Jh(e,n,t,i=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let r=So(n);if(Array.isArray(n))r=n.map(So).join(" -> ");else if("object"==typeof n){let a=[];for(let h in n)if(n.hasOwnProperty(h)){let v=n[h];a.push(h+":"+("string"==typeof v?JSON.stringify(v):So(v)))}r=`{${a.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${e.replace(dw,"\n  ")}`}("\n"+e.message,r,t,i),e.ngTokenPath=r,e[Au]=null,e}(v,n,"R3InjectorError",this.source)}throw v}finally{ba(h),An(a)}}resolveInjectorInitializers(){const n=Xn(null),t=An(this),i=ba(void 0);try{const a=this.get(dl,vr,Xi.Self);for(const h of a)h()}finally{An(t),ba(i),Xn(n)}}toString(){const n=[],t=this.records;for(const i of t.keys())n.push(So(i));return`R3Injector[${n.join(", ")}]`}processProvider(n){let t=Zc(n=qn(n))?n:qn(n&&n.provide);const i=function pw(e){return Pl(e)?Pd(void 0,e.useValue):Pd(cg(e),Rd)}(n);if(!Zc(n)&&!0===n.multi){let r=this.records.get(t);r||(r=Pd(void 0,Rd,!0),r.factory=()=>mn(r.multi),this.records.set(t,r)),t=n,r.multi.push(n)}this.records.set(t,i)}hydrate(n,t){const i=Xn(null);try{return t.value===Rd&&(t.value=vb,t.value=t.factory()),"object"==typeof t.value&&t.value&&function bb(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{Xn(i)}}injectableDefInScope(n){if(!n.providedIn)return!1;const t=qn(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){const t=this._onDestroyHooks.indexOf(n);-1!==t&&this._onDestroyHooks.splice(t,1)}}function W_(e){const n=gi(e),t=null!==n?n.factory:fc(e);if(null!==t)return t;if(e instanceof ct)throw new ot(204,!1);if(e instanceof Function)return function fw(e){if(e.length>0)throw new ot(204,!1);const t=function _i(e){return e&&(e[al]||e[as])||null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new ot(204,!1)}function cg(e,n,t){let i;if(Zc(e)){const r=qn(e);return fc(r)||W_(r)}if(Pl(e))i=()=>qn(e.useValue);else if(function yp(e){return!(!e||!e.useFactory)}(e))i=()=>e.useFactory(...mn(e.deps||[]));else if(function nf(e){return!(!e||!e.useExisting)}(e))i=()=>un(qn(e.useExisting));else{const r=qn(e&&(e.useClass||e.provide));if(!function Z_(e){return!!e.deps}(e))return fc(r)||W_(r);i=()=>new r(...mn(e.deps))}return i}function zu(e){if(e.destroyed)throw new ot(205,!1)}function Pd(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function Y_(e,n){for(const t of e)Array.isArray(t)?Y_(t,n):t&&gr(t)?Y_(t.\u0275providers,n):n(t)}function As(e,n){e instanceof tr&&zu(e);const i=An(e),r=ba(void 0);try{return n()}finally{An(i),ba(r)}}function sf(){return void 0!==_b()||null!=function Kh(){return Ru}()}function Bu(e){if(!sf())throw new ot(-203,!1)}var Kc=function(e){return e[e.None=0]="None",e[e.HasTransplantedViews=2]="HasTransplantedViews",e}(Kc||{});function go(e){return Array.isArray(e)&&"object"==typeof e[1]}function Io(e){return Array.isArray(e)&&!0===e[1]}function df(e){return!!(4&e.flags)}function Ll(e){return e.componentOffset>-1}function xp(e){return!(1&~e.flags)}function Nl(e){return!!e.template}function zl(e){return!!(512&e[2])}class ay{previousValue;currentValue;firstChange;constructor(n,t,i){this.previousValue=n,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function ly(e,n,t,i){null!==n?n.applyValueToInputSignal(n,i):e[t]=i}const sr=(()=>{const e=()=>_r;return e.ngInherit=!0,e})();function _r(e){return e.type.prototype.ngOnChanges&&(e.setInput=hf),Tp}function Tp(){const e=cy(this),n=e?.current;if(n){const t=e.previous;if(t===ls)e.previous=n;else for(let i in n)t[i]=n[i];e.current=null,this.ngOnChanges(n)}}function hf(e,n,t,i,r){const a=this.declaredInputs[i],h=cy(e)||function Eb(e,n){return e[Nd]=n}(e,{previous:ls,current:null}),v=h.current||(h.current={}),C=h.previous,P=C[a];v[a]=new ay(P&&P.currentValue,t,C===ls),ly(e,n,r,t)}const Nd="__ngSimpleChanges__";function cy(e){return e[Nd]||null}function Ki(e){for(;Array.isArray(e);)e=e[0];return e}function Ge(e,n){return Ki(n[e])}function Ps(e,n){return Ki(n[e.index])}function zd(e,n){return e.data[n]}function Bd(e,n){return e[n]}function Ta(e,n){const t=n[e];return go(t)?t:t[0]}function Vd(e){return!(128&~e[2])}function ws(e,n){return null==n?null:e[n]}function gg(e){e[17]=0}function Hu(e){1024&e[2]||(e[2]|=1024,Vd(e)&&na(e))}function Mp(e){return!!(9216&e[2]||e[24]?.dirty)}function _g(e){e[10].changeDetectionScheduler?.notify(9),64&e[2]&&(e[2]|=1024),Mp(e)&&na(e)}function na(e){e[10].changeDetectionScheduler?.notify(0);let n=vc(e);for(;null!==n&&!(8192&n[2])&&(n[2]|=8192,Vd(n));)n=vc(n)}function Ud(e,n){if(!(256&~e[2]))throw new ot(911,!1);null===e[21]&&(e[21]=[]),e[21].push(n)}function vc(e){const n=e[3];return Io(n)?n[3]:n}const wi={lFrame:_f(null),bindingsEnabled:!0,skipHydrationRootTNode:null};let Gu=!1;function qu(){return wi.bindingsEnabled}function fl(){return null!==wi.skipHydrationRootTNode}function yt(){return wi.lFrame.lView}function fi(){return wi.lFrame.tView}function Di(e){return wi.lFrame.contextLView=e,e[8]}function Ii(e){return wi.lFrame.contextLView=null,e}function Bi(){let e=td();for(;null!==e&&64===e.type;)e=e.parent;return e}function td(){return wi.lFrame.currentTNode}function ia(e,n){const t=wi.lFrame;t.currentTNode=e,t.isParent=n}function Ep(){return wi.lFrame.isParent}function Dp(){wi.lFrame.isParent=!1}function nd(){return Gu}function pf(e){const n=Gu;return Gu=e,n}function Ts(){const e=wi.lFrame;let n=e.bindingRootIndex;return-1===n&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}function ra(){return wi.lFrame.bindingIndex++}function Vl(e){const n=wi.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function vg(e,n){const t=wi.lFrame;t.bindingIndex=t.bindingRootIndex=e,bg(n)}function bg(e){wi.lFrame.currentDirectiveIndex=e}function xg(e){const n=wi.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}function wg(){return wi.lFrame.currentQueryIndex}function kp(e){wi.lFrame.currentQueryIndex=e}function Ib(e){const n=e[1];return 2===n.type?n.declTNode:1===n.type?e[5]:null}function gf(e,n,t){if(t&Xi.SkipSelf){let r=n,a=e;for(;!(r=r.parent,null!==r||t&Xi.Host||(r=Ib(a),null===r||(a=a[14],10&r.type))););if(null===r)return!1;n=r,e=a}const i=wi.lFrame=oa();return i.currentTNode=n,i.lView=e,!0}function Zu(e){const n=oa(),t=e[1];wi.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function oa(){const e=wi.lFrame,n=null===e?null:e.child;return null===n?_f(e):n}function _f(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function my(){const e=wi.lFrame;return wi.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const gy=my;function Cg(){const e=my();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function ts(){return wi.lFrame.selectedIndex}function Yu(e){wi.lFrame.selectedIndex=e}function ni(){const e=wi.lFrame;return zd(e.tView,e.selectedIndex)}function Ma(){wi.lFrame.currentNamespace="svg"}function Xu(){!function Ap(){wi.lFrame.currentNamespace=null}()}let Rp=!0;function $d(){return Rp}function Wo(e){Rp=e}function Fr(e,n){for(let t=n.directiveStart,i=n.directiveEnd;t<i;t++){const a=e.data[t].type.prototype,{ngAfterContentInit:h,ngAfterContentChecked:v,ngAfterViewInit:C,ngAfterViewChecked:P,ngOnDestroy:L}=a;h&&(e.contentHooks??=[]).push(-t,h),v&&((e.contentHooks??=[]).push(t,v),(e.contentCheckHooks??=[]).push(t,v)),C&&(e.viewHooks??=[]).push(-t,C),P&&((e.viewHooks??=[]).push(t,P),(e.viewCheckHooks??=[]).push(t,P)),null!=L&&(e.destroyHooks??=[]).push(t,L)}}function $a(e,n,t){Pp(e,n,3,t)}function Qu(e,n,t,i){(3&e[2])===t&&Pp(e,n,t,i)}function yf(e,n){let t=e[2];(3&t)===n&&(t&=16383,t+=1,e[2]=t)}function Pp(e,n,t,i){const a=i??-1,h=n.length-1;let v=0;for(let C=void 0!==i?65535&e[17]:0;C<h;C++)if("number"==typeof n[C+1]){if(v=n[C],null!=i&&v>=i)break}else n[C]<0&&(e[17]+=65536),(v<a||-1==a)&&(Op(e,t,n,C),e[17]=(4294901760&e[17])+C+2),C++}function Ab(e,n){const t=Xn(null);try{n.call(e)}finally{Xn(t)}}function Op(e,n,t,i){const r=t[i]<0,a=t[i+1],v=e[r?-t[i]:t[i]];r?e[2]>>14<e[17]>>16&&(3&e[2])===n&&(e[2]+=16384,Ab(v,a)):Ab(v,a)}class Fp{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(n,t,i){this.factory=n,this.canSeeViewProviders=t,this.injectImpl=i}}function xc(e,n,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const a=t[i++],h=t[i++],v=t[i++];e.setAttribute(n,h,v,a)}else{const a=r,h=t[++i];Rb(a)?e.setProperty(n,a,h):e.setAttribute(n,a,h),i++}}return i}function Np(e){return 3===e||4===e||6===e}function Rb(e){return 64===e.charCodeAt(0)}function zp(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?t=r:0===t||Bp(e,t,r,null,-1===t||2===t?n[++i]:null)}}return e}function Bp(e,n,t,i,r){let a=0,h=e.length;if(-1===n)h=-1;else for(;a<e.length;){const v=e[a++];if("number"==typeof v){if(v===n){h=-1;break}if(v>n){h=a-1;break}}}for(;a<e.length;){const v=e[a];if("number"==typeof v)break;if(v===t){if(null===i)return void(null!==r&&(e[a+1]=r));if(i===e[a+1])return void(e[a+2]=r)}a++,null!==i&&a++,null!==r&&a++}-1!==h&&(e.splice(h,0,n),a=h+1),e.splice(a++,0,t),null!==i&&e.splice(a++,0,i),null!==r&&e.splice(a++,0,r)}const Sg={};class _o{injector;parentInjector;constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,i){i=ll(i);const r=this.injector.get(n,Sg,i);return r!==Sg||t===Sg?r:this.parentInjector.get(n,t,i)}}function Vp(e){return-1!==e}function eh(e){return 32767&e}function jl(e,n){let t=function Pb(e){return e>>16}(e),i=n;for(;t>0;)i=i[14],t--;return i}let Sa=!0;function sa(e){const n=Sa;return Sa=e,n}let yy=0;const ii={};function Up(e,n){const t=Cf(e,n);if(-1!==t)return t;const i=n[1];i.firstCreatePass&&(e.injectorIndex=n.length,jp(i.data,e),jp(n,null),jp(i.blueprint,null));const r=Hl(e,n),a=e.injectorIndex;if(Vp(r)){const h=eh(r),v=jl(r,n),C=v[1].data;for(let P=0;P<8;P++)n[a+P]=v[h+P]|C[h+P]}return n[a+8]=r,a}function jp(e,n){e.push(0,0,0,0,0,0,0,0,n)}function Cf(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function Hl(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,i=null,r=n;for(;null!==r;){if(i=G(r),null===i)return-1;if(t++,r=r[14],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function $l(e,n,t){!function Wd(e,n,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Na)&&(i=t[Na]),null==i&&(i=t[Na]=yy++);const r=255&i;n.data[e+(r>>5)]|=1<<r}(e,n,t)}function aa(e,n,t){if(t&Xi.Optional||void 0!==e)return e;Yh()}function Zo(e,n,t,i){if(t&Xi.Optional&&void 0===i&&(i=null),!(t&(Xi.Self|Xi.Host))){const r=e[9],a=ba(void 0);try{return r?r.get(n,i,t&Xi.Optional):Xh(n,i,t&Xi.Optional)}finally{ba(a)}}return aa(i,0,t)}function Eg(e,n,t,i=Xi.Default,r){if(null!==e){if(2048&n[2]&&!(i&Xi.Self)){const h=function j(e,n,t,i,r){let a=e,h=n;for(;null!==a&&null!==h&&2048&h[2]&&!(512&h[2]);){const v=eo(a,h,t,i|Xi.Self,ii);if(v!==ii)return v;let C=a.parent;if(!C){const P=h[20];if(P){const L=P.get(t,ii,i);if(L!==ii)return L}C=G(h),h=h[14]}a=C}return r}(e,n,t,i,ii);if(h!==ii)return h}const a=eo(e,n,t,i,ii);if(a!==ii)return a}return Zo(n,t,i,r)}function eo(e,n,t,i,r){const a=function g(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(Na)?e[Na]:void 0;return"number"==typeof n?n>=0?255&n:N:n}(t);if("function"==typeof a){if(!gf(n,e,i))return i&Xi.Host?aa(r,0,i):Zo(n,t,i,r);try{let h;if(h=a(i),null!=h||i&Xi.Optional)return h;Yh()}finally{gy()}}else if("number"==typeof a){let h=null,v=Cf(e,n),C=-1,P=i&Xi.Host?n[15][5]:null;for((-1===v||i&Xi.SkipSelf)&&(C=-1===v?Hl(e,n):n[v+8],-1!==C&&x(i,!1)?(h=n[1],v=eh(C),n=jl(C,n)):v=-1);-1!==v;){const L=n[1];if(b(a,v,L.data)){const V=m(v,n,t,h,i,P);if(V!==ii)return V}C=n[v+8],-1!==C&&x(i,n[1].data[v+8]===P)&&b(a,v,n)?(h=L,v=eh(C),n=jl(C,n)):v=-1}}return r}function m(e,n,t,i,r,a){const h=n[1],v=h.data[e+8],L=s(v,h,t,null==i?Ll(v)&&Sa:i!=h&&!!(3&v.type),r&Xi.Host&&a===v);return null!==L?c(n,h,L,v):ii}function s(e,n,t,i,r){const a=e.providerIndexes,h=n.data,v=1048575&a,C=e.directiveStart,L=a>>20,W=r?v+L:e.directiveEnd;for(let X=i?v:v+L;X<W;X++){const oe=h[X];if(X<C&&t===oe||X>=C&&oe.type===t)return X}if(r){const X=h[C];if(X&&Nl(X)&&X.type===t)return C}return null}function c(e,n,t,i){let r=e[t];const a=n.data;if(function Mg(e){return e instanceof Fp}(r)){const h=r;h.resolving&&function eg(e,n){throw n&&n.join(" > "),new ot(-200,e)}(function wr(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():hi(e)}(a[t]));const v=sa(h.canSeeViewProviders);h.resolving=!0;const P=h.injectImpl?ba(h.injectImpl):null;gf(e,i,Xi.Default);try{r=e[t]=h.factory(void 0,a,e,i),n.firstCreatePass&&t>=i.directiveStart&&function Ku(e,n,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:a}=n.type.prototype;if(i){const h=_r(n);(t.preOrderHooks??=[]).push(e,h),(t.preOrderCheckHooks??=[]).push(e,h)}r&&(t.preOrderHooks??=[]).push(0-e,r),a&&((t.preOrderHooks??=[]).push(e,a),(t.preOrderCheckHooks??=[]).push(e,a))}(t,a[t],n)}finally{null!==P&&ba(P),sa(v),h.resolving=!1,gy()}}return r}function b(e,n,t){return!!(t[n+(e>>5)]&1<<e)}function x(e,n){return!(e&Xi.Self||e&Xi.Host&&n)}class F{_tNode;_lView;constructor(n,t){this._tNode=n,this._lView=t}get(n,t,i){return Eg(this._tNode,this._lView,n,ll(i),t)}}function N(){return new F(Bi(),yt())}function z(e){return Br(()=>{const n=e.prototype.constructor,t=n[Go]||H(n),i=Object.prototype;let r=Object.getPrototypeOf(e.prototype).constructor;for(;r&&r!==i;){const a=r[Go]||H(r);if(a&&a!==t)return a;r=Object.getPrototypeOf(r)}return a=>new a})}function H(e){return Xs(e)?()=>{const n=H(qn(e));return n&&n()}:fc(e)}function G(e){const n=e[1],t=n.type;return 2===t?n.declTNode:1===t?e[5]:null}function J(e){return function Os(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const a=t[r];if(Np(a))break;if(0===a)r+=2;else if("number"==typeof a)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(a===n)return t[r+1];r+=2}}}return null}(Bi(),e)}function Ae(e,n=null,t=null,i){const r=Be(e,n,t,i);return r.resolveInjectorInitializers(),r}function Be(e,n=null,t=null,i,r=new Set){const a=[t||vr,kd(e)];return i=i||("object"==typeof e?void 0:So(e)),new tr(a,n||rf(),i||null,r)}class Ye{static THROW_IF_NOT_FOUND=Js;static NULL=new ef;static create(n,t){if(Array.isArray(n))return Ae({name:""},t,n,"");{const i=n.name??"";return Ae({name:i},n.parent,n.providers,i)}}static \u0275prov=Nt({token:Ye,providedIn:"any",factory:()=>un(og)});static __NG_ELEMENT_ID__=-1}class pt{attributeName;constructor(n){this.attributeName=n}__NG_ELEMENT_ID__=()=>J(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}}new ct("").__NG_ELEMENT_ID__=e=>{const n=Bi();if(null===n)throw new ot(204,!1);if(2&n.type)return n.value;if(e&Xi.Optional)return null;throw new ot(204,!1)};const dt=!1;let Ke=(()=>class e{static __NG_ELEMENT_ID__=ht;static __NG_ENV_ID__=t=>t})();class bt extends Ke{_lView;constructor(n){super(),this._lView=n}onDestroy(n){return Ud(this._lView,n),()=>function Cs(e,n){if(null===e[21])return;const t=e[21].indexOf(n);-1!==t&&e[21].splice(t,1)}(this._lView,n)}}function ht(){return new bt(yt())}class st{}const Pt=new ct("",{providedIn:"root",factory:()=>!1}),kt=new ct(""),Gt=new ct("");let hn=(()=>{class e{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Je(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=Nt({token:e,providedIn:"root",factory:()=>new e})}return e})();const Dt=class sn extends Ie{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(n=!1){super(),this.__isAsync=n,sf()&&(this.destroyRef=re(Ke,{optional:!0})??void 0,this.pendingTasks=re(hn,{optional:!0})??void 0)}emit(n){const t=Xn(null);try{super.next(n)}finally{Xn(t)}}subscribe(n,t,i){let r=n,a=t||(()=>null),h=i;if(n&&"object"==typeof n){const C=n;r=C.next?.bind(C),a=C.error?.bind(C),h=C.complete?.bind(C)}this.__isAsync&&(a=this.wrapInTimeout(a),r&&(r=this.wrapInTimeout(r)),h&&(h=this.wrapInTimeout(h)));const v=super.subscribe({next:r,error:a,complete:h});return n instanceof Ni&&n.add(v),v}wrapInTimeout(n){return t=>{const i=this.pendingTasks?.add();setTimeout(()=>{n(t),void 0!==i&&this.pendingTasks?.remove(i)})}}};function si(...e){}function jn(e){let n,t;function i(){e=si;try{void 0!==t&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(t),void 0!==n&&clearTimeout(n)}catch{}}return n=setTimeout(()=>{e(),i()}),"function"==typeof requestAnimationFrame&&(t=requestAnimationFrame(()=>{e(),i()})),()=>i()}function hr(e){return queueMicrotask(()=>e()),()=>{e=si}}const Fi="isAngularZone",ji=Fi+"_ID";let Zn=0;class Ht{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Dt(!1);onMicrotaskEmpty=new Dt(!1);onStable=new Dt(!1);onError=new Dt(!1);constructor(n){const{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:a=dt}=n;if(typeof Zone>"u")throw new ot(908,!1);Zone.assertZonePatched();const h=this;h._nesting=0,h._outer=h._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!r&&i,h.shouldCoalesceRunChangeDetection=r,h.callbackScheduled=!1,h.scheduleInRootZone=a,function Yo(e){const n=()=>{!function Lr(e){function n(){jn(()=>{e.callbackScheduled=!1,Fs(e),e.isCheckStableRunning=!0,Si(e),e.isCheckStableRunning=!1})}e.isCheckStableRunning||e.callbackScheduled||(e.callbackScheduled=!0,e.scheduleInRootZone?Zone.root.run(()=>{n()}):e._outer.run(()=>{n()}),Fs(e))}(e)},t=Zn++;e._inner=e._inner.fork({name:"angular",properties:{[Fi]:!0,[ji]:t,[ji+t]:!0},onInvokeTask:(i,r,a,h,v,C)=>{if(function Gr(e){return nr(e,"__ignore_ng_zone__")}(C))return i.invokeTask(a,h,v,C);try{return us(e),i.invokeTask(a,h,v,C)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===h.type||e.shouldCoalesceRunChangeDetection)&&n(),ko(e)}},onInvoke:(i,r,a,h,v,C,P)=>{try{return us(e),i.invoke(a,h,v,C,P)}finally{e.shouldCoalesceRunChangeDetection&&!e.callbackScheduled&&!function pr(e){return nr(e,"__scheduler_tick__")}(C)&&n(),ko(e)}},onHasTask:(i,r,a,h)=>{i.hasTask(a,h),r===a&&("microTask"==h.change?(e._hasPendingMicrotasks=h.microTask,Fs(e),Si(e)):"macroTask"==h.change&&(e.hasPendingMacrotasks=h.macroTask))},onHandleError:(i,r,a,h)=>(i.handleError(a,h),e.runOutsideAngular(()=>e.onError.emit(h)),!1)})}(h)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(Fi)}static assertInAngularZone(){if(!Ht.isInAngularZone())throw new ot(909,!1)}static assertNotInAngularZone(){if(Ht.isInAngularZone())throw new ot(909,!1)}run(n,t,i){return this._inner.run(n,t,i)}runTask(n,t,i,r){const a=this._inner,h=a.scheduleEventTask("NgZoneEvent: "+r,n,gn,si,si);try{return a.runTask(h,t,i)}finally{a.cancelTask(h)}}runGuarded(n,t,i){return this._inner.runGuarded(n,t,i)}runOutsideAngular(n){return this._outer.run(n)}}const gn={};function Si(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Fs(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&!0===e.callbackScheduled)}function us(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function ko(e){e._nesting--,Si(e)}class to{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Dt;onMicrotaskEmpty=new Dt;onStable=new Dt;onError=new Dt;run(n,t,i){return n.apply(t,i)}runGuarded(n,t,i){return n.apply(t,i)}runOutsideAngular(n){return n()}runTask(n,t,i,r){return n.apply(t,i)}}function nr(e,n){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0]?.data?.[n]}class Zi{_console=console;handleError(n){this._console.error("ERROR",n)}}const Fo=new ct("",{providedIn:"root",factory:()=>{const e=re(Ht),n=re(Zi);return t=>e.runOutsideAngular(()=>n.handleError(t))}});function Ls(e,n){return xs(e,n)}const wc=(Ls.required=function rd(e){return xs(Kn,e)},Ls);function Ss(){return hs(Bi(),yt())}function hs(e,n){return new In(Ps(e,n))}let In=(()=>class e{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=Ss})();function gl(e){return e instanceof In?e.nativeElement:e}function nh(){return this._results[Symbol.iterator]()}class od{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Ie}constructor(n=!1){this._emitDistinctChangesOnly=n}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){this.dirty=!1;const i=function Cr(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function Gc(e,n,t){if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++){let r=e[i],a=n[i];if(t&&(r=t(r),a=t(a)),a!==r)return!1}return!0}(this._results,i,t))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=nh}function Ig(e){return!(128&~e.flags)}var by=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(by||{});const xy=new Map;let FT=0;function Fb(e){xy.delete(e[19])}const Nb="__ngContext__";function la(e,n){go(n)?(e[Nb]=n[19],function NT(e){xy.set(e[19],e)}(n)):e[Nb]=n}function Ao(e){return Cw(e[12])}function wy(e){return Cw(e[4])}function Cw(e){for(;null!==e&&!Io(e);)e=e[4];return e}let My;function sd(){if(void 0!==My)return My;if(typeof document<"u")return document;throw new ot(210,!1)}const Mf=new ct("",{providedIn:"root",factory:()=>kk}),kk="ng",kw=new ct(""),rh=new ct("",{providedIn:"platform",factory:()=>"unknown"}),Ga=new ct(""),Aw=new ct("",{providedIn:"root",factory:()=>sd().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),Ow=new ct("",{providedIn:"root",factory:()=>!1});var Iy=function(e){return e[e.CHANGE_DETECTION=0]="CHANGE_DETECTION",e[e.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",e}(Iy||{});const ky=new ct(""),KT=new Set;function Es(e){KT.has(e)||(KT.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}var Zp=function(e){return e[e.EarlyRead=0]="EarlyRead",e[e.Write=1]="Write",e[e.MixedReadWrite=2]="MixedReadWrite",e[e.Read=3]="Read",e}(Zp||{});let Kd=(()=>{class e{impl=null;execute(){this.impl?.execute()}static \u0275prov=Nt({token:e,providedIn:"root",factory:()=>new e})}return e})();const Ng=[Zp.EarlyRead,Zp.Write,Zp.MixedReadWrite,Zp.Read];let zg=(()=>{class e{ngZone=re(Ht);scheduler=re(st);errorHandler=re(Zi,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){re(ky,{optional:!0})}execute(){this.executing=!0;for(const t of Ng)for(const i of this.sequences)if(!i.erroredOrDestroyed&&i.hooks[t])try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>i.hooks[t](i.pipelinedValue),i.snapshot))}catch(r){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(const t of this.sequences)t.afterRun(),t.once&&(this.sequences.delete(t),t.destroy());for(const t of this.deferredRegistrations)this.sequences.add(t);this.deferredRegistrations.size>0&&this.scheduler.notify(8),this.deferredRegistrations.clear()}register(t){this.executing?this.deferredRegistrations.add(t):(this.sequences.add(t),this.scheduler.notify(7))}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,i){return i?i.run(Iy.AFTER_NEXT_RENDER,t):t()}static \u0275prov=Nt({token:e,providedIn:"root",factory:()=>new e})}return e})();class Ay{impl;hooks;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(n,t,i,r,a=null){this.impl=n,this.hooks=t,this.once=i,this.snapshot=a,this.unregisterOnDestroy=r?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}}function Yp(e,n){!n?.injector&&Bu();const t=n?.injector??re(Ye);return Es("NgAfterRender"),Nw(e,t,n,!1)}function Tc(e,n){!n?.injector&&Bu();const t=n?.injector??re(Ye);return Es("NgAfterNextRender"),Nw(e,t,n,!0)}function Nw(e,n,t,i){const r=n.get(Kd);r.impl??=n.get(zg);const a=n.get(ky,null,{optional:!0}),h=t?.phase??Zp.MixedReadWrite,v=!0!==t?.manualCleanup?n.get(Ke):null,C=new Ay(r.impl,function QT(e,n){if(e instanceof Function){const t=[void 0,void 0,void 0,void 0];return t[n]=e,t}return[e.earlyRead,e.write,e.mixedReadWrite,e.read]}(e,h),i,v,a?.snapshot(null));return r.impl.register(C),C}var Sc=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(Sc||{});let Zy,Yy;function ql(){if(void 0===Zy&&(Zy=null,Rr.trustedTypes))try{Zy=Rr.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Zy}function If(e){return ql()?.createHTML(e)||e}function qg(){if(void 0===Yy&&(Yy=null,Rr.trustedTypes))try{Yy=Rr.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Yy}function Zw(e){return qg()?.createHTML(e)||e}function Ky(e){return qg()?.createScriptURL(e)||e}class tm{changingThisBreaksApplicationSecurity;constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${wn})`}}class Gk extends tm{getTypeName(){return"HTML"}}class qk extends tm{getTypeName(){return"Style"}}class Wg extends tm{getTypeName(){return"Script"}}class Yw extends tm{getTypeName(){return"URL"}}class Wk extends tm{getTypeName(){return"ResourceURL"}}function _l(e){return e instanceof tm?e.changingThisBreaksApplicationSecurity:e}function Ec(e,n){const t=function Zk(e){return e instanceof tm&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${wn})`)}return t===n}class Yk{inertDocumentHelper;constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(If(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.firstChild?.remove(),t)}catch{return null}}}class IM{defaultDoc;inertDocument;constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=If(n),t}}const kM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function a0(e){return(e=String(e)).match(kM)?e:"unsafe:"+e}function Ea(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function ev(...e){const n={};for(const t of e)for(const i in t)t.hasOwnProperty(i)&&(n[i]=!0);return n}const Zg=Ea("area,br,col,hr,img,wbr"),Yg=Ea("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Xg=Ea("rp,rt"),Kw=ev(Zg,ev(Yg,Ea("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),ev(Xg,Ea("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),ev(Xg,Yg)),Rf=Ea("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Jw=ev(Rf,Ea("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ea("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),AM=Ea("script,style,template");class Xk{sanitizedSomething=!1;buf=[];sanitizeChildren(n){let t=n.firstChild,i=!0,r=[];for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)r.push(t),t=PM(t);else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let a=Kk(t);if(a){t=a;break}t=r.pop()}return this.buf.join("")}startElement(n){const t=OM(n).toLowerCase();if(!Kw.hasOwnProperty(t))return this.sanitizedSomething=!0,!AM.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=n.attributes;for(let r=0;r<i.length;r++){const a=i.item(r),h=a.name,v=h.toLowerCase();if(!Jw.hasOwnProperty(v)){this.sanitizedSomething=!0;continue}let C=a.value;Rf[v]&&(C=a0(C)),this.buf.push(" ",h,'="',tv(C),'"')}return this.buf.push(">"),!0}endElement(n){const t=OM(n).toLowerCase();Kw.hasOwnProperty(t)&&!Zg.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(tv(n))}}function Kk(e){const n=e.nextSibling;if(n&&e!==n.previousSibling)throw e1(n);return n}function PM(e){const n=e.firstChild;if(n&&function RM(e,n){return(e.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(e,n))throw e1(n);return n}function OM(e){const n=e.nodeName;return"string"==typeof n?n:"FORM"}function e1(e){return new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`)}const Qk=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Jk=/([^\#-~ |!])/g;function tv(e){return e.replace(/&/g,"&amp;").replace(Qk,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(Jk,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let nm;function nv(e,n){let t=null;try{nm=nm||function s0(e){const n=new IM(e);return function Jy(){try{return!!(new window.DOMParser).parseFromString(If(""),"text/html")}catch{return!1}}()?new Yk(n):n}(e);let i=n?String(n):"";t=nm.getInertBodyElement(i);let r=5,a=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=a,a=t.innerHTML,t=nm.getInertBodyElement(i)}while(i!==a);return If((new Xk).sanitizeChildren(Kg(t)||t))}finally{if(t){const i=Kg(t)||t;for(;i.firstChild;)i.firstChild.remove()}}}function Kg(e){return"content"in e&&function eA(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var ps=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(ps||{});function iv(e){const n=Qg();return n?Zw(n.sanitize(ps.HTML,e)||""):Ec(e,"HTML")?Zw(_l(e)):nv(sd(),hi(e))}function eu(e){const n=Qg();return n?n.sanitize(ps.URL,e)||"":Ec(e,"URL")?_l(e):a0(hi(e))}function t1(e){const n=Qg();if(n)return Ky(n.sanitize(ps.RESOURCE_URL,e)||"");if(Ec(e,"ResourceURL"))return Ky(_l(e));throw new ot(904,!1)}function d0(e){return function kf(e){return ql()?.createScriptURL(e)||e}(e[0])}function Qg(){const e=yt();return e&&e[10].sanitizer}const r1=/^>|^->|<!--|-->|--!>|<!-$/g,o1=/(<|>)/g;function v0(e){return e.ownerDocument.defaultView}function Wl(e){return e instanceof Function?e():e}var dh=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(dh||{}),uh=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(uh||{});function ov(e,n){return undefined(e,n)}function om(e,n,t,i,r){if(null!=i){let a,h=!1;Io(i)?a=i:go(i)&&(h=!0,i=i[0]);const v=Ki(i);0===e&&null!==t?null==r?h1(n,t,v):lm(n,t,v,r||null,!0):1===e&&null!==t?lm(n,t,v,r||null,!0):2===e?function Ff(e,n,t){e.removeChild(null,n,t)}(n,v,h):3===e&&n.destroyNode(v),null!=a&&function uA(e,n,t,i,r){const a=t[7];a!==Ki(t)&&om(n,e,i,a,r);for(let v=10;v<t.length;v++){const C=t[v];dv(C[1],C,e,n,i,a)}}(n,e,a,t,r)}}function C0(e,n){return e.createComment(function h0(e){return e.replace(r1,n=>n.replace(o1,"\u200b$1\u200b"))}(n))}function Pf(e,n,t){return e.createElement(n,t)}function sv(e,n){n[10].changeDetectionScheduler?.notify(10),dv(e,n,n[11],2,null,null)}function T0(e,n){const t=e[9],i=n[3];(go(i)||n[15]!==i[3][15])&&(e[2]|=Kc.HasTransplantedViews),null===t?e[9]=[n]:t.push(n)}function fh(e,n){const t=e[9],i=t.indexOf(n);t.splice(i,1)}function e_(e,n){if(e.length<=10)return;const t=10+n,i=e[t];if(i){const r=i[16];null!==r&&r!==e&&fh(r,i),n>0&&(e[t-1][4]=i[4]);const a=cl(e,10+n);!function HM(e,n){sv(e,n),n[0]=null,n[5]=null}(i[1],i);const h=a[18];null!==h&&h.detachView(a[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function t_(e,n){if(!(256&n[2])){const t=n[11];t.destroyNode&&dv(e,n,t,3,null,null),function u1(e){let n=e[12];if(!n)return M0(e[1],e);for(;n;){let t=null;if(go(n))t=n[12];else{const i=n[10];i&&(t=i)}if(!t){for(;n&&!n[4]&&n!==e;)go(n)&&M0(n[1],n),n=n[3];null===n&&(n=e),go(n)&&M0(n[1],n),t=n&&n[4]}n=t}}(n)}}function M0(e,n){if(256&n[2])return;const t=Xn(null);try{n[2]&=-129,n[2]|=256,n[24]&&xn(n[24]),function S0(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let i=0;i<t.length;i+=2){const r=n[t[i]];if(!(r instanceof Fp)){const a=t[i+1];if(Array.isArray(a))for(let h=0;h<a.length;h+=2){const v=r[a[h]],C=a[h+1];try{C.call(v)}finally{}}else try{a.call(r)}finally{}}}}(e,n),function $M(e,n){const t=e.cleanup,i=n[7];if(null!==t)for(let h=0;h<t.length-1;h+=2)if("string"==typeof t[h]){const v=t[h+3];v>=0?i[v]():i[-v].unsubscribe(),h+=2}else t[h].call(i[t[h+1]]);null!==i&&(n[7]=null);const r=n[21];if(null!==r){n[21]=null;for(let h=0;h<r.length;h++)(0,r[h])()}const a=n[23];if(null!==a){n[23]=null;for(const h of a)h.destroy()}}(e,n),1===n[1].type&&n[11].destroy();const i=n[16];if(null!==i&&Io(n[3])){i!==n[3]&&fh(i,n);const r=n[18];null!==r&&r.detachView(e)}Fb(n)}finally{Xn(t)}}function am(e,n,t){return function GM(e,n,t){let i=n;for(;null!==i&&168&i.type;)i=(n=i).parent;if(null===i)return t[0];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:a}=e.data[i.directiveStart+r];if(a===Sc.None||a===Sc.Emulated)return null}return Ps(i,t)}}(e,n.parent,t)}function lm(e,n,t,i,r){e.insertBefore(n,t,i,r)}function h1(e,n,t){e.appendChild(n,t)}function qM(e,n,t,i,r){null!==i?lm(e,n,t,i,r):h1(e,n,t)}function f1(e,n){return e.parentNode(n)}function p1(e,n,t){return E0(e,n,t)}let E0=function n_(e,n,t){return 40&e.type?Ps(e,t):null};function Of(e,n,t,i){const r=am(e,i,n),a=n[11],v=p1(i.parent||n[5],i,n);if(null!=r)if(Array.isArray(t))for(let C=0;C<t.length;C++)qM(a,r,t[C],v,!1);else qM(a,r,t,v,!1)}function ph(e,n){if(null!==n){const t=n.type;if(3&t)return Ps(n,e);if(4&t)return lv(-1,e[n.index]);if(8&t){const i=n.child;if(null!==i)return ph(e,i);{const r=e[n.index];return Io(r)?lv(-1,r):Ki(r)}}if(128&t)return ph(e,n.next);if(32&t)return ov(n,e)()||Ki(e[n.index]);{const i=av(e,n);return null!==i?Array.isArray(i)?i[0]:ph(vc(e[15]),i):ph(e,n.next)}}return null}function av(e,n){return null!==n?e[15][5].projection[n.projection]:null}function lv(e,n){const t=10+e+1;if(t<n.length){const i=n[t],r=i[1].firstChild;if(null!==r)return ph(i,r)}return n[7]}function dm(e,n,t,i,r,a,h){for(;null!=t;){if(128===t.type){t=t.next;continue}const v=i[t.index],C=t.type;if(h&&0===n&&(v&&la(Ki(v),i),t.flags|=2),32&~t.flags)if(8&C)dm(e,n,t.child,i,r,a,!1),om(n,e,r,v,a);else if(32&C){const P=ov(t,i);let L;for(;L=P();)om(n,e,r,L,a);om(n,e,r,v,a)}else 16&C?m1(e,n,i,t,r,a):om(n,e,r,v,a);t=h?t.projectionNext:t.next}}function dv(e,n,t,i,r,a){dm(t,i,e.firstChild,n,r,a,!1)}function m1(e,n,t,i,r,a){const h=t[15],C=h[5].projection[i.projection];if(Array.isArray(C))for(let P=0;P<C.length;P++)om(n,e,r,C[P],a);else{let P=C;const L=h[3];Ig(i)&&(P.flags|=128),dm(e,n,P,L,r,a,!0)}}function ZM(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function YM(e,n,t){const{mergedAttrs:i,classes:r,styles:a}=t;null!==i&&xc(e,n,i),null!==r&&ZM(e,n,r),null!==a&&function hA(e,n,t){e.setAttribute(n,"style",t)}(e,n,a)}function fA(e,n,t){let i=e.length;for(;;){const r=e.indexOf(n,t);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){const a=n.length;if(r+a===i||e.charCodeAt(r+a)<=32)return r}t=r+1}}const XM="ng-template";function D0(e,n,t,i){let r=0;if(i){for(;r<n.length&&"string"==typeof n[r];r+=2)if("class"===n[r]&&-1!==fA(n[r+1].toLowerCase(),t,0))return!0}else if(g1(e))return!1;if(r=n.indexOf(1,r),r>-1){let a;for(;++r<n.length&&"string"==typeof(a=n[r]);)if(a.toLowerCase()===t)return!0}return!1}function g1(e){return 4===e.type&&e.value!==XM}function pA(e,n,t){return n===(4!==e.type||t?e.value:XM)}function I0(e,n,t){let i=4;const r=e.attrs,a=null!==r?function gA(e){for(let n=0;n<e.length;n++)if(Np(e[n]))return n;return e.length}(r):0;let h=!1;for(let v=0;v<n.length;v++){const C=n[v];if("number"!=typeof C){if(!h)if(4&i){if(i=2|1&i,""!==C&&!pA(e,C,t)||""===C&&1===n.length){if(ld(i))return!1;h=!0}}else if(8&i){if(null===r||!D0(e,r,C,t)){if(ld(i))return!1;h=!0}}else{const P=n[++v],L=mA(C,r,g1(e),t);if(-1===L){if(ld(i))return!1;h=!0;continue}if(""!==P){let V;if(V=L>a?"":r[L+1].toLowerCase(),2&i&&P!==V){if(ld(i))return!1;h=!0}}}}else{if(!h&&!ld(i)&&!ld(C))return!1;if(h&&ld(C))continue;h=!1,i=C|1&i}}return ld(i)||h}function ld(e){return!(1&e)}function mA(e,n,t,i){if(null===n)return-1;let r=0;if(i||!t){let a=!1;for(;r<n.length;){const h=n[r];if(h===e)return r;if(3===h||6===h)a=!0;else{if(1===h||2===h){let v=n[++r];for(;"string"==typeof v;)v=n[++r];continue}if(4===h)break;if(0===h){r+=4;continue}}r+=a?1:2}return-1}return function _A(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const i=e[t];if("number"==typeof i)return-1;if(i===n)return t;t++}return-1}(n,e)}function KM(e,n,t=!1){for(let i=0;i<n.length;i++)if(I0(e,n[i],t))return!0;return!1}function QM(e,n){e:for(let t=0;t<n.length;t++){const i=n[t];if(e.length===i.length){for(let r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function JM(e,n){return e?":not("+n.trim()+")":n}function yA(e){let n=e[0],t=1,i=2,r="",a=!1;for(;t<e.length;){let h=e[t];if("string"==typeof h)if(2&i){const v=e[++t];r+="["+h+(v.length>0?'="'+v+'"':"")+"]"}else 8&i?r+="."+h:4&i&&(r+=" "+h);else""!==r&&!ld(h)&&(n+=JM(a,r),r=""),i=h,a=a||!ld(i);t++}return""!==r&&(n+=JM(a,r)),n}const Vi={};function Ze(e=1){A0(fi(),yt(),ts()+e,!1)}function A0(e,n,t,i){if(!i)if(3&~n[2]){const a=e.preOrderHooks;null!==a&&Qu(n,a,0,t)}else{const a=e.preOrderCheckHooks;null!==a&&$a(n,a,t)}Yu(t)}function Rt(e,n=Xi.Default){const t=yt();return null===t?un(e,n):Eg(Bi(),t,qn(e),n)}function _1(e,n,t,i,r,a){const h=Xn(null);try{let v=null;r&dh.SignalBased&&(v=n[i][xi]),null!==v&&void 0!==v.transformFn&&(a=v.transformFn(a)),r&dh.HasDecoratorInputTransform&&(a=e.inputTransforms[i].call(n,a)),null!==e.setInput?e.setInput(n,v,a,t,i):ly(n,v,i,a)}finally{Xn(h)}}function o_(e,n,t,i,r,a,h,v,C,P,L){const V=n.blueprint.slice();return V[0]=r,V[2]=1228|i,(null!==P||e&&2048&e[2])&&(V[2]|=2048),gg(V),V[3]=V[14]=e,V[8]=t,V[10]=h||e&&e[10],V[11]=v||e&&e[11],V[9]=C||e&&e[9]||null,V[5]=a,V[19]=function LT(){return FT++}(),V[6]=L,V[20]=P,V[15]=2==n.type?e[15]:V,V}function Lf(e,n,t,i,r){let a=e.data[n];if(null===a)a=function P0(e,n,t,i,r){const a=td(),h=Ep(),C=e.data[n]=function xA(e,n,t,i,r,a){let h=n?n.injectorIndex:-1,v=0;return fl()&&(v|=128),{type:t,index:i,insertBeforeIndex:null,injectorIndex:h,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:v,providerIndexes:0,value:r,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,h?a:a&&a.parent,t,n,i,r);return null===e.firstChild&&(e.firstChild=C),null!==a&&(h?null==a.child&&null!==C.parent&&(a.child=C):null===a.next&&(a.next=C,C.prev=a)),C}(e,n,t,i,r),function yg(){return wi.lFrame.inI18n}()&&(a.flags|=32);else if(64&a.type){a.type=t,a.value=i,a.attrs=r;const h=function Wu(){const e=wi.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();a.injectorIndex=null===h?-1:h.injectorIndex}return ia(a,!0),a}function s_(e,n,t,i){if(0===t)return-1;const r=n.length;for(let a=0;a<t;a++)n.push(i),e.blueprint.push(i),e.data.push(null);return r}function y1(e,n,t,i,r){const a=ts(),h=2&i;try{Yu(-1),h&&n.length>25&&A0(e,n,25,!1),t(i,r)}finally{Yu(a)}}function um(e,n,t){if(df(n)){const i=Xn(null);try{const a=n.directiveEnd;for(let h=n.directiveStart;h<a;h++){const v=e.data[h];v.contentQueries&&v.contentQueries(1,t[h],h)}}finally{Xn(i)}}}function O0(e,n,t){qu()&&(function EA(e,n,t,i){const r=t.directiveStart,a=t.directiveEnd;Ll(t)&&function fS(e,n,t){const i=Ps(n,e),r=hv(t),a=e[10].rendererFactory,h=zf(e,o_(e,r,null,N0(t),i,n,null,a.createRenderer(i,t),null,null,null));e[n.index]=h}(n,t,e.data[r+t.componentOffset]),e.firstCreatePass||Up(t,n),la(i,n);const h=t.initialInputs;for(let v=r;v<a;v++){const C=e.data[v],P=c(n,e,v,t);la(P,n),null!==h&&pS(0,v-r,P,C,0,h),Nl(C)&&(Ta(t.index,n)[8]=c(n,e,v,t))}}(e,n,t,Ps(t,n)),!(64&~t.flags)&&cS(e,n,t))}function uv(e,n,t=Ps){const i=n.localNames;if(null!==i){let r=n.index+1;for(let a=0;a<i.length;a+=2){const h=i[a+1],v=-1===h?t(n,e):e[h];e[r++]=v}}}function hv(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=F0(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function F0(e,n,t,i,r,a,h,v,C,P,L){const V=25+i,W=V+r,X=function tS(e,n){const t=[];for(let i=0;i<n;i++)t.push(i<e?null:Vi);return t}(V,W),oe="function"==typeof P?P():P;return X[1]={type:e,blueprint:X,template:t,queries:null,viewQuery:v,declTNode:n,data:X.slice().fill(null,V),bindingStartIndex:V,expandoStartIndex:W,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof h?h():h,firstChild:null,schemas:C,consts:oe,incompleteFirstPass:!1,ssrId:L}}let v1=()=>null;function sS(e,n,t,i,r){for(let a in n){if(!n.hasOwnProperty(a))continue;const h=n[a];if(void 0===h)continue;i??={};let v,C=dh.None;Array.isArray(h)?(v=h[0],C=h[1]):v=h;let P=a;if(null!==r){if(!r.hasOwnProperty(a))continue;P=r[a]}0===e?aS(i,t,P,v,C):aS(i,t,P,v)}return i}function aS(e,n,t,i,r){let a;e.hasOwnProperty(t)?(a=e[t]).push(n,i):a=e[t]=[n,i],void 0!==r&&a.push(r)}function yl(e,n,t,i,r,a,h,v){const C=Ps(n,t);let L,P=n.inputs;!v&&null!=P&&(L=P[i])?(C1(e,t,L,i,r),Ll(n)&&function CA(e,n){const t=Ta(n,e);16&t[2]||(t[2]|=64)}(t,n.index)):3&n.type&&(i=function wA(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=h?h(r,n.value||"",i):r,a.setProperty(C,i,r))}function b1(e,n,t,i){if(qu()){const r=null===i?null:{"":-1},a=function fv(e,n){const t=e.directiveRegistry;let i=null,r=null;if(t)for(let a=0;a<t.length;a++){const h=t[a];if(KM(n,h.selectors,!1))if(i||(i=[]),Nl(h))if(null!==h.findHostDirectiveDefs){const v=[];r=r||new Map,h.findHostDirectiveDefs(h,v,r),i.unshift(...v,h),x1(e,n,v.length)}else i.unshift(h),x1(e,n,0);else r=r||new Map,h.findHostDirectiveDefs?.(h,i,r),i.push(h)}return null===i?null:[i,r]}(e,t);let h,v;null===a?h=v=null:[h,v]=a,null!==h&&lS(e,n,t,h,r,v),r&&function dS(e,n,t){if(n){const i=e.localNames=[];for(let r=0;r<n.length;r+=2){const a=t[n[r+1]];if(null==a)throw new ot(-301,!1);i.push(n[r],a)}}}(t,i,r)}t.mergedAttrs=zp(t.mergedAttrs,t.attrs)}function lS(e,n,t,i,r,a){for(let P=0;P<i.length;P++)$l(Up(t,n),e,i[P].type);!function DA(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,i.length);for(let P=0;P<i.length;P++){const L=i[P];L.providersResolver&&L.providersResolver(L)}let h=!1,v=!1,C=s_(e,n,i.length,null);for(let P=0;P<i.length;P++){const L=i[P];t.mergedAttrs=zp(t.mergedAttrs,L.hostAttrs),hS(e,t,n,C,L),uS(C,L,r),null!==L.contentQueries&&(t.flags|=4),(null!==L.hostBindings||null!==L.hostAttrs||0!==L.hostVars)&&(t.flags|=64);const V=L.type.prototype;!h&&(V.ngOnChanges||V.ngOnInit||V.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),h=!0),!v&&(V.ngOnChanges||V.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),v=!0),C++}!function L0(e,n,t){const r=n.directiveEnd,a=e.data,h=n.attrs,v=[];let C=null,P=null;for(let L=n.directiveStart;L<r;L++){const V=a[L],W=t?t.get(V):null,oe=W?W.outputs:null;C=sS(0,V.inputs,L,C,W?W.inputs:null),P=sS(1,V.outputs,L,P,oe);const he=null===C||null===h||g1(n)?null:yo(C,L,h);v.push(he)}null!==C&&(C.hasOwnProperty("class")&&(n.flags|=8),C.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=v,n.inputs=C,n.outputs=P}(e,t,a)}function cS(e,n,t){const i=t.directiveStart,r=t.directiveEnd,a=t.index,h=function mf(){return wi.lFrame.currentDirectiveIndex}();try{Yu(a);for(let v=i;v<r;v++){const C=e.data[v],P=n[v];bg(v),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&Zl(C,P)}}finally{Yu(-1),bg(h)}}function Zl(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function x1(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function uS(e,n,t){if(t){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)t[n.exportAs[i]]=e;Nl(n)&&(t[""]=e)}}function hS(e,n,t,i,r){e.data[i]=r;const a=r.factory||(r.factory=fc(r.type)),h=new Fp(a,Nl(r),Rt);e.blueprint[i]=h,t[i]=h,function MA(e,n,t,i,r){const a=r.hostBindings;if(a){let h=e.hostBindingOpCodes;null===h&&(h=e.hostBindingOpCodes=[]);const v=~n.index;(function SA(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(h)!=v&&h.push(v),h.push(t,i,a)}}(e,n,i,s_(e,t,r.hostVars,Vi),r)}function N0(e){let n=16;return e.signals?n=4096:e.onPush&&(n=64),n}function tu(e,n,t,i,r,a){const h=Ps(e,n);!function w1(e,n,t,i,r,a,h){if(null==a)e.removeAttribute(n,r,t);else{const v=null==h?hi(a):h(a,i||"",r);e.setAttribute(n,r,v,t)}}(n[11],h,a,e.value,t,i,r)}function pS(e,n,t,i,r,a){const h=a[n];if(null!==h)for(let v=0;v<h.length;)_1(i,t,h[v++],h[v++],h[v++],h[v++])}function yo(e,n,t){let i=null,r=0;for(;r<t.length;){const a=t[r];if(0!==a)if(5!==a){if("number"==typeof a)break;if(e.hasOwnProperty(a)){null===i&&(i=[]);const h=e[a];for(let v=0;v<h.length;v+=3)if(h[v]===n){i.push(a,h[v+1],h[v+2],t[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function hm(e,n,t,i){return[e,!0,0,n,null,i,null,t,null,null]}function a_(e,n){const t=e.contentQueries;if(null!==t){const i=Xn(null);try{for(let r=0;r<t.length;r+=2){const h=t[r+1];if(-1!==h){const v=e.data[h];kp(t[r]),v.contentQueries(2,n[h],h)}}}finally{Xn(i)}}}function zf(e,n){return e[12]?e[13][4]=n:e[12]=n,e[13]=n,n}function z0(e,n,t){kp(0);const i=Xn(null);try{n(e,t)}finally{Xn(i)}}function mS(e){return e[7]??=[]}function B0(e){return e.cleanup??=[]}function Dc(e,n,t){return(null===e||Nl(e))&&(t=function Pr(e){for(;Array.isArray(e);){if("object"==typeof e[1])return e;e=e[0]}return null}(t[n.index])),t[11]}function l_(e,n){const t=e[9],i=t?t.get(Zi,null):null;i&&i.handleError(n)}function C1(e,n,t,i,r){for(let a=0;a<t.length;){const h=t[a++],v=t[a++],C=t[a++];_1(e.data[h],n[h],i,v,C,r)}}function Ds(e,n,t){const i=Ge(n,e);!function sm(e,n,t){e.setValue(n,t)}(e[11],i,t)}function IA(e,n){const t=Ta(n,e),i=t[1];!function kA(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}(i,t);const r=t[0];null!==r&&null===t[6]&&(t[6]=null),V0(i,t,t[8])}function V0(e,n,t){Zu(n);try{const i=e.viewQuery;null!==i&&z0(1,i,t);const r=e.template;null!==r&&y1(e,n,r,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),n[18]?.finishViewCreation(e),e.staticContentQueries&&a_(e,n),e.staticViewQueries&&z0(2,e.viewQuery,t);const a=e.components;null!==a&&function Ic(e,n){for(let t=0;t<n.length;t++)IA(e,n[t])}(n,a)}catch(i){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),i}finally{n[2]&=-5,Cg()}}function c_(e,n,t,i){const r=Xn(null);try{const a=n.tView,C=o_(e,a,t,4096&e[2]?4096:16,null,n,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);C[16]=e[n.index];const L=e[18];return null!==L&&(C[18]=L.createEmbeddedView(a)),V0(a,C,t),C}finally{Xn(r)}}function T1(e,n){const t=10+n;if(t<e.length)return e[t]}function fm(e,n){return!n||null===n.firstChild||Ig(e)}function Bf(e,n,t,i=!0){const r=n[1];if(function Jg(e,n,t,i){const r=10+i,a=t.length;i>0&&(t[r-1][4]=n),i<a-10?(n[4]=t[r],pp(t,10+i,n)):(t.push(n),n[4]=null),n[3]=t;const h=n[16];null!==h&&t!==h&&T0(h,n);const v=n[18];null!==v&&v.insertView(e),_g(n),n[2]|=128}(r,n,e,t),i){const h=lv(t,e),v=n[11],C=f1(v,e[7]);null!==C&&function d1(e,n,t,i,r,a){i[0]=r,i[5]=n,dv(e,i,t,1,r,a)}(r,e[5],v,n,C,h)}const a=n[6];null!==a&&null!==a.firstChild&&(a.firstChild=null)}function pv(e,n){const t=e_(e,n);return void 0!==t&&t_(t[1],t),t}function mv(e,n,t,i,r=!1){for(;null!==t;){if(128===t.type){t=r?t.projectionNext:t.next;continue}const a=n[t.index];null!==a&&i.push(Ki(a)),Io(a)&&U0(a,i);const h=t.type;if(8&h)mv(e,n,t.child,i);else if(32&h){const v=ov(t,n);let C;for(;C=v();)i.push(C)}else if(16&h){const v=av(n,t);if(Array.isArray(v))i.push(...v);else{const C=vc(n[15]);mv(C[1],C,v,i,!0)}}t=r?t.projectionNext:t.next}return i}function U0(e,n){for(let t=10;t<e.length;t++){const i=e[t],r=i[1].firstChild;null!==r&&mv(i[1],i,r,n)}e[7]!==e[0]&&n.push(e[7])}let d_=[];const S1={...Oi,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{na(e.lView)},consumerOnSignalRead(){this.lView[24]=this}},gS={...Oi,consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{let n=vc(e.lView);for(;n&&!E1(n[1]);)n=vc(n);n&&Hu(n)},consumerOnSignalRead(){this.lView[24]=this}};function E1(e){return 2!==e.type}function gv(e){if(null===e[23])return;let n=!0;for(;n;){let t=!1;for(const i of e[23])i.dirty&&(t=!0,null===i.zone||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));n=t&&!!(8192&e[2])}}function Vf(e,n=!0,t=0){const r=e[10].rendererFactory;r.begin?.();try{!function _S(e,n){const t=nd();try{pf(!0),H0(e,n);let i=0;for(;Mp(e);){if(100===i)throw new ot(103,!1);i++,H0(e,1)}}finally{pf(t)}}(e,t)}catch(h){throw n&&l_(e,h),h}finally{r.end?.()}}function yS(e,n,t,i){const r=n[2];if(!(256&~r))return;Zu(n);let v=!0,C=null,P=null;E1(e)?(P=function M1(e){return e[24]??function cd(e){const n=d_.pop()??Object.create(S1);return n.lView=e,n}(e)}(n),C=bn(P)):null===function ks(){return f}()?(v=!1,P=function h_(e){const n=e[24]??Object.create(gS);return n.lView=e,n}(n),C=bn(P)):n[24]&&(xn(n[24]),n[24]=null);try{gg(n),function bc(e){return wi.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&y1(e,n,t,2,i);const L=!(3&~r);if(L){const X=e.preOrderCheckHooks;null!==X&&$a(n,X,null)}else{const X=e.preOrderHooks;null!==X&&Qu(n,X,0,null),yf(n,0)}if(function RA(e){for(let n=Ao(e);null!==n;n=wy(n)){if(!(n[2]&Kc.HasTransplantedViews))continue;const t=n[9];for(let i=0;i<t.length;i++)Hu(t[i])}}(n),gv(n),_v(n,0),null!==e.contentQueries&&a_(e,n),L){const X=e.contentCheckHooks;null!==X&&$a(n,X)}else{const X=e.contentHooks;null!==X&&Qu(n,X,1),yf(n,1)}!function eS(e,n){const t=e.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Yu(~r);else{const a=r,h=t[++i],v=t[++i];vg(h,a),v(2,n[a])}}}finally{Yu(-1)}}(e,n);const V=e.components;null!==V&&bS(n,V,0);const W=e.viewQuery;if(null!==W&&z0(2,W,i),L){const X=e.viewCheckHooks;null!==X&&$a(n,X)}else{const X=e.viewHooks;null!==X&&Qu(n,X,2),yf(n,2)}if(!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[22]){for(const X of n[22])X();n[22]=null}n[2]&=-73}catch(L){throw na(n),L}finally{null!==P&&(el(P,C),v&&function u_(e){e.lView[24]!==e&&(e.lView=null,d_.push(e))}(P)),Cg()}}function _v(e,n){for(let t=Ao(e);null!==t;t=wy(t))for(let i=10;i<t.length;i++)D1(t[i],n)}function vS(e,n,t){D1(Ta(n,e),t)}function D1(e,n){Vd(e)&&H0(e,n)}function H0(e,n){const i=e[1],r=e[2],a=e[24];let h=!!(0===n&&16&r);if(h||=!!(64&r&&0===n),h||=!!(1024&r),h||=!(!a?.dirty||!tl(a)),h||=!1,a&&(a.dirty=!1),e[2]&=-9217,h)yS(i,e,i.template,e[8]);else if(8192&r){gv(e),_v(e,1);const v=i.components;null!==v&&bS(e,v,1)}}function bS(e,n,t){for(let i=0;i<n.length;i++)vS(e,n[i],t)}function f_(e,n){const t=nd()?64:1088;for(e[10].changeDetectionScheduler?.notify(n);e;){e[2]|=t;const i=vc(e);if(zl(e)&&!i)return e;e=i}return null}class yv{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){const n=this._lView,t=n[1];return mv(t,n,t.firstChild,[])}constructor(n,t,i=!0){this._lView=n,this._cdRefInjectingView=t,this.notifyErrorHandler=i}get context(){return this._lView[8]}get dirty(){return!!(9280&this._lView[2])||!!this._lView[24]?.dirty}set context(n){this._lView[8]=n}get destroyed(){return!(256&~this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(Io(n)){const t=n[8],i=t?t.indexOf(this):-1;i>-1&&(e_(n,i),cl(t,i))}this._attachedToViewContainer=!1}t_(this._lView[1],this._lView)}onDestroy(n){Ud(this._lView,n)}markForCheck(){f_(this._cdRefInjectingView||this._lView,4)}markForRefresh(){Hu(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){_g(this._lView),this._lView[2]|=128}detectChanges(){this._lView[2]|=1024,Vf(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ot(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const n=zl(this._lView),t=this._lView[16];null!==t&&!n&&fh(t,this._lView),sv(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new ot(902,!1);this._appRef=n;const t=zl(this._lView),i=this._lView[16];null!==i&&!t&&T0(i,this._lView),_g(this._lView)}}let Lo=(()=>class e{static __NG_ELEMENT_ID__=PA})();const pm=Lo,I1=class extends pm{_declarationLView;_declarationTContainer;elementRef;constructor(n,t,i){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,i){const r=c_(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:t,dehydratedView:i});return new yv(r)}};function PA(){return vv(Bi(),yt())}function vv(e,n){return 4&e.type?new I1(n,e,hs(e,n)):null}class SS{}class P1{}class O1{resolveComponentFactory(n){throw Error(`No component factory found for ${So(n)}.`)}}class ym{static NULL=new O1}class ua{}let Ns=(()=>class e{destroyNode=null;static __NG_ELEMENT_ID__=()=>function vm(){const e=yt(),t=Ta(Bi().index,e);return(go(t)?t:e)[11]}()})(),F1=(()=>{class e{static \u0275prov=Nt({token:e,providedIn:"root",factory:()=>null})}return e})();function ES(e,n,t){let i=t?e.styles:null,r=t?e.classes:null,a=0;if(null!==n)for(let h=0;h<n.length;h++){const v=n[h];"number"==typeof v?a=v:1==a?r=Tu(r,v):2==a&&(i=Tu(i,v+": "+n[++h]+";"))}t?e.styles=i:e.stylesWithoutHost=i,t?e.classes=r:e.classesWithoutHost=r}class rN extends ym{ngModule;constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=Ai(n);return new N1(t,this.ngModule)}}function oN(e,n){const t=[];for(const i in e){if(!e.hasOwnProperty(i))continue;const r=e[i];if(void 0===r)continue;const a=Array.isArray(r),h=a?r[0]:r;t.push(n?{propName:h,templateName:i,isSignal:!!((a?r[1]:dh.None)&dh.SignalBased)}:{propName:h,templateName:i})}return t}class N1 extends P1{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;get inputs(){const n=this.componentDef,t=n.inputTransforms,i=oN(n.inputs,!0);if(null!==t)for(const r of i)t.hasOwnProperty(r.propName)&&(r.transform=t[r.propName]);return i}get outputs(){return oN(this.componentDef.outputs,!1)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function vA(e){return e.map(yA).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,i,r){const a=Xn(null);try{let h=(r=r||this.ngModule)instanceof Eo?r:r?.injector;h&&null!==this.componentDef.getStandaloneInjector&&(h=this.componentDef.getStandaloneInjector(h)||h);const v=h?new _o(n,h):n,C=v.get(ua,null);if(null===C)throw new ot(407,!1);const V={rendererFactory:C,sanitizer:v.get(F1,null),changeDetectionScheduler:v.get(st,null)},W=C.createRenderer(null,this.componentDef),X=this.componentDef.selectors[0][0]||"div",oe=i?function nS(e,n,t,i){const a=i.get(Ow,!1)||t===Sc.ShadowDom,h=e.selectRootElement(n,a);return function iS(e){v1(e)}(h),h}(W,i,this.componentDef.encapsulation,v):Pf(W,X,function Nq(e){const n=e.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(X));let he=512;this.componentDef.signals?he|=4096:this.componentDef.onPush||(he|=16);let se=null;null!==oe&&(se=null);const _e=F0(0,null,null,1,0,null,null,null,null,null,null),Se=o_(null,_e,null,he,null,null,V,W,v,null,se);Zu(Se);let $e,et,ut=null;try{const mt=this.componentDef;let qt,tn=null;mt.findHostDirectiveDefs?(qt=[],tn=new Map,mt.findHostDirectiveDefs(mt,qt,tn),qt.push(mt)):qt=[mt];const Rn=function Bq(e,n){const t=e[1];return e[25]=n,Lf(t,25,2,"#host",null)}(Se,oe);ut=function Vq(e,n,t,i,r,a,h){const v=r[1];!function Uq(e,n,t,i){for(const r of e)n.mergedAttrs=zp(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(ES(n,n.mergedAttrs,!0),null!==t&&YM(i,t,n))}(i,e,n,h);let C=null;null!==n&&(C=null);const P=a.rendererFactory.createRenderer(n,t),L=o_(r,hv(t),null,N0(t),r[e.index],e,a,P,null,null,C);return v.firstCreatePass&&x1(v,e,i.length-1),zf(r,L),r[e.index]=L}(Rn,oe,mt,qt,Se,V,W),et=zd(_e,25),oe&&function Hq(e,n,t,i){if(i)xc(e,t,["ng-version","19.0.6"]);else{const{attrs:r,classes:a}=function bA(e){const n=[],t=[];let i=1,r=2;for(;i<e.length;){let a=e[i];if("string"==typeof a)2===r?""!==a&&n.push(a,e[++i]):8===r&&t.push(a);else{if(!ld(r))break;r=a}i++}return{attrs:n,classes:t}}(n.selectors[0]);r&&xc(e,t,r),a&&a.length>0&&ZM(e,t,a.join(" "))}}(W,mt,oe,i),void 0!==t&&function $q(e,n,t){const i=e.projection=[];for(let r=0;r<n.length;r++){const a=t[r];i.push(null!=a&&a.length?Array.from(a):null)}}(et,this.ngContentSelectors,t),$e=function jq(e,n,t,i,r,a){const h=Bi(),v=r[1],C=Ps(h,r);lS(v,r,h,t,null,i);for(let L=0;L<t.length;L++)la(c(r,v,h.directiveStart+L,h),r);cS(v,r,h),C&&la(C,r);const P=c(r,v,h.directiveStart+h.componentOffset,h);if(e[8]=r[8]=P,null!==a)for(const L of a)L(P,n);return um(v,h,r),P}(ut,mt,qt,tn,Se,[Gq]),V0(_e,Se,null)}catch(mt){throw null!==ut&&Fb(ut),Fb(Se),mt}finally{Cg()}return new zq(this.componentType,$e,hs(et,Se),Se,et)}finally{Xn(a)}}}class zq extends SS{location;_rootLView;_tNode;instance;hostView;changeDetectorRef;componentType;previousInputValues=null;constructor(n,t,i,r,a){super(),this.location=i,this._rootLView=r,this._tNode=a,this.instance=t,this.hostView=this.changeDetectorRef=new yv(r,void 0,!1),this.componentType=n}setInput(n,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;const a=this._rootLView;C1(a[1],a,r,n,t),this.previousInputValues.set(n,t),f_(Ta(this._tNode.index,a),1)}}get injector(){return new F(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function Gq(){const e=Bi();Fr(yt()[1],e)}let ms=(()=>class e{static __NG_ELEMENT_ID__=qq})();function qq(){return lN(Bi(),yt())}const Wq=ms,sN=class extends Wq{_lContainer;_hostTNode;_hostLView;constructor(n,t,i){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=i}get element(){return hs(this._hostTNode,this._hostLView)}get injector(){return new F(this._hostTNode,this._hostLView)}get parentInjector(){const n=Hl(this._hostTNode,this._hostLView);if(Vp(n)){const t=jl(n,this._hostLView),i=eh(n);return new F(t[1].data[i+8],t)}return new F(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=aN(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,t,i){let r,a;"number"==typeof i?r=i:null!=i&&(r=i.index,a=i.injector);const v=n.createEmbeddedViewImpl(t||{},a,null);return this.insertImpl(v,r,fm(this._hostTNode,null)),v}createComponent(n,t,i,r,a){const h=n&&!function Od(e){return"function"==typeof e}(n);let v;if(h)v=t;else{const oe=t||{};v=oe.index,i=oe.injector,r=oe.projectableNodes,a=oe.environmentInjector||oe.ngModuleRef}const C=h?n:new N1(Ai(n)),P=i||this.parentInjector;if(!a&&null==C.ngModule){const he=(h?P:this.parentInjector).get(Eo,null);he&&(a=he)}Ai(C.componentType??{});const X=C.create(P,r,null,a);return this.insertImpl(X.hostView,v,fm(this._hostTNode,null)),X}insert(n,t){return this.insertImpl(n,t,!0)}insertImpl(n,t,i){const r=n._lView;if(function yw(e){return Io(e[3])}(r)){const v=this.indexOf(n);if(-1!==v)this.detach(v);else{const C=r[3],P=new sN(C,C[5],C[3]);P.detach(P.indexOf(n))}}const a=this._adjustIndex(t),h=this._lContainer;return Bf(h,r,a,i),n.attachToViewContainerRef(),pp(UA(h),a,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=aN(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),i=e_(this._lContainer,t);i&&(cl(UA(this._lContainer),t),t_(i[1],i))}detach(n){const t=this._adjustIndex(n,-1),i=e_(this._lContainer,t);return i&&null!=cl(UA(this._lContainer),t)?new yv(i):null}_adjustIndex(n,t=0){return n??this.length+t}};function aN(e){return e[8]}function UA(e){return e[8]||(e[8]=[])}function lN(e,n){let t;const i=n[e.index];return Io(i)?t=i:(t=hm(i,n,null,e),n[e.index]=t,zf(n,t)),cN(t,n,e,i),new sN(t,e,n)}let cN=function uN(e,n,t,i){if(e[7])return;let r;r=8&t.type?Ki(i):function Zq(e,n){const t=e[11],i=t.createComment(""),r=Ps(n,e);return lm(t,f1(t,r),i,function dA(e,n){return e.nextSibling(n)}(t,r),!1),i}(n,t),e[7]=r};class HA{queryList;matches=null;constructor(n){this.queryList=n}clone(){return new HA(this.queryList)}setDirty(){this.queryList.setDirty()}}class $A{queries;constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const i=null!==n.contentQueries?n.contentQueries[0]:t.length,r=[];for(let a=0;a<i;a++){const h=t.getByIndex(a);r.push(this.queries[h.indexInDeclarationView].clone())}return new $A(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==YA(n,t).matches&&this.queries[t].setDirty()}}class hN{flags;read;predicate;constructor(n,t,i=null){this.flags=t,this.read=i,this.predicate="string"==typeof n?function nW(e){return e.split(",").map(n=>n.trim())}(n):n}}class GA{queries;constructor(n=[]){this.queries=n}elementStart(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,a=this.getByIndex(i).embeddedTView(n,r);a&&(a.indexInDeclarationView=i,null!==t?t.push(a):t=[a])}return null!==t?new GA(t):null}template(n,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class qA{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(n,t=-1){this.metadata=n,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new qA(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1&~this.metadata.flags){const t=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const a=i[r];this.matchTNodeWithReadOption(n,t,Qq(t,a)),this.matchTNodeWithReadOption(n,t,s(t,n,a,!1,!1))}else i===Lo?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,s(t,n,i,!1,!1))}matchTNodeWithReadOption(n,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===In||r===ms||r===Lo&&4&t.type)this.addMatch(t.index,-2);else{const a=s(t,n,r,!1,!1);null!==a&&this.addMatch(t.index,a)}else this.addMatch(t.index,i)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function Qq(e,n){const t=e.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===n)return t[i+1];return null}function eW(e,n,t,i){return-1===t?function Jq(e,n){return 11&e.type?hs(e,n):4&e.type?vv(e,n):null}(n,e):-2===t?function tW(e,n,t){return t===In?hs(n,e):t===Lo?vv(n,e):t===ms?lN(n,e):void 0}(e,n,i):c(e,e[1],t,n)}function fN(e,n,t,i){const r=n[18].queries[i];if(null===r.matches){const a=e.data,h=t.matches,v=[];for(let C=0;null!==h&&C<h.length;C+=2){const P=h[C];v.push(P<0?null:eW(n,a[P],h[C+1],t.metadata.read))}r.matches=v}return r.matches}function WA(e,n,t,i){const r=e.queries.getByIndex(t),a=r.matches;if(null!==a){const h=fN(e,n,r,t);for(let v=0;v<a.length;v+=2){const C=a[v];if(C>0)i.push(h[v/2]);else{const P=a[v+1],L=n[-C];for(let V=10;V<L.length;V++){const W=L[V];W[16]===W[3]&&WA(W[1],W,P,i)}if(null!==L[9]){const V=L[9];for(let W=0;W<V.length;W++){const X=V[W];WA(X[1],X,P,i)}}}}}return i}function ZA(e,n){return e[18].queries[n].queryList}function pN(e,n,t){const i=new od(!(4&~t));return function Nf(e,n,t,i){const r=mS(n);r.push(t),e.firstCreatePass&&B0(e).push(i,r.length-1)}(e,n,i,i.destroy),(n[18]??=new $A).queries.push(new HA(i))-1}function gN(e,n,t,i){const r=fi();if(r.firstCreatePass){const a=Bi();_N(r,new hN(n,t,i),a.index),function iW(e,n){const t=e.contentQueries||(e.contentQueries=[]);n!==(t.length?t[t.length-1]:-1)&&t.push(e.queries.length-1,n)}(r,e),!(2&~t)&&(r.staticContentQueries=!0)}return pN(r,yt(),t)}function _N(e,n,t){null===e.queries&&(e.queries=new GA),e.queries.track(new qA(n,t))}function YA(e,n){return e.queries.getByIndex(n)}function yN(e,n){const t=e[1],i=YA(t,n);return i.crossesNgTemplate?WA(t,e,n,[]):fN(t,e,i,n)}function W0(e){return"function"==typeof e&&void 0!==e[xi]}function ha(e,n){Es("NgSignals");const t=function zh(e){const n=Object.create(xu);n.value=e;const t=()=>(ss(n),n.value);return t[xi]=n,t}(e),i=t[xi];return n?.equal&&(i.equal=n.equal),t.set=r=>Oe(i,r),t.update=r=>function Nc(e,n){$i()||Nh(),Oe(e,n(e.value))}(i,r),t.asReadonly=XA.bind(t),t}function XA(){const e=this[xi];if(void 0===e.readonlyFn){const n=()=>this();n[xi]=e,e.readonlyFn=n}return e.readonlyFn}function vN(e){return W0(e)&&"function"==typeof e.set}function KA(e,n,t){let i;const r=El(()=>{i._dirtyCounter();const a=function rW(e,n){const t=e._lView,i=e._queryIndex;if(void 0===t||void 0===i||4&t[2])return n?void 0:vr;const r=ZA(t,i),a=yN(t,i);return r.reset(a,gl),n?r.first:r._changesDetected||void 0===e._flatValue?e._flatValue=r.toArray():e._flatValue}(i,e);if(n&&void 0===a)throw new ot(-951,!1);return a});return i=r[xi],i._dirtyCounter=ha(0),i._flatValue=void 0,r}function TN(e,n){return function bN(e){return KA(!0,!1)}()}const sW=(TN.required=function oW(e,n){return function xN(e){return KA(!0,!0)}()},TN);class bm{}class AN{}class QA extends bm{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new rN(this);constructor(n,t,i,r=!0){super(),this.ngModuleType=n,this._parent=t;const a=Qr(n);this._bootstrapComponents=Wl(a.bootstrap),this._r3Injector=Be(n,t,[{provide:bm,useValue:this},{provide:ym,useValue:this.componentFactoryResolver},...i],So(n),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class JA extends AN{moduleType;constructor(n){super(),this.moduleType=n}create(n){return new QA(this.moduleType,n,[])}}class RN extends bm{injector;componentFactoryResolver=new rN(this);instance=null;constructor(n){super();const t=new tr([...n.providers,{provide:bm,useValue:this},{provide:ym,useValue:this.componentFactoryResolver}],n.parent||rf(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function IS(e,n,t=null){return new RN({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}let _W=(()=>{class e{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const i=tf(0,t.type),r=i.length>0?IS([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,r)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=Nt({token:e,providedIn:"environment",factory:()=>new e(un(Eo))})}return e})();function Ln(e){return Br(()=>{const n=ON(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===by.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:n.standalone?r=>r.get(_W).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Sc.Emulated,styles:e.styles||vr,_:null,schemas:e.schemas||null,tView:null,id:""};n.standalone&&Es("NgStandalone"),FN(t);const i=e.dependencies;return t.directiveDefs=kS(i,!1),t.pipeDefs=kS(i,!0),t.id=function xW(e){let n=0;const i=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,"function"==typeof e.consts?"":e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery];for(const a of i.join("|"))n=Math.imul(31,n)+a.charCodeAt(0)|0;return n+=2147483648,"c"+n}(t),t})}function yW(e){return Ai(e)||qo(e)}function vW(e){return null!==e}function ci(e){return Br(()=>({type:e.type,bootstrap:e.bootstrap||vr,declarations:e.declarations||vr,imports:e.imports||vr,exports:e.exports||vr,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function PN(e,n){if(null==e)return ls;const t={};for(const i in e)if(e.hasOwnProperty(i)){const r=e[i];let a,h,v=dh.None;Array.isArray(r)?(v=r[0],a=r[1],h=r[2]??a):(a=r,h=r),n?(t[a]=v!==dh.None?[i,v]:i,n[a]=h):t[a]=i}return t}function Bt(e){return Br(()=>{const n=ON(e);return FN(n),n})}function Xl(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:e.standalone??!0,onDestroy:e.type.prototype.ngOnDestroy||null}}function ON(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||ls,exportAs:e.exportAs||null,standalone:e.standalone??!0,signals:!0===e.signals,selectors:e.selectors||vr,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:PN(e.inputs,n),outputs:PN(e.outputs),debugInfo:null}}function FN(e){e.features?.forEach(n=>n(e))}function kS(e,n){if(!e)return null;const t=n?Qo:yW;return()=>("function"==typeof e?e():e).map(i=>t(i)).filter(vW)}function Gn(e){let n=function LN(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const i=[e];for(;n;){let r;if(Nl(e))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new ot(903,!1);r=n.\u0275dir}if(r){if(t){i.push(r);const h=e;h.inputs=AS(e.inputs),h.inputTransforms=AS(e.inputTransforms),h.declaredInputs=AS(e.declaredInputs),h.outputs=AS(e.outputs);const v=r.hostBindings;v&&SW(e,v);const C=r.viewQuery,P=r.contentQueries;if(C&&TW(e,C),P&&MW(e,P),wW(e,r),hb(e.outputs,r.outputs),Nl(r)&&r.data.animation){const L=e.data;L.animation=(L.animation||[]).concat(r.data.animation)}}const a=r.features;if(a)for(let h=0;h<a.length;h++){const v=a[h];v&&v.ngInherit&&v(e),v===Gn&&(t=!1)}}n=Object.getPrototypeOf(n)}!function CW(e){let n=0,t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.hostVars=n+=r.hostVars,r.hostAttrs=zp(r.hostAttrs,t=zp(t,r.hostAttrs))}}(i)}function wW(e,n){for(const t in n.inputs){if(!n.inputs.hasOwnProperty(t)||e.inputs.hasOwnProperty(t))continue;const i=n.inputs[t];if(void 0!==i&&(e.inputs[t]=i,e.declaredInputs[t]=n.declaredInputs[t],null!==n.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!n.inputTransforms.hasOwnProperty(r))continue;e.inputTransforms??={},e.inputTransforms[r]=n.inputTransforms[r]}}}function AS(e){return e===ls?{}:e===vr?[]:e}function TW(e,n){const t=e.viewQuery;e.viewQuery=t?(i,r)=>{n(i,r),t(i,r)}:n}function MW(e,n){const t=e.contentQueries;e.contentQueries=t?(i,r,a)=>{n(i,r,a),t(i,r,a)}:n}function SW(e,n){const t=e.hostBindings;e.hostBindings=t?(i,r)=>{n(i,r),t(i,r)}:n}function jr(e){const n=e.inputConfig,t={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];Array.isArray(r)&&r[3]&&(t[i]=r[3])}e.inputTransforms=t}function RS(e){return!!tR(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function tR(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Hf(e,n,t){return e[n]=t}function gs(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function V1(e,n,t,i,r,a,h,v,C,P){const L=t+25,V=n.firstCreatePass?function FW(e,n,t,i,r,a,h,v,C){const P=n.consts,L=Lf(n,e,4,h||null,v||null);b1(n,t,L,ws(P,C)),Fr(n,L);const V=L.tView=F0(2,L,i,r,a,n.directiveRegistry,n.pipeRegistry,null,n.schemas,P,null);return null!==n.queries&&(n.queries.template(n,L),V.queries=n.queries.embeddedTView(L)),L}(L,n,e,i,r,a,h,v,C):n.data[L];ia(V,!1);const W=UN(n,e,V,t);$d()&&Of(n,e,W,V),la(W,e);const X=hm(W,e,W,V);return e[L]=X,zf(e,X),xp(V)&&O0(n,e,V),null!=C&&uv(e,V,P),V}function an(e,n,t,i,r,a,h,v){const C=yt(),P=fi();return V1(C,P,e,n,t,i,r,ws(P.consts,a),h,v),an}let UN=function jN(e,n,t,i){return Wo(!0),n[11].createComment("")};let YN=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const tz=new ct(""),zS=new ct("");let aR,oR=(()=>{class e{_ngZone;registry;_isZoneStable=!0;_callbacks=[];taskTrackingZone=null;constructor(t,i,r){this._ngZone=t,this.registry=i,aR||(function x7(e){aR=e}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ht.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}isStable(){return this._isZoneStable&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb()}});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let a=-1;i&&i>0&&(a=setTimeout(()=>{this._callbacks=this._callbacks.filter(h=>h.timeoutId!==a),t()},i)),this._callbacks.push({doneCb:t,timeoutId:a,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}static \u0275fac=function(i){return new(i||e)(un(Ht),un(sR),un(zS))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})(),sR=(()=>{class e{_applications=new Map;registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return aR?.findTestabilityInTree(this,t,i)??null}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();function j1(e){return!!e&&"function"==typeof e.then}function nz(e){return!!e&&"function"==typeof e.subscribe}const BS=new ct("");let iz=(()=>{class e{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,i)=>{this.resolve=t,this.reject=i});appInits=re(BS,{optional:!0})??[];injector=re(Ye);constructor(){}runInitializers(){if(this.initialized)return;const t=[];for(const r of this.appInits){const a=As(this.injector,r);if(j1(a))t.push(a);else if(nz(a)){const h=new Promise((v,C)=>{a.subscribe({complete:v,error:C})});t.push(h)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),lR=(()=>{class e{static \u0275prov=Nt({token:e,providedIn:"root",factory:()=>new rz})}return e})();class rz{queuedEffectCount=0;queues=new Map;schedule(n){this.enqueue(n)}remove(n){const i=this.queues.get(n.zone);i.has(n)&&(i.delete(n),this.queuedEffectCount--)}enqueue(n){const t=n.zone;this.queues.has(t)||this.queues.set(t,new Set);const i=this.queues.get(t);i.has(n)||(this.queuedEffectCount++,i.add(n))}flush(){for(;this.queuedEffectCount>0;)for(const[n,t]of this.queues)null===n?this.flushQueue(t):n.run(()=>this.flushQueue(t))}flushQueue(n){for(const t of n)n.delete(t),this.queuedEffectCount--,t.run()}}const H1=new ct("");function sz(e,n){return Array.isArray(n)?n.reduce(sz,e):{...e,...n}}let Wa=(()=>{class e{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=re(Fo);afterRenderManager=re(Kd);zonelessEnabled=re(Pt);rootEffectScheduler=re(lR);dirtyFlags=0;deferredDirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new Ie;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=re(hn).hasPendingTasks.pipe($t(t=>!t));constructor(){re(ky,{optional:!0})}whenStable(){let t;return new Promise(i=>{t=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{t.unsubscribe()})}_injector=re(Eo);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,i){const r=t instanceof P1;if(!this._injector.get(iz).done)throw!r&&function Rl(e){const n=Ai(e)||qo(e)||Qo(e);return null!==n&&n.standalone}(t),new ot(405,!1);let h;h=r?t:this._injector.get(ym).resolveComponentFactory(t),this.componentTypes.push(h.componentType);const v=function w7(e){return e.isBoundToModule}(h)?void 0:this._injector.get(bm),P=h.create(Ye.NULL,[],i||h.selector,v),L=P.location.nativeElement,V=P.injector.get(tz,null);return V?.registerApplication(L),P.onDestroy(()=>{this.detachView(P.hostView),VS(this.components,P),V?.unregisterApplication(L)}),this._loadComponent(P),P}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick=()=>{if(null!==this.tracingSnapshot){const i=this.tracingSnapshot;return this.tracingSnapshot=null,i.run(Iy.CHANGE_DETECTION,this._tick),void i.dispose()}if(this._runningTick)throw new ot(101,!1);const t=Xn(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,Xn(t),this.afterTick.next()}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(ua,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let t=0;for(;0!==this.dirtyFlags&&t++<10;)this.synchronizeOnce()}synchronizeOnce(){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),7&this.dirtyFlags){const t=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i,notifyErrorHandler:r}of this.allViews)M7(i,r,t,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:t})=>Mp(t))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;VS(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(H1,[]).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>VS(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ot(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function VS(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function M7(e,n,t,i){(t||Mp(e))&&Vf(e,n,t&&!i?0:1)}function ui(e,n,t,i){const r=yt();return gs(r,ra(),n)&&(fi(),tu(ni(),r,e,n,t,i)),ui}function Q0(e,n,t,i){return gs(e,ra(),t)?n+hi(t)+i:Vi}function J0(e,n,t,i,r,a){const v=function Mv(e,n,t,i){const r=gs(e,n,t);return gs(e,n+1,i)||r}(e,function Bl(){return wi.lFrame.bindingIndex}(),t,r);return Vl(2),v?n+hi(t)+i+hi(r)+a:Vi}function US(e,n){return e<<17|n<<2}function y_(e){return e>>17&32767}function hR(e){return 2|e}function Ev(e){return(131068&e)>>2}function fR(e,n){return-131069&e|n<<2}function pR(e){return 1|e}function xz(e,n,t,i){const r=e[t+1],a=null===n;let h=i?y_(r):Ev(r),v=!1;for(;0!==h&&(!1===v||a);){const P=e[h+1];c9(e[h],n)&&(v=!0,e[h+1]=i?pR(P):hR(P)),h=i?y_(P):Ev(P)}v&&(e[t+1]=i?hR(r):pR(r))}function c9(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&Lu(e,n)>=0}const fa={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function wz(e){return e.substring(fa.key,fa.keyEnd)}function Cz(e,n){const t=fa.textEnd;return t===n?-1:(n=fa.keyEnd=function f9(e,n,t){for(;n<t&&e.charCodeAt(n)>32;)n++;return n}(e,fa.key=n,t),sx(e,n,t))}function sx(e,n,t){for(;n<t&&e.charCodeAt(n)<=32;)n++;return n}function At(e,n,t){const i=yt();return gs(i,ra(),n)&&yl(fi(),ni(),i,e,n,i[11],t,!1),At}function mR(e,n,t,i,r){const h=r?"class":"style";C1(e,t,n.inputs[h],h,i)}function Ia(e,n,t){return _h(e,n,t,!1),Ia}function Ti(e,n){return _h(e,n,null,!0),Ti}function ka(e){yh(w9,Gf,e,!0)}function Gf(e,n){for(let t=function u9(e){return function Mz(e){fa.key=0,fa.keyEnd=0,fa.value=0,fa.valueEnd=0,fa.textEnd=e.length}(e),Cz(e,sx(e,0,fa.textEnd))}(n);t>=0;t=Cz(n,t))Ba(e,wz(n),!0)}function _h(e,n,t,i){const r=yt(),a=fi(),h=Vl(2);a.firstUpdatePass&&Iz(a,e,h,i),n!==Vi&&gs(r,h,n)&&Az(a,a.data[ts()],r,r[11],e,r[h+1]=function T9(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=So(_l(e)))),e}(n,t),i,h)}function yh(e,n,t,i){const r=fi(),a=Vl(2);r.firstUpdatePass&&Iz(r,null,a,i);const h=yt();if(t!==Vi&&gs(h,a,t)){const v=r.data[ts()];if(Pz(v,i)&&!Dz(r,a)){let C=i?v.classesWithoutHost:v.stylesWithoutHost;null!==C&&(t=Tu(C,t||"")),mR(r,v,h,t,i)}else!function C9(e,n,t,i,r,a,h,v){r===Vi&&(r=vr);let C=0,P=0,L=0<r.length?r[0]:null,V=0<a.length?a[0]:null;for(;null!==L||null!==V;){const W=C<r.length?r[C+1]:void 0,X=P<a.length?a[P+1]:void 0;let he,oe=null;L===V?(C+=2,P+=2,W!==X&&(oe=V,he=X)):null===V||null!==L&&L<V?(C+=2,oe=L):(P+=2,oe=V,he=X),null!==oe&&Az(e,n,t,i,oe,he,h,v),L=C<r.length?r[C]:null,V=P<a.length?a[P]:null}}(r,v,h,h[11],h[a+1],h[a+1]=function x9(e,n,t){if(null==t||""===t)return vr;const i=[],r=_l(t);if(Array.isArray(r))for(let a=0;a<r.length;a++)e(i,r[a],!0);else if("object"==typeof r)for(const a in r)r.hasOwnProperty(a)&&e(i,a,r[a]);else"string"==typeof r&&n(i,r);return i}(e,n,t),i,a)}}function Dz(e,n){return n>=e.expandoStartIndex}function Iz(e,n,t,i){const r=e.data;if(null===r[t+1]){const a=r[ts()],h=Dz(e,t);Pz(a,i)&&null===n&&!h&&(n=!1),n=function _9(e,n,t,i){const r=xg(e);let a=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(t=G1(t=gR(null,e,n,t,i),n.attrs,i),a=null);else{const h=n.directiveStylingLast;if(-1===h||e[h]!==r)if(t=gR(r,e,n,t,i),null===a){let C=function y9(e,n,t){const i=t?n.classBindings:n.styleBindings;if(0!==Ev(i))return e[y_(i)]}(e,n,i);void 0!==C&&Array.isArray(C)&&(C=gR(null,e,n,C[1],i),C=G1(C,n.attrs,i),function v9(e,n,t,i){e[y_(t?n.classBindings:n.styleBindings)]=i}(e,n,i,C))}else a=function b9(e,n,t){let i;const r=n.directiveEnd;for(let a=1+n.directiveStylingLast;a<r;a++)i=G1(i,e[a].hostAttrs,t);return G1(i,n.attrs,t)}(e,n,i)}return void 0!==a&&(i?n.residualClasses=a:n.residualStyles=a),t}(r,a,n,i),function a9(e,n,t,i,r,a){let h=a?n.classBindings:n.styleBindings,v=y_(h),C=Ev(h);e[i]=t;let L,P=!1;if(Array.isArray(t)?(L=t[1],(null===L||Lu(t,L)>0)&&(P=!0)):L=t,r)if(0!==C){const W=y_(e[v+1]);e[i+1]=US(W,v),0!==W&&(e[W+1]=fR(e[W+1],i)),e[v+1]=function o9(e,n){return 131071&e|n<<17}(e[v+1],i)}else e[i+1]=US(v,0),0!==v&&(e[v+1]=fR(e[v+1],i)),v=i;else e[i+1]=US(C,0),0===v?v=i:e[C+1]=fR(e[C+1],i),C=i;P&&(e[i+1]=hR(e[i+1])),xz(e,L,i,!0),xz(e,L,i,!1),function l9(e,n,t,i,r){const a=r?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof n&&Lu(a,n)>=0&&(t[i+1]=pR(t[i+1]))}(n,L,e,i,a),h=US(v,C),a?n.classBindings=h:n.styleBindings=h}(r,a,n,t,h,i)}}function gR(e,n,t,i,r){let a=null;const h=t.directiveEnd;let v=t.directiveStylingLast;for(-1===v?v=t.directiveStart:v++;v<h&&(a=n[v],i=G1(i,a.hostAttrs,r),a!==e);)v++;return null!==e&&(t.directiveStylingLast=v),i}function G1(e,n,t){const i=t?1:2;let r=-1;if(null!==n)for(let a=0;a<n.length;a++){const h=n[a];"number"==typeof h?r=h:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Ba(e,h,!!t||n[++a]))}return void 0===e?null:e}function w9(e,n,t){const i=String(n);""!==i&&!i.includes(" ")&&Ba(e,i,t)}function Az(e,n,t,i,r,a,h,v){if(!(3&n.type))return;const C=e.data,P=C[v+1],L=function s9(e){return!(1&~e)}(P)?Rz(C,n,t,r,Ev(P),h):void 0;jS(L)||(jS(a)||function r9(e){return!(2&~e)}(P)&&(a=Rz(C,null,t,r,v,h)),function WM(e,n,t,i,r){if(n)r?e.addClass(t,i):e.removeClass(t,i);else{let a=-1===i.indexOf("-")?void 0:uh.DashCase;null==r?e.removeStyle(t,i,a):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),a|=uh.Important),e.setStyle(t,i,r,a))}}(i,h,Ge(ts(),t),r,a))}function Rz(e,n,t,i,r,a){const h=null===n;let v;for(;r>0;){const C=e[r],P=Array.isArray(C),L=P?C[1]:C,V=null===L;let W=t[r+1];W===Vi&&(W=V?vr:void 0);let X=V?gp(W,i):L===i?W:void 0;if(P&&!jS(X)&&(X=gp(C,i)),jS(X)&&(v=X,h))return v;const oe=e[r+1];r=h?y_(oe):Ev(oe)}if(null!==n){let C=a?n.residualClasses:n.residualStyles;null!=C&&(v=gp(C,i))}return v}function jS(e){return void 0!==e}function Pz(e,n){return!!(e.flags&(n?8:16))}class O9{destroy(n){}updateValue(n,t){}swap(n,t){const i=Math.min(n,t),r=Math.max(n,t),a=this.detach(r);if(r-i>1){const h=this.detach(i);this.attach(i,a),this.attach(r,h)}else this.attach(i,a)}move(n,t){this.attach(t,this.detach(n))}}function _R(e,n,t,i,r){return e===t&&Object.is(n,i)?1:Object.is(r(e,n),r(t,i))?-1:0}function yR(e,n,t,i){return!(void 0===n||!n.has(i)||(e.attach(t,n.get(i)),n.delete(i),0))}function Fz(e,n,t,i,r){if(yR(e,n,i,t(i,r)))e.updateValue(i,r);else{const a=e.create(i,r);e.attach(i,a)}}function Lz(e,n,t,i){const r=new Set;for(let a=n;a<=t;a++)r.add(i(a,e.at(a)));return r}class Nz{kvMap=new Map;_vMap=void 0;has(n){return this.kvMap.has(n)}delete(n){if(!this.has(n))return!1;const t=this.kvMap.get(n);return void 0!==this._vMap&&this._vMap.has(t)?(this.kvMap.set(n,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(n),!0}get(n){return this.kvMap.get(n)}set(n,t){if(this.kvMap.has(n)){let i=this.kvMap.get(n);void 0===this._vMap&&(this._vMap=new Map);const r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,t)}else this.kvMap.set(n,t)}forEach(n){for(let[t,i]of this.kvMap)if(n(i,t),void 0!==this._vMap){const r=this._vMap;for(;r.has(i);)i=r.get(i),n(i,t)}}}function Mr(e,n){Es("NgControlFlow");const t=yt(),i=ra(),r=t[i]!==Vi?t[i]:-1,a=-1!==r?HS(t,25+r):void 0;if(gs(t,i,e)){const v=Xn(null);try{if(void 0!==a&&pv(a,0),-1!==e){const C=25+e,P=HS(t,C),L=vR(t[1],C),V=null;Bf(P,c_(t,L,n,{dehydratedView:V}),0,fm(L,V))}}finally{Xn(v)}}else if(void 0!==a){const v=T1(a,0);void 0!==v&&(v[8]=n)}}class L9{lContainer;$implicit;$index;constructor(n,t,i){this.lContainer=n,this.$implicit=t,this.$index=i}get $count(){return this.lContainer.length-10}}function zz(e,n){return n}class z9{hasEmptyBlock;trackByFn;liveCollection;constructor(n,t,i){this.hasEmptyBlock=n,this.trackByFn=t,this.liveCollection=i}}class B9 extends O9{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(n,t,i){super(),this.lContainer=n,this.hostLView=t,this.templateTNode=i}get length(){return this.lContainer.length-10}at(n){return this.getLView(n)[8].$implicit}attach(n,t){const i=t[6];this.needsIndexUpdate||=n!==this.length,Bf(this.lContainer,t,n,fm(this.templateTNode,i))}detach(n){return this.needsIndexUpdate||=n!==this.length-1,function V9(e,n){return e_(e,n)}(this.lContainer,n)}create(n,t){const r=c_(this.hostLView,this.templateTNode,new L9(this.lContainer,t,n),{dehydratedView:null});return this.operationsCounter?.recordCreate(),r}destroy(n){t_(n[1],n),this.operationsCounter?.recordDestroy()}updateValue(n,t){this.getLView(n)[8].$implicit=t}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let n=0;n<this.length;n++)this.getLView(n)[8].$index=n}getLView(n){return function U9(e,n){return T1(e,n)}(this.lContainer,n)}}function HS(e,n){return e[n]}function vR(e,n){return zd(e,n)}function Fe(e,n,t,i){const r=yt(),a=fi(),h=25+e,v=r[11],C=a.firstCreatePass?function j9(e,n,t,i,r,a){const h=n.consts,C=Lf(n,e,2,i,ws(h,r));return b1(n,t,C,ws(h,a)),null!==C.attrs&&ES(C,C.attrs,!1),null!==C.mergedAttrs&&ES(C,C.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,C),C}(h,a,r,n,t,i):a.data[h],P=Uz(a,r,C,v,n,e);r[h]=P;const L=xp(C);return ia(C,!0),YM(v,P,C),!function Y0(e){return!(32&~e.flags)}(C)&&$d()&&Of(a,r,P,C),0===function Ri(){return wi.lFrame.elementDepthCount}()&&la(P,r),function Sp(){wi.lFrame.elementDepthCount++}(),L&&(O0(a,r,C),um(a,C,r)),null!==i&&uv(r,C),Fe}function Ue(){let e=Bi();Ep()?Dp():(e=e.parent,ia(e,!1));const n=e;(function pl(e){return wi.skipHydrationRootTNode===e})(n)&&function Hd(){wi.skipHydrationRootTNode=null}(),function Jc(){wi.lFrame.elementDepthCount--}();const t=fi();return t.firstCreatePass&&(Fr(t,e),df(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function id(e){return!!(8&e.flags)}(n)&&mR(t,n,yt(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Ul(e){return!!(16&e.flags)}(n)&&mR(t,n,yt(),n.stylesWithoutHost,!1),Ue}function _n(e,n,t,i){return Fe(e,n,t,i),Ue(),_n}let Uz=(e,n,t,i,r,a)=>(Wo(!0),Pf(i,r,function Tg(){return wi.lFrame.currentNamespace}()));function co(e,n,t){const i=yt(),r=fi(),a=e+25,h=r.firstCreatePass?function G9(e,n,t,i,r){const a=n.consts,h=ws(a,i),v=Lf(n,e,8,"ng-container",h);return null!==h&&ES(v,h,!0),b1(n,t,v,ws(a,r)),null!==n.queries&&n.queries.elementStart(n,v),v}(a,r,i,n,t):r.data[a];ia(h,!0);const v=jz(r,i,h,e);return i[a]=v,$d()&&Of(r,i,v,h),la(v,i),xp(h)&&(O0(r,i,h),um(r,h,i)),null!=t&&uv(i,h),co}function uo(){let e=Bi();const n=fi();return Ep()?Dp():(e=e.parent,ia(e,!1)),n.firstCreatePass&&(Fr(n,e),df(e)&&n.queries.elementEnd(e)),uo}function zs(e,n,t){return co(e,n,t),uo(),zs}let jz=(e,n,t,i)=>(Wo(!0),C0(n[11],""));function Is(){return yt()}function ax(e,n,t){const i=yt();return gs(i,ra(),n)&&yl(fi(),ni(),i,e,n,i[11],t,!0),ax}function bR(e,n,t){const i=yt();if(gs(i,ra(),n)){const a=fi(),h=ni();yl(a,h,i,e,n,Dc(xg(a.data),h,i),t,!0)}return bR}const Dv=void 0;var Y9=["en",[["a","p"],["AM","PM"],Dv],[["AM","PM"],Dv,Dv],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Dv,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Dv,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Dv,"{1} 'at' {0}",Dv],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Z9(e){const t=Math.floor(Math.abs(e)),i=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let lx={};function Kl(e){const n=function X9(e){return e.toLowerCase().replace(/_/g,"-")}(e);let t=$z(n);if(t)return t;const i=n.split("-")[0];if(t=$z(i),t)return t;if("en"===i)return Y9;throw new ot(701,!1)}function $z(e){return e in lx||(lx[e]=Rr.ng&&Rr.ng.common&&Rr.ng.common.locales&&Rr.ng.common.locales[e]),lx[e]}var Ro=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(Ro||{});const $S="en-US";let Gz=$S;function Nn(e,n,t,i){const r=yt(),a=fi(),h=Bi();return CR(a,r,r[11],h,e,n,i),Nn}function CR(e,n,t,i,r,a,h){const v=xp(i),P=e.firstCreatePass&&B0(e),L=n[8],V=mS(n);let W=!0;if(3&i.type||h){const he=Ps(i,n),se=h?h(he):he,_e=V.length,Se=h?et=>h(Ki(et[i.index])):i.index;let $e=null;if(!h&&v&&($e=function BZ(e,n,t,i){const r=e.cleanup;if(null!=r)for(let a=0;a<r.length-1;a+=2){const h=r[a];if(h===t&&r[a+1]===i){const v=n[7],C=r[a+2];return v.length>C?v[C]:null}"string"==typeof h&&(a+=2)}return null}(e,n,r,i.index)),null!==$e)($e.__ngLastListenerFn__||$e).__ngNextListenerFn__=a,$e.__ngLastListenerFn__=a,W=!1;else{a=h3(i,n,L,a);const et=t.listen(se,r,a);V.push(a,et),P&&P.push(r,Se,_e,_e+1)}}else a=h3(i,n,L,a);const X=i.outputs;let oe;if(W&&null!==X&&(oe=X[r])){const he=oe.length;if(he)for(let se=0;se<he;se+=2){const ut=n[oe[se]][oe[se+1]].subscribe(a),mt=V.length;V.push(a,ut),P&&P.push(r,i.index,mt,-(mt+1))}}}function u3(e,n,t,i){const r=Xn(null);try{return!1!==t(i)}catch(a){return l_(e,a),!1}finally{Xn(r)}}function h3(e,n,t,i){return function r(a){if(a===Function)return i;f_(e.componentOffset>-1?Ta(e.index,n):n,5);let v=u3(n,0,i,a),C=r.__ngNextListenerFn__;for(;C;)v=u3(n,0,C,a)&&v,C=C.__ngNextListenerFn__;return v}}function cn(e=1){return function kb(e){return(wi.lFrame.contextLView=function $u(e,n){for(;e>0;)n=n[14],e--;return n}(e,wi.lFrame.contextLView))[8]}(e)}function VZ(e,n){let t=null;const i=function k0(e){const n=e.attrs;if(null!=n){const t=n.indexOf(5);if(!(1&t))return n[t+1]}return null}(e);for(let r=0;r<n.length;r++){const a=n[r];if("*"!==a){if(null===i?KM(e,a,!0):QM(i,a))return r}else t=r}return t}function zo(e){const n=yt()[15][5];if(!n.projection){const i=n.projection=function qc(e,n){const t=[];for(let i=0;i<e;i++)t.push(n);return t}(e?e.length:1,null),r=i.slice();let a=n.child;for(;null!==a;){if(128!==a.type){const h=e?VZ(a,e):0;null!==h&&(r[h]?r[h].projectionNext=a:i[h]=a,r[h]=a)}a=a.next}}}function ai(e,n=0,t,i,r,a){const h=yt(),v=fi(),C=i?e+1:null;null!==C&&V1(h,v,C,i,r,a,null,t);const P=Lf(v,25+e,16,null,t||null);null===P.projection&&(P.projection=n),Dp();const V=!h[6]||fl();null===h[15][5].projection[P.projection]&&null!==C?function UZ(e,n,t){const i=25+t,r=n.data[i],a=e[i];Bf(a,c_(e,r,void 0,{dehydratedView:null}),0,fm(r,null))}(h,v,C):V&&32&~P.flags&&function r_(e,n,t){m1(n[11],0,n,t,am(e,t,n),p1(t.parent||n[5],t,n))}(v,h,P)}function bo(e,n,t,i){gN(e,n,t,i)}function zr(e,n,t){!function mN(e,n,t){const i=fi();return i.firstCreatePass&&(_N(i,new hN(e,n,t),-1),!(2&~n)&&(i.staticViewQueries=!0)),pN(i,yt(),n)}(e,n,t)}function ri(e){const n=yt(),t=fi(),i=wg();kp(i+1);const r=YA(t,i);if(e.dirty&&function Db(e){return!(4&~e[2])}(n)===!(2&~r.metadata.flags)){if(null===r.matches)e.reset([]);else{const a=yN(n,i);e.reset(a,gl),e.notifyOnChanges()}return!0}return!1}function oi(){return ZA(yt(),wg())}function w3(e,n,t,i,r){!function CN(e,n){const t=e[xi];t._lView=yt(),t._queryIndex=n,t._queryList=ZA(t._lView,n),t._queryList.onDirty(()=>t._dirtyCounter.update(i=>i+1))}(n,gN(e,t,i,r))}function Za(e){return Bd(function es(){return wi.lFrame.contextLView}(),25+e)}function gt(e,n=""){const t=yt(),i=fi(),r=e+25,a=i.firstCreatePass?Lf(i,r,1,n,null):i.data[r],h=P3(i,t,a,n,e);t[r]=h,$d()&&Of(i,t,h,a),ia(a,!1)}let P3=(e,n,t,i,r)=>(Wo(!0),function hh(e,n){return e.createText(n)}(n[11],i));function br(e){return Sr("",e,""),br}function Sr(e,n,t){const i=yt(),r=Q0(i,e,n,t);return r!==Vi&&Ds(i,ts(),r),Sr}function cx(e,n,t,i,r){const a=yt(),h=J0(a,e,n,t,i,r);return h!==Vi&&Ds(a,ts(),h),cx}function ZS(e,n,t){vN(n)&&(n=n());const i=yt();return gs(i,ra(),n)&&yl(fi(),ni(),i,e,n,i[11],t,!1),ZS}function SR(e,n){const t=vN(e);return t&&e.set(n),t}function YS(e,n){const t=yt(),i=fi(),r=Bi();return CR(i,t,t[11],r,e,n),YS}function ER(e,n,t,i,r){if(e=qn(e),Array.isArray(e))for(let a=0;a<e.length;a++)ER(e[a],n,t,i,r);else{const a=fi(),h=yt(),v=Bi();let C=Zc(e)?e:qn(e.provide);const P=cg(e),L=1048575&v.providerIndexes,V=v.directiveStart,W=v.providerIndexes>>20;if(Zc(e)||!e.multi){const X=new Fp(P,r,Rt),oe=IR(C,n,r?L:L+W,V);-1===oe?($l(Up(v,h),a,C),DR(a,e,n.length),n.push(C),v.directiveStart++,v.directiveEnd++,r&&(v.providerIndexes+=1048576),t.push(X),h.push(X)):(t[oe]=X,h[oe]=X)}else{const X=IR(C,n,L+W,V),oe=IR(C,n,L,L+W),se=oe>=0&&t[oe];if(r&&!se||!r&&!(X>=0&&t[X])){$l(Up(v,h),a,C);const _e=function oY(e,n,t,i,r){const a=new Fp(e,t,Rt);return a.multi=[],a.index=n,a.componentProviders=0,H3(a,r,i&&!t),a}(r?rY:iY,t.length,r,i,P);!r&&se&&(t[oe].providerFactory=_e),DR(a,e,n.length,0),n.push(C),v.directiveStart++,v.directiveEnd++,r&&(v.providerIndexes+=1048576),t.push(_e),h.push(_e)}else DR(a,e,X>-1?X:oe,H3(t[r?oe:X],P,!r&&i));!r&&i&&se&&t[oe].componentProviders++}}}function DR(e,n,t,i){const r=Zc(n),a=function Ad(e){return!!e.useClass}(n);if(r||a){const C=(a?qn(n.useClass):n).prototype.ngOnDestroy;if(C){const P=e.destroyHooks||(e.destroyHooks=[]);if(!r&&n.multi){const L=P.indexOf(t);-1===L?P.push(t,[i,C]):P[L+1].push(i,C)}else P.push(t,C)}}}function H3(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function IR(e,n,t,i){for(let r=t;r<i;r++)if(n[r]===e)return r;return-1}function iY(e,n,t,i){return kR(this.multi,[])}function rY(e,n,t,i){const r=this.multi;let a;if(this.providerFactory){const h=this.providerFactory.componentProviders,v=c(t,t[1],this.providerFactory.index,i);a=v.slice(0,h),kR(r,a);for(let C=h;C<v.length;C++)a.push(v[C])}else a=[],kR(r,a);return a}function kR(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function Jn(e,n=[]){return t=>{t.providersResolver=(i,r)=>function nY(e,n,t){const i=fi();if(i.firstCreatePass){const r=Nl(e);ER(t,i.data,i.blueprint,r,!0),ER(n,i.data,i.blueprint,r,!1)}}(i,r?r(e):e,n)}}function KS(e,n,t){const i=Ts()+e,r=yt();return r[i]===Vi?Hf(r,i,t?n.call(t):n()):function B1(e,n){return e[n]}(r,i)}function xm(e,n,t,i){return G3(yt(),Ts(),e,n,t,i)}function G3(e,n,t,i,r,a){const h=n+t;return gs(e,h,r)?Hf(e,h+1,a?i.call(a,r):i(r)):function K1(e,n){const t=e[n];return t===Vi?void 0:t}(e,h+1)}function Iv(e,n){const t=fi();let i;const r=e+25;t.firstCreatePass?(i=function _Y(e,n){if(n)for(let t=n.length-1;t>=0;t--){const i=n[t];if(e===i.name)return i}}(n,t.pipeRegistry),t.data[r]=i,i.onDestroy&&(t.destroyHooks??=[]).push(r,i.onDestroy)):i=t.data[r];const a=i.factory||(i.factory=fc(i.type)),v=ba(Rt);try{const C=sa(!1),P=a();return sa(C),function MR(e,n,t,i){t>=e.data.length&&(e.data[t]=null,e.blueprint[t]=null),n[t]=i}(t,yt(),r,P),P}finally{ba(v)}}function kv(e,n,t){const i=e+25,r=yt(),a=Bd(r,i);return function Q1(e,n){return e[1].data[n].pure}(r,i)?G3(r,Ts(),n,a.transform,t,a):a.transform(t)}function wm(e,n){return vv(e,n)}class ZY{ngModuleFactory;componentFactories;constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let uB=(()=>{class e{compileModuleSync(t){return new JA(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),a=Wl(Qr(t).declarations).reduce((h,v)=>{const C=Ai(v);return C&&h.push(new N1(C)),h},[]);return new ZY(i,a)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),KY=(()=>{class e{zone=re(Ht);changeDetectionScheduler=re(st);applicationRef=re(Wa);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function LR({ngZoneFactory:e,ignoreChangesOutsideZone:n,scheduleInRootZone:t}){return e??=()=>new Ht({...NR(),scheduleInRootZone:t}),[{provide:Ht,useFactory:e},{provide:dl,multi:!0,useFactory:()=>{const i=re(KY,{optional:!0});return()=>i.initialize()}},{provide:dl,multi:!0,useFactory:()=>{const i=re(JY);return()=>{i.initialize()}}},!0===n?{provide:kt,useValue:!0}:[],{provide:Gt,useValue:t??dt}]}function NR(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}let JY=(()=>{class e{subscription=new Ni;initialized=!1;zone=re(Ht);pendingTasks=re(hn);initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Ht.assertNotInAngularZone(),queueMicrotask(()=>{null!==t&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Ht.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),eC=(()=>{class e{appRef=re(Wa);taskService=re(hn);ngZone=re(Ht);zonelessEnabled=re(Pt);tracing=re(ky,{optional:!0});disableScheduling=re(kt,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Ni;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(ji):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(re(Gt,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof to||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&5===t)return;let i=!1;switch(t){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 8:this.appRef.deferredDirtyFlags|=8;break;case 6:case 14:this.appRef.dirtyFlags|=2,i=!0;break;case 13:this.appRef.dirtyFlags|=16,i=!0;break;case 12:i=!0;break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;const r=this.useMicrotaskScheduler?hr:jn;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>r(()=>this.tick())):this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(t){return!(this.disableScheduling&&!t||this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(ji+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(t),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,hr(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Cm=new ct("",{providedIn:"root",factory:()=>re(Cm,Xi.Optional|Xi.SkipSelf)||function eX(){return typeof $localize<"u"&&$localize.locale||$S}()}),tX=new ct("",{providedIn:"root",factory:()=>"USD"}),JS=new ct(""),sX=new ct("");function tC(e){return!e.moduleRef}let _B=(()=>{class e{_injector;_modules=[];_destroyListeners=[];_destroyed=!1;constructor(t){this._injector=t}bootstrapModuleFactory(t,i){const r=i?.scheduleInRootZone,h=i?.ignoreChangesOutsideZone,v=[LR({ngZoneFactory:()=>function Ci(e="zone.js",n){return"noop"===e?new to:"zone.js"===e?new Ht(n):e}(i?.ngZone,{...NR({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}),scheduleInRootZone:r}),ignoreChangesOutsideZone:h}),{provide:st,useExisting:eC}],C=function gW(e,n,t){return new QA(e,n,t,!1)}(t.moduleType,this.injector,v);return function gB(e){const n=tC(e)?e.r3Injector:e.moduleRef.injector,t=n.get(Ht);return t.run(()=>{tC(e)?e.r3Injector.resolveInjectorInitializers():e.moduleRef.resolveInjectorInitializers();const i=n.get(Zi,null);let r;if(t.runOutsideAngular(()=>{r=t.onError.subscribe({next:a=>{i.handleError(a)}})}),tC(e)){const a=()=>n.destroy(),h=e.platformInjector.get(JS);h.add(a),n.onDestroy(()=>{r.unsubscribe(),h.delete(a)})}else{const a=()=>e.moduleRef.destroy(),h=e.platformInjector.get(JS);h.add(a),e.moduleRef.onDestroy(()=>{VS(e.allPlatformModules,e.moduleRef),r.unsubscribe(),h.delete(a)})}return function T7(e,n,t){try{const i=t();return j1(i)?i.catch(r=>{throw n.runOutsideAngular(()=>e.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>e.handleError(i)),i}}(i,t,()=>{const a=n.get(iz);return a.runInitializers(),a.donePromise.then(()=>{if(function eZ(e){"string"==typeof e&&(Gz=e.toLowerCase().replace(/_/g,"-"))}(n.get(Cm,$S)||$S),!n.get(sX,!0))return tC(e)?n.get(Wa):(e.allPlatformModules.push(e.moduleRef),e.moduleRef);if(tC(e)){const C=n.get(Wa);return void 0!==e.rootComponent&&C.bootstrap(e.rootComponent),C}return function aX(e,n){const t=e.injector.get(Wa);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(i=>t.bootstrap(i));else{if(!e.instance.ngDoBootstrap)throw new ot(-403,!1);e.instance.ngDoBootstrap(t)}n.push(e)}(e.moduleRef,e.allPlatformModules),e.moduleRef})})})}({moduleRef:C,allPlatformModules:this._modules,platformInjector:this.injector})}bootstrapModule(t,i=[]){const r=sz({},i);return function XY(e,n,t){const i=new JA(t);return Promise.resolve(i)}(0,0,t).then(a=>this.bootstrapModuleFactory(a,r))}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ot(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(JS,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static \u0275fac=function(i){return new(i||e)(un(Ye))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})(),v_=null;const yB=new ct("");function vB(e,n,t=[]){const i=`Platform: ${n}`,r=new ct(i);return(a=[])=>{let h=BR();if(!h||h.injector.get(yB,!1)){const v=[...t,...a,{provide:r,useValue:!0}];e?e(v):function lX(e){if(v_&&!v_.get(yB,!1))throw new ot(400,!1);(function oz(){!function Dl(e){Fn=e}(()=>{throw new ot(600,!1)})})(),v_=e;const n=e.get(_B);(function xB(e){const n=e.get(kw,null);As(e,()=>{n?.forEach(t=>t())})})(e)}(function bB(e=[],n){return Ye.create({name:n,providers:[{provide:li,useValue:"platform"},{provide:JS,useValue:new Set([()=>v_=null])},...e]})}(v,i))}return function cX(){const n=BR();if(!n)throw new ot(401,!1);return n}()}}function BR(){return v_?.get(_B)??null}let Bo=(()=>class e{static __NG_ELEMENT_ID__=uX})();function uX(e){return function hX(e,n,t){if(Ll(e)&&!t){const i=Ta(e.index,n);return new yv(i,i)}return 175&e.type?new yv(n[15],n):null}(Bi(),yt(),!(16&~e))}class SB{constructor(){}supports(n){return RS(n)}create(n){return new _X(n)}}const gX=(e,n)=>n;class _X{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(n){this._trackByFn=n||gX}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,i=this._removalsHead,r=0,a=null;for(;t||i;){const h=!i||t&&t.currentIndex<DB(i,r,a)?t:i,v=DB(h,r,a),C=h.currentIndex;if(h===i)r--,i=i._nextRemoved;else if(t=t._next,null==h.previousIndex)r++;else{a||(a=[]);const P=v-r,L=C-r;if(P!=L){for(let W=0;W<P;W++){const X=W<a.length?a[W]:a[W]=0,oe=X+W;L<=oe&&oe<P&&(a[W]=X+1)}a[h.previousIndex]=L-P}}v!==C&&n(h,v,C)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!RS(n))throw new ot(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,a,h,t=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let v=0;v<this.length;v++)a=n[v],h=this._trackByFn(v,a),null!==t&&Object.is(t.trackById,h)?(i&&(t=this._verifyReinsertion(t,a,h,v)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,h,v),i=!0),t=t._next}else r=0,function PW(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let i;for(;!(i=t.next()).done;)n(i.value)}}(n,v=>{h=this._trackByFn(r,v),null!==t&&Object.is(t.trackById,h)?(i&&(t=this._verifyReinsertion(t,v,h,r)),Object.is(t.item,v)||this._addIdentityChange(t,v)):(t=this._mismatch(t,v,h,r),i=!0),t=t._next,r++}),this.length=r;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,i,r){let a;return null===n?a=this._itTail:(a=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,a,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,a,r)):n=this._addAfter(new yX(t,i),a,r),n}_verifyReinsertion(n,t,i,r){let a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==a?n=this._reinsertAfter(a,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,a=n._nextRemoved;return null===r?this._removalsHead=a:r._nextRemoved=a,null===a?this._removalsTail=r:a._prevRemoved=r,this._insertAfter(n,t,i),this._addToMoves(n,i),n}_moveAfter(n,t,i){return this._unlink(n),this._insertAfter(n,t,i),this._addToMoves(n,i),n}_addAfter(n,t,i){return this._insertAfter(n,t,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,i){const r=null===t?this._itHead:t._next;return n._next=r,n._prev=t,null===r?this._itTail=n:r._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new EB),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,i=n._next;return null===t?this._itHead=i:t._next=i,null===i?this._itTail=t:i._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new EB),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class yX{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(n,t){this.item=n,this.trackById=t}}class vX{_head=null;_tail=null;add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===t||t<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const t=n._prevDup,i=n._nextDup;return null===t?this._head=i:t._nextDup=i,null===i?this._tail=t:i._prevDup=t,null===this._head}}class EB{map=new Map;put(n){const t=n.trackById;let i=this.map.get(t);i||(i=new vX,this.map.set(t,i)),i.add(n)}get(n,t){const r=this.map.get(n);return r?r.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function DB(e,n,t){const i=e.previousIndex;if(null===i)return i;let r=0;return t&&i<t.length&&(r=t[i]),i+n+r}class IB{constructor(){}supports(n){return n instanceof Map||tR(n)}create(){return new bX}}class bX{_records=new Map;_mapHead=null;_appendAfter=null;_previousMapHead=null;_changesHead=null;_changesTail=null;_additionsHead=null;_additionsTail=null;_removalsHead=null;_removalsTail=null;get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let t;for(t=this._mapHead;null!==t;t=t._next)n(t)}forEachPreviousItem(n){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)n(t)}forEachChangedItem(n){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}diff(n){if(n){if(!(n instanceof Map||tR(n)))throw new ot(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const a=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,a)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,t){if(n){const i=n._prev;return t._next=n,t._prev=i,n._prev=t,i&&(i._next=t),n===this._mapHead&&(this._mapHead=t),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(n,t){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,t);const a=r._prev,h=r._next;return a&&(a._next=h),h&&(h._prev=a),r._next=null,r._prev=null,r}const i=new xX(n);return this._records.set(n,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,t){Object.is(t,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=t,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,t){n instanceof Map?n.forEach(t):Object.keys(n).forEach(i=>t(n[i],i))}}class xX{key;previousValue=null;currentValue=null;_nextPrevious=null;_next=null;_prev=null;_nextAdded=null;_nextRemoved=null;_nextChanged=null;constructor(n){this.key=n}}function kB(){return new b_([new SB])}let b_=(()=>{class e{factories;static \u0275prov=Nt({token:e,providedIn:"root",factory:kB});constructor(t){this.factories=t}static create(t,i){if(null!=i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||kB()),deps:[[e,new hc,new Kr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(null!=i)return i;throw new ot(901,!1)}}return e})();function AB(){return new nE([new IB])}let nE=(()=>{class e{static \u0275prov=Nt({token:e,providedIn:"root",factory:AB});factories;constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new e(t)}static extend(t){return{provide:e,useFactory:i=>e.create(t,i||AB()),deps:[[e,new hc,new Kr]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new ot(901,!1)}}return e})();const TX=vB(null,"core",[]);let MX=(()=>{class e{constructor(t){}static \u0275fac=function(i){return new(i||e)(un(Wa))};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();function zn(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}function Ya(e,n=NaN){return isNaN(parseFloat(e))||isNaN(Number(e))?n:Number(e)}function Tm(e,n){Es("NgSignals");const t=El(e);return n?.equal&&(t[xi].equal=n.equal),t}function bl(e){const n=Xn(null);try{return e()}finally{Xn(n)}}let oV=(()=>class e{view;node;constructor(t,i){this.view=t,this.node=i}static __NG_ELEMENT_ID__=dK})();function dK(){return new oV(yt(),Bi())}class gK{[xi];constructor(n){this[xi]=n}destroy(){this[xi].destroy()}}function uE(e,n){Es("NgSignals"),!n?.injector&&Bu();const t=n?.injector??re(Ye);let r,i=!0!==n?.manualCleanup?t.get(Ke):null;const a=t.get(oV,null,{optional:!0}),h=t.get(st);return null===a||n?.forceRoot?r=function bK(e,n,t){const i=Object.create(_K);return i.fn=e,i.scheduler=n,i.notifier=t,i.zone=typeof Zone<"u"?Zone.current:null,i.scheduler.schedule(i),i.notifier.notify(13),i}(e,t.get(lR),h):(r=function vK(e,n,t){const i=Object.create(yK);return i.view=e,i.zone=typeof Zone<"u"?Zone.current:null,i.notifier=n,i.fn=t,e[23]??=new Set,e[23].add(i),i.consumerMarkedDirty(i),i}(a.view,h,e),i instanceof bt&&i._lView===a.view&&(i=null)),r.injector=t,null!==i&&(r.onDestroyFn=i.onDestroy(()=>r.destroy())),new gK(r)}const sV={...Oi,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,onDestroyFn:si,run(){if(this.dirty=!1,this.hasRun&&!tl(this))return;this.hasRun=!0;const e=i=>(this.cleanupFns??=[]).push(i),n=bn(this),t=pf(!1);try{this.maybeCleanup(),this.fn(e)}finally{pf(t),el(this,n)}},maybeCleanup(){if(this.cleanupFns?.length)try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[]}}},_K={...sV,consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(13)},destroy(){xn(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}},yK={...sV,consumerMarkedDirty(){this.view[2]|=8192,na(this.view),this.notifier.notify(14)},destroy(){xn(this),this.onDestroyFn(),this.maybeCleanup(),this.view[23]?.delete(this)}};function lV(e,n){const t=Ai(e),i=n.elementInjector||rf();return new N1(t).create(i,n.projectableNodes,n.hostElement,n.environmentInjector)}let cV=null;function x_(){return cV}class kK{}const ir=new ct("");let YR=(()=>{class e{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>re(RK),providedIn:"platform"})}return e})();const AK=new ct("");let RK=(()=>{class e extends YR{_location;_history;_doc=re(ir);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return x_().getBaseHref(this._doc)}onPopState(t){const i=x_().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=x_().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,r){this._history.pushState(t,i,r)}replaceState(t,i,r){this._history.replaceState(t,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>new e,providedIn:"platform"})}return e})();function XR(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function dV(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function Mm(e){return e&&"?"!==e[0]?"?"+e:e}let Rv=(()=>{class e{historyGo(t){throw new Error("")}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>re(hV),providedIn:"root"})}return e})();const uV=new ct("");let hV=(()=>{class e extends Rv{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??re(ir).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return XR(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Mm(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,a){const h=this.prepareExternalUrl(r+Mm(a));this._platformLocation.pushState(t,i,h)}replaceState(t,i,r,a){const h=this.prepareExternalUrl(r+Mm(a));this._platformLocation.replaceState(t,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||e)(un(YR),un(uV,8))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),PK=(()=>{class e extends Rv{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(t,i){super(),this._platformLocation=t,null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){const i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=XR(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,a){let h=this.prepareExternalUrl(r+Mm(a));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.pushState(t,i,h)}replaceState(t,i,r,a){let h=this.prepareExternalUrl(r+Mm(a));0==h.length&&(h=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,h)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(i){return new(i||e)(un(YR),un(uV,8))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})(),fx=(()=>{class e{_subject=new Ie;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function LK(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(dV(fV(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Mm(i))}normalize(t){return e.stripTrailingSlash(function FK(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,fV(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Mm(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Mm(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=Mm;static joinWithSlash=XR;static stripTrailingSlash=dV;static \u0275fac=function(i){return new(i||e)(un(Rv))};static \u0275prov=Nt({token:e,factory:()=>function OK(){return new fx(un(Rv))}(),providedIn:"root"})}return e})();function fV(e){return e.replace(/\/index.html$/,"")}const pV={ADP:[void 0,void 0,0],AFN:[void 0,"\u060b",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058f",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20bc"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09f3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xa5","\xa5"],COP:[void 0,"$",2],CRC:[void 0,"\u20a1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010d",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xa3"],ESP:[void 0,"\u20a7",0],EUR:["\u20ac"],FJD:[void 0,"$"],FKP:[void 0,"\xa3"],GBP:["\xa3"],GEL:[void 0,"\u20be"],GHS:[void 0,"GH\u20b5"],GIP:[void 0,"\xa3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20aa"],INR:["\u20b9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xa5",void 0,0],KHR:[void 0,"\u17db"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20a9",0],KRW:["\u20a9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20b8"],LAK:[void 0,"\u20ad",0],LBP:[void 0,"L\xa3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20ae",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20a6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20b1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20b2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20bd"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xa3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xa3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xa3",0],THB:[void 0,"\u0e3f"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20ba"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20b4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20ab",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202fCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xa4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]};var hE=function(e){return e[e.Decimal=0]="Decimal",e[e.Percent=1]="Percent",e[e.Currency=2]="Currency",e[e.Scientific=3]="Scientific",e}(hE||{});function su(e,n){const t=Kl(e),i=t[Ro.NumberSymbols][n];if(typeof i>"u"){if(12===n)return t[Ro.NumberSymbols][0];if(13===n)return t[Ro.NumberSymbols][1]}return i}const cQ=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function fQ(e,n,t,i,r){const h=function i2(e,n="-"){const t={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=e.split(";"),r=i[0],a=i[1],h=-1!==r.indexOf(".")?r.split("."):[r.substring(0,r.lastIndexOf("0")+1),r.substring(r.lastIndexOf("0")+1)],v=h[0],C=h[1]||"";t.posPre=v.substring(0,v.indexOf("#"));for(let L=0;L<C.length;L++){const V=C.charAt(L);"0"===V?t.minFrac=t.maxFrac=L+1:"#"===V?t.maxFrac=L+1:t.posSuf+=V}const P=v.split(",");if(t.gSize=P[1]?P[1].length:0,t.lgSize=P[2]||P[1]?(P[2]||P[1]).length:0,a){const L=r.length-t.posPre.length-t.posSuf.length,V=a.indexOf("#");t.negPre=a.substring(0,V).replace(/'/g,""),t.negSuf=a.slice(V+L).replace(/'/g,"")}else t.negPre=n+t.posPre,t.negSuf=t.posSuf;return t}(function KR(e,n){return Kl(e)[Ro.NumberFormats][n]}(n,hE.Currency),su(n,5));return h.minFrac=function YK(e){let n;const t=pV[e];return t&&(n=t[2]),"number"==typeof n?n:2}(i),h.maxFrac=h.minFrac,function n2(e,n,t,i,r,a,h=!1){let v="",C=!1;if(isFinite(e)){let P=function _Q(e){let i,r,a,h,v,n=Math.abs(e)+"",t=0;for((r=n.indexOf("."))>-1&&(n=n.replace(".","")),(a=n.search(/e/i))>0?(r<0&&(r=a),r+=+n.slice(a+1),n=n.substring(0,a)):r<0&&(r=n.length),a=0;"0"===n.charAt(a);a++);if(a===(v=n.length))i=[0],r=1;else{for(v--;"0"===n.charAt(v);)v--;for(r-=a,i=[],h=0;a<=v;a++,h++)i[h]=Number(n.charAt(a))}return r>22&&(i=i.splice(0,21),t=r-1,r=1),{digits:i,exponent:t,integerLen:r}}(e);h&&(P=function gQ(e){if(0===e.digits[0])return e;const n=e.digits.length-e.integerLen;return e.exponent?e.exponent+=2:(0===n?e.digits.push(0,0):1===n&&e.digits.push(0),e.integerLen+=2),e}(P));let L=n.minInt,V=n.minFrac,W=n.maxFrac;if(a){const Se=a.match(cQ);if(null===Se)throw new Error(`${a} is not a valid digit info`);const $e=Se[1],et=Se[3],ut=Se[5];null!=$e&&(L=r2($e)),null!=et&&(V=r2(et)),null!=ut?W=r2(ut):null!=et&&V>W&&(W=V)}!function yQ(e,n,t){if(n>t)throw new Error(`The minimum number of digits after fraction (${n}) is higher than the maximum (${t}).`);let i=e.digits,r=i.length-e.integerLen;const a=Math.min(Math.max(n,r),t);let h=a+e.integerLen,v=i[h];if(h>0){i.splice(Math.max(e.integerLen,h));for(let V=h;V<i.length;V++)i[V]=0}else{r=Math.max(0,r),e.integerLen=1,i.length=Math.max(1,h=a+1),i[0]=0;for(let V=1;V<h;V++)i[V]=0}if(v>=5)if(h-1<0){for(let V=0;V>h;V--)i.unshift(0),e.integerLen++;i.unshift(1),e.integerLen++}else i[h-1]++;for(;r<Math.max(0,a);r++)i.push(0);let C=0!==a;const P=n+e.integerLen,L=i.reduceRight(function(V,W,X,oe){return oe[X]=(W+=V)<10?W:W-10,C&&(0===oe[X]&&X>=P?oe.pop():C=!1),W>=10?1:0},0);L&&(i.unshift(L),e.integerLen++)}(P,V,W);let X=P.digits,oe=P.integerLen;const he=P.exponent;let se=[];for(C=X.every(Se=>!Se);oe<L;oe++)X.unshift(0);for(;oe<0;oe++)X.unshift(0);oe>0?se=X.splice(oe,X.length):(se=X,X=[0]);const _e=[];for(X.length>=n.lgSize&&_e.unshift(X.splice(-n.lgSize,X.length).join(""));X.length>n.gSize;)_e.unshift(X.splice(-n.gSize,X.length).join(""));X.length&&_e.unshift(X.join("")),v=_e.join(su(t,i)),se.length&&(v+=su(t,r)+se.join("")),he&&(v+=su(t,6)+"+"+he)}else v=su(t,9);return v=e<0&&!C?n.negPre+v+n.negSuf:n.posPre+v+n.posSuf,v}(e,h,n,13,12,r).replace("\xa4",t).replace("\xa4","").trim()}function r2(e){const n=parseInt(e);if(isNaN(n))throw new Error("Invalid integer literal when parsing "+e);return n}function wV(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const i=t.indexOf("="),[r,a]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===n)return decodeURIComponent(a)}return null}const s2=/\s+/,CV=[];let w_=(()=>{class e{_ngEl;_renderer;initialClasses=CV;rawClass;stateMap=new Map;constructor(t,i){this._ngEl=t,this._renderer=i}set klass(t){this.initialClasses=null!=t?t.trim().split(s2):CV}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(s2):t}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const i of t)this._updateState(i,!0);else if(null!=t)for(const i of Object.keys(t))this._updateState(i,!!t[i]);this._applyStateDiff()}_updateState(t,i){const r=this.stateMap.get(t);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(t,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const i=t[0],r=t[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(t,i){(t=t.trim()).length>0&&t.split(s2).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||e)(Rt(In),Rt(Ns))};static \u0275dir=Bt({type:e,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return e})();class xQ{$implicit;ngForOf;index;count;constructor(n,t,i,r){this.$implicit=n,this.ngForOf=t,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let md=(()=>{class e{_viewContainer;_template;_differs;set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(t,i,r){this._viewContainer=t,this._template=i,this._differs=r}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const i=this._viewContainer;t.forEachOperation((r,a,h)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new xQ(r.item,this._ngForOf,-1,-1),null===h?void 0:h);else if(null==h)i.remove(null===a?void 0:a);else if(null!==a){const v=i.get(a);i.move(v,h),MV(v,r)}});for(let r=0,a=i.length;r<a;r++){const v=i.get(r).context;v.index=r,v.count=a,v.ngForOf=this._ngForOf}t.forEachIdentityChange(r=>{MV(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||e)(Rt(ms),Rt(Lo),Rt(b_))};static \u0275dir=Bt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return e})();function MV(e,n){e.context.$implicit=n.item}let qf=(()=>{class e{_viewContainer;_context=new wQ;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(t,i){this._viewContainer=t,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){SV("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){SV("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(t,i){return!0}static \u0275fac=function(i){return new(i||e)(Rt(ms),Rt(Lo))};static \u0275dir=Bt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return e})();class wQ{$implicit=null;ngIf=null}function SV(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${So(n)}'.`)}let DV=(()=>{class e{_ngEl;_differs;_renderer;_ngStyle=null;_differ=null;constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,a]=t.split("."),h=-1===r.indexOf("-")?void 0:uh.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,a?`${i}${a}`:i,h):this._renderer.removeStyle(this._ngEl.nativeElement,r,h)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static \u0275fac=function(i){return new(i||e)(Rt(In),Rt(nE),Rt(Ns))};static \u0275dir=Bt({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}})}return e})(),sC=(()=>{class e{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(t){this._viewContainerRef=t}ngOnChanges(t){if(this._shouldRecreateView(t)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(t){return!!t.ngTemplateOutlet||!!t.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(t,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(t,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static \u0275fac=function(i){return new(i||e)(Rt(ms))};static \u0275dir=Bt({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[sr]})}return e})();let IV=(()=>{class e{differs;constructor(t){this.differs=t}differ;keyValues=[];compareFn=kV;transform(t,i=kV){if(!t||!(t instanceof Map)&&"object"!=typeof t)return null;this.differ??=this.differs.find(t).create();const r=this.differ.diff(t),a=i!==this.compareFn;return r&&(this.keyValues=[],r.forEachItem(h=>{this.keyValues.push(function HQ(e,n){return{key:e,value:n}}(h.key,h.currentValue))})),(r||a)&&(i&&this.keyValues.sort(i),this.compareFn=i),this.keyValues}static \u0275fac=function(i){return new(i||e)(Rt(nE,16))};static \u0275pipe=Xl({name:"keyvalue",type:e,pure:!1})}return e})();function kV(e,n){const t=e.key,i=n.key;if(t===i)return 0;if(void 0===t)return 1;if(void 0===i)return-1;if(null===t)return 1;if(null===i)return-1;if("string"==typeof t&&"string"==typeof i)return t<i?-1:1;if("number"==typeof t&&"number"==typeof i)return t-i;if("boolean"==typeof t&&"boolean"==typeof i)return t<i?-1:1;const r=String(t),a=String(i);return r==a?0:r<a?-1:1}let c2=(()=>{class e{_locale;_defaultCurrencyCode;constructor(t,i="USD"){this._locale=t,this._defaultCurrencyCode=i}transform(t,i=this._defaultCurrencyCode,r="symbol",a,h){if(!function d2(e){return!(null==e||""===e||e!=e)}(t))return null;h||=this._locale,"boolean"==typeof r&&(r=r?"symbol":"code");let v=i||this._defaultCurrencyCode;"code"!==r&&(v="symbol"===r||"symbol-narrow"===r?function WK(e,n,t="en"){const i=function HK(e){return Kl(e)[Ro.Currencies]}(t)[e]||pV[e]||[],r=i[1];return"narrow"===n&&"string"==typeof r?r:i[0]||e}(v,"symbol"===r?"wide":"narrow",h):r);try{return fQ(function u2(e){if("string"==typeof e&&!isNaN(Number(e)-parseFloat(e)))return Number(e);if("number"!=typeof e)throw new Error(`${e} is not a number`);return e}(t),h,v,i,a)}catch(C){throw function bh(e,n){return new ot(2100,!1)}()}}static \u0275fac=function(i){return new(i||e)(Rt(Cm,16),Rt(tX,16))};static \u0275pipe=Xl({name:"currency",type:e,pure:!0})}return e})();let Dm=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();const AV="browser";function RV(e){return e===AV}function PV(e){return"server"===e}let WQ=(()=>{class e{static \u0275prov=Nt({token:e,providedIn:"root",factory:()=>RV(re(rh))?new ZQ(re(ir),window):new XQ})}return e})();class ZQ{document;window;offset=()=>[0,0];constructor(n,t){this.document=n,this.window=t}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n){this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){const t=function YQ(e,n){const t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if("function"==typeof e.createTreeWalker&&e.body&&"function"==typeof e.body.attachShadow){const i=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const a=r.shadowRoot;if(a){const h=a.getElementById(n)||a.querySelector(`[name="${n}"]`);if(h)return h}r=i.nextNode()}}return null}(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.window.history.scrollRestoration=n}scrollToElement(n){const t=n.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(i-a[0],r-a[1])}}class XQ{setOffset(n){}getScrollPosition(){return[0,0]}scrollToPosition(n){}scrollToAnchor(n){}setHistoryScrollRestoration(n){}}class OV{}class TJ extends kK{supportsDOMEvents=!0}class m2 extends TJ{static makeCurrent(){!function IK(e){cV??=e}(new m2)}onAndCancel(n,t,i){return n.addEventListener(t,i),()=>{n.removeEventListener(t,i)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.remove()}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function MJ(){return cC=cC||document.querySelector("base"),cC?cC.getAttribute("href"):null}();return null==t?null:function SJ(e){return new URL(e,document.baseURI).pathname}(t)}resetBaseElement(){cC=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return wV(document.cookie,n)}}let cC=null,DJ=(()=>{class e{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();const g2=new ct("");let GV=(()=>{class e{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,i){this._zone=i,t.forEach(r=>{r.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){let i=this._eventNameToPlugin.get(t);if(i)return i;if(i=this._plugins.find(a=>a.supports(t)),!i)throw new ot(5101,!1);return this._eventNameToPlugin.set(t,i),i}static \u0275fac=function(i){return new(i||e)(un(g2),un(Ht))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();class qV{_doc;constructor(n){this._doc=n}manager}const SE="ng-app-id";function WV(e){for(const n of e)n.remove()}function ZV(e,n){const t=n.createElement("style");return t.textContent=e,t}function _2(e,n){const t=n.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",e),t}let YV=(()=>{class e{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(t,i,r,a={}){this.doc=t,this.appId=i,this.nonce=r,this.isServer=PV(a),function IJ(e,n,t,i){const r=e.head?.querySelectorAll(`style[${SE}="${n}"],link[${SE}="${n}"]`);if(r)for(const a of r)a.removeAttribute(SE),a instanceof HTMLLinkElement?i.set(a.href.slice(a.href.lastIndexOf("/")+1),{usage:0,elements:[a]}):a.textContent&&t.set(a.textContent,{usage:0,elements:[a]})}(t,i,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,i){for(const r of t)this.addUsage(r,this.inline,ZV);i?.forEach(r=>this.addUsage(r,this.external,_2))}removeStyles(t,i){for(const r of t)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(t,i,r){const a=i.get(t);a?a.usage++:i.set(t,{usage:1,elements:[...this.hosts].map(h=>this.addElement(h,r(t,this.doc)))})}removeUsage(t,i){const r=i.get(t);r&&(r.usage--,r.usage<=0&&(WV(r.elements),i.delete(t)))}ngOnDestroy(){for(const[,{elements:t}]of[...this.inline,...this.external])WV(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(const[i,{elements:r}]of this.inline)r.push(this.addElement(t,ZV(i,this.doc)));for(const[i,{elements:r}]of this.external)r.push(this.addElement(t,_2(i,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,i){return this.nonce&&i.setAttribute("nonce",this.nonce),this.isServer&&i.setAttribute(SE,this.appId),t.appendChild(i)}static \u0275fac=function(i){return new(i||e)(un(ir),un(Mf),un(Aw,8),un(rh))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();const y2={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},v2=/%COMP%/g,PJ=new ct("",{providedIn:"root",factory:()=>!0});function KV(e,n){return n.map(t=>t.replace(v2,e))}let b2=(()=>{class e{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,i,r,a,h,v,C,P=null){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=a,this.doc=h,this.platformId=v,this.ngZone=C,this.nonce=P,this.platformIsServer=PV(v),this.defaultRenderer=new x2(t,h,C,this.platformIsServer)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Sc.ShadowDom&&(i={...i,encapsulation:Sc.Emulated});const r=this.getOrCreateRenderer(t,i);return r instanceof JV?r.applyToHost(t):r instanceof w2&&r.applyStyles(),r}getOrCreateRenderer(t,i){const r=this.rendererByCompId;let a=r.get(i.id);if(!a){const h=this.doc,v=this.ngZone,C=this.eventManager,P=this.sharedStylesHost,L=this.removeStylesOnCompDestroy,V=this.platformIsServer;switch(i.encapsulation){case Sc.Emulated:a=new JV(C,P,i,this.appId,L,h,v,V);break;case Sc.ShadowDom:return new NJ(C,P,t,i,h,v,this.nonce,V);default:a=new w2(C,P,i,L,h,v,V)}r.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(i){return new(i||e)(un(GV),un(YV),un(Mf),un(PJ),un(ir),un(rh),un(Ht),un(Aw))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();class x2{eventManager;doc;ngZone;platformIsServer;data=Object.create(null);throwOnSyntheticProps=!0;constructor(n,t,i,r){this.eventManager=n,this.doc=t,this.ngZone=i,this.platformIsServer=r}destroy(){}destroyNode=null;createElement(n,t){return t?this.doc.createElementNS(y2[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(QV(n)?n.content:n).appendChild(t)}insertBefore(n,t,i){n&&(QV(n)?n.content:n).insertBefore(t,i)}removeChild(n,t){t.remove()}selectRootElement(n,t){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new ot(-5104,!1);return t||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,i,r){if(r){t=r+":"+t;const a=y2[r];a?n.setAttributeNS(a,t,i):n.setAttribute(t,i)}else n.setAttribute(t,i)}removeAttribute(n,t,i){if(i){const r=y2[i];r?n.removeAttributeNS(r,t):n.removeAttribute(`${i}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,i,r){r&(uh.DashCase|uh.Important)?n.style.setProperty(t,i,r&uh.Important?"important":""):n.style[t]=i}removeStyle(n,t,i){i&uh.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,i){null!=n&&(n[t]=i)}setValue(n,t){n.nodeValue=t}listen(n,t,i){if("string"==typeof n&&!(n=x_().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(i))}decoratePreventDefault(n){return t=>{if("__ngUnwrap__"===t)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))&&t.preventDefault()}}}function QV(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class NJ extends x2{sharedStylesHost;hostEl;shadowRoot;constructor(n,t,i,r,a,h,v,C){super(n,a,h,C),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const P=KV(r.id,r.styles);for(const V of P){const W=document.createElement("style");v&&W.setAttribute("nonce",v),W.textContent=V,this.shadowRoot.appendChild(W)}const L=r.getExternalStyles?.();if(L)for(const V of L){const W=_2(V,a);v&&W.setAttribute("nonce",v),this.shadowRoot.appendChild(W)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,i){return super.insertBefore(this.nodeOrShadowRoot(n),t,i)}removeChild(n,t){return super.removeChild(null,t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class w2 extends x2{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(n,t,i,r,a,h,v,C){super(n,a,h,v),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=r,this.styles=C?KV(C,i.styles):i.styles,this.styleUrls=i.getExternalStyles?.(C)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}class JV extends w2{contentAttr;hostAttr;constructor(n,t,i,r,a,h,v,C){const P=r+"-"+i.id;super(n,t,i,a,h,v,C,P),this.contentAttr=function OJ(e){return"_ngcontent-%COMP%".replace(v2,e)}(P),this.hostAttr=function FJ(e){return"_nghost-%COMP%".replace(v2,e)}(P)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const i=super.createElement(n,t);return super.setAttribute(i,this.contentAttr,""),i}}let zJ=(()=>{class e extends qV{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}static \u0275fac=function(i){return new(i||e)(un(ir))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();const e4=["alt","control","meta","shift"],BJ={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},VJ={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let UJ=(()=>{class e extends qV{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,i,r){const a=e.parseEventName(i),h=e.eventCallback(a.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>x_().onAndCancel(t,a.domEventName,h))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const a=e._normalizeKey(i.pop());let h="",v=i.indexOf("code");if(v>-1&&(i.splice(v,1),h="code."),e4.forEach(P=>{const L=i.indexOf(P);L>-1&&(i.splice(L,1),h+=P+".")}),h+=a,0!=i.length||0===a.length)return null;const C={};return C.domEventName=r,C.fullKey=h,C}static matchEventFullKeyCode(t,i){let r=BJ[t.key]||t.key,a="";return i.indexOf("code.")>-1&&(r=t.code,a="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),e4.forEach(h=>{h!==r&&(0,VJ[h])(t)&&(a+=h+".")}),a+=r,a===i)}static eventCallback(t,i,r){return a=>{e.matchEventFullKeyCode(a,t)&&r.runGuarded(()=>i(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}static \u0275fac=function(i){return new(i||e)(un(ir))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();const GJ=vB(TX,"browser",[{provide:rh,useValue:AV},{provide:kw,useValue:function jJ(){m2.makeCurrent()},multi:!0},{provide:ir,useFactory:function $J(){return function Zd(e){My=e}(document),document},deps:[]}]),qJ=new ct(""),i4=[{provide:zS,useClass:class EJ{addToWindow(n){Rr.getAngularTestability=(i,r=!0)=>{const a=n.findTestabilityInTree(i,r);if(null==a)throw new ot(5103,!1);return a},Rr.getAllAngularTestabilities=()=>n.getAllTestabilities(),Rr.getAllAngularRootElements=()=>n.getAllRootElements(),Rr.frameworkStabilizers||(Rr.frameworkStabilizers=[]),Rr.frameworkStabilizers.push(i=>{const r=Rr.getAllAngularTestabilities();let a=r.length;const h=function(){a--,0==a&&i()};r.forEach(v=>{v.whenStable(h)})})}findTestabilityInTree(n,t,i){return null==t?null:n.getTestability(t)??(i?x_().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:tz,useClass:oR,deps:[Ht,sR,zS]},{provide:oR,useClass:oR,deps:[Ht,sR,zS]}],r4=[{provide:li,useValue:"root"},{provide:Zi,useFactory:function HJ(){return new Zi},deps:[]},{provide:g2,useClass:zJ,multi:!0,deps:[ir,Ht,rh]},{provide:g2,useClass:UJ,multi:!0,deps:[ir]},b2,YV,GV,{provide:ua,useExisting:b2},{provide:OV,useClass:DJ,deps:[]},[]];let o4=(()=>{class e{constructor(t){}static \u0275fac=function(i){return new(i||e)(un(qJ,12))};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[...r4,...i4],imports:[Dm,MX]})}return e})(),WJ=(()=>{class e{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(i){return new(i||e)(un(ir))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),EE=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:function(i){let r=null;return r=i?new(i||e):un(KJ),r},providedIn:"root"})}return e})(),KJ=(()=>{class e extends EE{_doc;constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case ps.NONE:return i;case ps.HTML:return Ec(i,"HTML")?_l(i):nv(this._doc,String(i)).toString();case ps.STYLE:return Ec(i,"Style")?_l(i):i;case ps.SCRIPT:if(Ec(i,"Script"))return _l(i);throw new ot(5200,!1);case ps.URL:return Ec(i,"URL")?_l(i):a0(String(i));case ps.RESOURCE_URL:if(Ec(i,"ResourceURL"))return _l(i);throw new ot(5201,!1);default:throw new ot(5202,!1)}}bypassSecurityTrustHtml(t){return function Qy(e){return new Gk(e)}(t)}bypassSecurityTrustStyle(t){return function Af(e){return new qk(e)}(t)}bypassSecurityTrustScript(t){return function EM(e){return new Wg(e)}(t)}bypassSecurityTrustUrl(t){return function DM(e){return new Yw(e)}(t)}bypassSecurityTrustResourceUrl(t){return function o0(e){return new Wk(e)}(t)}static \u0275fac=function(i){return new(i||e)(un(ir))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Li=function(e){return e[e.State=0]="State",e[e.Transition=1]="Transition",e[e.Sequence=2]="Sequence",e[e.Group=3]="Group",e[e.Animate=4]="Animate",e[e.Keyframes=5]="Keyframes",e[e.Style=6]="Style",e[e.Trigger=7]="Trigger",e[e.Reference=8]="Reference",e[e.AnimateChild=9]="AnimateChild",e[e.AnimateRef=10]="AnimateRef",e[e.Query=11]="Query",e[e.Stagger=12]="Stagger",e}(Li||{});const Im="*";function Us(e,n){return{type:Li.Trigger,name:e,definitions:n,options:{}}}function no(e,n=null){return{type:Li.Animate,styles:n,timings:e}}function yi(e){return{type:Li.Style,styles:e,offset:null}}function Or(e,n,t){return{type:Li.State,name:e,styles:n,options:t}}function Hr(e,n,t=null){return{type:Li.Transition,expr:e,animation:n,options:t}}function l4(e=null){return{type:Li.AnimateChild,options:e}}function c4(e,n,t=null){return{type:Li.Query,selector:e,animation:n,options:t}}class uC{_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_originalOnDoneFns=[];_originalOnStartFns=[];_started=!1;_destroyed=!1;_finished=!1;_position=0;parentPlayer=null;totalTime;constructor(n=0,t=0){this.totalTime=n+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class d4{_onDoneFns=[];_onStartFns=[];_finished=!1;_started=!1;_destroyed=!1;_onDestroyFns=[];parentPlayer=null;totalTime=0;players;constructor(n){this.players=n;let t=0,i=0,r=0;const a=this.players.length;0==a?queueMicrotask(()=>this._onFinish()):this.players.forEach(h=>{h.onDone(()=>{++t==a&&this._onFinish()}),h.onDestroy(()=>{++i==a&&this._onDestroy()}),h.onStart(()=>{++r==a&&this._onStart()})}),this.totalTime=this.players.reduce((h,v)=>Math.max(h,v.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const t=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const t="start"==n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}function u4(e){return new ot(3e3,!1)}function T_(e){switch(e.length){case 0:return new uC;case 1:return e[0];default:return new d4(e)}}function h4(e,n,t=new Map,i=new Map){const r=[],a=[];let h=-1,v=null;if(n.forEach(C=>{const P=C.get("offset"),L=P==h,V=L&&v||new Map;C.forEach((W,X)=>{let oe=X,he=W;if("offset"!==X)switch(oe=e.normalizePropertyName(oe,r),he){case"!":he=t.get(X);break;case Im:he=i.get(X);break;default:he=e.normalizeStyleValue(X,oe,he,r)}V.set(oe,he)}),L||a.push(V),v=V,h=P}),r.length)throw function Mee(){return new ot(3502,!1)}();return a}function T2(e,n,t,i){switch(n){case"start":e.onStart(()=>i(t&&M2(t,"start",e)));break;case"done":e.onDone(()=>i(t&&M2(t,"done",e)));break;case"destroy":e.onDestroy(()=>i(t&&M2(t,"destroy",e)))}}function M2(e,n,t){const a=S2(e.element,e.triggerName,e.fromState,e.toState,n||e.phaseName,t.totalTime??e.totalTime,!!t.disabled),h=e._data;return null!=h&&(a._data=h),a}function S2(e,n,t,i,r="",a=0,h){return{element:e,triggerName:n,fromState:t,toState:i,phaseName:r,totalTime:a,disabled:!!h}}function gd(e,n,t){let i=e.get(n);return i||e.set(n,i=t),i}function f4(e){const n=e.indexOf(":");return[e.substring(1,n),e.slice(n+1)]}const Nee=typeof document>"u"?null:document.documentElement;function E2(e){const n=e.parentNode||e.host||null;return n===Nee?null:n}let Pv=null,p4=!1;function m4(e,n){for(;n;){if(n===e)return!0;n=E2(n)}return!1}function g4(e,n,t){if(t)return Array.from(e.querySelectorAll(n));const i=e.querySelector(n);return i?[i]:[]}let D2=(()=>{class e{validateStyleProperty(t){return function Bee(e){Pv||(Pv=function Vee(){return typeof document<"u"?document.body:null}()||{},p4=!!Pv.style&&"WebkitAppearance"in Pv.style);let n=!0;return Pv.style&&!function zee(e){return"ebkit"==e.substring(1,6)}(e)&&(n=e in Pv.style,!n&&p4&&(n="Webkit"+e.charAt(0).toUpperCase()+e.slice(1)in Pv.style)),n}(t)}containsElement(t,i){return m4(t,i)}getParentElement(t){return E2(t)}query(t,i,r){return g4(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,a,h,v=[],C){return new uC(r,a)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();class I2{static NOOP=new D2}class k2{}const A2="ng-enter",IE="ng-leave",kE="ng-trigger",AE=".ng-trigger",y4="ng-animating",R2=".ng-animating";function km(e){if("number"==typeof e)return e;const n=e.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:P2(parseFloat(n[1]),n[2])}function P2(e,n){return"s"===n?1e3*e:e}function RE(e,n,t){return e.hasOwnProperty("duration")?e:function $ee(e,n,t){let r,a=0,h="";if("string"==typeof e){const v=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===v)return n.push(u4()),{duration:0,delay:0,easing:""};r=P2(parseFloat(v[1]),v[2]);const C=v[3];null!=C&&(a=P2(parseFloat(C),v[4]));const P=v[5];P&&(h=P)}else r=e;if(!t){let v=!1,C=n.length;r<0&&(n.push(function iee(){return new ot(3100,!1)}()),v=!0),a<0&&(n.push(function ree(){return new ot(3101,!1)}()),v=!0),v&&n.splice(C,0,u4())}return{duration:r,delay:a,easing:h}}(e,n,t)}function Wf(e,n,t){n.forEach((i,r)=>{const a=F2(r);t&&!t.has(r)&&t.set(r,e.style[a]),e.style[a]=i})}function Ov(e,n){n.forEach((t,i)=>{const r=F2(i);e.style[r]=""})}function hC(e){return Array.isArray(e)?1==e.length?e[0]:function QJ(e,n=null){return{type:Li.Sequence,steps:e,options:n}}(e):e}const O2=new RegExp("{{\\s*(.+?)\\s*}}","g");function b4(e){let n=[];if("string"==typeof e){let t;for(;t=O2.exec(e);)n.push(t[1]);O2.lastIndex=0}return n}function fC(e,n,t){const i=`${e}`,r=i.replace(O2,(a,h)=>{let v=n[h];return null==v&&(t.push(function see(){return new ot(3003,!1)}()),v=""),v.toString()});return r==i?e:r}const Wee=/-+([a-z0-9])/g;function F2(e){return e.replace(Wee,(...n)=>n[1].toUpperCase())}function _d(e,n,t){switch(n.type){case Li.Trigger:return e.visitTrigger(n,t);case Li.State:return e.visitState(n,t);case Li.Transition:return e.visitTransition(n,t);case Li.Sequence:return e.visitSequence(n,t);case Li.Group:return e.visitGroup(n,t);case Li.Animate:return e.visitAnimate(n,t);case Li.Keyframes:return e.visitKeyframes(n,t);case Li.Style:return e.visitStyle(n,t);case Li.Reference:return e.visitReference(n,t);case Li.AnimateChild:return e.visitAnimateChild(n,t);case Li.AnimateRef:return e.visitAnimateRef(n,t);case Li.Query:return e.visitQuery(n,t);case Li.Stagger:return e.visitStagger(n,t);default:throw function aee(){return new ot(3004,!1)}()}}function L2(e,n){return window.getComputedStyle(e)[n]}const Xee=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class x4 extends k2{normalizePropertyName(n,t){return F2(n)}normalizeStyleValue(n,t,i,r){let a="";const h=i.toString().trim();if(Xee.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)a="px";else{const v=i.match(/^[+-]?[\d\.]+([a-z]*)$/);v&&0==v[1].length&&r.push(function lee(){return new ot(3005,!1)}())}return h+a}}const OE=new Set(["true","1"]),FE=new Set(["false","0"]);function w4(e,n){const t=OE.has(e)||FE.has(e),i=OE.has(n)||FE.has(n);return(r,a)=>{let h="*"==e||e==r,v="*"==n||n==a;return!h&&t&&"boolean"==typeof r&&(h=r?OE.has(e):FE.has(e)),!v&&i&&"boolean"==typeof a&&(v=a?OE.has(n):FE.has(n)),h&&v}}const ete=new RegExp("s*:selfs*,?","g");function N2(e,n,t,i){return new tte(e).build(n,t,i)}class tte{_driver;constructor(n){this._driver=n}build(n,t,i){const r=new rte(t);return this._resetContextStyleTimingState(r),_d(this,hC(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,t){let i=t.queryCount=0,r=t.depCount=0;const a=[],h=[];return"@"==n.name.charAt(0)&&t.errors.push(function cee(){return new ot(3006,!1)}()),n.definitions.forEach(v=>{if(this._resetContextStyleTimingState(t),v.type==Li.State){const C=v,P=C.name;P.toString().split(/\s*,\s*/).forEach(L=>{C.name=L,a.push(this.visitState(C,t))}),C.name=P}else if(v.type==Li.Transition){const C=this.visitTransition(v,t);i+=C.queryCount,r+=C.depCount,h.push(C)}else t.errors.push(function dee(){return new ot(3007,!1)}())}),{type:Li.Trigger,name:n.name,states:a,transitions:h,queryCount:i,depCount:r,options:null}}visitState(n,t){const i=this.visitStyle(n.styles,t),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const a=new Set,h=r||{};i.styles.forEach(v=>{v instanceof Map&&v.forEach(C=>{b4(C).forEach(P=>{h.hasOwnProperty(P)||a.add(P)})})}),a.size&&t.errors.push(function uee(){return new ot(3008,!1)}(0,a.values()))}return{type:Li.State,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,t){t.queryCount=0,t.depCount=0;const i=_d(this,hC(n.animation),t),r=function Kee(e,n){const t=[];return"string"==typeof e?e.split(/\s*,\s*/).forEach(i=>function Qee(e,n,t){if(":"==e[0]){const C=function Jee(e,n){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return n.push(function xee(){return new ot(3016,!1)}()),"* => *"}}(e,t);if("function"==typeof C)return void n.push(C);e=C}const i=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function bee(){return new ot(3015,!1)}()),n;const r=i[1],a=i[2],h=i[3];n.push(w4(r,h)),"<"==a[0]&&("*"!=r||"*"!=h)&&n.push(w4(h,r))}(i,t,n)):t.push(e),t}(n.expr,t.errors);return{type:Li.Transition,matchers:r,animation:i,queryCount:t.queryCount,depCount:t.depCount,options:Fv(n.options)}}visitSequence(n,t){return{type:Li.Sequence,steps:n.steps.map(i=>_d(this,i,t)),options:Fv(n.options)}}visitGroup(n,t){const i=t.currentTime;let r=0;const a=n.steps.map(h=>{t.currentTime=i;const v=_d(this,h,t);return r=Math.max(r,t.currentTime),v});return t.currentTime=r,{type:Li.Group,steps:a,options:Fv(n.options)}}visitAnimate(n,t){const i=function ste(e,n){if(e.hasOwnProperty("duration"))return e;if("number"==typeof e)return z2(RE(e,n).duration,0,"");const t=e;if(t.split(/\s+/).some(a=>"{"==a.charAt(0)&&"{"==a.charAt(1))){const a=z2(0,0,"");return a.dynamic=!0,a.strValue=t,a}const r=RE(t,n);return z2(r.duration,r.delay,r.easing)}(n.timings,t.errors);t.currentAnimateTimings=i;let r,a=n.styles?n.styles:yi({});if(a.type==Li.Keyframes)r=this.visitKeyframes(a,t);else{let h=n.styles,v=!1;if(!h){v=!0;const P={};i.easing&&(P.easing=i.easing),h=yi(P)}t.currentTime+=i.duration+i.delay;const C=this.visitStyle(h,t);C.isEmptyStep=v,r=C}return t.currentAnimateTimings=null,{type:Li.Animate,timings:i,style:r,options:null}}visitStyle(n,t){const i=this._makeStyleAst(n,t);return this._validateStyleAst(i,t),i}_makeStyleAst(n,t){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let v of r)"string"==typeof v?v===Im?i.push(v):t.errors.push(new ot(3002,!1)):i.push(new Map(Object.entries(v)));let a=!1,h=null;return i.forEach(v=>{if(v instanceof Map&&(v.has("easing")&&(h=v.get("easing"),v.delete("easing")),!a))for(let C of v.values())if(C.toString().indexOf("{{")>=0){a=!0;break}}),{type:Li.Style,styles:i,easing:h,offset:n.offset,containsDynamicStyles:a,options:null}}_validateStyleAst(n,t){const i=t.currentAnimateTimings;let r=t.currentTime,a=t.currentTime;i&&a>0&&(a-=i.duration+i.delay),n.styles.forEach(h=>{"string"!=typeof h&&h.forEach((v,C)=>{const P=t.collectedStyles.get(t.currentQuerySelector),L=P.get(C);let V=!0;L&&(a!=r&&a>=L.startTime&&r<=L.endTime&&(t.errors.push(function fee(){return new ot(3010,!1)}()),V=!1),a=L.startTime),V&&P.set(C,{startTime:a,endTime:r}),t.options&&function qee(e,n,t){const i=n.params||{},r=b4(e);r.length&&r.forEach(a=>{i.hasOwnProperty(a)||t.push(function oee(){return new ot(3001,!1)}())})}(v,t.options,t.errors)})})}visitKeyframes(n,t){const i={type:Li.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function pee(){return new ot(3011,!1)}()),i;let a=0;const h=[];let v=!1,C=!1,P=0;const L=n.steps.map(_e=>{const Se=this._makeStyleAst(_e,t);let $e=null!=Se.offset?Se.offset:function ote(e){if("string"==typeof e)return null;let n=null;if(Array.isArray(e))e.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(e instanceof Map&&e.has("offset")){const t=e;n=parseFloat(t.get("offset")),t.delete("offset")}return n}(Se.styles),et=0;return null!=$e&&(a++,et=Se.offset=$e),C=C||et<0||et>1,v=v||et<P,P=et,h.push(et),Se});C&&t.errors.push(function mee(){return new ot(3012,!1)}()),v&&t.errors.push(function gee(){return new ot(3200,!1)}());const V=n.steps.length;let W=0;a>0&&a<V?t.errors.push(function _ee(){return new ot(3202,!1)}()):0==a&&(W=1/(V-1));const X=V-1,oe=t.currentTime,he=t.currentAnimateTimings,se=he.duration;return L.forEach((_e,Se)=>{const $e=W>0?Se==X?1:W*Se:h[Se],et=$e*se;t.currentTime=oe+he.delay+et,he.duration=et,this._validateStyleAst(_e,t),_e.offset=$e,i.styles.push(_e)}),i}visitReference(n,t){return{type:Li.Reference,animation:_d(this,hC(n.animation),t),options:Fv(n.options)}}visitAnimateChild(n,t){return t.depCount++,{type:Li.AnimateChild,options:Fv(n.options)}}visitAnimateRef(n,t){return{type:Li.AnimateRef,animation:this.visitReference(n.animation,t),options:Fv(n.options)}}visitQuery(n,t){const i=t.currentQuerySelector,r=n.options||{};t.queryCount++,t.currentQuery=n;const[a,h]=function nte(e){const n=!!e.split(/\s*,\s*/).find(t=>":self"==t);return n&&(e=e.replace(ete,"")),e=e.replace(/@\*/g,AE).replace(/@\w+/g,t=>AE+"-"+t.slice(1)).replace(/:animating/g,R2),[e,n]}(n.selector);t.currentQuerySelector=i.length?i+" "+a:a,gd(t.collectedStyles,t.currentQuerySelector,new Map);const v=_d(this,hC(n.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:Li.Query,selector:a,limit:r.limit||0,optional:!!r.optional,includeSelf:h,animation:v,originalSelector:n.selector,options:Fv(n.options)}}visitStagger(n,t){t.currentQuery||t.errors.push(function yee(){return new ot(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:RE(n.timings,t.errors,!0);return{type:Li.Stagger,animation:_d(this,hC(n.animation),t),timings:i,options:null}}}class rte{errors;queryCount=0;depCount=0;currentTransition=null;currentQuery=null;currentQuerySelector=null;currentAnimateTimings=null;currentTime=0;collectedStyles=new Map;options=null;unsupportedCSSPropertiesFound=new Set;constructor(n){this.errors=n}}function Fv(e){return e?(e={...e}).params&&(e.params=function ite(e){return e?{...e}:null}(e.params)):e={},e}function z2(e,n,t){return{duration:e,delay:n,easing:t}}function B2(e,n,t,i,r,a,h=null,v=!1){return{type:1,element:e,keyframes:n,preStyleProps:t,postStyleProps:i,duration:r,delay:a,totalTime:r+a,easing:h,subTimeline:v}}class LE{_map=new Map;get(n){return this._map.get(n)||[]}append(n,t){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...t)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const cte=new RegExp(":enter","g"),ute=new RegExp(":leave","g");function V2(e,n,t,i,r,a=new Map,h=new Map,v,C,P=[]){return(new hte).buildKeyframes(e,n,t,i,r,a,h,v,C,P)}class hte{buildKeyframes(n,t,i,r,a,h,v,C,P,L=[]){P=P||new LE;const V=new U2(n,t,P,r,a,L,[]);V.options=C;const W=C.delay?km(C.delay):0;V.currentTimeline.delayNextStep(W),V.currentTimeline.setStyles([h],null,V.errors,C),_d(this,i,V);const X=V.timelines.filter(oe=>oe.containsAnimation());if(X.length&&v.size){let oe;for(let he=X.length-1;he>=0;he--){const se=X[he];if(se.element===t){oe=se;break}}oe&&!oe.allowOnlyTimelineStyles()&&oe.setStyles([v],null,V.errors,C)}return X.length?X.map(oe=>oe.buildKeyframes()):[B2(t,[],[],[],0,W,"",!1)]}visitTrigger(n,t){}visitState(n,t){}visitTransition(n,t){}visitAnimateChild(n,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(n.options),a=t.currentTimeline.currentTime,h=this._visitSubInstructions(i,r,r.options);a!=h&&t.transformIntoNewTimeline(h)}t.previousNode=n}visitAnimateRef(n,t){const i=t.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],t,i),this.visitReference(n.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=n}_applyAnimationRefDelays(n,t,i){for(const r of n){const a=r?.delay;if(a){const h="number"==typeof a?a:km(fC(a,r?.params??{},t.errors));i.delayNextStep(h)}}}_visitSubInstructions(n,t,i){let a=t.currentTimeline.currentTime;const h=null!=i.duration?km(i.duration):null,v=null!=i.delay?km(i.delay):null;return 0!==h&&n.forEach(C=>{const P=t.appendInstructionToTimeline(C,h,v);a=Math.max(a,P.duration+P.delay)}),a}visitReference(n,t){t.updateOptions(n.options,!0),_d(this,n.animation,t),t.previousNode=n}visitSequence(n,t){const i=t.subContextCount;let r=t;const a=n.options;if(a&&(a.params||a.delay)&&(r=t.createSubContext(a),r.transformIntoNewTimeline(),null!=a.delay)){r.previousNode.type==Li.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=NE);const h=km(a.delay);r.delayNextStep(h)}n.steps.length&&(n.steps.forEach(h=>_d(this,h,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=n}visitGroup(n,t){const i=[];let r=t.currentTimeline.currentTime;const a=n.options&&n.options.delay?km(n.options.delay):0;n.steps.forEach(h=>{const v=t.createSubContext(n.options);a&&v.delayNextStep(a),_d(this,h,v),r=Math.max(r,v.currentTimeline.currentTime),i.push(v.currentTimeline)}),i.forEach(h=>t.currentTimeline.mergeTimelineCollectedStyles(h)),t.transformIntoNewTimeline(r),t.previousNode=n}_visitTiming(n,t){if(n.dynamic){const i=n.strValue;return RE(t.params?fC(i,t.params,t.errors):i,t.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,t){const i=t.currentAnimateTimings=this._visitTiming(n.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const a=n.style;a.type==Li.Keyframes?this.visitKeyframes(a,t):(t.incrementTime(i.duration),this.visitStyle(a,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=n}visitStyle(n,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const a=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(a):i.setStyles(n.styles,a,t.errors,t.options),t.previousNode=n}visitKeyframes(n,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,a=i.duration,v=t.createSubContext().currentTimeline;v.easing=i.easing,n.styles.forEach(C=>{v.forwardTime((C.offset||0)*a),v.setStyles(C.styles,C.easing,t.errors,t.options),v.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(v),t.transformIntoNewTimeline(r+a),t.previousNode=n}visitQuery(n,t){const i=t.currentTimeline.currentTime,r=n.options||{},a=r.delay?km(r.delay):0;a&&(t.previousNode.type===Li.Style||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=NE);let h=i;const v=t.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=v.length;let C=null;v.forEach((P,L)=>{t.currentQueryIndex=L;const V=t.createSubContext(n.options,P);a&&V.delayNextStep(a),P===t.element&&(C=V.currentTimeline),_d(this,n.animation,V),V.currentTimeline.applyStylesToKeyframe(),h=Math.max(h,V.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(h),C&&(t.currentTimeline.mergeTimelineCollectedStyles(C),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=n}visitStagger(n,t){const i=t.parentContext,r=t.currentTimeline,a=n.timings,h=Math.abs(a.duration),v=h*(t.currentQueryTotal-1);let C=h*t.currentQueryIndex;switch(a.duration<0?"reverse":a.easing){case"reverse":C=v-C;break;case"full":C=i.currentStaggerTime}const L=t.currentTimeline;C&&L.delayNextStep(C);const V=L.currentTime;_d(this,n.animation,t),t.previousNode=n,i.currentStaggerTime=r.currentTime-V+(r.startTime-i.currentTimeline.startTime)}}const NE={};class U2{_driver;element;subInstructions;_enterClassName;_leaveClassName;errors;timelines;parentContext=null;currentTimeline;currentAnimateTimings=null;previousNode=NE;subContextCount=0;options={};currentQueryIndex=0;currentQueryTotal=0;currentStaggerTime=0;constructor(n,t,i,r,a,h,v,C){this._driver=n,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=a,this.errors=h,this.timelines=v,this.currentTimeline=C||new zE(this._driver,t,0),v.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,t){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=km(i.duration)),null!=i.delay&&(r.delay=km(i.delay));const a=i.params;if(a){let h=r.params;h||(h=this.options.params={}),Object.keys(a).forEach(v=>{(!t||!h.hasOwnProperty(v))&&(h[v]=fC(a[v],h,this.errors))})}}_copyOptions(){const n={};if(this.options){const t=this.options.params;if(t){const i=n.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return n}createSubContext(n=null,t,i){const r=t||this.element,a=new U2(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(n),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}transformIntoNewTimeline(n){return this.previousNode=NE,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,t,i){const r={duration:t??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},a=new fte(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(a),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,t,i,r,a,h){let v=[];if(r&&v.push(this.element),n.length>0){n=(n=n.replace(cte,"."+this._enterClassName)).replace(ute,"."+this._leaveClassName);let P=this._driver.query(this.element,n,1!=i);0!==i&&(P=i<0?P.slice(P.length+i,P.length):P.slice(0,i)),v.push(...P)}return!a&&0==v.length&&h.push(function vee(){return new ot(3014,!1)}()),v}}class zE{_driver;element;startTime;_elementTimelineStylesLookup;duration=0;easing=null;_previousKeyframe=new Map;_currentKeyframe=new Map;_keyframes=new Map;_styleSummary=new Map;_localTimelineStyles=new Map;_globalTimelineStyles;_pendingStyles=new Map;_backFill=new Map;_currentEmptyStepKeyframe=null;constructor(n,t,i,r){this._driver=n,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+n),t&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,t){return this.applyStylesToKeyframe(),new zE(this._driver,n,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,t){this._localTimelineStyles.set(n,t),this._globalTimelineStyles.set(n,t),this._styleSummary.set(n,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||Im),this._currentKeyframe.set(t,Im);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,t,i,r){t&&this._previousKeyframe.set("easing",t);const a=r&&r.params||{},h=function pte(e,n){const t=new Map;let i;return e.forEach(r=>{if("*"===r){i??=n.keys();for(let a of i)t.set(a,Im)}else for(let[a,h]of r)t.set(a,h)}),t}(n,this._globalTimelineStyles);for(let[v,C]of h){const P=fC(C,a,i);this._pendingStyles.set(v,P),this._localTimelineStyles.has(v)||this._backFill.set(v,this._globalTimelineStyles.get(v)??Im),this._updateStyle(v,P)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,t)=>{this._currentKeyframe.set(t,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,n)}))}snapshotCurrentStyles(){for(let[n,t]of this._localTimelineStyles)this._pendingStyles.set(n,t),this._updateStyle(n,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let t in this._currentKeyframe)n.push(t);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((v,C)=>{const P=new Map([...this._backFill,...v]);P.forEach((L,V)=>{"!"===L?n.add(V):L===Im&&t.add(V)}),i||P.set("offset",C/this.duration),r.push(P)});const a=[...n.values()],h=[...t.values()];if(i){const v=r[0],C=new Map(v);v.set("offset",0),C.set("offset",1),r=[v,C]}return B2(this.element,r,a,h,this.duration,this.startTime,this.easing,!1)}}class fte extends zE{keyframes;preStyleProps;postStyleProps;_stretchStartingKeyframe;timings;constructor(n,t,i,r,a,h,v=!1){super(n,t,h.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=a,this._stretchStartingKeyframe=v,this.timings={duration:h.duration,delay:h.delay,easing:h.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const a=[],h=i+t,v=t/h,C=new Map(n[0]);C.set("offset",0),a.push(C);const P=new Map(n[0]);P.set("offset",M4(v)),a.push(P);const L=n.length-1;for(let V=1;V<=L;V++){let W=new Map(n[V]);const X=W.get("offset");W.set("offset",M4((t+X*i)/h)),a.push(W)}i=h,t=0,r="",n=a}return B2(this.element,n,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function M4(e,n=3){const t=Math.pow(10,n-1);return Math.round(e*t)/t}function S4(e,n,t,i,r,a,h,v,C,P,L,V,W){return{type:0,element:e,triggerName:n,isRemovalTransition:r,fromState:t,fromStyles:a,toState:i,toStyles:h,timelines:v,queriedElements:C,preStyleProps:P,postStyleProps:L,totalTime:V,errors:W}}const j2={};class E4{_triggerName;ast;_stateStyles;constructor(n,t,i){this._triggerName=n,this.ast=t,this._stateStyles=i}match(n,t,i,r){return function mte(e,n,t,i,r){return e.some(a=>a(n,t,i,r))}(this.ast.matchers,n,t,i,r)}buildStyles(n,t,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(t,i):new Map}build(n,t,i,r,a,h,v,C,P,L){const V=[],W=this.ast.options&&this.ast.options.params||j2,oe=this.buildStyles(i,v&&v.params||j2,V),he=C&&C.params||j2,se=this.buildStyles(r,he,V),_e=new Set,Se=new Map,$e=new Map,et="void"===r,ut={params:D4(he,W),delay:this.ast.options?.delay},mt=L?[]:V2(n,t,this.ast.animation,a,h,oe,se,ut,P,V);let qt=0;return mt.forEach(tn=>{qt=Math.max(tn.duration+tn.delay,qt)}),V.length?S4(t,this._triggerName,i,r,et,oe,se,[],[],Se,$e,qt,V):(mt.forEach(tn=>{const Rn=tn.element,Pn=gd(Se,Rn,new Set);tn.preStyleProps.forEach(Mi=>Pn.add(Mi));const Kt=gd($e,Rn,new Set);tn.postStyleProps.forEach(Mi=>Kt.add(Mi)),Rn!==t&&_e.add(Rn)}),S4(t,this._triggerName,i,r,et,oe,se,mt,[..._e.values()],Se,$e,qt))}}function D4(e,n){const t={...n};return Object.entries(e).forEach(([i,r])=>{null!=r&&(t[i]=r)}),t}class gte{styles;defaultParams;normalizer;constructor(n,t,i){this.styles=n,this.defaultParams=t,this.normalizer=i}buildStyles(n,t){const i=new Map,r=D4(n,this.defaultParams);return this.styles.styles.forEach(a=>{"string"!=typeof a&&a.forEach((h,v)=>{h&&(h=fC(h,r,t));const C=this.normalizer.normalizePropertyName(v,t);h=this.normalizer.normalizeStyleValue(v,C,h,t),i.set(v,h)})}),i}}class yte{name;ast;_normalizer;transitionFactories=[];fallbackTransition;states=new Map;constructor(n,t,i){this.name=n,this.ast=t,this._normalizer=i,t.states.forEach(r=>{this.states.set(r.name,new gte(r.style,r.options&&r.options.params||{},i))}),I4(this.states,"true","1"),I4(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new E4(n,r,this.states))}),this.fallbackTransition=function vte(e,n){return new E4(e,{type:Li.Transition,animation:{type:Li.Sequence,steps:[],options:null},matchers:[(h,v)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,t,i,r){return this.transitionFactories.find(h=>h.match(n,t,i,r))||null}matchStyles(n,t,i){return this.fallbackTransition.buildStyles(n,t,i)}}function I4(e,n,t){e.has(n)?e.has(t)||e.set(t,e.get(n)):e.has(t)&&e.set(n,e.get(t))}const bte=new LE;class xte{bodyNode;_driver;_normalizer;_animations=new Map;_playersById=new Map;players=[];constructor(n,t,i){this.bodyNode=n,this._driver=t,this._normalizer=i}register(n,t){const i=[],a=N2(this._driver,t,i,[]);if(i.length)throw function See(){return new ot(3503,!1)}();this._animations.set(n,a)}_buildPlayer(n,t,i){const r=n.element,a=h4(this._normalizer,n.keyframes,t,i);return this._driver.animate(r,a,n.duration,n.delay,n.easing,[],!0)}create(n,t,i={}){const r=[],a=this._animations.get(n);let h;const v=new Map;if(a?(h=V2(this._driver,t,a,A2,IE,new Map,new Map,i,bte,r),h.forEach(L=>{const V=gd(v,L.element,new Map);L.postStyleProps.forEach(W=>V.set(W,null))})):(r.push(function Eee(){return new ot(3300,!1)}()),h=[]),r.length)throw function Dee(){return new ot(3504,!1)}();v.forEach((L,V)=>{L.forEach((W,X)=>{L.set(X,this._driver.computeStyle(V,X,Im))})});const P=T_(h.map(L=>{const V=v.get(L.element);return this._buildPlayer(L,new Map,V)}));return this._playersById.set(n,P),P.onDestroy(()=>this.destroy(n)),this.players.push(P),P}destroy(n){const t=this._getPlayer(n);t.destroy(),this._playersById.delete(n);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(n){const t=this._playersById.get(n);if(!t)throw function Iee(){return new ot(3301,!1)}();return t}listen(n,t,i,r){const a=S2(t,"","","");return T2(this._getPlayer(n),i,a,r),()=>{}}command(n,t,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,t,r[0]||{});const a=this._getPlayer(n);switch(i){case"play":a.play();break;case"pause":a.pause();break;case"reset":a.reset();break;case"restart":a.restart();break;case"finish":a.finish();break;case"init":a.init();break;case"setPosition":a.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const k4="ng-animate-queued",H2="ng-animate-disabled",Ste=[],A4={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Ete={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},xh="__ng_removed";class $2{namespaceId;value;options;get params(){return this.options.params}constructor(n,t=""){this.namespaceId=t;const i=n&&n.hasOwnProperty("value");if(this.value=function Ate(e){return e??null}(i?n.value:n),i){const{value:a,...h}=n;this.options=h}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const t=n.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const pC="void",G2=new $2(pC);class Dte{id;hostElement;_engine;players=[];_triggers=new Map;_queue=[];_elementListeners=new Map;_hostClassName;constructor(n,t,i){this.id=n,this.hostElement=t,this._engine=i,this._hostClassName="ng-tns-"+n,lu(t,this._hostClassName)}listen(n,t,i,r){if(!this._triggers.has(t))throw function kee(){return new ot(3302,!1)}();if(null==i||0==i.length)throw function Aee(){return new ot(3303,!1)}();if(!function Rte(e){return"start"==e||"done"==e}(i))throw function Ree(){return new ot(3400,!1)}();const a=gd(this._elementListeners,n,[]),h={name:t,phase:i,callback:r};a.push(h);const v=gd(this._engine.statesByElement,n,new Map);return v.has(t)||(lu(n,kE),lu(n,kE+"-"+t),v.set(t,G2)),()=>{this._engine.afterFlush(()=>{const C=a.indexOf(h);C>=0&&a.splice(C,1),this._triggers.has(t)||v.delete(t)})}}register(n,t){return!this._triggers.has(n)&&(this._triggers.set(n,t),!0)}_getTrigger(n){const t=this._triggers.get(n);if(!t)throw function Pee(){return new ot(3401,!1)}();return t}trigger(n,t,i,r=!0){const a=this._getTrigger(t),h=new q2(this.id,t,n);let v=this._engine.statesByElement.get(n);v||(lu(n,kE),lu(n,kE+"-"+t),this._engine.statesByElement.set(n,v=new Map));let C=v.get(t);const P=new $2(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&C&&P.absorbOptions(C.options),v.set(t,P),C||(C=G2),P.value!==pC&&C.value===P.value){if(!function Fte(e,n){const t=Object.keys(e),i=Object.keys(n);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const a=t[r];if(!n.hasOwnProperty(a)||e[a]!==n[a])return!1}return!0}(C.params,P.params)){const he=[],se=a.matchStyles(C.value,C.params,he),_e=a.matchStyles(P.value,P.params,he);he.length?this._engine.reportError(he):this._engine.afterFlush(()=>{Ov(n,se),Wf(n,_e)})}return}const W=gd(this._engine.playersByElement,n,[]);W.forEach(he=>{he.namespaceId==this.id&&he.triggerName==t&&he.queued&&he.destroy()});let X=a.matchTransition(C.value,P.value,n,P.params),oe=!1;if(!X){if(!r)return;X=a.fallbackTransition,oe=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:t,transition:X,fromState:C,toState:P,player:h,isFallbackTransition:oe}),oe||(lu(n,k4),h.onStart(()=>{gx(n,k4)})),h.onDone(()=>{let he=this.players.indexOf(h);he>=0&&this.players.splice(he,1);const se=this._engine.playersByElement.get(n);if(se){let _e=se.indexOf(h);_e>=0&&se.splice(_e,1)}}),this.players.push(h),W.push(h),h}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(t=>t.delete(n)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const t=this._engine.playersByElement.get(n);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,t){const i=this._engine.driver.query(n,AE,!0);i.forEach(r=>{if(r[xh])return;const a=this._engine.fetchNamespacesByElement(r);a.size?a.forEach(h=>h.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,t,i,r){const a=this._engine.statesByElement.get(n),h=new Map;if(a){const v=[];if(a.forEach((C,P)=>{if(h.set(P,C.value),this._triggers.has(P)){const L=this.trigger(n,P,pC,r);L&&v.push(L)}}),v.length)return this._engine.markElementAsRemoved(this.id,n,!0,t,h),i&&T_(v).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const t=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(t&&i){const r=new Set;t.forEach(a=>{const h=a.name;if(r.has(h))return;r.add(h);const C=this._triggers.get(h).fallbackTransition,P=i.get(h)||G2,L=new $2(pC),V=new q2(this.id,h,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:h,transition:C,fromState:P,toState:L,player:V,isFallbackTransition:!0})})}}removeNode(n,t){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,t),this.triggerLeaveAnimation(n,t,!0))return;let r=!1;if(i.totalAnimations){const a=i.players.length?i.playersByQueriedElement.get(n):[];if(a&&a.length)r=!0;else{let h=n;for(;h=h.parentNode;)if(i.statesByElement.get(h)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,t);else{const a=n[xh];(!a||a===A4)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,t))}}insertNode(n,t){lu(n,this._hostClassName)}drainQueuedTransitions(n){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const a=i.element,h=this._elementListeners.get(a);h&&h.forEach(v=>{if(v.name==i.triggerName){const C=S2(a,i.triggerName,i.fromState.value,i.toState.value);C._data=n,T2(i.player,v.phase,C,v.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const a=i.transition.ast.depCount,h=r.transition.ast.depCount;return 0==a||0==h?a-h:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class Ite{bodyNode;driver;_normalizer;players=[];newHostElements=new Map;playersByElement=new Map;playersByQueriedElement=new Map;statesByElement=new Map;disabledNodes=new Set;totalAnimations=0;totalQueuedPlayers=0;_namespaceLookup={};_namespaceList=[];_flushFns=[];_whenQuietFns=[];namespacesByHostElement=new Map;collectedEnterElements=[];collectedLeaveElements=[];onRemovalComplete=(n,t)=>{};_onRemovalComplete(n,t){this.onRemovalComplete(n,t)}constructor(n,t,i){this.bodyNode=n,this.driver=t,this._normalizer=i}get queuedPlayers(){const n=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,t){const i=new Dte(n,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let h=!1,v=this.driver.getParentElement(t);for(;v;){const C=r.get(v);if(C){const P=i.indexOf(C);i.splice(P+1,0,n),h=!0;break}v=this.driver.getParentElement(v)}h||i.unshift(n)}else i.push(n);return r.set(t,n),n}register(n,t){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,t)),i}registerTrigger(n,t,i){let r=this._namespaceLookup[n];r&&r.register(t,i)&&this.totalAnimations++}destroy(n,t){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(t),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const t=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const a=this._fetchNamespace(r.namespaceId);a&&t.add(a)}return t}trigger(n,t,i,r){if(BE(t)){const a=this._fetchNamespace(n);if(a)return a.trigger(t,i,r),!0}return!1}insertNode(n,t,i,r){if(!BE(t))return;const a=t[xh];if(a&&a.setForRemoval){a.setForRemoval=!1,a.setForMove=!0;const h=this.collectedLeaveElements.indexOf(t);h>=0&&this.collectedLeaveElements.splice(h,1)}if(n){const h=this._fetchNamespace(n);h&&h.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,t){t?this.disabledNodes.has(n)||(this.disabledNodes.add(n),lu(n,H2)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),gx(n,H2))}removeNode(n,t,i){if(BE(t)){const r=n?this._fetchNamespace(n):null;r?r.removeNode(t,i):this.markElementAsRemoved(n,t,!1,i);const a=this.namespacesByHostElement.get(t);a&&a.id!==n&&a.removeNode(t,i)}else this._onRemovalComplete(t,i)}markElementAsRemoved(n,t,i,r,a){this.collectedLeaveElements.push(t),t[xh]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:a}}listen(n,t,i,r,a){return BE(t)?this._fetchNamespace(n).listen(t,i,r,a):()=>{}}_buildInstruction(n,t,i,r,a){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,t,a)}destroyInnerAnimations(n){let t=this.driver.query(n,AE,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(n,R2,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const t=this.playersByElement.get(n);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const t=this.playersByQueriedElement.get(n);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return T_(this.players).onDone(()=>n());n()})}processLeaveNode(n){const t=n[xh];if(t&&t.setForRemoval){if(n[xh]=A4,t.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,t.setForRemoval)}n.classList?.contains(H2)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)lu(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?T_(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function Oee(){return new ot(3402,!1)}()}_flushAnimations(n,t){const i=new LE,r=[],a=new Map,h=[],v=new Map,C=new Map,P=new Map,L=new Set;this.disabledNodes.forEach(Qe=>{L.add(Qe);const vt=this.driver.query(Qe,".ng-animate-queued",!0);for(let Ut=0;Ut<vt.length;Ut++)L.add(vt[Ut])});const V=this.bodyNode,W=Array.from(this.statesByElement.keys()),X=O4(W,this.collectedEnterElements),oe=new Map;let he=0;X.forEach((Qe,vt)=>{const Ut=A2+he++;oe.set(vt,Ut),Qe.forEach(Wt=>lu(Wt,Ut))});const se=[],_e=new Set,Se=new Set;for(let Qe=0;Qe<this.collectedLeaveElements.length;Qe++){const vt=this.collectedLeaveElements[Qe],Ut=vt[xh];Ut&&Ut.setForRemoval&&(se.push(vt),_e.add(vt),Ut.hasAnimation?this.driver.query(vt,".ng-star-inserted",!0).forEach(Wt=>_e.add(Wt)):Se.add(vt))}const $e=new Map,et=O4(W,Array.from(_e));et.forEach((Qe,vt)=>{const Ut=IE+he++;$e.set(vt,Ut),Qe.forEach(Wt=>lu(Wt,Ut))}),n.push(()=>{X.forEach((Qe,vt)=>{const Ut=oe.get(vt);Qe.forEach(Wt=>gx(Wt,Ut))}),et.forEach((Qe,vt)=>{const Ut=$e.get(vt);Qe.forEach(Wt=>gx(Wt,Ut))}),se.forEach(Qe=>{this.processLeaveNode(Qe)})});const ut=[],mt=[];for(let Qe=this._namespaceList.length-1;Qe>=0;Qe--)this._namespaceList[Qe].drainQueuedTransitions(t).forEach(Ut=>{const Wt=Ut.player,pn=Ut.element;if(ut.push(Wt),this.collectedEnterElements.length){const Wi=pn[xh];if(Wi&&Wi.setForMove){if(Wi.previousTriggersValues&&Wi.previousTriggersValues.has(Ut.triggerName)){const jo=Wi.previousTriggersValues.get(Ut.triggerName),fn=this.statesByElement.get(Ut.element);if(fn&&fn.has(Ut.triggerName)){const Ui=fn.get(Ut.triggerName);Ui.value=jo,fn.set(Ut.triggerName,Ui)}}return void Wt.destroy()}}const kn=!V||!this.driver.containsElement(V,pn),Vn=$e.get(pn),Ar=oe.get(pn),bi=this._buildInstruction(Ut,i,Ar,Vn,kn);if(bi.errors&&bi.errors.length)return void mt.push(bi);if(kn)return Wt.onStart(()=>Ov(pn,bi.fromStyles)),Wt.onDestroy(()=>Wf(pn,bi.toStyles)),void r.push(Wt);if(Ut.isFallbackTransition)return Wt.onStart(()=>Ov(pn,bi.fromStyles)),Wt.onDestroy(()=>Wf(pn,bi.toStyles)),void r.push(Wt);const fo=[];bi.timelines.forEach(Wi=>{Wi.stretchStartingKeyframe=!0,this.disabledNodes.has(Wi.element)||fo.push(Wi)}),bi.timelines=fo,i.append(pn,bi.timelines),h.push({instruction:bi,player:Wt,element:pn}),bi.queriedElements.forEach(Wi=>gd(v,Wi,[]).push(Wt)),bi.preStyleProps.forEach((Wi,jo)=>{if(Wi.size){let fn=C.get(jo);fn||C.set(jo,fn=new Set),Wi.forEach((Ui,dr)=>fn.add(dr))}}),bi.postStyleProps.forEach((Wi,jo)=>{let fn=P.get(jo);fn||P.set(jo,fn=new Set),Wi.forEach((Ui,dr)=>fn.add(dr))})});if(mt.length){const Qe=[];mt.forEach(vt=>{Qe.push(function Fee(){return new ot(3505,!1)}())}),ut.forEach(vt=>vt.destroy()),this.reportError(Qe)}const qt=new Map,tn=new Map;h.forEach(Qe=>{const vt=Qe.element;i.has(vt)&&(tn.set(vt,vt),this._beforeAnimationBuild(Qe.player.namespaceId,Qe.instruction,qt))}),r.forEach(Qe=>{const vt=Qe.element;this._getPreviousPlayers(vt,!1,Qe.namespaceId,Qe.triggerName,null).forEach(Wt=>{gd(qt,vt,[]).push(Wt),Wt.destroy()})});const Rn=se.filter(Qe=>L4(Qe,C,P)),Pn=new Map;P4(Pn,this.driver,Se,P,Im).forEach(Qe=>{L4(Qe,C,P)&&Rn.push(Qe)});const Mi=new Map;X.forEach((Qe,vt)=>{P4(Mi,this.driver,new Set(Qe),C,"!")}),Rn.forEach(Qe=>{const vt=Pn.get(Qe),Ut=Mi.get(Qe);Pn.set(Qe,new Map([...vt?.entries()??[],...Ut?.entries()??[]]))});const Bn=[],at=[],ft={};h.forEach(Qe=>{const{element:vt,player:Ut,instruction:Wt}=Qe;if(i.has(vt)){if(L.has(vt))return Ut.onDestroy(()=>Wf(vt,Wt.toStyles)),Ut.disabled=!0,Ut.overrideTotalTime(Wt.totalTime),void r.push(Ut);let pn=ft;if(tn.size>1){let Vn=vt;const Ar=[];for(;Vn=Vn.parentNode;){const bi=tn.get(Vn);if(bi){pn=bi;break}Ar.push(Vn)}Ar.forEach(bi=>tn.set(bi,pn))}const kn=this._buildAnimation(Ut.namespaceId,Wt,qt,a,Mi,Pn);if(Ut.setRealPlayer(kn),pn===ft)Bn.push(Ut);else{const Vn=this.playersByElement.get(pn);Vn&&Vn.length&&(Ut.parentPlayer=T_(Vn)),r.push(Ut)}}else Ov(vt,Wt.fromStyles),Ut.onDestroy(()=>Wf(vt,Wt.toStyles)),at.push(Ut),L.has(vt)&&r.push(Ut)}),at.forEach(Qe=>{const vt=a.get(Qe.element);if(vt&&vt.length){const Ut=T_(vt);Qe.setRealPlayer(Ut)}}),r.forEach(Qe=>{Qe.parentPlayer?Qe.syncPlayerEvents(Qe.parentPlayer):Qe.destroy()});for(let Qe=0;Qe<se.length;Qe++){const vt=se[Qe],Ut=vt[xh];if(gx(vt,IE),Ut&&Ut.hasAnimation)continue;let Wt=[];if(v.size){let kn=v.get(vt);kn&&kn.length&&Wt.push(...kn);let Vn=this.driver.query(vt,R2,!0);for(let Ar=0;Ar<Vn.length;Ar++){let bi=v.get(Vn[Ar]);bi&&bi.length&&Wt.push(...bi)}}const pn=Wt.filter(kn=>!kn.destroyed);pn.length?Pte(this,vt,pn):this.processLeaveNode(vt)}return se.length=0,Bn.forEach(Qe=>{this.players.push(Qe),Qe.onDone(()=>{Qe.destroy();const vt=this.players.indexOf(Qe);this.players.splice(vt,1)}),Qe.play()}),Bn}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,t,i,r,a){let h=[];if(t){const v=this.playersByQueriedElement.get(n);v&&(h=v)}else{const v=this.playersByElement.get(n);if(v){const C=!a||a==pC;v.forEach(P=>{P.queued||!C&&P.triggerName!=r||h.push(P)})}}return(i||r)&&(h=h.filter(v=>!(i&&i!=v.namespaceId||r&&r!=v.triggerName))),h}_beforeAnimationBuild(n,t,i){const a=t.element,h=t.isRemovalTransition?void 0:n,v=t.isRemovalTransition?void 0:t.triggerName;for(const C of t.timelines){const P=C.element,L=P!==a,V=gd(i,P,[]);this._getPreviousPlayers(P,L,h,v,t.toState).forEach(X=>{const oe=X.getRealPlayer();oe.beforeDestroy&&oe.beforeDestroy(),X.destroy(),V.push(X)})}Ov(a,t.fromStyles)}_buildAnimation(n,t,i,r,a,h){const v=t.triggerName,C=t.element,P=[],L=new Set,V=new Set,W=t.timelines.map(oe=>{const he=oe.element;L.add(he);const se=he[xh];if(se&&se.removedBeforeQueried)return new uC(oe.duration,oe.delay);const _e=he!==C,Se=function Ote(e){const n=[];return F4(e,n),n}((i.get(he)||Ste).map(qt=>qt.getRealPlayer())).filter(qt=>!!qt.element&&qt.element===he),$e=a.get(he),et=h.get(he),ut=h4(this._normalizer,oe.keyframes,$e,et),mt=this._buildPlayer(oe,ut,Se);if(oe.subTimeline&&r&&V.add(he),_e){const qt=new q2(n,v,he);qt.setRealPlayer(mt),P.push(qt)}return mt});P.forEach(oe=>{gd(this.playersByQueriedElement,oe.element,[]).push(oe),oe.onDone(()=>function kte(e,n,t){let i=e.get(n);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&e.delete(n)}return i}(this.playersByQueriedElement,oe.element,oe))}),L.forEach(oe=>lu(oe,y4));const X=T_(W);return X.onDestroy(()=>{L.forEach(oe=>gx(oe,y4)),Wf(C,t.toStyles)}),V.forEach(oe=>{gd(r,oe,[]).push(X)}),X}_buildPlayer(n,t,i){return t.length>0?this.driver.animate(n.element,t,n.duration,n.delay,n.easing,i):new uC(n.duration,n.delay)}}class q2{namespaceId;triggerName;element;_player=new uC;_containsRealPlayer=!1;_queuedCallbacks=new Map;destroyed=!1;parentPlayer=null;markedForDestroy=!1;disabled=!1;queued=!0;totalTime=0;constructor(n,t,i){this.namespaceId=n,this.triggerName=t,this.element=i}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>T2(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const t=this._player;t.triggerCallback&&n.onStart(()=>t.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,t){gd(this._queuedCallbacks,n,[]).push(t)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const t=this._player;t.triggerCallback&&t.triggerCallback(n)}}function BE(e){return e&&1===e.nodeType}function R4(e,n){const t=e.style.display;return e.style.display=n??"none",t}function P4(e,n,t,i,r){const a=[];t.forEach(C=>a.push(R4(C)));const h=[];i.forEach((C,P)=>{const L=new Map;C.forEach(V=>{const W=n.computeStyle(P,V,r);L.set(V,W),(!W||0==W.length)&&(P[xh]=Ete,h.push(P))}),e.set(P,L)});let v=0;return t.forEach(C=>R4(C,a[v++])),h}function O4(e,n){const t=new Map;if(e.forEach(v=>t.set(v,[])),0==n.length)return t;const r=new Set(n),a=new Map;function h(v){if(!v)return 1;let C=a.get(v);if(C)return C;const P=v.parentNode;return C=t.has(P)?P:r.has(P)?1:h(P),a.set(v,C),C}return n.forEach(v=>{const C=h(v);1!==C&&t.get(C).push(v)}),t}function lu(e,n){e.classList?.add(n)}function gx(e,n){e.classList?.remove(n)}function Pte(e,n,t){T_(t).onDone(()=>e.processLeaveNode(n))}function F4(e,n){for(let t=0;t<e.length;t++){const i=e[t];i instanceof d4?F4(i.players,n):n.push(i)}}function L4(e,n,t){const i=t.get(e);if(!i)return!1;let r=n.get(e);return r?i.forEach(a=>r.add(a)):n.set(e,i),t.delete(e),!0}class mC{_driver;_normalizer;_transitionEngine;_timelineEngine;_triggerCache={};onRemovalComplete=(n,t)=>{};constructor(n,t,i){this._driver=t,this._normalizer=i,this._transitionEngine=new Ite(n.body,t,i),this._timelineEngine=new xte(n.body,t,i),this._transitionEngine.onRemovalComplete=(r,a)=>this.onRemovalComplete(r,a)}registerTrigger(n,t,i,r,a){const h=n+"-"+r;let v=this._triggerCache[h];if(!v){const C=[],L=N2(this._driver,a,C,[]);if(C.length)throw function Tee(){return new ot(3404,!1)}();v=function _te(e,n,t){return new yte(e,n,t)}(r,L,this._normalizer),this._triggerCache[h]=v}this._transitionEngine.registerTrigger(t,r,v)}register(n,t){this._transitionEngine.register(n,t)}destroy(n,t){this._transitionEngine.destroy(n,t)}onInsert(n,t,i,r){this._transitionEngine.insertNode(n,t,i,r)}onRemove(n,t,i){this._transitionEngine.removeNode(n,t,i)}disableAnimations(n,t){this._transitionEngine.markElementAsDisabled(n,t)}process(n,t,i,r){if("@"==i.charAt(0)){const[a,h]=f4(i);this._timelineEngine.command(a,t,h,r)}else this._transitionEngine.trigger(n,t,i,r)}listen(n,t,i,r,a){if("@"==i.charAt(0)){const[h,v]=f4(i);return this._timelineEngine.listen(h,t,v,a)}return this._transitionEngine.listen(n,t,i,r,a)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}let Nte=(()=>{class e{_element;_startStyles;_endStyles;static initialStylesByElement=new WeakMap;_state=0;_initialStyles;constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r;let a=e.initialStylesByElement.get(t);a||e.initialStylesByElement.set(t,a=new Map),this._initialStyles=a}start(){this._state<1&&(this._startStyles&&Wf(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Wf(this._element,this._initialStyles),this._endStyles&&(Wf(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Ov(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Ov(this._element,this._endStyles),this._endStyles=null),Wf(this._element,this._initialStyles),this._state=3)}}return e})();function W2(e){let n=null;return e.forEach((t,i)=>{(function zte(e){return"display"===e||"position"===e})(i)&&(n=n||new Map,n.set(i,t))}),n}class N4{element;keyframes;options;_specialStyles;_onDoneFns=[];_onStartFns=[];_onDestroyFns=[];_duration;_delay;_initialized=!1;_finished=!1;_started=!1;_destroyed=!1;_finalKeyframe;_originalOnDoneFns=[];_originalOnStartFns=[];domPlayer;time=0;parentPlayer=null;currentSnapshot=new Map;constructor(n,t,i,r){this.element=n,this.keyframes=t,this.options=i,this._specialStyles=r,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const t=[];return n.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(n,t,i){return n.animate(this._convertKeyframesToObject(t),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:L2(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const t="start"===n?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class z4{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}containsElement(n,t){return m4(n,t)}getParentElement(n){return E2(n)}query(n,t,i){return g4(n,t,i)}computeStyle(n,t,i){return L2(n,t)}animate(n,t,i,r,a,h=[]){const C={duration:i,delay:r,fill:0==r?"both":"forwards"};a&&(C.easing=a);const P=new Map,L=h.filter(X=>X instanceof N4);(function Zee(e,n){return 0===e||0===n})(i,r)&&L.forEach(X=>{X.currentSnapshot.forEach((oe,he)=>P.set(he,oe))});let V=function Gee(e){return e.length?e[0]instanceof Map?e:e.map(n=>new Map(Object.entries(n))):[]}(t).map(X=>new Map(X));V=function Yee(e,n,t){if(t.size&&n.length){let i=n[0],r=[];if(t.forEach((a,h)=>{i.has(h)||r.push(h),i.set(h,a)}),r.length)for(let a=1;a<n.length;a++){let h=n[a];r.forEach(v=>h.set(v,L2(e,v)))}}return n}(n,V,P);const W=function Lte(e,n){let t=null,i=null;return Array.isArray(n)&&n.length?(t=W2(n[0]),n.length>1&&(i=W2(n[n.length-1]))):n instanceof Map&&(t=W2(n)),t||i?new Nte(e,t,i):null}(n,V);return new N4(n,V,C,W)}}const B4="@.disabled";class V4{namespaceId;delegate;engine;_onDestroy;\u0275type=0;constructor(n,t,i,r){this.namespaceId=n,this.delegate=t,this.engine=i,this._onDestroy=r}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,t){return this.delegate.createElement(n,t)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,t){this.delegate.appendChild(n,t),this.engine.onInsert(this.namespaceId,t,n,!1)}insertBefore(n,t,i,r=!0){this.delegate.insertBefore(n,t,i),this.engine.onInsert(this.namespaceId,t,n,r)}removeChild(n,t,i){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(n,t){return this.delegate.selectRootElement(n,t)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,t,i,r){this.delegate.setAttribute(n,t,i,r)}removeAttribute(n,t,i){this.delegate.removeAttribute(n,t,i)}addClass(n,t){this.delegate.addClass(n,t)}removeClass(n,t){this.delegate.removeClass(n,t)}setStyle(n,t,i,r){this.delegate.setStyle(n,t,i,r)}removeStyle(n,t,i){this.delegate.removeStyle(n,t,i)}setProperty(n,t,i){"@"==t.charAt(0)&&t==B4?this.disableAnimations(n,!!i):this.delegate.setProperty(n,t,i)}setValue(n,t){this.delegate.setValue(n,t)}listen(n,t,i){return this.delegate.listen(n,t,i)}disableAnimations(n,t){this.engine.disableAnimations(n,t)}}class Bte extends V4{factory;constructor(n,t,i,r,a){super(t,i,r,a),this.factory=n,this.namespaceId=t}setProperty(n,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==B4?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,t.slice(1),i):this.delegate.setProperty(n,t,i)}listen(n,t,i){if("@"==t.charAt(0)){const r=function Vte(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(n);let a=t.slice(1),h="";return"@"!=a.charAt(0)&&([a,h]=function Ute(e){const n=e.indexOf(".");return[e.substring(0,n),e.slice(n+1)]}(a)),this.engine.listen(this.namespaceId,r,a,h,v=>{this.factory.scheduleListenerCallback(v._data||-1,i,v)})}return this.delegate.listen(n,t,i)}}class jte{delegate;engine;_zone;_currentId=0;_microtaskId=1;_animationCallbacksBuffer=[];_rendererCache=new Map;_cdRecurDepth=0;constructor(n,t,i){this.delegate=n,this.engine=t,this._zone=i,t.onRemovalComplete=(r,a)=>{a?.removeChild(null,r)}}createRenderer(n,t){const r=this.delegate.createRenderer(n,t);if(!n||!t?.data?.animation){const P=this._rendererCache;let L=P.get(r);return L||(L=new V4("",r,this.engine,()=>P.delete(r)),P.set(r,L)),L}const a=t.id,h=t.id+"-"+this._currentId;this._currentId++,this.engine.register(h,n);const v=P=>{Array.isArray(P)?P.forEach(v):this.engine.registerTrigger(a,h,n,P.name,P)};return t.data.animation.forEach(v),new Bte(this,h,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,t,i){if(n>=0&&n<this._microtaskId)return void this._zone.run(()=>t(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(a=>{const[h,v]=a;h(v)}),this._animationCallbacksBuffer=[]})}),r.push([t,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}componentReplaced(n){this.delegate.componentReplaced?.(n)}}const U4=[{provide:k2,useFactory:function $te(){return new x4}},{provide:mC,useClass:(()=>{class e extends mC{constructor(t,i,r){super(t,i,r)}ngOnDestroy(){this.flush()}static \u0275fac=function(i){return new(i||e)(un(ir),un(I2),un(k2))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})()},{provide:ua,useFactory:function Gte(e,n,t){return new jte(e,n,t)},deps:[b2,mC,Ht]}],Z2=[{provide:I2,useFactory:()=>new z4},{provide:Ga,useValue:"BrowserAnimations"},...U4],j4=[{provide:I2,useClass:D2},{provide:Ga,useValue:"NoopAnimations"},...U4];let qte=(()=>{class e{static withConfig(t){return{ngModule:e,providers:t.disableAnimations?j4:Z2}}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:Z2,imports:[o4]})}return e})();function Wte(){return Es("NgEagerAnimations"),[...Z2]}function gC(e){return!!e&&(e instanceof Ce||pi(e.lift)&&pi(e.subscribe))}function M_(e){return this instanceof M_?(this.v=e,this):new M_(e)}function q4(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function Q2(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],i=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(a){t[a]=e[a]&&function(h){return new Promise(function(v,C){!function r(a,h,v,C){Promise.resolve(C).then(function(P){a({value:P,done:v})},h)}(v,C,(h=e[a](h)).done,h.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const eP=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function W4(e){return pi(e?.then)}function Z4(e){return pi(e[tt])}function Y4(e){return Symbol.asyncIterator&&pi(e?.[Symbol.asyncIterator])}function X4(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const K4=function bne(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Q4(e){return pi(e?.[K4])}function J4(e){return function G4(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(e,n||[]),a=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),v("next"),v("throw"),v("return",function h(X){return function(oe){return Promise.resolve(oe).then(X,V)}}),r[Symbol.asyncIterator]=function(){return this},r;function v(X,oe){i[X]&&(r[X]=function(he){return new Promise(function(se,_e){a.push([X,he,se,_e])>1||C(X,he)})},oe&&(r[X]=oe(r[X])))}function C(X,oe){try{!function P(X){X.value instanceof M_?Promise.resolve(X.value.v).then(L,V):W(a[0][2],X)}(i[X](oe))}catch(he){W(a[0][3],he)}}function L(X){C("next",X)}function V(X){C("throw",X)}function W(X,oe){X(oe),a.shift(),a.length&&C(a[0][0],a[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:i,done:r}=yield M_(t.read());if(r)return yield M_(void 0);yield yield M_(i)}}finally{t.releaseLock()}})}function e5(e){return pi(e?.getReader)}function ec(e){if(e instanceof Ce)return e;if(null!=e){if(Z4(e))return function xne(e){return new Ce(n=>{const t=e[tt]();if(pi(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(eP(e))return function wne(e){return new Ce(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(W4(e))return function Cne(e){return new Ce(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,ga)})}(e);if(Y4(e))return t5(e);if(Q4(e))return function Tne(e){return new Ce(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(e5(e))return function Mne(e){return t5(J4(e))}(e)}throw X4(e)}function t5(e){return new Ce(n=>{(function Sne(e,n){var t,i,r,a;return function H4(e,n,t,i){return new(t||(t=Promise))(function(a,h){function v(L){try{P(i.next(L))}catch(V){h(V)}}function C(L){try{P(i.throw(L))}catch(V){h(V)}}function P(L){L.done?a(L.value):function r(a){return a instanceof t?a:new t(function(h){h(a)})}(L.value).then(v,C)}P((i=i.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=q4(e);!(i=yield t.next()).done;)if(n.next(i.value),n.closed)return}catch(h){r={error:h}}finally{try{i&&!i.done&&(a=t.return)&&(yield a.call(t))}finally{if(r)throw r.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function Am(e,n,t,i=0,r=!1){const a=n.schedule(function(){t(),r?e.add(this.schedule(null,i)):this.unsubscribe()},i);if(e.add(a),!r)return a}function n5(e,n=0){return Tt((t,i)=>{t.subscribe(Mt(i,r=>Am(i,e,()=>i.next(r),n),()=>Am(i,e,()=>i.complete(),n),r=>Am(i,e,()=>i.error(r),n)))})}function i5(e,n=0){return Tt((t,i)=>{i.add(e.schedule(()=>t.subscribe(i),n))})}function r5(e,n){if(!e)throw new Error("Iterable cannot be null");return new Ce(t=>{Am(t,n,()=>{const i=e[Symbol.asyncIterator]();Am(t,n,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function js(e,n){return n?function Rne(e,n){if(null!=e){if(Z4(e))return function Ene(e,n){return ec(e).pipe(i5(n),n5(n))}(e,n);if(eP(e))return function Ine(e,n){return new Ce(t=>{let i=0;return n.schedule(function(){i===e.length?t.complete():(t.next(e[i++]),t.closed||this.schedule())})})}(e,n);if(W4(e))return function Dne(e,n){return ec(e).pipe(i5(n),n5(n))}(e,n);if(Y4(e))return r5(e,n);if(Q4(e))return function kne(e,n){return new Ce(t=>{let i;return Am(t,n,()=>{i=e[K4](),Am(t,n,()=>{let r,a;try{({value:r,done:a}=i.next())}catch(h){return void t.error(h)}a?t.complete():t.next(r)},0,!0)}),()=>pi(i?.return)&&i.return()})}(e,n);if(e5(e))return function Ane(e,n){return r5(J4(e),n)}(e,n)}throw X4(e)}(e,n):ec(e)}function o5(e){return e&&pi(e.schedule)}function tP(e){return e[e.length-1]}function s5(e){return pi(tP(e))?e.pop():void 0}function _C(e){return o5(tP(e))?e.pop():void 0}function vn(...e){return js(e,_C(e))}const{isArray:One}=Array,{getPrototypeOf:Fne,prototype:Lne,keys:Nne}=Object;function a5(e){if(1===e.length){const n=e[0];if(One(n))return{args:n,keys:null};if(function zne(e){return e&&"object"==typeof e&&Fne(e)===Lne}(n)){const t=Nne(n);return{args:t.map(i=>n[i]),keys:t}}}return{args:e,keys:null}}const{isArray:Bne}=Array;function nP(e){return $t(n=>function Vne(e,n){return Bne(n)?e(...n):e(n)}(e,n))}function l5(e,n){return e.reduce((t,i,r)=>(t[i]=n[r],t),{})}function Lv(...e){const n=_C(e),t=s5(e),{args:i,keys:r}=a5(e);if(0===i.length)return js([],n);const a=new Ce(function Une(e,n,t=ie){return i=>{c5(n,()=>{const{length:r}=e,a=new Array(r);let h=r,v=r;for(let C=0;C<r;C++)c5(n,()=>{const P=js(e[C],n);let L=!1;P.subscribe(Mt(i,V=>{a[C]=V,L||(L=!0,v--),v||i.next(t(a.slice()))},()=>{--h||i.complete()}))},i)},i)}}(i,n,r?h=>l5(r,h):ie));return t?a.pipe(nP(t)):a}function c5(e,n,t){e?Am(t,e,n):n()}const UE=Fa(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function Ka(e,n,t=1/0){return pi(n)?Ka((i,r)=>$t((a,h)=>n(i,a,r,h))(ec(e(i,r))),t):("number"==typeof n&&(t=n),Tt((i,r)=>function jne(e,n,t,i,r,a,h,v){const C=[];let P=0,L=0,V=!1;const W=()=>{V&&!C.length&&!P&&n.complete()},X=he=>P<i?oe(he):C.push(he),oe=he=>{a&&n.next(he),P++;let se=!1;ec(t(he,L++)).subscribe(Mt(n,_e=>{r?.(_e),a?X(_e):n.next(_e)},()=>{se=!0},void 0,()=>{if(se)try{for(P--;C.length&&P<i;){const _e=C.shift();h?Am(n,h,()=>oe(_e)):oe(_e)}W()}catch(_e){n.error(_e)}}))};return e.subscribe(Mt(n,X,()=>{V=!0,W()})),()=>{v?.()}}(i,r,e,t)))}function _x(e=1/0){return Ka(ie,e)}function jE(...e){return function Hne(){return _x(1)}()(js(e,_C(e)))}function iP(e){return new Ce(n=>{ec(e()).subscribe(n)})}function wh(e,n){const t=pi(e)?e:()=>e,i=r=>r.error(t());return new Ce(n?r=>n.schedule(i,0,r):i)}const yd=new Ce(e=>e.complete());function rP(){return Tt((e,n)=>{let t=null;e._refCount++;const i=Mt(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const r=e._connection,a=t;t=null,r&&(!a||r===a)&&r.unsubscribe(),n.unsubscribe()});e.subscribe(i),i.closed||(t=e.connect())})}class oP extends Ce{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,xt(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new Ni;const t=this.getSubject();n.add(this.source.subscribe(Mt(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=Ni.EMPTY)}return n}refCount(){return rP()(this)}}function Aa(e,n){return Tt((t,i)=>{let r=null,a=0,h=!1;const v=()=>h&&!r&&i.complete();t.subscribe(Mt(i,C=>{r?.unsubscribe();let P=0;const L=a++;ec(e(C,L)).subscribe(r=Mt(i,V=>i.next(n?n(C,V,L,P++):V),()=>{r=null,v()}))},()=>{h=!0,v()}))})}function Ac(e){return e<=0?()=>yd:Tt((n,t)=>{let i=0;n.subscribe(Mt(t,r=>{++i<=e&&(t.next(r),e<=i&&t.complete())}))})}function Ch(...e){const n=_C(e);return Tt((t,i)=>{(n?jE(e,t,n):jE(e,t)).subscribe(i)})}function is(e,n){return Tt((t,i)=>{let r=0;t.subscribe(Mt(i,a=>e.call(n,a,r++)&&i.next(a)))})}function HE(e){return Tt((n,t)=>{let i=!1;n.subscribe(Mt(t,r=>{i=!0,t.next(r)},()=>{i||t.next(e),t.complete()}))})}function d5(e=Gne){return Tt((n,t)=>{let i=!1;n.subscribe(Mt(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(e())))})}function Gne(){return new UE}function Nv(e,n){const t=arguments.length>=2;return i=>i.pipe(e?is((r,a)=>e(r,a,i)):ie,Ac(1),t?HE(n):d5(()=>new UE))}function yx(e,n){return pi(n)?Ka(e,n,1):Ka(e,1)}function Vo(e,n,t){const i=pi(e)||n||t?{next:e,error:n,complete:t}:e;return i?Tt((r,a)=>{var h;null===(h=i.subscribe)||void 0===h||h.call(i);let v=!0;r.subscribe(Mt(a,C=>{var P;null===(P=i.next)||void 0===P||P.call(i,C),a.next(C)},()=>{var C;v=!1,null===(C=i.complete)||void 0===C||C.call(i),a.complete()},C=>{var P;v=!1,null===(P=i.error)||void 0===P||P.call(i,C),a.error(C)},()=>{var C,P;v&&(null===(C=i.unsubscribe)||void 0===C||C.call(i)),null===(P=i.finalize)||void 0===P||P.call(i)}))}):ie}function rs(e){return Tt((n,t)=>{let a,i=null,r=!1;i=n.subscribe(Mt(t,void 0,void 0,h=>{a=ec(e(h,rs(e)(n))),i?(i.unsubscribe(),i=null,a.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,a.subscribe(t))})}function sP(e){return e<=0?()=>yd:Tt((n,t)=>{let i=[];n.subscribe(Mt(t,r=>{i.push(r),e<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function vx(e){return Tt((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}function Er(e){return Tt((n,t)=>{ec(e).subscribe(Mt(t,()=>t.complete(),Cu)),!t.closed&&n.subscribe(t)})}const rr="primary",yC=Symbol("RouteTitle");class Yne{params;constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function bx(e){return new Yne(e)}function Xne(e,n,t){const i=t.path.split("/");if(i.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||i.length<e.length))return null;const r={};for(let a=0;a<i.length;a++){const h=i[a],v=e[a];if(":"===h[0])r[h.substring(1)]=v;else if(h!==v.path)return null}return{consumed:e.slice(0,i.length),posParams:r}}function Zf(e,n){const t=e?aP(e):void 0,i=n?aP(n):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let a=0;a<t.length;a++)if(r=t[a],!u5(e[r],n[r]))return!1;return!0}function aP(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function u5(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),i=[...n].sort();return t.every((r,a)=>i[a]===r)}return e===n}function h5(e){return e.length>0?e[e.length-1]:null}function S_(e){return gC(e)?e:j1(e)?js(Promise.resolve(e)):vn(e)}const Qne={exact:function m5(e,n,t){if(!Bv(e.segments,n.segments)||!$E(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const i in n.children)if(!e.children[i]||!m5(e.children[i],n.children[i],t))return!1;return!0},subset:g5},f5={exact:function Jne(e,n){return Zf(e,n)},subset:function eie(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>u5(e[t],n[t]))},ignored:()=>!0};function p5(e,n,t){return Qne[t.paths](e.root,n.root,t.matrixParams)&&f5[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function g5(e,n,t){return _5(e,n,n.segments,t)}function _5(e,n,t,i){if(e.segments.length>t.length){const r=e.segments.slice(0,t.length);return!(!Bv(r,t)||n.hasChildren()||!$E(r,t,i))}if(e.segments.length===t.length){if(!Bv(e.segments,t)||!$E(e.segments,t,i))return!1;for(const r in n.children)if(!e.children[r]||!g5(e.children[r],n.children[r],i))return!1;return!0}{const r=t.slice(0,e.segments.length),a=t.slice(e.segments.length);return!!(Bv(e.segments,r)&&$E(e.segments,r,i)&&e.children[rr])&&_5(e.children[rr],n,a,i)}}function $E(e,n,t){return n.every((i,r)=>f5[t](e[r].parameters,i.parameters))}class zv{root;queryParams;fragment;_queryParamMap;constructor(n=new ho([],{}),t={},i=null){this.root=n,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap??=bx(this.queryParams),this._queryParamMap}toString(){return iie.serialize(this)}}class ho{segments;children;parent=null;constructor(n,t){this.segments=n,this.children=t,Object.values(t).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return qE(this)}}class vC{path;parameters;_parameterMap;constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap??=bx(this.parameters),this._parameterMap}toString(){return b5(this)}}function Bv(e,n){return e.length===n.length&&e.every((t,i)=>t.path===n[i].path)}let xx=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>new GE,providedIn:"root"})}return e})();class GE{parse(n){const t=new pie(n);return new zv(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${bC(n.root,!0)}`,i=function sie(e){const n=Object.entries(e).map(([t,i])=>Array.isArray(i)?i.map(r=>`${WE(t)}=${WE(r)}`).join("&"):`${WE(t)}=${WE(i)}`).filter(t=>t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${i}${"string"==typeof n.fragment?`#${function rie(e){return encodeURI(e)}(n.fragment)}`:""}`}}const iie=new GE;function qE(e){return e.segments.map(n=>b5(n)).join("/")}function bC(e,n){if(!e.hasChildren())return qE(e);if(n){const t=e.children[rr]?bC(e.children[rr],!1):"",i=[];return Object.entries(e.children).forEach(([r,a])=>{r!==rr&&i.push(`${r}:${bC(a,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function nie(e,n){let t=[];return Object.entries(e.children).forEach(([i,r])=>{i===rr&&(t=t.concat(n(r,i)))}),Object.entries(e.children).forEach(([i,r])=>{i!==rr&&(t=t.concat(n(r,i)))}),t}(e,(i,r)=>r===rr?[bC(e.children[rr],!1)]:[`${r}:${bC(i,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[rr]?`${qE(e)}/${t[0]}`:`${qE(e)}/(${t.join("//")})`}}function y5(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function WE(e){return y5(e).replace(/%3B/gi,";")}function lP(e){return y5(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ZE(e){return decodeURIComponent(e)}function v5(e){return ZE(e.replace(/\+/g,"%20"))}function b5(e){return`${lP(e.path)}${function oie(e){return Object.entries(e).map(([n,t])=>`;${lP(n)}=${lP(t)}`).join("")}(e.parameters)}`}const aie=/^[^\/()?;#]+/;function cP(e){const n=e.match(aie);return n?n[0]:""}const lie=/^[^\/()?;=#]+/,die=/^[^=?&#]+/,hie=/^[^&#]+/;class pie{url;remaining;constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ho([],{}):new ho([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(i[rr]=new ho(n,t)),i}parseSegment(){const n=cP(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new ot(4009,!1);return this.capture(n),new vC(ZE(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=function cie(e){const n=e.match(lie);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=cP(this.remaining);r&&(i=r,this.capture(i))}n[ZE(t)]=ZE(i)}parseQueryParam(n){const t=function uie(e){const n=e.match(die);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const h=function fie(e){const n=e.match(hie);return n?n[0]:""}(this.remaining);h&&(i=h,this.capture(i))}const r=v5(t),a=v5(i);if(n.hasOwnProperty(r)){let h=n[r];Array.isArray(h)||(h=[h],n[r]=h),h.push(a)}else n[r]=a}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=cP(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ot(4010,!1);let a;i.indexOf(":")>-1?(a=i.slice(0,i.indexOf(":")),this.capture(a),this.capture(":")):n&&(a=rr);const h=this.parseChildren();t[a]=1===Object.keys(h).length?h[rr]:new ho([],h),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new ot(4011,!1)}}function x5(e){return e.segments.length>0?new ho([],{[rr]:e}):e}function w5(e){const n={};for(const[i,r]of Object.entries(e.children)){const a=w5(r);if(i===rr&&0===a.segments.length&&a.hasChildren())for(const[h,v]of Object.entries(a.children))n[h]=v;else(a.segments.length>0||a.hasChildren())&&(n[i]=a)}return function mie(e){if(1===e.numberOfChildren&&e.children[rr]){const n=e.children[rr];return new ho(e.segments.concat(n.segments),n.children)}return e}(new ho(e.segments,n))}function Vv(e){return e instanceof zv}function C5(e){let n;const r=x5(function t(a){const h={};for(const C of a.children){const P=t(C);h[C.outlet]=P}const v=new ho(a.url,h);return a===e&&(n=v),v}(e.root));return n??r}function T5(e,n,t,i){let r=e;for(;r.parent;)r=r.parent;if(0===n.length)return dP(r,r,r,t,i);const a=function _ie(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new S5(!0,0,e);let n=0,t=!1;const i=e.reduce((r,a,h)=>{if("object"==typeof a&&null!=a){if(a.outlets){const v={};return Object.entries(a.outlets).forEach(([C,P])=>{v[C]="string"==typeof P?P.split("/"):P}),[...r,{outlets:v}]}if(a.segmentPath)return[...r,a.segmentPath]}return"string"!=typeof a?[...r,a]:0===h?(a.split("/").forEach((v,C)=>{0==C&&"."===v||(0==C&&""===v?t=!0:".."===v?n++:""!=v&&r.push(v))}),r):[...r,a]},[]);return new S5(t,n,i)}(n);if(a.toRoot())return dP(r,r,new ho([],{}),t,i);const h=function yie(e,n,t){if(e.isAbsolute)return new XE(n,!0,0);if(!t)return new XE(n,!1,NaN);if(null===t.parent)return new XE(t,!0,0);const i=YE(e.commands[0])?0:1;return function vie(e,n,t){let i=e,r=n,a=t;for(;a>r;){if(a-=r,i=i.parent,!i)throw new ot(4005,!1);r=i.segments.length}return new XE(i,!1,r-a)}(t,t.segments.length-1+i,e.numberOfDoubleDots)}(a,r,e),v=h.processChildren?wC(h.segmentGroup,h.index,a.commands):E5(h.segmentGroup,h.index,a.commands);return dP(r,h.segmentGroup,v,t,i)}function YE(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function xC(e){return"object"==typeof e&&null!=e&&e.outlets}function dP(e,n,t,i,r){let h,a={};i&&Object.entries(i).forEach(([C,P])=>{a[C]=Array.isArray(P)?P.map(L=>`${L}`):`${P}`}),h=e===n?t:M5(e,n,t);const v=x5(w5(h));return new zv(v,a,r)}function M5(e,n,t){const i={};return Object.entries(e.children).forEach(([r,a])=>{i[r]=a===n?t:M5(a,n,t)}),new ho(e.segments,i)}class S5{isAbsolute;numberOfDoubleDots;commands;constructor(n,t,i){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=i,n&&i.length>0&&YE(i[0]))throw new ot(4003,!1);const r=i.find(xC);if(r&&r!==h5(i))throw new ot(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class XE{segmentGroup;processChildren;index;constructor(n,t,i){this.segmentGroup=n,this.processChildren=t,this.index=i}}function E5(e,n,t){if(e??=new ho([],{}),0===e.segments.length&&e.hasChildren())return wC(e,n,t);const i=function xie(e,n,t){let i=0,r=n;const a={match:!1,pathIndex:0,commandIndex:0};for(;r<e.segments.length;){if(i>=t.length)return a;const h=e.segments[r],v=t[i];if(xC(v))break;const C=`${v}`,P=i<t.length-1?t[i+1]:null;if(r>0&&void 0===C)break;if(C&&P&&"object"==typeof P&&void 0===P.outlets){if(!I5(C,P,h))return a;i+=2}else{if(!I5(C,{},h))return a;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(e,n,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<e.segments.length){const a=new ho(e.segments.slice(0,i.pathIndex),{});return a.children[rr]=new ho(e.segments.slice(i.pathIndex),e.children),wC(a,0,r)}return i.match&&0===r.length?new ho(e.segments,{}):i.match&&!e.hasChildren()?uP(e,n,t):i.match?wC(e,0,r):uP(e,n,t)}function wC(e,n,t){if(0===t.length)return new ho(e.segments,{});{const i=function bie(e){return xC(e[0])?e[0].outlets:{[rr]:e}}(t),r={};if(Object.keys(i).some(a=>a!==rr)&&e.children[rr]&&1===e.numberOfChildren&&0===e.children[rr].segments.length){const a=wC(e.children[rr],n,t);return new ho(e.segments,a.children)}return Object.entries(i).forEach(([a,h])=>{"string"==typeof h&&(h=[h]),null!==h&&(r[a]=E5(e.children[a],n,h))}),Object.entries(e.children).forEach(([a,h])=>{void 0===i[a]&&(r[a]=h)}),new ho(e.segments,r)}}function uP(e,n,t){const i=e.segments.slice(0,n);let r=0;for(;r<t.length;){const a=t[r];if(xC(a)){const C=wie(a.outlets);return new ho(i,C)}if(0===r&&YE(t[0])){i.push(new vC(e.segments[n].path,D5(t[0]))),r++;continue}const h=xC(a)?a.outlets[rr]:`${a}`,v=r<t.length-1?t[r+1]:null;h&&v&&YE(v)?(i.push(new vC(h,D5(v))),r+=2):(i.push(new vC(h,{})),r++)}return new ho(i,{})}function wie(e){const n={};return Object.entries(e).forEach(([t,i])=>{"string"==typeof i&&(i=[i]),null!==i&&(n[t]=uP(new ho([],{}),0,i))}),n}function D5(e){const n={};return Object.entries(e).forEach(([t,i])=>n[t]=`${i}`),n}function I5(e,n,t){return e==t.path&&Zf(n,t.parameters)}const CC="imperative";var Dr=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(Dr||{});class Yf{id;url;constructor(n,t){this.id=n,this.url=t}}class KE extends Yf{type=Dr.NavigationStart;navigationTrigger;restoredState;constructor(n,t,i="imperative",r=null){super(n,t),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Rm extends Yf{urlAfterRedirects;type=Dr.NavigationEnd;constructor(n,t,i){super(n,t),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var vd=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(vd||{}),QE=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(QE||{});class Uv extends Yf{reason;code;type=Dr.NavigationCancel;constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class wx extends Yf{reason;code;type=Dr.NavigationSkipped;constructor(n,t,i,r){super(n,t),this.reason=i,this.code=r}}class hP extends Yf{error;target;type=Dr.NavigationError;constructor(n,t,i,r){super(n,t),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class k5 extends Yf{urlAfterRedirects;state;type=Dr.RoutesRecognized;constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Cie extends Yf{urlAfterRedirects;state;type=Dr.GuardsCheckStart;constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Tie extends Yf{urlAfterRedirects;state;shouldActivate;type=Dr.GuardsCheckEnd;constructor(n,t,i,r,a){super(n,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=a}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Mie extends Yf{urlAfterRedirects;state;type=Dr.ResolveStart;constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Sie extends Yf{urlAfterRedirects;state;type=Dr.ResolveEnd;constructor(n,t,i,r){super(n,t),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Eie{route;type=Dr.RouteConfigLoadStart;constructor(n){this.route=n}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Die{route;type=Dr.RouteConfigLoadEnd;constructor(n){this.route=n}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Iie{snapshot;type=Dr.ChildActivationStart;constructor(n){this.snapshot=n}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class kie{snapshot;type=Dr.ChildActivationEnd;constructor(n){this.snapshot=n}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Aie{snapshot;type=Dr.ActivationStart;constructor(n){this.snapshot=n}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Rie{snapshot;type=Dr.ActivationEnd;constructor(n){this.snapshot=n}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class A5{routerEvent;position;anchor;type=Dr.Scroll;constructor(n,t,i){this.routerEvent=n,this.position=t,this.anchor=i}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class fP{}class JE{url;navigationBehaviorOptions;constructor(n,t){this.url=n,this.navigationBehaviorOptions=t}}function Th(e){return e.outlet||rr}function TC(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class zie{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return TC(this.route?.snapshot)??this.rootInjector}constructor(n){this.rootInjector=n,this.children=new MC(this.rootInjector)}}let MC=(()=>{class e{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,i){const r=this.getOrCreateContext(t);r.outlet=i,this.contexts.set(t,r)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new zie(this.rootInjector),this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(i){return new(i||e)(un(Eo))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class R5{_root;constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=pP(n,this._root);return t?t.children.map(i=>i.value):[]}firstChild(n){const t=pP(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=mP(n,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==n)}pathFromRoot(n){return mP(n,this._root).map(t=>t.value)}}function pP(e,n){if(e===n.value)return n;for(const t of n.children){const i=pP(e,t);if(i)return i}return null}function mP(e,n){if(e===n.value)return[n];for(const t of n.children){const i=mP(e,t);if(i.length)return i.unshift(n),i}return[]}class Mh{value;children;constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function Cx(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class P5 extends R5{snapshot;constructor(n,t){super(n),this.snapshot=t,gP(this,n)}toString(){return this.snapshot.toString()}}function O5(e){const n=function Bie(e){const a=new tD([],{},{},"",{},rr,e,null,{});return new F5("",new Mh(a,[]))}(e),t=new Je([new vC("",{})]),i=new Je({}),r=new Je({}),a=new Je({}),h=new Je(""),v=new jv(t,i,a,h,r,rr,e,n.root);return v.snapshot=n.root,new P5(new Mh(v,[]),n)}class jv{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(n,t,i,r,a,h,v,C){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=a,this.outlet=h,this.component=v,this._futureSnapshot=C,this.title=this.dataSubject?.pipe($t(P=>P[yC]))??vn(void 0),this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=a}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe($t(n=>bx(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe($t(n=>bx(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function eD(e,n,t="emptyOnly"){let i;const{routeConfig:r}=e;return i=null===n||"always"!==t&&""!==r?.path&&(n.component||n.routeConfig?.loadComponent)?{params:{...e.params},data:{...e.data},resolve:{...e.data,...e._resolvedData??{}}}:{params:{...n.params,...e.params},data:{...n.data,...e.data},resolve:{...e.data,...n.data,...r?.data,...e._resolvedData}},r&&N5(r)&&(i.resolve[yC]=r.title),i}class tD{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[yC]}constructor(n,t,i,r,a,h,v,C,P){this.url=n,this.params=t,this.queryParams=i,this.fragment=r,this.data=a,this.outlet=h,this.component=v,this.routeConfig=C,this._resolve=P}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=bx(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=bx(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class F5 extends R5{url;constructor(n,t){super(t),this.url=n,gP(this,t)}toString(){return L5(this._root)}}function gP(e,n){n.value._routerState=e,n.children.forEach(t=>gP(e,t))}function L5(e){const n=e.children.length>0?` { ${e.children.map(L5).join(", ")} } `:"";return`${e.value}${n}`}function _P(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Zf(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Zf(n.params,t.params)||e.paramsSubject.next(t.params),function Kne(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!Zf(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.urlSubject.next(t.url),Zf(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function yP(e,n){const t=Zf(e.params,n.params)&&function tie(e,n){return Bv(e,n)&&e.every((t,i)=>Zf(t.parameters,n[i].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||yP(e.parent,n.parent))}function N5(e){return"string"==typeof e.title||null===e.title}const Vie=new ct("");let nD=(()=>{class e{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=rr;activateEvents=new Dt;deactivateEvents=new Dt;attachEvents=new Dt;detachEvents=new Dt;routerOutletData=wc(void 0);parentContexts=re(MC);location=re(ms);changeDetector=re(Bo);inputBinder=re(iD,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:r}=t.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ot(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ot(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ot(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ot(4013,!1);this._activatedRoute=t;const r=this.location,h=t.snapshot.component,v=this.parentContexts.getOrCreateContext(this.name).children,C=new vP(t,v,r.injector,this.routerOutletData);this.activated=r.createComponent(h,{index:r.length,injector:C,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[sr]})}return e})();class vP{route;childContexts;parent;outletData;__ngOutletInjector(n){return new vP(this.route,this.childContexts,n,this.outletData)}constructor(n,t,i,r){this.route=n,this.childContexts=t,this.parent=i,this.outletData=r}get(n,t){return n===jv?this.route:n===MC?this.childContexts:n===Vie?this.outletData:this.parent.get(n,t)}}const iD=new ct("");let z5=(()=>{class e{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:i}=t,r=Lv([i.queryParams,i.params,i.data]).pipe(Aa(([a,h,v],C)=>(v={...a,...h,...v},0===C?vn(v):Promise.resolve(v)))).subscribe(a=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==i||null===i.component)return void this.unsubscribeFromRouteData(t);const h=function DK(e){const n=Ai(e);if(!n)return null;const t=new N1(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}(i.component);if(h)for(const{templateName:v}of h.inputs)t.activatedComponentRef.setInput(v,a[v]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,r)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();function SC(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=n.value;const r=function jie(e,n,t){return n.children.map(i=>{for(const r of t.children)if(e.shouldReuseRoute(i.value,r.value.snapshot))return SC(e,i,r);return SC(e,i)})}(e,n,t);return new Mh(i,r)}{if(e.shouldAttach(n.value)){const a=e.retrieve(n.value);if(null!==a){const h=a.route;return h.value._futureSnapshot=n.value,h.children=n.children.map(v=>SC(e,v)),h}}const i=function Hie(e){return new jv(new Je(e.url),new Je(e.params),new Je(e.queryParams),new Je(e.fragment),new Je(e.data),e.outlet,e.component,e)}(n.value),r=n.children.map(a=>SC(e,a));return new Mh(i,r)}}class bP{redirectTo;navigationBehaviorOptions;constructor(n,t){this.redirectTo=n,this.navigationBehaviorOptions=t}}const B5="ngNavigationCancelingError";function rD(e,n){const{redirectTo:t,navigationBehaviorOptions:i}=Vv(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,r=V5(!1,vd.Redirect);return r.url=t,r.navigationBehaviorOptions=i,r}function V5(e,n){const t=new Error(`NavigationCancelingError: ${e||""}`);return t[B5]=!0,t.cancellationCode=n,t}function U5(e){return!!e&&e[B5]}class qie{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(n,t,i,r,a){this.routeReuseStrategy=n,this.futureState=t,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=a}activate(n){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,n),_P(this.futureState.root),this.activateChildRoutes(t,i,n)}deactivateChildRoutes(n,t,i){const r=Cx(t);n.children.forEach(a=>{const h=a.value.outlet;this.deactivateRoutes(a,r[h],i),delete r[h]}),Object.values(r).forEach(a=>{this.deactivateRouteAndItsChildren(a,i)})}deactivateRoutes(n,t,i){const r=n.value,a=t?t.value:null;if(r===a)if(r.component){const h=i.getContext(r.outlet);h&&this.deactivateChildRoutes(n,t,h.children)}else this.deactivateChildRoutes(n,t,i);else a&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,a=Cx(n);for(const h of Object.values(a))this.deactivateRouteAndItsChildren(h,r);if(i&&i.outlet){const h=i.outlet.detach(),v=i.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:h,route:n,contexts:v})}}deactivateRouteAndOutlet(n,t){const i=t.getContext(n.value.outlet),r=i&&n.value.component?i.children:t,a=Cx(n);for(const h of Object.values(a))this.deactivateRouteAndItsChildren(h,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(n,t,i){const r=Cx(t);n.children.forEach(a=>{this.activateRoutes(a,r[a.value.outlet],i),this.forwardEvent(new Rie(a.value.snapshot))}),n.children.length&&this.forwardEvent(new kie(n.value.snapshot))}activateRoutes(n,t,i){const r=n.value,a=t?t.value:null;if(_P(r),r===a)if(r.component){const h=i.getOrCreateContext(r.outlet);this.activateChildRoutes(n,t,h.children)}else this.activateChildRoutes(n,t,i);else if(r.component){const h=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){const v=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),h.children.onOutletReAttached(v.contexts),h.attachRef=v.componentRef,h.route=v.route.value,h.outlet&&h.outlet.attach(v.componentRef,v.route.value),_P(v.route.value),this.activateChildRoutes(n,null,h.children)}else h.attachRef=null,h.route=r,h.outlet&&h.outlet.activateWith(r,h.injector),this.activateChildRoutes(n,null,h.children)}else this.activateChildRoutes(n,null,i)}}class j5{path;route;constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class oD{component;route;constructor(n,t){this.component=n,this.route=t}}function Wie(e,n,t){const i=e._root;return EC(i,n?n._root:null,t,[i.value])}function Tx(e,n){const t=Symbol(),i=n.get(e,t);return i===t?"function"!=typeof e||function ya(e){return null!==gi(e)}(e)?n.get(e):e:i}function EC(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const a=Cx(n);return e.children.forEach(h=>{(function Yie(e,n,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const a=e.value,h=n?n.value:null,v=t?t.getContext(e.value.outlet):null;if(h&&a.routeConfig===h.routeConfig){const C=function Xie(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!Bv(e.url,n.url);case"pathParamsOrQueryParamsChange":return!Bv(e.url,n.url)||!Zf(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!yP(e,n)||!Zf(e.queryParams,n.queryParams);default:return!yP(e,n)}}(h,a,a.routeConfig.runGuardsAndResolvers);C?r.canActivateChecks.push(new j5(i)):(a.data=h.data,a._resolvedData=h._resolvedData),EC(e,n,a.component?v?v.children:null:t,i,r),C&&v&&v.outlet&&v.outlet.isActivated&&r.canDeactivateChecks.push(new oD(v.outlet.component,h))}else h&&DC(n,v,r),r.canActivateChecks.push(new j5(i)),EC(e,null,a.component?v?v.children:null:t,i,r)})(h,a[h.value.outlet],t,i.concat([h.value]),r),delete a[h.value.outlet]}),Object.entries(a).forEach(([h,v])=>DC(v,t.getContext(h),r)),r}function DC(e,n,t){const i=Cx(e),r=e.value;Object.entries(i).forEach(([a,h])=>{DC(h,r.component?n?n.children.getContext(a):null:n,t)}),t.canDeactivateChecks.push(new oD(r.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,r))}function IC(e){return"function"==typeof e}function H5(e){return e instanceof UE||"EmptyError"===e?.name}const sD=Symbol("INITIAL_VALUE");function Mx(){return Aa(e=>Lv(e.map(n=>n.pipe(Ac(1),Ch(sD)))).pipe($t(n=>{for(const t of n)if(!0!==t){if(t===sD)return sD;if(!1===t||ire(t))return t}return!0}),is(n=>n!==sD),Ac(1)))}function ire(e){return Vv(e)||e instanceof bP}function $5(e){return function ae(...e){return ge(e)}(Vo(n=>{if("boolean"!=typeof n)throw rD(0,n)}),$t(n=>!0===n))}class xP{segmentGroup;constructor(n){this.segmentGroup=n||null}}class aD extends Error{urlTree;constructor(n){super(),this.urlTree=n}}function Sx(e){return wh(new xP(e))}class gre{urlSerializer;urlTree;constructor(n,t){this.urlSerializer=n,this.urlTree=t}lineralizeSegments(n,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return vn(i);if(r.numberOfChildren>1||!r.children[rr])return wh(new ot(4e3,!1));r=r.children[rr]}}applyRedirectCommands(n,t,i,r,a){if("string"!=typeof t){const v=t,{queryParams:C,fragment:P,routeConfig:L,url:V,outlet:W,params:X,data:oe,title:he}=r,se=As(a,()=>v({params:X,data:oe,queryParams:C,fragment:P,routeConfig:L,url:V,outlet:W,title:he}));if(se instanceof zv)throw new aD(se);t=se}const h=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,i);if("/"===t[0])throw new aD(h);return h}applyRedirectCreateUrlTree(n,t,i,r){const a=this.createSegmentGroup(n,t.root,i,r);return new zv(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const i={};return Object.entries(n).forEach(([r,a])=>{if("string"==typeof a&&":"===a[0]){const v=a.substring(1);i[r]=t[v]}else i[r]=a}),i}createSegmentGroup(n,t,i,r){const a=this.createSegments(n,t.segments,i,r);let h={};return Object.entries(t.children).forEach(([v,C])=>{h[v]=this.createSegmentGroup(n,C,i,r)}),new ho(a,h)}createSegments(n,t,i,r){return t.map(a=>":"===a.path[0]?this.findPosParam(n,a,r):this.findOrReturn(a,i))}findPosParam(n,t,i){const r=i[t.path.substring(1)];if(!r)throw new ot(4001,!1);return r}findOrReturn(n,t){let i=0;for(const r of t){if(r.path===n.path)return t.splice(i),r;i++}return n}}const wP={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function _re(e,n,t,i,r){const a=G5(e,n,t);return a.matched?(i=function Pie(e,n){return e.providers&&!e._injector&&(e._injector=IS(e.providers,n,`Route: ${e.path}`)),e._injector??n}(n,i),function fre(e,n,t,i){const r=n.canMatch;return r&&0!==r.length?vn(r.map(h=>{const v=Tx(h,e);return S_(function nre(e){return e&&IC(e.canMatch)}(v)?v.canMatch(n,t):As(e,()=>v(n,t)))})).pipe(Mx(),$5()):vn(!0)}(i,n,t).pipe($t(h=>!0===h?a:{...wP}))):vn(a)}function G5(e,n,t){if("**"===n.path)return function yre(e){return{matched:!0,parameters:e.length>0?h5(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}(t);if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...wP}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const r=(n.matcher||Xne)(t,e,n);if(!r)return{...wP};const a={};Object.entries(r.posParams??{}).forEach(([v,C])=>{a[v]=C.path});const h=r.consumed.length>0?{...a,...r.consumed[r.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:r.consumed,remainingSegments:t.slice(r.consumed.length),parameters:h,positionalParamSegments:r.posParams??{}}}function q5(e,n,t,i){return t.length>0&&function xre(e,n,t){return t.some(i=>lD(e,n,i)&&Th(i)!==rr)}(e,t,i)?{segmentGroup:new ho(n,bre(i,new ho(t,e.children))),slicedSegments:[]}:0===t.length&&function wre(e,n,t){return t.some(i=>lD(e,n,i))}(e,t,i)?{segmentGroup:new ho(e.segments,vre(e,t,i,e.children)),slicedSegments:t}:{segmentGroup:new ho(e.segments,e.children),slicedSegments:t}}function vre(e,n,t,i){const r={};for(const a of t)if(lD(e,n,a)&&!i[Th(a)]){const h=new ho([],{});r[Th(a)]=h}return{...i,...r}}function bre(e,n){const t={};t[rr]=n;for(const i of e)if(""===i.path&&Th(i)!==rr){const r=new ho([],{});t[Th(i)]=r}return t}function lD(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}class Tre{}class Ere{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(n,t,i,r,a,h,v){this.injector=n,this.configLoader=t,this.rootComponentType=i,this.config=r,this.urlTree=a,this.paramsInheritanceStrategy=h,this.urlSerializer=v,this.applyRedirects=new gre(this.urlSerializer,this.urlTree)}noMatchError(n){return new ot(4002,`'${n.segmentGroup}'`)}recognize(){const n=q5(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(n).pipe($t(({children:t,rootSnapshot:i})=>{const r=new Mh(i,t),a=new F5("",r),h=function gie(e,n,t=null,i=null){return T5(C5(e),n,t,i)}(i,[],this.urlTree.queryParams,this.urlTree.fragment);return h.queryParams=this.urlTree.queryParams,a.url=this.urlSerializer.serialize(h),{state:a,tree:h}}))}match(n){const t=new tD([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),rr,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,n,rr,t).pipe($t(i=>({children:i,rootSnapshot:t})),rs(i=>{if(i instanceof aD)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof xP?this.noMatchError(i):i}))}processSegmentGroup(n,t,i,r,a){return 0===i.segments.length&&i.hasChildren()?this.processChildren(n,t,i,a):this.processSegment(n,t,i,i.segments,r,!0,a).pipe($t(h=>h instanceof Mh?[h]:[]))}processChildren(n,t,i,r){const a=[];for(const h of Object.keys(i.children))"primary"===h?a.unshift(h):a.push(h);return js(a).pipe(yx(h=>{const v=i.children[h],C=function Nie(e,n){const t=e.filter(i=>Th(i)===n);return t.push(...e.filter(i=>Th(i)!==n)),t}(t,h);return this.processSegmentGroup(n,C,v,h,r)}),function Wne(e,n){return Tt(function qne(e,n,t,i,r){return(a,h)=>{let v=t,C=n,P=0;a.subscribe(Mt(h,L=>{const V=P++;C=v?e(C,L,V):(v=!0,L),i&&h.next(C)},r&&(()=>{v&&h.next(C),h.complete()})))}}(e,n,arguments.length>=2,!0))}((h,v)=>(h.push(...v),h)),HE(null),function Zne(e,n){const t=arguments.length>=2;return i=>i.pipe(e?is((r,a)=>e(r,a,i)):ie,sP(1),t?HE(n):d5(()=>new UE))}(),Ka(h=>{if(null===h)return Sx(i);const v=W5(h);return function Dre(e){e.sort((n,t)=>n.value.outlet===rr?-1:t.value.outlet===rr?1:n.value.outlet.localeCompare(t.value.outlet))}(v),vn(v)}))}processSegment(n,t,i,r,a,h,v){return js(t).pipe(yx(C=>this.processSegmentAgainstRoute(C._injector??n,t,C,i,r,a,h,v).pipe(rs(P=>{if(P instanceof xP)return vn(null);throw P}))),Nv(C=>!!C),rs(C=>{if(H5(C))return function Cre(e,n,t){return 0===n.length&&!e.children[t]}(i,r,a)?vn(new Tre):Sx(i);throw C}))}processSegmentAgainstRoute(n,t,i,r,a,h,v,C){return Th(i)===h||h!==rr&&lD(r,a,i)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(n,r,i,a,h,C):this.allowRedirects&&v?this.expandSegmentAgainstRouteUsingRedirect(n,r,t,i,a,h,C):Sx(r):Sx(r)}expandSegmentAgainstRouteUsingRedirect(n,t,i,r,a,h,v){const{matched:C,parameters:P,consumedSegments:L,positionalParamSegments:V,remainingSegments:W}=G5(t,r,a);if(!C)return Sx(t);"string"==typeof r.redirectTo&&"/"===r.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const X=new tD(a,P,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Z5(r),Th(r),r.component??r._loadedComponent??null,r,Y5(r)),oe=eD(X,v,this.paramsInheritanceStrategy);X.params=Object.freeze(oe.params),X.data=Object.freeze(oe.data);const he=this.applyRedirects.applyRedirectCommands(L,r.redirectTo,V,X,n);return this.applyRedirects.lineralizeSegments(r,he).pipe(Ka(se=>this.processSegment(n,i,t,se.concat(W),h,!1,v)))}matchSegmentAgainstRoute(n,t,i,r,a,h){const v=_re(t,i,r,n);return"**"===i.path&&(t.children={}),v.pipe(Aa(C=>C.matched?this.getChildConfig(n=i._injector??n,i,r).pipe(Aa(({routes:P})=>{const L=i._loadedInjector??n,{parameters:V,consumedSegments:W,remainingSegments:X}=C,oe=new tD(W,V,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Z5(i),Th(i),i.component??i._loadedComponent??null,i,Y5(i)),he=eD(oe,h,this.paramsInheritanceStrategy);oe.params=Object.freeze(he.params),oe.data=Object.freeze(he.data);const{segmentGroup:se,slicedSegments:_e}=q5(t,W,X,P);if(0===_e.length&&se.hasChildren())return this.processChildren(L,P,se,oe).pipe($t($e=>new Mh(oe,$e)));if(0===P.length&&0===_e.length)return vn(new Mh(oe,[]));const Se=Th(i)===a;return this.processSegment(L,P,se,_e,Se?rr:a,!0,oe).pipe($t($e=>new Mh(oe,$e instanceof Mh?[$e]:[])))})):Sx(t)))}getChildConfig(n,t,i){return t.children?vn({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?vn({routes:t._loadedRoutes,injector:t._loadedInjector}):function hre(e,n,t,i){const r=n.canLoad;return void 0===r||0===r.length?vn(!0):vn(r.map(h=>{const v=Tx(h,e);return S_(function Qie(e){return e&&IC(e.canLoad)}(v)?v.canLoad(n,t):As(e,()=>v(n,t)))})).pipe(Mx(),$5())}(n,t,i).pipe(Ka(r=>r?this.configLoader.loadChildren(n,t).pipe(Vo(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function mre(){return wh(V5(!1,vd.GuardRejected))}())):vn({routes:[],injector:n})}}function Ire(e){const n=e.value.routeConfig;return n&&""===n.path}function W5(e){const n=[],t=new Set;for(const i of e){if(!Ire(i)){n.push(i);continue}const r=n.find(a=>i.value.routeConfig===a.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):n.push(i)}for(const i of t){const r=W5(i.children);n.push(new Mh(i.value,r))}return n.filter(i=>!t.has(i))}function Z5(e){return e.data||{}}function Y5(e){return e.resolve||{}}function X5(e){const n=e.children.map(t=>X5(t)).flat();return[e,...n]}function CP(e){return Aa(n=>{const t=e(n);return t?js(t).pipe($t(()=>n)):vn(n)})}let K5=(()=>{class e{buildTitle(t){let i,r=t.root;for(;void 0!==r;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(a=>a.outlet===rr);return i}getResolvedTitleForRoute(t){return t.data[yC]}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>re(Fre),providedIn:"root"})}return e})(),Fre=(()=>{class e extends K5{title;constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||e)(un(WJ))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ex=new ct("",{providedIn:"root",factory:()=>({})});let Q5=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){1&i&&_n(0,"router-outlet")},dependencies:[nD],encapsulation:2})}return e})();function TP(e){const n=e.children&&e.children.map(TP),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==rr&&(t.component=Q5),t}const Dx=new ct("");let MP=(()=>{class e{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=re(uB);loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return vn(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=S_(t.loadComponent()).pipe($t(J5),Vo(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),vx(()=>{this.componentLoaders.delete(t)})),r=new oP(i,()=>new Ie).pipe(rP());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return vn({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const a=function Lre(e,n,t,i){return S_(e.loadChildren()).pipe($t(J5),Ka(r=>r instanceof AN||Array.isArray(r)?vn(r):js(n.compileModuleAsync(r))),$t(r=>{i&&i(e);let a,h,v=!1;return Array.isArray(r)?(h=r,!0):(a=r.create(t).injector,h=a.get(Dx,[],{optional:!0,self:!0}).flat()),{routes:h.map(TP),injector:a}}))}(i,this.compiler,t,this.onLoadEndListener).pipe(vx(()=>{this.childrenLoaders.delete(i)})),h=new oP(a,()=>new Ie).pipe(rP());return this.childrenLoaders.set(i,h),h}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function J5(e){return function Nre(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let SP=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>re(zre),providedIn:"root"})}return e})(),zre=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const eU=new ct(""),tU=new ct("");function Bre(e,n,t){const i=e.get(tU),r=e.get(ir);return e.get(Ht).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(P=>setTimeout(P));let a;const h=new Promise(P=>{a=P}),v=r.startViewTransition(()=>(a(),function Vre(e){return new Promise(n=>{Tc({read:()=>setTimeout(n)},{injector:e})})}(e))),{onViewTransitionCreated:C}=i;return C&&As(e,()=>C({transition:v,from:n,to:t})),h})}const EP=new ct("");let cD=(()=>{class e{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new Ie;transitionAbortSubject=new Ie;configLoader=re(MP);environmentInjector=re(Eo);urlSerializer=re(xx);rootContexts=re(MC);location=re(fx);inputBindingEnabled=null!==re(iD,{optional:!0});titleStrategy=re(K5);options=re(Ex,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=re(SP);createViewTransition=re(eU,{optional:!0});navigationErrorHandler=re(EP,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>vn(void 0);rootComponentType=null;constructor(){this.configLoader.onLoadEndListener=r=>this.events.next(new Die(r)),this.configLoader.onLoadStartListener=r=>this.events.next(new Eie(r))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t,i,r){return this.transitions=new Je({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:CC,restoredState:null,currentSnapshot:r.snapshot,targetSnapshot:null,currentRouterState:r,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(is(a=>0!==a.id),$t(a=>({...a,extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),Aa(a=>{let h=!1,v=!1;return vn(a).pipe(Aa(C=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",vd.SupersededByNewNavigation),yd;this.currentTransition=a,this.currentNavigation={id:C.id,initialUrl:C.rawUrl,extractedUrl:C.extractedUrl,targetBrowserUrl:"string"==typeof C.extras.browserUrl?this.urlSerializer.parse(C.extras.browserUrl):C.extras.browserUrl,trigger:C.source,extras:C.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null};const P=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!P&&"reload"!==(C.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const V="";return this.events.next(new wx(C.id,this.urlSerializer.serialize(C.rawUrl),V,QE.IgnoredSameUrlNavigation)),C.resolve(!1),yd}if(this.urlHandlingStrategy.shouldProcessUrl(C.rawUrl))return vn(C).pipe(Aa(V=>{const W=this.transitions?.getValue();return this.events.next(new KE(V.id,this.urlSerializer.serialize(V.extractedUrl),V.source,V.restoredState)),W!==this.transitions?.getValue()?yd:Promise.resolve(V)}),function kre(e,n,t,i,r,a){return Ka(h=>function Mre(e,n,t,i,r,a,h="emptyOnly"){return new Ere(e,n,t,i,r,h,a).recognize()}(e,n,t,i,h.extractedUrl,r,a).pipe($t(({state:v,tree:C})=>({...h,targetSnapshot:v,urlAfterRedirects:C}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Vo(V=>{a.targetSnapshot=V.targetSnapshot,a.urlAfterRedirects=V.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:V.urlAfterRedirects};const W=new k5(V.id,this.urlSerializer.serialize(V.extractedUrl),this.urlSerializer.serialize(V.urlAfterRedirects),V.targetSnapshot);this.events.next(W)}));if(P&&this.urlHandlingStrategy.shouldProcessUrl(C.currentRawUrl)){const{id:V,extractedUrl:W,source:X,restoredState:oe,extras:he}=C,se=new KE(V,this.urlSerializer.serialize(W),X,oe);this.events.next(se);const _e=O5(this.rootComponentType).snapshot;return this.currentTransition=a={...C,targetSnapshot:_e,urlAfterRedirects:W,extras:{...he,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=W,vn(a)}{const V="";return this.events.next(new wx(C.id,this.urlSerializer.serialize(C.extractedUrl),V,QE.IgnoredByUrlHandlingStrategy)),C.resolve(!1),yd}}),Vo(C=>{const P=new Cie(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects),C.targetSnapshot);this.events.next(P)}),$t(C=>(this.currentTransition=a={...C,guards:Wie(C.targetSnapshot,C.currentSnapshot,this.rootContexts)},a)),function rre(e,n){return Ka(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:a,canDeactivateChecks:h}}=t;return 0===h.length&&0===a.length?vn({...t,guardsResult:!0}):function ore(e,n,t,i){return js(e).pipe(Ka(r=>function ure(e,n,t,i,r){const a=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return a&&0!==a.length?vn(a.map(v=>{const C=TC(n)??r,P=Tx(v,C);return S_(function tre(e){return e&&IC(e.canDeactivate)}(P)?P.canDeactivate(e,n,t,i):As(C,()=>P(e,n,t,i))).pipe(Nv())})).pipe(Mx()):vn(!0)}(r.component,r.route,t,n,i)),Nv(r=>!0!==r,!0))}(h,i,r,e).pipe(Ka(v=>v&&function Kie(e){return"boolean"==typeof e}(v)?function sre(e,n,t,i){return js(n).pipe(yx(r=>jE(function lre(e,n){return null!==e&&n&&n(new Iie(e)),vn(!0)}(r.route.parent,i),function are(e,n){return null!==e&&n&&n(new Aie(e)),vn(!0)}(r.route,i),function dre(e,n,t){const i=n[n.length-1],a=n.slice(0,n.length-1).reverse().map(h=>function Zie(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(h)).filter(h=>null!==h).map(h=>iP(()=>vn(h.guards.map(C=>{const P=TC(h.node)??t,L=Tx(C,P);return S_(function ere(e){return e&&IC(e.canActivateChild)}(L)?L.canActivateChild(i,e):As(P,()=>L(i,e))).pipe(Nv())})).pipe(Mx())));return vn(a).pipe(Mx())}(e,r.path,t),function cre(e,n,t){const i=n.routeConfig?n.routeConfig.canActivate:null;if(!i||0===i.length)return vn(!0);const r=i.map(a=>iP(()=>{const h=TC(n)??t,v=Tx(a,h);return S_(function Jie(e){return e&&IC(e.canActivate)}(v)?v.canActivate(n,e):As(h,()=>v(n,e))).pipe(Nv())}));return vn(r).pipe(Mx())}(e,r.route,t))),Nv(r=>!0!==r,!0))}(i,a,e,n):vn(v)),$t(v=>({...t,guardsResult:v})))})}(this.environmentInjector,C=>this.events.next(C)),Vo(C=>{if(a.guardsResult=C.guardsResult,C.guardsResult&&"boolean"!=typeof C.guardsResult)throw rD(0,C.guardsResult);const P=new Tie(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects),C.targetSnapshot,!!C.guardsResult);this.events.next(P)}),is(C=>!!C.guardsResult||(this.cancelNavigationTransition(C,"",vd.GuardRejected),!1)),CP(C=>{if(C.guards.canActivateChecks.length)return vn(C).pipe(Vo(P=>{const L=new Mie(P.id,this.urlSerializer.serialize(P.extractedUrl),this.urlSerializer.serialize(P.urlAfterRedirects),P.targetSnapshot);this.events.next(L)}),Aa(P=>{let L=!1;return vn(P).pipe(function Are(e,n){return Ka(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return vn(t);const a=new Set(r.map(C=>C.route)),h=new Set;for(const C of a)if(!h.has(C))for(const P of X5(C))h.add(P);let v=0;return js(h).pipe(yx(C=>a.has(C)?function Rre(e,n,t,i){const r=e.routeConfig,a=e._resolve;return void 0!==r?.title&&!N5(r)&&(a[yC]=r.title),function Pre(e,n,t,i){const r=aP(e);if(0===r.length)return vn({});const a={};return js(r).pipe(Ka(h=>function Ore(e,n,t,i){const r=TC(n)??i,a=Tx(e,r);return S_(a.resolve?a.resolve(n,t):As(r,()=>a(n,t)))}(e[h],n,t,i).pipe(Nv(),Vo(v=>{if(v instanceof bP)throw rD(new GE,v);a[h]=v}))),sP(1),$t(()=>a),rs(h=>H5(h)?yd:wh(h)))}(a,e,n,i).pipe($t(h=>(e._resolvedData=h,e.data=eD(e,e.parent,t).resolve,null)))}(C,i,e,n):(C.data=eD(C,C.parent,e).resolve,vn(void 0))),Vo(()=>v++),sP(1),Ka(C=>v===h.size?vn(t):yd))})}(this.paramsInheritanceStrategy,this.environmentInjector),Vo({next:()=>L=!0,complete:()=>{L||this.cancelNavigationTransition(P,"",vd.NoDataFromResolver)}}))}),Vo(P=>{const L=new Sie(P.id,this.urlSerializer.serialize(P.extractedUrl),this.urlSerializer.serialize(P.urlAfterRedirects),P.targetSnapshot);this.events.next(L)}))}),CP(C=>{const P=L=>{const V=[];L.routeConfig?.loadComponent&&!L.routeConfig._loadedComponent&&V.push(this.configLoader.loadComponent(L.routeConfig).pipe(Vo(W=>{L.component=W}),$t(()=>{})));for(const W of L.children)V.push(...P(W));return V};return Lv(P(C.targetSnapshot.root)).pipe(HE(null),Ac(1))}),CP(()=>this.afterPreactivation()),Aa(()=>{const{currentSnapshot:C,targetSnapshot:P}=a,L=this.createViewTransition?.(this.environmentInjector,C.root,P.root);return L?js(L).pipe($t(()=>a)):vn(a)}),$t(C=>{const P=function Uie(e,n,t){const i=SC(e,n._root,t?t._root:void 0);return new P5(i,n)}(t.routeReuseStrategy,C.targetSnapshot,C.currentRouterState);return this.currentTransition=a={...C,targetRouterState:P},this.currentNavigation.targetRouterState=P,a}),Vo(()=>{this.events.next(new fP)}),((e,n,t,i)=>$t(r=>(new qie(n,r.targetRouterState,r.currentRouterState,t,i).activate(e),r)))(this.rootContexts,t.routeReuseStrategy,C=>this.events.next(C),this.inputBindingEnabled),Ac(1),Vo({next:C=>{h=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Rm(C.id,this.urlSerializer.serialize(C.extractedUrl),this.urlSerializer.serialize(C.urlAfterRedirects))),this.titleStrategy?.updateTitle(C.targetRouterState.snapshot),C.resolve(!0)},complete:()=>{h=!0}}),Er(this.transitionAbortSubject.pipe(Vo(C=>{throw C}))),vx(()=>{!h&&!v&&this.cancelNavigationTransition(a,"",vd.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),rs(C=>{if(v=!0,U5(C))this.events.next(new Uv(a.id,this.urlSerializer.serialize(a.extractedUrl),C.message,C.cancellationCode)),function $ie(e){return U5(e)&&Vv(e.url)}(C)?this.events.next(new JE(C.url,C.navigationBehaviorOptions)):a.resolve(!1);else{const P=new hP(a.id,this.urlSerializer.serialize(a.extractedUrl),C,a.targetSnapshot??void 0);try{const L=As(this.environmentInjector,()=>this.navigationErrorHandler?.(P));if(!(L instanceof bP))throw this.events.next(P),C;{const{message:V,cancellationCode:W}=rD(0,L);this.events.next(new Uv(a.id,this.urlSerializer.serialize(a.extractedUrl),V,W)),this.events.next(new JE(L.redirectTo,L.navigationBehaviorOptions))}}catch(L){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(L)}}return yd}))}))}cancelNavigationTransition(t,i,r){const a=new Uv(t.id,this.urlSerializer.serialize(t.extractedUrl),i,r);this.events.next(a),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ure(e){return e!==CC}let jre=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>re($re),providedIn:"root"})}return e})();class Hre{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let $re=(()=>{class e extends Hre{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),nU=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:()=>re(Gre),providedIn:"root"})}return e})(),Gre=(()=>{class e extends nU{location=re(fx);urlSerializer=re(xx);options=re(Ex,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";urlHandlingStrategy=re(SP);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new zv;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}routerState=O5(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(i=>{"popstate"===i.type&&t(i.url,i.state)})}handleRouterEvent(t,i){if(t instanceof KE)this.stateMemento=this.createStateMemento();else if(t instanceof wx)this.rawUrlTree=i.initialUrl;else if(t instanceof k5){if("eager"===this.urlUpdateStrategy&&!i.extras.skipLocationChange){const r=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??r,i)}}else t instanceof fP?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):t instanceof Uv&&(t.code===vd.GuardRejected||t.code===vd.NoDataFromResolver)?this.restoreHistory(i):t instanceof hP?this.restoreHistory(i,!0):t instanceof Rm&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,i){const r=t instanceof zv?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl){const h={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(r,"",h)}else{const a={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId+1)};this.location.go(r,"",a)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const a=this.currentPageId-this.browserPageId;0!==a?this.location.historyGo(a):this.currentUrlTree===t.finalUrl&&0===a&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var kC=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(kC||{});function iU(e,n){e.events.pipe(is(t=>t instanceof Rm||t instanceof Uv||t instanceof hP||t instanceof wx),$t(t=>t instanceof Rm||t instanceof wx?kC.COMPLETE:t instanceof Uv&&(t.code===vd.Redirect||t.code===vd.SupersededByNewNavigation)?kC.REDIRECTING:kC.FAILED),is(t=>t!==kC.REDIRECTING),Ac(1)).subscribe(()=>{n()})}const qre={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Wre={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Qa=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=re(YN);stateManager=re(nU);options=re(Ex,{optional:!0})||{};pendingTasks=re(hn);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=re(cD);urlSerializer=re(xx);location=re(fx);urlHandlingStrategy=re(SP);_events=new Ie;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=re(jre);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=re(Dx,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!re(iD,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Ni;subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(i=>{try{const r=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(null!==r&&null!==a)if(this.stateManager.handleRouterEvent(i,a),i instanceof Uv&&i.code!==vd.Redirect&&i.code!==vd.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Rm)this.navigated=!0;else if(i instanceof JE){const h=i.navigationBehaviorOptions,v=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),C={browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||"eager"===this.urlUpdateStrategy||Ure(r.source),...h};this.scheduleNavigation(v,CC,null,C,{resolve:r.resolve,reject:r.reject,promise:r.promise})}(function Yre(e){return!(e instanceof fP||e instanceof JE)})(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),CC,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",i)},0)})}navigateToSyncWithBrowser(t,i,r){const a={replaceUrl:!0},h=r?.navigationId?r:null;if(r){const C={...r};delete C.navigationId,delete C.\u0275routerPageId,0!==Object.keys(C).length&&(a.state=C)}const v=this.parseUrl(t);this.scheduleNavigation(v,i,h,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(TP),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,i={}){const{relativeTo:r,queryParams:a,fragment:h,queryParamsHandling:v,preserveFragment:C}=i,P=C?this.currentUrlTree.fragment:h;let V,L=null;switch(v??this.options.defaultQueryParamsHandling){case"merge":L={...this.currentUrlTree.queryParams,...a};break;case"preserve":L=this.currentUrlTree.queryParams;break;default:L=a||null}null!==L&&(L=this.removeEmptyProps(L));try{V=C5(r?r.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||"/"!==t[0][0])&&(t=[]),V=this.currentUrlTree.root}return T5(V,t,L,P??null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Vv(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(a,CC,null,i)}navigate(t,i={skipLocationChange:!1}){return function Zre(e){for(let n=0;n<e.length;n++)if(null==e[n])throw new ot(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,i){let r;if(r=!0===i?{...qre}:!1===i?{...Wre}:i,Vv(t))return p5(this.currentUrlTree,t,r);const a=this.parseUrl(t);return p5(this.currentUrlTree,a,r)}removeEmptyProps(t){return Object.entries(t).reduce((i,[r,a])=>(null!=a&&(i[r]=a),i),{})}scheduleNavigation(t,i,r,a,h){if(this.disposed)return Promise.resolve(!1);let v,C,P;h?(v=h.resolve,C=h.reject,P=h.promise):P=new Promise((V,W)=>{v=V,C=W});const L=this.pendingTasks.add();return iU(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(L))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:a,resolve:v,reject:C,promise:P,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),P.catch(V=>Promise.reject(V))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),dD=(()=>{class e{router;route;tabIndexAttribute;renderer;el;locationStrategy;href=null;target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Ie;constructor(t,i,r,a,h,v){this.router=t,this.route=i,this.tabIndexAttribute=r,this.renderer=a,this.el=h,this.locationStrategy=v;const C=h.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===C||"area"===C,this.isAnchorElement?this.subscription=t.events.subscribe(P=>{P instanceof Rm&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){null==t?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(this.routerLinkInput=Vv(t)||Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,i,r,a,h){const v=this.urlTree;return!!(null===v||this.isAnchorElement&&(0!==t||i||r||a||h||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(v,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){const t=this.urlTree;this.href=null!==t&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;const i=null===this.href?null:function i1(e,n,t){return function u0(e,n){return"src"===n&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===n&&("base"===e||"link"===e)?t1:eu}(n,t)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(t,i){const r=this.renderer,a=this.el.nativeElement;null!==i?r.setAttribute(a,t,i):r.removeAttribute(a,t)}get urlTree(){return null===this.routerLinkInput?null:Vv(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||e)(Rt(Qa),Rt(jv),J("tabindex"),Rt(Ns),Rt(In),Rt(Rv))};static \u0275dir=Bt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,r){1&i&&Nn("click",function(h){return r.onClick(h.button,h.ctrlKey,h.shiftKey,h.altKey,h.metaKey)}),2&i&&ui("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",zn],skipLocationChange:[2,"skipLocationChange","skipLocationChange",zn],replaceUrl:[2,"replaceUrl","replaceUrl",zn],routerLink:"routerLink"},features:[jr,sr]})}return e})();class rU{}let Qre=(()=>{class e{router;injector;preloadingStrategy;loader;subscription;constructor(t,i,r,a,h){this.router=t,this.injector=r,this.preloadingStrategy=a,this.loader=h}setUpPreloading(){this.subscription=this.router.events.pipe(is(t=>t instanceof Rm),yx(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const r=[];for(const a of i){a.providers&&!a._injector&&(a._injector=IS(a.providers,t,`Route: ${a.path}`));const h=a._injector??t,v=a._loadedInjector??h;(a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent)&&r.push(this.preloadConfig(h,a)),(a.children||a._loadedRoutes)&&r.push(this.processRoutes(v,a.children??a._loadedRoutes))}return js(r).pipe(_x())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):vn(null);const a=r.pipe(Ka(h=>null===h?vn(void 0):(i._loadedRoutes=h.routes,i._loadedInjector=h.injector,this.processRoutes(h.injector??t,h.routes))));return i.loadComponent&&!i._loadedComponent?js([a,this.loader.loadComponent(i)]).pipe(_x()):a})}static \u0275fac=function(i){return new(i||e)(un(Qa),un(uB),un(Eo),un(rU),un(MP))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const DP=new ct("");let oU=(()=>{class e{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(t,i,r,a,h={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=r,this.zone=a,this.options=h,h.scrollPositionRestoration||="disabled",h.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof KE?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Rm?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof wx&&t.code===QE.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof A5&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new A5(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(i){!function R0(){throw new Error("invalid")}()};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();function Xf(e,n){return{\u0275kind:e,\u0275providers:n}}function aU(){const e=re(Ye);return n=>{const t=e.get(Wa);if(n!==t.components[0])return;const i=e.get(Qa),r=e.get(lU);1===e.get(IP)&&i.initialNavigation(),e.get(cU,null,Xi.Optional)?.setUpPreloading(),e.get(DP,null,Xi.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}const lU=new ct("",{factory:()=>new Ie}),IP=new ct("",{providedIn:"root",factory:()=>1}),cU=new ct("");function noe(e){return Xf(0,[{provide:cU,useExisting:Qre},{provide:rU,useExisting:e}])}function roe(e){return Xf(9,[{provide:eU,useValue:Bre},{provide:tU,useValue:{skipNextTransition:!!e?.skipInitialTransition,...e}}])}const dU=new ct("ROUTER_FORROOT_GUARD"),ooe=[fx,{provide:xx,useClass:GE},Qa,MC,{provide:jv,useFactory:function sU(e){return e.routerState.root},deps:[Qa]},MP,[]];let kP=(()=>{class e{constructor(t){}static forRoot(t,i){return{ngModule:e,providers:[ooe,[],{provide:Dx,multi:!0,useValue:t},{provide:dU,useFactory:coe,deps:[[Qa,new Kr,new hc]]},i?.errorHandler?{provide:EP,useValue:i.errorHandler}:[],{provide:Ex,useValue:i||{}},i?.useHash?{provide:Rv,useClass:PK}:{provide:Rv,useClass:hV},{provide:DP,useFactory:()=>{const e=re(WQ),n=re(Ht),t=re(Ex),i=re(cD),r=re(xx);return t.scrollOffset&&e.setOffset(t.scrollOffset),new oU(r,i,e,n,t)}},i?.preloadingStrategy?noe(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?doe(i):[],i?.bindToComponentInputs?Xf(8,[z5,{provide:iD,useExisting:z5}]).\u0275providers:[],i?.enableViewTransitions?roe().\u0275providers:[],[{provide:uU,useFactory:aU},{provide:H1,multi:!0,useExisting:uU}]]}}static forChild(t){return{ngModule:e,providers:[{provide:Dx,multi:!0,useValue:t}]}}static \u0275fac=function(i){return new(i||e)(un(dU,8))};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();function coe(e){return"guarded"}function doe(e){return["disabled"===e.initialNavigation?Xf(3,[{provide:BS,multi:!0,useFactory:()=>{const n=re(Qa);return()=>{n.setUpLocationChangeListener()}}},{provide:IP,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?Xf(2,[{provide:IP,useValue:0},{provide:BS,multi:!0,deps:[Ye],useFactory:n=>{const t=n.get(AK,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const r=n.get(Qa),a=n.get(lU);iU(r,()=>{i(!0)}),n.get(cD).afterPreactivation=()=>(i(!0),a.closed?vn(void 0):a),r.initialNavigation()}))}}]).\u0275providers:[]]}const uU=new ct("");function hU(...e){const n=s5(e),{args:t,keys:i}=a5(e),r=new Ce(a=>{const{length:h}=t;if(!h)return void a.complete();const v=new Array(h);let C=h,P=h;for(let L=0;L<h;L++){let V=!1;ec(t[L]).subscribe(Mt(a,W=>{V||(V=!0,P--),v[L]=W},()=>C--,void 0,()=>{(!C||!V)&&(P||a.next(i?l5(i,v):v),a.complete())}))}});return n?r.pipe(nP(n)):r}let fU=(()=>{class e{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,i){this._renderer=t,this._elementRef=i}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(i){return new(i||e)(Rt(Ns),Rt(In))};static \u0275dir=Bt({type:e})}return e})(),Hv=(()=>{class e extends fU{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,features:[Gn]})}return e})();const Rc=new ct(""),poe={provide:Rc,useExisting:zi(()=>uD),multi:!0},goe=new ct("");let uD=(()=>{class e extends fU{_compositionMode;_composing=!1;constructor(t,i,r){super(t,i),this._compositionMode=r,null==this._compositionMode&&(this._compositionMode=!function moe(){const e=x_()?x_().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(i){return new(i||e)(Rt(Ns),Rt(In),Rt(goe,8))};static \u0275dir=Bt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&Nn("input",function(h){return r._handleInput(h.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(h){return r._compositionEnd(h.target.value)})},standalone:!1,features:[Jn([poe]),Gn]})}return e})();function E_(e){return null==e||("string"==typeof e||Array.isArray(e))&&0===e.length}function mU(e){return null!=e&&"number"==typeof e.length}const Ra=new ct(""),D_=new ct(""),_oe=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/;class gU{static min(n){return function _U(e){return n=>{if(E_(n.value)||E_(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t<e?{min:{min:e,actual:n.value}}:null}}(n)}static max(n){return function yU(e){return n=>{if(E_(n.value)||E_(e))return null;const t=parseFloat(n.value);return!isNaN(t)&&t>e?{max:{max:e,actual:n.value}}:null}}(n)}static required(n){return function vU(e){return E_(e.value)?{required:!0}:null}(n)}static requiredTrue(n){return function bU(e){return!0===e.value?null:{required:!0}}(n)}static email(n){return function xU(e){return E_(e.value)||_oe.test(e.value)?null:{email:!0}}(n)}static minLength(n){return function wU(e){return n=>E_(n.value)||!mU(n.value)?null:n.value.length<e?{minlength:{requiredLength:e,actualLength:n.value.length}}:null}(n)}static maxLength(n){return function CU(e){return n=>mU(n.value)&&n.value.length>e?{maxlength:{requiredLength:e,actualLength:n.value.length}}:null}(n)}static pattern(n){return function TU(e){if(!e)return hD;let n,t;return"string"==typeof e?(t="","^"!==e.charAt(0)&&(t+="^"),t+=e,"$"!==e.charAt(e.length-1)&&(t+="$"),n=new RegExp(t)):(t=e.toString(),n=e),i=>{if(E_(i.value))return null;const r=i.value;return n.test(r)?null:{pattern:{requiredPattern:t,actualValue:r}}}}(n)}static nullValidator(n){return null}static compose(n){return kU(n)}static composeAsync(n){return AU(n)}}function hD(e){return null}function MU(e){return null!=e}function SU(e){return j1(e)?js(e):e}function EU(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function DU(e,n){return n.map(t=>t(e))}function IU(e){return e.map(n=>function yoe(e){return!e.validate}(n)?n:t=>n.validate(t))}function kU(e){if(!e)return null;const n=e.filter(MU);return 0==n.length?null:function(t){return EU(DU(t,n))}}function AP(e){return null!=e?kU(IU(e)):null}function AU(e){if(!e)return null;const n=e.filter(MU);return 0==n.length?null:function(t){return hU(DU(t,n).map(SU)).pipe($t(EU))}}function RP(e){return null!=e?AU(IU(e)):null}function RU(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function PU(e){return e._rawValidators}function OU(e){return e._rawAsyncValidators}function PP(e){return e?Array.isArray(e)?e:[e]:[]}function fD(e,n){return Array.isArray(e)?e.includes(n):e===n}function FU(e,n){const t=PP(n);return PP(e).forEach(r=>{fD(t,r)||t.push(r)}),t}function LU(e,n){return PP(n).filter(t=>!fD(e,t))}class NU{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=AP(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=RP(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class tc extends NU{name;get formDirective(){return null}get path(){return null}}class Kf extends NU{_parent=null;name=null;valueAccessor=null}class zU{_cd;constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}}let BU=(()=>{class e extends zU{constructor(t){super(t)}static \u0275fac=function(i){return new(i||e)(Rt(Kf,2))};static \u0275dir=Bt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&Ti("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Gn]})}return e})();const AC="VALID",mD="INVALID",Ix="PENDING",RC="DISABLED";class kx{}class UU extends kx{value;source;constructor(n,t){super(),this.value=n,this.source=t}}class LP extends kx{pristine;source;constructor(n,t){super(),this.pristine=n,this.source=t}}class NP extends kx{touched;source;constructor(n,t){super(),this.touched=n,this.source=t}}class gD extends kx{status;source;constructor(n,t){super(),this.status=n,this.source=t}}class Toe extends kx{source;constructor(n){super(),this.source=n}}class Moe extends kx{source;constructor(n){super(),this.source=n}}function zP(e){return(_D(e)?e.validators:e)||null}function BP(e,n){return(_D(n)?n.asyncValidators:e)||null}function _D(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class VP{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(n,t){this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return bl(this.statusReactive)}set status(n){bl(()=>this.statusReactive.set(n))}_status=Tm(()=>this.statusReactive());statusReactive=ha(void 0);get valid(){return this.status===AC}get invalid(){return this.status===mD}get pending(){return this.status==Ix}get disabled(){return this.status===RC}get enabled(){return this.status!==RC}errors;get pristine(){return bl(this.pristineReactive)}set pristine(n){bl(()=>this.pristineReactive.set(n))}_pristine=Tm(()=>this.pristineReactive());pristineReactive=ha(!0);get dirty(){return!this.pristine}get touched(){return bl(this.touchedReactive)}set touched(n){bl(()=>this.touchedReactive.set(n))}_touched=Tm(()=>this.touchedReactive());touchedReactive=ha(!1);get untouched(){return!this.touched}_events=new Ie;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(FU(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(FU(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(LU(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(LU(n,this._rawAsyncValidators))}hasValidator(n){return fD(this._rawValidators,n)}hasAsyncValidator(n){return fD(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){const t=!1===this.touched;this.touched=!0;const i=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsTouched({...n,sourceControl:i}),t&&!1!==n.emitEvent&&this._events.next(new NP(!0,i))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(n))}markAsUntouched(n={}){const t=!0===this.touched;this.touched=!1,this._pendingTouched=!1;const i=n.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:i})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,i),t&&!1!==n.emitEvent&&this._events.next(new NP(!1,i))}markAsDirty(n={}){const t=!0===this.pristine;this.pristine=!1;const i=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsDirty({...n,sourceControl:i}),t&&!1!==n.emitEvent&&this._events.next(new LP(!1,i))}markAsPristine(n={}){const t=!1===this.pristine;this.pristine=!0,this._pendingDirty=!1;const i=n.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n,i),t&&!1!==n.emitEvent&&this._events.next(new LP(!0,i))}markAsPending(n={}){this.status=Ix;const t=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new gD(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.markAsPending({...n,sourceControl:t})}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=RC,this.errors=null,this._forEachChild(r=>{r.disable({...n,onlySelf:!0})}),this._updateValue();const i=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new UU(this.value,i)),this._events.next(new gD(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t},this),this._onDisabledChange.forEach(r=>r(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=AC,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t},this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n,t){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){const i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===AC||this.status===Ix)&&this._runAsyncValidator(i,n.emitEvent)}const t=n.sourceControl??this;!1!==n.emitEvent&&(this._events.next(new UU(this.value,t)),this._events.next(new gD(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity({...n,sourceControl:t})}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?RC:AC}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,t){if(this.asyncValidator){this.status=Ix,this._hasOwnPendingAsyncValidator={emitEvent:!1!==t};const i=SU(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:t,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();const n=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent,this,t.shouldHaveEmitted)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(n,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,t,i){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||i)&&this._events.next(new gD(this.status,t)),this._parent&&this._parent._updateControlsErrors(n,t,i)}_initObservables(){this.valueChanges=new Dt,this.statusChanges=new Dt}_calculateStatus(){return this._allControlsDisabled()?RC:this.errors?mD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ix)?Ix:this._anyControlsHaveStatus(mD)?mD:AC}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,t){const i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!n.onlySelf&&this._parent._updatePristine(n,t),r&&this._events.next(new LP(this.pristine,t))}_updateTouched(n={},t){this.touched=this._anyControlsTouched(),this._events.next(new NP(this.touched,t)),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,t)}_onDisabledChange=[];_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){_D(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function Soe(e){return Array.isArray(e)?AP(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function Eoe(e){return Array.isArray(e)?RP(e):e||null}(this._rawAsyncValidators)}}class UP extends VP{constructor(n,t,i){super(zP(t),BP(i,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,i={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){(function HU(e,n,t){e._forEachChild((i,r)=>{if(void 0===t[r])throw new ot(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function jU(e,n,t){const i=e.controls;if(!(n?Object.keys(i):i).length)throw new ot(1e3,"");if(!i[t])throw new ot(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((i,r)=>{i.reset(n?n[r]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,i)=>(n[i]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,i)=>!!i._syncPendingControls()||t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{const i=this.controls[t];i&&n(i,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[t,i]of Object.entries(this.controls))if(this.contains(t)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,i,r)=>((i.enabled||this.disabled)&&(t[r]=i.value),t))}_reduceChildren(n,t){let i=n;return this._forEachChild((r,a)=>{i=t(i,r,a)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const Ax=new ct("CallSetDisabledState",{providedIn:"root",factory:()=>yD}),yD="always";function PC(e,n,t=yD){jP(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function koe(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&$U(e,n)})}(e,n),function Roe(e,n){const t=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function Aoe(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&$U(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function Ioe(e,n){if(n.valueAccessor.setDisabledState){const t=i=>{n.valueAccessor.setDisabledState(i)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function bD(e,n,t=!0){const i=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(i),n.valueAccessor.registerOnTouched(i)),wD(e,n),e&&(n._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function xD(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function jP(e,n){const t=PU(e);null!==n.validator?e.setValidators(RU(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const i=OU(e);null!==n.asyncValidator?e.setAsyncValidators(RU(i,n.asyncValidator)):"function"==typeof i&&e.setAsyncValidators([i]);const r=()=>e.updateValueAndValidity();xD(n._rawValidators,r),xD(n._rawAsyncValidators,r)}function wD(e,n){let t=!1;if(null!==e){if(null!==n.validator){const r=PU(e);if(Array.isArray(r)&&r.length>0){const a=r.filter(h=>h!==n.validator);a.length!==r.length&&(t=!0,e.setValidators(a))}}if(null!==n.asyncValidator){const r=OU(e);if(Array.isArray(r)&&r.length>0){const a=r.filter(h=>h!==n.asyncValidator);a.length!==r.length&&(t=!0,e.setAsyncValidators(a))}}}const i=()=>{};return xD(n._rawValidators,i),xD(n._rawAsyncValidators,i),t}function $U(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function GU(e,n){jP(e,n)}function qU(e,n){e._syncPendingControls(),n.forEach(t=>{const i=t.control;"submit"===i.updateOn&&i._pendingChange&&(t.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}const Noe={provide:tc,useExisting:zi(()=>FC)},OC=Promise.resolve();let FC=(()=>{class e extends tc{callSetDisabledState;get submitted(){return bl(this.submittedReactive)}_submitted=Tm(()=>this.submittedReactive());submittedReactive=ha(!1);_directives=new Set;form;ngSubmit=new Dt;options;constructor(t,i,r){super(),this.callSetDisabledState=r,this.form=new UP({},AP(t),RP(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){OC.then(()=>{const i=this._findContainer(t.path);t.control=i.registerControl(t.name,t.control),PC(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){OC.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){OC.then(()=>{const i=this._findContainer(t.path),r=new UP({});GU(r,t),i.registerControl(t.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){OC.then(()=>{const i=this._findContainer(t.path);i&&i.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,i){OC.then(()=>{this.form.get(t.path).setValue(i)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),qU(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static \u0275fac=function(i){return new(i||e)(Rt(Ra,10),Rt(D_,10),Rt(Ax,8))};static \u0275dir=Bt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&Nn("submit",function(h){return r.onSubmit(h)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Jn([Noe]),Gn]})}return e})();function WU(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function ZU(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const YU=class extends VP{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(n=null,t,i){super(zP(t),BP(i,t)),this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),_D(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=ZU(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){WU(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){WU(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){ZU(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},Voe={provide:Kf,useExisting:zi(()=>qP)},QU=Promise.resolve();let qP=(()=>{class e extends Kf{_changeDetectorRef;callSetDisabledState;control=new YU;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Dt;constructor(t,i,r,a,h,v){super(),this._changeDetectorRef=h,this.callSetDisabledState=v,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function GP(e,n){if(!n)return null;let t,i,r;return Array.isArray(n),n.forEach(a=>{a.constructor===uD?t=a:function Foe(e){return Object.getPrototypeOf(e.constructor)===Hv}(a)?i=a:r=a}),r||i||t||null}(0,a)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function $P(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){PC(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){QU.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&zn(i);QU.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function vD(e,n){return[...n.path,e]}(t,this._parent):[t]}static \u0275fac=function(i){return new(i||e)(Rt(tc,9),Rt(Ra,10),Rt(D_,10),Rt(Rc,10),Rt(Bo,8),Rt(Ax,8))};static \u0275dir=Bt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Jn([Voe]),Gn,sr]})}return e})();const Woe={provide:tc,useExisting:zi(()=>LC)};let LC=(()=>{class e extends tc{callSetDisabledState;get submitted(){return bl(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}_submitted=Tm(()=>this._submittedReactive());_submittedReactive=ha(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new Dt;constructor(t,i,r){super(),this.callSetDisabledState=r,this._setValidators(t),this._setAsyncValidators(i)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(wD(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){const i=this.form.get(t.path);return PC(i,t,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),i}getControl(t){return this.form.get(t.path)}removeControl(t){bD(t.control||null,t,!1),function Loe(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,i){this.form.get(t.path).setValue(i)}onSubmit(t){return this._submittedReactive.set(!0),qU(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Toe(this.control)),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new Moe(this.form))}_updateDomValue(){this.directives.forEach(t=>{const i=t.control,r=this.form.get(t.path);i!==r&&(bD(i||null,t),(e=>e instanceof YU)(r)&&(PC(r,t,this.callSetDisabledState),t.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){const i=this.form.get(t.path);GU(i,t),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){const i=this.form.get(t.path);i&&function Poe(e,n){return wD(e,n)}(i,t)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){jP(this.form,this),this._oldForm&&wD(this._oldForm,this)}_checkFormPresent(){}static \u0275fac=function(i){return new(i||e)(Rt(Ra,10),Rt(D_,10),Rt(Ax,8))};static \u0275dir=Bt({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,r){1&i&&Nn("submit",function(h){return r.onSubmit(h)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Jn([Woe]),Gn,sr]})}return e})(),use=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})(),gj=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:Ax,useValue:t.callSetDisabledState??yD}]}}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[use]})}return e})();class CD{}class TD{}class Ja{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(n){n?"string"==typeof n?this.lazyInit=()=>{this.headers=new Map,n.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),a=t.slice(i+1).trim();this.addHeaderEntry(r,a)}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,i)=>{this.addHeaderEntry(i,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,i])=>{this.setHeaderEntries(t,i)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof Ja?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new Ja;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Ja?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let i=n.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(n.name,t);const r=("a"===n.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const a=n.value;if(a){let h=this.headers.get(t);if(!h)return;h=h.filter(v=>-1===a.indexOf(v)),0===h.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,h)}else this.headers.delete(t),this.normalizedNames.delete(t)}}addHeaderEntry(n,t){const i=n.toLowerCase();this.maybeSetNormalizedName(n,i),this.headers.has(i)?this.headers.get(i).push(t):this.headers.set(i,[t])}setHeaderEntries(n,t){const i=(Array.isArray(t)?t:[t]).map(a=>a.toString()),r=n.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(n,r)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class fse{encodeKey(n){return _j(n)}encodeValue(n){return _j(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const mse=/%(\d[a-f0-9])/gi,gse={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function _j(e){return encodeURIComponent(e).replace(mse,(n,t)=>gse[t]??n)}function MD(e){return`${e}`}class Qf{map;encoder;updates=null;cloneFrom=null;constructor(n={}){if(this.encoder=n.encoder||new fse,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function pse(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(r=>{const a=r.indexOf("="),[h,v]=-1==a?[n.decodeKey(r),""]:[n.decodeKey(r.slice(0,a)),n.decodeValue(r.slice(a+1))],C=t.get(h)||[];C.push(v),t.set(h,C)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const i=n.fromObject[t],r=Array.isArray(i)?i.map(MD):[MD(i)];this.map.set(t,r)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(i=>{const r=n[i];Array.isArray(r)?r.forEach(a=>{t.push({param:i,value:a,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new Qf({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(MD(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let i=this.map.get(n.param)||[];const r=i.indexOf(MD(n.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(n.param,i):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class _se{map=new Map;set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function yj(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function vj(e){return typeof Blob<"u"&&e instanceof Blob}function bj(e){return typeof FormData<"u"&&e instanceof FormData}class NC{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(n,t,i,r){let a;if(this.url=t,this.method=n.toUpperCase(),function yse(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,a=r):a=i,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params),this.transferCache=a.transferCache),this.headers??=new Ja,this.context??=new _se,this.params){const h=this.params.toString();if(0===h.length)this.urlWithParams=t;else{const v=t.indexOf("?");this.urlWithParams=t+(-1===v?"?":v<t.length-1?"&":"")+h}}else this.params=new Qf,this.urlWithParams=t}serializeBody(){return null===this.body?null:"string"==typeof this.body||yj(this.body)||vj(this.body)||bj(this.body)||function vse(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)?this.body:this.body instanceof Qf?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||bj(this.body)?null:vj(this.body)?this.body.type||null:yj(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Qf?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,i=n.url||this.url,r=n.responseType||this.responseType,a=n.transferCache??this.transferCache,h=void 0!==n.body?n.body:this.body,v=n.withCredentials??this.withCredentials,C=n.reportProgress??this.reportProgress;let P=n.headers||this.headers,L=n.params||this.params;const V=n.context??this.context;return void 0!==n.setHeaders&&(P=Object.keys(n.setHeaders).reduce((W,X)=>W.set(X,n.setHeaders[X]),P)),n.setParams&&(L=Object.keys(n.setParams).reduce((W,X)=>W.set(X,n.setParams[X]),L)),new NC(t,i,h,{params:L,headers:P,context:V,reportProgress:C,responseType:r,withCredentials:v,transferCache:a})}}var I_=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(I_||{});class JP{headers;status;statusText;url;ok;type;constructor(n,t=200,i="OK"){this.headers=n.headers||new Ja,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||i,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class SD extends JP{constructor(n={}){super(n)}type=I_.ResponseHeader;clone(n={}){return new SD({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Gv extends JP{body;constructor(n={}){super(n),this.body=void 0!==n.body?n.body:null}type=I_.Response;clone(n={}){return new Gv({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class Rx extends JP{name="HttpErrorResponse";message;error;ok=!1;constructor(n){super(n,0,"Unknown Error"),this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function eO(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,transferCache:e.transferCache}}let k_=(()=>{class e{handler;constructor(t){this.handler=t}request(t,i,r={}){let a;if(t instanceof NC)a=t;else{let C,P;C=r.headers instanceof Ja?r.headers:new Ja(r.headers),r.params&&(P=r.params instanceof Qf?r.params:new Qf({fromObject:r.params})),a=new NC(t,i,void 0!==r.body?r.body:null,{headers:C,context:r.context,params:P,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}const h=vn(a).pipe(yx(C=>this.handler.handle(C)));if(t instanceof NC||"events"===r.observe)return h;const v=h.pipe(is(C=>C instanceof Gv));switch(r.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return v.pipe($t(C=>{if(null!==C.body&&!(C.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return C.body}));case"blob":return v.pipe($t(C=>{if(null!==C.body&&!(C.body instanceof Blob))throw new Error("Response is not a Blob.");return C.body}));case"text":return v.pipe($t(C=>{if(null!==C.body&&"string"!=typeof C.body)throw new Error("Response is not a string.");return C.body}));default:return v.pipe($t(C=>C.body))}case"response":return v;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Qf).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,eO(r,i))}post(t,i,r={}){return this.request("POST",t,eO(r,i))}put(t,i,r={}){return this.request("PUT",t,eO(r,i))}static \u0275fac=function(i){return new(i||e)(un(CD))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();const wse=/^\)\]\}',?\n/;function wj(e){if(e.url)return e.url;const n="X-Request-URL".toLocaleLowerCase();return e.headers.get(n)}let tO=(()=>{class e{fetchImpl=re(Tse,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t));ngZone=re(Ht);handle(t){return new Ce(i=>{const r=new AbortController;return this.doRequest(t,r.signal,i).then(nO,a=>i.error(new Rx({error:a}))),()=>r.abort()})}doRequest(t,i,r){var a=this;return Ph(function*(){const h=a.createRequestInit(t);let v;try{const oe=a.ngZone.runOutsideAngular(()=>a.fetchImpl(t.urlWithParams,{signal:i,...h}));(function Mse(e){e.then(nO,nO)})(oe),r.next({type:I_.Sent}),v=yield oe}catch(oe){return void r.error(new Rx({error:oe,status:oe.status??0,statusText:oe.statusText,url:t.urlWithParams,headers:oe.headers}))}const C=new Ja(v.headers),P=v.statusText,L=wj(v)??t.urlWithParams;let V=v.status,W=null;if(t.reportProgress&&r.next(new SD({headers:C,status:V,statusText:P,url:L})),v.body){const oe=v.headers.get("content-length"),he=[],se=v.body.getReader();let Se,$e,_e=0;const et=typeof Zone<"u"&&Zone.current;yield a.ngZone.runOutsideAngular(Ph(function*(){for(;;){const{done:mt,value:qt}=yield se.read();if(mt)break;if(he.push(qt),_e+=qt.length,t.reportProgress){$e="text"===t.responseType?($e??"")+(Se??=new TextDecoder).decode(qt,{stream:!0}):void 0;const tn=()=>r.next({type:I_.DownloadProgress,total:oe?+oe:void 0,loaded:_e,partialText:$e});et?et.run(tn):tn()}}}));const ut=a.concatChunks(he,_e);try{const mt=v.headers.get("Content-Type")??"";W=a.parseBody(t,ut,mt)}catch(mt){return void r.error(new Rx({error:mt,headers:new Ja(v.headers),status:v.status,statusText:v.statusText,url:wj(v)??t.urlWithParams}))}}0===V&&(V=W?200:0),V>=200&&V<300?(r.next(new Gv({body:W,headers:C,status:V,statusText:P,url:L})),r.complete()):r.error(new Rx({error:W,headers:C,status:V,statusText:P,url:L}))})()}parseBody(t,i,r){switch(t.responseType){case"json":const a=(new TextDecoder).decode(i).replace(wse,"");return""===a?null:JSON.parse(a);case"text":return(new TextDecoder).decode(i);case"blob":return new Blob([i],{type:r});case"arraybuffer":return i.buffer}}createRequestInit(t){const i={},r=t.withCredentials?"include":void 0;if(t.headers.forEach((a,h)=>i[a]=h.join(",")),t.headers.has("Accept")||(i.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){const a=t.detectContentTypeHeader();null!==a&&(i["Content-Type"]=a)}return{body:t.serializeBody(),method:t.method,headers:i,credentials:r}}concatChunks(t,i){const r=new Uint8Array(i);let a=0;for(const h of t)r.set(h,a),a+=h.length;return r}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();class Tse{}function nO(){}function Cj(e,n){return n(e)}function Sse(e,n){return(t,i)=>n.intercept(t,{handle:r=>e(r,i)})}const Dse=new ct(""),zC=new ct(""),Tj=new ct(""),Mj=new ct("",{providedIn:"root",factory:()=>!0});function Ise(){let e=null;return(n,t)=>{null===e&&(e=(re(Dse,{optional:!0})??[]).reduceRight(Sse,Cj));const i=re(hn);if(re(Mj)){const a=i.add();return e(n,t).pipe(vx(()=>i.remove(a)))}return e(n,t)}}let Sj=(()=>{class e extends CD{backend;injector;chain=null;pendingTasks=re(hn);contributeToStability=re(Mj);constructor(t,i){super(),this.backend=t,this.injector=i}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(zC),...this.injector.get(Tj,[])]));this.chain=i.reduceRight((r,a)=>function Ese(e,n,t){return(i,r)=>As(t,()=>n(i,a=>e(a,r)))}(r,a,this.injector),Cj)}if(this.contributeToStability){const i=this.pendingTasks.add();return this.chain(t,r=>this.backend.handle(r)).pipe(vx(()=>this.pendingTasks.remove(i)))}return this.chain(t,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||e)(un(TD),un(Eo))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();const Ose=/^\)\]\}',?\n/;let Dj=(()=>{class e{xhrFactory;constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new ot(-2800,!1);const i=this.xhrFactory;return(i.\u0275loadImpl?js(i.\u0275loadImpl()):vn(null)).pipe(Aa(()=>new Ce(a=>{const h=i.build();if(h.open(t.method,t.urlWithParams),t.withCredentials&&(h.withCredentials=!0),t.headers.forEach((he,se)=>h.setRequestHeader(he,se.join(","))),t.headers.has("Accept")||h.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const he=t.detectContentTypeHeader();null!==he&&h.setRequestHeader("Content-Type",he)}if(t.responseType){const he=t.responseType.toLowerCase();h.responseType="json"!==he?he:"text"}const v=t.serializeBody();let C=null;const P=()=>{if(null!==C)return C;const he=h.statusText||"OK",se=new Ja(h.getAllResponseHeaders()),_e=function Fse(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(h)||t.url;return C=new SD({headers:se,status:h.status,statusText:he,url:_e}),C},L=()=>{let{headers:he,status:se,statusText:_e,url:Se}=P(),$e=null;204!==se&&($e=typeof h.response>"u"?h.responseText:h.response),0===se&&(se=$e?200:0);let et=se>=200&&se<300;if("json"===t.responseType&&"string"==typeof $e){const ut=$e;$e=$e.replace(Ose,"");try{$e=""!==$e?JSON.parse($e):null}catch(mt){$e=ut,et&&(et=!1,$e={error:mt,text:$e})}}et?(a.next(new Gv({body:$e,headers:he,status:se,statusText:_e,url:Se||void 0})),a.complete()):a.error(new Rx({error:$e,headers:he,status:se,statusText:_e,url:Se||void 0}))},V=he=>{const{url:se}=P(),_e=new Rx({error:he,status:h.status||0,statusText:h.statusText||"Unknown Error",url:se||void 0});a.error(_e)};let W=!1;const X=he=>{W||(a.next(P()),W=!0);let se={type:I_.DownloadProgress,loaded:he.loaded};he.lengthComputable&&(se.total=he.total),"text"===t.responseType&&h.responseText&&(se.partialText=h.responseText),a.next(se)},oe=he=>{let se={type:I_.UploadProgress,loaded:he.loaded};he.lengthComputable&&(se.total=he.total),a.next(se)};return h.addEventListener("load",L),h.addEventListener("error",V),h.addEventListener("timeout",V),h.addEventListener("abort",V),t.reportProgress&&(h.addEventListener("progress",X),null!==v&&h.upload&&h.upload.addEventListener("progress",oe)),h.send(v),a.next({type:I_.Sent}),()=>{h.removeEventListener("error",V),h.removeEventListener("abort",V),h.removeEventListener("load",L),h.removeEventListener("timeout",V),t.reportProgress&&(h.removeEventListener("progress",X),null!==v&&h.upload&&h.upload.removeEventListener("progress",oe)),h.readyState!==h.DONE&&h.abort()}})))}static \u0275fac=function(i){return new(i||e)(un(OV))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();const iO=new ct(""),Ij=new ct("",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),kj=new ct("",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Aj{}let zse=(()=>{class e{doc;platform;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=wV(t,this.cookieName),this.lastCookieString=t),this.lastToken}static \u0275fac=function(i){return new(i||e)(un(ir),un(rh),un(Ij))};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();function Bse(e,n){const t=e.url.toLowerCase();if(!re(iO)||"GET"===e.method||"HEAD"===e.method||t.startsWith("http://")||t.startsWith("https://"))return n(e);const i=re(Aj).getToken(),r=re(kj);return null!=i&&!e.headers.has(r)&&(e=e.clone({headers:e.headers.set(r,i)})),n(e)}var A_=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(A_||{});function Vse(...e){const n=[k_,Dj,Sj,{provide:CD,useExisting:Sj},{provide:TD,useFactory:()=>re(tO,{optional:!0})??re(Dj)},{provide:zC,useValue:Bse,multi:!0},{provide:iO,useValue:!0},{provide:Aj,useClass:zse}];for(const t of e)n.push(...t.\u0275providers);return Va(n)}const Rj=new ct("");function Use(){return function qv(e,n){return{\u0275kind:e,\u0275providers:n}}(A_.LegacyInterceptors,[{provide:Rj,useFactory:Ise},{provide:zC,useExisting:Rj,multi:!0}])}let jse=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[Vse(Use())]})}return e})();const Vj=["toast-component",""];function Kse(e,n){if(1&e){const t=Is();Fe(0,"button",5),Nn("click",function(){return Di(t),Ii(cn().remove())}),Fe(1,"span",6),gt(2,"\xd7"),Ue()()}}function Qse(e,n){if(1&e&&(co(0),gt(1),uo()),2&e){const t=cn(2);Ze(),Sr("[",t.duplicatesCount+1,"]")}}function Jse(e,n){if(1&e&&(Fe(0,"div"),gt(1),an(2,Qse,2,1,"ng-container",4),Ue()),2&e){const t=cn();ka(t.options.titleClass),ui("aria-label",t.title),Ze(),Sr(" ",t.title," "),Ze(),At("ngIf",t.duplicatesCount)}}function eae(e,n){if(1&e&&_n(0,"div",7),2&e){const t=cn();ka(t.options.messageClass),At("innerHTML",t.message,iv)}}function tae(e,n){if(1&e&&(Fe(0,"div",8),gt(1),Ue()),2&e){const t=cn();ka(t.options.messageClass),ui("aria-label",t.message),Ze(),Sr(" ",t.message," ")}}function nae(e,n){if(1&e&&(Fe(0,"div"),_n(1,"div",9),Ue()),2&e){const t=cn();Ze(),Ia("width",t.width()+"%")}}class cae{_attachedHost;component;viewContainerRef;injector;constructor(n,t){this.component=n,this.injector=t}attach(n,t){return this._attachedHost=n,n.attach(this,t)}detach(){const n=this._attachedHost;if(n)return this._attachedHost=void 0,n.detach()}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class dae{_attachedPortal;_disposeFn;attach(n,t){return this._attachedPortal=n,this.attachComponentPortal(n,t)}detach(){this._attachedPortal&&this._attachedPortal.setAttachedHost(),this._attachedPortal=void 0,this._disposeFn&&(this._disposeFn(),this._disposeFn=void 0)}setDisposeFn(n){this._disposeFn=n}}class uae{_overlayRef;componentInstance;duplicatesCount=0;_afterClosed=new Ie;_activate=new Ie;_manualClose=new Ie;_resetTimeout=new Ie;_countDuplicate=new Ie;constructor(n){this._overlayRef=n}manualClose(){this._manualClose.next(),this._manualClose.complete()}manualClosed(){return this._manualClose.asObservable()}timeoutReset(){return this._resetTimeout.asObservable()}countDuplicate(){return this._countDuplicate.asObservable()}close(){this._overlayRef.detach(),this._afterClosed.next(),this._manualClose.next(),this._afterClosed.complete(),this._manualClose.complete(),this._activate.complete(),this._resetTimeout.complete(),this._countDuplicate.complete()}afterClosed(){return this._afterClosed.asObservable()}isInactive(){return this._activate.isStopped}activate(){this._activate.next(),this._activate.complete()}afterActivate(){return this._activate.asObservable()}onDuplicate(n,t){n&&this._resetTimeout.next(),t&&this._countDuplicate.next(++this.duplicatesCount)}}class DD{toastId;config;message;title;toastType;toastRef;_onTap=new Ie;_onAction=new Ie;constructor(n,t,i,r,a,h){this.toastId=n,this.config=t,this.message=i,this.title=r,this.toastType=a,this.toastRef=h,this.toastRef.afterClosed().subscribe(()=>{this._onAction.complete(),this._onTap.complete()})}triggerTap(){this._onTap.next(),this.config.tapToDismiss&&this._onTap.complete()}onTap(){return this._onTap.asObservable()}triggerAction(n){this._onAction.next(n)}onAction(){return this._onAction.asObservable()}}const jj=new ct("ToastConfig");class hae extends dae{_hostDomElement;_componentFactoryResolver;_appRef;constructor(n,t,i){super(),this._hostDomElement=n,this._componentFactoryResolver=t,this._appRef=i}attachComponentPortal(n,t){const i=this._componentFactoryResolver.resolveComponentFactory(n.component);let r;return r=i.create(n.injector),this._appRef.attachView(r.hostView),this.setDisposeFn(()=>{this._appRef.detachView(r.hostView),r.destroy()}),t?this._hostDomElement.insertBefore(this._getComponentRootNode(r),this._hostDomElement.firstChild):this._hostDomElement.appendChild(this._getComponentRootNode(r)),r}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let fae=(()=>{class e{_document=re(ir);_containerElement;ngOnDestroy(){this._containerElement&&this._containerElement.parentNode&&this._containerElement.parentNode.removeChild(this._containerElement)}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t=this._document.createElement("div");t.classList.add("overlay-container"),t.setAttribute("aria-live","polite"),this._document.body.appendChild(t),this._containerElement=t}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class pae{_portalHost;constructor(n){this._portalHost=n}attach(n,t=!0){return this._portalHost.attach(n,t)}detach(){return this._portalHost.detach()}}let mae=(()=>{class e{_overlayContainer=re(fae);_componentFactoryResolver=re(ym);_appRef=re(Wa);_document=re(ir);_paneElements=new Map;create(t,i){return this._createOverlayRef(this.getPaneElement(t,i))}getPaneElement(t="",i){return this._paneElements.get(i)||this._paneElements.set(i,{}),this._paneElements.get(i)[t]||(this._paneElements.get(i)[t]=this._createPaneElement(t,i)),this._paneElements.get(i)[t]}_createPaneElement(t,i){const r=this._document.createElement("div");return r.id="toast-container",r.classList.add(t),r.classList.add("toast-container"),i?i.getContainerElement().appendChild(r):this._overlayContainer.getContainerElement().appendChild(r),r}_createPortalHost(t){return new hae(t,this._componentFactoryResolver,this._appRef)}_createOverlayRef(t){return new pae(this._createPortalHost(t))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),rO=(()=>{class e{overlay;_injector;sanitizer;ngZone;toastrConfig;currentlyActive=0;toasts=[];overlayContainer;previousToastMessage;index=0;constructor(t,i,r,a,h){this.overlay=i,this._injector=r,this.sanitizer=a,this.ngZone=h,this.toastrConfig={...t.default,...t.config},t.config.iconClasses&&(this.toastrConfig.iconClasses={...t.default.iconClasses,...t.config.iconClasses})}show(t,i,r={},a=""){return this._preBuildNotification(a,t,i,this.applyConfig(r))}success(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.success||"",t,i,this.applyConfig(r))}error(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.error||"",t,i,this.applyConfig(r))}info(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.info||"",t,i,this.applyConfig(r))}warning(t,i,r={}){return this._preBuildNotification(this.toastrConfig.iconClasses.warning||"",t,i,this.applyConfig(r))}clear(t){for(const i of this.toasts)if(void 0!==t){if(i.toastId===t)return void i.toastRef.manualClose()}else i.toastRef.manualClose()}remove(t){const i=this._findToast(t);if(!i||(i.activeToast.toastRef.close(),this.toasts.splice(i.index,1),this.currentlyActive=this.currentlyActive-1,!this.toastrConfig.maxOpened||!this.toasts.length))return!1;if(this.currentlyActive<this.toastrConfig.maxOpened&&this.toasts[this.currentlyActive]){const r=this.toasts[this.currentlyActive].toastRef;r.isInactive()||(this.currentlyActive=this.currentlyActive+1,r.activate())}return!0}findDuplicate(t="",i="",r,a){const{includeTitleDuplicates:h}=this.toastrConfig;for(const v of this.toasts)if((!h||h&&v.title===t)&&v.message===i)return v.toastRef.onDuplicate(r,a),v;return null}applyConfig(t={}){return{...this.toastrConfig,...t}}_findToast(t){for(let i=0;i<this.toasts.length;i++)if(this.toasts[i].toastId===t)return{index:i,activeToast:this.toasts[i]};return null}_preBuildNotification(t,i,r,a){return a.onActivateTick?this.ngZone.run(()=>this._buildNotification(t,i,r,a)):this._buildNotification(t,i,r,a)}_buildNotification(t,i,r,a){if(!a.toastComponent)throw new Error("toastComponent required");const h=this.findDuplicate(r,i,this.toastrConfig.resetTimeoutOnDuplicate&&a.timeOut>0,this.toastrConfig.countDuplicates);if((this.toastrConfig.includeTitleDuplicates&&r||i)&&this.toastrConfig.preventDuplicates&&null!==h)return h;this.previousToastMessage=i;let v=!1;this.toastrConfig.maxOpened&&this.currentlyActive>=this.toastrConfig.maxOpened&&(v=!0,this.toastrConfig.autoDismiss&&this.clear(this.toasts[0].toastId));const C=this.overlay.create(a.positionClass,this.overlayContainer);this.index=this.index+1;let P=i;i&&a.enableHtml&&(P=this.sanitizer.sanitize(ps.HTML,i));const L=new uae(C),V=new DD(this.index,a,P,r,t,L),X=Ye.create({providers:[{provide:DD,useValue:V}],parent:this._injector}),oe=new cae(a.toastComponent,X),he=C.attach(oe,a.newestOnTop);L.componentInstance=he.instance;const se={toastId:this.index,title:r||"",message:i||"",toastRef:L,onShown:L.afterActivate(),onHidden:L.afterClosed(),onTap:V.onTap(),onAction:V.onAction(),portal:he};return v||(this.currentlyActive=this.currentlyActive+1,setTimeout(()=>{se.toastRef.activate()})),this.toasts.push(se),se}static \u0275fac=function(i){return new(i||e)(un(jj),un(mae),un(Ye),un(EE),un(Ht))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const gae={maxOpened:0,autoDismiss:!1,newestOnTop:!0,preventDuplicates:!1,countDuplicates:!1,resetTimeoutOnDuplicate:!1,includeTitleDuplicates:!1,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},closeButton:!1,disableTimeOut:!1,timeOut:5e3,extendedTimeOut:1e3,enableHtml:!1,progressBar:!1,toastClass:"ngx-toastr",positionClass:"toast-top-right",titleClass:"toast-title",messageClass:"toast-message",easing:"ease-in",easeTime:300,tapToDismiss:!0,onActivateTick:!1,progressAnimation:"decreasing",toastComponent:(()=>{class e{toastrService;toastPackage;ngZone;message;title;options;duplicatesCount;originalTimeout;width=ha(-1);toastClasses="";state;get _state(){return this.state()}get displayStyle(){if("inactive"===this.state().value)return"none"}timeout;intervalId;hideTime;sub;sub1;sub2;sub3;constructor(t,i,r){this.toastrService=t,this.toastPackage=i,this.ngZone=r,this.message=i.message,this.title=i.title,this.options=i.config,this.originalTimeout=i.config.timeOut,this.toastClasses=`${i.toastType} ${i.config.toastClass}`,this.sub=i.toastRef.afterActivate().subscribe(()=>{this.activateToast()}),this.sub1=i.toastRef.manualClosed().subscribe(()=>{this.remove()}),this.sub2=i.toastRef.timeoutReset().subscribe(()=>{this.resetTimeout()}),this.sub3=i.toastRef.countDuplicate().subscribe(a=>{this.duplicatesCount=a}),this.state=ha({value:"inactive",params:{easeTime:this.toastPackage.config.easeTime,easing:"ease-in"}})}ngOnDestroy(){this.sub.unsubscribe(),this.sub1.unsubscribe(),this.sub2.unsubscribe(),this.sub3.unsubscribe(),clearInterval(this.intervalId),clearTimeout(this.timeout)}activateToast(){this.state.update(t=>({...t,value:"active"})),!0!==this.options.disableTimeOut&&"timeOut"!==this.options.disableTimeOut&&this.options.timeOut&&(this.outsideTimeout(()=>this.remove(),this.options.timeOut),this.hideTime=(new Date).getTime()+this.options.timeOut,this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}updateProgress(){if(0===this.width()||100===this.width()||!this.options.timeOut)return;const t=(new Date).getTime();this.width.set((this.hideTime-t)/this.options.timeOut*100),"increasing"===this.options.progressAnimation&&this.width.update(r=>100-r),this.width()<=0&&this.width.set(0),this.width()>=100&&this.width.set(100)}resetTimeout(){clearTimeout(this.timeout),clearInterval(this.intervalId),this.state.update(t=>({...t,value:"active"})),this.outsideTimeout(()=>this.remove(),this.originalTimeout),this.options.timeOut=this.originalTimeout,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10)}remove(){"removed"!==this.state().value&&(clearTimeout(this.timeout),this.state.update(t=>({...t,value:"removed"})),this.outsideTimeout(()=>this.toastrService.remove(this.toastPackage.toastId),+this.toastPackage.config.easeTime))}tapToast(){"removed"!==this.state().value&&(this.toastPackage.triggerTap(),this.options.tapToDismiss&&this.remove())}stickAround(){"removed"!==this.state().value&&"extendedTimeOut"!==this.options.disableTimeOut&&(clearTimeout(this.timeout),this.options.timeOut=0,this.hideTime=0,clearInterval(this.intervalId),this.width.set(0))}delayedHideToast(){!0===this.options.disableTimeOut||"extendedTimeOut"===this.options.disableTimeOut||0===this.options.extendedTimeOut||"removed"===this.state().value||(this.outsideTimeout(()=>this.remove(),this.options.extendedTimeOut),this.options.timeOut=this.options.extendedTimeOut,this.hideTime=(new Date).getTime()+(this.options.timeOut||0),this.width.set(-1),this.options.progressBar&&this.outsideInterval(()=>this.updateProgress(),10))}outsideTimeout(t,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.timeout=setTimeout(()=>this.runInsideAngular(t),i)):this.timeout=setTimeout(()=>t(),i)}outsideInterval(t,i){this.ngZone?this.ngZone.runOutsideAngular(()=>this.intervalId=setInterval(()=>this.runInsideAngular(t),i)):this.intervalId=setInterval(()=>t(),i)}runInsideAngular(t){this.ngZone?this.ngZone.run(()=>t()):t()}static \u0275fac=function(i){return new(i||e)(Rt(rO),Rt(DD),Rt(Ht))};static \u0275cmp=Ln({type:e,selectors:[["","toast-component",""]],hostVars:5,hostBindings:function(i,r){1&i&&Nn("click",function(){return r.tapToast()})("mouseenter",function(){return r.stickAround()})("mouseleave",function(){return r.delayedHideToast()}),2&i&&(bR("@flyInOut",r._state),ka(r.toastClasses),Ia("display",r.displayStyle))},attrs:Vj,decls:5,vars:5,consts:[["type","button","class","toast-close-button","aria-label","Close",3,"click",4,"ngIf"],[3,"class",4,"ngIf"],["role","alert",3,"class","innerHTML",4,"ngIf"],["role","alert",3,"class",4,"ngIf"],[4,"ngIf"],["type","button","aria-label","Close",1,"toast-close-button",3,"click"],["aria-hidden","true"],["role","alert",3,"innerHTML"],["role","alert"],[1,"toast-progress"]],template:function(i,r){1&i&&an(0,Kse,3,0,"button",0)(1,Jse,3,5,"div",1)(2,eae,1,3,"div",2)(3,tae,2,4,"div",3)(4,nae,2,2,"div",4),2&i&&(At("ngIf",r.options.closeButton),Ze(),At("ngIf",r.title),Ze(),At("ngIf",r.message&&r.options.enableHtml),Ze(),At("ngIf",r.message&&!r.options.enableHtml),Ze(),At("ngIf",r.options.progressBar))},dependencies:[qf],encapsulation:2,data:{animation:[Us("flyInOut",[Or("inactive",yi({opacity:0})),Or("active",yi({opacity:1})),Or("removed",yi({opacity:0})),Hr("inactive => active",no("{{ easeTime }}ms {{ easing }}")),Hr("active => removed",no("{{ easeTime }}ms {{ easing }}"))])]},changeDetection:0})}return e})()},_ae=(e={})=>Va([{provide:jj,useValue:{default:gae,config:e}}]);let oO,yae=(()=>{class e{static forRoot(t={}){return{ngModule:e,providers:[_ae(t)]}}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();try{oO=typeof Intl<"u"&&Intl.v8BreakIterator}catch{oO=!1}let Px,Hs=(()=>{class e{_platformId=re(rh);isBrowser=this._platformId?RV(this._platformId):"object"==typeof document&&!!document;EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent);TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent);BLINK=this.isBrowser&&!(!window.chrome&&!oO)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT;WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT;IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window);FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent);ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT;SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT;constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Hj=["color","button","checkbox","date","datetime-local","email","file","hidden","image","month","number","password","radio","range","reset","search","submit","tel","text","time","url","week"];function $j(){if(Px)return Px;if("object"!=typeof document||!document)return Px=new Set(Hj),Px;let e=document.createElement("input");return Px=new Set(Hj.filter(n=>(e.setAttribute("type",n),e.type===n))),Px}let BC,Wv,sO;function cu(e){return function vae(){if(null==BC&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>BC=!0}))}finally{BC=BC||!1}return BC}()?e:!!e.capture}function bae(){if(null==Wv){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return Wv=!1,Wv;if("scrollBehavior"in document.documentElement.style)Wv=!0;else{const e=Element.prototype.scrollTo;Wv=!!e&&!/\{\s*\[native code\]\s*\}/.test(e.toString())}}return Wv}function kD(e){if(function xae(){if(null==sO){const e=typeof document<"u"?document.head:null;sO=!(!e||!e.createShadowRoot&&!e.attachShadow)}return sO}()){const n=e.getRootNode?e.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&n instanceof ShadowRoot)return n}return null}function Pc(e){return e.composedPath?e.composedPath()[0]:e.target}function Gj(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}const AD=new WeakMap;let Oc=(()=>{class e{_appRef;_injector=re(Ye);_environmentInjector=re(Eo);load(t){const i=this._appRef=this._appRef||this._injector.get(Wa);let r=AD.get(i);r||(r={loaders:new Set,refs:[]},AD.set(i,r),i.onDestroy(()=>{AD.get(i)?.refs.forEach(a=>a.destroy()),AD.delete(i)})),r.loaders.has(t)||(r.loaders.add(t),r.refs.push(lV(t,{environmentInjector:this._environmentInjector})))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),qj=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["ng-component"]],exportAs:["cdkVisuallyHidden"],decls:0,vars:0,template:function(i,r){},styles:[".cdk-visually-hidden{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap;outline:0;-webkit-appearance:none;-moz-appearance:none;left:0}[dir=rtl] .cdk-visually-hidden{left:auto;right:0}"],encapsulation:2,changeDetection:0})}return e})();function Pm(e,...n){return n.length?n.some(t=>e[t]):e.altKey||e.shiftKey||e.ctrlKey||e.metaKey}class Lae extends Ni{constructor(n,t){super()}schedule(n,t=0){return this}}const LD={setInterval(e,n,...t){const{delegate:i}=LD;return i?.setInterval?i.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=LD;return(n?.clearInterval||clearInterval)(e)},delegate:void 0};class cO extends Lae{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var i;if(this.closed)return this;this.state=n;const r=this.id,a=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(a,r,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(a,this.id,t),this}requestAsyncId(n,t,i=0){return LD.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&LD.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let r,i=!1;try{this.work(n)}catch(a){i=!0,r=a||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Il(i,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}}const dO={now:()=>(dO.delegate||Date).now(),delegate:void 0};class UC{constructor(n,t=UC.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,i){return new this.schedulerActionCtor(this,n).schedule(i,t)}}UC.now=dO.now;class uO extends UC{constructor(n,t=UC.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,i){for(;n=t.shift();)n.unsubscribe();throw i}}}const ND=new uO(cO),Nae=ND;function hO(e,n=ND){return Tt((t,i)=>{let r=null,a=null,h=null;const v=()=>{if(r){r.unsubscribe(),r=null;const P=a;a=null,i.next(P)}};function C(){const P=h+e,L=n.now();if(L<P)return r=this.schedule(void 0,P-L),void i.add(r);v()}t.subscribe(Mt(i,P=>{a=P,h=n.now(),r||(r=n.schedule(C,e),i.add(r))},()=>{v(),i.complete()},void 0,()=>{a=r=null}))})}function Wj(e){return is((n,t)=>e<=t)}function Zj(e,n=ie){return e=e??zae,Tt((t,i)=>{let r,a=!0;t.subscribe(Mt(i,h=>{const v=n(h);(a||!e(r,v))&&(a=!1,r=v,i.next(h))}))})}function zae(e,n){return e===n}function Fc(e){return null!=e&&"false"!=`${e}`}function Ox(e,n=0){return Xj(e)?Number(e):2===arguments.length?n:0}function Xj(e){return!isNaN(parseFloat(e))&&!isNaN(Number(e))}function jC(e){return Array.isArray(e)?e:[e]}function $s(e){return null==e?"":"string"==typeof e?e:`${e}px`}function xl(e){return e instanceof In?e.nativeElement:e}let Kj=(()=>{class e{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),fO=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[Kj]})}return e})();const Qj=new Set;let Xv,jae=(()=>{class e{_platform=re(Hs);_nonce=re(Aw,{optional:!0});_matchMedia;constructor(){this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):$ae}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function Hae(e,n){if(!Qj.has(e))try{Xv||(Xv=document.createElement("style"),n&&Xv.setAttribute("nonce",n),Xv.setAttribute("type","text/css"),document.head.appendChild(Xv)),Xv.sheet&&(Xv.sheet.insertRule(`@media ${e} {body{ }}`,0),Qj.add(e))}catch(t){console.error(t)}}(t,this._nonce),this._matchMedia(t)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function $ae(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let zD=(()=>{class e{_mediaMatcher=re(jae);_zone=re(Ht);_queries=new Map;_destroySubject=new Ie;constructor(){}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return Jj(jC(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let a=Lv(Jj(jC(t)).map(h=>this._registerQuery(h).observable));return a=jE(a.pipe(Ac(1)),a.pipe(Wj(1),hO(0))),a.pipe($t(h=>{const v={matches:!1,breakpoints:{}};return h.forEach(({matches:C,query:P})=>{v.matches=v.matches||C,v.breakpoints[P]=C}),v}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),a={observable:new Ce(h=>{const v=C=>this._zone.run(()=>h.next(C));return i.addListener(v),()=>{i.removeListener(v)}}).pipe(Ch(i),$t(({matches:h})=>({query:t,matches:h})),Er(this._destroySubject)),mql:i};return this._queries.set(t,a),a}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Jj(e){return e.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}const pO_Handset="(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)";function tH(e,n,t){const i=BD(e,n);t=t.trim(),!i.some(r=>r.trim()===t)&&(i.push(t),e.setAttribute(n,i.join(" ")))}function mO(e,n,t){const i=BD(e,n);t=t.trim();const r=i.filter(a=>a!==t);r.length?e.setAttribute(n,r.join(" ")):e.removeAttribute(n)}function BD(e,n){return e.getAttribute(n)?.match(/\S+/g)??[]}const nH="cdk-describedby-message",VD="cdk-describedby-host";let gO=0,iH=(()=>{class e{_platform=re(Hs);_document=re(ir);_messageRegistry=new Map;_messagesContainer=null;_id=""+gO++;constructor(){re(Oc).load(qj),this._id=re(Mf)+"-"+gO++}describe(t,i,r){if(!this._canBeDescribed(t,i))return;const a=_O(i,r);"string"!=typeof i?(rH(i,this._id),this._messageRegistry.set(a,{messageElement:i,referenceCount:0})):this._messageRegistry.has(a)||this._createMessageElement(i,r),this._isElementDescribedByMessage(t,a)||this._addMessageReference(t,a)}removeDescription(t,i,r){if(!i||!this._isElementNode(t))return;const a=_O(i,r);if(this._isElementDescribedByMessage(t,a)&&this._removeMessageReference(t,a),"string"==typeof i){const h=this._messageRegistry.get(a);h&&0===h.referenceCount&&this._deleteMessageElement(a)}0===this._messagesContainer?.childNodes.length&&(this._messagesContainer.remove(),this._messagesContainer=null)}ngOnDestroy(){const t=this._document.querySelectorAll(`[${VD}="${this._id}"]`);for(let i=0;i<t.length;i++)this._removeCdkDescribedByReferenceIds(t[i]),t[i].removeAttribute(VD);this._messagesContainer?.remove(),this._messagesContainer=null,this._messageRegistry.clear()}_createMessageElement(t,i){const r=this._document.createElement("div");rH(r,this._id),r.textContent=t,i&&r.setAttribute("role",i),this._createMessagesContainer(),this._messagesContainer.appendChild(r),this._messageRegistry.set(_O(t,i),{messageElement:r,referenceCount:0})}_deleteMessageElement(t){this._messageRegistry.get(t)?.messageElement?.remove(),this._messageRegistry.delete(t)}_createMessagesContainer(){if(this._messagesContainer)return;const t="cdk-describedby-message-container",i=this._document.querySelectorAll(`.${t}[platform="server"]`);for(let a=0;a<i.length;a++)i[a].remove();const r=this._document.createElement("div");r.style.visibility="hidden",r.classList.add(t),r.classList.add("cdk-visually-hidden"),this._platform.isBrowser||r.setAttribute("platform","server"),this._document.body.appendChild(r),this._messagesContainer=r}_removeCdkDescribedByReferenceIds(t){const i=BD(t,"aria-describedby").filter(r=>0!=r.indexOf(nH));t.setAttribute("aria-describedby",i.join(" "))}_addMessageReference(t,i){const r=this._messageRegistry.get(i);tH(t,"aria-describedby",r.messageElement.id),t.setAttribute(VD,this._id),r.referenceCount++}_removeMessageReference(t,i){const r=this._messageRegistry.get(i);r.referenceCount--,mO(t,"aria-describedby",r.messageElement.id),t.removeAttribute(VD)}_isElementDescribedByMessage(t,i){const r=BD(t,"aria-describedby"),a=this._messageRegistry.get(i),h=a&&a.messageElement.id;return!!h&&-1!=r.indexOf(h)}_canBeDescribed(t,i){if(!this._isElementNode(t))return!1;if(i&&"object"==typeof i)return!0;const r=null==i?"":`${i}`.trim(),a=t.getAttribute("aria-label");return!(!r||a&&a.trim()===r)}_isElementNode(t){return t.nodeType===this._document.ELEMENT_NODE}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function _O(e,n){return"string"==typeof e?`${n||""}/${e}`:e}function rH(e,n){e.id||(e.id=`${nH}-${n}-${gO++}`)}class oH{_letterKeyStream=new Ie;_items=[];_selectedItemIndex=-1;_pressedLetters=[];_skipPredicateFn;_selectedItem=new Ie;selectedItem=this._selectedItem;constructor(n,t){const i="number"==typeof t?.debounceInterval?t.debounceInterval:200;t?.skipPredicate&&(this._skipPredicateFn=t.skipPredicate),this.setItems(n),this._setupKeyHandler(i)}destroy(){this._pressedLetters=[],this._letterKeyStream.complete(),this._selectedItem.complete()}setCurrentSelectedItemIndex(n){this._selectedItemIndex=n}setItems(n){this._items=n}handleKey(n){const t=n.keyCode;n.key&&1===n.key.length?this._letterKeyStream.next(n.key.toLocaleUpperCase()):(t>=65&&t<=90||t>=48&&t<=57)&&this._letterKeyStream.next(String.fromCharCode(t))}isTyping(){return this._pressedLetters.length>0}reset(){this._pressedLetters=[]}_setupKeyHandler(n){this._letterKeyStream.pipe(Vo(t=>this._pressedLetters.push(t)),hO(n),is(()=>this._pressedLetters.length>0),$t(()=>this._pressedLetters.join("").toLocaleUpperCase())).subscribe(t=>{for(let i=1;i<this._items.length+1;i++){const a=this._items[(this._selectedItemIndex+i)%this._items.length];if(!this._skipPredicateFn?.(a)&&0===a.getLabel?.().toLocaleUpperCase().trim().indexOf(t)){this._selectedItem.next(a);break}}this._pressedLetters=[]})}}class sH{_items;_activeItemIndex=-1;_activeItem=ha(null);_wrap=!1;_typeaheadSubscription=Ni.EMPTY;_itemChangesSubscription;_vertical=!0;_horizontal;_allowedModifierKeys=[];_homeAndEnd=!1;_pageUpAndDown={enabled:!1,delta:10};_effectRef;_typeahead;_skipPredicateFn=n=>n.disabled;constructor(n,t){this._items=n,n instanceof od?this._itemChangesSubscription=n.changes.subscribe(i=>this._itemsChanged(i.toArray())):W0(n)&&(this._effectRef=uE(()=>this._itemsChanged(n()),{injector:t}))}tabOut=new Ie;change=new Ie;skipPredicate(n){return this._skipPredicateFn=n,this}withWrap(n=!0){return this._wrap=n,this}withVerticalOrientation(n=!0){return this._vertical=n,this}withHorizontalOrientation(n){return this._horizontal=n,this}withAllowedModifierKeys(n){return this._allowedModifierKeys=n,this}withTypeAhead(n=200){this._typeaheadSubscription.unsubscribe();const t=this._getItemsArray();return this._typeahead=new oH(t,{debounceInterval:"number"==typeof n?n:void 0,skipPredicate:i=>this._skipPredicateFn(i)}),this._typeaheadSubscription=this._typeahead.selectedItem.subscribe(i=>{this.setActiveItem(i)}),this}cancelTypeahead(){return this._typeahead?.reset(),this}withHomeAndEnd(n=!0){return this._homeAndEnd=n,this}withPageUpDown(n=!0,t=10){return this._pageUpAndDown={enabled:n,delta:t},this}setActiveItem(n){const t=this._activeItem();this.updateActiveItem(n),this._activeItem()!==t&&this.change.next(this._activeItemIndex)}onKeydown(n){const t=n.keyCode,r=["altKey","ctrlKey","metaKey","shiftKey"].every(a=>!n[a]||this._allowedModifierKeys.indexOf(a)>-1);switch(t){case 9:return void this.tabOut.next();case 40:if(this._vertical&&r){this.setNextItemActive();break}return;case 38:if(this._vertical&&r){this.setPreviousItemActive();break}return;case 39:if(this._horizontal&&r){"rtl"===this._horizontal?this.setPreviousItemActive():this.setNextItemActive();break}return;case 37:if(this._horizontal&&r){"rtl"===this._horizontal?this.setNextItemActive():this.setPreviousItemActive();break}return;case 36:if(this._homeAndEnd&&r){this.setFirstItemActive();break}return;case 35:if(this._homeAndEnd&&r){this.setLastItemActive();break}return;case 33:if(this._pageUpAndDown.enabled&&r){const a=this._activeItemIndex-this._pageUpAndDown.delta;this._setActiveItemByIndex(a>0?a:0,1);break}return;case 34:if(this._pageUpAndDown.enabled&&r){const a=this._activeItemIndex+this._pageUpAndDown.delta,h=this._getItemsArray().length;this._setActiveItemByIndex(a<h?a:h-1,-1);break}return;default:return void((r||Pm(n,"shiftKey"))&&this._typeahead?.handleKey(n))}this._typeahead?.reset(),n.preventDefault()}get activeItemIndex(){return this._activeItemIndex}get activeItem(){return this._activeItem()}isTyping(){return!!this._typeahead&&this._typeahead.isTyping()}setFirstItemActive(){this._setActiveItemByIndex(0,1)}setLastItemActive(){this._setActiveItemByIndex(this._getItemsArray().length-1,-1)}setNextItemActive(){this._activeItemIndex<0?this.setFirstItemActive():this._setActiveItemByDelta(1)}setPreviousItemActive(){this._activeItemIndex<0&&this._wrap?this.setLastItemActive():this._setActiveItemByDelta(-1)}updateActiveItem(n){const t=this._getItemsArray(),i="number"==typeof n?n:t.indexOf(n);this._activeItem.set(t[i]??null),this._activeItemIndex=i,this._typeahead?.setCurrentSelectedItemIndex(i)}destroy(){this._typeaheadSubscription.unsubscribe(),this._itemChangesSubscription?.unsubscribe(),this._effectRef?.destroy(),this._typeahead?.destroy(),this.tabOut.complete(),this.change.complete()}_setActiveItemByDelta(n){this._wrap?this._setActiveInWrapMode(n):this._setActiveInDefaultMode(n)}_setActiveInWrapMode(n){const t=this._getItemsArray();for(let i=1;i<=t.length;i++){const r=(this._activeItemIndex+n*i+t.length)%t.length;if(!this._skipPredicateFn(t[r]))return void this.setActiveItem(r)}}_setActiveInDefaultMode(n){this._setActiveItemByIndex(this._activeItemIndex+n,n)}_setActiveItemByIndex(n,t){const i=this._getItemsArray();if(i[n]){for(;this._skipPredicateFn(i[n]);)if(!i[n+=t])return;this.setActiveItem(n)}}_getItemsArray(){return W0(this._items)?this._items():this._items instanceof od?this._items.toArray():this._items}_itemsChanged(n){this._typeahead?.setItems(n);const t=this._activeItem();if(t){const i=n.indexOf(t);i>-1&&i!==this._activeItemIndex&&(this._activeItemIndex=i,this._typeahead?.setCurrentSelectedItemIndex(i))}}}class qae extends sH{setActiveItem(n){this.activeItem&&this.activeItem.setInactiveStyles(),super.setActiveItem(n),this.activeItem&&this.activeItem.setActiveStyles()}}class aH extends sH{_origin="program";setFocusOrigin(n){return this._origin=n,this}setActiveItem(n){super.setActiveItem(n),this.activeItem&&this.activeItem.focus(this._origin)}}function UD(e){return 0===e.buttons||0===e.detail}function jD(e){const n=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}const nle=new ct("cdk-input-modality-detector-options"),ile={ignoreKeys:[18,17,224,91,16]},Fx=cu({passive:!0,capture:!0});let rle=(()=>{class e{_platform=re(Hs);modalityDetected;modalityChanged;get mostRecentModality(){return this._modality.value}_mostRecentTarget=null;_modality=new Je(null);_options;_lastTouchMs=0;_onKeydown=t=>{this._options?.ignoreKeys?.some(i=>i===t.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=Pc(t))};_onMousedown=t=>{Date.now()-this._lastTouchMs<650||(this._modality.next(UD(t)?"keyboard":"mouse"),this._mostRecentTarget=Pc(t))};_onTouchstart=t=>{jD(t)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=Pc(t))};constructor(){const t=re(Ht),i=re(ir),r=re(nle,{optional:!0});this._options={...ile,...r},this.modalityDetected=this._modality.pipe(Wj(1)),this.modalityChanged=this.modalityDetected.pipe(Zj()),this._platform.isBrowser&&t.runOutsideAngular(()=>{i.addEventListener("keydown",this._onKeydown,Fx),i.addEventListener("mousedown",this._onMousedown,Fx),i.addEventListener("touchstart",this._onTouchstart,Fx)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Fx),document.removeEventListener("mousedown",this._onMousedown,Fx),document.removeEventListener("touchstart",this._onTouchstart,Fx))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const ole=new ct("liveAnnouncerElement",{providedIn:"root",factory:function sle(){return null}}),ale=new ct("LIVE_ANNOUNCER_DEFAULT_OPTIONS");let lle=0,cle=(()=>{class e{_ngZone=re(Ht);_defaultOptions=re(ale,{optional:!0});_liveElement;_document=re(ir);_previousTimeout;_currentPromise;_currentResolve;constructor(){const t=re(ole,{optional:!0});this._liveElement=t||this._createLiveElement()}announce(t,...i){const r=this._defaultOptions;let a,h;return 1===i.length&&"number"==typeof i[0]?h=i[0]:[a,h]=i,this.clear(),clearTimeout(this._previousTimeout),a||(a=r&&r.politeness?r.politeness:"polite"),null==h&&r&&(h=r.duration),this._liveElement.setAttribute("aria-live",a),this._liveElement.id&&this._exposeAnnouncerToModals(this._liveElement.id),this._ngZone.runOutsideAngular(()=>(this._currentPromise||(this._currentPromise=new Promise(v=>this._currentResolve=v)),clearTimeout(this._previousTimeout),this._previousTimeout=setTimeout(()=>{this._liveElement.textContent=t,"number"==typeof h&&(this._previousTimeout=setTimeout(()=>this.clear(),h)),this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0},100),this._currentPromise))}clear(){this._liveElement&&(this._liveElement.textContent="")}ngOnDestroy(){clearTimeout(this._previousTimeout),this._liveElement?.remove(),this._liveElement=null,this._currentResolve?.(),this._currentPromise=this._currentResolve=void 0}_createLiveElement(){const t="cdk-live-announcer-element",i=this._document.getElementsByClassName(t),r=this._document.createElement("div");for(let a=0;a<i.length;a++)i[a].remove();return r.classList.add(t),r.classList.add("cdk-visually-hidden"),r.setAttribute("aria-atomic","true"),r.setAttribute("aria-live","polite"),r.id="cdk-live-announcer-"+lle++,this._document.body.appendChild(r),r}_exposeAnnouncerToModals(t){const i=this._document.querySelectorAll('body > .cdk-overlay-container [aria-modal="true"]');for(let r=0;r<i.length;r++){const a=i[r],h=a.getAttribute("aria-owns");h?-1===h.indexOf(t)&&a.setAttribute("aria-owns",h+" "+t):a.setAttribute("aria-owns",t)}}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var HD=function(e){return e[e.IMMEDIATE=0]="IMMEDIATE",e[e.EVENTUAL=1]="EVENTUAL",e}(HD||{});const dle=new ct("cdk-focus-monitor-default-options"),$D=cu({passive:!0,capture:!0});let Lx=(()=>{class e{_ngZone=re(Ht);_platform=re(Hs);_inputModalityDetector=re(rle);_origin=null;_lastFocusOrigin;_windowFocused=!1;_windowFocusTimeoutId;_originTimeoutId;_originFromTouchInteraction=!1;_elementInfo=new Map;_monitoredElementCount=0;_rootNodeFocusListenerCount=new Map;_detectionMode;_windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=setTimeout(()=>this._windowFocused=!1)};_document=re(ir,{optional:!0});_stopInputModalityDetector=new Ie;constructor(){const t=re(dle,{optional:!0});this._detectionMode=t?.detectionMode||HD.IMMEDIATE}_rootNodeFocusAndBlurListener=t=>{for(let r=Pc(t);r;r=r.parentElement)"focus"===t.type?this._onFocus(t,r):this._onBlur(t,r)};monitor(t,i=!1){const r=xl(t);if(!this._platform.isBrowser||1!==r.nodeType)return vn();const a=kD(r)||this._getDocument(),h=this._elementInfo.get(r);if(h)return i&&(h.checkChildren=!0),h.subject;const v={checkChildren:i,subject:new Ie,rootNode:a};return this._elementInfo.set(r,v),this._registerGlobalListeners(v),v.subject}stopMonitoring(t){const i=xl(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const a=xl(t);a===this._getDocument().activeElement?this._getClosestElementsInfo(a).forEach(([v,C])=>this._originChanged(v,i,C)):(this._setOrigin(i),"function"==typeof a.focus&&a.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return this._detectionMode===HD.EVENTUAL||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,this._detectionMode===HD.IMMEDIATE&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),a=Pc(t);!r||!r.checkChildren&&i!==a||this._originChanged(i,this._getFocusOrigin(a),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,$D),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,$D)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Er(this._stopInputModalityDetector)).subscribe(a=>{this._setOrigin(a,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,$D),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,$D),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,a)=>{(a===t||r.checkChildren&&a.contains(t))&&i.push([a,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const a=t.labels;if(a)for(let h=0;h<a.length;h++)if(a[h].contains(i))return!0;return!1}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Kv=function(e){return e[e.NONE=0]="NONE",e[e.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",e[e.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",e}(Kv||{});const hH="cdk-high-contrast-black-on-white",fH="cdk-high-contrast-white-on-black",yO="cdk-high-contrast-active";let pH=(()=>{class e{_platform=re(Hs);_hasCheckedHighContrastMode;_document=re(ir);_breakpointSubscription;constructor(){this._breakpointSubscription=re(zD).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Kv.NONE;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,a=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Kv.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Kv.BLACK_ON_WHITE}return Kv.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(yO,hH,fH),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();i===Kv.BLACK_ON_WHITE?t.add(yO,hH):i===Kv.WHITE_ON_BLACK&&t.add(yO,fH)}}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ule=(()=>{class e{constructor(){re(pH)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[fO]})}return e})();const vO={};let du=(()=>{class e{_appId=re(Mf);getId(t){return"ng"!==this._appId&&(t+=this._appId),vO.hasOwnProperty(t)||(vO[t]=0),`${t}${vO[t]++}`}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const hle=new ct("cdk-dir-doc",{providedIn:"root",factory:function fle(){return re(ir)}}),ple=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Om=(()=>{class e{value="ltr";change=new Dt;constructor(){const t=re(hle,{optional:!0});t&&(this.value=function mle(e){const n=e?.toLowerCase()||"";return"auto"===n&&typeof navigator<"u"&&navigator?.language?ple.test(navigator.language)?"rtl":"ltr":"rtl"===n?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),HC=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();const gle=["text"],_le=[[["mat-icon"]],"*"],yle=["mat-icon","*"];function vle(e,n){if(1&e&&_n(0,"mat-pseudo-checkbox",1),2&e){const t=cn();At("disabled",t.disabled)("state",t.selected?"checked":"unchecked")}}function ble(e,n){1&e&&_n(0,"mat-pseudo-checkbox",3),2&e&&At("disabled",cn().disabled)}function xle(e,n){if(1&e&&(Fe(0,"span",4),gt(1),Ue()),2&e){const t=cn();Ze(),Sr("(",t.group.label,")")}}const wle=["mat-internal-form-field",""],Cle=["*"];let or=(()=>{class e{constructor(){re(pH)._applyBodyHighContrastModeCssClasses()}static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[HC,HC]})}return e})();class mH{_defaultMatcher;ngControl;_parentFormGroup;_parentForm;_stateChanges;errorState=!1;matcher;constructor(n,t,i,r,a){this._defaultMatcher=n,this.ngControl=t,this._parentFormGroup=i,this._parentForm=r,this._stateChanges=a}updateErrorState(){const n=this.errorState,t=this._parentFormGroup||this._parentForm,i=this.matcher||this._defaultMatcher,r=this.ngControl?this.ngControl.control:null,a=i?.isErrorState(r,t)??!1;a!==n&&(this.errorState=a,this._stateChanges.next())}}let gH=(()=>{class e{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Qv=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["structural-styles"]],decls:0,vars:0,template:function(i,r){},styles:['.mat-focus-indicator{position:relative}.mat-focus-indicator::before{top:0;left:0;right:0;bottom:0;position:absolute;box-sizing:border-box;pointer-events:none;display:var(--mat-focus-indicator-display, none);border-width:var(--mat-focus-indicator-border-width, 3px);border-style:var(--mat-focus-indicator-border-style, solid);border-color:var(--mat-focus-indicator-border-color, transparent);border-radius:var(--mat-focus-indicator-border-radius, 4px)}.mat-focus-indicator:focus::before{content:""}@media(forced-colors: active){html{--mat-focus-indicator-display: block}}'],encapsulation:2,changeDetection:0})}return e})(),_H=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,or]})}return e})();var uu=function(e){return e[e.FADING_IN=0]="FADING_IN",e[e.VISIBLE=1]="VISIBLE",e[e.FADING_OUT=2]="FADING_OUT",e[e.HIDDEN=3]="HIDDEN",e}(uu||{});class Ale{_renderer;element;config;_animationForciblyDisabledThroughCss;state=uu.HIDDEN;constructor(n,t,i,r=!1){this._renderer=n,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r}fadeOut(){this._renderer.fadeOutRipple(this)}}const yH=cu({passive:!0,capture:!0});class Rle{_events=new Map;addHandler(n,t,i,r){const a=this._events.get(t);if(a){const h=a.get(i);h?h.add(r):a.set(i,new Set([r]))}else this._events.set(t,new Map([[i,new Set([r])]])),n.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,yH)})}removeHandler(n,t,i){const r=this._events.get(n);if(!r)return;const a=r.get(t);a&&(a.delete(i),0===a.size&&r.delete(t),0===r.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,yH)))}_delegateEventHandler=n=>{const t=Pc(n);t&&this._events.get(n.type)?.forEach((i,r)=>{(r===t||r.contains(t))&&i.forEach(a=>a.handleEvent(n))})}}const GD={enterDuration:225,exitDuration:150},vH=cu({passive:!0,capture:!0}),bH=["mousedown","touchstart"],xH=["mouseup","mouseleave","touchend","touchcancel"];let Ole=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["ng-component"]],hostAttrs:["mat-ripple-style-loader",""],decls:0,vars:0,template:function(i,r){},styles:[".mat-ripple{overflow:hidden;position:relative}.mat-ripple:not(:empty){transform:translateZ(0)}.mat-ripple.mat-ripple-unbounded{overflow:visible}.mat-ripple-element{position:absolute;border-radius:50%;pointer-events:none;transition:opacity,transform 0ms cubic-bezier(0, 0, 0.2, 1);transform:scale3d(0, 0, 0);background-color:var(--mat-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface) 10%, transparent))}@media(forced-colors: active){.mat-ripple-element{display:none}}.cdk-drag-preview .mat-ripple-element,.cdk-drag-placeholder .mat-ripple-element{display:none}"],encapsulation:2,changeDetection:0})}return e})();class zx{_target;_ngZone;_platform;_containerElement;_triggerElement;_isPointerDown=!1;_activeRipples=new Map;_mostRecentTransientRipple;_lastTouchStartEvent;_pointerUpEventsRegistered=!1;_containerRect;static _eventManager=new Rle;constructor(n,t,i,r,a){this._target=n,this._ngZone=t,this._platform=r,r.isBrowser&&(this._containerElement=xl(i)),a&&a.get(Oc).load(Ole)}fadeInRipple(n,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),a={...GD,...i.animation};i.centered&&(n=r.left+r.width/2,t=r.top+r.height/2);const h=i.radius||function Fle(e,n,t){const i=Math.max(Math.abs(e-t.left),Math.abs(e-t.right)),r=Math.max(Math.abs(n-t.top),Math.abs(n-t.bottom));return Math.sqrt(i*i+r*r)}(n,t,r),v=n-r.left,C=t-r.top,P=a.enterDuration,L=document.createElement("div");L.classList.add("mat-ripple-element"),L.style.left=v-h+"px",L.style.top=C-h+"px",L.style.height=2*h+"px",L.style.width=2*h+"px",null!=i.color&&(L.style.backgroundColor=i.color),L.style.transitionDuration=`${P}ms`,this._containerElement.appendChild(L);const V=window.getComputedStyle(L),X=V.transitionDuration,oe="none"===V.transitionProperty||"0s"===X||"0s, 0s"===X||0===r.width&&0===r.height,he=new Ale(this,L,i,oe);L.style.transform="scale3d(1, 1, 1)",he.state=uu.FADING_IN,i.persistent||(this._mostRecentTransientRipple=he);let se=null;return!oe&&(P||a.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const _e=()=>{se&&(se.fallbackTimer=null),clearTimeout($e),this._finishRippleTransition(he)},Se=()=>this._destroyRipple(he),$e=setTimeout(Se,P+100);L.addEventListener("transitionend",_e),L.addEventListener("transitioncancel",Se),se={onTransitionEnd:_e,onTransitionCancel:Se,fallbackTimer:$e}}),this._activeRipples.set(he,se),(oe||!P)&&this._finishRippleTransition(he),he}fadeOutRipple(n){if(n.state===uu.FADING_OUT||n.state===uu.HIDDEN)return;const t=n.element,i={...GD,...n.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",n.state=uu.FADING_OUT,(n._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const t=xl(n);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,bH.forEach(i=>{zx._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{xH.forEach(t=>{this._triggerElement.addEventListener(t,this,vH)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){n.state===uu.FADING_IN?this._startFadeOutTransition(n):n.state===uu.FADING_OUT&&this._destroyRipple(n)}_startFadeOutTransition(n){const t=n===this._mostRecentTransientRipple,{persistent:i}=n.config;n.state=uu.VISIBLE,!i&&(!t||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const t=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=uu.HIDDEN,null!==t&&(n.element.removeEventListener("transitionend",t.onTransitionEnd),n.element.removeEventListener("transitioncancel",t.onTransitionCancel),null!==t.fallbackTimer&&clearTimeout(t.fallbackTimer)),n.element.remove()}_onMousedown(n){const t=UD(n),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!jD(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=n.changedTouches;if(t)for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(n.state===uu.VISIBLE||n.config.terminateOnPointerUp&&n.state===uu.FADING_IN)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(bH.forEach(t=>zx._eventManager.removeHandler(t,n,this)),this._pointerUpEventsRegistered&&(xH.forEach(t=>n.removeEventListener(t,this,vH)),this._pointerUpEventsRegistered=!1))}}const bO=new ct("mat-ripple-global-options");let xO=(()=>{class e{_elementRef=re(In);_animationMode=re(Ga,{optional:!0});color;unbounded;centered;radius=0;animation;get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}_disabled=!1;get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}_trigger;_rippleRenderer;_globalOptions;_isInitialized=!1;constructor(){const t=re(Ht),i=re(Hs),r=re(bO,{optional:!0}),a=re(Ye);this._globalOptions=r||{},this._rippleRenderer=new zx(this,t,this._elementRef,i,a)}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:{...this._globalOptions.animation,..."NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{},...this.animation},terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,{...this.rippleConfig,...r}):this._rippleRenderer.fadeInRipple(0,0,{...this.rippleConfig,...t})}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(i,r){2&i&&Ti("mat-ripple-unbounded",r.unbounded)},inputs:{color:[0,"matRippleColor","color"],unbounded:[0,"matRippleUnbounded","unbounded"],centered:[0,"matRippleCentered","centered"],radius:[0,"matRippleRadius","radius"],animation:[0,"matRippleAnimation","animation"],disabled:[0,"matRippleDisabled","disabled"],trigger:[0,"matRippleTrigger","trigger"]},exportAs:["matRipple"]})}return e})(),GC=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,or]})}return e})(),Lle=(()=>{class e{_animationMode=re(Ga,{optional:!0});state="unchecked";disabled=!1;appearance="full";constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-pseudo-checkbox"]],hostAttrs:[1,"mat-pseudo-checkbox"],hostVars:12,hostBindings:function(i,r){2&i&&Ti("mat-pseudo-checkbox-indeterminate","indeterminate"===r.state)("mat-pseudo-checkbox-checked","checked"===r.state)("mat-pseudo-checkbox-disabled",r.disabled)("mat-pseudo-checkbox-minimal","minimal"===r.appearance)("mat-pseudo-checkbox-full","full"===r.appearance)("_mat-animation-noopable","NoopAnimations"===r._animationMode)},inputs:{state:"state",disabled:"disabled",appearance:"appearance"},decls:0,vars:0,template:function(i,r){},styles:['.mat-pseudo-checkbox{border-radius:2px;cursor:pointer;display:inline-block;vertical-align:middle;box-sizing:border-box;position:relative;flex-shrink:0;transition:border-color 90ms cubic-bezier(0, 0, 0.2, 0.1),background-color 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox::after{position:absolute;opacity:0;content:"";border-bottom:2px solid currentColor;transition:opacity 90ms cubic-bezier(0, 0, 0.2, 0.1)}.mat-pseudo-checkbox._mat-animation-noopable{transition:none !important;animation:none !important}.mat-pseudo-checkbox._mat-animation-noopable::after{transition:none}.mat-pseudo-checkbox-disabled{cursor:default}.mat-pseudo-checkbox-indeterminate::after{left:1px;opacity:1;border-radius:2px}.mat-pseudo-checkbox-checked::after{left:1px;border-left:2px solid currentColor;transform:rotate(-45deg);opacity:1;box-sizing:content-box}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-minimal-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-primary))}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-minimal-pseudo-checkbox-disabled-selected-checkmark-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full{border-color:var(--mat-full-pseudo-checkbox-unselected-icon-color, var(--mat-sys-on-surface-variant));border-width:2px;border-style:solid}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-disabled{border-color:var(--mat-full-pseudo-checkbox-disabled-unselected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate{background-color:var(--mat-full-pseudo-checkbox-selected-icon-color, var(--mat-sys-primary));border-color:rgba(0,0,0,0)}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{color:var(--mat-full-pseudo-checkbox-selected-checkmark-color, var(--mat-sys-on-primary))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled{background-color:var(--mat-full-pseudo-checkbox-disabled-selected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked.mat-pseudo-checkbox-disabled::after,.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate.mat-pseudo-checkbox-disabled::after{color:var(--mat-full-pseudo-checkbox-disabled-selected-checkmark-color, var(--mat-sys-surface))}.mat-pseudo-checkbox{width:18px;height:18px}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-checked::after{width:14px;height:6px;transform-origin:center;top:-4.2426406871px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-minimal.mat-pseudo-checkbox-indeterminate::after{top:8px;width:16px}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-checked::after{width:10px;height:4px;transform-origin:center;top:-2.8284271247px;left:0;bottom:0;right:0;margin:auto}.mat-pseudo-checkbox-full.mat-pseudo-checkbox-indeterminate::after{top:6px;width:12px}'],encapsulation:2,changeDetection:0})}return e})(),wH=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or]})}return e})();const CH=new ct("MAT_OPTION_PARENT_COMPONENT"),TH=new ct("MatOptgroup");class Nle{source;isUserInput;constructor(n,t=!1){this.source=n,this.isUserInput=t}}let wO=(()=>{class e{_element=re(In);_changeDetectorRef=re(Bo);_parent=re(CH,{optional:!0});group=re(TH,{optional:!0});_signalDisableRipple=!1;_selected=!1;_active=!1;_disabled=!1;_mostRecentViewValue="";get multiple(){return this._parent&&this._parent.multiple}get selected(){return this._selected}value;id=re(du).getId("mat-option-");get disabled(){return this.group&&this.group.disabled||this._disabled}set disabled(t){this._disabled=t}get disableRipple(){return this._signalDisableRipple?this._parent.disableRipple():!!this._parent?.disableRipple}get hideSingleSelectionIndicator(){return!(!this._parent||!this._parent.hideSingleSelectionIndicator)}onSelectionChange=new Dt;_text;_stateChanges=new Ie;constructor(){re(Oc).load(Qv),re(Oc).load(qj),this._signalDisableRipple=!!this._parent&&W0(this._parent.disableRipple)}get active(){return this._active}get viewValue(){return(this._text?.nativeElement.textContent||"").trim()}select(t=!0){this._selected||(this._selected=!0,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}deselect(t=!0){this._selected&&(this._selected=!1,this._changeDetectorRef.markForCheck(),t&&this._emitSelectionChangeEvent())}focus(t,i){const r=this._getHostElement();"function"==typeof r.focus&&r.focus(i)}setActiveStyles(){this._active||(this._active=!0,this._changeDetectorRef.markForCheck())}setInactiveStyles(){this._active&&(this._active=!1,this._changeDetectorRef.markForCheck())}getLabel(){return this.viewValue}_handleKeydown(t){(13===t.keyCode||32===t.keyCode)&&!Pm(t)&&(this._selectViaInteraction(),t.preventDefault())}_selectViaInteraction(){this.disabled||(this._selected=!this.multiple||!this._selected,this._changeDetectorRef.markForCheck(),this._emitSelectionChangeEvent(!0))}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._element.nativeElement}ngAfterViewChecked(){if(this._selected){const t=this.viewValue;t!==this._mostRecentViewValue&&(this._mostRecentViewValue&&this._stateChanges.next(),this._mostRecentViewValue=t)}}ngOnDestroy(){this._stateChanges.complete()}_emitSelectionChangeEvent(t=!1){this.onSelectionChange.emit(new Nle(this,t))}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-option"]],viewQuery:function(i,r){if(1&i&&zr(gle,7),2&i){let a;ri(a=oi())&&(r._text=a.first)}},hostAttrs:["role","option",1,"mat-mdc-option","mdc-list-item"],hostVars:11,hostBindings:function(i,r){1&i&&Nn("click",function(){return r._selectViaInteraction()})("keydown",function(h){return r._handleKeydown(h)}),2&i&&(ax("id",r.id),ui("aria-selected",r.selected)("aria-disabled",r.disabled.toString()),Ti("mdc-list-item--selected",r.selected)("mat-mdc-option-multiple",r.multiple)("mat-mdc-option-active",r.active)("mdc-list-item--disabled",r.disabled))},inputs:{value:"value",id:"id",disabled:[2,"disabled","disabled",zn]},outputs:{onSelectionChange:"onSelectionChange"},exportAs:["matOption"],features:[jr],ngContentSelectors:yle,decls:8,vars:5,consts:[["text",""],["aria-hidden","true",1,"mat-mdc-option-pseudo-checkbox",3,"disabled","state"],[1,"mdc-list-item__primary-text"],["state","checked","aria-hidden","true","appearance","minimal",1,"mat-mdc-option-pseudo-checkbox",3,"disabled"],[1,"cdk-visually-hidden"],["aria-hidden","true","mat-ripple","",1,"mat-mdc-option-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"]],template:function(i,r){1&i&&(zo(_le),an(0,vle,1,2,"mat-pseudo-checkbox",1),ai(1),Fe(2,"span",2,0),ai(4,1),Ue(),an(5,ble,1,1,"mat-pseudo-checkbox",3)(6,xle,2,1,"span",4),_n(7,"div",5)),2&i&&(Mr(r.multiple?0:-1),Ze(5),Mr(r.multiple||!r.selected||r.hideSingleSelectionIndicator?-1:5),Ze(),Mr(r.group&&r.group._inert?6:-1),Ze(),At("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disabled||r.disableRipple))},dependencies:[Lle,xO],styles:['.mat-mdc-option{-webkit-user-select:none;user-select:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;min-height:48px;padding:0 16px;cursor:pointer;-webkit-tap-highlight-color:rgba(0,0,0,0);color:var(--mat-option-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-option-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-option-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-option-label-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-option-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-option-label-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-option:hover:not(.mdc-list-item--disabled){background-color:var(--mat-option-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-option:focus.mdc-list-item,.mat-mdc-option.mat-mdc-option-active.mdc-list-item{background-color:var(--mat-option-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent));outline:0}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled) .mdc-list-item__primary-text{color:var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item--selected:not(.mdc-list-item--disabled):not(.mat-mdc-option-multiple){background-color:var(--mat-option-selected-state-layer-color, var(--mat-sys-secondary-container))}.mat-mdc-option .mat-pseudo-checkbox{--mat-minimal-pseudo-checkbox-selected-checkmark-color: var(--mat-option-selected-state-label-text-color, var(--mat-sys-on-secondary-container))}.mat-mdc-option.mdc-list-item{align-items:center;background:rgba(0,0,0,0)}.mat-mdc-option.mdc-list-item--disabled{cursor:default;pointer-events:none}.mat-mdc-option.mdc-list-item--disabled .mat-mdc-option-pseudo-checkbox,.mat-mdc-option.mdc-list-item--disabled .mdc-list-item__primary-text,.mat-mdc-option.mdc-list-item--disabled>mat-icon{opacity:.38}.mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:32px}[dir=rtl] .mat-mdc-optgroup .mat-mdc-option:not(.mat-mdc-option-multiple){padding-left:16px;padding-right:32px}.mat-mdc-option .mat-icon,.mat-mdc-option .mat-pseudo-checkbox-full{margin-right:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-icon,[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-full{margin-right:0;margin-left:16px}.mat-mdc-option .mat-pseudo-checkbox-minimal{margin-left:16px;flex-shrink:0}[dir=rtl] .mat-mdc-option .mat-pseudo-checkbox-minimal{margin-right:16px;margin-left:0}.mat-mdc-option .mat-mdc-option-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-option .mdc-list-item__primary-text{white-space:normal;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;font-family:inherit;text-decoration:inherit;text-transform:inherit;margin-right:auto}[dir=rtl] .mat-mdc-option .mdc-list-item__primary-text{margin-right:0;margin-left:auto}@media(forced-colors: active){.mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}[dir=rtl] .mat-mdc-option.mdc-list-item--selected:not(:has(.mat-mdc-option-pseudo-checkbox))::after{right:auto;left:16px}}.mat-mdc-option-multiple{--mdc-list-list-item-selected-container-color:var(--mdc-list-list-item-container-color, transparent)}.mat-mdc-option-active .mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})(),MH=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[GC,or,wH]})}return e})();const SH={capture:!0},EH=["focus","mousedown","mouseenter","touchstart"],CO="mat-ripple-loader-uninitialized",TO="mat-ripple-loader-class-name",DH="mat-ripple-loader-centered",qD="mat-ripple-loader-disabled";let Vle=(()=>{class e{_document=re(ir,{optional:!0});_animationMode=re(Ga,{optional:!0});_globalRippleOptions=re(bO,{optional:!0});_platform=re(Hs);_ngZone=re(Ht);_injector=re(Ye);_hosts=new Map;constructor(){this._ngZone.runOutsideAngular(()=>{for(const t of EH)this._document?.addEventListener(t,this._onInteraction,SH)})}ngOnDestroy(){const t=this._hosts.keys();for(const i of t)this.destroyRipple(i);for(const i of EH)this._document?.removeEventListener(i,this._onInteraction,SH)}configureRipple(t,i){t.setAttribute(CO,this._globalRippleOptions?.namespace??""),(i.className||!t.hasAttribute(TO))&&t.setAttribute(TO,i.className||""),i.centered&&t.setAttribute(DH,""),i.disabled&&t.setAttribute(qD,"")}setDisabled(t,i){const r=this._hosts.get(t);r?(r.target.rippleDisabled=i,!i&&!r.hasSetUpEvents&&(r.hasSetUpEvents=!0,r.renderer.setupTriggerEvents(t))):i?t.setAttribute(qD,""):t.removeAttribute(qD)}_onInteraction=t=>{const i=Pc(t);if(i instanceof HTMLElement){const r=i.closest(`[${CO}="${this._globalRippleOptions?.namespace??""}"]`);r&&this._createRipple(r)}};_createRipple(t){if(!this._document||this._hosts.has(t))return;t.querySelector(".mat-ripple")?.remove();const i=this._document.createElement("span");i.classList.add("mat-ripple",t.getAttribute(TO)),t.append(i);const r="NoopAnimations"===this._animationMode,a=this._globalRippleOptions,h=r?0:a?.animation?.enterDuration??GD.enterDuration,v=r?0:a?.animation?.exitDuration??GD.exitDuration,C={rippleDisabled:r||a?.disabled||t.hasAttribute(qD),rippleConfig:{centered:t.hasAttribute(DH),terminateOnPointerUp:a?.terminateOnPointerUp,animation:{enterDuration:h,exitDuration:v}}},P=new zx(C,this._ngZone,i,this._platform,this._injector),L=!C.rippleDisabled;L&&P.setupTriggerEvents(t),this._hosts.set(t,{target:C,renderer:P,hasSetUpEvents:L}),t.removeAttribute(CO)}destroyRipple(t){const i=this._hosts.get(t);i&&(i.renderer._removeTriggerEvents(),this._hosts.delete(t))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Ule=(()=>{class e{labelPosition;static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["div","mat-internal-form-field",""]],hostAttrs:[1,"mdc-form-field","mat-internal-form-field"],hostVars:2,hostBindings:function(i,r){2&i&&Ti("mdc-form-field--align-end","before"===r.labelPosition)},inputs:{labelPosition:"labelPosition"},attrs:wle,ngContentSelectors:Cle,decls:1,vars:0,template:function(i,r){1&i&&(zo(),ai(0))},styles:[".mat-internal-form-field{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-flex;align-items:center;vertical-align:middle}.mat-internal-form-field>label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0;order:0}[dir=rtl] .mat-internal-form-field>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px}.mdc-form-field--align-end>label{margin-left:auto;margin-right:0;padding-left:0;padding-right:4px;order:-1}[dir=rtl] .mdc-form-field--align-end .mdc-form-field--align-end label{margin-left:0;margin-right:auto;padding-left:4px;padding-right:0}"],encapsulation:2,changeDetection:0})}return e})();const jle=["mat-button",""],MO=[[["",8,"material-icons",3,"iconPositionEnd",""],["mat-icon",3,"iconPositionEnd",""],["","matButtonIcon","",3,"iconPositionEnd",""]],"*",[["","iconPositionEnd","",8,"material-icons"],["mat-icon","iconPositionEnd",""],["","matButtonIcon","","iconPositionEnd",""]]],SO=[".material-icons:not([iconPositionEnd]), mat-icon:not([iconPositionEnd]), [matButtonIcon]:not([iconPositionEnd])","*",".material-icons[iconPositionEnd], mat-icon[iconPositionEnd], [matButtonIcon][iconPositionEnd]"],$le=["mat-fab",""],Gle=["mat-mini-fab",""],Wle=["mat-icon-button",""],Zle=["*"],Yle=new ct("MAT_BUTTON_CONFIG"),Xle=[{attribute:"mat-button",mdcClasses:["mdc-button","mat-mdc-button"]},{attribute:"mat-flat-button",mdcClasses:["mdc-button","mdc-button--unelevated","mat-mdc-unelevated-button"]},{attribute:"mat-raised-button",mdcClasses:["mdc-button","mdc-button--raised","mat-mdc-raised-button"]},{attribute:"mat-stroked-button",mdcClasses:["mdc-button","mdc-button--outlined","mat-mdc-outlined-button"]},{attribute:"mat-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mat-mdc-fab"]},{attribute:"mat-mini-fab",mdcClasses:["mdc-fab","mat-mdc-fab-base","mdc-fab--mini","mat-mdc-mini-fab"]},{attribute:"mat-icon-button",mdcClasses:["mdc-icon-button","mat-mdc-icon-button"]}];let WD=(()=>{class e{_elementRef=re(In);_platform=re(Hs);_ngZone=re(Ht);_animationMode=re(Ga,{optional:!0});_focusMonitor=re(Lx);_rippleLoader=re(Vle);_isFab=!1;color;get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=t,this._updateRippleDisabled()}_disableRipple=!1;get disabled(){return this._disabled}set disabled(t){this._disabled=t,this._updateRippleDisabled()}_disabled=!1;ariaDisabled;disabledInteractive;constructor(){re(Oc).load(Qv);const t=re(Yle,{optional:!0}),i=this._elementRef.nativeElement,r=i.classList;this.disabledInteractive=t?.disabledInteractive??!1,this.color=t?.color??null,this._rippleLoader?.configureRipple(i,{className:"mat-mdc-button-ripple"});for(const{attribute:a,mdcClasses:h}of Xle)i.hasAttribute(a)&&r.add(...h)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._rippleLoader?.destroyRipple(this._elementRef.nativeElement)}focus(t="program",i){t?this._focusMonitor.focusVia(this._elementRef.nativeElement,t,i):this._elementRef.nativeElement.focus(i)}_getAriaDisabled(){return null!=this.ariaDisabled?this.ariaDisabled:!(!this.disabled||!this.disabledInteractive)||null}_getDisabledAttribute(){return!(this.disabledInteractive||!this.disabled)||null}_updateRippleDisabled(){this._rippleLoader?.setDisabled(this._elementRef.nativeElement,this.disableRipple||this.disabled)}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,inputs:{color:"color",disableRipple:[2,"disableRipple","disableRipple",zn],disabled:[2,"disabled","disabled",zn],ariaDisabled:[2,"aria-disabled","ariaDisabled",zn],disabledInteractive:[2,"disabledInteractive","disabledInteractive",zn]},features:[jr]})}return e})(),ZD=(()=>{class e extends WD{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275cmp=Ln({type:e,selectors:[["button","mat-button",""],["button","mat-raised-button",""],["button","mat-flat-button",""],["button","mat-stroked-button",""]],hostVars:14,hostBindings:function(i,r){2&i&&(ui("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),ka(r.color?"mat-"+r.color:""),Ti("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[Gn],attrs:jle,ngContentSelectors:SO,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(zo(MO),_n(0,"span",0),ai(1),Fe(2,"span",1),ai(3,1),Ue(),ai(4,2),_n(5,"span",2)(6,"span",3)),2&i&&Ti("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mat-mdc-button-base{text-decoration:none}.mdc-button{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;min-width:64px;border:none;outline:none;line-height:inherit;-webkit-appearance:none;overflow:visible;vertical-align:middle;background:rgba(0,0,0,0);padding:0 8px}.mdc-button::-moz-focus-inner{padding:0;border:0}.mdc-button:active{outline:none}.mdc-button:hover{cursor:pointer}.mdc-button:disabled{cursor:default;pointer-events:none}.mdc-button[hidden]{display:none}.mdc-button .mdc-button__label{position:relative}.mat-mdc-button{padding:0 var(--mat-text-button-horizontal-padding, 12px);height:var(--mdc-text-button-container-height, 40px);font-family:var(--mdc-text-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-text-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-text-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-text-button-label-text-transform);font-weight:var(--mdc-text-button-label-text-weight, var(--mat-sys-label-large-weight))}.mat-mdc-button,.mat-mdc-button .mdc-button__ripple{border-radius:var(--mdc-text-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-button:not(:disabled){color:var(--mdc-text-button-label-text-color, var(--mat-sys-primary))}.mat-mdc-button[disabled],.mat-mdc-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-text-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-button:has(.material-icons,mat-icon,[matButtonIcon]){padding:0 var(--mat-text-button-with-icon-horizontal-padding, 16px)}.mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}[dir=rtl] .mat-mdc-button>.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}.mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-offset, -4px);margin-left:var(--mat-text-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-button .mdc-button__label+.mat-icon{margin-right:var(--mat-text-button-icon-spacing, 8px);margin-left:var(--mat-text-button-icon-offset, -4px)}.mat-mdc-button .mat-ripple-element{background-color:var(--mat-text-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-text-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-text-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-text-button-touch-target-display, block)}.mat-mdc-unelevated-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-filled-button-container-height, 40px);font-family:var(--mdc-filled-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-filled-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-filled-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-filled-button-label-text-transform);font-weight:var(--mdc-filled-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-filled-button-horizontal-padding, 24px)}.mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-unelevated-button>.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}.mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-offset, -8px);margin-left:var(--mat-filled-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-unelevated-button .mdc-button__label+.mat-icon{margin-right:var(--mat-filled-button-icon-spacing, 8px);margin-left:var(--mat-filled-button-icon-offset, -8px)}.mat-mdc-unelevated-button .mat-ripple-element{background-color:var(--mat-filled-button-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-state-layer-color, var(--mat-sys-on-primary))}.mat-mdc-unelevated-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-filled-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-unelevated-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-unelevated-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-unelevated-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-filled-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-unelevated-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-filled-button-touch-target-display, block)}.mat-mdc-unelevated-button:not(:disabled){color:var(--mdc-filled-button-label-text-color, var(--mat-sys-on-primary));background-color:var(--mdc-filled-button-container-color, var(--mat-sys-primary))}.mat-mdc-unelevated-button,.mat-mdc-unelevated-button .mdc-button__ripple{border-radius:var(--mdc-filled-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-unelevated-button[disabled],.mat-mdc-unelevated-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-filled-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-filled-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-unelevated-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-raised-button{transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);box-shadow:var(--mdc-protected-button-container-elevation-shadow, var(--mat-sys-level1));height:var(--mdc-protected-button-container-height, 40px);font-family:var(--mdc-protected-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-protected-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-protected-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-protected-button-label-text-transform);font-weight:var(--mdc-protected-button-label-text-weight, var(--mat-sys-label-large-weight));padding:0 var(--mat-protected-button-horizontal-padding, 24px)}.mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-raised-button>.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}.mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-offset, -8px);margin-left:var(--mat-protected-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-raised-button .mdc-button__label+.mat-icon{margin-right:var(--mat-protected-button-icon-spacing, 8px);margin-left:var(--mat-protected-button-icon-offset, -8px)}.mat-mdc-raised-button .mat-ripple-element{background-color:var(--mat-protected-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-raised-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-protected-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-raised-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-raised-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-raised-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-protected-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-raised-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-protected-button-touch-target-display, block)}.mat-mdc-raised-button:not(:disabled){color:var(--mdc-protected-button-label-text-color, var(--mat-sys-primary));background-color:var(--mdc-protected-button-container-color, var(--mat-sys-surface))}.mat-mdc-raised-button,.mat-mdc-raised-button .mdc-button__ripple{border-radius:var(--mdc-protected-button-container-shape, var(--mat-sys-corner-full))}.mat-mdc-raised-button:hover{box-shadow:var(--mdc-protected-button-hover-container-elevation-shadow, var(--mat-sys-level2))}.mat-mdc-raised-button:focus{box-shadow:var(--mdc-protected-button-focus-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button:active,.mat-mdc-raised-button:focus:active{box-shadow:var(--mdc-protected-button-pressed-container-elevation-shadow, var(--mat-sys-level1))}.mat-mdc-raised-button[disabled],.mat-mdc-raised-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-protected-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mdc-protected-button-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-raised-button[disabled].mat-mdc-button-disabled,.mat-mdc-raised-button.mat-mdc-button-disabled.mat-mdc-button-disabled{box-shadow:var(--mdc-protected-button-disabled-container-elevation-shadow, var(--mat-sys-level0))}.mat-mdc-raised-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button{border-style:solid;transition:border 280ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mdc-outlined-button-container-height, 40px);font-family:var(--mdc-outlined-button-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-outlined-button-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mdc-outlined-button-label-text-tracking, var(--mat-sys-label-large-tracking));text-transform:var(--mdc-outlined-button-label-text-transform);font-weight:var(--mdc-outlined-button-label-text-weight, var(--mat-sys-label-large-weight));border-radius:var(--mdc-outlined-button-container-shape, var(--mat-sys-corner-full));border-width:var(--mdc-outlined-button-outline-width, 1px);padding:0 var(--mat-outlined-button-horizontal-padding, 24px)}.mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}[dir=rtl] .mat-mdc-outlined-button>.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}.mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-offset, -8px);margin-left:var(--mat-outlined-button-icon-spacing, 8px)}[dir=rtl] .mat-mdc-outlined-button .mdc-button__label+.mat-icon{margin-right:var(--mat-outlined-button-icon-spacing, 8px);margin-left:var(--mat-outlined-button-icon-offset, -8px)}.mat-mdc-outlined-button .mat-ripple-element{background-color:var(--mat-outlined-button-ripple-color, color-mix(in srgb, var(--mat-sys-primary) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-state-layer-color, var(--mat-sys-primary))}.mat-mdc-outlined-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-outlined-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-outlined-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-outlined-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-outlined-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-outlined-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-outlined-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:0;right:0;transform:translateY(-50%);display:var(--mat-outlined-button-touch-target-display, block)}.mat-mdc-outlined-button:not(:disabled){color:var(--mdc-outlined-button-label-text-color, var(--mat-sys-primary));border-color:var(--mdc-outlined-button-outline-color, var(--mat-sys-outline))}.mat-mdc-outlined-button[disabled],.mat-mdc-outlined-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-outlined-button-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:var(--mdc-outlined-button-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-outlined-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-outlined-button .mdc-button__ripple{border-width:var(--mdc-outlined-button-outline-width, 1px);border-style:solid;border-color:rgba(0,0,0,0)}.mat-mdc-button,.mat-mdc-unelevated-button,.mat-mdc-raised-button,.mat-mdc-outlined-button{-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple,.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-button .mat-mdc-button-ripple,.mat-mdc-unelevated-button .mat-mdc-button-ripple,.mat-mdc-raised-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-unelevated-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-raised-button .mat-mdc-button-persistent-ripple::before,.mat-mdc-outlined-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-button .mdc-button__label,.mat-mdc-button .mat-icon,.mat-mdc-unelevated-button .mdc-button__label,.mat-mdc-unelevated-button .mat-icon,.mat-mdc-raised-button .mdc-button__label,.mat-mdc-raised-button .mat-icon,.mat-mdc-outlined-button .mdc-button__label,.mat-mdc-outlined-button .mat-icon{z-index:1;position:relative}.mat-mdc-button .mat-focus-indicator,.mat-mdc-unelevated-button .mat-focus-indicator,.mat-mdc-raised-button .mat-focus-indicator,.mat-mdc-outlined-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-button:focus .mat-focus-indicator::before,.mat-mdc-unelevated-button:focus .mat-focus-indicator::before,.mat-mdc-raised-button:focus .mat-focus-indicator::before,.mat-mdc-outlined-button:focus .mat-focus-indicator::before{content:""}.mat-mdc-button._mat-animation-noopable,.mat-mdc-unelevated-button._mat-animation-noopable,.mat-mdc-raised-button._mat-animation-noopable,.mat-mdc-outlined-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-button>.mat-icon,.mat-mdc-unelevated-button>.mat-icon,.mat-mdc-raised-button>.mat-icon,.mat-mdc-outlined-button>.mat-icon{display:inline-block;position:relative;vertical-align:top;font-size:1.125rem;height:1.125rem;width:1.125rem}.mat-mdc-outlined-button .mat-mdc-button-ripple,.mat-mdc-outlined-button .mdc-button__ripple{top:-1px;left:-1px;bottom:-1px;right:-1px}.mat-mdc-unelevated-button .mat-focus-indicator::before,.mat-mdc-raised-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-outlined-button .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 3px)*-1)}',"@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-icon-button.mat-mdc-icon-button{outline:solid 1px}}"],encapsulation:2,changeDetection:0})}return e})();const IH=new ct("mat-mdc-fab-default-options",{providedIn:"root",factory:kH});function kH(){return{color:"accent"}}const YD=kH();let Kle=(()=>{class e extends WD{_options=re(IH,{optional:!0});_isFab=!0;extended;constructor(){super(),this._options=this._options||YD,this.color=this._options.color||YD.color}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["button","mat-fab",""]],hostVars:18,hostBindings:function(i,r){2&i&&(ui("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),ka(r.color?"mat-"+r.color:""),Ti("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0)("mdc-fab--extended",r.extended)("mat-mdc-extended-fab",r.extended))},inputs:{extended:[2,"extended","extended",zn]},exportAs:["matButton"],features:[jr,Gn],attrs:$le,ngContentSelectors:SO,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(zo(MO),_n(0,"span",0),ai(1),Fe(2,"span",1),ai(3,1),Ue(),ai(4,2),_n(5,"span",2)(6,"span",3)),2&i&&Ti("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mat-mdc-fab-base{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1);flex-shrink:0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-fab-base .mat-mdc-button-ripple,.mat-mdc-fab-base .mat-mdc-button-persistent-ripple,.mat-mdc-fab-base .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab-base .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab-base .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-fab-base .mdc-button__label,.mat-mdc-fab-base .mat-icon{z-index:1;position:relative}.mat-mdc-fab-base .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab-base:focus .mat-focus-indicator::before{content:""}.mat-mdc-fab-base._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab-base::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-fab-base[hidden]{display:none}.mat-mdc-fab-base::-moz-focus-inner{padding:0;border:0}.mat-mdc-fab-base:active,.mat-mdc-fab-base:focus{outline:none}.mat-mdc-fab-base:hover{cursor:pointer}.mat-mdc-fab-base>svg{width:100%}.mat-mdc-fab-base .mat-icon,.mat-mdc-fab-base .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab-base .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-fab-base[disabled],.mat-mdc-fab-base.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-fab-base[disabled],.mat-mdc-fab-base[disabled]:focus,.mat-mdc-fab-base.mat-mdc-button-disabled,.mat-mdc-fab-base.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-fab-base.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab{background-color:var(--mdc-fab-container-color, var(--mat-sys-primary-container));border-radius:var(--mdc-fab-container-shape, var(--mat-sys-corner-large));color:var(--mat-fab-foreground-color, var(--mat-sys-on-primary-container, inherit));box-shadow:var(--mdc-fab-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-fab:hover{box-shadow:var(--mdc-fab-hover-container-elevation-shadow, var(--mat-sys-level4))}.mat-mdc-fab:focus{box-shadow:var(--mdc-fab-focus-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-fab:active,.mat-mdc-fab:focus:active{box-shadow:var(--mdc-fab-pressed-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-disabled-state-foreground-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-fab-disabled-state-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-touch-target-display, block)}.mat-mdc-fab .mat-ripple-element{background-color:var(--mat-fab-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-state-layer-color, var(--mat-sys-on-primary-container))}.mat-mdc-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-disabled-state-layer-color)}.mat-mdc-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-mini-fab{width:40px;height:40px;background-color:var(--mdc-fab-small-container-color, var(--mat-sys-primary-container));border-radius:var(--mdc-fab-small-container-shape, var(--mat-sys-corner-medium));color:var(--mat-fab-small-foreground-color, var(--mat-sys-on-primary-container, inherit));box-shadow:var(--mdc-fab-small-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-mini-fab:hover{box-shadow:var(--mdc-fab-small-hover-container-elevation-shadow, var(--mat-sys-level4))}.mat-mdc-mini-fab:focus{box-shadow:var(--mdc-fab-small-focus-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:var(--mdc-fab-small-pressed-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-small-disabled-state-foreground-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-fab-small-disabled-state-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-small-touch-target-display)}.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-fab-small-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-state-layer-color, var(--mat-sys-on-primary-container))}.mat-mdc-mini-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-disabled-state-layer-color)}.mat-mdc-mini-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-mini-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-mini-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-extended-fab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;line-height:normal;height:var(--mdc-extended-fab-container-height, 56px);border-radius:var(--mdc-extended-fab-container-shape, var(--mat-sys-corner-large));font-family:var(--mdc-extended-fab-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-extended-fab-label-text-size, var(--mat-sys-label-large-size));font-weight:var(--mdc-extended-fab-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mdc-extended-fab-label-text-tracking, var(--mat-sys-label-large-tracking));box-shadow:var(--mdc-extended-fab-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-extended-fab:hover{box-shadow:var(--mdc-extended-fab-hover-container-elevation-shadow, var(--mat-sys-level4))}.mat-mdc-extended-fab:focus{box-shadow:var(--mdc-extended-fab-focus-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-extended-fab:active,.mat-mdc-extended-fab:focus:active{box-shadow:var(--mdc-extended-fab-pressed-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab[disabled]:focus,.mat-mdc-extended-fab.mat-mdc-button-disabled,.mat-mdc-extended-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-extended-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:-8px;margin-right:12px}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons,[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons{margin-left:12px;margin-right:-8px}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}'],encapsulation:2,changeDetection:0})}return e})(),AH=(()=>{class e extends WD{_options=re(IH,{optional:!0});_isFab=!0;constructor(){super(),this._options=this._options||YD,this.color=this._options.color||YD.color}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["button","mat-mini-fab",""]],hostVars:14,hostBindings:function(i,r){2&i&&(ui("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),ka(r.color?"mat-"+r.color:""),Ti("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[Gn],attrs:Gle,ngContentSelectors:SO,decls:7,vars:4,consts:[[1,"mat-mdc-button-persistent-ripple"],[1,"mdc-button__label"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(zo(MO),_n(0,"span",0),ai(1),Fe(2,"span",1),ai(3,1),Ue(),ai(4,2),_n(5,"span",2)(6,"span",3)),2&i&&Ti("mdc-button__ripple",!r._isFab)("mdc-fab__ripple",r._isFab)},styles:['.mat-mdc-fab-base{-webkit-user-select:none;user-select:none;position:relative;display:inline-flex;align-items:center;justify-content:center;box-sizing:border-box;width:56px;height:56px;padding:0;border:none;fill:currentColor;text-decoration:none;cursor:pointer;-moz-appearance:none;-webkit-appearance:none;overflow:visible;transition:box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1),opacity 15ms linear 30ms,transform 270ms 0ms cubic-bezier(0, 0, 0.2, 1);flex-shrink:0;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-fab-base .mat-mdc-button-ripple,.mat-mdc-fab-base .mat-mdc-button-persistent-ripple,.mat-mdc-fab-base .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-fab-base .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-fab-base .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-fab-base .mdc-button__label,.mat-mdc-fab-base .mat-icon{z-index:1;position:relative}.mat-mdc-fab-base .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-fab-base:focus .mat-focus-indicator::before{content:""}.mat-mdc-fab-base._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-fab-base::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mat-mdc-fab-base[hidden]{display:none}.mat-mdc-fab-base::-moz-focus-inner{padding:0;border:0}.mat-mdc-fab-base:active,.mat-mdc-fab-base:focus{outline:none}.mat-mdc-fab-base:hover{cursor:pointer}.mat-mdc-fab-base>svg{width:100%}.mat-mdc-fab-base .mat-icon,.mat-mdc-fab-base .material-icons{transition:transform 180ms 90ms cubic-bezier(0, 0, 0.2, 1);fill:currentColor;will-change:transform}.mat-mdc-fab-base .mat-focus-indicator::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-mdc-fab-base[disabled],.mat-mdc-fab-base.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-fab-base[disabled],.mat-mdc-fab-base[disabled]:focus,.mat-mdc-fab-base.mat-mdc-button-disabled,.mat-mdc-fab-base.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-fab-base.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab{background-color:var(--mdc-fab-container-color, var(--mat-sys-primary-container));border-radius:var(--mdc-fab-container-shape, var(--mat-sys-corner-large));color:var(--mat-fab-foreground-color, var(--mat-sys-on-primary-container, inherit));box-shadow:var(--mdc-fab-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-fab:hover{box-shadow:var(--mdc-fab-hover-container-elevation-shadow, var(--mat-sys-level4))}.mat-mdc-fab:focus{box-shadow:var(--mdc-fab-focus-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-fab:active,.mat-mdc-fab:focus:active{box-shadow:var(--mdc-fab-pressed-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-fab[disabled],.mat-mdc-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-disabled-state-foreground-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-fab-disabled-state-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-touch-target-display, block)}.mat-mdc-fab .mat-ripple-element{background-color:var(--mat-fab-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-state-layer-color, var(--mat-sys-on-primary-container))}.mat-mdc-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-disabled-state-layer-color)}.mat-mdc-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-mini-fab{width:40px;height:40px;background-color:var(--mdc-fab-small-container-color, var(--mat-sys-primary-container));border-radius:var(--mdc-fab-small-container-shape, var(--mat-sys-corner-medium));color:var(--mat-fab-small-foreground-color, var(--mat-sys-on-primary-container, inherit));box-shadow:var(--mdc-fab-small-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-mini-fab:hover{box-shadow:var(--mdc-fab-small-hover-container-elevation-shadow, var(--mat-sys-level4))}.mat-mdc-mini-fab:focus{box-shadow:var(--mdc-fab-small-focus-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-mini-fab:active,.mat-mdc-mini-fab:focus:active{box-shadow:var(--mdc-fab-small-pressed-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-mini-fab[disabled],.mat-mdc-mini-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mat-fab-small-disabled-state-foreground-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));background-color:var(--mat-fab-small-disabled-state-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-mini-fab .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-fab-small-touch-target-display)}.mat-mdc-mini-fab .mat-ripple-element{background-color:var(--mat-fab-small-ripple-color, color-mix(in srgb, var(--mat-sys-on-primary-container) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-mini-fab .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-state-layer-color, var(--mat-sys-on-primary-container))}.mat-mdc-mini-fab.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-fab-small-disabled-state-layer-color)}.mat-mdc-mini-fab:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-mini-fab.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-mini-fab.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-mini-fab:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-fab-small-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-extended-fab{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;border-radius:24px;padding-left:20px;padding-right:20px;width:auto;max-width:100%;line-height:normal;height:var(--mdc-extended-fab-container-height, 56px);border-radius:var(--mdc-extended-fab-container-shape, var(--mat-sys-corner-large));font-family:var(--mdc-extended-fab-label-text-font, var(--mat-sys-label-large-font));font-size:var(--mdc-extended-fab-label-text-size, var(--mat-sys-label-large-size));font-weight:var(--mdc-extended-fab-label-text-weight, var(--mat-sys-label-large-weight));letter-spacing:var(--mdc-extended-fab-label-text-tracking, var(--mat-sys-label-large-tracking));box-shadow:var(--mdc-extended-fab-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-extended-fab:hover{box-shadow:var(--mdc-extended-fab-hover-container-elevation-shadow, var(--mat-sys-level4))}.mat-mdc-extended-fab:focus{box-shadow:var(--mdc-extended-fab-focus-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-extended-fab:active,.mat-mdc-extended-fab:focus:active{box-shadow:var(--mdc-extended-fab-pressed-container-elevation-shadow, var(--mat-sys-level3))}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab.mat-mdc-button-disabled{cursor:default;pointer-events:none}.mat-mdc-extended-fab[disabled],.mat-mdc-extended-fab[disabled]:focus,.mat-mdc-extended-fab.mat-mdc-button-disabled,.mat-mdc-extended-fab.mat-mdc-button-disabled:focus{box-shadow:none}.mat-mdc-extended-fab.mat-mdc-button-disabled-interactive{pointer-events:auto}[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.mat-icon,[dir=rtl] .mat-mdc-extended-fab .mdc-button__label+.material-icons,.mat-mdc-extended-fab>.mat-icon,.mat-mdc-extended-fab>.material-icons{margin-left:-8px;margin-right:12px}.mat-mdc-extended-fab .mdc-button__label+.mat-icon,.mat-mdc-extended-fab .mdc-button__label+.material-icons,[dir=rtl] .mat-mdc-extended-fab>.mat-icon,[dir=rtl] .mat-mdc-extended-fab>.material-icons{margin-left:12px;margin-right:-8px}.mat-mdc-extended-fab .mat-mdc-button-touch-target{width:100%}'],encapsulation:2,changeDetection:0})}return e})(),qC=(()=>{class e extends WD{constructor(){super(),this._rippleLoader.configureRipple(this._elementRef.nativeElement,{centered:!0})}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["button","mat-icon-button",""]],hostVars:14,hostBindings:function(i,r){2&i&&(ui("disabled",r._getDisabledAttribute())("aria-disabled",r._getAriaDisabled()),ka(r.color?"mat-"+r.color:""),Ti("mat-mdc-button-disabled",r.disabled)("mat-mdc-button-disabled-interactive",r.disabledInteractive)("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mat-unthemed",!r.color)("mat-mdc-button-base",!0))},exportAs:["matButton"],features:[Gn],attrs:Wle,ngContentSelectors:Zle,decls:4,vars:0,consts:[[1,"mat-mdc-button-persistent-ripple","mdc-icon-button__ripple"],[1,"mat-focus-indicator"],[1,"mat-mdc-button-touch-target"]],template:function(i,r){1&i&&(zo(),_n(0,"span",0),ai(1),_n(2,"span",1)(3,"span",2))},styles:['.mat-mdc-icon-button{-webkit-user-select:none;user-select:none;display:inline-block;position:relative;box-sizing:border-box;border:none;outline:none;background-color:rgba(0,0,0,0);fill:currentColor;color:inherit;text-decoration:none;cursor:pointer;z-index:0;overflow:visible;border-radius:50%;flex-shrink:0;text-align:center;width:var(--mdc-icon-button-state-layer-size, 40px);height:var(--mdc-icon-button-state-layer-size, 40px);padding:calc(calc(var(--mdc-icon-button-state-layer-size, 40px) - var(--mdc-icon-button-icon-size, 24px)) / 2);font-size:var(--mdc-icon-button-icon-size, 24px);color:var(--mdc-icon-button-icon-color, var(--mat-sys-on-surface-variant));-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-icon-button .mat-mdc-button-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple,.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none;border-radius:inherit}.mat-mdc-icon-button .mat-mdc-button-ripple{overflow:hidden}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{content:"";opacity:0}.mat-mdc-icon-button .mdc-button__label,.mat-mdc-icon-button .mat-icon{z-index:1;position:relative}.mat-mdc-icon-button .mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute}.mat-mdc-icon-button:focus .mat-focus-indicator::before{content:""}.mat-mdc-icon-button .mat-ripple-element{background-color:var(--mat-icon-button-ripple-color, color-mix(in srgb, var(--mat-sys-on-surface-variant) calc(var(--mat-sys-pressed-state-layer-opacity) * 100%), transparent))}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button.mat-mdc-button-disabled .mat-mdc-button-persistent-ripple::before{background-color:var(--mat-icon-button-disabled-state-layer-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button:hover .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-icon-button.cdk-program-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.cdk-keyboard-focused .mat-mdc-button-persistent-ripple::before,.mat-mdc-icon-button.mat-mdc-button-disabled-interactive:focus .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mat-mdc-icon-button:active .mat-mdc-button-persistent-ripple::before{opacity:var(--mat-icon-button-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity))}.mat-mdc-icon-button .mat-mdc-button-touch-target{position:absolute;top:50%;height:48px;left:50%;width:48px;transform:translate(-50%, -50%);display:var(--mat-icon-button-touch-target-display, block)}.mat-mdc-icon-button._mat-animation-noopable{transition:none !important;animation:none !important}.mat-mdc-icon-button[disabled],.mat-mdc-icon-button.mat-mdc-button-disabled{cursor:default;pointer-events:none;color:var(--mdc-icon-button-disabled-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-icon-button.mat-mdc-button-disabled-interactive{pointer-events:auto}.mat-mdc-icon-button img,.mat-mdc-icon-button svg{width:var(--mdc-icon-button-icon-size, 24px);height:var(--mdc-icon-button-icon-size, 24px);vertical-align:baseline}.mat-mdc-icon-button .mat-mdc-button-persistent-ripple{border-radius:50%}.mat-mdc-icon-button[hidden]{display:none}.mat-mdc-icon-button.mat-unthemed:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-primary:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-accent:not(.mdc-ripple-upgraded):focus::before,.mat-mdc-icon-button.mat-warn:not(.mdc-ripple-upgraded):focus::before{background:rgba(0,0,0,0);opacity:1}',"@media(forced-colors: active){.mat-mdc-button:not(.mdc-button--outlined),.mat-mdc-unelevated-button:not(.mdc-button--outlined),.mat-mdc-raised-button:not(.mdc-button--outlined),.mat-mdc-outlined-button:not(.mdc-button--outlined),.mat-mdc-icon-button.mat-mdc-icon-button{outline:solid 1px}}"],encapsulation:2,changeDetection:0})}return e})(),EO=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,GC,or]})}return e})();const Qle=["*"],Jle=[[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],[["","mat-card-image",""],["","matCardImage",""],["","mat-card-sm-image",""],["","matCardImageSmall",""],["","mat-card-md-image",""],["","matCardImageMedium",""],["","mat-card-lg-image",""],["","matCardImageLarge",""],["","mat-card-xl-image",""],["","matCardImageXLarge",""]],"*"],ece=["mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","[mat-card-image], [matCardImage],\n                    [mat-card-sm-image], [matCardImageSmall],\n                    [mat-card-md-image], [matCardImageMedium],\n                    [mat-card-lg-image], [matCardImageLarge],\n                    [mat-card-xl-image], [matCardImageXLarge]","*"],tce=[[["","mat-card-avatar",""],["","matCardAvatar",""]],[["mat-card-title"],["mat-card-subtitle"],["","mat-card-title",""],["","mat-card-subtitle",""],["","matCardTitle",""],["","matCardSubtitle",""]],"*"],nce=["[mat-card-avatar], [matCardAvatar]","mat-card-title, mat-card-subtitle,\n      [mat-card-title], [mat-card-subtitle],\n      [matCardTitle], [matCardSubtitle]","*"],ice=new ct("MAT_CARD_CONFIG");let hu=(()=>{class e{appearance;constructor(){const t=re(ice,{optional:!0});this.appearance=t?.appearance||"raised"}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-card"]],hostAttrs:[1,"mat-mdc-card","mdc-card"],hostVars:4,hostBindings:function(i,r){2&i&&Ti("mat-mdc-card-outlined","outlined"===r.appearance)("mdc-card--outlined","outlined"===r.appearance)},inputs:{appearance:"appearance"},exportAs:["matCard"],ngContentSelectors:Qle,decls:1,vars:0,template:function(i,r){1&i&&(zo(),ai(0))},styles:['.mat-mdc-card{display:flex;flex-direction:column;box-sizing:border-box;position:relative;border-style:solid;border-width:0;background-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-color:var(--mdc-elevated-card-container-color, var(--mat-sys-surface-container-low));border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium));box-shadow:var(--mdc-elevated-card-container-elevation, var(--mat-sys-level1))}.mat-mdc-card::after{position:absolute;top:0;left:0;width:100%;height:100%;border:solid 1px rgba(0,0,0,0);content:"";display:block;pointer-events:none;box-sizing:border-box;border-radius:var(--mdc-elevated-card-container-shape, var(--mat-sys-corner-medium))}.mat-mdc-card-outlined{background-color:var(--mdc-outlined-card-container-color, var(--mat-sys-surface));border-radius:var(--mdc-outlined-card-container-shape, var(--mat-sys-corner-medium));border-width:var(--mdc-outlined-card-outline-width, 1px);border-color:var(--mdc-outlined-card-outline-color, var(--mat-sys-outline-variant));box-shadow:var(--mdc-outlined-card-container-elevation, var(--mat-sys-level0))}.mat-mdc-card-outlined::after{border:none}.mdc-card__media{position:relative;box-sizing:border-box;background-repeat:no-repeat;background-position:center;background-size:cover}.mdc-card__media::before{display:block;content:""}.mdc-card__media:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.mdc-card__media:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.mat-mdc-card-actions{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;min-height:52px;padding:8px}.mat-mdc-card-title{font-family:var(--mat-card-title-text-font, var(--mat-sys-title-large-font));line-height:var(--mat-card-title-text-line-height, var(--mat-sys-title-large-line-height));font-size:var(--mat-card-title-text-size, var(--mat-sys-title-large-size));letter-spacing:var(--mat-card-title-text-tracking, var(--mat-sys-title-large-tracking));font-weight:var(--mat-card-title-text-weight, var(--mat-sys-title-large-weight))}.mat-mdc-card-subtitle{color:var(--mat-card-subtitle-text-color, var(--mat-sys-on-surface));font-family:var(--mat-card-subtitle-text-font, var(--mat-sys-title-medium-font));line-height:var(--mat-card-subtitle-text-line-height, var(--mat-sys-title-medium-line-height));font-size:var(--mat-card-subtitle-text-size, var(--mat-sys-title-medium-size));letter-spacing:var(--mat-card-subtitle-text-tracking, var(--mat-sys-title-medium-tracking));font-weight:var(--mat-card-subtitle-text-weight, var(--mat-sys-title-medium-weight))}.mat-mdc-card-title,.mat-mdc-card-subtitle{display:block;margin:0}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle{padding:16px 16px 0}.mat-mdc-card-header{display:flex;padding:16px 16px 0}.mat-mdc-card-content{display:block;padding:0 16px}.mat-mdc-card-content:first-child{padding-top:16px}.mat-mdc-card-content:last-child{padding-bottom:16px}.mat-mdc-card-title-group{display:flex;justify-content:space-between;width:100%}.mat-mdc-card-avatar{height:40px;width:40px;border-radius:50%;flex-shrink:0;margin-bottom:16px;object-fit:cover}.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-avatar~.mat-mdc-card-header-text .mat-mdc-card-title{line-height:normal}.mat-mdc-card-sm-image{width:80px;height:80px}.mat-mdc-card-md-image{width:112px;height:112px}.mat-mdc-card-lg-image{width:152px;height:152px}.mat-mdc-card-xl-image{width:240px;height:240px}.mat-mdc-card-subtitle~.mat-mdc-card-title,.mat-mdc-card-title~.mat-mdc-card-subtitle,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-title,.mat-mdc-card-header .mat-mdc-card-header-text .mat-mdc-card-subtitle,.mat-mdc-card-title-group .mat-mdc-card-title,.mat-mdc-card-title-group .mat-mdc-card-subtitle{padding-top:0}.mat-mdc-card-content>:last-child:not(.mat-mdc-card-footer){margin-bottom:0}.mat-mdc-card-actions-align-end{justify-content:flex-end}'],encapsulation:2,changeDetection:0})}return e})(),Bx=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["mat-card-title"],["","mat-card-title",""],["","matCardTitle",""]],hostAttrs:[1,"mat-mdc-card-title"]})}return e})(),RH=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-card-title-group"]],hostAttrs:[1,"mat-mdc-card-title-group"],ngContentSelectors:ece,decls:4,vars:0,template:function(i,r){1&i&&(zo(Jle),Fe(0,"div"),ai(1),Ue(),ai(2,1),ai(3,2))},encapsulation:2,changeDetection:0})}return e})(),R_=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["mat-card-content"]],hostAttrs:[1,"mat-mdc-card-content"]})}return e})(),WC=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-card-header"]],hostAttrs:[1,"mat-mdc-card-header"],ngContentSelectors:nce,decls:4,vars:0,consts:[[1,"mat-mdc-card-header-text"]],template:function(i,r){1&i&&(zo(tce),ai(0),Fe(1,"div",0),ai(2,1),Ue(),ai(3,2))},encapsulation:2,changeDetection:0})}return e})(),PH=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,or]})}return e})();const sce=["input"],ace=["label"],lce=["*"],cce=new ct("mat-checkbox-default-options",{providedIn:"root",factory:OH});function OH(){return{color:"accent",clickAction:"check-indeterminate",disabledInteractive:!1}}var wl=function(e){return e[e.Init=0]="Init",e[e.Checked=1]="Checked",e[e.Unchecked=2]="Unchecked",e[e.Indeterminate=3]="Indeterminate",e}(wl||{});const dce={provide:Rc,useExisting:zi(()=>LH),multi:!0};class uce{source;checked}const FH=OH();let LH=(()=>{class e{_elementRef=re(In);_changeDetectorRef=re(Bo);_ngZone=re(Ht);_animationMode=re(Ga,{optional:!0});_options=re(cce,{optional:!0});focus(){this._inputElement.nativeElement.focus()}_createChangeEvent(t){const i=new uce;return i.source=this,i.checked=t,i}_getAnimationTargetElement(){return this._inputElement?.nativeElement}_animationClasses={uncheckedToChecked:"mdc-checkbox--anim-unchecked-checked",uncheckedToIndeterminate:"mdc-checkbox--anim-unchecked-indeterminate",checkedToUnchecked:"mdc-checkbox--anim-checked-unchecked",checkedToIndeterminate:"mdc-checkbox--anim-checked-indeterminate",indeterminateToChecked:"mdc-checkbox--anim-indeterminate-checked",indeterminateToUnchecked:"mdc-checkbox--anim-indeterminate-unchecked"};ariaLabel="";ariaLabelledby=null;ariaDescribedby;ariaExpanded;ariaControls;ariaOwns;_uniqueId;id;get inputId(){return`${this.id||this._uniqueId}-input`}required;labelPosition="after";name=null;change=new Dt;indeterminateChange=new Dt;value;disableRipple;_inputElement;_labelElement;tabIndex;color;disabledInteractive;_onTouched=()=>{};_currentAnimationClass="";_currentCheckState=wl.Init;_controlValueAccessorChangeFn=()=>{};_validatorChangeFn=()=>{};constructor(){re(Oc).load(Qv);const t=re(new pt("tabindex"),{optional:!0});this._options=this._options||FH,this.color=this._options.color||FH.color,this.tabIndex=null==t?0:parseInt(t)||0,this.id=this._uniqueId=re(du).getId("mat-mdc-checkbox-"),this.disabledInteractive=this._options?.disabledInteractive??!1}ngOnChanges(t){t.required&&this._validatorChangeFn()}ngAfterViewInit(){this._syncIndeterminate(this._indeterminate)}get checked(){return this._checked}set checked(t){t!=this.checked&&(this._checked=t,this._changeDetectorRef.markForCheck())}_checked=!1;get disabled(){return this._disabled}set disabled(t){t!==this.disabled&&(this._disabled=t,this._changeDetectorRef.markForCheck())}_disabled=!1;get indeterminate(){return this._indeterminate}set indeterminate(t){const i=t!=this._indeterminate;this._indeterminate=t,i&&(this._transitionCheckState(this._indeterminate?wl.Indeterminate:this.checked?wl.Checked:wl.Unchecked),this.indeterminateChange.emit(this._indeterminate)),this._syncIndeterminate(this._indeterminate)}_indeterminate=!1;_isRippleDisabled(){return this.disableRipple||this.disabled}_onLabelTextChange(){this._changeDetectorRef.detectChanges()}writeValue(t){this.checked=!!t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t}validate(t){return this.required&&!0!==t.value?{required:!0}:null}registerOnValidatorChange(t){this._validatorChangeFn=t}_transitionCheckState(t){let i=this._currentCheckState,r=this._getAnimationTargetElement();if(i!==t&&r&&(this._currentAnimationClass&&r.classList.remove(this._currentAnimationClass),this._currentAnimationClass=this._getAnimationClassForCheckStateTransition(i,t),this._currentCheckState=t,this._currentAnimationClass.length>0)){r.classList.add(this._currentAnimationClass);const a=this._currentAnimationClass;this._ngZone.runOutsideAngular(()=>{setTimeout(()=>{r.classList.remove(a)},1e3)})}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.checked),this.change.emit(this._createChangeEvent(this.checked)),this._inputElement&&(this._inputElement.nativeElement.checked=this.checked)}toggle(){this.checked=!this.checked,this._controlValueAccessorChangeFn(this.checked)}_handleInputClick(){const t=this._options?.clickAction;this.disabled||"noop"===t?(this.disabled&&this.disabledInteractive||!this.disabled&&"noop"===t)&&(this._inputElement.nativeElement.checked=this.checked,this._inputElement.nativeElement.indeterminate=this.indeterminate):(this.indeterminate&&"check"!==t&&Promise.resolve().then(()=>{this._indeterminate=!1,this.indeterminateChange.emit(this._indeterminate)}),this._checked=!this._checked,this._transitionCheckState(this._checked?wl.Checked:wl.Unchecked),this._emitChangeEvent())}_onInteractionEvent(t){t.stopPropagation()}_onBlur(){Promise.resolve().then(()=>{this._onTouched(),this._changeDetectorRef.markForCheck()})}_getAnimationClassForCheckStateTransition(t,i){if("NoopAnimations"===this._animationMode)return"";switch(t){case wl.Init:if(i===wl.Checked)return this._animationClasses.uncheckedToChecked;if(i==wl.Indeterminate)return this._checked?this._animationClasses.checkedToIndeterminate:this._animationClasses.uncheckedToIndeterminate;break;case wl.Unchecked:return i===wl.Checked?this._animationClasses.uncheckedToChecked:this._animationClasses.uncheckedToIndeterminate;case wl.Checked:return i===wl.Unchecked?this._animationClasses.checkedToUnchecked:this._animationClasses.checkedToIndeterminate;case wl.Indeterminate:return i===wl.Checked?this._animationClasses.indeterminateToChecked:this._animationClasses.indeterminateToUnchecked}return""}_syncIndeterminate(t){const i=this._inputElement;i&&(i.nativeElement.indeterminate=t)}_onInputClick(){this._handleInputClick()}_onTouchTargetClick(){this._handleInputClick(),this.disabled||this._inputElement.nativeElement.focus()}_preventBubblingFromLabel(t){t.target&&this._labelElement.nativeElement.contains(t.target)&&t.stopPropagation()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-checkbox"]],viewQuery:function(i,r){if(1&i&&(zr(sce,5),zr(ace,5)),2&i){let a;ri(a=oi())&&(r._inputElement=a.first),ri(a=oi())&&(r._labelElement=a.first)}},hostAttrs:[1,"mat-mdc-checkbox"],hostVars:16,hostBindings:function(i,r){2&i&&(ax("id",r.id),ui("tabindex",null)("aria-label",null)("aria-labelledby",null),ka(r.color?"mat-"+r.color:"mat-accent"),Ti("_mat-animation-noopable","NoopAnimations"===r._animationMode)("mdc-checkbox--disabled",r.disabled)("mat-mdc-checkbox-disabled",r.disabled)("mat-mdc-checkbox-checked",r.checked)("mat-mdc-checkbox-disabled-interactive",r.disabledInteractive))},inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],ariaExpanded:[2,"aria-expanded","ariaExpanded",zn],ariaControls:[0,"aria-controls","ariaControls"],ariaOwns:[0,"aria-owns","ariaOwns"],id:"id",required:[2,"required","required",zn],labelPosition:"labelPosition",name:"name",value:"value",disableRipple:[2,"disableRipple","disableRipple",zn],tabIndex:[2,"tabIndex","tabIndex",t=>null==t?void 0:Ya(t)],color:"color",disabledInteractive:[2,"disabledInteractive","disabledInteractive",zn],checked:[2,"checked","checked",zn],disabled:[2,"disabled","disabled",zn],indeterminate:[2,"indeterminate","indeterminate",zn]},outputs:{change:"change",indeterminateChange:"indeterminateChange"},exportAs:["matCheckbox"],features:[Jn([dce,{provide:Ra,useExisting:e,multi:!0}]),jr,sr],ngContentSelectors:lce,decls:15,vars:23,consts:[["checkbox",""],["input",""],["label",""],["mat-internal-form-field","",3,"click","labelPosition"],[1,"mdc-checkbox"],[1,"mat-mdc-checkbox-touch-target",3,"click"],["type","checkbox",1,"mdc-checkbox__native-control",3,"blur","click","change","checked","indeterminate","disabled","id","required","tabIndex"],[1,"mdc-checkbox__ripple"],[1,"mdc-checkbox__background"],["focusable","false","viewBox","0 0 24 24","aria-hidden","true",1,"mdc-checkbox__checkmark"],["fill","none","d","M1.73,12.91 8.1,19.28 22.79,4.59",1,"mdc-checkbox__checkmark-path"],[1,"mdc-checkbox__mixedmark"],["mat-ripple","",1,"mat-mdc-checkbox-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled","matRippleCentered"],[1,"mdc-label",3,"for"]],template:function(i,r){if(1&i){const a=Is();zo(),Fe(0,"div",3),Nn("click",function(v){return Di(a),Ii(r._preventBubblingFromLabel(v))}),Fe(1,"div",4,0)(3,"div",5),Nn("click",function(){return Di(a),Ii(r._onTouchTargetClick())}),Ue(),Fe(4,"input",6,1),Nn("blur",function(){return Di(a),Ii(r._onBlur())})("click",function(){return Di(a),Ii(r._onInputClick())})("change",function(v){return Di(a),Ii(r._onInteractionEvent(v))}),Ue(),_n(6,"div",7),Fe(7,"div",8),Ma(),Fe(8,"svg",9),_n(9,"path",10),Ue(),Xu(),_n(10,"div",11),Ue(),_n(11,"div",12),Ue(),Fe(12,"label",13,2),ai(14),Ue()()}if(2&i){const a=Za(2);At("labelPosition",r.labelPosition),Ze(4),Ti("mdc-checkbox--selected",r.checked),At("checked",r.checked)("indeterminate",r.indeterminate)("disabled",r.disabled&&!r.disabledInteractive)("id",r.inputId)("required",r.required)("tabIndex",r.disabled&&!r.disabledInteractive?-1:r.tabIndex),ui("aria-label",r.ariaLabel||null)("aria-labelledby",r.ariaLabelledby)("aria-describedby",r.ariaDescribedby)("aria-checked",r.indeterminate?"mixed":null)("aria-controls",r.ariaControls)("aria-disabled",!(!r.disabled||!r.disabledInteractive)||null)("aria-expanded",r.ariaExpanded)("aria-owns",r.ariaOwns)("name",r.name)("value",r.value),Ze(7),At("matRippleTrigger",a)("matRippleDisabled",r.disableRipple||r.disabled)("matRippleCentered",!0),Ze(),At("for",r.inputId)}},dependencies:[xO,Ule],styles:['.mdc-checkbox{display:inline-block;position:relative;flex:0 0 18px;box-sizing:content-box;width:18px;height:18px;line-height:0;white-space:nowrap;cursor:pointer;vertical-align:bottom;padding:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);margin:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox:hover .mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-sys-on-surface))}.mdc-checkbox:hover .mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-sys-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-sys-on-surface))}.mdc-checkbox .mdc-checkbox__native-control:focus~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-focus-state-layer-color, var(--mat-sys-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-unselected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-sys-primary))}.mdc-checkbox:active .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-unselected-pressed-state-layer-color, var(--mat-sys-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity));background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-sys-primary))}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-hover-state-layer-color, var(--mat-sys-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity));background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-sys-primary))}.mdc-checkbox .mdc-checkbox__native-control:focus:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-focus-state-layer-color, var(--mat-sys-primary))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mdc-checkbox__ripple{opacity:var(--mdc-checkbox-selected-pressed-state-layer-opacity, var(--mat-sys-pressed-state-layer-opacity));background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-sys-on-surface))}.mdc-checkbox:active .mdc-checkbox__native-control:checked~.mat-mdc-checkbox-ripple .mat-ripple-element{background-color:var(--mdc-checkbox-selected-pressed-state-layer-color, var(--mat-sys-on-surface))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mat-mdc-checkbox-ripple .mat-ripple-element,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control~.mdc-checkbox__ripple{background-color:var(--mdc-checkbox-unselected-hover-state-layer-color, var(--mat-sys-on-surface))}.mdc-checkbox .mdc-checkbox__native-control{position:absolute;margin:0;padding:0;opacity:0;cursor:inherit;width:var(--mdc-checkbox-state-layer-size, 40px);height:var(--mdc-checkbox-state-layer-size, 40px);top:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);right:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - var(--mdc-checkbox-state-layer-size, 40px))/2)}.mdc-checkbox--disabled{cursor:default;pointer-events:none}@media(forced-colors: active){.mdc-checkbox--disabled{opacity:.5}}.mdc-checkbox__background{display:inline-flex;position:absolute;align-items:center;justify-content:center;box-sizing:border-box;width:18px;height:18px;border:2px solid currentColor;border-radius:2px;background-color:rgba(0,0,0,0);pointer-events:none;will-change:background-color,border-color;transition:background-color 90ms cubic-bezier(0.4, 0, 0.6, 1),border-color 90ms cubic-bezier(0.4, 0, 0.6, 1);-webkit-print-color-adjust:exact;color-adjust:exact;border-color:var(--mdc-checkbox-unselected-icon-color, var(--mat-sys-on-surface-variant));top:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2);left:calc((var(--mdc-checkbox-state-layer-size, 40px) - 18px)/2)}.mdc-checkbox__native-control:enabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:enabled:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-icon-color, var(--mat-sys-primary));background-color:var(--mdc-checkbox-selected-icon-color, var(--mat-sys-primary))}.mdc-checkbox--disabled .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-checkbox__native-control:disabled:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:disabled:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:not(:checked)~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-hover-icon-color, var(--mat-sys-on-surface));background-color:rgba(0,0,0,0)}.mdc-checkbox:hover .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox:hover .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-sys-primary));background-color:var(--mdc-checkbox-selected-hover-icon-color, var(--mat-sys-primary))}.mdc-checkbox__native-control:focus:focus:not(:checked)~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:not(:indeterminate)~.mdc-checkbox__background{border-color:var(--mdc-checkbox-unselected-focus-icon-color, var(--mat-sys-on-surface))}.mdc-checkbox__native-control:focus:focus:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:focus:focus:indeterminate~.mdc-checkbox__background{border-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-sys-primary));background-color:var(--mdc-checkbox-selected-focus-icon-color, var(--mat-sys-primary))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox:hover .mdc-checkbox__native-control~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox .mdc-checkbox__native-control:focus~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__background{border-color:var(--mdc-checkbox-disabled-unselected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{background-color:var(--mdc-checkbox-disabled-selected-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent));border-color:rgba(0,0,0,0)}.mdc-checkbox__checkmark{position:absolute;top:0;right:0;bottom:0;left:0;width:100%;opacity:0;transition:opacity 180ms cubic-bezier(0.4, 0, 0.6, 1);color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-sys-on-primary))}@media(forced-colors: active){.mdc-checkbox__checkmark{color:CanvasText}}.mdc-checkbox--disabled .mdc-checkbox__checkmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-sys-surface))}@media(forced-colors: active){.mdc-checkbox--disabled .mdc-checkbox__checkmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__checkmark{color:CanvasText}}.mdc-checkbox__checkmark-path{transition:stroke-dashoffset 180ms cubic-bezier(0.4, 0, 0.6, 1);stroke:currentColor;stroke-width:3.12px;stroke-dashoffset:29.7833385;stroke-dasharray:29.7833385}.mdc-checkbox__mixedmark{width:100%;height:0;transform:scaleX(0) rotate(0deg);border-width:1px;border-style:solid;opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1);border-color:var(--mdc-checkbox-selected-checkmark-color, var(--mat-sys-on-primary))}@media(forced-colors: active){.mdc-checkbox__mixedmark{margin:0 1px}}.mdc-checkbox--disabled .mdc-checkbox__mixedmark,.mdc-checkbox--disabled.mat-mdc-checkbox-disabled-interactive .mdc-checkbox__mixedmark{border-color:var(--mdc-checkbox-disabled-selected-checkmark-color, var(--mat-sys-surface))}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__background,.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__background,.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__background,.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__background{animation-duration:180ms;animation-timing-function:linear}.mdc-checkbox--anim-unchecked-checked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-unchecked-checked-checkmark-path 180ms linear;transition:none}.mdc-checkbox--anim-unchecked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-unchecked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-unchecked .mdc-checkbox__checkmark-path{animation:mdc-checkbox-checked-unchecked-checkmark-path 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__checkmark{animation:mdc-checkbox-checked-indeterminate-checkmark 90ms linear;transition:none}.mdc-checkbox--anim-checked-indeterminate .mdc-checkbox__mixedmark{animation:mdc-checkbox-checked-indeterminate-mixedmark 90ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__checkmark{animation:mdc-checkbox-indeterminate-checked-checkmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-checked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-checked-mixedmark 500ms linear;transition:none}.mdc-checkbox--anim-indeterminate-unchecked .mdc-checkbox__mixedmark{animation:mdc-checkbox-indeterminate-unchecked-mixedmark 300ms linear;transition:none}.mdc-checkbox__native-control:checked~.mdc-checkbox__background,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background{transition:border-color 90ms cubic-bezier(0, 0, 0.2, 1),background-color 90ms cubic-bezier(0, 0, 0.2, 1)}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark-path,.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark-path{stroke-dashoffset:0}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__checkmark{transition:opacity 180ms cubic-bezier(0, 0, 0.2, 1),transform 180ms cubic-bezier(0, 0, 0.2, 1);opacity:1}.mdc-checkbox__native-control:checked~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(-45deg)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__checkmark{transform:rotate(45deg);opacity:0;transition:opacity 90ms cubic-bezier(0.4, 0, 0.6, 1),transform 90ms cubic-bezier(0.4, 0, 0.6, 1)}.mdc-checkbox__native-control:indeterminate~.mdc-checkbox__background .mdc-checkbox__mixedmark{transform:scaleX(1) rotate(0deg);opacity:1}@keyframes mdc-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:29.7833385}50%{animation-timing-function:cubic-bezier(0, 0, 0.2, 1)}100%{stroke-dashoffset:0}}@keyframes mdc-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0, 0, 0, 1)}100%{transform:scaleX(1)}}@keyframes mdc-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(0.4, 0, 1, 1);opacity:1;stroke-dashoffset:0}to{opacity:0;stroke-dashoffset:-29.7833385}}@keyframes mdc-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(45deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(45deg);opacity:0}to{transform:rotate(360deg);opacity:1}}@keyframes mdc-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0, 0, 0.2, 1);transform:rotate(-45deg);opacity:0}to{transform:rotate(0deg);opacity:1}}@keyframes mdc-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(0.14, 0, 0, 1);transform:rotate(0deg);opacity:1}to{transform:rotate(315deg);opacity:0}}@keyframes mdc-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;transform:scaleX(1);opacity:1}32.8%,100%{transform:scaleX(0);opacity:0}}.mat-mdc-checkbox{display:inline-block;position:relative;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *,.mat-mdc-checkbox._mat-animation-noopable .mdc-checkbox *::before{transition:none !important;animation:none !important}.mat-mdc-checkbox label{cursor:pointer}.mat-mdc-checkbox .mat-internal-form-field{color:var(--mat-checkbox-label-text-color, var(--mat-sys-on-surface));font-family:var(--mat-checkbox-label-text-font, var(--mat-sys-body-medium-font));line-height:var(--mat-checkbox-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-checkbox-label-text-size, var(--mat-sys-body-medium-size));letter-spacing:var(--mat-checkbox-label-text-tracking, var(--mat-sys-body-medium-tracking));font-weight:var(--mat-checkbox-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive{pointer-events:auto}.mat-mdc-checkbox.mat-mdc-checkbox-disabled.mat-mdc-checkbox-disabled-interactive input{cursor:default}.mat-mdc-checkbox.mat-mdc-checkbox-disabled label{cursor:default;color:var(--mat-checkbox-disabled-label-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-checkbox label:empty{display:none}.mat-mdc-checkbox .mdc-checkbox__ripple{opacity:0}.mat-mdc-checkbox .mat-mdc-checkbox-ripple,.mdc-checkbox__ripple{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:50%;pointer-events:none}.mat-mdc-checkbox .mat-mdc-checkbox-ripple:not(:empty),.mdc-checkbox__ripple:not(:empty){transform:translateZ(0)}.mat-mdc-checkbox-ripple .mat-ripple-element{opacity:.1}.mat-mdc-checkbox-touch-target{position:absolute;top:50%;left:50%;height:48px;width:48px;transform:translate(-50%, -50%);display:var(--mat-checkbox-touch-target-display, block)}.mat-mdc-checkbox-ripple::before{border-radius:50%}.mdc-checkbox__native-control:focus~.mat-focus-indicator::before{content:""}'],encapsulation:2,changeDetection:0})}return e})(),NH=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[LH,or,or]})}return e})();function zH(e={}){const{connector:n=()=>new Ie,resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=e;return a=>{let h,v,C,P=0,L=!1,V=!1;const W=()=>{v?.unsubscribe(),v=void 0},X=()=>{W(),h=C=void 0,L=V=!1},oe=()=>{const he=h;X(),he?.unsubscribe()};return Tt((he,se)=>{P++,!V&&!L&&W();const _e=C=C??n();se.add(()=>{P--,0===P&&!V&&!L&&(v=DO(oe,r))}),_e.subscribe(se),!h&&P>0&&(h=new kl({next:Se=>_e.next(Se),error:Se=>{V=!0,W(),v=DO(X,t,Se),_e.error(Se)},complete:()=>{L=!0,W(),v=DO(X,i),_e.complete()}}),ec(he).subscribe(h))})(a)}}function DO(e,n,...t){if(!0===n)return void e();if(!1===n)return;const i=new kl({next:()=>{i.unsubscribe(),e()}});return ec(n(...t)).subscribe(i)}const pce=["*"];let XD;function ZC(e){return function mce(){if(void 0===XD&&(XD=null,typeof window<"u")){const e=window;void 0!==e.trustedTypes&&(XD=e.trustedTypes.createPolicy("angular#components",{createHTML:n=>n}))}return XD}()?.createHTML(e)||e}function BH(e){return Error(`Unable to find icon with the name "${e}"`)}function VH(e){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${e}".`)}function UH(e){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${e}".`)}class Jv{url;svgText;options;svgElement;constructor(n,t,i){this.url=n,this.svgText=t,this.options=i}}let KD=(()=>{class e{_httpClient;_sanitizer;_errorHandler;_document;_svgIconConfigs=new Map;_iconSetConfigs=new Map;_cachedIconsByUrl=new Map;_inProgressUrlFetches=new Map;_fontCssClassesByAlias=new Map;_resolvers=[];_defaultFontSetClass=["material-icons","mat-ligature-font"];constructor(t,i,r,a){this._httpClient=t,this._sanitizer=i,this._errorHandler=a,this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,a){return this._addSvgIconConfig(t,i,new Jv(r,null,a))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,a){const h=this._sanitizer.sanitize(ps.HTML,r);if(!h)throw UH(r);const v=ZC(h);return this._addSvgIconConfig(t,i,new Jv("",v,a))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new Jv(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const a=this._sanitizer.sanitize(ps.HTML,i);if(!a)throw UH(i);const h=ZC(a);return this._addSvgIconSetConfig(t,new Jv("",h,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(ps.RESOURCE_URL,t);if(!i)throw VH(t);const r=this._cachedIconsByUrl.get(i);return r?vn(QD(r)):this._loadSvgIconFromConfig(new Jv(t,null)).pipe(Vo(a=>this._cachedIconsByUrl.set(i,a)),$t(a=>QD(a)))}getNamedSvgIcon(t,i=""){const r=jH(i,t);let a=this._svgIconConfigs.get(r);if(a)return this._getSvgFromConfig(a);if(a=this._getIconConfigFromResolvers(i,t),a)return this._svgIconConfigs.set(r,a),this._getSvgFromConfig(a);const h=this._iconSetConfigs.get(i);return h?this._getSvgFromIconSetConfigs(t,h):wh(BH(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?vn(QD(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe($t(i=>QD(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?vn(r):hU(i.filter(h=>!h.svgText).map(h=>this._loadSvgIconSetFromConfig(h).pipe(rs(v=>{const P=`Loading icon set URL: ${this._sanitizer.sanitize(ps.RESOURCE_URL,h.url)} failed: ${v.message}`;return this._errorHandler.handleError(new Error(P)),vn(null)})))).pipe($t(()=>{const h=this._extractIconWithNameFromAnySet(t,i);if(!h)throw BH(t);return h}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const a=i[r];if(a.svgText&&a.svgText.toString().indexOf(t)>-1){const h=this._svgElementFromConfig(a),v=this._extractSvgIconFromSet(h,t,a.options);if(v)return v}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(Vo(i=>t.svgText=i),$t(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?vn(null):this._fetchIcon(t).pipe(Vo(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const a=t.querySelector(`[id="${i}"]`);if(!a)return null;const h=a.cloneNode(!0);if(h.removeAttribute("id"),"svg"===h.nodeName.toLowerCase())return this._setSvgAttributes(h,r);if("symbol"===h.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(h),r);const v=this._svgElementFromString(ZC("<svg></svg>"));return v.appendChild(h),this._setSvgAttributes(v,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(ZC("<svg></svg>")),r=t.attributes;for(let a=0;a<r.length;a++){const{name:h,value:v}=r[a];"id"!==h&&i.setAttribute(h,v)}for(let a=0;a<t.childNodes.length;a++)t.childNodes[a].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[a].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){const{url:i,options:r}=t,a=r?.withCredentials??!1;if(!this._httpClient)throw function gce(){return Error("Could not find HttpClient for use with Angular Material icons. Please add provideHttpClient() to your providers.")}();if(null==i)throw Error(`Cannot fetch icon from URL "${i}".`);const h=this._sanitizer.sanitize(ps.RESOURCE_URL,i);if(!h)throw VH(i);const v=this._inProgressUrlFetches.get(h);if(v)return v;const C=this._httpClient.get(h,{responseType:"text",withCredentials:a}).pipe($t(P=>ZC(P)),vx(()=>this._inProgressUrlFetches.delete(h)),zH());return this._inProgressUrlFetches.set(h,C),C}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(jH(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const a=this._resolvers[r](i,t);if(a)return yce(a)?new Jv(a.url,null,a.options):new Jv(a,null)}}static \u0275fac=function(i){return new(i||e)(un(k_,8),un(EE),un(ir,8),un(Zi))};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function QD(e){return e.cloneNode(!0)}function jH(e,n){return e+":"+n}function yce(e){return!(!e.url||!e.options)}const vce=new ct("MAT_ICON_DEFAULT_OPTIONS"),bce=new ct("mat-icon-location",{providedIn:"root",factory:function xce(){const e=re(ir),n=e?e.location:null;return{getPathname:()=>n?n.pathname+n.search:""}}}),HH=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],wce=HH.map(e=>`[${e}]`).join(", "),Cce=/^url\(['"]?#(.*?)['"]?\)$/;let P_=(()=>{class e{_elementRef=re(In);_iconRegistry=re(KD);_location=re(bce);_errorHandler=re(Zi);_defaultColor;get color(){return this._color||this._defaultColor}set color(t){this._color=t}_color;inline=!1;get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}_svgIcon;get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}_fontSet;get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}_fontIcon;_previousFontSetClass=[];_previousFontIconClass;_svgName;_svgNamespace;_previousPath;_elementsWithExternalReferences;_currentIconFetch=Ni.EMPTY;constructor(){const t=re(new pt("aria-hidden"),{optional:!0}),i=re(vce,{optional:!0});i&&(i.color&&(this.color=this._defaultColor=i.color),i.fontSet&&(this.fontSet=i.fontSet)),t||this._elementRef.nativeElement.setAttribute("aria-hidden","true")}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,a)=>{r.forEach(h=>{a.setAttribute(h.name,`url('${t}#${h.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(wce),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let a=0;a<i.length;a++)HH.forEach(h=>{const v=i[a],C=v.getAttribute(h),P=C?C.match(Cce):null;if(P){let L=r.get(v);L||(L=[],r.set(v,L)),L.push({name:h,value:P[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Ac(1)).subscribe(a=>this._setSvgElement(a),a=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${a.message}`))})}}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:10,hostBindings:function(i,r){2&i&&(ui("data-mat-icon-type",r._usingFontIcon()?"font":"svg")("data-mat-icon-name",r._svgName||r.fontIcon)("data-mat-icon-namespace",r._svgNamespace||r.fontSet)("fontIcon",r._usingFontIcon()?r.fontIcon:null),ka(r.color?"mat-"+r.color:""),Ti("mat-icon-inline",r.inline)("mat-icon-no-color","primary"!==r.color&&"accent"!==r.color&&"warn"!==r.color))},inputs:{color:"color",inline:[2,"inline","inline",zn],svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[jr],ngContentSelectors:pce,decls:1,vars:0,template:function(i,r){1&i&&(zo(),ai(0))},styles:["mat-icon,mat-icon.mat-primary,mat-icon.mat-accent,mat-icon.mat-warn{color:var(--mat-icon-color, inherit)}.mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0})}return e})(),$H=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,or]})}return e})(),Tce=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-text-field-style-loader",""],decls:0,vars:0,template:function(i,r){},styles:["textarea.cdk-textarea-autosize{resize:none}textarea.cdk-textarea-autosize-measuring{padding:2px 0 !important;box-sizing:content-box !important;height:auto !important;overflow:hidden !important}textarea.cdk-textarea-autosize-measuring-firefox{padding:2px 0 !important;box-sizing:content-box !important;height:0 !important}@keyframes cdk-text-field-autofill-start{/*!*/}@keyframes cdk-text-field-autofill-end{/*!*/}.cdk-text-field-autofill-monitored:-webkit-autofill{animation:cdk-text-field-autofill-start 0s 1ms}.cdk-text-field-autofill-monitored:not(:-webkit-autofill){animation:cdk-text-field-autofill-end 0s 1ms}"],encapsulation:2,changeDetection:0})}return e})();const GH=cu({passive:!0});let Mce=(()=>{class e{_platform=re(Hs);_ngZone=re(Ht);_styleLoader=re(Oc);_monitoredElements=new Map;constructor(){}monitor(t){if(!this._platform.isBrowser)return yd;this._styleLoader.load(Tce);const i=xl(t),r=this._monitoredElements.get(i);if(r)return r.subject;const a=new Ie,h="cdk-text-field-autofilled",v=C=>{"cdk-text-field-autofill-start"!==C.animationName||i.classList.contains(h)?"cdk-text-field-autofill-end"===C.animationName&&i.classList.contains(h)&&(i.classList.remove(h),this._ngZone.run(()=>a.next({target:C.target,isAutofilled:!1}))):(i.classList.add(h),this._ngZone.run(()=>a.next({target:C.target,isAutofilled:!0})))};return this._ngZone.runOutsideAngular(()=>{i.addEventListener("animationstart",v,GH),i.classList.add("cdk-text-field-autofill-monitored")}),this._monitoredElements.set(i,{subject:a,unlisten:()=>{i.removeEventListener("animationstart",v,GH)}}),a}stopMonitoring(t){const i=xl(t),r=this._monitoredElements.get(i);r&&(r.unlisten(),r.subject.complete(),i.classList.remove("cdk-text-field-autofill-monitored"),i.classList.remove("cdk-text-field-autofilled"),this._monitoredElements.delete(i))}ngOnDestroy(){this._monitoredElements.forEach((t,i)=>this.stopMonitoring(i))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Sce=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();function Cl(...e){const n=_C(e),t=function Pne(e,n){return"number"==typeof tP(e)?e.pop():n}(e,1/0),i=e;return i.length?1===i.length?ec(i[0]):_x(t)(js(i,n)):yd}class IO extends Ie{constructor(n=1/0,t=1/0,i=dO){super(),this._bufferSize=n,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,n),this._windowTime=Math.max(1,t)}next(n){const{isStopped:t,_buffer:i,_infiniteTimeWindow:r,_timestampProvider:a,_windowTime:h}=this;t||(i.push(n),!r&&i.push(a.now()+h)),this._trimBuffer(),super.next(n)}_subscribe(n){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(n),{_infiniteTimeWindow:i,_buffer:r}=this,a=r.slice();for(let h=0;h<a.length&&!n.closed;h+=i?1:2)n.next(a[h]);return this._checkFinalizedStatuses(n),t}_trimBuffer(){const{_bufferSize:n,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:r}=this,a=(r?1:2)*n;if(n<1/0&&a<i.length&&i.splice(0,i.length-a),!r){const h=t.now();let v=0;for(let C=1;C<i.length&&i[C]<=h;C+=2)v=C;v&&i.splice(0,v+1)}}}class Ice{_box;_destroyed=new Ie;_resizeSubject=new Ie;_resizeObserver;_elementObservables=new Map;constructor(n){this._box=n,typeof ResizeObserver<"u"&&(this._resizeObserver=new ResizeObserver(t=>this._resizeSubject.next(t)))}observe(n){return this._elementObservables.has(n)||this._elementObservables.set(n,new Ce(t=>{const i=this._resizeSubject.subscribe(t);return this._resizeObserver?.observe(n,{box:this._box}),()=>{this._resizeObserver?.unobserve(n),i.unsubscribe(),this._elementObservables.delete(n)}}).pipe(is(t=>t.some(i=>i.target===n)),function Dce(e,n,t){let i,r=!1;return e&&"object"==typeof e?({bufferSize:i=1/0,windowTime:n=1/0,refCount:r=!1,scheduler:t}=e):i=e??1/0,zH({connector:()=>new IO(i,n,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:r})}({bufferSize:1,refCount:!0}),Er(this._destroyed))),this._elementObservables.get(n)}destroy(){this._destroyed.next(),this._destroyed.complete(),this._resizeSubject.complete(),this._elementObservables.clear()}}let kce=(()=>{class e{_cleanupErrorListener;_observers=new Map;_ngZone=re(Ht);constructor(){}ngOnDestroy(){for(const[,t]of this._observers)t.destroy();this._observers.clear(),this._cleanupErrorListener?.()}observe(t,i){const r=i?.box||"content-box";return this._observers.has(r)||this._observers.set(r,new Ice(r)),this._observers.get(r).observe(t)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ace=["notch"],Rce=["matFormFieldNotchedOutline",""],Pce=["*"],Oce=["textField"],Fce=["iconPrefixContainer"],Lce=["textPrefixContainer"],Nce=["iconSuffixContainer"],zce=["textSuffixContainer"],Bce=["*",[["mat-label"]],[["","matPrefix",""],["","matIconPrefix",""]],[["","matTextPrefix",""]],[["","matTextSuffix",""]],[["","matSuffix",""],["","matIconSuffix",""]],[["mat-error"],["","matError",""]],[["mat-hint",3,"align","end"]],[["mat-hint","align","end"]]],Vce=["*","mat-label","[matPrefix], [matIconPrefix]","[matTextPrefix]","[matTextSuffix]","[matSuffix], [matIconSuffix]","mat-error, [matError]","mat-hint:not([align='end'])","mat-hint[align='end']"];function Uce(e,n){1&e&&_n(0,"span",21)}function jce(e,n){if(1&e&&(Fe(0,"label",20),ai(1,1),an(2,Uce,1,0,"span",21),Ue()),2&e){const t=cn(2);At("floating",t._shouldLabelFloat())("monitorResize",t._hasOutline())("id",t._labelId),ui("for",t._control.disableAutomaticLabeling?null:t._control.id),Ze(2),Mr(!t.hideRequiredMarker&&t._control.required?2:-1)}}function Hce(e,n){1&e&&an(0,jce,3,5,"label",20),2&e&&Mr(cn()._hasFloatingLabel()?0:-1)}function $ce(e,n){1&e&&_n(0,"div",7)}function Gce(e,n){}function qce(e,n){1&e&&an(0,Gce,0,0,"ng-template",13),2&e&&(cn(2),At("ngTemplateOutlet",Za(1)))}function Wce(e,n){if(1&e&&(Fe(0,"div",9),an(1,qce,1,1,null,13),Ue()),2&e){const t=cn();At("matFormFieldNotchedOutlineOpen",t._shouldLabelFloat()),Ze(),Mr(t._forceDisplayInfixLabel()?-1:1)}}function Zce(e,n){1&e&&(Fe(0,"div",10,2),ai(2,2),Ue())}function Yce(e,n){1&e&&(Fe(0,"div",11,3),ai(2,3),Ue())}function Xce(e,n){}function Kce(e,n){1&e&&an(0,Xce,0,0,"ng-template",13),2&e&&(cn(),At("ngTemplateOutlet",Za(1)))}function Qce(e,n){1&e&&(Fe(0,"div",14,4),ai(2,4),Ue())}function Jce(e,n){1&e&&(Fe(0,"div",15,5),ai(2,5),Ue())}function ede(e,n){1&e&&_n(0,"div",16)}function tde(e,n){1&e&&(Fe(0,"div",18),ai(1,6),Ue()),2&e&&At("@transitionMessages",cn()._subscriptAnimationState)}function nde(e,n){if(1&e&&(Fe(0,"mat-hint",22),gt(1),Ue()),2&e){const t=cn(2);At("id",t._hintLabelId),Ze(),br(t.hintLabel)}}function ide(e,n){if(1&e&&(Fe(0,"div",19),an(1,nde,2,2,"mat-hint",22),ai(2,7),_n(3,"div",23),ai(4,8),Ue()),2&e){const t=cn();At("@transitionMessages",t._subscriptAnimationState),Ze(),Mr(t.hintLabel?1:-1)}}let kO=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["mat-label"]]})}return e})();const rde=new ct("MatError");let qH=(()=>{class e{align="start";id=re(du).getId("mat-mdc-hint-");static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["mat-hint"]],hostAttrs:[1,"mat-mdc-form-field-hint","mat-mdc-form-field-bottom-align"],hostVars:4,hostBindings:function(i,r){2&i&&(ax("id",r.id),ui("align",null),Ti("mat-mdc-form-field-hint-end","end"===r.align))},inputs:{align:"align",id:"id"}})}return e})();const ode=new ct("MatPrefix"),WH=new ct("MatSuffix");let sde=(()=>{class e{set _isTextSelector(t){this._isText=!0}_isText=!1;static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","matSuffix",""],["","matIconSuffix",""],["","matTextSuffix",""]],inputs:{_isTextSelector:[0,"matTextSuffix","_isTextSelector"]},features:[Jn([{provide:WH,useExisting:e}])]})}return e})();const ZH=new ct("FloatingLabelParent");let YH=(()=>{class e{_elementRef=re(In);get floating(){return this._floating}set floating(t){this._floating=t,this.monitorResize&&this._handleResize()}_floating=!1;get monitorResize(){return this._monitorResize}set monitorResize(t){this._monitorResize=t,this._monitorResize?this._subscribeToResize():this._resizeSubscription.unsubscribe()}_monitorResize=!1;_resizeObserver=re(kce);_ngZone=re(Ht);_parent=re(ZH);_resizeSubscription=new Ni;constructor(){}ngOnDestroy(){this._resizeSubscription.unsubscribe()}getWidth(){return function ade(e){if(null!==e.offsetParent)return e.scrollWidth;const t=e.cloneNode(!0);t.style.setProperty("position","absolute"),t.style.setProperty("transform","translate(-9999px, -9999px)"),document.documentElement.appendChild(t);const i=t.scrollWidth;return t.remove(),i}(this._elementRef.nativeElement)}get element(){return this._elementRef.nativeElement}_handleResize(){setTimeout(()=>this._parent._handleLabelResized())}_subscribeToResize(){this._resizeSubscription.unsubscribe(),this._ngZone.runOutsideAngular(()=>{this._resizeSubscription=this._resizeObserver.observe(this._elementRef.nativeElement,{box:"border-box"}).subscribe(()=>this._handleResize())})}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["label","matFormFieldFloatingLabel",""]],hostAttrs:[1,"mdc-floating-label","mat-mdc-floating-label"],hostVars:2,hostBindings:function(i,r){2&i&&Ti("mdc-floating-label--float-above",r.floating)},inputs:{floating:"floating",monitorResize:"monitorResize"}})}return e})();const XH="mdc-line-ripple--active",JD="mdc-line-ripple--deactivating";let KH=(()=>{class e{_elementRef=re(In);_cleanupTransitionEnd;constructor(){const t=re(Ht),i=re(Ns);t.runOutsideAngular(()=>{this._cleanupTransitionEnd=i.listen(this._elementRef.nativeElement,"transitionend",this._handleTransitionEnd)})}activate(){const t=this._elementRef.nativeElement.classList;t.remove(JD),t.add(XH)}deactivate(){this._elementRef.nativeElement.classList.add(JD)}_handleTransitionEnd=t=>{const i=this._elementRef.nativeElement.classList,r=i.contains(JD);"opacity"===t.propertyName&&r&&i.remove(XH,JD)};ngOnDestroy(){this._cleanupTransitionEnd()}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["div","matFormFieldLineRipple",""]],hostAttrs:[1,"mdc-line-ripple"]})}return e})(),QH=(()=>{class e{_elementRef=re(In);_ngZone=re(Ht);open=!1;_notch;constructor(){}ngAfterViewInit(){const t=this._elementRef.nativeElement.querySelector(".mdc-floating-label");t?(this._elementRef.nativeElement.classList.add("mdc-notched-outline--upgraded"),"function"==typeof requestAnimationFrame&&(t.style.transitionDuration="0s",this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>t.style.transitionDuration="")}))):this._elementRef.nativeElement.classList.add("mdc-notched-outline--no-label")}_setNotchWidth(t){this._notch.nativeElement.style.width=this.open&&t?`calc(${t}px * var(--mat-mdc-form-field-floating-label-scale, 0.75) + 9px)`:""}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["div","matFormFieldNotchedOutline",""]],viewQuery:function(i,r){if(1&i&&zr(Ace,5),2&i){let a;ri(a=oi())&&(r._notch=a.first)}},hostAttrs:[1,"mdc-notched-outline"],hostVars:2,hostBindings:function(i,r){2&i&&Ti("mdc-notched-outline--notched",r.open)},inputs:{open:[0,"matFormFieldNotchedOutlineOpen","open"]},attrs:Rce,ngContentSelectors:Pce,decls:5,vars:0,consts:[["notch",""],[1,"mat-mdc-notch-piece","mdc-notched-outline__leading"],[1,"mat-mdc-notch-piece","mdc-notched-outline__notch"],[1,"mat-mdc-notch-piece","mdc-notched-outline__trailing"]],template:function(i,r){1&i&&(zo(),_n(0,"div",1),Fe(1,"div",2,0),ai(3),Ue(),_n(4,"div",3))},encapsulation:2,changeDetection:0})}return e})();const lde={transitionMessages:Us("transitionMessages",[Or("enter",yi({opacity:1,transform:"translateY(0%)"})),Hr("void => enter",[yi({opacity:0,transform:"translateY(-5px)"}),no("300ms cubic-bezier(0.55, 0, 0.55, 0.2)")])])};let AO=(()=>{class e{value;stateChanges;id;placeholder;ngControl;focused;empty;shouldLabelFloat;required;disabled;errorState;controlType;autofilled;userAriaDescribedBy;disableAutomaticLabeling;static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e})}return e})();const RO=new ct("MatFormField"),cde=new ct("MAT_FORM_FIELD_DEFAULT_OPTIONS");let t6=(()=>{class e{_elementRef=re(In);_changeDetectorRef=re(Bo);_dir=re(Om);_platform=re(Hs);_idGenerator=re(du);_defaults=re(cde,{optional:!0});_animationMode=re(Ga,{optional:!0});_textField;_iconPrefixContainer;_textPrefixContainer;_iconSuffixContainer;_textSuffixContainer;_floatingLabel;_notchedOutline;_lineRipple;_formFieldControl;_prefixChildren;_suffixChildren;_errorChildren;_hintChildren;_labelChild=sW(kO);get hideRequiredMarker(){return this._hideRequiredMarker}set hideRequiredMarker(t){this._hideRequiredMarker=Fc(t)}_hideRequiredMarker=!1;color="primary";get floatLabel(){return this._floatLabel||this._defaults?.floatLabel||"auto"}set floatLabel(t){t!==this._floatLabel&&(this._floatLabel=t,this._changeDetectorRef.markForCheck())}_floatLabel;get appearance(){return this._appearance}set appearance(t){const i=this._appearance;this._appearance=t||this._defaults?.appearance||"fill","outline"===this._appearance&&this._appearance!==i&&(this._needsOutlineLabelOffsetUpdate=!0)}_appearance="fill";get subscriptSizing(){return this._subscriptSizing||this._defaults?.subscriptSizing||"fixed"}set subscriptSizing(t){this._subscriptSizing=t||this._defaults?.subscriptSizing||"fixed"}_subscriptSizing=null;get hintLabel(){return this._hintLabel}set hintLabel(t){this._hintLabel=t,this._processHints()}_hintLabel="";_hasIconPrefix=!1;_hasTextPrefix=!1;_hasIconSuffix=!1;_hasTextSuffix=!1;_labelId=this._idGenerator.getId("mat-mdc-form-field-label-");_hintLabelId=this._idGenerator.getId("mat-mdc-hint-");_subscriptAnimationState="";get _control(){return this._explicitFormFieldControl||this._formFieldControl}set _control(t){this._explicitFormFieldControl=t}_destroyed=new Ie;_isFocused=null;_explicitFormFieldControl;_needsOutlineLabelOffsetUpdate=!1;_previousControl=null;_stateChanges;_valueChanges;_describedByChanges;_injector=re(Ye);constructor(){const t=this._defaults;t&&(t.appearance&&(this.appearance=t.appearance),this._hideRequiredMarker=!!t?.hideRequiredMarker,t.color&&(this.color=t.color))}ngAfterViewInit(){this._updateFocusState(),this._subscriptAnimationState="enter",this._changeDetectorRef.detectChanges()}ngAfterContentInit(){this._assertFormFieldControl(),this._initializeSubscript(),this._initializePrefixAndSuffix(),this._initializeOutlineLabelOffsetSubscriptions()}ngAfterContentChecked(){this._assertFormFieldControl(),this._control!==this._previousControl&&(this._initializeControl(this._previousControl),this._previousControl=this._control)}ngOnDestroy(){this._stateChanges?.unsubscribe(),this._valueChanges?.unsubscribe(),this._describedByChanges?.unsubscribe(),this._destroyed.next(),this._destroyed.complete()}getLabelId=Tm(()=>this._hasFloatingLabel()?this._labelId:null);getConnectedOverlayOrigin(){return this._textField||this._elementRef}_animateAndLockLabel(){this._hasFloatingLabel()&&(this.floatLabel="always")}_initializeControl(t){const i=this._control,r="mat-mdc-form-field-type-";t&&this._elementRef.nativeElement.classList.remove(r+t.controlType),i.controlType&&this._elementRef.nativeElement.classList.add(r+i.controlType),this._stateChanges?.unsubscribe(),this._stateChanges=i.stateChanges.subscribe(()=>{this._updateFocusState(),this._changeDetectorRef.markForCheck()}),this._describedByChanges?.unsubscribe(),this._describedByChanges=i.stateChanges.pipe(Ch([void 0,void 0]),$t(()=>[i.errorState,i.userAriaDescribedBy]),function Ece(){return Tt((e,n)=>{let t,i=!1;e.subscribe(Mt(n,r=>{const a=t;t=r,i&&n.next([a,r]),i=!0}))})}(),is(([[a,h],[v,C]])=>a!==v||h!==C)).subscribe(()=>this._syncDescribedByIds()),this._valueChanges?.unsubscribe(),i.ngControl&&i.ngControl.valueChanges&&(this._valueChanges=i.ngControl.valueChanges.pipe(Er(this._destroyed)).subscribe(()=>this._changeDetectorRef.markForCheck()))}_checkPrefixAndSuffixTypes(){this._hasIconPrefix=!!this._prefixChildren.find(t=>!t._isText),this._hasTextPrefix=!!this._prefixChildren.find(t=>t._isText),this._hasIconSuffix=!!this._suffixChildren.find(t=>!t._isText),this._hasTextSuffix=!!this._suffixChildren.find(t=>t._isText)}_initializePrefixAndSuffix(){this._checkPrefixAndSuffixTypes(),Cl(this._prefixChildren.changes,this._suffixChildren.changes).subscribe(()=>{this._checkPrefixAndSuffixTypes(),this._changeDetectorRef.markForCheck()})}_initializeSubscript(){this._hintChildren.changes.subscribe(()=>{this._processHints(),this._changeDetectorRef.markForCheck()}),this._errorChildren.changes.subscribe(()=>{this._syncDescribedByIds(),this._changeDetectorRef.markForCheck()}),this._validateHints(),this._syncDescribedByIds()}_assertFormFieldControl(){}_updateFocusState(){this._control.focused&&!this._isFocused?(this._isFocused=!0,this._lineRipple?.activate()):!this._control.focused&&(this._isFocused||null===this._isFocused)&&(this._isFocused=!1,this._lineRipple?.deactivate()),this._textField?.nativeElement.classList.toggle("mdc-text-field--focused",this._control.focused)}_initializeOutlineLabelOffsetSubscriptions(){this._prefixChildren.changes.subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0),Yp(()=>{this._needsOutlineLabelOffsetUpdate&&(this._needsOutlineLabelOffsetUpdate=!1,this._updateOutlineLabelOffset())},{injector:this._injector}),this._dir.change.pipe(Er(this._destroyed)).subscribe(()=>this._needsOutlineLabelOffsetUpdate=!0)}_shouldAlwaysFloat(){return"always"===this.floatLabel}_hasOutline(){return"outline"===this.appearance}_forceDisplayInfixLabel(){return!this._platform.isBrowser&&this._prefixChildren.length&&!this._shouldLabelFloat()}_hasFloatingLabel=Tm(()=>!!this._labelChild());_shouldLabelFloat(){return!!this._hasFloatingLabel()&&(this._control.shouldLabelFloat||this._shouldAlwaysFloat())}_shouldForward(t){const i=this._control?this._control.ngControl:null;return i&&i[t]}_getDisplayedMessages(){return this._errorChildren&&this._errorChildren.length>0&&this._control.errorState?"error":"hint"}_handleLabelResized(){this._refreshOutlineNotchWidth()}_refreshOutlineNotchWidth(){this._hasOutline()&&this._floatingLabel&&this._shouldLabelFloat()?this._notchedOutline?._setNotchWidth(this._floatingLabel.getWidth()):this._notchedOutline?._setNotchWidth(0)}_processHints(){this._validateHints(),this._syncDescribedByIds()}_validateHints(){}_syncDescribedByIds(){if(this._control){let t=[];if(this._control.userAriaDescribedBy&&"string"==typeof this._control.userAriaDescribedBy&&t.push(...this._control.userAriaDescribedBy.split(" ")),"hint"===this._getDisplayedMessages()){const i=this._hintChildren?this._hintChildren.find(a=>"start"===a.align):null,r=this._hintChildren?this._hintChildren.find(a=>"end"===a.align):null;i?t.push(i.id):this._hintLabel&&t.push(this._hintLabelId),r&&t.push(r.id)}else this._errorChildren&&t.push(...this._errorChildren.map(i=>i.id));this._control.setDescribedByIds(t)}}_updateOutlineLabelOffset(){if(!this._hasOutline()||!this._floatingLabel)return;const t=this._floatingLabel.element;if(!this._iconPrefixContainer&&!this._textPrefixContainer)return void(t.style.transform="");if(!this._isAttachedToDom())return void(this._needsOutlineLabelOffsetUpdate=!0);const i=this._iconPrefixContainer?.nativeElement,r=this._textPrefixContainer?.nativeElement,a=this._iconSuffixContainer?.nativeElement,h=this._textSuffixContainer?.nativeElement,v=i?.getBoundingClientRect().width??0,C=r?.getBoundingClientRect().width??0,P=a?.getBoundingClientRect().width??0,L=h?.getBoundingClientRect().width??0;t.style.transform=`var(\n        --mat-mdc-form-field-label-transform,\n        translateY(-50%) translateX(calc(${"rtl"===this._dir.value?"-1":"1"} * (${v+C}px + var(--mat-mdc-form-field-label-offset-x, 0px))))\n    )`,this._elementRef.nativeElement.style.setProperty("--mat-form-field-notch-max-width",`calc(100% - ${v+C+P+L}px)`)}_isAttachedToDom(){const t=this._elementRef.nativeElement;if(t.getRootNode){const i=t.getRootNode();return i&&i!==t}return document.documentElement.contains(t)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-form-field"]],contentQueries:function(i,r,a){if(1&i&&(w3(a,r._labelChild,kO,5),bo(a,AO,5),bo(a,ode,5),bo(a,WH,5),bo(a,rde,5),bo(a,qH,5)),2&i){let h;(function C3(e=1){kp(wg()+e)})(),ri(h=oi())&&(r._formFieldControl=h.first),ri(h=oi())&&(r._prefixChildren=h),ri(h=oi())&&(r._suffixChildren=h),ri(h=oi())&&(r._errorChildren=h),ri(h=oi())&&(r._hintChildren=h)}},viewQuery:function(i,r){if(1&i&&(zr(Oce,5),zr(Fce,5),zr(Lce,5),zr(Nce,5),zr(zce,5),zr(YH,5),zr(QH,5),zr(KH,5)),2&i){let a;ri(a=oi())&&(r._textField=a.first),ri(a=oi())&&(r._iconPrefixContainer=a.first),ri(a=oi())&&(r._textPrefixContainer=a.first),ri(a=oi())&&(r._iconSuffixContainer=a.first),ri(a=oi())&&(r._textSuffixContainer=a.first),ri(a=oi())&&(r._floatingLabel=a.first),ri(a=oi())&&(r._notchedOutline=a.first),ri(a=oi())&&(r._lineRipple=a.first)}},hostAttrs:[1,"mat-mdc-form-field"],hostVars:42,hostBindings:function(i,r){2&i&&Ti("mat-mdc-form-field-label-always-float",r._shouldAlwaysFloat())("mat-mdc-form-field-has-icon-prefix",r._hasIconPrefix)("mat-mdc-form-field-has-icon-suffix",r._hasIconSuffix)("mat-form-field-invalid",r._control.errorState)("mat-form-field-disabled",r._control.disabled)("mat-form-field-autofilled",r._control.autofilled)("mat-form-field-no-animations","NoopAnimations"===r._animationMode)("mat-form-field-appearance-fill","fill"==r.appearance)("mat-form-field-appearance-outline","outline"==r.appearance)("mat-form-field-hide-placeholder",r._hasFloatingLabel()&&!r._shouldLabelFloat())("mat-focused",r._control.focused)("mat-primary","accent"!==r.color&&"warn"!==r.color)("mat-accent","accent"===r.color)("mat-warn","warn"===r.color)("ng-untouched",r._shouldForward("untouched"))("ng-touched",r._shouldForward("touched"))("ng-pristine",r._shouldForward("pristine"))("ng-dirty",r._shouldForward("dirty"))("ng-valid",r._shouldForward("valid"))("ng-invalid",r._shouldForward("invalid"))("ng-pending",r._shouldForward("pending"))},inputs:{hideRequiredMarker:"hideRequiredMarker",color:"color",floatLabel:"floatLabel",appearance:"appearance",subscriptSizing:"subscriptSizing",hintLabel:"hintLabel"},exportAs:["matFormField"],features:[Jn([{provide:RO,useExisting:e},{provide:ZH,useExisting:e}])],ngContentSelectors:Vce,decls:18,vars:21,consts:[["labelTemplate",""],["textField",""],["iconPrefixContainer",""],["textPrefixContainer",""],["textSuffixContainer",""],["iconSuffixContainer",""],[1,"mat-mdc-text-field-wrapper","mdc-text-field",3,"click"],[1,"mat-mdc-form-field-focus-overlay"],[1,"mat-mdc-form-field-flex"],["matFormFieldNotchedOutline","",3,"matFormFieldNotchedOutlineOpen"],[1,"mat-mdc-form-field-icon-prefix"],[1,"mat-mdc-form-field-text-prefix"],[1,"mat-mdc-form-field-infix"],[3,"ngTemplateOutlet"],[1,"mat-mdc-form-field-text-suffix"],[1,"mat-mdc-form-field-icon-suffix"],["matFormFieldLineRipple",""],[1,"mat-mdc-form-field-subscript-wrapper","mat-mdc-form-field-bottom-align"],[1,"mat-mdc-form-field-error-wrapper"],[1,"mat-mdc-form-field-hint-wrapper"],["matFormFieldFloatingLabel","",3,"floating","monitorResize","id"],["aria-hidden","true",1,"mat-mdc-form-field-required-marker","mdc-floating-label--required"],[3,"id"],[1,"mat-mdc-form-field-hint-spacer"]],template:function(i,r){if(1&i){const a=Is();zo(Bce),an(0,Hce,1,1,"ng-template",null,0,wm),Fe(2,"div",6,1),Nn("click",function(v){return Di(a),Ii(r._control.onContainerClick(v))}),an(4,$ce,1,0,"div",7),Fe(5,"div",8),an(6,Wce,2,2,"div",9)(7,Zce,3,0,"div",10)(8,Yce,3,0,"div",11),Fe(9,"div",12),an(10,Kce,1,1,null,13),ai(11),Ue(),an(12,Qce,3,0,"div",14)(13,Jce,3,0,"div",15),Ue(),an(14,ede,1,0,"div",16),Ue(),Fe(15,"div",17),an(16,tde,2,1,"div",18)(17,ide,5,2,"div",19),Ue()}if(2&i){let a;Ze(2),Ti("mdc-text-field--filled",!r._hasOutline())("mdc-text-field--outlined",r._hasOutline())("mdc-text-field--no-label",!r._hasFloatingLabel())("mdc-text-field--disabled",r._control.disabled)("mdc-text-field--invalid",r._control.errorState),Ze(2),Mr(r._hasOutline()||r._control.disabled?-1:4),Ze(2),Mr(r._hasOutline()?6:-1),Ze(),Mr(r._hasIconPrefix?7:-1),Ze(),Mr(r._hasTextPrefix?8:-1),Ze(2),Mr(!r._hasOutline()||r._forceDisplayInfixLabel()?10:-1),Ze(2),Mr(r._hasTextSuffix?12:-1),Ze(),Mr(r._hasIconSuffix?13:-1),Ze(),Mr(r._hasOutline()?-1:14),Ze(),Ti("mat-mdc-form-field-subscript-dynamic-size","dynamic"===r.subscriptSizing),Ze(),Mr("error"===(a=r._getDisplayedMessages())?16:"hint"===a?17:-1)}},dependencies:[YH,QH,sC,KH,qH],styles:['.mdc-text-field{display:inline-flex;align-items:baseline;padding:0 16px;position:relative;box-sizing:border-box;overflow:hidden;will-change:opacity,transform,color;border-top-left-radius:4px;border-top-right-radius:4px;border-bottom-right-radius:0;border-bottom-left-radius:0}.mdc-text-field__input{width:100%;min-width:0;border:none;border-radius:0;background:none;padding:0;-moz-appearance:none;-webkit-appearance:none;height:28px}.mdc-text-field__input::-webkit-calendar-picker-indicator{display:none}.mdc-text-field__input::-ms-clear{display:none}.mdc-text-field__input:focus{outline:none}.mdc-text-field__input:invalid{box-shadow:none}.mdc-text-field__input::placeholder{opacity:0}.mdc-text-field__input::-moz-placeholder{opacity:0}.mdc-text-field__input::-webkit-input-placeholder{opacity:0}.mdc-text-field__input:-ms-input-placeholder{opacity:0}.mdc-text-field--no-label .mdc-text-field__input::placeholder,.mdc-text-field--focused .mdc-text-field__input::placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{opacity:1}.mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{opacity:1}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-moz-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive::-webkit-input-placeholder{opacity:0}.mdc-text-field--disabled:not(.mdc-text-field--no-label) .mdc-text-field__input.mat-mdc-input-disabled-interactive:-ms-input-placeholder{opacity:0}.mdc-text-field--outlined .mdc-text-field__input,.mdc-text-field--filled.mdc-text-field--no-label .mdc-text-field__input{height:100%}.mdc-text-field--outlined .mdc-text-field__input{display:flex;border:none !important;background-color:rgba(0,0,0,0)}.mdc-text-field--disabled .mdc-text-field__input{pointer-events:auto}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-filled-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-filled-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-filled-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-filled-text-field-error-caret-color)}.mdc-text-field--filled.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-filled-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input{color:var(--mdc-outlined-text-field-input-text-color, var(--mat-sys-on-surface));caret-color:var(--mdc-outlined-text-field-caret-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-moz-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input::-webkit-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-text-field__input:-ms-input-placeholder{color:var(--mdc-outlined-text-field-input-text-placeholder-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-text-field__input{caret-color:var(--mdc-outlined-text-field-error-caret-color)}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-text-field__input{color:var(--mdc-outlined-text-field-disabled-input-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}@media(forced-colors: active){.mdc-text-field--disabled .mdc-text-field__input{background-color:Window}}.mdc-text-field--filled{height:56px;border-bottom-right-radius:0;border-bottom-left-radius:0;border-top-left-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small));border-top-right-radius:var(--mdc-filled-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--filled:not(.mdc-text-field--disabled){background-color:var(--mdc-filled-text-field-container-color, var(--mat-sys-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled{background-color:var(--mdc-filled-text-field-disabled-container-color, color-mix(in srgb, var(--mat-sys-on-surface) 4%, transparent))}.mdc-text-field--outlined{height:56px;overflow:visible;padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)));padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px)}[dir=rtl] .mdc-text-field--outlined{padding-right:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)) + 4px);padding-left:max(16px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}.mdc-floating-label{position:absolute;left:0;transform-origin:left top;line-height:1.15rem;text-align:left;text-overflow:ellipsis;white-space:nowrap;cursor:text;overflow:hidden;will-change:transform}[dir=rtl] .mdc-floating-label{right:0;left:auto;transform-origin:right top;text-align:right}.mdc-text-field .mdc-floating-label{top:50%;transform:translateY(-50%);pointer-events:none}.mdc-notched-outline .mdc-floating-label{display:inline-block;position:relative;max-width:100%}.mdc-text-field--outlined .mdc-floating-label{left:4px;right:auto}[dir=rtl] .mdc-text-field--outlined .mdc-floating-label{left:auto;right:4px}.mdc-text-field--filled .mdc-floating-label{left:16px;right:auto}[dir=rtl] .mdc-text-field--filled .mdc-floating-label{left:auto;right:16px}.mdc-text-field--disabled .mdc-floating-label{cursor:default}@media(forced-colors: active){.mdc-text-field--disabled .mdc-floating-label{z-index:1}}.mdc-text-field--filled.mdc-text-field--no-label .mdc-floating-label{display:none}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-filled-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-filled-text-field-hover-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-filled-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-filled-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-filled-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-filled-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--filled .mdc-floating-label{font-family:var(--mdc-filled-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-filled-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-filled-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-filled-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mdc-floating-label{color:var(--mdc-outlined-text-field-label-text-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-focus-label-text-color, var(--mat-sys-primary))}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined.mdc-text-field--disabled .mdc-floating-label{color:var(--mdc-outlined-text-field-disabled-label-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-floating-label{color:var(--mdc-outlined-text-field-error-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mdc-floating-label{color:var(--mdc-outlined-text-field-error-focus-label-text-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--disabled):hover .mdc-floating-label{color:var(--mdc-outlined-text-field-error-hover-label-text-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined .mdc-floating-label{font-family:var(--mdc-outlined-text-field-label-text-font, var(--mat-sys-body-large-font));font-size:var(--mdc-outlined-text-field-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-outlined-text-field-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-outlined-text-field-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-floating-label--float-above{cursor:auto;transform:translateY(-106%) scale(0.75)}.mdc-text-field--filled .mdc-floating-label--float-above{transform:translateY(-106%) scale(0.75)}.mdc-text-field--outlined .mdc-floating-label--float-above{transform:translateY(-37.25px) scale(1);font-size:.75rem}.mdc-notched-outline .mdc-floating-label--float-above{text-overflow:clip}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:133.3333333333%}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{transform:translateY(-34.75px) scale(0.75)}.mdc-text-field--outlined.mdc-notched-outline--upgraded .mdc-floating-label--float-above,.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:1rem}.mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:1px;margin-right:0;content:"*"}[dir=rtl] .mdc-floating-label--required:not(.mdc-floating-label--hide-required-marker)::after{margin-left:0;margin-right:1px}.mdc-notched-outline{display:flex;position:absolute;top:0;right:0;left:0;box-sizing:border-box;width:100%;max-width:100%;height:100%;text-align:left;pointer-events:none}[dir=rtl] .mdc-notched-outline{text-align:right}.mdc-text-field--outlined .mdc-notched-outline{z-index:1}.mat-mdc-notch-piece{box-sizing:border-box;height:100%;pointer-events:none;border-top:1px solid;border-bottom:1px solid}.mdc-text-field--focused .mat-mdc-notch-piece{border-width:2px}.mdc-text-field--outlined:not(.mdc-text-field--disabled) .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-outline-color, var(--mat-sys-outline));border-width:var(--mdc-outlined-text-field-outline-width, 1px)}.mdc-text-field--outlined:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-hover-outline-color, var(--mat-sys-on-surface))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-focus-outline-color, var(--mat-sys-primary))}.mdc-text-field--outlined.mdc-text-field--disabled .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-disabled-outline-color, color-mix(in srgb, var(--mat-sys-on-surface) 12%, transparent))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-notched-outline .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-hover-outline-color, var(--mat-sys-on-error-container))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--invalid.mdc-text-field--focused .mat-mdc-notch-piece{border-color:var(--mdc-outlined-text-field-error-focus-outline-color, var(--mat-sys-error))}.mdc-text-field--outlined:not(.mdc-text-field--disabled).mdc-text-field--focused .mdc-notched-outline .mat-mdc-notch-piece{border-width:var(--mdc-outlined-text-field-focus-outline-width, 2px)}.mdc-notched-outline__leading{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__leading{width:max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))}[dir=rtl] .mdc-notched-outline__leading{border-left:none;border-right:1px solid;border-bottom-left-radius:0;border-top-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__trailing{flex-grow:1;border-left:none;border-right:1px solid;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-right-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}[dir=rtl] .mdc-notched-outline__trailing{border-left:1px solid;border-right:none;border-top-right-radius:0;border-bottom-right-radius:0;border-top-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small));border-bottom-left-radius:var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small))}.mdc-notched-outline__notch{flex:0 0 auto;width:auto}.mdc-text-field--outlined .mdc-notched-outline .mdc-notched-outline__notch{max-width:min(var(--mat-form-field-notch-max-width, 100%),100% - max(12px,var(--mdc-outlined-text-field-container-shape, var(--mat-sys-corner-extra-small)))*2)}.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:1px}.mdc-text-field--focused.mdc-text-field--outlined .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-top:2px}.mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:0;padding-right:8px;border-top:none;--mat-form-field-notch-max-width: 100%}[dir=rtl] .mdc-notched-outline--notched .mdc-notched-outline__notch{padding-left:8px;padding-right:0}.mdc-notched-outline--no-label .mdc-notched-outline__notch{display:none}.mdc-line-ripple::before,.mdc-line-ripple::after{position:absolute;bottom:0;left:0;width:100%;border-bottom-style:solid;content:""}.mdc-line-ripple::before{z-index:1;border-bottom-width:var(--mdc-filled-text-field-active-indicator-height, 1px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-active-indicator-color, var(--mat-sys-on-surface-variant))}.mdc-text-field--filled:not(.mdc-text-field--disabled):not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-hover-active-indicator-color, var(--mat-sys-on-surface))}.mdc-text-field--filled.mdc-text-field--disabled .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-disabled-active-indicator-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-active-indicator-color, var(--mat-sys-error))}.mdc-text-field--filled:not(.mdc-text-field--disabled).mdc-text-field--invalid:not(.mdc-text-field--focused):hover .mdc-line-ripple::before{border-bottom-color:var(--mdc-filled-text-field-error-hover-active-indicator-color, var(--mat-sys-on-error-container))}.mdc-line-ripple::after{transform:scaleX(0);opacity:0;z-index:2}.mdc-text-field--filled .mdc-line-ripple::after{border-bottom-width:var(--mdc-filled-text-field-focus-active-indicator-height, 2px)}.mdc-text-field--filled:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-focus-active-indicator-color, var(--mat-sys-primary))}.mdc-text-field--filled.mdc-text-field--invalid:not(.mdc-text-field--disabled) .mdc-line-ripple::after{border-bottom-color:var(--mdc-filled-text-field-error-focus-active-indicator-color, var(--mat-sys-error))}.mdc-line-ripple--active::after{transform:scaleX(1);opacity:1}.mdc-line-ripple--deactivating::after{opacity:0}.mdc-text-field--disabled{pointer-events:none}.mat-mdc-form-field-textarea-control{vertical-align:middle;resize:vertical;box-sizing:border-box;height:auto;margin:0;padding:0;border:none;overflow:auto}.mat-mdc-form-field-input-control.mat-mdc-form-field-input-control{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font:inherit;letter-spacing:inherit;text-decoration:inherit;text-transform:inherit;border:none}.mat-mdc-form-field .mat-mdc-floating-label.mdc-floating-label{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;line-height:normal;pointer-events:all;will-change:auto}.mat-mdc-form-field:not(.mat-form-field-disabled) .mat-mdc-floating-label.mdc-floating-label{cursor:inherit}.mdc-text-field--no-label:not(.mdc-text-field--textarea) .mat-mdc-form-field-input-control.mdc-text-field__input,.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control{height:auto}.mat-mdc-text-field-wrapper .mat-mdc-form-field-input-control.mdc-text-field__input[type=color]{height:23px}.mat-mdc-text-field-wrapper{height:auto;flex:auto;will-change:auto}.mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-left:0;--mat-mdc-form-field-label-offset-x: -16px}.mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-right:0}[dir=rtl] .mat-mdc-text-field-wrapper{padding-left:16px;padding-right:16px}[dir=rtl] .mat-mdc-form-field-has-icon-suffix .mat-mdc-text-field-wrapper{padding-left:0}[dir=rtl] .mat-mdc-form-field-has-icon-prefix .mat-mdc-text-field-wrapper{padding-right:0}.mat-form-field-disabled .mdc-text-field__input::placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-moz-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input::-webkit-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-disabled .mdc-text-field__input:-ms-input-placeholder{color:var(--mat-form-field-disabled-input-text-placeholder-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-label-always-float .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms;opacity:1}.mat-mdc-text-field-wrapper .mat-mdc-form-field-infix .mat-mdc-floating-label{left:auto;right:auto}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-text-field__input{display:inline-block}.mat-mdc-form-field .mat-mdc-text-field-wrapper.mdc-text-field .mdc-notched-outline__notch{padding-top:0}.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:1px solid rgba(0,0,0,0)}[dir=rtl] .mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field.mat-mdc-form-field .mdc-notched-outline__notch{border-left:none;border-right:1px solid rgba(0,0,0,0)}.mat-mdc-form-field-infix{min-height:var(--mat-form-field-container-height, 56px);padding-top:var(--mat-form-field-filled-with-label-container-padding-top, 24px);padding-bottom:var(--mat-form-field-filled-with-label-container-padding-bottom, 8px)}.mdc-text-field--outlined .mat-mdc-form-field-infix,.mdc-text-field--no-label .mat-mdc-form-field-infix{padding-top:var(--mat-form-field-container-vertical-padding, 16px);padding-bottom:var(--mat-form-field-container-vertical-padding, 16px)}.mat-mdc-text-field-wrapper .mat-mdc-form-field-flex .mat-mdc-floating-label{top:calc(var(--mat-form-field-container-height, 56px)/2)}.mdc-text-field--filled .mat-mdc-floating-label{display:var(--mat-form-field-filled-label-display, block)}.mat-mdc-text-field-wrapper.mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{--mat-mdc-form-field-label-transform: translateY(calc(calc(6.75px + var(--mat-form-field-container-height, 56px) / 2) * -1)) scale(var(--mat-mdc-form-field-floating-label-scale, 0.75));transform:var(--mat-mdc-form-field-label-transform)}.mat-mdc-form-field-subscript-wrapper{box-sizing:border-box;width:100%;position:relative}.mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-error-wrapper{position:absolute;top:0;left:0;right:0;padding:0 16px}.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-hint-wrapper,.mat-mdc-form-field-subscript-dynamic-size .mat-mdc-form-field-error-wrapper{position:static}.mat-mdc-form-field-bottom-align::before{content:"";display:inline-block;height:16px}.mat-mdc-form-field-bottom-align.mat-mdc-form-field-subscript-dynamic-size::before{content:unset}.mat-mdc-form-field-hint-end{order:1}.mat-mdc-form-field-hint-wrapper{display:flex}.mat-mdc-form-field-hint-spacer{flex:1 0 1em}.mat-mdc-form-field-error{display:block;color:var(--mat-form-field-error-text-color, var(--mat-sys-error))}.mat-mdc-form-field-subscript-wrapper,.mat-mdc-form-field-bottom-align::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-subscript-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-form-field-subscript-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-form-field-subscript-text-size, var(--mat-sys-body-small-size));letter-spacing:var(--mat-form-field-subscript-text-tracking, var(--mat-sys-body-small-tracking));font-weight:var(--mat-form-field-subscript-text-weight, var(--mat-sys-body-small-weight))}.mat-mdc-form-field-focus-overlay{top:0;left:0;right:0;bottom:0;position:absolute;opacity:0;pointer-events:none;background-color:var(--mat-form-field-state-layer-color, var(--mat-sys-on-surface))}.mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mat-mdc-form-field.mat-focused .mat-mdc-form-field-focus-overlay{opacity:var(--mat-form-field-focus-state-layer-opacity, 0)}select.mat-mdc-form-field-input-control{-moz-appearance:none;-webkit-appearance:none;background-color:rgba(0,0,0,0);display:inline-flex;box-sizing:border-box}select.mat-mdc-form-field-input-control:not(:disabled){cursor:pointer}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option{color:var(--mat-form-field-select-option-text-color, var(--mat-sys-neutral10))}select.mat-mdc-form-field-input-control:not(.mat-mdc-native-select-inline) option:disabled{color:var(--mat-form-field-select-disabled-option-text-color, color-mix(in srgb, var(--mat-sys-neutral10) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{content:"";width:0;height:0;border-left:5px solid rgba(0,0,0,0);border-right:5px solid rgba(0,0,0,0);border-top:5px solid;position:absolute;right:0;top:50%;margin-top:-2.5px;pointer-events:none;color:var(--mat-form-field-enabled-select-arrow-color, var(--mat-sys-on-surface-variant))}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-infix::after{right:auto;left:0}.mat-mdc-form-field-type-mat-native-select.mat-focused .mat-mdc-form-field-infix::after{color:var(--mat-form-field-focus-select-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field-type-mat-native-select.mat-form-field-disabled .mat-mdc-form-field-infix::after{color:var(--mat-form-field-disabled-select-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:15px}[dir=rtl] .mat-mdc-form-field-type-mat-native-select .mat-mdc-form-field-input-control{padding-right:0;padding-left:15px}@media(forced-colors: active){.mat-form-field-appearance-fill .mat-mdc-text-field-wrapper{outline:solid 1px}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-form-field-disabled .mat-mdc-text-field-wrapper{outline-color:GrayText}}@media(forced-colors: active){.mat-form-field-appearance-fill.mat-focused .mat-mdc-text-field-wrapper{outline:dashed 3px}}@media(forced-colors: active){.mat-mdc-form-field.mat-focused .mdc-notched-outline{border:dashed 3px}}.mat-mdc-form-field-input-control[type=date],.mat-mdc-form-field-input-control[type=datetime],.mat-mdc-form-field-input-control[type=datetime-local],.mat-mdc-form-field-input-control[type=month],.mat-mdc-form-field-input-control[type=week],.mat-mdc-form-field-input-control[type=time]{line-height:1}.mat-mdc-form-field-input-control::-webkit-datetime-edit{line-height:1;padding:0;margin-bottom:-2px}.mat-mdc-form-field{--mat-mdc-form-field-floating-label-scale: 0.75;display:inline-flex;flex-direction:column;min-width:0;text-align:left;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-form-field-container-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-form-field-container-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-form-field-container-text-size, var(--mat-sys-body-large-size));letter-spacing:var(--mat-form-field-container-text-tracking, var(--mat-sys-body-large-tracking));font-weight:var(--mat-form-field-container-text-weight, var(--mat-sys-body-large-weight))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-floating-label--float-above{font-size:calc(var(--mat-form-field-outlined-label-text-populated-size)*var(--mat-mdc-form-field-floating-label-scale))}.mat-mdc-form-field .mdc-text-field--outlined .mdc-notched-outline--upgraded .mdc-floating-label--float-above{font-size:var(--mat-form-field-outlined-label-text-populated-size)}[dir=rtl] .mat-mdc-form-field{text-align:right}.mat-mdc-form-field-flex{display:inline-flex;align-items:baseline;box-sizing:border-box;width:100%}.mat-mdc-text-field-wrapper{width:100%;z-index:0}.mat-mdc-form-field-icon-prefix,.mat-mdc-form-field-icon-suffix{align-self:center;line-height:0;pointer-events:auto;position:relative;z-index:1}.mat-mdc-form-field-icon-prefix>.mat-icon,.mat-mdc-form-field-icon-suffix>.mat-icon{padding:0 12px;box-sizing:content-box}.mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-leading-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-prefix{color:var(--mat-form-field-disabled-leading-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-trailing-icon-color, var(--mat-sys-on-surface-variant))}.mat-form-field-disabled .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-disabled-trailing-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-form-field-invalid .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-trailing-icon-color, var(--mat-sys-error))}.mat-form-field-invalid:not(.mat-focused):not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper:hover .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-hover-trailing-icon-color, var(--mat-sys-on-error-container))}.mat-form-field-invalid.mat-focused .mat-mdc-text-field-wrapper .mat-mdc-form-field-icon-suffix{color:var(--mat-form-field-error-focus-trailing-icon-color, var(--mat-sys-error))}.mat-mdc-form-field-icon-prefix,[dir=rtl] .mat-mdc-form-field-icon-suffix{padding:0 4px 0 0}.mat-mdc-form-field-icon-suffix,[dir=rtl] .mat-mdc-form-field-icon-prefix{padding:0 0 0 4px}.mat-mdc-form-field-subscript-wrapper .mat-icon,.mat-mdc-form-field label .mat-icon{width:1em;height:1em;font-size:inherit}.mat-mdc-form-field-infix{flex:auto;min-width:0;width:180px;position:relative;box-sizing:border-box}.mat-mdc-form-field-infix:has(textarea[cols]){width:auto}.mat-mdc-form-field .mdc-notched-outline__notch{margin-left:-1px;-webkit-clip-path:inset(-9em -999em -9em 1px);clip-path:inset(-9em -999em -9em 1px)}[dir=rtl] .mat-mdc-form-field .mdc-notched-outline__notch{margin-left:0;margin-right:-1px;-webkit-clip-path:inset(-9em 1px -9em -999em);clip-path:inset(-9em 1px -9em -999em)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-floating-label{transition:transform 150ms cubic-bezier(0.4, 0, 0.2, 1),color 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input{transition:opacity 150ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-moz-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input::-webkit-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field__input:-ms-input-placeholder{transition:opacity 67ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-moz-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-moz-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input::-webkit-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input::-webkit-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--no-label .mdc-text-field__input:-ms-input-placeholder,.mat-mdc-form-field:not(.mat-form-field-no-animations).mdc-text-field--focused .mdc-text-field__input:-ms-input-placeholder{transition-delay:40ms;transition-duration:110ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-text-field--filled:not(.mdc-ripple-upgraded):focus .mdc-text-field__ripple::before{transition-duration:75ms}.mat-mdc-form-field:not(.mat-form-field-no-animations) .mdc-line-ripple::after{transition:transform 180ms cubic-bezier(0.4, 0, 0.2, 1),opacity 180ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-notched-outline .mdc-floating-label{max-width:calc(100% + 1px)}.mdc-notched-outline--upgraded .mdc-floating-label--float-above{max-width:calc(133.3333333333% + 1px)}'],encapsulation:2,data:{animation:[lde.transitionMessages]},changeDetection:0})}return e})(),PO=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,fO,or]})}return e})();const hde=new ct("MAT_INPUT_VALUE_ACCESSOR"),fde=["button","checkbox","file","hidden","image","radio","range","reset","submit"],pde=new ct("MAT_INPUT_CONFIG");let mde=(()=>{class e{_elementRef=re(In);_platform=re(Hs);ngControl=re(Kf,{optional:!0,self:!0});_autofillMonitor=re(Mce);_ngZone=re(Ht);_formField=re(RO,{optional:!0});_renderer=re(Ns);_uid=re(du).getId("mat-input-");_previousNativeValue;_inputValueAccessor;_signalBasedValueAccessor;_previousPlaceholder;_errorStateTracker;_config=re(pde,{optional:!0});_cleanupIosKeyup;_cleanupWebkitWheel;_formFieldDescribedBy;_isServer;_isNativeSelect;_isTextarea;_isInFormField;focused=!1;stateChanges=new Ie;controlType="mat-input";autofilled=!1;get disabled(){return this._disabled}set disabled(t){this._disabled=Fc(t),this.focused&&(this.focused=!1,this.stateChanges.next())}_disabled=!1;get id(){return this._id}set id(t){this._id=t||this._uid}_id;placeholder;name;get required(){return this._required??this.ngControl?.control?.hasValidator(gU.required)??!1}set required(t){this._required=Fc(t)}_required;get type(){return this._type}set type(t){const i=this._type;this._type=t||"text",this._validateType(),!this._isTextarea&&$j().has(this._type)&&(this._elementRef.nativeElement.type=this._type),this._type!==i&&this._ensureWheelDefaultBehavior()}_type="text";get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(t){this._errorStateTracker.matcher=t}userAriaDescribedBy;get value(){return this._signalBasedValueAccessor?this._signalBasedValueAccessor.value():this._inputValueAccessor.value}set value(t){t!==this.value&&(this._signalBasedValueAccessor?this._signalBasedValueAccessor.value.set(t):this._inputValueAccessor.value=t,this.stateChanges.next())}get readonly(){return this._readonly}set readonly(t){this._readonly=Fc(t)}_readonly=!1;disabledInteractive;get errorState(){return this._errorStateTracker.errorState}set errorState(t){this._errorStateTracker.errorState=t}_neverEmptyInputTypes=["date","datetime","datetime-local","month","time","week"].filter(t=>$j().has(t));constructor(){const t=re(FC,{optional:!0}),i=re(LC,{optional:!0}),r=re(gH),a=re(hde,{optional:!0,self:!0}),h=this._elementRef.nativeElement,v=h.nodeName.toLowerCase();a?W0(a.value)?this._signalBasedValueAccessor=a:this._inputValueAccessor=a:this._inputValueAccessor=h,this._previousNativeValue=this.value,this.id=this.id,this._platform.IOS&&this._ngZone.runOutsideAngular(()=>{this._cleanupIosKeyup=this._renderer.listen(h,"keyup",this._iOSKeyupListener)}),this._errorStateTracker=new mH(r,this.ngControl,i,t,this.stateChanges),this._isServer=!this._platform.isBrowser,this._isNativeSelect="select"===v,this._isTextarea="textarea"===v,this._isInFormField=!!this._formField,this.disabledInteractive=this._config?.disabledInteractive||!1,this._isNativeSelect&&(this.controlType=h.multiple?"mat-native-select-multiple":"mat-native-select"),this._signalBasedValueAccessor&&uE(()=>{this._signalBasedValueAccessor.value(),this.stateChanges.next()})}ngAfterViewInit(){this._platform.isBrowser&&this._autofillMonitor.monitor(this._elementRef.nativeElement).subscribe(t=>{this.autofilled=t.isAutofilled,this.stateChanges.next()})}ngOnChanges(){this.stateChanges.next()}ngOnDestroy(){this.stateChanges.complete(),this._platform.isBrowser&&this._autofillMonitor.stopMonitoring(this._elementRef.nativeElement),this._cleanupIosKeyup?.(),this._cleanupWebkitWheel?.()}ngDoCheck(){this.ngControl&&(this.updateErrorState(),null!==this.ngControl.disabled&&this.ngControl.disabled!==this.disabled&&(this.disabled=this.ngControl.disabled,this.stateChanges.next())),this._dirtyCheckNativeValue(),this._dirtyCheckPlaceholder()}focus(t){this._elementRef.nativeElement.focus(t)}updateErrorState(){this._errorStateTracker.updateErrorState()}_focusChanged(t){if(t!==this.focused){if(!this._isNativeSelect&&t&&this.disabled&&this.disabledInteractive){const i=this._elementRef.nativeElement;"number"===i.type?(i.type="text",i.setSelectionRange(0,0),i.type="number"):i.setSelectionRange(0,0)}this.focused=t,this.stateChanges.next()}}_onInput(){}_dirtyCheckNativeValue(){const t=this._elementRef.nativeElement.value;this._previousNativeValue!==t&&(this._previousNativeValue=t,this.stateChanges.next())}_dirtyCheckPlaceholder(){const t=this._getPlaceholder();if(t!==this._previousPlaceholder){const i=this._elementRef.nativeElement;this._previousPlaceholder=t,t?i.setAttribute("placeholder",t):i.removeAttribute("placeholder")}}_getPlaceholder(){return this.placeholder||null}_validateType(){fde.indexOf(this._type)}_isNeverEmpty(){return this._neverEmptyInputTypes.indexOf(this._type)>-1}_isBadInput(){let t=this._elementRef.nativeElement.validity;return t&&t.badInput}get empty(){return!(this._isNeverEmpty()||this._elementRef.nativeElement.value||this._isBadInput()||this.autofilled)}get shouldLabelFloat(){if(this._isNativeSelect){const t=this._elementRef.nativeElement,i=t.options[0];return this.focused||t.multiple||!this.empty||!!(t.selectedIndex>-1&&i&&i.label)}return this.focused&&!this.disabled||!this.empty}setDescribedByIds(t){const i=this._elementRef.nativeElement,r=i.getAttribute("aria-describedby");let a;if(r){const h=this._formFieldDescribedBy||t;a=t.concat(r.split(" ").filter(v=>v&&!h.includes(v)))}else a=t;this._formFieldDescribedBy=t,a.length?i.setAttribute("aria-describedby",a.join(" ")):i.removeAttribute("aria-describedby")}onContainerClick(){this.focused||this.focus()}_isInlineSelect(){const t=this._elementRef.nativeElement;return this._isNativeSelect&&(t.multiple||t.size>1)}_iOSKeyupListener=t=>{const i=t.target;!i.value&&0===i.selectionStart&&0===i.selectionEnd&&(i.setSelectionRange(1,1),i.setSelectionRange(0,0))};_webkitBlinkWheelListener=()=>{};_ensureWheelDefaultBehavior(){this._cleanupWebkitWheel?.(),"number"===this._type&&(this._platform.BLINK||this._platform.WEBKIT)&&(this._cleanupWebkitWheel=this._renderer.listen(this._elementRef.nativeElement,"wheel",this._webkitBlinkWheelListener))}_getReadonlyAttribute(){return this._isNativeSelect?null:this.readonly||this.disabled&&this.disabledInteractive?"true":null}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["input","matInput",""],["textarea","matInput",""],["select","matNativeControl",""],["input","matNativeControl",""],["textarea","matNativeControl",""]],hostAttrs:[1,"mat-mdc-input-element"],hostVars:21,hostBindings:function(i,r){1&i&&Nn("focus",function(){return r._focusChanged(!0)})("blur",function(){return r._focusChanged(!1)})("input",function(){return r._onInput()}),2&i&&(ax("id",r.id)("disabled",r.disabled&&!r.disabledInteractive)("required",r.required),ui("name",r.name||null)("readonly",r._getReadonlyAttribute())("aria-disabled",r.disabled&&r.disabledInteractive?"true":null)("aria-invalid",r.empty&&r.required?null:r.errorState)("aria-required",r.required)("id",r.id),Ti("mat-input-server",r._isServer)("mat-mdc-form-field-textarea-control",r._isInFormField&&r._isTextarea)("mat-mdc-form-field-input-control",r._isInFormField)("mat-mdc-input-disabled-interactive",r.disabledInteractive)("mdc-text-field__input",r._isInFormField)("mat-mdc-native-select-inline",r._isInlineSelect()))},inputs:{disabled:"disabled",id:"id",placeholder:"placeholder",name:"name",required:"required",type:"type",errorStateMatcher:"errorStateMatcher",userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],value:"value",readonly:"readonly",disabledInteractive:[2,"disabledInteractive","disabledInteractive",zn]},exportAs:["matInput"],features:[Jn([{provide:AO,useExisting:e}]),jr,sr]})}return e})(),n6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,PO,PO,Sce,or]})}return e})(),gde=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,or]})}return e})();class i6{}function OO(e){return e&&"function"==typeof e.connect&&!(e instanceof oP)}var Fm=function(e){return e[e.REPLACED=0]="REPLACED",e[e.INSERTED=1]="INSERTED",e[e.MOVED=2]="MOVED",e[e.REMOVED=3]="REMOVED",e}(Fm||{});const YC=new ct("_ViewRepeater");class r6{applyChanges(n,t,i,r,a){n.forEachOperation((h,v,C)=>{let P,L;if(null==h.previousIndex){const V=i(h,v,C);P=t.createEmbeddedView(V.templateRef,V.context,V.index),L=Fm.INSERTED}else null==C?(t.remove(v),L=Fm.REMOVED):(P=t.get(v),t.move(P,C),L=Fm.MOVED);a&&a({context:P?.context,operation:L,record:h})})}detach(){}}class FO{_multiple;_emitChanges;compareWith;_selection=new Set;_deselectedToEmit=[];_selectedToEmit=[];_selected;get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}changed=new Ie;constructor(n=!1,t,i=!0,r){this._multiple=n,this._emitChanges=i,this.compareWith=r,t&&t.length&&(n?t.forEach(a=>this._markSelected(a)):this._markSelected(t[0]),this._selectedToEmit.length=0)}select(...n){this._verifyValueAssignment(n),n.forEach(i=>this._markSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}deselect(...n){this._verifyValueAssignment(n),n.forEach(i=>this._unmarkSelected(i));const t=this._hasQueuedChanges();return this._emitChangeEvent(),t}setSelection(...n){this._verifyValueAssignment(n);const t=this.selected,i=new Set(n);n.forEach(a=>this._markSelected(a)),t.filter(a=>!i.has(this._getConcreteValue(a,i))).forEach(a=>this._unmarkSelected(a));const r=this._hasQueuedChanges();return this._emitChangeEvent(),r}toggle(n){return this.isSelected(n)?this.deselect(n):this.select(n)}clear(n=!0){this._unmarkAll();const t=this._hasQueuedChanges();return n&&this._emitChangeEvent(),t}isSelected(n){return this._selection.has(this._getConcreteValue(n))}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(n){this._multiple&&this.selected&&this._selected.sort(n)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(n){n=this._getConcreteValue(n),this.isSelected(n)||(this._multiple||this._unmarkAll(),this.isSelected(n)||this._selection.add(n),this._emitChanges&&this._selectedToEmit.push(n))}_unmarkSelected(n){n=this._getConcreteValue(n),this.isSelected(n)&&(this._selection.delete(n),this._emitChanges&&this._deselectedToEmit.push(n))}_unmarkAll(){this.isEmpty()||this._selection.forEach(n=>this._unmarkSelected(n))}_verifyValueAssignment(n){}_hasQueuedChanges(){return!(!this._deselectedToEmit.length&&!this._selectedToEmit.length)}_getConcreteValue(n,t){if(this.compareWith){t=t??this._selection;for(let i of t)if(this.compareWith(n,i))return i;return n}return n}}let s6=(()=>{class e{_listeners=[];notify(t,i){for(let r of this._listeners)r(t,i)}listen(t){return this._listeners.push(t),()=>{this._listeners=this._listeners.filter(i=>t!==i)}}ngOnDestroy(){this._listeners=[]}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const a6=["*"],Bde=new ct("MAT_LIST_CONFIG");let XC=(()=>{class e{_isNonInteractive=!0;get disableRipple(){return this._disableRipple}set disableRipple(t){this._disableRipple=Fc(t)}_disableRipple=!1;get disabled(){return this._disabled}set disabled(t){this._disabled=Fc(t)}_disabled=!1;_defaultOptions=re(Bde,{optional:!0});static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,hostVars:1,hostBindings:function(i,r){2&i&&ui("aria-disabled",r.disabled)},inputs:{disableRipple:"disableRipple",disabled:"disabled"}})}return e})(),Ude=(()=>{class e extends XC{_isNonInteractive=!1;static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275cmp=Ln({type:e,selectors:[["mat-nav-list"]],hostAttrs:["role","navigation",1,"mat-mdc-nav-list","mat-mdc-list-base","mdc-list"],exportAs:["matNavList"],features:[Jn([{provide:XC,useExisting:e}]),Gn],ngContentSelectors:a6,decls:1,vars:0,template:function(i,r){1&i&&(zo(),ai(0))},styles:['.mdc-list{margin:0;padding:8px 0;list-style-type:none}.mdc-list:focus{outline:none}.mdc-list-item{display:flex;position:relative;justify-content:flex-start;overflow:hidden;padding:0;align-items:stretch;cursor:pointer;padding-left:16px;padding-right:16px;background-color:var(--mdc-list-list-item-container-color, transparent);border-radius:var(--mdc-list-list-item-container-shape, var(--mat-sys-corner-none))}.mdc-list-item.mdc-list-item--selected{background-color:var(--mdc-list-list-item-selected-container-color)}.mdc-list-item:focus{outline:0}.mdc-list-item.mdc-list-item--disabled{cursor:auto}.mdc-list-item.mdc-list-item--with-one-line{height:var(--mdc-list-list-item-one-line-container-height, 48px)}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__start{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-one-line .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-two-lines{height:var(--mdc-list-list-item-two-line-container-height, 64px)}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-two-lines .mdc-list-item__end{align-self:center;margin-top:0}.mdc-list-item.mdc-list-item--with-three-lines{height:var(--mdc-list-list-item-three-line-container-height, 88px)}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__start{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:16px}.mdc-list-item.mdc-list-item--selected::before,.mdc-list-item.mdc-list-item--selected:focus::before,.mdc-list-item:not(.mdc-list-item--selected):focus::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;content:"";pointer-events:none}a.mdc-list-item{color:inherit;text-decoration:none}.mdc-list-item__start{fill:currentColor;flex-shrink:0;pointer-events:none}.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-leading-icon-color, var(--mat-sys-on-surface-variant));width:var(--mdc-list-list-item-leading-icon-size, 24px);height:var(--mdc-list-list-item-leading-icon-size, 24px);margin-left:16px;margin-right:32px}[dir=rtl] .mdc-list-item--with-leading-icon .mdc-list-item__start{margin-left:32px;margin-right:16px}.mdc-list-item--with-leading-icon:hover .mdc-list-item__start{color:var(--mdc-list-list-item-hover-leading-icon-color)}.mdc-list-item--with-leading-avatar .mdc-list-item__start{width:var(--mdc-list-list-item-leading-avatar-size, 40px);height:var(--mdc-list-list-item-leading-avatar-size, 40px);margin-left:16px;margin-right:16px;border-radius:50%}.mdc-list-item--with-leading-avatar .mdc-list-item__start,[dir=rtl] .mdc-list-item--with-leading-avatar .mdc-list-item__start{margin-left:16px;margin-right:16px;border-radius:50%}.mdc-list-item__end{flex-shrink:0;pointer-events:none}.mdc-list-item--with-trailing-meta .mdc-list-item__end{font-family:var(--mdc-list-list-item-trailing-supporting-text-font, var(--mat-sys-label-small-font));line-height:var(--mdc-list-list-item-trailing-supporting-text-line-height, var(--mat-sys-label-small-line-height));font-size:var(--mdc-list-list-item-trailing-supporting-text-size, var(--mat-sys-label-small-size));font-weight:var(--mdc-list-list-item-trailing-supporting-text-weight, var(--mat-sys-label-small-weight));letter-spacing:var(--mdc-list-list-item-trailing-supporting-text-tracking, var(--mat-sys-label-small-tracking))}.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-icon-color, var(--mat-sys-on-surface-variant));width:var(--mdc-list-list-item-trailing-icon-size, 24px);height:var(--mdc-list-list-item-trailing-icon-size, 24px)}.mdc-list-item--with-trailing-icon:hover .mdc-list-item__end{color:var(--mdc-list-list-item-hover-trailing-icon-color)}.mdc-list-item.mdc-list-item--with-trailing-meta .mdc-list-item__end{color:var(--mdc-list-list-item-trailing-supporting-text-color, var(--mat-sys-on-surface-variant))}.mdc-list-item--selected.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-selected-trailing-icon-color, var(--mat-sys-primary))}.mdc-list-item__content{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;align-self:center;flex:1;pointer-events:none}.mdc-list-item--with-two-lines .mdc-list-item__content,.mdc-list-item--with-three-lines .mdc-list-item__content{align-self:stretch}.mdc-list-item__primary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;color:var(--mdc-list-list-item-label-text-color, var(--mat-sys-on-surface));font-family:var(--mdc-list-list-item-label-text-font, var(--mat-sys-body-large-font));line-height:var(--mdc-list-list-item-label-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mdc-list-list-item-label-text-size, var(--mat-sys-body-large-size));font-weight:var(--mdc-list-list-item-label-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mdc-list-list-item-label-text-tracking, var(--mat-sys-body-large-tracking))}.mdc-list-item:hover .mdc-list-item__primary-text{color:var(--mdc-list-list-item-hover-label-text-color, var(--mat-sys-on-surface))}.mdc-list-item:focus .mdc-list-item__primary-text{color:var(--mdc-list-list-item-focus-label-text-color, var(--mat-sys-on-surface))}.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-three-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-three-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item__secondary-text{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;margin-top:0;color:var(--mdc-list-list-item-supporting-text-color, var(--mat-sys-on-surface-variant));font-family:var(--mdc-list-list-item-supporting-text-font, var(--mat-sys-body-medium-font));line-height:var(--mdc-list-list-item-supporting-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mdc-list-list-item-supporting-text-size, var(--mat-sys-body-medium-size));font-weight:var(--mdc-list-list-item-supporting-text-weight, var(--mat-sys-body-medium-weight));letter-spacing:var(--mdc-list-list-item-supporting-text-tracking, var(--mat-sys-body-medium-tracking))}.mdc-list-item__secondary-text::before{display:inline-block;width:0;height:20px;content:"";vertical-align:0}.mdc-list-item--with-three-lines .mdc-list-item__secondary-text{white-space:normal;line-height:20px}.mdc-list-item--with-overline .mdc-list-item__secondary-text{white-space:nowrap;line-height:auto}.mdc-list-item--with-leading-radio.mdc-list-item,.mdc-list-item--with-leading-checkbox.mdc-list-item,.mdc-list-item--with-leading-icon.mdc-list-item,.mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:0;padding-right:16px}[dir=rtl] .mdc-list-item--with-leading-radio.mdc-list-item,[dir=rtl] .mdc-list-item--with-leading-checkbox.mdc-list-item,[dir=rtl] .mdc-list-item--with-leading-icon.mdc-list-item,[dir=rtl] .mdc-list-item--with-leading-avatar.mdc-list-item{padding-left:16px;padding-right:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text{display:block;margin-top:0;line-height:normal;margin-bottom:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines .mdc-list-item__primary-text::after{display:inline-block;width:0;height:20px;content:"";vertical-align:-20px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end{display:block;margin-top:0;line-height:normal}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before,.mdc-list-item--with-leading-icon.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before,.mdc-list-item--with-leading-avatar.mdc-list-item--with-two-lines.mdc-list-item--with-trailing-meta .mdc-list-item__end::before{display:inline-block;width:0;height:32px;content:"";vertical-align:0}.mdc-list-item--with-trailing-icon.mdc-list-item,[dir=rtl] .mdc-list-item--with-trailing-icon.mdc-list-item{padding-left:0;padding-right:0}.mdc-list-item--with-trailing-icon .mdc-list-item__end{margin-left:16px;margin-right:16px}.mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:16px;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-meta.mdc-list-item{padding-left:0;padding-right:16px}.mdc-list-item--with-trailing-meta .mdc-list-item__end{-webkit-user-select:none;user-select:none;margin-left:28px;margin-right:16px}[dir=rtl] .mdc-list-item--with-trailing-meta .mdc-list-item__end{margin-left:16px;margin-right:28px}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end,.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end{display:block;line-height:normal;align-self:flex-start;margin-top:0}.mdc-list-item--with-trailing-meta.mdc-list-item--with-three-lines .mdc-list-item__end::before,.mdc-list-item--with-trailing-meta.mdc-list-item--with-two-lines .mdc-list-item__end::before{display:inline-block;width:0;height:28px;content:"";vertical-align:0}.mdc-list-item--with-leading-radio .mdc-list-item__start,.mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:8px;margin-right:24px}[dir=rtl] .mdc-list-item--with-leading-radio .mdc-list-item__start,[dir=rtl] .mdc-list-item--with-leading-checkbox .mdc-list-item__start{margin-left:24px;margin-right:8px}.mdc-list-item--with-leading-radio.mdc-list-item--with-two-lines .mdc-list-item__start,.mdc-list-item--with-leading-checkbox.mdc-list-item--with-two-lines .mdc-list-item__start{align-self:flex-start;margin-top:8px}.mdc-list-item--with-trailing-radio.mdc-list-item,.mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:16px;padding-right:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item,[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item{padding-left:0;padding-right:16px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-icon,.mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-avatar,.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-icon,.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-avatar{padding-left:0}[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-icon,[dir=rtl] .mdc-list-item--with-trailing-radio.mdc-list-item--with-leading-avatar,[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-icon,[dir=rtl] .mdc-list-item--with-trailing-checkbox.mdc-list-item--with-leading-avatar{padding-right:0}.mdc-list-item--with-trailing-radio .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:24px;margin-right:8px}[dir=rtl] .mdc-list-item--with-trailing-radio .mdc-list-item__end,[dir=rtl] .mdc-list-item--with-trailing-checkbox .mdc-list-item__end{margin-left:8px;margin-right:24px}.mdc-list-item--with-trailing-radio.mdc-list-item--with-three-lines .mdc-list-item__end,.mdc-list-item--with-trailing-checkbox.mdc-list-item--with-three-lines .mdc-list-item__end{align-self:flex-start;margin-top:8px}.mdc-list-group__subheader{margin:.75rem 16px}.mdc-list-item--disabled .mdc-list-item__start,.mdc-list-item--disabled .mdc-list-item__content,.mdc-list-item--disabled .mdc-list-item__end{opacity:1}.mdc-list-item--disabled .mdc-list-item__primary-text,.mdc-list-item--disabled .mdc-list-item__secondary-text{opacity:var(--mdc-list-list-item-disabled-label-text-opacity, 0.3)}.mdc-list-item--disabled.mdc-list-item--with-leading-icon .mdc-list-item__start{color:var(--mdc-list-list-item-disabled-leading-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-list-list-item-disabled-leading-icon-opacity, 0.38)}.mdc-list-item--disabled.mdc-list-item--with-trailing-icon .mdc-list-item__end{color:var(--mdc-list-list-item-disabled-trailing-icon-color, var(--mat-sys-on-surface));opacity:var(--mdc-list-list-item-disabled-trailing-icon-opacity, 0.38)}.mat-mdc-list-item.mat-mdc-list-item-both-leading-and-trailing,[dir=rtl] .mat-mdc-list-item.mat-mdc-list-item-both-leading-and-trailing{padding-left:0;padding-right:0}.mdc-list-item.mdc-list-item--disabled .mdc-list-item__primary-text{color:var(--mdc-list-list-item-disabled-label-text-color, var(--mat-sys-on-surface))}.mdc-list-item:hover::before{background-color:var(--mdc-list-list-item-hover-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mdc-list-list-item-hover-state-layer-opacity, var(--mat-sys-hover-state-layer-opacity))}.mdc-list-item.mdc-list-item--disabled::before{background-color:var(--mdc-list-list-item-disabled-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mdc-list-list-item-disabled-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-list-item:focus::before{background-color:var(--mdc-list-list-item-focus-state-layer-color, var(--mat-sys-on-surface));opacity:var(--mdc-list-list-item-focus-state-layer-opacity, var(--mat-sys-focus-state-layer-opacity))}.mdc-list-item--disabled .mdc-radio,.mdc-list-item--disabled .mdc-checkbox{opacity:var(--mdc-list-list-item-disabled-label-text-opacity, 0.3)}.mdc-list-item--with-leading-avatar .mat-mdc-list-item-avatar{border-radius:var(--mdc-list-list-item-leading-avatar-shape, var(--mat-sys-corner-full));background-color:var(--mdc-list-list-item-leading-avatar-color, var(--mat-sys-primary-container))}.mat-mdc-list-item-icon{font-size:var(--mdc-list-list-item-leading-icon-size, 24px)}@media(forced-colors: active){a.mdc-list-item--activated::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}a.mdc-list-item--activated [dir=rtl]::after{right:auto;left:16px}}.mat-mdc-list-base{display:block}.mat-mdc-list-base .mdc-list-item__start,.mat-mdc-list-base .mdc-list-item__end,.mat-mdc-list-base .mdc-list-item__content{pointer-events:auto}.mat-mdc-list-item,.mat-mdc-list-option{width:100%;box-sizing:border-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-list-item:not(.mat-mdc-list-item-interactive),.mat-mdc-list-option:not(.mat-mdc-list-item-interactive){cursor:default}.mat-mdc-list-item .mat-divider-inset,.mat-mdc-list-option .mat-divider-inset{position:absolute;left:0;right:0;bottom:0}.mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,.mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-left:72px}[dir=rtl] .mat-mdc-list-item .mat-mdc-list-item-avatar~.mat-divider-inset,[dir=rtl] .mat-mdc-list-option .mat-mdc-list-item-avatar~.mat-divider-inset{margin-right:72px}.mat-mdc-list-item-interactive::before{top:0;left:0;right:0;bottom:0;position:absolute;content:"";opacity:0;pointer-events:none;border-radius:inherit}.mat-mdc-list-item>.mat-focus-indicator{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-mdc-list-item:focus>.mat-focus-indicator::before{content:""}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-line.mdc-list-item__secondary-text{white-space:nowrap;line-height:normal}.mat-mdc-list-item.mdc-list-item--with-three-lines .mat-mdc-list-item-unscoped-content.mdc-list-item__secondary-text{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2}mat-action-list button{background:none;color:inherit;border:none;font:inherit;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:start}mat-action-list button::-moz-focus-inner{border:0}.mdc-list-item--with-leading-icon .mdc-list-item__start{margin-inline-start:var(--mat-list-list-item-leading-icon-start-space, 16px);margin-inline-end:var(--mat-list-list-item-leading-icon-end-space, 16px)}.mat-mdc-nav-list .mat-mdc-list-item{border-radius:var(--mat-list-active-indicator-shape, var(--mat-sys-corner-full));--mat-focus-indicator-border-radius:var(--mat-list-active-indicator-shape, var(--mat-sys-corner-full))}.mat-mdc-nav-list .mat-mdc-list-item.mdc-list-item--activated{background-color:var(--mat-list-active-indicator-color, var(--mat-sys-secondary-container))}'],encapsulation:2,changeDetection:0})}return e})(),f6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[fO,or,GC,wH,gde]})}return e})();class LO{_attachedHost;attach(n){return this._attachedHost=n,n.attach(this)}detach(){let n=this._attachedHost;null!=n&&(this._attachedHost=null,n.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(n){this._attachedHost=n}}class p6 extends LO{component;viewContainerRef;injector;componentFactoryResolver;projectableNodes;constructor(n,t,i,r,a){super(),this.component=n,this.viewContainerRef=t,this.injector=i,this.projectableNodes=a}}class eI extends LO{templateRef;viewContainerRef;context;injector;constructor(n,t,i,r){super(),this.templateRef=n,this.viewContainerRef=t,this.context=i,this.injector=r}get origin(){return this.templateRef.elementRef}attach(n,t=this.context){return this.context=t,super.attach(n)}detach(){return this.context=void 0,super.detach()}}class Gde extends LO{element;constructor(n){super(),this.element=n instanceof In?n.nativeElement:n}}class m6{_attachedPortal;_disposeFn;_isDisposed=!1;hasAttached(){return!!this._attachedPortal}attach(n){return n instanceof p6?(this._attachedPortal=n,this.attachComponentPortal(n)):n instanceof eI?(this._attachedPortal=n,this.attachTemplatePortal(n)):this.attachDomPortal&&n instanceof Gde?(this._attachedPortal=n,this.attachDomPortal(n)):void 0}attachDomPortal=null;detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(n){this._disposeFn=n}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class qde extends m6{outletElement;_appRef;_defaultInjector;_document;constructor(n,t,i,r,a){super(),this.outletElement=n,this._appRef=i,this._defaultInjector=r,this._document=a}attachComponentPortal(n){let t;if(n.viewContainerRef){const i=n.injector||n.viewContainerRef.injector,r=i.get(bm,null,{optional:!0})||void 0;t=n.viewContainerRef.createComponent(n.component,{index:n.viewContainerRef.length,injector:i,ngModuleRef:r,projectableNodes:n.projectableNodes||void 0}),this.setDisposeFn(()=>t.destroy())}else t=lV(n.component,{elementInjector:n.injector||this._defaultInjector||Ye.NULL,environmentInjector:this._appRef.injector,projectableNodes:n.projectableNodes||void 0}),this._appRef.attachView(t.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(t.hostView),t.destroy()});return this.outletElement.appendChild(this._getComponentRootNode(t)),this._attachedPortal=n,t}attachTemplatePortal(n){let t=n.viewContainerRef,i=t.createEmbeddedView(n.templateRef,n.context,{injector:n.injector});return i.rootNodes.forEach(r=>this.outletElement.appendChild(r)),i.detectChanges(),this.setDisposeFn(()=>{let r=t.indexOf(i);-1!==r&&t.remove(r)}),this._attachedPortal=n,i}attachDomPortal=n=>{const t=n.element,i=this._document.createComment("dom-portal");t.parentNode.insertBefore(i,t),this.outletElement.appendChild(t),this._attachedPortal=n,super.setDisposeFn(()=>{i.parentNode&&i.parentNode.replaceChild(t,i)})};dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(n){return n.hostView.rootNodes[0]}}let Wde=(()=>{class e extends m6{_moduleRef=re(bm,{optional:!0});_document=re(ir);_viewContainerRef=re(ms);_isInitialized=!1;_attachedRef;constructor(){super()}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}attached=new Dt;get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,r=i.createComponent(t.component,{index:i.length,injector:t.injector||i.injector,projectableNodes:t.projectableNodes||void 0,ngModuleRef:this._moduleRef||void 0});return i!==this._viewContainerRef&&this._getRootNode().appendChild(r.hostView.rootNodes[0]),super.setDisposeFn(()=>r.destroy()),this._attachedPortal=t,this._attachedRef=r,this.attached.emit(r),r}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}attachDomPortal=t=>{const i=t.element,r=this._document.createComment("dom-portal");t.setAttachedHost(this),i.parentNode.insertBefore(r,i),this._getRootNode().appendChild(i),this._attachedPortal=t,super.setDisposeFn(()=>{r.parentNode&&r.parentNode.replaceChild(i,r)})};_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:[0,"cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Gn]})}return e})(),g6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();const Zde=["addListener","removeListener"],Yde=["addEventListener","removeEventListener"],Xde=["on","off"];function NO(e,n,t,i){if(pi(t)&&(i=t,t=void 0),i)return NO(e,n,t).pipe(nP(i));const[r,a]=function Jde(e){return pi(e.addEventListener)&&pi(e.removeEventListener)}(e)?Yde.map(h=>v=>e[h](n,v,t)):function Kde(e){return pi(e.addListener)&&pi(e.removeListener)}(e)?Zde.map(_6(e,n)):function Qde(e){return pi(e.on)&&pi(e.off)}(e)?Xde.map(_6(e,n)):[];if(!r&&eP(e))return Ka(h=>NO(h,n,t))(ec(e));if(!r)throw new TypeError("Invalid event target");return new Ce(h=>{const v=(...C)=>h.next(1<C.length?C:C[0]);return r(v),()=>a(v)})}function _6(e,n){return t=>i=>e[t](n,i)}const KC={schedule(e){let n=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=KC;i&&(n=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=n(a=>{t=void 0,e(a)});return new Ni(()=>t?.(r))},requestAnimationFrame(...e){const{delegate:n}=KC;return(n?.requestAnimationFrame||requestAnimationFrame)(...e)},cancelAnimationFrame(...e){const{delegate:n}=KC;return(n?.cancelAnimationFrame||cancelAnimationFrame)(...e)},delegate:void 0},y6=new class tue extends uO{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class eue extends cO{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=KC.requestAnimationFrame(()=>n.flush(void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:a}=n;null!=t&&(null===(r=a[a.length-1])||void 0===r?void 0:r.id)!==t&&(KC.cancelAnimationFrame(t),n._scheduled=void 0)}});let zO,nue=1;const tI={};function v6(e){return e in tI&&(delete tI[e],!0)}const iue={setImmediate(e){const n=nue++;return tI[n]=!0,zO||(zO=Promise.resolve()),zO.then(()=>v6(n)&&e()),n},clearImmediate(e){v6(e)}},{setImmediate:rue,clearImmediate:oue}=iue,nI={setImmediate(...e){const{delegate:n}=nI;return(n?.setImmediate||rue)(...e)},clearImmediate(e){const{delegate:n}=nI;return(n?.clearImmediate||oue)(e)},delegate:void 0};new class aue extends uO{flush(n){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;n=n||i.shift();do{if(r=n.execute(n.state,n.delay))break}while((n=i[0])&&n.id===t&&i.shift());if(this._active=!1,r){for(;(n=i[0])&&n.id===t&&i.shift();)n.unsubscribe();throw r}}}(class sue extends cO{constructor(n,t){super(n,t),this.scheduler=n,this.work=t}requestAsyncId(n,t,i=0){return null!==i&&i>0?super.requestAsyncId(n,t,i):(n.actions.push(this),n._scheduled||(n._scheduled=nI.setImmediate(n.flush.bind(n,void 0))))}recycleAsyncId(n,t,i=0){var r;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(n,t,i);const{actions:a}=n;null!=t&&(null===(r=a[a.length-1])||void 0===r?void 0:r.id)!==t&&(nI.clearImmediate(t),n._scheduled===t&&(n._scheduled=void 0))}});function b6(e=0,n,t=Nae){let i=-1;return null!=n&&(o5(n)?t=n:i=n),new Ce(r=>{let a=function due(e){return e instanceof Date&&!isNaN(e)}(e)?+e-t.now():e;a<0&&(a=0);let h=0;return t.schedule(function(){r.closed||(r.next(h++),0<=i?this.schedule(void 0,i):r.complete())},a)})}function x6(e,n=ND){return function cue(e){return Tt((n,t)=>{let i=!1,r=null,a=null,h=!1;const v=()=>{if(a?.unsubscribe(),a=null,i){i=!1;const P=r;r=null,t.next(P)}h&&t.complete()},C=()=>{a=null,h&&t.complete()};n.subscribe(Mt(t,P=>{i=!0,r=P,a||ec(e(P)).subscribe(a=Mt(t,v,C))},()=>{h=!0,(!i||!a||a.closed)&&t.complete()}))})}(()=>b6(e,n))}let BO=(()=>{class e{_ngZone=re(Ht);_platform=re(Hs);_document=re(ir,{optional:!0});constructor(){}_scrolled=new Ie;_globalSubscription=null;_scrolledCount=0;scrollContainers=new Map;register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Ce(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe(x6(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):vn()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(is(a=>!a||r.indexOf(a)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,a)=>{this._scrollableContainsElement(a,t)&&i.push(a)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=xl(i),a=t.getElementRef().nativeElement;do{if(r==a)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>NO(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),QC=(()=>{class e{_platform=re(Hs);_listeners;_viewportSize;_change=new Ie;_document=re(ir,{optional:!0});constructor(){const t=re(Ht),i=re(ua).createRenderer(null,null);t.runOutsideAngular(()=>{if(this._platform.isBrowser){const r=a=>this._change.next(a);this._listeners=[i.listen("window","resize",r),i.listen("window","orientationchange",r)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(t=>t()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,a=r.getBoundingClientRect();return{top:-a.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-a.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(x6(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),O_=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})(),VO=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[HC,O_,HC,O_]})}return e})();const w6=bae();class pue{_viewportRuler;_previousHTMLStyles={top:"",left:""};_previousScrollPosition;_isEnabled=!1;_document;constructor(n,t){this._viewportRuler=n,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const n=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=n.style.left||"",this._previousHTMLStyles.top=n.style.top||"",n.style.left=$s(-this._previousScrollPosition.left),n.style.top=$s(-this._previousScrollPosition.top),n.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const n=this._document.documentElement,i=n.style,r=this._document.body.style,a=i.scrollBehavior||"",h=r.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,n.classList.remove("cdk-global-scrollblock"),w6&&(i.scrollBehavior=r.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),w6&&(i.scrollBehavior=a,r.scrollBehavior=h)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class mue{_scrollDispatcher;_ngZone;_viewportRuler;_config;_scrollSubscription=null;_overlayRef;_initialScrollPosition;constructor(n,t,i,r){this._scrollDispatcher=n,this._ngZone=t,this._viewportRuler=i,this._config=r}attach(n){this._overlayRef=n}enable(){if(this._scrollSubscription)return;const n=this._scrollDispatcher.scrolled(0).pipe(is(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=n.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=n.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}_detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}class C6{enable(){}disable(){}attach(){}}function UO(e,n){return n.some(t=>e.bottom<t.top||e.top>t.bottom||e.right<t.left||e.left>t.right)}function T6(e,n){return n.some(t=>e.top<t.top||e.bottom>t.bottom||e.left<t.left||e.right>t.right)}class gue{_scrollDispatcher;_viewportRuler;_ngZone;_config;_scrollSubscription=null;_overlayRef;constructor(n,t,i,r){this._scrollDispatcher=n,this._viewportRuler=t,this._ngZone=i,this._config=r}attach(n){this._overlayRef=n}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:r}=this._viewportRuler.getViewportSize();UO(t,[{width:i,height:r,bottom:r,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let _ue=(()=>{class e{_scrollDispatcher=re(BO);_viewportRuler=re(QC);_ngZone=re(Ht);_document=re(ir);constructor(){}noop=()=>new C6;close=t=>new mue(this._scrollDispatcher,this._ngZone,this._viewportRuler,t);block=()=>new pue(this._viewportRuler,this._document);reposition=t=>new gue(this._scrollDispatcher,this._viewportRuler,this._ngZone,t);static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class jO{positionStrategy;scrollStrategy=new C6;panelClass="";hasBackdrop=!1;backdropClass="cdk-overlay-dark-backdrop";width;height;minWidth;minHeight;maxWidth;maxHeight;direction;disposeOnNavigation=!1;constructor(n){if(n){const t=Object.keys(n);for(const i of t)void 0!==n[i]&&(this[i]=n[i])}}}class yue{connectionPair;scrollableViewProperties;constructor(n,t){this.connectionPair=n,this.scrollableViewProperties=t}}let M6=(()=>{class e{_attachedOverlays=[];_document=re(ir);_isAttached;constructor(){}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),vue=(()=>{class e extends M6{_ngZone=re(Ht);_renderer=re(ua).createRenderer(null,null);_cleanupKeydown;add(t){super.add(t),this._isAttached||(this._ngZone.runOutsideAngular(()=>{this._cleanupKeydown=this._renderer.listen("body","keydown",this._keydownListener)}),this._isAttached=!0)}detach(){this._isAttached&&(this._cleanupKeydown?.(),this._isAttached=!1)}_keydownListener=t=>{const i=this._attachedOverlays;for(let r=i.length-1;r>-1;r--)if(i[r]._keydownEvents.observers.length>0){this._ngZone.run(()=>i[r]._keydownEvents.next(t));break}};static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),bue=(()=>{class e extends M6{_platform=re(Hs);_ngZone=re(Ht,{optional:!0});_cursorOriginalValue;_cursorStyleIsSet=!1;_pointerDownEventTarget;add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}_pointerDownListener=t=>{this._pointerDownEventTarget=Pc(t)};_clickListener=t=>{const i=Pc(t),r="click"===t.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:i;this._pointerDownEventTarget=null;const a=this._attachedOverlays.slice();for(let h=a.length-1;h>-1;h--){const v=a[h];if(v._outsidePointerEvents.observers.length<1||!v.hasAttached())continue;if(S6(v.overlayElement,i)||S6(v.overlayElement,r))break;const C=v._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>C.next(t)):C.next(t)}};static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function S6(e,n){const t=typeof ShadowRoot<"u"&&ShadowRoot;let i=n;for(;i;){if(i===e)return!0;i=t&&i instanceof ShadowRoot?i.host:i.parentNode}return!1}let E6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-overlay-style-loader",""],decls:0,vars:0,template:function(i,r){},styles:[".cdk-overlay-container,.cdk-global-overlay-wrapper{pointer-events:none;top:0;left:0;height:100%;width:100%}.cdk-overlay-container{position:fixed}@layer cdk-overlay{.cdk-overlay-container{z-index:1000}}.cdk-overlay-container:empty{display:none}.cdk-global-overlay-wrapper{display:flex;position:absolute}@layer cdk-overlay{.cdk-global-overlay-wrapper{z-index:1000}}.cdk-overlay-pane{position:absolute;pointer-events:auto;box-sizing:border-box;display:flex;max-width:100%;max-height:100%}@layer cdk-overlay{.cdk-overlay-pane{z-index:1000}}.cdk-overlay-backdrop{position:absolute;top:0;bottom:0;left:0;right:0;pointer-events:auto;-webkit-tap-highlight-color:rgba(0,0,0,0);opacity:0}@layer cdk-overlay{.cdk-overlay-backdrop{z-index:1000;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}}.cdk-overlay-backdrop-showing{opacity:1}@media(forced-colors: active){.cdk-overlay-backdrop-showing{opacity:.6}}@layer cdk-overlay{.cdk-overlay-dark-backdrop{background:rgba(0,0,0,.32)}}.cdk-overlay-transparent-backdrop{transition:visibility 1ms linear,opacity 1ms linear;visibility:hidden;opacity:1}.cdk-overlay-transparent-backdrop.cdk-overlay-backdrop-showing,.cdk-high-contrast-active .cdk-overlay-transparent-backdrop{opacity:0;visibility:visible}.cdk-overlay-backdrop-noop-animation{transition:none}.cdk-overlay-connected-position-bounding-box{position:absolute;display:flex;flex-direction:column;min-width:1px;min-height:1px}@layer cdk-overlay{.cdk-overlay-connected-position-bounding-box{z-index:1000}}.cdk-global-scrollblock{position:fixed;width:100%;overflow-y:scroll}"],encapsulation:2,changeDetection:0})}return e})(),D6=(()=>{class e{_platform=re(Hs);_containerElement;_document=re(ir);_styleLoader=re(Oc);constructor(){}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._loadStyles(),this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||Gj()){const r=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let a=0;a<r.length;a++)r[a].remove()}const i=this._document.createElement("div");i.classList.add(t),Gj()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}_loadStyles(){this._styleLoader.load(E6)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class xue{_portalOutlet;_host;_pane;_config;_ngZone;_keyboardDispatcher;_document;_location;_outsideClickDispatcher;_animationsDisabled;_injector;_renderer;_backdropElement=null;_backdropTimeout;_backdropClick=new Ie;_attachments=new Ie;_detachments=new Ie;_positionStrategy;_scrollStrategy;_locationChanges=Ni.EMPTY;_cleanupBackdropClick;_cleanupBackdropTransitionEnd;_previousHostParent;_keydownEvents=new Ie;_outsidePointerEvents=new Ie;_renders=new Ie;_afterRenderRef;_afterNextRenderRef;constructor(n,t,i,r,a,h,v,C,P,L=!1,V,W){this._portalOutlet=n,this._host=t,this._pane=i,this._config=r,this._ngZone=a,this._keyboardDispatcher=h,this._document=v,this._location=C,this._outsideClickDispatcher=P,this._animationsDisabled=L,this._injector=V,this._renderer=W,r.scrollStrategy&&(this._scrollStrategy=r.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=r.positionStrategy,this._afterRenderRef=bl(()=>Yp(()=>{this._renders.next()},{injector:this._injector}))}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(n){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(n);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._afterNextRenderRef?.destroy(),this._afterNextRenderRef=Tc(()=>{this.hasAttached()&&this.updatePosition()},{injector:this._injector}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const n=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenEmpty(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),n}dispose(){const n=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._afterNextRenderRef?.destroy(),this._previousHostParent=this._pane=this._host=null,n&&this._detachments.next(),this._detachments.complete(),this._afterRenderRef.destroy(),this._renders.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(n){n!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=n,this.hasAttached()&&(n.attach(this),this.updatePosition()))}updateSize(n){this._config={...this._config,...n},this._updateElementSize()}setDirection(n){this._config={...this._config,direction:n},this._updateElementDirection()}addPanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!0)}removePanelClass(n){this._pane&&this._toggleClasses(this._pane,n,!1)}getDirection(){const n=this._config.direction;return n?"string"==typeof n?n:n.value:"ltr"}updateScrollStrategy(n){n!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=n,this.hasAttached()&&(n.attach(this),n.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const n=this._pane.style;n.width=$s(this._config.width),n.height=$s(this._config.height),n.minWidth=$s(this._config.minWidth),n.minHeight=$s(this._config.minHeight),n.maxWidth=$s(this._config.maxWidth),n.maxHeight=$s(this._config.maxHeight)}_togglePointerEvents(n){this._pane.style.pointerEvents=n?"":"none"}_attachBackdrop(){const n="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._cleanupBackdropClick?.(),this._cleanupBackdropClick=this._renderer.listen(this._backdropElement,"click",t=>this._backdropClick.next(t)),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(n)})}):this._backdropElement.classList.add(n)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const n=this._backdropElement;if(n){if(this._animationsDisabled)return void this._disposeBackdrop(n);n.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{this._cleanupBackdropTransitionEnd?.(),this._cleanupBackdropTransitionEnd=this._renderer.listen(n,"transitionend",t=>{this._disposeBackdrop(t.target)})}),n.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(n)},500))}}_toggleClasses(n,t,i){const r=jC(t||[]).filter(a=>!!a);r.length&&(i?n.classList.add(...r):n.classList.remove(...r))}_detachContentWhenEmpty(){this._ngZone.runOutsideAngular(()=>{const n=this._renders.pipe(Er(Cl(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),n.unsubscribe())})})}_disposeScrollStrategy(){const n=this._scrollStrategy;n&&(n.disable(),n.detach&&n.detach())}_disposeBackdrop(n){this._cleanupBackdropClick?.(),this._cleanupBackdropTransitionEnd?.(),n&&(n.remove(),this._backdropElement===n&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const I6="cdk-overlay-connected-position-bounding-box",wue=/([A-Za-z%]+)$/;class Cue{_viewportRuler;_document;_platform;_overlayContainer;_overlayRef;_isInitialRender;_lastBoundingBoxSize={width:0,height:0};_isPushed=!1;_canPush=!0;_growAfterOpen=!1;_hasFlexibleDimensions=!0;_positionLocked=!1;_originRect;_overlayRect;_viewportRect;_containerRect;_viewportMargin=0;_scrollables=[];_preferredPositions=[];_origin;_pane;_isDisposed;_boundingBox;_lastPosition;_lastScrollVisibility;_positionChanges=new Ie;_resizeSubscription=Ni.EMPTY;_offsetX=0;_offsetY=0;_transformOriginSelector;_appliedPanelClasses=[];_previousPushAmount;positionChanges=this._positionChanges;get positions(){return this._preferredPositions}constructor(n,t,i,r,a){this._viewportRuler=t,this._document=i,this._platform=r,this._overlayContainer=a,this.setOrigin(n)}attach(n){this._validatePositions(),n.hostElement.classList.add(I6),this._overlayRef=n,this._boundingBox=n.hostElement,this._pane=n.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const n=this._originRect,t=this._overlayRect,i=this._viewportRect,r=this._containerRect,a=[];let h;for(let v of this._preferredPositions){let C=this._getOriginPoint(n,r,v),P=this._getOverlayPoint(C,t,v),L=this._getOverlayFit(P,t,i,v);if(L.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(v,C);this._canFitWithFlexibleDimensions(L,P,i)?a.push({position:v,origin:C,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(C,v)}):(!h||h.overlayFit.visibleArea<L.visibleArea)&&(h={overlayFit:L,overlayPoint:P,originPoint:C,position:v,overlayRect:t})}if(a.length){let v=null,C=-1;for(const P of a){const L=P.boundingBoxRect.width*P.boundingBoxRect.height*(P.position.weight||1);L>C&&(C=L,v=P)}return this._isPushed=!1,void this._applyPosition(v.position,v.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(h.position,h.originPoint);this._applyPosition(h.position,h.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&eb(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(I6),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const n=this._lastPosition;if(n){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,n);this._applyPosition(n,t)}else this.apply()}withScrollableContainers(n){return this._scrollables=n,this}withPositions(n){return this._preferredPositions=n,-1===n.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(n){return this._viewportMargin=n,this}withFlexibleDimensions(n=!0){return this._hasFlexibleDimensions=n,this}withGrowAfterOpen(n=!0){return this._growAfterOpen=n,this}withPush(n=!0){return this._canPush=n,this}withLockedPosition(n=!0){return this._positionLocked=n,this}setOrigin(n){return this._origin=n,this}withDefaultOffsetX(n){return this._offsetX=n,this}withDefaultOffsetY(n){return this._offsetY=n,this}withTransformOriginOn(n){return this._transformOriginSelector=n,this}_getOriginPoint(n,t,i){let r,a;if("center"==i.originX)r=n.left+n.width/2;else{const h=this._isRtl()?n.right:n.left,v=this._isRtl()?n.left:n.right;r="start"==i.originX?h:v}return t.left<0&&(r-=t.left),a="center"==i.originY?n.top+n.height/2:"top"==i.originY?n.top:n.bottom,t.top<0&&(a-=t.top),{x:r,y:a}}_getOverlayPoint(n,t,i){let r,a;return r="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,a="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:n.x+r,y:n.y+a}}_getOverlayFit(n,t,i,r){const a=A6(t);let{x:h,y:v}=n,C=this._getOffset(r,"x"),P=this._getOffset(r,"y");C&&(h+=C),P&&(v+=P);let W=0-v,X=v+a.height-i.height,oe=this._subtractOverflows(a.width,0-h,h+a.width-i.width),he=this._subtractOverflows(a.height,W,X),se=oe*he;return{visibleArea:se,isCompletelyWithinViewport:a.width*a.height===se,fitsInViewportVertically:he===a.height,fitsInViewportHorizontally:oe==a.width}}_canFitWithFlexibleDimensions(n,t,i){if(this._hasFlexibleDimensions){const r=i.bottom-t.y,a=i.right-t.x,h=k6(this._overlayRef.getConfig().minHeight),v=k6(this._overlayRef.getConfig().minWidth);return(n.fitsInViewportVertically||null!=h&&h<=r)&&(n.fitsInViewportHorizontally||null!=v&&v<=a)}return!1}_pushOverlayOnScreen(n,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:n.x+this._previousPushAmount.x,y:n.y+this._previousPushAmount.y};const r=A6(t),a=this._viewportRect,h=Math.max(n.x+r.width-a.width,0),v=Math.max(n.y+r.height-a.height,0),C=Math.max(a.top-i.top-n.y,0),P=Math.max(a.left-i.left-n.x,0);let L=0,V=0;return L=r.width<=a.width?P||-h:n.x<this._viewportMargin?a.left-i.left-n.x:0,V=r.height<=a.height?C||-v:n.y<this._viewportMargin?a.top-i.top-n.y:0,this._previousPushAmount={x:L,y:V},{x:n.x+L,y:n.y+V}}_applyPosition(n,t){if(this._setTransformOrigin(n),this._setOverlayElementStyles(t,n),this._setBoundingBoxStyles(t,n),n.panelClass&&this._addPanelClasses(n.panelClass),this._positionChanges.observers.length){const i=this._getScrollVisibility();if(n!==this._lastPosition||!this._lastScrollVisibility||!function Tue(e,n){return e===n||e.isOriginClipped===n.isOriginClipped&&e.isOriginOutsideView===n.isOriginOutsideView&&e.isOverlayClipped===n.isOverlayClipped&&e.isOverlayOutsideView===n.isOverlayOutsideView}(this._lastScrollVisibility,i)){const r=new yue(n,i);this._positionChanges.next(r)}this._lastScrollVisibility=i}this._lastPosition=n,this._isInitialRender=!1}_setTransformOrigin(n){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,r=n.overlayY;i="center"===n.overlayX?"center":this._isRtl()?"start"===n.overlayX?"right":"left":"start"===n.overlayX?"left":"right";for(let a=0;a<t.length;a++)t[a].style.transformOrigin=`${i} ${r}`}_calculateBoundingBoxRect(n,t){const i=this._viewportRect,r=this._isRtl();let a,h,v,L,V,W;if("top"===t.overlayY)h=n.y,a=i.height-h+this._viewportMargin;else if("bottom"===t.overlayY)v=i.height-n.y+2*this._viewportMargin,a=i.height-v+this._viewportMargin;else{const X=Math.min(i.bottom-n.y+i.top,n.y),oe=this._lastBoundingBoxSize.height;a=2*X,h=n.y-X,a>oe&&!this._isInitialRender&&!this._growAfterOpen&&(h=n.y-oe/2)}if("end"===t.overlayX&&!r||"start"===t.overlayX&&r)W=i.width-n.x+2*this._viewportMargin,L=n.x-this._viewportMargin;else if("start"===t.overlayX&&!r||"end"===t.overlayX&&r)V=n.x,L=i.right-n.x;else{const X=Math.min(i.right-n.x+i.left,n.x),oe=this._lastBoundingBoxSize.width;L=2*X,V=n.x-X,L>oe&&!this._isInitialRender&&!this._growAfterOpen&&(V=n.x-oe/2)}return{top:h,left:V,bottom:v,right:W,width:L,height:a}}_setBoundingBoxStyles(n,t){const i=this._calculateBoundingBoxRect(n,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const r={};if(this._hasExactPosition())r.top=r.left="0",r.bottom=r.right=r.maxHeight=r.maxWidth="",r.width=r.height="100%";else{const a=this._overlayRef.getConfig().maxHeight,h=this._overlayRef.getConfig().maxWidth;r.height=$s(i.height),r.top=$s(i.top),r.bottom=$s(i.bottom),r.width=$s(i.width),r.left=$s(i.left),r.right=$s(i.right),r.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",r.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",a&&(r.maxHeight=$s(a)),h&&(r.maxWidth=$s(h))}this._lastBoundingBoxSize=i,eb(this._boundingBox.style,r)}_resetBoundingBoxStyles(){eb(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){eb(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(n,t){const i={},r=this._hasExactPosition(),a=this._hasFlexibleDimensions,h=this._overlayRef.getConfig();if(r){const L=this._viewportRuler.getViewportScrollPosition();eb(i,this._getExactOverlayY(t,n,L)),eb(i,this._getExactOverlayX(t,n,L))}else i.position="static";let v="",C=this._getOffset(t,"x"),P=this._getOffset(t,"y");C&&(v+=`translateX(${C}px) `),P&&(v+=`translateY(${P}px)`),i.transform=v.trim(),h.maxHeight&&(r?i.maxHeight=$s(h.maxHeight):a&&(i.maxHeight="")),h.maxWidth&&(r?i.maxWidth=$s(h.maxWidth):a&&(i.maxWidth="")),eb(this._pane.style,i)}_getExactOverlayY(n,t,i){let r={top:"",bottom:""},a=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,i)),"bottom"===n.overlayY?r.bottom=this._document.documentElement.clientHeight-(a.y+this._overlayRect.height)+"px":r.top=$s(a.y),r}_getExactOverlayX(n,t,i){let h,r={left:"",right:""},a=this._getOverlayPoint(t,this._overlayRect,n);return this._isPushed&&(a=this._pushOverlayOnScreen(a,this._overlayRect,i)),h=this._isRtl()?"end"===n.overlayX?"left":"right":"end"===n.overlayX?"right":"left","right"===h?r.right=this._document.documentElement.clientWidth-(a.x+this._overlayRect.width)+"px":r.left=$s(a.x),r}_getScrollVisibility(){const n=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(r=>r.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:T6(n,i),isOriginOutsideView:UO(n,i),isOverlayClipped:T6(t,i),isOverlayOutsideView:UO(t,i)}}_subtractOverflows(n,...t){return t.reduce((i,r)=>i-Math.max(r,0),n)}_getNarrowedViewportRect(){const n=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+n-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:n-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(n,t){return"x"===t?null==n.offsetX?this._offsetX:n.offsetX:null==n.offsetY?this._offsetY:n.offsetY}_validatePositions(){}_addPanelClasses(n){this._pane&&jC(n).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(n=>{this._pane.classList.remove(n)}),this._appliedPanelClasses=[])}_getOriginRect(){const n=this._origin;if(n instanceof In)return n.nativeElement.getBoundingClientRect();if(n instanceof Element)return n.getBoundingClientRect();const t=n.width||0,i=n.height||0;return{top:n.y,bottom:n.y+i,left:n.x,right:n.x+t,height:i,width:t}}}function eb(e,n){for(let t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e}function k6(e){if("number"!=typeof e&&null!=e){const[n,t]=e.split(wue);return t&&"px"!==t?null:parseFloat(n)}return e||null}function A6(e){return{top:Math.floor(e.top),right:Math.floor(e.right),bottom:Math.floor(e.bottom),left:Math.floor(e.left),width:Math.floor(e.width),height:Math.floor(e.height)}}const R6="cdk-global-overlay-wrapper";class Mue{_overlayRef;_cssPosition="static";_topOffset="";_bottomOffset="";_alignItems="";_xPosition="";_xOffset="";_width="";_height="";_isDisposed=!1;attach(n){const t=n.getConfig();this._overlayRef=n,this._width&&!t.width&&n.updateSize({width:this._width}),this._height&&!t.height&&n.updateSize({height:this._height}),n.hostElement.classList.add(R6),this._isDisposed=!1}top(n=""){return this._bottomOffset="",this._topOffset=n,this._alignItems="flex-start",this}left(n=""){return this._xOffset=n,this._xPosition="left",this}bottom(n=""){return this._topOffset="",this._bottomOffset=n,this._alignItems="flex-end",this}right(n=""){return this._xOffset=n,this._xPosition="right",this}start(n=""){return this._xOffset=n,this._xPosition="start",this}end(n=""){return this._xOffset=n,this._xPosition="end",this}width(n=""){return this._overlayRef?this._overlayRef.updateSize({width:n}):this._width=n,this}height(n=""){return this._overlayRef?this._overlayRef.updateSize({height:n}):this._height=n,this}centerHorizontally(n=""){return this.left(n),this._xPosition="center",this}centerVertically(n=""){return this.top(n),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:r,height:a,maxWidth:h,maxHeight:v}=i,C=!("100%"!==r&&"100vw"!==r||h&&"100%"!==h&&"100vw"!==h),P=!("100%"!==a&&"100vh"!==a||v&&"100%"!==v&&"100vh"!==v),L=this._xPosition,V=this._xOffset,W="rtl"===this._overlayRef.getConfig().direction;let X="",oe="",he="";C?he="flex-start":"center"===L?(he="center",W?oe=V:X=V):W?"left"===L||"end"===L?(he="flex-end",X=V):("right"===L||"start"===L)&&(he="flex-start",oe=V):"left"===L||"start"===L?(he="flex-start",X=V):("right"===L||"end"===L)&&(he="flex-end",oe=V),n.position=this._cssPosition,n.marginLeft=C?"0":X,n.marginTop=P?"0":this._topOffset,n.marginBottom=this._bottomOffset,n.marginRight=C?"0":oe,t.justifyContent=he,t.alignItems=P?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const n=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(R6),i.justifyContent=i.alignItems=n.marginTop=n.marginBottom=n.marginLeft=n.marginRight=n.position="",this._overlayRef=null,this._isDisposed=!0}}let Sue=(()=>{class e{_viewportRuler=re(QC);_document=re(ir);_platform=re(Hs);_overlayContainer=re(D6);constructor(){}global(){return new Mue}flexibleConnectedTo(t){return new Cue(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),fu=(()=>{class e{scrollStrategies=re(_ue);_overlayContainer=re(D6);_positionBuilder=re(Sue);_keyboardDispatcher=re(vue);_injector=re(Ye);_ngZone=re(Ht);_document=re(ir);_directionality=re(Om);_location=re(fx);_outsideClickDispatcher=re(bue);_animationsModuleType=re(Ga,{optional:!0});_idGenerator=re(du);_renderer=re(ua).createRenderer(null,null);_appRef;_styleLoader=re(Oc);constructor(){}create(t){this._styleLoader.load(E6);const i=this._createHostElement(),r=this._createPaneElement(i),a=this._createPortalOutlet(r),h=new jO(t);return h.direction=h.direction||this._directionality.value,new xue(a,i,r,h,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType,this._injector.get(Eo),this._renderer)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id=this._idGenerator.getId("cdk-overlay-"),i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Wa)),new qde(t,null,this._appRef,this._injector,this._document)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Eue=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],P6=new ct("cdk-connected-overlay-scroll-strategy",{providedIn:"root",factory:()=>{const e=re(fu);return()=>e.scrollStrategies.reposition()}});let iI=(()=>{class e{elementRef=re(In);constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdk-overlay-origin",""],["","overlay-origin",""],["","cdkOverlayOrigin",""]],exportAs:["cdkOverlayOrigin"]})}return e})(),O6=(()=>{class e{_overlay=re(fu);_dir=re(Om,{optional:!0});_overlayRef;_templatePortal;_backdropSubscription=Ni.EMPTY;_attachSubscription=Ni.EMPTY;_detachSubscription=Ni.EMPTY;_positionSubscription=Ni.EMPTY;_offsetX;_offsetY;_position;_scrollStrategyFactory=re(P6);_disposeOnNavigation=!1;_ngZone=re(Ht);origin;positions;positionStrategy;get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t,this._position&&this._updatePositionStrategy(this._position)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t,this._position&&this._updatePositionStrategy(this._position)}width;height;minWidth;minHeight;backdropClass;panelClass;viewportMargin=0;scrollStrategy;open=!1;disableClose=!1;transformOriginSelector;hasBackdrop=!1;lockPosition=!1;flexibleDimensions=!1;growAfterOpen=!1;push=!1;get disposeOnNavigation(){return this._disposeOnNavigation}set disposeOnNavigation(t){this._disposeOnNavigation=t}backdropClick=new Dt;positionChange=new Dt;attach=new Dt;detach=new Dt;overlayKeydown=new Dt;overlayOutsideClick=new Dt;constructor(){const t=re(Lo),i=re(ms);this._templatePortal=new eI(t,i),this.scrollStrategy=this._scrollStrategyFactory()}get overlayRef(){return this._overlayRef}get dir(){return this._dir?this._dir.value:"ltr"}ngOnDestroy(){this._attachSubscription.unsubscribe(),this._detachSubscription.unsubscribe(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this._overlayRef&&this._overlayRef.dispose()}ngOnChanges(t){this._position&&(this._updatePositionStrategy(this._position),this._overlayRef.updateSize({width:this.width,minWidth:this.minWidth,height:this.height,minHeight:this.minHeight}),t.origin&&this.open&&this._position.apply()),t.open&&(this.open?this._attachOverlay():this._detachOverlay())}_createOverlay(){(!this.positions||!this.positions.length)&&(this.positions=Eue);const t=this._overlayRef=this._overlay.create(this._buildConfig());this._attachSubscription=t.attachments().subscribe(()=>this.attach.emit()),this._detachSubscription=t.detachments().subscribe(()=>this.detach.emit()),t.keydownEvents().subscribe(i=>{this.overlayKeydown.next(i),27===i.keyCode&&!this.disableClose&&!Pm(i)&&(i.preventDefault(),this._detachOverlay())}),this._overlayRef.outsidePointerEvents().subscribe(i=>{const r=this._getOriginElement(),a=Pc(i);(!r||r!==a&&!r.contains(a))&&this.overlayOutsideClick.next(i)})}_buildConfig(){const t=this._position=this.positionStrategy||this._createPositionStrategy(),i=new jO({direction:this._dir||"ltr",positionStrategy:t,scrollStrategy:this.scrollStrategy,hasBackdrop:this.hasBackdrop,disposeOnNavigation:this.disposeOnNavigation});return(this.width||0===this.width)&&(i.width=this.width),(this.height||0===this.height)&&(i.height=this.height),(this.minWidth||0===this.minWidth)&&(i.minWidth=this.minWidth),(this.minHeight||0===this.minHeight)&&(i.minHeight=this.minHeight),this.backdropClass&&(i.backdropClass=this.backdropClass),this.panelClass&&(i.panelClass=this.panelClass),i}_updatePositionStrategy(t){const i=this.positions.map(r=>({originX:r.originX,originY:r.originY,overlayX:r.overlayX,overlayY:r.overlayY,offsetX:r.offsetX||this.offsetX,offsetY:r.offsetY||this.offsetY,panelClass:r.panelClass||void 0}));return t.setOrigin(this._getOrigin()).withPositions(i).withFlexibleDimensions(this.flexibleDimensions).withPush(this.push).withGrowAfterOpen(this.growAfterOpen).withViewportMargin(this.viewportMargin).withLockedPosition(this.lockPosition).withTransformOriginOn(this.transformOriginSelector)}_createPositionStrategy(){const t=this._overlay.position().flexibleConnectedTo(this._getOrigin());return this._updatePositionStrategy(t),t}_getOrigin(){return this.origin instanceof iI?this.origin.elementRef:this.origin}_getOriginElement(){return this.origin instanceof iI?this.origin.elementRef.nativeElement:this.origin instanceof In?this.origin.nativeElement:typeof Element<"u"&&this.origin instanceof Element?this.origin:null}_attachOverlay(){this._overlayRef?this._overlayRef.getConfig().hasBackdrop=this.hasBackdrop:this._createOverlay(),this._overlayRef.hasAttached()||this._overlayRef.attach(this._templatePortal),this.hasBackdrop?this._backdropSubscription=this._overlayRef.backdropClick().subscribe(t=>{this.backdropClick.emit(t)}):this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe(),this.positionChange.observers.length>0&&(this._positionSubscription=this._position.positionChanges.pipe(function fue(e,n=!1){return Tt((t,i)=>{let r=0;t.subscribe(Mt(i,a=>{const h=e(a,r++);(h||n)&&i.next(a),!h&&i.complete()}))})}(()=>this.positionChange.observers.length>0)).subscribe(t=>{this._ngZone.run(()=>this.positionChange.emit(t)),0===this.positionChange.observers.length&&this._positionSubscription.unsubscribe()}))}_detachOverlay(){this._overlayRef&&this._overlayRef.detach(),this._backdropSubscription.unsubscribe(),this._positionSubscription.unsubscribe()}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdk-connected-overlay",""],["","connected-overlay",""],["","cdkConnectedOverlay",""]],inputs:{origin:[0,"cdkConnectedOverlayOrigin","origin"],positions:[0,"cdkConnectedOverlayPositions","positions"],positionStrategy:[0,"cdkConnectedOverlayPositionStrategy","positionStrategy"],offsetX:[0,"cdkConnectedOverlayOffsetX","offsetX"],offsetY:[0,"cdkConnectedOverlayOffsetY","offsetY"],width:[0,"cdkConnectedOverlayWidth","width"],height:[0,"cdkConnectedOverlayHeight","height"],minWidth:[0,"cdkConnectedOverlayMinWidth","minWidth"],minHeight:[0,"cdkConnectedOverlayMinHeight","minHeight"],backdropClass:[0,"cdkConnectedOverlayBackdropClass","backdropClass"],panelClass:[0,"cdkConnectedOverlayPanelClass","panelClass"],viewportMargin:[0,"cdkConnectedOverlayViewportMargin","viewportMargin"],scrollStrategy:[0,"cdkConnectedOverlayScrollStrategy","scrollStrategy"],open:[0,"cdkConnectedOverlayOpen","open"],disableClose:[0,"cdkConnectedOverlayDisableClose","disableClose"],transformOriginSelector:[0,"cdkConnectedOverlayTransformOriginOn","transformOriginSelector"],hasBackdrop:[2,"cdkConnectedOverlayHasBackdrop","hasBackdrop",zn],lockPosition:[2,"cdkConnectedOverlayLockPosition","lockPosition",zn],flexibleDimensions:[2,"cdkConnectedOverlayFlexibleDimensions","flexibleDimensions",zn],growAfterOpen:[2,"cdkConnectedOverlayGrowAfterOpen","growAfterOpen",zn],push:[2,"cdkConnectedOverlayPush","push",zn],disposeOnNavigation:[2,"cdkConnectedOverlayDisposeOnNavigation","disposeOnNavigation",zn]},outputs:{backdropClick:"backdropClick",positionChange:"positionChange",attach:"attach",detach:"detach",overlayKeydown:"overlayKeydown",overlayOutsideClick:"overlayOutsideClick"},exportAs:["cdkConnectedOverlay"],features:[jr,sr]})}return e})();const Iue={provide:P6,deps:[fu],useFactory:function Due(e){return()=>e.scrollStrategies.reposition()}};let HO=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[fu,Iue],imports:[HC,g6,VO,VO]})}return e})();const kue=["mat-menu-item",""],Aue=[[["mat-icon"],["","matMenuItemIcon",""]],"*"],Rue=["mat-icon, [matMenuItemIcon]","*"];function Pue(e,n){1&e&&(Ma(),Fe(0,"svg",2),_n(1,"polygon",3),Ue())}const Oue=["*"];function Fue(e,n){if(1&e){const t=Is();Fe(0,"div",0),Nn("click",function(){return Di(t),Ii(cn().closed.emit("click"))})("animationstart",function(r){return Di(t),Ii(cn()._onAnimationStart(r.animationName))})("animationend",function(r){return Di(t),Ii(cn()._onAnimationDone(r.animationName))})("animationcancel",function(r){return Di(t),Ii(cn()._onAnimationDone(r.animationName))}),Fe(1,"div",1),ai(2),Ue()()}if(2&e){const t=cn();ka(t._classList),Ti("mat-menu-panel-animations-disabled",t._animationsDisabled)("mat-menu-panel-exit-animation","void"===t._panelAnimationState)("mat-menu-panel-animating",t._isAnimating),At("id",t.panelId),ui("aria-label",t.ariaLabel||null)("aria-labelledby",t.ariaLabelledby||null)("aria-describedby",t.ariaDescribedby||null)}}const $O=new ct("MAT_MENU_PANEL");let rI=(()=>{class e{_elementRef=re(In);_document=re(ir);_focusMonitor=re(Lx);_parentMenu=re($O,{optional:!0});_changeDetectorRef=re(Bo);role="menuitem";disabled=!1;disableRipple=!1;_hovered=new Ie;_focused=new Ie;_highlighted=!1;_triggersSubmenu=!1;constructor(){re(Oc).load(Qv),this._parentMenu?.addItem?.(this)}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._getHostElement(),t,i):this._getHostElement().focus(i),this._focused.next(this)}ngAfterViewInit(){this._focusMonitor&&this._focusMonitor.monitor(this._elementRef,!1)}ngOnDestroy(){this._focusMonitor&&this._focusMonitor.stopMonitoring(this._elementRef),this._parentMenu&&this._parentMenu.removeItem&&this._parentMenu.removeItem(this),this._hovered.complete(),this._focused.complete()}_getTabIndex(){return this.disabled?"-1":"0"}_getHostElement(){return this._elementRef.nativeElement}_checkDisabled(t){this.disabled&&(t.preventDefault(),t.stopPropagation())}_handleMouseEnter(){this._hovered.next(this)}getLabel(){const t=this._elementRef.nativeElement.cloneNode(!0),i=t.querySelectorAll("mat-icon, .material-icons");for(let r=0;r<i.length;r++)i[r].remove();return t.textContent?.trim()||""}_setHighlighted(t){this._highlighted=t,this._changeDetectorRef.markForCheck()}_setTriggersSubmenu(t){this._triggersSubmenu=t,this._changeDetectorRef.markForCheck()}_hasFocus(){return this._document&&this._document.activeElement===this._getHostElement()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["","mat-menu-item",""]],hostAttrs:[1,"mat-mdc-menu-item","mat-focus-indicator"],hostVars:8,hostBindings:function(i,r){1&i&&Nn("click",function(h){return r._checkDisabled(h)})("mouseenter",function(){return r._handleMouseEnter()}),2&i&&(ui("role",r.role)("tabindex",r._getTabIndex())("aria-disabled",r.disabled)("disabled",r.disabled||null),Ti("mat-mdc-menu-item-highlighted",r._highlighted)("mat-mdc-menu-item-submenu-trigger",r._triggersSubmenu))},inputs:{role:"role",disabled:[2,"disabled","disabled",zn],disableRipple:[2,"disableRipple","disableRipple",zn]},exportAs:["matMenuItem"],features:[jr],attrs:kue,ngContentSelectors:Rue,decls:5,vars:3,consts:[[1,"mat-mdc-menu-item-text"],["matRipple","",1,"mat-mdc-menu-ripple",3,"matRippleDisabled","matRippleTrigger"],["viewBox","0 0 5 10","focusable","false","aria-hidden","true",1,"mat-mdc-menu-submenu-icon"],["points","0,0 5,5 0,10"]],template:function(i,r){1&i&&(zo(Aue),ai(0),Fe(1,"span",0),ai(2,1),Ue(),_n(3,"div",1),an(4,Pue,2,0,":svg:svg",2)),2&i&&(Ze(3),At("matRippleDisabled",r.disableRipple||r.disabled)("matRippleTrigger",r._getHostElement()),Ze(),Mr(r._triggersSubmenu?4:-1))},dependencies:[xO],encapsulation:2,changeDetection:0})}return e})();const Lue=new ct("MatMenuContent"),Nue=new ct("mat-menu-default-options",{providedIn:"root",factory:function zue(){return{overlapTrigger:!1,xPosition:"after",yPosition:"below",backdropClass:"cdk-overlay-transparent-backdrop"}}}),GO="_mat-menu-enter",oI="_mat-menu-exit";let JC=(()=>{class e{_elementRef=re(In);_changeDetectorRef=re(Bo);_injector=re(Ye);_keyManager;_xPosition;_yPosition;_firstItemFocusRef;_exitFallbackTimeout;_animationsDisabled;_allItems;_directDescendantItems=new od;_classList={};_panelAnimationState="void";_animationDone=new Ie;_isAnimating=!1;parentMenu;direction;overlayPanelClass;backdropClass;ariaLabel;ariaLabelledby;ariaDescribedby;get xPosition(){return this._xPosition}set xPosition(t){this._xPosition=t,this.setPositionClasses()}get yPosition(){return this._yPosition}set yPosition(t){this._yPosition=t,this.setPositionClasses()}templateRef;items;lazyContent;overlapTrigger;hasBackdrop;set panelClass(t){const i=this._previousPanelClass,r={...this._classList};i&&i.length&&i.split(" ").forEach(a=>{r[a]=!1}),this._previousPanelClass=t,t&&t.length&&(t.split(" ").forEach(a=>{r[a]=!0}),this._elementRef.nativeElement.className=""),this._classList=r}_previousPanelClass;get classList(){return this.panelClass}set classList(t){this.panelClass=t}closed=new Dt;close=this.closed;panelId=re(du).getId("mat-menu-panel-");constructor(){const t=re(Nue);this.overlayPanelClass=t.overlayPanelClass||"",this._xPosition=t.xPosition,this._yPosition=t.yPosition,this.backdropClass=t.backdropClass,this.overlapTrigger=t.overlapTrigger,this.hasBackdrop=t.hasBackdrop,this._animationsDisabled="NoopAnimations"===re(Ga,{optional:!0})}ngOnInit(){this.setPositionClasses()}ngAfterContentInit(){this._updateDirectDescendants(),this._keyManager=new aH(this._directDescendantItems).withWrap().withTypeAhead().withHomeAndEnd(),this._keyManager.tabOut.subscribe(()=>this.closed.emit("tab")),this._directDescendantItems.changes.pipe(Ch(this._directDescendantItems),Aa(t=>Cl(...t.map(i=>i._focused)))).subscribe(t=>this._keyManager.updateActiveItem(t)),this._directDescendantItems.changes.subscribe(t=>{const i=this._keyManager;if("enter"===this._panelAnimationState&&i.activeItem?._hasFocus()){const r=t.toArray(),a=Math.max(0,Math.min(r.length-1,i.activeItemIndex||0));r[a]&&!r[a].disabled?i.setActiveItem(a):i.setNextItemActive()}})}ngOnDestroy(){this._keyManager?.destroy(),this._directDescendantItems.destroy(),this.closed.complete(),this._firstItemFocusRef?.destroy(),clearTimeout(this._exitFallbackTimeout)}_hovered(){return this._directDescendantItems.changes.pipe(Ch(this._directDescendantItems),Aa(i=>Cl(...i.map(r=>r._hovered))))}addItem(t){}removeItem(t){}_handleKeydown(t){const i=t.keyCode,r=this._keyManager;switch(i){case 27:Pm(t)||(t.preventDefault(),this.closed.emit("keydown"));break;case 37:this.parentMenu&&"ltr"===this.direction&&this.closed.emit("keydown");break;case 39:this.parentMenu&&"rtl"===this.direction&&this.closed.emit("keydown");break;default:return(38===i||40===i)&&r.setFocusOrigin("keyboard"),void r.onKeydown(t)}}focusFirstItem(t="program"){this._firstItemFocusRef?.destroy(),this._firstItemFocusRef=Tc(()=>{const i=this._resolvePanel();if(!i||!i.contains(document.activeElement)){const r=this._keyManager;r.setFocusOrigin(t).setFirstItemActive(),!r.activeItem&&i&&i.focus()}},{injector:this._injector})}resetActiveItem(){this._keyManager.setActiveItem(-1)}setElevation(t){}setPositionClasses(t=this.xPosition,i=this.yPosition){this._classList={...this._classList,"mat-menu-before":"before"===t,"mat-menu-after":"after"===t,"mat-menu-above":"above"===i,"mat-menu-below":"below"===i},this._changeDetectorRef.markForCheck()}_onAnimationDone(t){const i=t===oI;(i||t===GO)&&(i&&(clearTimeout(this._exitFallbackTimeout),this._exitFallbackTimeout=void 0),this._animationDone.next(i?"void":"enter"),this._isAnimating=!1)}_onAnimationStart(t){(t===GO||t===oI)&&(this._isAnimating=!0)}_setIsOpen(t){if(this._panelAnimationState=t?"enter":"void",t){if(0===this._keyManager.activeItemIndex){const i=this._resolvePanel();i&&(i.scrollTop=0)}}else this._animationsDisabled||(this._exitFallbackTimeout=setTimeout(()=>this._onAnimationDone(oI),200));this._animationsDisabled&&setTimeout(()=>{this._onAnimationDone(t?GO:oI)}),this._changeDetectorRef.markForCheck()}_updateDirectDescendants(){this._allItems.changes.pipe(Ch(this._allItems)).subscribe(t=>{this._directDescendantItems.reset(t.filter(i=>i._parentMenu===this)),this._directDescendantItems.notifyOnChanges()})}_resolvePanel(){let t=null;return this._directDescendantItems.length&&(t=this._directDescendantItems.first._getHostElement().closest('[role="menu"]')),t}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-menu"]],contentQueries:function(i,r,a){if(1&i&&(bo(a,Lue,5),bo(a,rI,5),bo(a,rI,4)),2&i){let h;ri(h=oi())&&(r.lazyContent=h.first),ri(h=oi())&&(r._allItems=h),ri(h=oi())&&(r.items=h)}},viewQuery:function(i,r){if(1&i&&zr(Lo,5),2&i){let a;ri(a=oi())&&(r.templateRef=a.first)}},hostVars:3,hostBindings:function(i,r){2&i&&ui("aria-label",null)("aria-labelledby",null)("aria-describedby",null)},inputs:{backdropClass:"backdropClass",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],ariaDescribedby:[0,"aria-describedby","ariaDescribedby"],xPosition:"xPosition",yPosition:"yPosition",overlapTrigger:[2,"overlapTrigger","overlapTrigger",zn],hasBackdrop:[2,"hasBackdrop","hasBackdrop",t=>null==t?null:zn(t)],panelClass:[0,"class","panelClass"],classList:"classList"},outputs:{closed:"closed",close:"close"},exportAs:["matMenu"],features:[Jn([{provide:$O,useExisting:e}]),jr],ngContentSelectors:Oue,decls:1,vars:0,consts:[["tabindex","-1","role","menu",1,"mat-mdc-menu-panel",3,"click","animationstart","animationend","animationcancel","id"],[1,"mat-mdc-menu-content"]],template:function(i,r){1&i&&(zo(),an(0,Fue,3,12,"ng-template"))},styles:['mat-menu{display:none}.mat-mdc-menu-content{margin:0;padding:8px 0;outline:0}.mat-mdc-menu-content,.mat-mdc-menu-content .mat-mdc-menu-item .mat-mdc-menu-item-text{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;flex:1;white-space:normal;font-family:var(--mat-menu-item-label-text-font, var(--mat-sys-label-large-font));line-height:var(--mat-menu-item-label-text-line-height, var(--mat-sys-label-large-line-height));font-size:var(--mat-menu-item-label-text-size, var(--mat-sys-label-large-size));letter-spacing:var(--mat-menu-item-label-text-tracking, var(--mat-sys-label-large-tracking));font-weight:var(--mat-menu-item-label-text-weight, var(--mat-sys-label-large-weight))}@keyframes _mat-menu-enter{from{opacity:0;transform:scale(0.8)}to{opacity:1;transform:none}}@keyframes _mat-menu-exit{from{opacity:1}to{opacity:0}}.mat-mdc-menu-panel{min-width:112px;max-width:280px;overflow:auto;-webkit-overflow-scrolling:touch;box-sizing:border-box;outline:0;animation:_mat-menu-enter 120ms cubic-bezier(0, 0, 0.2, 1);border-radius:var(--mat-menu-container-shape, var(--mat-sys-corner-extra-small));background-color:var(--mat-menu-container-color, var(--mat-sys-surface-container));box-shadow:var(--mat-menu-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12));will-change:transform,opacity}.mat-mdc-menu-panel.mat-menu-panel-exit-animation{animation:_mat-menu-exit 100ms 25ms linear forwards}.mat-mdc-menu-panel.mat-menu-panel-animations-disabled{animation:none}.mat-mdc-menu-panel.mat-menu-panel-animating{pointer-events:none}.mat-mdc-menu-panel.mat-menu-panel-animating:has(.mat-mdc-menu-content:empty){display:none}@media(forced-colors: active){.mat-mdc-menu-panel{outline:solid 1px}}.mat-mdc-menu-panel .mat-divider{color:var(--mat-menu-divider-color, var(--mat-sys-surface-variant));margin-bottom:var(--mat-menu-divider-bottom-spacing, 8px);margin-top:var(--mat-menu-divider-top-spacing, 8px)}.mat-mdc-menu-item{display:flex;position:relative;align-items:center;justify-content:flex-start;overflow:hidden;padding:0;cursor:pointer;width:100%;text-align:left;box-sizing:border-box;color:inherit;font-size:inherit;background:none;text-decoration:none;margin:0;min-height:48px;padding-left:var(--mat-menu-item-leading-spacing, 12px);padding-right:var(--mat-menu-item-trailing-spacing, 12px);-webkit-user-select:none;user-select:none;cursor:pointer;outline:none;border:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-mdc-menu-item::-moz-focus-inner{border:0}[dir=rtl] .mat-mdc-menu-item{padding-left:var(--mat-menu-item-trailing-spacing, 12px);padding-right:var(--mat-menu-item-leading-spacing, 12px)}.mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-leading-spacing, 12px);padding-right:var(--mat-menu-item-with-icon-trailing-spacing, 12px)}[dir=rtl] .mat-mdc-menu-item:has(.material-icons,mat-icon,[matButtonIcon]){padding-left:var(--mat-menu-item-with-icon-trailing-spacing, 12px);padding-right:var(--mat-menu-item-with-icon-leading-spacing, 12px)}.mat-mdc-menu-item,.mat-mdc-menu-item:visited,.mat-mdc-menu-item:link{color:var(--mat-menu-item-label-text-color, var(--mat-sys-on-surface))}.mat-mdc-menu-item .mat-icon-no-color,.mat-mdc-menu-item .mat-mdc-menu-submenu-icon{color:var(--mat-menu-item-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-menu-item[disabled]{cursor:default;opacity:.38}.mat-mdc-menu-item[disabled]::after{display:block;position:absolute;content:"";top:0;left:0;bottom:0;right:0}.mat-mdc-menu-item:focus{outline:0}.mat-mdc-menu-item .mat-icon{flex-shrink:0;margin-right:var(--mat-menu-item-spacing, 12px);height:var(--mat-menu-item-icon-size, 24px);width:var(--mat-menu-item-icon-size, 24px)}[dir=rtl] .mat-mdc-menu-item{text-align:right}[dir=rtl] .mat-mdc-menu-item .mat-icon{margin-right:0;margin-left:var(--mat-menu-item-spacing, 12px)}.mat-mdc-menu-item:not([disabled]):hover{background-color:var(--mat-menu-item-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}.mat-mdc-menu-item:not([disabled]).cdk-program-focused,.mat-mdc-menu-item:not([disabled]).cdk-keyboard-focused,.mat-mdc-menu-item:not([disabled]).mat-mdc-menu-item-highlighted{background-color:var(--mat-menu-item-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}@media(forced-colors: active){.mat-mdc-menu-item{margin-top:1px}}.mat-mdc-menu-submenu-icon{width:var(--mat-menu-item-icon-size, 24px);height:10px;fill:currentColor;padding-left:var(--mat-menu-item-spacing, 12px)}[dir=rtl] .mat-mdc-menu-submenu-icon{padding-right:var(--mat-menu-item-spacing, 12px);padding-left:0}[dir=rtl] .mat-mdc-menu-submenu-icon polygon{transform:scaleX(-1);transform-origin:center}@media(forced-colors: active){.mat-mdc-menu-submenu-icon{fill:CanvasText}}.mat-mdc-menu-item .mat-mdc-menu-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}'],encapsulation:2,changeDetection:0})}return e})();const F6=new ct("mat-menu-scroll-strategy",{providedIn:"root",factory:()=>{const e=re(fu);return()=>e.scrollStrategies.reposition()}}),Vue={provide:F6,deps:[fu],useFactory:function Bue(e){return()=>e.scrollStrategies.reposition()}},L6=cu({passive:!0}),eT=new WeakMap;let Uue=(()=>{class e{_overlay=re(fu);_element=re(In);_viewContainerRef=re(ms);_menuItemInstance=re(rI,{optional:!0,self:!0});_dir=re(Om,{optional:!0});_focusMonitor=re(Lx);_ngZone=re(Ht);_scrollStrategy=re(F6);_changeDetectorRef=re(Bo);_portal;_overlayRef=null;_menuOpen=!1;_closingActionsSubscription=Ni.EMPTY;_hoverSubscription=Ni.EMPTY;_menuCloseSubscription=Ni.EMPTY;_pendingRemoval;_parentMaterialMenu;_parentInnerPadding;_handleTouchStart=t=>{jD(t)||(this._openedBy="touch")};_openedBy=void 0;get _deprecatedMatMenuTriggerFor(){return this.menu}set _deprecatedMatMenuTriggerFor(t){this.menu=t}get menu(){return this._menu}set menu(t){t!==this._menu&&(this._menu=t,this._menuCloseSubscription.unsubscribe(),t&&(this._menuCloseSubscription=t.close.subscribe(i=>{this._destroyMenu(i),("click"===i||"tab"===i)&&this._parentMaterialMenu&&this._parentMaterialMenu.closed.emit(i)})),this._menuItemInstance?._setTriggersSubmenu(this.triggersSubmenu()))}_menu;menuData;restoreFocus=!0;menuOpened=new Dt;onMenuOpen=this.menuOpened;menuClosed=new Dt;onMenuClose=this.menuClosed;constructor(){const t=re($O,{optional:!0});this._parentMaterialMenu=t instanceof JC?t:void 0,this._element.nativeElement.addEventListener("touchstart",this._handleTouchStart,L6)}ngAfterContentInit(){this._handleHover()}ngOnDestroy(){this.menu&&this._ownsMenu(this.menu)&&eT.delete(this.menu),this._element.nativeElement.removeEventListener("touchstart",this._handleTouchStart,L6),this._pendingRemoval?.unsubscribe(),this._menuCloseSubscription.unsubscribe(),this._closingActionsSubscription.unsubscribe(),this._hoverSubscription.unsubscribe(),this._overlayRef&&(this._overlayRef.dispose(),this._overlayRef=null)}get menuOpen(){return this._menuOpen}get dir(){return this._dir&&"rtl"===this._dir.value?"rtl":"ltr"}triggersSubmenu(){return!!(this._menuItemInstance&&this._parentMaterialMenu&&this.menu)}toggleMenu(){return this._menuOpen?this.closeMenu():this.openMenu()}openMenu(){const t=this.menu;if(this._menuOpen||!t)return;this._pendingRemoval?.unsubscribe();const i=eT.get(t);eT.set(t,this),i&&i!==this&&i.closeMenu();const r=this._createOverlay(t),a=r.getConfig(),h=a.positionStrategy;this._setPosition(t,h),a.hasBackdrop=null==t.hasBackdrop?!this.triggersSubmenu():t.hasBackdrop,r.hasAttached()||(r.attach(this._getPortal(t)),t.lazyContent?.attach(this.menuData)),this._closingActionsSubscription=this._menuClosingActions().subscribe(()=>this.closeMenu()),t.parentMenu=this.triggersSubmenu()?this._parentMaterialMenu:void 0,t.direction=this.dir,t.focusFirstItem(this._openedBy||"program"),this._setIsMenuOpen(!0),t instanceof JC&&(t._setIsOpen(!0),t._directDescendantItems.changes.pipe(Er(t.close)).subscribe(()=>{h.withLockedPosition(!1).reapplyLastPosition(),h.withLockedPosition(!0)}))}closeMenu(){this.menu?.close.emit()}focus(t,i){this._focusMonitor&&t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}updatePosition(){this._overlayRef?.updatePosition()}_destroyMenu(t){const i=this._overlayRef,r=this._menu;!i||!this.menuOpen||(this._closingActionsSubscription.unsubscribe(),this._pendingRemoval?.unsubscribe(),r instanceof JC&&this._ownsMenu(r)?(this._pendingRemoval=r._animationDone.pipe(Ac(1)).subscribe(()=>i.detach()),r._setIsOpen(!1)):i.detach(),r&&this._ownsMenu(r)&&eT.delete(r),this.restoreFocus&&("keydown"===t||!this._openedBy||!this.triggersSubmenu())&&this.focus(this._openedBy),this._openedBy=void 0,this._setIsMenuOpen(!1))}_setIsMenuOpen(t){t!==this._menuOpen&&(this._menuOpen=t,this._menuOpen?this.menuOpened.emit():this.menuClosed.emit(),this.triggersSubmenu()&&this._menuItemInstance._setHighlighted(t),this._changeDetectorRef.markForCheck())}_createOverlay(t){if(!this._overlayRef){const i=this._getOverlayConfig(t);this._subscribeToPositions(t,i.positionStrategy),this._overlayRef=this._overlay.create(i),this._overlayRef.keydownEvents().subscribe(r=>{this.menu instanceof JC&&this.menu._handleKeydown(r)})}return this._overlayRef}_getOverlayConfig(t){return new jO({positionStrategy:this._overlay.position().flexibleConnectedTo(this._element).withLockedPosition().withGrowAfterOpen().withTransformOriginOn(".mat-menu-panel, .mat-mdc-menu-panel"),backdropClass:t.backdropClass||"cdk-overlay-transparent-backdrop",panelClass:t.overlayPanelClass,scrollStrategy:this._scrollStrategy(),direction:this._dir||"ltr"})}_subscribeToPositions(t,i){t.setPositionClasses&&i.positionChanges.subscribe(r=>{this._ngZone.run(()=>{t.setPositionClasses("start"===r.connectionPair.overlayX?"after":"before","top"===r.connectionPair.overlayY?"below":"above")})})}_setPosition(t,i){let[r,a]="before"===t.xPosition?["end","start"]:["start","end"],[h,v]="above"===t.yPosition?["bottom","top"]:["top","bottom"],[C,P]=[h,v],[L,V]=[r,a],W=0;if(this.triggersSubmenu()){if(V=r="before"===t.xPosition?"start":"end",a=L="end"===r?"start":"end",this._parentMaterialMenu){if(null==this._parentInnerPadding){const X=this._parentMaterialMenu.items.first;this._parentInnerPadding=X?X._getHostElement().offsetTop:0}W="bottom"===h?this._parentInnerPadding:-this._parentInnerPadding}}else t.overlapTrigger||(C="top"===h?"bottom":"top",P="top"===v?"bottom":"top");i.withPositions([{originX:r,originY:C,overlayX:L,overlayY:h,offsetY:W},{originX:a,originY:C,overlayX:V,overlayY:h,offsetY:W},{originX:r,originY:P,overlayX:L,overlayY:v,offsetY:-W},{originX:a,originY:P,overlayX:V,overlayY:v,offsetY:-W}])}_menuClosingActions(){const t=this._overlayRef.backdropClick(),i=this._overlayRef.detachments();return Cl(t,this._parentMaterialMenu?this._parentMaterialMenu.closed:vn(),this._parentMaterialMenu?this._parentMaterialMenu._hovered().pipe(is(h=>this._menuOpen&&h!==this._menuItemInstance)):vn(),i)}_handleMousedown(t){UD(t)||(this._openedBy=0===t.button?"mouse":void 0,this.triggersSubmenu()&&t.preventDefault())}_handleKeydown(t){const i=t.keyCode;(13===i||32===i)&&(this._openedBy="keyboard"),this.triggersSubmenu()&&(39===i&&"ltr"===this.dir||37===i&&"rtl"===this.dir)&&(this._openedBy="keyboard",this.openMenu())}_handleClick(t){this.triggersSubmenu()?(t.stopPropagation(),this.openMenu()):this.toggleMenu()}_handleHover(){this.triggersSubmenu()&&this._parentMaterialMenu&&(this._hoverSubscription=this._parentMaterialMenu._hovered().subscribe(t=>{t===this._menuItemInstance&&!t.disabled&&(this._openedBy="mouse",this.openMenu())}))}_getPortal(t){return(!this._portal||this._portal.templateRef!==t.templateRef)&&(this._portal=new eI(t.templateRef,this._viewContainerRef)),this._portal}_ownsMenu(t){return eT.get(t)===this}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","mat-menu-trigger-for",""],["","matMenuTriggerFor",""]],hostAttrs:[1,"mat-mdc-menu-trigger"],hostVars:3,hostBindings:function(i,r){1&i&&Nn("click",function(h){return r._handleClick(h)})("mousedown",function(h){return r._handleMousedown(h)})("keydown",function(h){return r._handleKeydown(h)}),2&i&&ui("aria-haspopup",r.menu?"menu":null)("aria-expanded",r.menuOpen)("aria-controls",r.menuOpen?r.menu.panelId:null)},inputs:{_deprecatedMatMenuTriggerFor:[0,"mat-menu-trigger-for","_deprecatedMatMenuTriggerFor"],menu:[0,"matMenuTriggerFor","menu"],menuData:[0,"matMenuTriggerData","menuData"],restoreFocus:[0,"matMenuTriggerRestoreFocus","restoreFocus"]},outputs:{menuOpened:"menuOpened",onMenuOpen:"onMenuOpen",menuClosed:"menuClosed",onMenuClose:"onMenuClose"},exportAs:["matMenuTrigger"]})}return e})(),N6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[Vue],imports:[GC,or,HO,O_,or]})}return e})();const jue=["trigger"],Hue=["panel"],$ue=[[["mat-select-trigger"]],"*"],Gue=["mat-select-trigger","*"];function que(e,n){if(1&e&&(Fe(0,"span",4),gt(1),Ue()),2&e){const t=cn();Ze(),br(t.placeholder)}}function Wue(e,n){1&e&&ai(0)}function Zue(e,n){if(1&e&&(Fe(0,"span",11),gt(1),Ue()),2&e){const t=cn(2);Ze(),br(t.triggerValue)}}function Yue(e,n){if(1&e&&(Fe(0,"span",5),an(1,Wue,1,0)(2,Zue,2,1,"span",11),Ue()),2&e){const t=cn();Ze(),Mr(t.customTrigger?1:2)}}function Xue(e,n){if(1&e){const t=Is();Fe(0,"div",12,1),Nn("@transformPanel.done",function(r){return Di(t),Ii(cn()._panelDoneAnimatingStream.next(r.toState))})("keydown",function(r){return Di(t),Ii(cn()._handleKeydown(r))}),ai(2,1),Ue()}if(2&e){const t=cn();(function Oz(e,n,t){yh(Ba,Gf,Q0(yt(),e,n,t),!0)})("mat-mdc-select-panel mdc-menu-surface mdc-menu-surface--open ",t._getPanelTheme(),""),At("ngClass",t.panelClass)("@transformPanel","showing"),ui("id",t.id+"-panel")("aria-multiselectable",t.multiple)("aria-label",t.ariaLabel||null)("aria-labelledby",t._getPanelAriaLabelledby())}}const Kue={transformPanelWrap:Us("transformPanelWrap",[Hr("* => void",c4("@transformPanel",[l4()],{optional:!0}))]),transformPanel:Us("transformPanel",[Or("void",yi({opacity:0,transform:"scale(1, 0.8)"})),Hr("void => showing",no("120ms cubic-bezier(0, 0, 0.2, 1)",yi({opacity:1,transform:"scale(1, 1)"}))),Hr("* => void",no("100ms linear",yi({opacity:0})))])},B6=new ct("mat-select-scroll-strategy",{providedIn:"root",factory:()=>{const e=re(fu);return()=>e.scrollStrategies.reposition()}}),Jue=new ct("MAT_SELECT_CONFIG"),ehe={provide:B6,deps:[fu],useFactory:function Que(e){return()=>e.scrollStrategies.reposition()}},the=new ct("MatSelectTrigger");class nhe{source;value;constructor(n,t){this.source=n,this.value=t}}let V6=(()=>{class e{_viewportRuler=re(QC);_changeDetectorRef=re(Bo);_elementRef=re(In);_dir=re(Om,{optional:!0});_idGenerator=re(du);_parentFormField=re(RO,{optional:!0});ngControl=re(Kf,{self:!0,optional:!0});_liveAnnouncer=re(cle);_defaultOptions=re(Jue,{optional:!0});_initialized=new Ie;options;optionGroups;customTrigger;_positions=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"},{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:"mat-mdc-select-panel-above"}];_scrollOptionIntoView(t){const i=this.options.toArray()[t];if(i){const r=this.panel.nativeElement,a=function zle(e,n,t){if(t.length){let i=n.toArray(),r=t.toArray(),a=0;for(let h=0;h<e+1;h++)i[h].group&&i[h].group===r[a]&&a++;return a}return 0}(t,this.options,this.optionGroups),h=i._getHostElement();r.scrollTop=0===t&&1===a?0:function Ble(e,n,t,i){return e<t?e:e+n>t+i?Math.max(0,e-i+n):t}(h.offsetTop,h.offsetHeight,r.scrollTop,r.offsetHeight)}}_positioningSettled(){this._scrollOptionIntoView(this._keyManager.activeItemIndex||0)}_getChangeEvent(t){return new nhe(this,t)}_scrollStrategyFactory=re(B6);_panelOpen=!1;_compareWith=(t,i)=>t===i;_uid=this._idGenerator.getId("mat-select-");_triggerAriaLabelledBy=null;_previousControl;_destroy=new Ie;_errorStateTracker;stateChanges=new Ie;disableAutomaticLabeling=!0;userAriaDescribedBy;_selectionModel;_keyManager;_preferredOverlayOrigin;_overlayWidth;_onChange=()=>{};_onTouched=()=>{};_valueId=this._idGenerator.getId("mat-select-value-");_panelDoneAnimatingStream=new Ie;_scrollStrategy;_overlayPanelClass=this._defaultOptions?.overlayPanelClass||"";get focused(){return this._focused||this._panelOpen}_focused=!1;controlType="mat-select";trigger;panel;_overlayDir;panelClass;disabled=!1;disableRipple=!1;tabIndex=0;get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=t,this._syncParentProperties()}_hideSingleSelectionIndicator=this._defaultOptions?.hideSingleSelectionIndicator??!1;get placeholder(){return this._placeholder}set placeholder(t){this._placeholder=t,this.stateChanges.next()}_placeholder;get required(){return this._required??this.ngControl?.control?.hasValidator(gU.required)??!1}set required(t){this._required=t,this.stateChanges.next()}_required;get multiple(){return this._multiple}set multiple(t){this._multiple=t}_multiple=!1;disableOptionCentering=this._defaultOptions?.disableOptionCentering??!1;get compareWith(){return this._compareWith}set compareWith(t){this._compareWith=t,this._selectionModel&&this._initializeSelection()}get value(){return this._value}set value(t){this._assignValue(t)&&this._onChange(t)}_value;ariaLabel="";ariaLabelledby;get errorStateMatcher(){return this._errorStateTracker.matcher}set errorStateMatcher(t){this._errorStateTracker.matcher=t}typeaheadDebounceInterval;sortComparator;get id(){return this._id}set id(t){this._id=t||this._uid,this.stateChanges.next()}_id;get errorState(){return this._errorStateTracker.errorState}set errorState(t){this._errorStateTracker.errorState=t}panelWidth=this._defaultOptions&&typeof this._defaultOptions.panelWidth<"u"?this._defaultOptions.panelWidth:"auto";canSelectNullableOptions=this._defaultOptions?.canSelectNullableOptions??!1;optionSelectionChanges=iP(()=>{const t=this.options;return t?t.changes.pipe(Ch(t),Aa(()=>Cl(...t.map(i=>i.onSelectionChange)))):this._initialized.pipe(Aa(()=>this.optionSelectionChanges))});openedChange=new Dt;_openedStream=this.openedChange.pipe(is(t=>t),$t(()=>{}));_closedStream=this.openedChange.pipe(is(t=>!t),$t(()=>{}));selectionChange=new Dt;valueChange=new Dt;constructor(){const t=re(gH),i=re(FC,{optional:!0}),r=re(LC,{optional:!0}),a=re(new pt("tabindex"),{optional:!0});this.ngControl&&(this.ngControl.valueAccessor=this),null!=this._defaultOptions?.typeaheadDebounceInterval&&(this.typeaheadDebounceInterval=this._defaultOptions.typeaheadDebounceInterval),this._errorStateTracker=new mH(t,this.ngControl,r,i,this.stateChanges),this._scrollStrategy=this._scrollStrategyFactory(),this.tabIndex=null==a?0:parseInt(a)||0,this.id=this.id}ngOnInit(){this._selectionModel=new FO(this.multiple),this.stateChanges.next(),this._panelDoneAnimatingStream.pipe(Zj(),Er(this._destroy)).subscribe(()=>this._panelDoneAnimating(this.panelOpen)),this._viewportRuler.change().pipe(Er(this._destroy)).subscribe(()=>{this.panelOpen&&(this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._changeDetectorRef.detectChanges())})}ngAfterContentInit(){this._initialized.next(),this._initialized.complete(),this._initKeyManager(),this._selectionModel.changed.pipe(Er(this._destroy)).subscribe(t=>{t.added.forEach(i=>i.select()),t.removed.forEach(i=>i.deselect())}),this.options.changes.pipe(Ch(null),Er(this._destroy)).subscribe(()=>{this._resetOptions(),this._initializeSelection()})}ngDoCheck(){const t=this._getTriggerAriaLabelledby(),i=this.ngControl;if(t!==this._triggerAriaLabelledBy){const r=this._elementRef.nativeElement;this._triggerAriaLabelledBy=t,t?r.setAttribute("aria-labelledby",t):r.removeAttribute("aria-labelledby")}i&&(this._previousControl!==i.control&&(void 0!==this._previousControl&&null!==i.disabled&&i.disabled!==this.disabled&&(this.disabled=i.disabled),this._previousControl=i.control),this.updateErrorState())}ngOnChanges(t){(t.disabled||t.userAriaDescribedBy)&&this.stateChanges.next(),t.typeaheadDebounceInterval&&this._keyManager&&this._keyManager.withTypeAhead(this.typeaheadDebounceInterval)}ngOnDestroy(){this._keyManager?.destroy(),this._destroy.next(),this._destroy.complete(),this.stateChanges.complete(),this._clearFromModal()}toggle(){this.panelOpen?this.close():this.open()}open(){this._canOpen()&&(this._parentFormField&&(this._preferredOverlayOrigin=this._parentFormField.getConnectedOverlayOrigin()),this._overlayWidth=this._getOverlayWidth(this._preferredOverlayOrigin),this._applyModalPanelOwnership(),this._panelOpen=!0,this._keyManager.withHorizontalOrientation(null),this._highlightCorrectOption(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_trackedModal=null;_applyModalPanelOwnership(){const t=this._elementRef.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!t)return;const i=`${this.id}-panel`;this._trackedModal&&mO(this._trackedModal,"aria-owns",i),tH(t,"aria-owns",i),this._trackedModal=t}_clearFromModal(){this._trackedModal&&(mO(this._trackedModal,"aria-owns",`${this.id}-panel`),this._trackedModal=null)}close(){this._panelOpen&&(this._panelOpen=!1,this._keyManager.withHorizontalOrientation(this._isRtl()?"rtl":"ltr"),this._changeDetectorRef.markForCheck(),this._onTouched(),this.stateChanges.next())}writeValue(t){this._assignValue(t)}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this.disabled=t,this._changeDetectorRef.markForCheck(),this.stateChanges.next()}get panelOpen(){return this._panelOpen}get selected(){return this.multiple?this._selectionModel?.selected||[]:this._selectionModel?.selected[0]}get triggerValue(){if(this.empty)return"";if(this._multiple){const t=this._selectionModel.selected.map(i=>i.viewValue);return this._isRtl()&&t.reverse(),t.join(", ")}return this._selectionModel.selected[0].viewValue}updateErrorState(){this._errorStateTracker.updateErrorState()}_isRtl(){return!!this._dir&&"rtl"===this._dir.value}_handleKeydown(t){this.disabled||(this.panelOpen?this._handleOpenKeydown(t):this._handleClosedKeydown(t))}_handleClosedKeydown(t){const i=t.keyCode,r=40===i||38===i||37===i||39===i,a=13===i||32===i,h=this._keyManager;if(!h.isTyping()&&a&&!Pm(t)||(this.multiple||t.altKey)&&r)t.preventDefault(),this.open();else if(!this.multiple){const v=this.selected;h.onKeydown(t);const C=this.selected;C&&v!==C&&this._liveAnnouncer.announce(C.viewValue,1e4)}}_handleOpenKeydown(t){const i=this._keyManager,r=t.keyCode,a=40===r||38===r,h=i.isTyping();if(a&&t.altKey)t.preventDefault(),this.close();else if(h||13!==r&&32!==r||!i.activeItem||Pm(t))if(!h&&this._multiple&&65===r&&t.ctrlKey){t.preventDefault();const v=this.options.some(C=>!C.disabled&&!C.selected);this.options.forEach(C=>{C.disabled||(v?C.select():C.deselect())})}else{const v=i.activeItemIndex;i.onKeydown(t),this._multiple&&a&&t.shiftKey&&i.activeItem&&i.activeItemIndex!==v&&i.activeItem._selectViaInteraction()}else t.preventDefault(),i.activeItem._selectViaInteraction()}_onFocus(){this.disabled||(this._focused=!0,this.stateChanges.next())}_onBlur(){this._focused=!1,this._keyManager?.cancelTypeahead(),!this.disabled&&!this.panelOpen&&(this._onTouched(),this._changeDetectorRef.markForCheck(),this.stateChanges.next())}_onAttached(){this._overlayDir.positionChange.pipe(Ac(1)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this._positioningSettled()})}_getPanelTheme(){return this._parentFormField?`mat-${this._parentFormField.color}`:""}get empty(){return!this._selectionModel||this._selectionModel.isEmpty()}_initializeSelection(){Promise.resolve().then(()=>{this.ngControl&&(this._value=this.ngControl.value),this._setSelectionByValue(this._value),this.stateChanges.next()})}_setSelectionByValue(t){if(this.options.forEach(i=>i.setInactiveStyles()),this._selectionModel.clear(),this.multiple&&t)Array.isArray(t),t.forEach(i=>this._selectOptionByValue(i)),this._sortValues();else{const i=this._selectOptionByValue(t);i?this._keyManager.updateActiveItem(i):this.panelOpen||this._keyManager.updateActiveItem(-1)}this._changeDetectorRef.markForCheck()}_selectOptionByValue(t){const i=this.options.find(r=>{if(this._selectionModel.isSelected(r))return!1;try{return(null!=r.value||this.canSelectNullableOptions)&&this._compareWith(r.value,t)}catch{return!1}});return i&&this._selectionModel.select(i),i}_assignValue(t){return!!(t!==this._value||this._multiple&&Array.isArray(t))&&(this.options&&this._setSelectionByValue(t),this._value=t,!0)}_skipPredicate=t=>!this.panelOpen&&t.disabled;_getOverlayWidth(t){return"auto"===this.panelWidth?(t instanceof iI?t.elementRef:t||this._elementRef).nativeElement.getBoundingClientRect().width:null===this.panelWidth?"":this.panelWidth}_syncParentProperties(){if(this.options)for(const t of this.options)t._changeDetectorRef.markForCheck()}_initKeyManager(){this._keyManager=new qae(this.options).withTypeAhead(this.typeaheadDebounceInterval).withVerticalOrientation().withHorizontalOrientation(this._isRtl()?"rtl":"ltr").withHomeAndEnd().withPageUpDown().withAllowedModifierKeys(["shiftKey"]).skipPredicate(this._skipPredicate),this._keyManager.tabOut.subscribe(()=>{this.panelOpen&&(!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction(),this.focus(),this.close())}),this._keyManager.change.subscribe(()=>{this._panelOpen&&this.panel?this._scrollOptionIntoView(this._keyManager.activeItemIndex||0):!this._panelOpen&&!this.multiple&&this._keyManager.activeItem&&this._keyManager.activeItem._selectViaInteraction()})}_resetOptions(){const t=Cl(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(Er(t)).subscribe(i=>{this._onSelect(i.source,i.isUserInput),i.isUserInput&&!this.multiple&&this._panelOpen&&(this.close(),this.focus())}),Cl(...this.options.map(i=>i._stateChanges)).pipe(Er(t)).subscribe(()=>{this._changeDetectorRef.detectChanges(),this.stateChanges.next()})}_onSelect(t,i){const r=this._selectionModel.isSelected(t);this.canSelectNullableOptions||null!=t.value||this._multiple?(r!==t.selected&&(t.selected?this._selectionModel.select(t):this._selectionModel.deselect(t)),i&&this._keyManager.setActiveItem(t),this.multiple&&(this._sortValues(),i&&this.focus())):(t.deselect(),this._selectionModel.clear(),null!=this.value&&this._propagateChanges(t.value)),r!==this._selectionModel.isSelected(t)&&this._propagateChanges(),this.stateChanges.next()}_sortValues(){if(this.multiple){const t=this.options.toArray();this._selectionModel.sort((i,r)=>this.sortComparator?this.sortComparator(i,r,t):t.indexOf(i)-t.indexOf(r)),this.stateChanges.next()}}_propagateChanges(t){let i;i=this.multiple?this.selected.map(r=>r.value):this.selected?this.selected.value:t,this._value=i,this.valueChange.emit(i),this._onChange(i),this.selectionChange.emit(this._getChangeEvent(i)),this._changeDetectorRef.markForCheck()}_highlightCorrectOption(){if(this._keyManager)if(this.empty){let t=-1;for(let i=0;i<this.options.length;i++)if(!this.options.get(i).disabled){t=i;break}this._keyManager.setActiveItem(t)}else this._keyManager.setActiveItem(this._selectionModel.selected[0])}_canOpen(){return!this._panelOpen&&!this.disabled&&this.options?.length>0}focus(t){this._elementRef.nativeElement.focus(t)}_getPanelAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId()||null;return this.ariaLabelledby?(t?t+" ":"")+this.ariaLabelledby:t}_getAriaActiveDescendant(){return this.panelOpen&&this._keyManager&&this._keyManager.activeItem?this._keyManager.activeItem.id:null}_getTriggerAriaLabelledby(){if(this.ariaLabel)return null;const t=this._parentFormField?.getLabelId();let i=(t?t+" ":"")+this._valueId;return this.ariaLabelledby&&(i+=" "+this.ariaLabelledby),i}_panelDoneAnimating(t){this.openedChange.emit(t)}setDescribedByIds(t){t.length?this._elementRef.nativeElement.setAttribute("aria-describedby",t.join(" ")):this._elementRef.nativeElement.removeAttribute("aria-describedby")}onContainerClick(){this.focus(),this.open()}get shouldLabelFloat(){return this.panelOpen||!this.empty||this.focused&&!!this.placeholder}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-select"]],contentQueries:function(i,r,a){if(1&i&&(bo(a,the,5),bo(a,wO,5),bo(a,TH,5)),2&i){let h;ri(h=oi())&&(r.customTrigger=h.first),ri(h=oi())&&(r.options=h),ri(h=oi())&&(r.optionGroups=h)}},viewQuery:function(i,r){if(1&i&&(zr(jue,5),zr(Hue,5),zr(O6,5)),2&i){let a;ri(a=oi())&&(r.trigger=a.first),ri(a=oi())&&(r.panel=a.first),ri(a=oi())&&(r._overlayDir=a.first)}},hostAttrs:["role","combobox","aria-haspopup","listbox",1,"mat-mdc-select"],hostVars:19,hostBindings:function(i,r){1&i&&Nn("keydown",function(h){return r._handleKeydown(h)})("focus",function(){return r._onFocus()})("blur",function(){return r._onBlur()}),2&i&&(ui("id",r.id)("tabindex",r.disabled?-1:r.tabIndex)("aria-controls",r.panelOpen?r.id+"-panel":null)("aria-expanded",r.panelOpen)("aria-label",r.ariaLabel||null)("aria-required",r.required.toString())("aria-disabled",r.disabled.toString())("aria-invalid",r.errorState)("aria-activedescendant",r._getAriaActiveDescendant()),Ti("mat-mdc-select-disabled",r.disabled)("mat-mdc-select-invalid",r.errorState)("mat-mdc-select-required",r.required)("mat-mdc-select-empty",r.empty)("mat-mdc-select-multiple",r.multiple))},inputs:{userAriaDescribedBy:[0,"aria-describedby","userAriaDescribedBy"],panelClass:"panelClass",disabled:[2,"disabled","disabled",zn],disableRipple:[2,"disableRipple","disableRipple",zn],tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:Ya(t)],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",zn],placeholder:"placeholder",required:[2,"required","required",zn],multiple:[2,"multiple","multiple",zn],disableOptionCentering:[2,"disableOptionCentering","disableOptionCentering",zn],compareWith:"compareWith",value:"value",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],errorStateMatcher:"errorStateMatcher",typeaheadDebounceInterval:[2,"typeaheadDebounceInterval","typeaheadDebounceInterval",Ya],sortComparator:"sortComparator",id:"id",panelWidth:"panelWidth",canSelectNullableOptions:[2,"canSelectNullableOptions","canSelectNullableOptions",zn]},outputs:{openedChange:"openedChange",_openedStream:"opened",_closedStream:"closed",selectionChange:"selectionChange",valueChange:"valueChange"},exportAs:["matSelect"],features:[Jn([{provide:AO,useExisting:e},{provide:CH,useExisting:e}]),jr,sr],ngContentSelectors:Gue,decls:11,vars:8,consts:[["fallbackOverlayOrigin","cdkOverlayOrigin","trigger",""],["panel",""],["cdk-overlay-origin","",1,"mat-mdc-select-trigger",3,"click"],[1,"mat-mdc-select-value"],[1,"mat-mdc-select-placeholder","mat-mdc-select-min-line"],[1,"mat-mdc-select-value-text"],[1,"mat-mdc-select-arrow-wrapper"],[1,"mat-mdc-select-arrow"],["viewBox","0 0 24 24","width","24px","height","24px","focusable","false","aria-hidden","true"],["d","M7 10l5 5 5-5z"],["cdk-connected-overlay","","cdkConnectedOverlayLockPosition","","cdkConnectedOverlayHasBackdrop","","cdkConnectedOverlayBackdropClass","cdk-overlay-transparent-backdrop",3,"backdropClick","attach","detach","cdkConnectedOverlayPanelClass","cdkConnectedOverlayScrollStrategy","cdkConnectedOverlayOrigin","cdkConnectedOverlayOpen","cdkConnectedOverlayPositions","cdkConnectedOverlayWidth"],[1,"mat-mdc-select-min-line"],["role","listbox","tabindex","-1",3,"keydown","ngClass"]],template:function(i,r){if(1&i){const a=Is();zo($ue),Fe(0,"div",2,0),Nn("click",function(){return Di(a),Ii(r.open())}),Fe(3,"div",3),an(4,que,2,1,"span",4)(5,Yue,3,1,"span",5),Ue(),Fe(6,"div",6)(7,"div",7),Ma(),Fe(8,"svg",8),_n(9,"path",9),Ue()()()(),an(10,Xue,3,9,"ng-template",10),Nn("backdropClick",function(){return Di(a),Ii(r.close())})("attach",function(){return Di(a),Ii(r._onAttached())})("detach",function(){return Di(a),Ii(r.close())})}if(2&i){const a=Za(1);Ze(3),ui("id",r._valueId),Ze(),Mr(r.empty?4:5),Ze(6),At("cdkConnectedOverlayPanelClass",r._overlayPanelClass)("cdkConnectedOverlayScrollStrategy",r._scrollStrategy)("cdkConnectedOverlayOrigin",r._preferredOverlayOrigin||a)("cdkConnectedOverlayOpen",r.panelOpen)("cdkConnectedOverlayPositions",r._positions)("cdkConnectedOverlayWidth",r._overlayWidth)}},dependencies:[iI,O6,w_],styles:['.mat-mdc-select{display:inline-block;width:100%;outline:none;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-select-enabled-trigger-text-color, var(--mat-sys-on-surface));font-family:var(--mat-select-trigger-text-font, var(--mat-sys-body-large-font));line-height:var(--mat-select-trigger-text-line-height, var(--mat-sys-body-large-line-height));font-size:var(--mat-select-trigger-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-select-trigger-text-weight, var(--mat-sys-body-large-weight));letter-spacing:var(--mat-select-trigger-text-tracking, var(--mat-sys-body-large-tracking))}div.mat-mdc-select-panel{box-shadow:var(--mat-select-container-elevation-shadow, 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12))}.mat-mdc-select-disabled{color:var(--mat-select-disabled-trigger-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-trigger{display:inline-flex;align-items:center;cursor:pointer;position:relative;box-sizing:border-box;width:100%}.mat-mdc-select-disabled .mat-mdc-select-trigger{-webkit-user-select:none;user-select:none;cursor:default}.mat-mdc-select-value{width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.mat-mdc-select-value-text{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.mat-mdc-select-arrow-wrapper{height:24px;flex-shrink:0;display:inline-flex;align-items:center}.mat-form-field-appearance-fill .mdc-text-field--no-label .mat-mdc-select-arrow-wrapper{transform:none}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-invalid .mat-mdc-select-arrow,.mat-form-field-invalid:not(.mat-form-field-disabled) .mat-mdc-form-field-infix::after{color:var(--mat-select-invalid-arrow-color, var(--mat-sys-error))}.mat-mdc-select-arrow{width:10px;height:5px;position:relative;color:var(--mat-select-enabled-arrow-color, var(--mat-sys-on-surface-variant))}.mat-mdc-form-field.mat-focused .mat-mdc-select-arrow{color:var(--mat-select-focused-arrow-color, var(--mat-sys-primary))}.mat-mdc-form-field .mat-mdc-select.mat-mdc-select-disabled .mat-mdc-select-arrow{color:var(--mat-select-disabled-arrow-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-mdc-select-arrow svg{fill:currentColor;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}@media(forced-colors: active){.mat-mdc-select-arrow svg{fill:CanvasText}.mat-mdc-select-disabled .mat-mdc-select-arrow svg{fill:GrayText}}div.mat-mdc-select-panel{width:100%;max-height:275px;outline:0;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-select-panel-background-color, var(--mat-sys-surface-container))}@media(forced-colors: active){div.mat-mdc-select-panel{outline:solid 1px}}.cdk-overlay-pane:not(.mat-mdc-select-panel-above) div.mat-mdc-select-panel{border-top-left-radius:0;border-top-right-radius:0;transform-origin:top center}.mat-mdc-select-panel-above div.mat-mdc-select-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:bottom center}div.mat-mdc-select-panel .mat-mdc-option{--mdc-list-list-item-container-color: var(--mat-select-panel-background-color)}.mat-mdc-select-placeholder{transition:color 400ms 133.3333333333ms cubic-bezier(0.25, 0.8, 0.25, 1);color:var(--mat-select-placeholder-text-color, var(--mat-sys-on-surface-variant))}._mat-animation-noopable .mat-mdc-select-placeholder{transition:none}.mat-form-field-hide-placeholder .mat-mdc-select-placeholder{color:rgba(0,0,0,0);-webkit-text-fill-color:rgba(0,0,0,0);transition:none;display:block}.mat-mdc-form-field-type-mat-select:not(.mat-form-field-disabled) .mat-mdc-text-field-wrapper{cursor:pointer}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mat-mdc-floating-label{max-width:calc(100% - 18px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-fill .mdc-floating-label--float-above{max-width:calc(100%/0.75 - 24px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-notched-outline__notch{max-width:calc(100% - 60px)}.mat-mdc-form-field-type-mat-select.mat-form-field-appearance-outline .mdc-text-field--label-floating .mdc-notched-outline__notch{max-width:calc(100% - 24px)}.mat-mdc-select-min-line:empty::before{content:" ";white-space:pre;width:1px;display:inline-block;visibility:hidden}.mat-form-field-appearance-fill .mat-mdc-select-arrow-wrapper{transform:var(--mat-select-arrow-transform, translateY(-8px))}'],encapsulation:2,data:{animation:[Kue.transformPanel]},changeDetection:0})}return e})(),qO=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[ehe],imports:[HO,MH,or,O_,PO,MH,or]})}return e})();const ihe=["tooltip"],j6=new ct("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{const e=re(fu);return()=>e.scrollStrategies.reposition({scrollThrottle:20})}}),ohe={provide:j6,deps:[fu],useFactory:function rhe(e){return()=>e.scrollStrategies.reposition({scrollThrottle:20})}},ahe=new ct("mat-tooltip-default-options",{providedIn:"root",factory:function she(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}}),H6="tooltip-panel",$6=cu({passive:!0});let hhe=(()=>{class e{_overlay=re(fu);_elementRef=re(In);_scrollDispatcher=re(BO);_viewContainerRef=re(ms);_ngZone=re(Ht);_platform=re(Hs);_ariaDescriber=re(iH);_focusMonitor=re(Lx);_dir=re(Om);_injector=re(Ye);_defaultOptions=re(ahe,{optional:!0});_overlayRef;_tooltipInstance;_portal;_position="below";_positionAtOrigin=!1;_disabled=!1;_tooltipClass;_scrollStrategy=re(j6);_viewInitialized=!1;_pointerExitEventsInitialized=!1;_tooltipComponent=fhe;_viewportMargin=8;_currentPosition;_cssClassPrefix="mat-mdc";_ariaDescriptionPending;_dirSubscribed=!1;get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=Fc(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){const i=Fc(t);this._disabled!==i&&(this._disabled=i,i?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=Ox(t)}_showDelay;get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=Ox(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}_hideDelay;touchGestures="auto";get message(){return this._message}set message(t){const i=this._message;this._message=null!=t?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(i)}_message="";get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}_passiveListeners=[];_document=re(ir);_touchstartTimeout=null;_destroyed=new Ie;constructor(){const t=this._defaultOptions;t&&(this._showDelay=t.showDelay,this._hideDelay=t.hideDelay,t.position&&(this.position=t.position),t.positionAtOrigin&&(this.positionAtOrigin=t.positionAtOrigin),t.touchGestures&&(this.touchGestures=t.touchGestures),t.tooltipClass&&(this.tooltipClass=t.tooltipClass)),this._viewportMargin=8}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(Er(this._destroyed)).subscribe(t=>{t?"keyboard"===t&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const t=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,r])=>{t.removeEventListener(i,r,$6)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,i){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const r=this._createOverlay(i);this._detach(),this._portal=this._portal||new p6(this._tooltipComponent,this._viewContainerRef);const a=this._tooltipInstance=r.attach(this._portal).instance;a._triggerElement=this._elementRef.nativeElement,a._mouseLeaveHideDelay=this._hideDelay,a.afterHidden().pipe(Er(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),a.show(t)}hide(t=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(t):(i._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){const a=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&a._origin instanceof In)return this._overlayRef;this._detach()}const i=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),r=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin&&t||this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(i);return r.positionChanges.pipe(Er(this._destroyed)).subscribe(a=>{this._updateCurrentPositionClass(a.connectionPair),this._tooltipInstance&&a.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:r,panelClass:`${this._cssClassPrefix}-${H6}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(Er(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(Er(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(Er(this._destroyed)).subscribe(a=>{this._isTooltipVisible()&&27===a.keyCode&&!Pm(a)&&(a.preventDefault(),a.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._dirSubscribed||(this._dirSubscribed=!0,this._dir.change.pipe(Er(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){const i=t.getConfig().positionStrategy,r=this._getOrigin(),a=this._getOverlayPosition();i.withPositions([this._addOffset({...r.main,...a.main}),this._addOffset({...r.fallback,...a.fallback})])}_addOffset(t){const r=!this._dir||"ltr"==this._dir.value;return"top"===t.originY?t.offsetY=-8:"bottom"===t.originY?t.offsetY=8:"start"===t.originX?t.offsetX=r?-8:8:"end"===t.originX&&(t.offsetX=r?8:-8),t}_getOrigin(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i||"below"==i?r={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={originX:"start",originY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={originX:"end",originY:"center"});const{x:a,y:h}=this._invertPosition(r.originX,r.originY);return{main:r,fallback:{originX:a,originY:h}}}_getOverlayPosition(){const t=!this._dir||"ltr"==this._dir.value,i=this.position;let r;"above"==i?r={overlayX:"center",overlayY:"bottom"}:"below"==i?r={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&t||"right"==i&&!t?r={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&t||"left"==i&&!t)&&(r={overlayX:"start",overlayY:"center"});const{x:a,y:h}=this._invertPosition(r.overlayX,r.overlayY);return{main:r,fallback:{overlayX:a,overlayY:h}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),Tc(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===t?t="start":"start"===t&&(t="end"),{x:t,y:i}}_updateCurrentPositionClass(t){const{overlayY:i,originX:r,originY:a}=t;let h;if(h="center"===i?this._dir&&"rtl"===this._dir.value?"end"===r?"left":"right":"start"===r?"left":"right":"bottom"===i&&"top"===a?"above":"below",h!==this._currentPosition){const v=this._overlayRef;if(v){const C=`${this._cssClassPrefix}-${H6}-`;v.removePanelClass(C+this._currentPosition),v.addPanelClass(C+h)}this._currentPosition=h}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{let i;this._setupPointerExitEventsIfNeeded(),void 0!==t.x&&void 0!==t.y&&(i=t),this.show(void 0,i)}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{const i=t.targetTouches?.[0],r=i?{x:i.clientX,y:i.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,r)},this._defaultOptions?.touchLongPressShowDelay??500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",i=>{const r=i.relatedTarget;(!r||!this._overlayRef?.overlayElement.contains(r))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions?.touchendHideDelay)};t.push(["touchend",i],["touchcancel",i])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([i,r])=>{this._elementRef.nativeElement.addEventListener(i,r,$6)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(t.clientX,t.clientY),r=this._elementRef.nativeElement;i!==r&&!r.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const t=this.touchGestures;if("off"!==t){const i=this._elementRef.nativeElement,r=i.style;("on"===t||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(r.userSelect=r.msUserSelect=r.webkitUserSelect=r.MozUserSelect="none"),("on"===t||!i.draggable)&&(r.webkitUserDrag="none"),r.touchAction="none",r.webkitTapHighlightColor="transparent"}}_syncAriaDescription(t){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,t,"tooltip"),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(i,r){2&i&&Ti("mat-mdc-tooltip-disabled",r.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"]})}return e})(),fhe=(()=>{class e{_changeDetectorRef=re(Bo);_elementRef=re(In);_isMultiline=!1;message;tooltipClass;_showTimeoutId;_hideTimeoutId;_triggerElement;_mouseLeaveHideDelay;_animationsDisabled;_tooltip;_closeOnInteraction=!1;_isVisible=!1;_onHide=new Ie;_showAnimation="mat-mdc-tooltip-show";_hideAnimation="mat-mdc-tooltip-hide";constructor(){const t=re(Ga,{optional:!0});this._animationsDisabled="NoopAnimations"===t}show(t){null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){const t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>24&&t.width>=200}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){null!=this._showTimeoutId&&clearTimeout(this._showTimeoutId),null!=this._hideTimeoutId&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){const i=this._tooltip.nativeElement,r=this._showAnimation,a=this._hideAnimation;if(i.classList.remove(t?a:r),i.classList.add(t?r:a),this._isVisible!==t&&(this._isVisible=t,this._changeDetectorRef.markForCheck()),t&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const h=getComputedStyle(i);("0s"===h.getPropertyValue("animation-duration")||"none"===h.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-tooltip-component"]],viewQuery:function(i,r){if(1&i&&zr(ihe,7),2&i){let a;ri(a=oi())&&(r._tooltip=a.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(i,r){1&i&&Nn("mouseleave",function(h){return r._handleMouseLeave(h)})},decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(i,r){if(1&i){const a=Is();Fe(0,"div",1,0),Nn("animationend",function(v){return Di(a),Ii(r._handleAnimationEnd(v))}),Fe(2,"div",2),gt(3),Ue()()}2&i&&(Ti("mdc-tooltip--multiline",r._isMultiline),At("ngClass",r.tooltipClass),Ze(3),br(r.message))},dependencies:[w_],styles:['.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-sys-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-sys-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-sys-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-sys-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-sys-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-sys-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-sys-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-sys-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel{line-height:normal}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}return e})(),phe=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[ohe],imports:[ule,HO,or,or,O_]})}return e})();function mhe(e,n){if(1&e&&(Fe(0,"mat-option",17),gt(1),Ue()),2&e){const t=n.$implicit;At("value",t),Ze(),Sr(" ",t," ")}}function ghe(e,n){if(1&e){const t=Is();Fe(0,"mat-form-field",14)(1,"mat-select",16,0),Nn("selectionChange",function(r){return Di(t),Ii(cn(2)._changePageSize(r.value))}),function Bz(e,n,t,i,r,a,h,v,C,P,L,V,W){Es("NgControlFlow");const X=yt(),oe=fi(),he=void 0!==C,se=yt(),_e=v?h.bind(se[15][8]):h,Se=new z9(he,_e);se[25+e]=Se,V1(X,oe,e+1,n,t,i,r,ws(oe.consts,a)),he&&V1(X,oe,e+2,C,P,L,V,ws(oe.consts,W))}(3,mhe,2,2,"mat-option",17,zz),Ue(),Fe(5,"div",18),Nn("click",function(){return Di(t),Ii(Za(2).open())}),Ue()()}if(2&e){const t=cn(2);At("appearance",t._formFieldAppearance)("color",t.color),Ze(),At("value",t.pageSize)("disabled",t.disabled)("aria-labelledby",t._pageSizeLabelId)("panelClass",t.selectConfig.panelClass||"")("disableOptionCentering",t.selectConfig.disableOptionCentering),Ze(2),function Vz(e){const n=Xn(null),t=ts();try{const i=yt(),r=i[1],a=i[t],h=t+1,v=HS(i,h);if(void 0===a.liveCollection){const P=vR(r,h);a.liveCollection=new B9(v,i,P)}else a.liveCollection.reset();const C=a.liveCollection;if(function F9(e,n,t){let i,r,a=0,h=e.length-1;if(Array.isArray(n)){let C=n.length-1;for(;a<=h&&a<=C;){const P=e.at(a),L=n[a],V=_R(a,P,a,L,t);if(0!==V){V<0&&e.updateValue(a,L),a++;continue}const W=e.at(h),X=n[C],oe=_R(h,W,C,X,t);if(0!==oe){oe<0&&e.updateValue(h,X),h--,C--;continue}const he=t(a,P),se=t(h,W),_e=t(a,L);if(Object.is(_e,se)){const Se=t(C,X);Object.is(Se,he)?(e.swap(a,h),e.updateValue(h,X),C--,h--):e.move(h,a),e.updateValue(a,L),a++}else if(i??=new Nz,r??=Lz(e,a,h,t),yR(e,i,a,_e))e.updateValue(a,L),a++,h++;else if(r.has(_e))i.set(he,e.detach(a)),h--;else{const Se=e.create(a,n[a]);e.attach(a,Se),a++,h++}}for(;a<=C;)Fz(e,i,t,a,n[a]),a++}else if(null!=n){const C=n[Symbol.iterator]();let P=C.next();for(;!P.done&&a<=h;){const L=e.at(a),V=P.value,W=_R(a,L,a,V,t);if(0!==W)W<0&&e.updateValue(a,V),a++,P=C.next();else{i??=new Nz,r??=Lz(e,a,h,t);const X=t(a,V);if(yR(e,i,a,X))e.updateValue(a,V),a++,h++,P=C.next();else if(r.has(X)){const oe=t(a,L);i.set(oe,e.detach(a)),h--}else e.attach(a,e.create(a,V)),a++,h++,P=C.next()}}for(;!P.done;)Fz(e,i,t,e.length,P.value),P=C.next()}for(;a<=h;)e.destroy(e.detach(h--));i?.forEach(C=>{e.destroy(C)})}(C,e,a.trackByFn),C.updateIndexes(),a.hasEmptyBlock){const P=ra(),L=0===C.length;if(gs(i,P,L)){const V=t+2,W=HS(i,V);if(L){const X=vR(r,V),oe=null;Bf(W,c_(i,X,void 0,{dehydratedView:oe}),0,fm(X,oe))}else pv(W,0)}}}finally{Xn(n)}}(t._displayedPageSizeOptions)}}function _he(e,n){if(1&e&&(Fe(0,"div",15),gt(1),Ue()),2&e){const t=cn(2);Ze(),br(t.pageSize)}}function yhe(e,n){if(1&e&&(Fe(0,"div",3)(1,"div",13),gt(2),Ue(),an(3,ghe,6,7,"mat-form-field",14)(4,_he,2,1,"div",15),Ue()),2&e){const t=cn();Ze(),ui("id",t._pageSizeLabelId),Ze(),Sr(" ",t._intl.itemsPerPageLabel," "),Ze(),Mr(t._displayedPageSizeOptions.length>1?3:-1),Ze(),Mr(t._displayedPageSizeOptions.length<=1?4:-1)}}function vhe(e,n){if(1&e){const t=Is();Fe(0,"button",19),Nn("click",function(){Di(t);const r=cn();return Ii(r._buttonClicked(0,r._previousButtonsDisabled()))}),Ma(),Fe(1,"svg",8),_n(2,"path",20),Ue()()}if(2&e){const t=cn();At("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("disabled",t._previousButtonsDisabled()),ui("aria-label",t._intl.firstPageLabel)}}function bhe(e,n){if(1&e){const t=Is();Fe(0,"button",21),Nn("click",function(){Di(t);const r=cn();return Ii(r._buttonClicked(r.getNumberOfPages()-1,r._nextButtonsDisabled()))}),Ma(),Fe(1,"svg",8),_n(2,"path",22),Ue()()}if(2&e){const t=cn();At("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("disabled",t._nextButtonsDisabled()),ui("aria-label",t._intl.lastPageLabel)}}let sI=(()=>{class e{changes=new Ie;itemsPerPageLabel="Items per page:";nextPageLabel="Next page";previousPageLabel="Previous page";firstPageLabel="First page";lastPageLabel="Last page";getRangeLabel=(t,i,r)=>{if(0==r||0==i)return`0 of ${r}`;const a=t*i;return`${a+1} \u2013 ${a<(r=Math.max(r,0))?Math.min(a+i,r):a+i} of ${r}`};static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const whe={provide:sI,deps:[[new Kr,new hc,sI]],useFactory:function xhe(e){return e||new sI}},The=new ct("MAT_PAGINATOR_DEFAULT_OPTIONS");let WO=(()=>{class e{_intl=re(sI);_changeDetectorRef=re(Bo);_formFieldAppearance;_pageSizeLabelId=re(du).getId("mat-paginator-page-size-label-");_intlChanges;_isInitialized=!1;_initializedStream=new IO(1);color;get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(t||0,0),this._changeDetectorRef.markForCheck()}_pageIndex=0;get length(){return this._length}set length(t){this._length=t||0,this._changeDetectorRef.markForCheck()}_length=0;get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(t||0,0),this._updateDisplayedPageSizeOptions()}_pageSize;get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(i=>Ya(i,0)),this._updateDisplayedPageSizeOptions()}_pageSizeOptions=[];hidePageSize=!1;showFirstLastButtons=!1;selectConfig={};disabled=!1;page=new Dt;_displayedPageSizeOptions;initialized=this._initializedStream;constructor(){const t=this._intl,i=re(The,{optional:!0});if(this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),i){const{pageSize:r,pageSizeOptions:a,hidePageSize:h,showFirstLastButtons:v}=i;null!=r&&(this._pageSize=r),null!=a&&(this._pageSizeOptions=a),null!=h&&(this.hidePageSize=h),null!=v&&(this.showFirstLastButtons=v)}this._formFieldAppearance=i?.formFieldAppearance||"outline"}ngOnInit(){this._isInitialized=!0,this._updateDisplayedPageSizeOptions(),this._initializedStream.next()}ngOnDestroy(){this._initializedStream.complete(),this._intlChanges.unsubscribe()}nextPage(){this.hasNextPage()&&this._navigate(this.pageIndex+1)}previousPage(){this.hasPreviousPage()&&this._navigate(this.pageIndex-1)}firstPage(){this.hasPreviousPage()&&this._navigate(0)}lastPage(){this.hasNextPage()&&this._navigate(this.getNumberOfPages()-1)}hasPreviousPage(){return this.pageIndex>=1&&0!=this.pageSize}hasNextPage(){const t=this.getNumberOfPages()-1;return this.pageIndex<t&&0!=this.pageSize}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){const r=this.pageIndex;this.pageIndex=Math.floor(this.pageIndex*this.pageSize/t)||0,this.pageSize=t,this._emitPageEvent(r)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._isInitialized&&(this.pageSize||(this._pageSize=0!=this.pageSizeOptions.length?this.pageSizeOptions[0]:50),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),-1===this._displayedPageSizeOptions.indexOf(this.pageSize)&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,i)=>t-i),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}_navigate(t){const i=this.pageIndex;t!==i&&(this.pageIndex=t,this._emitPageEvent(i))}_buttonClicked(t,i){i||this._navigate(t)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{color:"color",pageIndex:[2,"pageIndex","pageIndex",Ya],length:[2,"length","length",Ya],pageSize:[2,"pageSize","pageSize",Ya],pageSizeOptions:"pageSizeOptions",hidePageSize:[2,"hidePageSize","hidePageSize",zn],showFirstLastButtons:[2,"showFirstLastButtons","showFirstLastButtons",zn],selectConfig:"selectConfig",disabled:[2,"disabled","disabled",zn]},outputs:{page:"page"},exportAs:["matPaginator"],features:[jr],decls:14,vars:12,consts:[["selectRef",""],[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","disabled"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-previous",3,"click","matTooltip","matTooltipDisabled","disabled"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-next",3,"click","matTooltip","matTooltipDisabled","disabled"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","disabled"],[1,"mat-mdc-paginator-page-size-label"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],[1,"mat-mdc-paginator-page-size-value"],["hideSingleSelectionIndicator","",3,"selectionChange","value","disabled","aria-labelledby","panelClass","disableOptionCentering"],[3,"value"],[1,"mat-mdc-paginator-touch-target",3,"click"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-first",3,"click","matTooltip","matTooltipDisabled","disabled"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button","matTooltipPosition","above","disabledInteractive","",1,"mat-mdc-paginator-navigation-last",3,"click","matTooltip","matTooltipDisabled","disabled"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(i,r){1&i&&(Fe(0,"div",1)(1,"div",2),an(2,yhe,5,4,"div",3),Fe(3,"div",4)(4,"div",5),gt(5),Ue(),an(6,vhe,3,4,"button",6),Fe(7,"button",7),Nn("click",function(){return r._buttonClicked(r.pageIndex-1,r._previousButtonsDisabled())}),Ma(),Fe(8,"svg",8),_n(9,"path",9),Ue()(),Xu(),Fe(10,"button",10),Nn("click",function(){return r._buttonClicked(r.pageIndex+1,r._nextButtonsDisabled())}),Ma(),Fe(11,"svg",8),_n(12,"path",11),Ue()(),an(13,bhe,3,4,"button",12),Ue()()()),2&i&&(Ze(2),Mr(r.hidePageSize?-1:2),Ze(3),Sr(" ",r._intl.getRangeLabel(r.pageIndex,r.pageSize,r.length)," "),Ze(),Mr(r.showFirstLastButtons?6:-1),Ze(),At("matTooltip",r._intl.previousPageLabel)("matTooltipDisabled",r._previousButtonsDisabled())("disabled",r._previousButtonsDisabled()),ui("aria-label",r._intl.previousPageLabel),Ze(3),At("matTooltip",r._intl.nextPageLabel)("matTooltipDisabled",r._nextButtonsDisabled())("disabled",r._nextButtonsDisabled()),ui("aria-label",r._intl.nextPageLabel),Ze(3),Mr(r.showFirstLastButtons?13:-1))},dependencies:[t6,V6,wO,qC,hhe],styles:[".mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color, var(--mat-sys-on-surface));background-color:var(--mat-paginator-container-background-color, var(--mat-sys-surface));font-family:var(--mat-paginator-container-text-font, var(--mat-sys-body-small-font));line-height:var(--mat-paginator-container-text-line-height, var(--mat-sys-body-small-line-height));font-size:var(--mat-paginator-container-text-size, var(--mat-sys-body-small-size));font-weight:var(--mat-paginator-container-text-weight, var(--mat-sys-body-small-weight));letter-spacing:var(--mat-paginator-container-text-tracking, var(--mat-sys-body-small-tracking));--mat-form-field-container-height:var(--mat-paginator-form-field-container-height, 40px);--mat-form-field-container-vertical-padding:var(--mat-paginator-form-field-container-vertical-padding, 8px)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size, var(--mat-sys-body-small-size))}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap;width:100%;min-height:var(--mat-paginator-container-size, 56px)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color, var(--mat-sys-on-surface-variant))}.mat-mdc-icon-button[aria-disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}@media(forced-colors: active){.mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}}.mat-mdc-paginator-touch-target{display:var(--mat-paginator-touch-target-display, block);position:absolute;top:50%;left:50%;width:84px;height:48px;background-color:rgba(0,0,0,0);transform:translate(-50%, -50%);cursor:pointer}"],encapsulation:2,changeDetection:0})}return e})(),G6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[whe],imports:[EO,qO,phe,WO]})}return e})(),q6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,O_,O_,or]})}return e})();const She=["mat-sort-header",""],Ehe=["*"];function Dhe(e,n){1&e&&(Fe(0,"div",2),Ma(),Fe(1,"svg",3),_n(2,"path",4),Ue()())}const W6=new ct("MAT_SORT_DEFAULT_OPTIONS");let ZO=(()=>{class e{_defaultOptions;_initializedStream=new IO(1);sortables=new Map;_stateChanges=new Ie;active;start="asc";get direction(){return this._direction}set direction(t){this._direction=t}_direction="";disableClear;disabled=!1;sortChange=new Dt;initialized=this._initializedStream;constructor(t){this._defaultOptions=t}register(t){this.sortables.set(t.id,t)}deregister(t){this.sortables.delete(t.id)}sort(t){this.active!=t.id?(this.active=t.id,this.direction=t.start?t.start:this.start):this.direction=this.getNextSortDirection(t),this.sortChange.emit({active:this.active,direction:this.direction})}getNextSortDirection(t){if(!t)return"";let r=function Ihe(e,n){let t=["asc","desc"];return"desc"==e&&t.reverse(),n||t.push(""),t}(t.start||this.start,t?.disableClear??this.disableClear??!!this._defaultOptions?.disableClear),a=r.indexOf(this.direction)+1;return a>=r.length&&(a=0),r[a]}ngOnInit(){this._initializedStream.next()}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete(),this._initializedStream.complete()}static \u0275fac=function(i){return new(i||e)(Rt(W6,8))};static \u0275dir=Bt({type:e,selectors:[["","matSort",""]],hostAttrs:[1,"mat-sort"],inputs:{active:[0,"matSortActive","active"],start:[0,"matSortStart","start"],direction:[0,"matSortDirection","direction"],disableClear:[2,"matSortDisableClear","disableClear",zn],disabled:[2,"matSortDisabled","disabled",zn]},outputs:{sortChange:"matSortChange"},exportAs:["matSort"],features:[jr,sr]})}return e})(),aI=(()=>{class e{changes=new Ie;static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ahe={provide:aI,deps:[[new Kr,new hc,aI]],useFactory:function khe(e){return e||new aI}};let Rhe=(()=>{class e{_intl=re(aI);_sort=re(ZO,{optional:!0});_columnDef=re("MAT_SORT_HEADER_COLUMN_DEF",{optional:!0});_changeDetectorRef=re(Bo);_focusMonitor=re(Lx);_elementRef=re(In);_ariaDescriber=re(iH,{optional:!0});_renderChanges;_animationModule=re(Ga,{optional:!0});_recentlyCleared=ha(null);_sortButton;id;arrowPosition="after";start;disabled=!1;get sortActionDescription(){return this._sortActionDescription}set sortActionDescription(t){this._updateSortActionDescription(t)}_sortActionDescription="Sort";disableClear;constructor(){re(Oc).load(Qv);const t=re(W6,{optional:!0});t?.arrowPosition&&(this.arrowPosition=t?.arrowPosition)}ngOnInit(){!this.id&&this._columnDef&&(this.id=this._columnDef.name),this._sort.register(this),this._renderChanges=Cl(this._sort._stateChanges,this._sort.sortChange).subscribe(()=>this._changeDetectorRef.markForCheck()),this._sortButton=this._elementRef.nativeElement.querySelector(".mat-sort-header-container"),this._updateSortActionDescription(this._sortActionDescription)}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(()=>this._recentlyCleared.set(null))}ngOnDestroy(){this._focusMonitor.stopMonitoring(this._elementRef),this._sort.deregister(this),this._renderChanges?.unsubscribe(),this._sortButton&&this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription)}_toggleOnInteraction(){if(!this._isDisabled()){const t=this._isSorted(),i=this._sort.direction;this._sort.sort(this),this._recentlyCleared.set(t&&!this._isSorted()?i:null)}}_handleKeydown(t){(32===t.keyCode||13===t.keyCode)&&(t.preventDefault(),this._toggleOnInteraction())}_isSorted(){return this._sort.active==this.id&&("asc"===this._sort.direction||"desc"===this._sort.direction)}_isDisabled(){return this._sort.disabled||this.disabled}_getAriaSortAttribute(){return this._isSorted()?"asc"==this._sort.direction?"ascending":"descending":"none"}_renderArrow(){return!this._isDisabled()||this._isSorted()}_updateSortActionDescription(t){this._sortButton&&(this._ariaDescriber?.removeDescription(this._sortButton,this._sortActionDescription),this._ariaDescriber?.describe(this._sortButton,t)),this._sortActionDescription=t}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["","mat-sort-header",""]],hostAttrs:[1,"mat-sort-header"],hostVars:3,hostBindings:function(i,r){1&i&&Nn("click",function(){return r._toggleOnInteraction()})("keydown",function(h){return r._handleKeydown(h)})("mouseleave",function(){return r._recentlyCleared.set(!1)}),2&i&&(ui("aria-sort",r._getAriaSortAttribute()),Ti("mat-sort-header-disabled",r._isDisabled()))},inputs:{id:[0,"mat-sort-header","id"],arrowPosition:"arrowPosition",start:"start",disabled:[2,"disabled","disabled",zn],sortActionDescription:"sortActionDescription",disableClear:[2,"disableClear","disableClear",zn]},exportAs:["matSortHeader"],features:[jr],attrs:She,ngContentSelectors:Ehe,decls:4,vars:17,consts:[[1,"mat-sort-header-container","mat-focus-indicator"],[1,"mat-sort-header-content"],[1,"mat-sort-header-arrow"],["viewBox","0 -960 960 960","focusable","false","aria-hidden","true"],["d","M440-240v-368L296-464l-56-56 240-240 240 240-56 56-144-144v368h-80Z"]],template:function(i,r){1&i&&(zo(),Fe(0,"div",0)(1,"div",1),ai(2),Ue(),an(3,Dhe,3,0,"div",2),Ue()),2&i&&(Ti("mat-sort-header-sorted",r._isSorted())("mat-sort-header-position-before","before"===r.arrowPosition)("mat-sort-header-descending","desc"===r._sort.direction)("mat-sort-header-ascending","asc"===r._sort.direction)("mat-sort-header-recently-cleared-ascending","asc"===r._recentlyCleared())("mat-sort-header-recently-cleared-descending","desc"===r._recentlyCleared())("mat-sort-header-animations-disabled","NoopAnimations"===r._animationModule),ui("tabindex",r._isDisabled()?null:0)("role",r._isDisabled()?null:"button"),Ze(3),Mr(r._renderArrow()?3:-1))},styles:[".mat-sort-header-container{display:flex;cursor:pointer;align-items:center;letter-spacing:normal;outline:0}[mat-sort-header].cdk-keyboard-focused .mat-sort-header-container,[mat-sort-header].cdk-program-focused .mat-sort-header-container{border-bottom:solid 1px currentColor}.mat-sort-header-disabled .mat-sort-header-container{cursor:default}.mat-sort-header-container::before{margin:calc(calc(var(--mat-focus-indicator-border-width, 3px) + 2px)*-1)}.mat-sort-header-content{display:flex;align-items:center}.mat-sort-header-position-before{flex-direction:row-reverse}@keyframes _mat-sort-header-recently-cleared-ascending{from{transform:translateY(0);opacity:1}to{transform:translateY(-25%);opacity:0}}@keyframes _mat-sort-header-recently-cleared-descending{from{transform:translateY(0) rotate(180deg);opacity:1}to{transform:translateY(25%) rotate(180deg);opacity:0}}.mat-sort-header-arrow{height:12px;width:12px;position:relative;transition:transform 225ms cubic-bezier(0.4, 0, 0.2, 1),opacity 225ms cubic-bezier(0.4, 0, 0.2, 1);opacity:0;overflow:visible;color:var(--mat-sort-arrow-color, var(--mat-sys-on-surface))}.mat-sort-header.cdk-keyboard-focused .mat-sort-header-arrow,.mat-sort-header.cdk-program-focused .mat-sort-header-arrow,.mat-sort-header:hover .mat-sort-header-arrow{opacity:.54}.mat-sort-header .mat-sort-header-sorted .mat-sort-header-arrow{opacity:1}.mat-sort-header-descending .mat-sort-header-arrow{transform:rotate(180deg)}.mat-sort-header-recently-cleared-ascending .mat-sort-header-arrow{transform:translateY(-25%)}.mat-sort-header-recently-cleared-ascending .mat-sort-header-arrow{transition:none;animation:_mat-sort-header-recently-cleared-ascending 225ms cubic-bezier(0.4, 0, 0.2, 1) forwards}.mat-sort-header-recently-cleared-descending .mat-sort-header-arrow{transition:none;animation:_mat-sort-header-recently-cleared-descending 225ms cubic-bezier(0.4, 0, 0.2, 1) forwards}.mat-sort-header-animations-disabled .mat-sort-header-arrow{transition-duration:0ms;animation-duration:0ms}.mat-sort-header-arrow svg{width:24px;height:24px;fill:currentColor;position:absolute;top:50%;left:50%;margin:-12px 0 0 -12px;transform:translateZ(0)}.mat-sort-header-arrow,[dir=rtl] .mat-sort-header-position-before .mat-sort-header-arrow{margin:0 0 0 6px}.mat-sort-header-position-before .mat-sort-header-arrow,[dir=rtl] .mat-sort-header-arrow{margin:0 6px 0 0}"],encapsulation:2,changeDetection:0})}return e})(),Z6=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[Ahe],imports:[or]})}return e})();const Phe=[[["caption"]],[["colgroup"],["col"]],"*"],Ohe=["caption","colgroup, col","*"];function Fhe(e,n){1&e&&ai(0,2)}function Lhe(e,n){1&e&&(Fe(0,"thead",0),zs(1,1),Ue(),Fe(2,"tbody",0),zs(3,2)(4,3),Ue(),Fe(5,"tfoot",0),zs(6,4),Ue())}function Nhe(e,n){1&e&&zs(0,1)(1,2)(2,3)(3,4)}const Jf=new ct("CDK_TABLE");let Vx=(()=>{class e{template=re(Lo);constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkCellDef",""]]})}return e})(),Ux=(()=>{class e{template=re(Lo);constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkHeaderCellDef",""]]})}return e})(),lI=(()=>{class e{template=re(Lo);constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkFooterCellDef",""]]})}return e})(),Lm=(()=>{class e{_table=re(Jf,{optional:!0});_hasStickyChanged=!1;get name(){return this._name}set name(t){this._setNameInput(t)}_name;get sticky(){return this._sticky}set sticky(t){t!==this._sticky&&(this._sticky=t,this._hasStickyChanged=!0)}_sticky=!1;get stickyEnd(){return this._stickyEnd}set stickyEnd(t){t!==this._stickyEnd&&(this._stickyEnd=t,this._hasStickyChanged=!0)}_stickyEnd=!1;cell;headerCell;footerCell;cssClassFriendlyName;_columnCssClassName;constructor(){}hasStickyChanged(){const t=this._hasStickyChanged;return this.resetStickyChanged(),t}resetStickyChanged(){this._hasStickyChanged=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkColumnDef",""]],contentQueries:function(i,r,a){if(1&i&&(bo(a,Vx,5),bo(a,Ux,5),bo(a,lI,5)),2&i){let h;ri(h=oi())&&(r.cell=h.first),ri(h=oi())&&(r.headerCell=h.first),ri(h=oi())&&(r.footerCell=h.first)}},inputs:{name:[0,"cdkColumnDef","name"],sticky:[2,"sticky","sticky",zn],stickyEnd:[2,"stickyEnd","stickyEnd",zn]},features:[Jn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:e}]),jr]})}return e})();class YO{constructor(n,t){t.nativeElement.classList.add(...n._columnCssClassName)}}let XO=(()=>{class e extends YO{constructor(){super(re(Lm),re(In))}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[Gn]})}return e})(),Y6=(()=>{class e extends YO{constructor(){const t=re(Lm),i=re(In);super(t,i);const r=t._table?._getCellRole();r&&i.nativeElement.setAttribute("role",r)}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["cdk-footer-cell"],["td","cdk-footer-cell",""]],hostAttrs:[1,"cdk-footer-cell"],features:[Gn]})}return e})(),KO=(()=>{class e extends YO{constructor(){const t=re(Lm),i=re(In);super(t,i);const r=t._table?._getCellRole();r&&i.nativeElement.setAttribute("role",r)}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[Gn]})}return e})();class X6{tasks=[];endTasks=[]}const QO=new ct("_COALESCED_STYLE_SCHEDULER");let K6=(()=>{class e{_currentSchedule=null;_ngZone=re(Ht);constructor(){}schedule(t){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(t)}scheduleEnd(t){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(t)}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new X6,this._ngZone.runOutsideAngular(()=>queueMicrotask(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const t=this._currentSchedule;this._currentSchedule=new X6;for(const i of t.tasks)i();for(const i of t.endTasks)i()}this._currentSchedule=null})))}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})(),JO=(()=>{class e{template=re(Lo);_differs=re(b_);columns;_columnsDiffer;constructor(){}ngOnChanges(t){if(!this._columnsDiffer){const i=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(i).create(),this._columnsDiffer.diff(i)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(t){return this instanceof tT?t.headerCell.template:this instanceof nT?t.footerCell.template:t.cell.template}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,features:[sr]})}return e})(),tT=(()=>{class e extends JO{_table=re(Jf,{optional:!0});_hasStickyChanged=!1;get sticky(){return this._sticky}set sticky(t){t!==this._sticky&&(this._sticky=t,this._hasStickyChanged=!0)}_sticky=!1;constructor(){super(re(Lo),re(b_))}ngOnChanges(t){super.ngOnChanges(t)}hasStickyChanged(){const t=this._hasStickyChanged;return this.resetStickyChanged(),t}resetStickyChanged(){this._hasStickyChanged=!1}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:[0,"cdkHeaderRowDef","columns"],sticky:[2,"cdkHeaderRowDefSticky","sticky",zn]},features:[jr,Gn,sr]})}return e})(),nT=(()=>{class e extends JO{_table=re(Jf,{optional:!0});_hasStickyChanged=!1;get sticky(){return this._sticky}set sticky(t){t!==this._sticky&&(this._sticky=t,this._hasStickyChanged=!0)}_sticky=!1;constructor(){super(re(Lo),re(b_))}ngOnChanges(t){super.ngOnChanges(t)}hasStickyChanged(){const t=this._hasStickyChanged;return this.resetStickyChanged(),t}resetStickyChanged(){this._hasStickyChanged=!1}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:[0,"cdkFooterRowDef","columns"],sticky:[2,"cdkFooterRowDefSticky","sticky",zn]},features:[jr,Gn,sr]})}return e})(),cI=(()=>{class e extends JO{_table=re(Jf,{optional:!0});when;constructor(){super(re(Lo),re(b_))}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkRowDef",""]],inputs:{columns:[0,"cdkRowDefColumns","columns"],when:[0,"cdkRowDefWhen","when"]},features:[Gn]})}return e})(),Nm=(()=>{class e{_viewContainer=re(ms);cells;context;static mostRecentCellOutlet=null;constructor(){e.mostRecentCellOutlet=this}ngOnDestroy(){e.mostRecentCellOutlet===this&&(e.mostRecentCellOutlet=null)}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkCellOutlet",""]]})}return e})(),eF=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(i,r){1&i&&zs(0,0)},dependencies:[Nm],encapsulation:2})}return e})(),tF=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["cdk-footer-row"],["tr","cdk-footer-row",""]],hostAttrs:["role","row",1,"cdk-footer-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(i,r){1&i&&zs(0,0)},dependencies:[Nm],encapsulation:2})}return e})(),nF=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(i,r){1&i&&zs(0,0)},dependencies:[Nm],encapsulation:2})}return e})(),dI=(()=>{class e{templateRef=re(Lo);_contentClassName="cdk-no-data-row";constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["ng-template","cdkNoDataRow",""]]})}return e})();const Q6=["top","bottom","left","right"];class Uhe{_isNativeHtmlTable;_stickCellCss;direction;_coalescedStyleScheduler;_isBrowser;_needsPositionStickyOnElement;_positionListener;_elemSizeCache=new WeakMap;_resizeObserver=globalThis?.ResizeObserver?new globalThis.ResizeObserver(n=>this._updateCachedSizes(n)):null;_updatedStickyColumnsParamsToReplay=[];_stickyColumnsReplayTimeout=null;_cachedCellWidths=[];_borderCellCss;constructor(n,t,i,r,a=!0,h=!0,v){this._isNativeHtmlTable=n,this._stickCellCss=t,this.direction=i,this._coalescedStyleScheduler=r,this._isBrowser=a,this._needsPositionStickyOnElement=h,this._positionListener=v,this._borderCellCss={top:`${t}-border-elem-top`,bottom:`${t}-border-elem-bottom`,left:`${t}-border-elem-left`,right:`${t}-border-elem-right`}}clearStickyPositioning(n,t){(t.includes("left")||t.includes("right"))&&this._removeFromStickyColumnReplayQueue(n);const i=[];for(const r of n)if(r.nodeType===r.ELEMENT_NODE){i.push(r);for(let a=0;a<r.children.length;a++)i.push(r.children[a])}this._coalescedStyleScheduler.schedule(()=>{for(const r of i)this._removeStickyStyle(r,t)})}updateStickyColumns(n,t,i,r=!0,a=!0){a&&this._updateStickyColumnReplayQueue({rows:[...n],stickyStartStates:[...t],stickyEndStates:[...i]}),n.length&&this._isBrowser&&(t.some(h=>h)||i.some(h=>h))?this._coalescedStyleScheduler.schedule(()=>{const h=n[0],v=h.children.length,C=this._getCellWidths(h,r),P=this._getStickyStartColumnPositions(C,t),L=this._getStickyEndColumnPositions(C,i),V=t.lastIndexOf(!0),W=i.indexOf(!0),X="rtl"===this.direction,oe=X?"right":"left",he=X?"left":"right";for(const se of n)for(let _e=0;_e<v;_e++){const Se=se.children[_e];t[_e]&&this._addStickyStyle(Se,oe,P[_e],_e===V),i[_e]&&this._addStickyStyle(Se,he,L[_e],_e===W)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===V?[]:C.slice(0,V+1).map((se,_e)=>t[_e]?se:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===W?[]:C.slice(W).map((se,_e)=>i[_e+W]?se:null).reverse()}))}):this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]}))}stickRows(n,t,i){this._isBrowser&&this._coalescedStyleScheduler.schedule(()=>{const r="bottom"===i?n.slice().reverse():n,a="bottom"===i?t.slice().reverse():t,h=[],v=[],C=[];for(let L=0,V=0;L<r.length;L++){if(!a[L])continue;h[L]=V;const W=r[L];C[L]=this._isNativeHtmlTable?Array.from(W.children):[W];const X=this._retrieveElementSize(W).height;V+=X,v[L]=X}const P=a.lastIndexOf(!0);for(let L=0;L<r.length;L++){if(!a[L])continue;const V=h[L],W=L===P;for(const X of C[L])this._addStickyStyle(X,i,V,W)}"top"===i?this._positionListener?.stickyHeaderRowsUpdated({sizes:v,offsets:h,elements:C}):this._positionListener?.stickyFooterRowsUpdated({sizes:v,offsets:h,elements:C})})}updateStickyFooterContainer(n,t){this._isNativeHtmlTable&&this._coalescedStyleScheduler.schedule(()=>{const i=n.querySelector("tfoot");i&&(t.some(r=>!r)?this._removeStickyStyle(i,["bottom"]):this._addStickyStyle(i,"bottom",0,!1))})}_removeStickyStyle(n,t){for(const r of t)n.style[r]="",n.classList.remove(this._borderCellCss[r]);Q6.some(r=>-1===t.indexOf(r)&&n.style[r])?n.style.zIndex=this._getCalculatedZIndex(n):(n.style.zIndex="",this._needsPositionStickyOnElement&&(n.style.position=""),n.classList.remove(this._stickCellCss))}_addStickyStyle(n,t,i,r){n.classList.add(this._stickCellCss),r&&n.classList.add(this._borderCellCss[t]),n.style[t]=`${i}px`,n.style.zIndex=this._getCalculatedZIndex(n),this._needsPositionStickyOnElement&&(n.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(n){const t={top:100,bottom:10,left:1,right:1};let i=0;for(const r of Q6)n.style[r]&&(i+=t[r]);return i?`${i}`:""}_getCellWidths(n,t=!0){if(!t&&this._cachedCellWidths.length)return this._cachedCellWidths;const i=[],r=n.children;for(let a=0;a<r.length;a++)i.push(this._retrieveElementSize(r[a]).width);return this._cachedCellWidths=i,i}_getStickyStartColumnPositions(n,t){const i=[];let r=0;for(let a=0;a<n.length;a++)t[a]&&(i[a]=r,r+=n[a]);return i}_getStickyEndColumnPositions(n,t){const i=[];let r=0;for(let a=n.length;a>0;a--)t[a]&&(i[a]=r,r+=n[a]);return i}_retrieveElementSize(n){const t=this._elemSizeCache.get(n);if(t)return t;const i=n.getBoundingClientRect(),r={width:i.width,height:i.height};return this._resizeObserver&&(this._elemSizeCache.set(n,r),this._resizeObserver.observe(n,{box:"border-box"})),r}_updateStickyColumnReplayQueue(n){this._removeFromStickyColumnReplayQueue(n.rows),!this._stickyColumnsReplayTimeout&&this._updatedStickyColumnsParamsToReplay.push(n)}_removeFromStickyColumnReplayQueue(n){const t=new Set(n);for(const i of this._updatedStickyColumnsParamsToReplay)i.rows=i.rows.filter(r=>!t.has(r));this._updatedStickyColumnsParamsToReplay=this._updatedStickyColumnsParamsToReplay.filter(i=>!!i.rows.length)}_updateCachedSizes(n){let t=!1;for(const i of n){const r=i.borderBoxSize?.length?{width:i.borderBoxSize[0].inlineSize,height:i.borderBoxSize[0].blockSize}:{width:i.contentRect.width,height:i.contentRect.height};r.width!==this._elemSizeCache.get(i.target)?.width&&jhe(i.target)&&(t=!0),this._elemSizeCache.set(i.target,r)}t&&this._updatedStickyColumnsParamsToReplay.length&&(this._stickyColumnsReplayTimeout&&clearTimeout(this._stickyColumnsReplayTimeout),this._stickyColumnsReplayTimeout=setTimeout(()=>{for(const i of this._updatedStickyColumnsParamsToReplay)this.updateStickyColumns(i.rows,i.stickyStartStates,i.stickyEndStates,!0,!1);this._updatedStickyColumnsParamsToReplay=[],this._stickyColumnsReplayTimeout=null},0))}}function jhe(e){return["cdk-cell","cdk-header-cell","cdk-footer-cell"].some(n=>e.classList.contains(n))}const iF=new ct("CDK_SPL");let rF=(()=>{class e{viewContainer=re(ms);elementRef=re(In);constructor(){const t=re(Jf);t._rowOutlet=this,t._outletAssigned()}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","rowOutlet",""]]})}return e})(),oF=(()=>{class e{viewContainer=re(ms);elementRef=re(In);constructor(){const t=re(Jf);t._headerRowOutlet=this,t._outletAssigned()}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","headerRowOutlet",""]]})}return e})(),sF=(()=>{class e{viewContainer=re(ms);elementRef=re(In);constructor(){const t=re(Jf);t._footerRowOutlet=this,t._outletAssigned()}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","footerRowOutlet",""]]})}return e})(),aF=(()=>{class e{viewContainer=re(ms);elementRef=re(In);constructor(){const t=re(Jf);t._noDataRowOutlet=this,t._outletAssigned()}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","noDataRowOutlet",""]]})}return e})(),uI=(()=>{class e{_differs=re(b_);_changeDetectorRef=re(Bo);_elementRef=re(In);_dir=re(Om,{optional:!0});_platform=re(Hs);_viewRepeater=re(YC);_coalescedStyleScheduler=re(QO);_viewportRuler=re(QC);_stickyPositioningListener=re(iF,{optional:!0,skipSelf:!0});_document=re(ir);_data;_onDestroy=new Ie;_renderRows;_renderChangeSubscription;_columnDefsByName=new Map;_rowDefs;_headerRowDefs;_footerRowDefs;_dataDiffer;_defaultRowDef;_customColumnDefs=new Set;_customRowDefs=new Set;_customHeaderRowDefs=new Set;_customFooterRowDefs=new Set;_customNoDataRow;_headerRowDefChanged=!0;_footerRowDefChanged=!0;_stickyColumnStylesNeedReset=!0;_forceRecalculateCellWidths=!0;_cachedRenderRowsMap=new Map;_isNativeHtmlTable;_stickyStyler;stickyCssClass="cdk-table-sticky";needsPositionStickyOnElement=!0;_isServer;_isShowingNoDataRow=!1;_hasAllOutlets=!1;_hasInitialized=!1;_getCellRole(){if(void 0===this._cellRoleInternal){const t=this._elementRef.nativeElement.getAttribute("role");return"grid"===t||"treegrid"===t?"gridcell":"cell"}return this._cellRoleInternal}_cellRoleInternal=void 0;get trackBy(){return this._trackByFn}set trackBy(t){this._trackByFn=t}_trackByFn;get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}_dataSource;get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(t){this._multiTemplateDataRows=t,this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}_multiTemplateDataRows=!1;get fixedLayout(){return this._fixedLayout}set fixedLayout(t){this._fixedLayout=t,this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}_fixedLayout=!1;contentChanged=new Dt;viewChange=new Je({start:0,end:Number.MAX_VALUE});_rowOutlet;_headerRowOutlet;_footerRowOutlet;_noDataRowOutlet;_contentColumnDefs;_contentRowDefs;_contentHeaderRowDefs;_contentFooterRowDefs;_noDataRow;_injector=re(Ye);constructor(){re(new pt("role"),{optional:!0})||this._elementRef.nativeElement.setAttribute("role","table"),this._isServer=!this._platform.isBrowser,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._dataDiffer=this._differs.find([]).create((t,i)=>this.trackBy?this.trackBy(i.dataIndex,i.data):i),this._viewportRuler.change().pipe(Er(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentInit(){this._hasInitialized=!0}ngAfterContentChecked(){this._canRender()&&this._render()}ngOnDestroy(){[this._rowOutlet?.viewContainer,this._headerRowOutlet?.viewContainer,this._footerRowOutlet?.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(t=>{t?.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),OO(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const t=this._dataDiffer.diff(this._renderRows);if(!t)return this._updateNoDataRow(),void this.contentChanged.next();const i=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(t,i,(r,a,h)=>this._getEmbeddedViewArgs(r.item,h),r=>r.item.data,r=>{r.operation===Fm.INSERTED&&r.context&&this._renderCellTemplateForItem(r.record.item.rowDef,r.context)}),this._updateRowIndexContext(),t.forEachIdentityChange(r=>{i.get(r.currentIndex).context.$implicit=r.item.data}),this._updateNoDataRow(),Tc(()=>{this.updateStickyColumnStyles()},{injector:this._injector}),this.contentChanged.next()}addColumnDef(t){this._customColumnDefs.add(t)}removeColumnDef(t){this._customColumnDefs.delete(t)}addRowDef(t){this._customRowDefs.add(t)}removeRowDef(t){this._customRowDefs.delete(t)}addHeaderRowDef(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}removeHeaderRowDef(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}addFooterRowDef(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}removeFooterRowDef(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}setNoDataRow(t){this._customNoDataRow=t}updateStickyHeaderRowStyles(){const t=this._getRenderedRows(this._headerRowOutlet);if(this._isNativeHtmlTable){const r=J6(this._headerRowOutlet,"thead");r&&(r.style.display=t.length?"":"none")}const i=this._headerRowDefs.map(r=>r.sticky);this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,i,"top"),this._headerRowDefs.forEach(r=>r.resetStickyChanged())}updateStickyFooterRowStyles(){const t=this._getRenderedRows(this._footerRowOutlet);if(this._isNativeHtmlTable){const r=J6(this._footerRowOutlet,"tfoot");r&&(r.style.display=t.length?"":"none")}const i=this._footerRowDefs.map(r=>r.sticky);this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,i,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,i),this._footerRowDefs.forEach(r=>r.resetStickyChanged())}updateStickyColumnStyles(){const t=this._getRenderedRows(this._headerRowOutlet),i=this._getRenderedRows(this._rowOutlet),r=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...t,...i,...r],["left","right"]),this._stickyColumnStylesNeedReset=!1),t.forEach((a,h)=>{this._addStickyColumnStyles([a],this._headerRowDefs[h])}),this._rowDefs.forEach(a=>{const h=[];for(let v=0;v<i.length;v++)this._renderRows[v].rowDef===a&&h.push(i[v]);this._addStickyColumnStyles(h,a)}),r.forEach((a,h)=>{this._addStickyColumnStyles([a],this._footerRowDefs[h])}),Array.from(this._columnDefsByName.values()).forEach(a=>a.resetStickyChanged())}_outletAssigned(){!this._hasAllOutlets&&this._rowOutlet&&this._headerRowOutlet&&this._footerRowOutlet&&this._noDataRowOutlet&&(this._hasAllOutlets=!0,this._canRender()&&this._render())}_canRender(){return this._hasAllOutlets&&this._hasInitialized}_render(){this._cacheRowDefs(),this._cacheColumnDefs();const i=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||i,this._forceRecalculateCellWidths=i,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}_getAllRenderRows(){const t=[],i=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let r=0;r<this._data.length;r++){let a=this._data[r];const h=this._getRenderRowsForData(a,r,i.get(a));this._cachedRenderRowsMap.has(a)||this._cachedRenderRowsMap.set(a,new WeakMap);for(let v=0;v<h.length;v++){let C=h[v];const P=this._cachedRenderRowsMap.get(C.data);P.has(C.rowDef)?P.get(C.rowDef).push(C):P.set(C.rowDef,[C]),t.push(C)}}return t}_getRenderRowsForData(t,i,r){return this._getRowDefs(t,i).map(h=>{const v=r&&r.has(h)?r.get(h):[];if(v.length){const C=v.shift();return C.dataIndex=i,C}return{data:t,rowDef:h,dataIndex:i}})}_cacheColumnDefs(){this._columnDefsByName.clear(),hI(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(i=>{this._columnDefsByName.has(i.name),this._columnDefsByName.set(i.name,i)})}_cacheRowDefs(){this._headerRowDefs=hI(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=hI(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=hI(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const t=this._rowDefs.filter(i=>!i.when);this._defaultRowDef=t[0]}_renderUpdatedColumns(){const t=(h,v)=>{const C=!!v.getColumnsDiff();return h||C},i=this._rowDefs.reduce(t,!1);i&&this._forceRenderDataRows();const r=this._headerRowDefs.reduce(t,!1);r&&this._forceRenderHeaderRows();const a=this._footerRowDefs.reduce(t,!1);return a&&this._forceRenderFooterRows(),i||r||a}_switchDataSource(t){this._data=[],OO(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet&&this._rowOutlet.viewContainer.clear()),this._dataSource=t}_observeRenderChanges(){if(!this.dataSource)return;let t;OO(this.dataSource)?t=this.dataSource.connect(this):gC(this.dataSource)?t=this.dataSource:Array.isArray(this.dataSource)&&(t=vn(this.dataSource)),this._renderChangeSubscription=t.pipe(Er(this._onDestroy)).subscribe(i=>{this._data=i||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((t,i)=>this._renderRow(this._headerRowOutlet,t,i)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((t,i)=>this._renderRow(this._footerRowOutlet,t,i)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(t,i){const r=Array.from(i.columns||[]).map(v=>this._columnDefsByName.get(v)),a=r.map(v=>v.sticky),h=r.map(v=>v.stickyEnd);this._stickyStyler.updateStickyColumns(t,a,h,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(t){const i=[];for(let r=0;r<t.viewContainer.length;r++){const a=t.viewContainer.get(r);i.push(a.rootNodes[0])}return i}_getRowDefs(t,i){if(1==this._rowDefs.length)return[this._rowDefs[0]];let r=[];if(this.multiTemplateDataRows)r=this._rowDefs.filter(a=>!a.when||a.when(i,t));else{let a=this._rowDefs.find(h=>h.when&&h.when(i,t))||this._defaultRowDef;a&&r.push(a)}return r}_getEmbeddedViewArgs(t,i){return{templateRef:t.rowDef.template,context:{$implicit:t.data},index:i}}_renderRow(t,i,r,a={}){const h=t.viewContainer.createEmbeddedView(i.template,a,r);return this._renderCellTemplateForItem(i,a),h}_renderCellTemplateForItem(t,i){for(let r of this._getCellTemplates(t))Nm.mostRecentCellOutlet&&Nm.mostRecentCellOutlet._viewContainer.createEmbeddedView(r,i);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const t=this._rowOutlet.viewContainer;for(let i=0,r=t.length;i<r;i++){const h=t.get(i).context;h.count=r,h.first=0===i,h.last=i===r-1,h.even=i%2==0,h.odd=!h.even,this.multiTemplateDataRows?(h.dataIndex=this._renderRows[i].dataIndex,h.renderIndex=i):h.index=this._renderRows[i].dataIndex}}_getCellTemplates(t){return t&&t.columns?Array.from(t.columns,i=>{const r=this._columnDefsByName.get(i);return t.extractCellTemplate(r)}):[]}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const t=(i,r)=>i||r.hasStickyChanged();this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new Uhe(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:vn()).pipe(Er(this._onDestroy)).subscribe(i=>{this._stickyStyler.direction=i,this.updateStickyColumnStyles()})}_getOwnDefs(t){return t.filter(i=>!i._table||i._table===this)}_updateNoDataRow(){const t=this._customNoDataRow||this._noDataRow;if(!t)return;const i=0===this._rowOutlet.viewContainer.length;if(i===this._isShowingNoDataRow)return;const r=this._noDataRowOutlet.viewContainer;if(i){const a=r.createEmbeddedView(t.templateRef),h=a.rootNodes[0];1===a.rootNodes.length&&h?.nodeType===this._document.ELEMENT_NODE&&(h.setAttribute("role","row"),h.classList.add(t._contentClassName))}else r.clear();this._isShowingNoDataRow=i,this._changeDetectorRef.markForCheck()}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(i,r,a){if(1&i&&(bo(a,dI,5),bo(a,Lm,5),bo(a,cI,5),bo(a,tT,5),bo(a,nT,5)),2&i){let h;ri(h=oi())&&(r._noDataRow=h.first),ri(h=oi())&&(r._contentColumnDefs=h),ri(h=oi())&&(r._contentRowDefs=h),ri(h=oi())&&(r._contentHeaderRowDefs=h),ri(h=oi())&&(r._contentFooterRowDefs=h)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(i,r){2&i&&Ti("cdk-table-fixed-layout",r.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:[2,"multiTemplateDataRows","multiTemplateDataRows",zn],fixedLayout:[2,"fixedLayout","fixedLayout",zn]},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[Jn([{provide:Jf,useExisting:e},{provide:YC,useClass:r6},{provide:QO,useClass:K6},{provide:iF,useValue:null}]),jr],ngContentSelectors:Ohe,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(i,r){1&i&&(zo(Phe),ai(0),ai(1,1),an(2,Fhe,1,0)(3,Lhe,7,0)(4,Nhe,4,0)),2&i&&(Ze(2),Mr(r._isServer?2:-1),Ze(),Mr(r._isNativeHtmlTable?3:4))},dependencies:[oF,rF,aF,sF],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2})}return e})();function hI(e,n){return e.concat(Array.from(n))}function J6(e,n){const t=n.toUpperCase();let i=e.viewContainer.element.nativeElement;for(;i;){const r=1===i.nodeType?i.nodeName:null;if(r===t)return i;if("TABLE"===r)break;i=i.parentNode}return null}let $he=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[VO]})}return e})();const Ghe=[[["caption"]],[["colgroup"],["col"]],"*"],qhe=["caption","colgroup, col","*"];function Whe(e,n){1&e&&ai(0,2)}function Zhe(e,n){1&e&&(Fe(0,"thead",0),zs(1,1),Ue(),Fe(2,"tbody",2),zs(3,3)(4,4),Ue(),Fe(5,"tfoot",0),zs(6,5),Ue())}function Yhe(e,n){1&e&&zs(0,1)(1,3)(2,4)(3,5)}let lF=(()=>{class e extends uI{stickyCssClass="mat-mdc-table-sticky";needsPositionStickyOnElement=!1;static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275cmp=Ln({type:e,selectors:[["mat-table"],["table","mat-table",""]],hostAttrs:[1,"mat-mdc-table","mdc-data-table__table"],hostVars:2,hostBindings:function(i,r){2&i&&Ti("mdc-table-fixed-layout",r.fixedLayout)},exportAs:["matTable"],features:[Jn([{provide:uI,useExisting:e},{provide:Jf,useExisting:e},{provide:QO,useClass:K6},{provide:YC,useClass:r6},{provide:iF,useValue:null}]),Gn],ngContentSelectors:qhe,decls:5,vars:2,consts:[["role","rowgroup"],["headerRowOutlet",""],["role","rowgroup",1,"mdc-data-table__content"],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(i,r){1&i&&(zo(Ghe),ai(0),ai(1,1),an(2,Whe,1,0)(3,Zhe,7,0)(4,Yhe,4,0)),2&i&&(Ze(2),Mr(r._isServer?2:-1),Ze(),Mr(r._isNativeHtmlTable?3:4))},dependencies:[oF,rF,aF,sF],styles:[".mat-mdc-table-sticky{position:sticky !important}mat-table{display:block}mat-header-row{min-height:56px}mat-row,mat-footer-row{min-height:48px}mat-row,mat-header-row,mat-footer-row{display:flex;border-width:0;border-bottom-width:1px;border-style:solid;align-items:center;box-sizing:border-box}mat-cell:first-of-type,mat-header-cell:first-of-type,mat-footer-cell:first-of-type{padding-left:24px}[dir=rtl] mat-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:first-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:first-of-type:not(:only-of-type){padding-left:0;padding-right:24px}mat-cell:last-of-type,mat-header-cell:last-of-type,mat-footer-cell:last-of-type{padding-right:24px}[dir=rtl] mat-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-header-cell:last-of-type:not(:only-of-type),[dir=rtl] mat-footer-cell:last-of-type:not(:only-of-type){padding-right:0;padding-left:24px}mat-cell,mat-header-cell,mat-footer-cell{flex:1;display:flex;align-items:center;overflow:hidden;word-wrap:break-word;min-height:inherit}.mat-mdc-table{min-width:100%;border:0;border-spacing:0;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color, var(--mat-sys-surface))}.mdc-data-table__cell{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}[dir=rtl] .mdc-data-table__cell{text-align:right}.mdc-data-table__cell,.mdc-data-table__header-cell{padding:0 16px}.mat-mdc-header-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-table-header-headline-font, var(--mat-sys-title-small-font, Roboto, sans-serif));line-height:var(--mat-table-header-headline-line-height, var(--mat-sys-title-small-line-height));font-size:var(--mat-table-header-headline-size, var(--mat-sys-title-small-size, 14px));font-weight:var(--mat-table-header-headline-weight, var(--mat-sys-title-small-weight, 500))}.mat-mdc-row{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)))}.mat-mdc-row,.mdc-data-table__content{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, var(--mat-sys-body-medium-font, Roboto, sans-serif));line-height:var(--mat-table-row-item-label-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-table-row-item-label-text-size, var(--mat-sys-body-medium-size, 14px));font-weight:var(--mat-table-row-item-label-text-weight, var(--mat-sys-body-medium-weight))}.mat-mdc-footer-row{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, var(--mat-sys-on-surface, rgba(0, 0, 0, 0.87)));font-family:var(--mat-table-footer-supporting-text-font, var(--mat-sys-body-medium-font, Roboto, sans-serif));line-height:var(--mat-table-footer-supporting-text-line-height, var(--mat-sys-body-medium-line-height));font-size:var(--mat-table-footer-supporting-text-size, var(--mat-sys-body-medium-size, 14px));font-weight:var(--mat-table-footer-supporting-text-weight, var(--mat-sys-body-medium-weight));letter-spacing:var(--mat-table-footer-supporting-text-tracking, var(--mat-sys-body-medium-tracking))}.mat-mdc-header-cell{border-bottom-color:var(--mat-table-row-item-outline-color, var(--mat-sys-outline, rgba(0, 0, 0, 0.12)));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking, var(--mat-sys-title-small-tracking));font-weight:inherit;line-height:inherit;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}[dir=rtl] .mat-mdc-header-cell{text-align:right}.mdc-data-table__row:last-child>.mat-mdc-header-cell{border-bottom:none}.mat-mdc-cell{border-bottom-color:var(--mat-table-row-item-outline-color, var(--mat-sys-outline, rgba(0, 0, 0, 0.12)));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking, var(--mat-sys-body-medium-tracking));line-height:inherit}.mdc-data-table__row:last-child .mat-mdc-cell{border-bottom:none}.mat-mdc-footer-cell{letter-spacing:var(--mat-table-row-item-label-text-tracking, var(--mat-sys-body-medium-tracking))}mat-row.mat-mdc-row,mat-header-row.mat-mdc-header-row,mat-footer-row.mat-mdc-footer-row{border-bottom:none}.mat-mdc-table tbody,.mat-mdc-table tfoot,.mat-mdc-table thead,.mat-mdc-cell,.mat-mdc-footer-cell,.mat-mdc-header-row,.mat-mdc-row,.mat-mdc-footer-row,.mat-mdc-table .mat-mdc-header-cell{background:inherit}.mat-mdc-table mat-header-row.mat-mdc-header-row,.mat-mdc-table mat-row.mat-mdc-row,.mat-mdc-table mat-footer-row.mat-mdc-footer-cell{height:unset}mat-header-cell.mat-mdc-header-cell,mat-cell.mat-mdc-cell,mat-footer-cell.mat-mdc-footer-cell{align-self:stretch}"],encapsulation:2})}return e})(),fI=(()=>{class e extends Vx{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["","matCellDef",""]],features:[Jn([{provide:Vx,useExisting:e}]),Gn]})}return e})(),pI=(()=>{class e extends Ux{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["","matHeaderCellDef",""]],features:[Jn([{provide:Ux,useExisting:e}]),Gn]})}return e})(),t8=(()=>{class e extends lI{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["","matFooterCellDef",""]],features:[Jn([{provide:lI,useExisting:e}]),Gn]})}return e})(),mI=(()=>{class e extends Lm{get name(){return this._name}set name(t){this._setNameInput(t)}_updateColumnCssClassName(){super._updateColumnCssClassName(),this._columnCssClassName.push(`mat-column-${this.cssClassFriendlyName}`)}static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["","matColumnDef",""]],inputs:{name:[0,"matColumnDef","name"]},features:[Jn([{provide:Lm,useExisting:e},{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:e}]),Gn]})}return e})(),gI=(()=>{class e extends XO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["mat-header-cell"],["th","mat-header-cell",""]],hostAttrs:["role","columnheader",1,"mat-mdc-header-cell","mdc-data-table__header-cell"],features:[Gn]})}return e})(),n8=(()=>{class e extends Y6{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["mat-footer-cell"],["td","mat-footer-cell",""]],hostAttrs:[1,"mat-mdc-footer-cell","mdc-data-table__cell"],features:[Gn]})}return e})(),_I=(()=>{class e extends KO{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["mat-cell"],["td","mat-cell",""]],hostAttrs:[1,"mat-mdc-cell","mdc-data-table__cell"],features:[Gn]})}return e})(),cF=(()=>{class e extends tT{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["","matHeaderRowDef",""]],inputs:{columns:[0,"matHeaderRowDef","columns"],sticky:[2,"matHeaderRowDefSticky","sticky",zn]},features:[Jn([{provide:tT,useExisting:e}]),jr,Gn]})}return e})(),i8=(()=>{class e extends nT{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["","matFooterRowDef",""]],inputs:{columns:[0,"matFooterRowDef","columns"],sticky:[2,"matFooterRowDefSticky","sticky",zn]},features:[Jn([{provide:nT,useExisting:e}]),jr,Gn]})}return e})(),dF=(()=>{class e extends cI{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275dir=Bt({type:e,selectors:[["","matRowDef",""]],inputs:{columns:[0,"matRowDefColumns","columns"],when:[0,"matRowDefWhen","when"]},features:[Jn([{provide:cI,useExisting:e}]),Gn]})}return e})(),uF=(()=>{class e extends eF{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275cmp=Ln({type:e,selectors:[["mat-header-row"],["tr","mat-header-row",""]],hostAttrs:["role","row",1,"mat-mdc-header-row","mdc-data-table__header-row"],exportAs:["matHeaderRow"],features:[Jn([{provide:eF,useExisting:e}]),Gn],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(i,r){1&i&&zs(0,0)},dependencies:[Nm],encapsulation:2})}return e})(),r8=(()=>{class e extends tF{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275cmp=Ln({type:e,selectors:[["mat-footer-row"],["tr","mat-footer-row",""]],hostAttrs:["role","row",1,"mat-mdc-footer-row","mdc-data-table__row"],exportAs:["matFooterRow"],features:[Jn([{provide:tF,useExisting:e}]),Gn],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(i,r){1&i&&zs(0,0)},dependencies:[Nm],encapsulation:2})}return e})(),hF=(()=>{class e extends nF{static \u0275fac=(()=>{let t;return function(r){return(t||(t=z(e)))(r||e)}})();static \u0275cmp=Ln({type:e,selectors:[["mat-row"],["tr","mat-row",""]],hostAttrs:["role","row",1,"mat-mdc-row","mdc-data-table__row"],exportAs:["matRow"],features:[Jn([{provide:nF,useExisting:e}]),Gn],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(i,r){1&i&&zs(0,0)},dependencies:[Nm],encapsulation:2})}return e})(),o8=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,$he,or]})}return e})();class efe extends i6{_data;_renderData=new Je([]);_filter=new Je("");_internalPageChanges=new Ie;_renderChangesSubscription=null;filteredData;get data(){return this._data.value}set data(n){n=Array.isArray(n)?n:[],this._data.next(n),this._renderChangesSubscription||this._filterData(n)}get filter(){return this._filter.value}set filter(n){this._filter.next(n),this._renderChangesSubscription||this._filterData(this.data)}get sort(){return this._sort}set sort(n){this._sort=n,this._updateChangeSubscription()}_sort;get paginator(){return this._paginator}set paginator(n){this._paginator=n,this._updateChangeSubscription()}_paginator;sortingDataAccessor=(n,t)=>{const i=n[t];if(Xj(i)){const r=Number(i);return r<9007199254740991?r:i}return i};sortData=(n,t)=>{const i=t.active,r=t.direction;return i&&""!=r?n.sort((a,h)=>{let v=this.sortingDataAccessor(a,i),C=this.sortingDataAccessor(h,i);const P=typeof v,L=typeof C;P!==L&&("number"===P&&(v+=""),"number"===L&&(C+=""));let V=0;return null!=v&&null!=C?v>C?V=1:v<C&&(V=-1):null!=v?V=1:null!=C&&(V=-1),V*("asc"==r?1:-1)}):n};filterPredicate=(n,t)=>{const i=t.trim().toLowerCase();return Object.values(n).some(r=>`${r}`.toLowerCase().includes(i))};constructor(n=[]){super(),this._data=new Je(n),this._updateChangeSubscription()}_updateChangeSubscription(){const n=this._sort?Cl(this._sort.sortChange,this._sort.initialized):vn(null),t=this._paginator?Cl(this._paginator.page,this._internalPageChanges,this._paginator.initialized):vn(null),r=Lv([this._data,this._filter]).pipe($t(([v])=>this._filterData(v))),a=Lv([r,n]).pipe($t(([v])=>this._orderData(v))),h=Lv([a,t]).pipe($t(([v])=>this._pageData(v)));this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=h.subscribe(v=>this._renderData.next(v))}_filterData(n){return this.filteredData=null==this.filter||""===this.filter?n:n.filter(t=>this.filterPredicate(t,this.filter)),this.paginator&&this._updatePaginator(this.filteredData.length),this.filteredData}_orderData(n){return this.sort?this.sortData(n.slice(),this.sort):n}_pageData(n){if(!this.paginator)return n;const t=this.paginator.pageIndex*this.paginator.pageSize;return n.slice(t,t+this.paginator.pageSize)}_updatePaginator(n){Promise.resolve().then(()=>{const t=this.paginator;if(t&&(t.length=n,t.pageIndex>0)){const i=Math.ceil(t.length/t.pageSize)-1||0,r=Math.min(t.pageIndex,i);r!==t.pageIndex&&(t.pageIndex=r,this._internalPageChanges.next())}})}connect(){return this._renderChangesSubscription||this._updateChangeSubscription(),this._renderData}disconnect(){this._renderChangesSubscription?.unsubscribe(),this._renderChangesSubscription=null}}let s8=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,or]})}return e})(),a8=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,or]})}return e})(),c8=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,GC]})}return e})();const d8=new ct("CdkAccordion");let mfe=(()=>{class e{accordion=re(d8,{optional:!0,skipSelf:!0});_changeDetectorRef=re(Bo);_expansionDispatcher=re(s6);_openCloseAllSubscription=Ni.EMPTY;closed=new Dt;opened=new Dt;destroyed=new Dt;expandedChange=new Dt;id=re(du).getId("cdk-accordion-child-");get expanded(){return this._expanded}set expanded(t){this._expanded!==t&&(this._expanded=t,this.expandedChange.emit(t),t?(this.opened.emit(),this._expansionDispatcher.notify(this.id,this.accordion?this.accordion.id:this.id)):this.closed.emit(),this._changeDetectorRef.markForCheck())}_expanded=!1;disabled=!1;_removeUniqueSelectionListener=()=>{};constructor(){}ngOnInit(){this._removeUniqueSelectionListener=this._expansionDispatcher.listen((t,i)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===i&&this.id!==t&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",zn],disabled:[2,"disabled","disabled",zn]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],features:[Jn([{provide:d8,useValue:void 0}]),jr]})}return e})(),gfe=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({})}return e})();const _fe=["body"],yfe=["bodyWrapper"],vfe=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],bfe=["mat-expansion-panel-header","*","mat-action-row"];function xfe(e,n){}const wfe=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],Cfe=["mat-panel-title","mat-panel-description","*"];function Tfe(e,n){1&e&&(Fe(0,"span",1),Ma(),Fe(1,"svg",2),_n(2,"path",3),Ue()())}const u8=new ct("MAT_ACCORDION"),h8=new ct("MAT_EXPANSION_PANEL");let Mfe=(()=>{class e{_template=re(Lo);_expansionPanel=re(h8,{optional:!0});constructor(){}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["ng-template","matExpansionPanelContent",""]]})}return e})();const f8=new ct("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS");let p8=(()=>{class e extends mfe{_viewContainerRef=re(ms);_animationsDisabled="NoopAnimations"===re(Ga,{optional:!0});_document=re(ir);_ngZone=re(Ht);_elementRef=re(In);_renderer=re(Ns);_cleanupTransitionEnd;get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=t}_hideToggle=!1;get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}_togglePosition;afterExpand=new Dt;afterCollapse=new Dt;_inputChanges=new Ie;accordion=re(u8,{optional:!0,skipSelf:!0});_lazyContent;_body;_bodyWrapper;_portal;_headerId=re(du).getId("mat-expansion-panel-header-");constructor(){super();const t=re(f8,{optional:!0});this._expansionDispatcher=re(s6),t&&(this.hideToggle=t.hideToggle)}_hasSpacing(){return!!this.accordion&&this.expanded&&"default"===this.accordion.displayMode}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(Ch(null),is(()=>this.expanded&&!this._portal),Ac(1)).subscribe(()=>{this._portal=new eI(this._lazyContent._template,this._viewContainerRef)}),this._setupAnimationEvents()}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._cleanupTransitionEnd?.(),this._inputChanges.complete()}_containsFocus(){if(this._body){const t=this._document.activeElement,i=this._body.nativeElement;return t===i||i.contains(t)}return!1}_transitionEndListener=({target:t,propertyName:i})=>{t===this._bodyWrapper?.nativeElement&&"grid-template-rows"===i&&this._ngZone.run(()=>{this.expanded?this.afterExpand.emit():this.afterCollapse.emit()})};_setupAnimationEvents(){this._ngZone.runOutsideAngular(()=>{this._animationsDisabled?(this.opened.subscribe(()=>this._ngZone.run(()=>this.afterExpand.emit())),this.closed.subscribe(()=>this._ngZone.run(()=>this.afterCollapse.emit()))):setTimeout(()=>{const t=this._elementRef.nativeElement;this._cleanupTransitionEnd=this._renderer.listen(t,"transitionend",this._transitionEndListener),t.classList.add("mat-expansion-panel-animations-enabled")},200)})}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-expansion-panel"]],contentQueries:function(i,r,a){if(1&i&&bo(a,Mfe,5),2&i){let h;ri(h=oi())&&(r._lazyContent=h.first)}},viewQuery:function(i,r){if(1&i&&(zr(_fe,5),zr(yfe,5)),2&i){let a;ri(a=oi())&&(r._body=a.first),ri(a=oi())&&(r._bodyWrapper=a.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:4,hostBindings:function(i,r){2&i&&Ti("mat-expanded",r.expanded)("mat-expansion-panel-spacing",r._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",zn],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],features:[Jn([{provide:u8,useValue:void 0},{provide:h8,useExisting:e}]),jr,Gn,sr],ngContentSelectors:bfe,decls:9,vars:4,consts:[["bodyWrapper",""],["body",""],[1,"mat-expansion-panel-content-wrapper"],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(i,r){1&i&&(zo(vfe),ai(0),Fe(1,"div",2,0)(3,"div",3,1)(5,"div",4),ai(6,1),an(7,xfe,0,0,"ng-template",5),Ue(),ai(8,2),Ue()()),2&i&&(Ze(),ui("inert",r.expanded?null:""),Ze(2),At("id",r.id),ui("aria-labelledby",r._headerId),Ze(4),At("cdkPortalOutlet",r._portal))},dependencies:[Wde],styles:[".mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;position:relative;background:var(--mat-expansion-container-background-color, var(--mat-sys-surface));color:var(--mat-expansion-container-text-color, var(--mat-sys-on-surface));border-radius:var(--mat-expansion-container-shape, 12px)}.mat-expansion-panel.mat-expansion-panel-animations-enabled{transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape, 12px);border-top-left-radius:var(--mat-expansion-container-shape, 12px)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape, 12px);border-bottom-left-radius:var(--mat-expansion-container-shape, 12px)}@media(forced-colors: active){.mat-expansion-panel{outline:solid 1px}}.mat-expansion-panel-content-wrapper{display:grid;grid-template-rows:0fr;grid-template-columns:100%}.mat-expansion-panel-animations-enabled .mat-expansion-panel-content-wrapper{transition:grid-template-rows 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel.mat-expanded>.mat-expansion-panel-content-wrapper{grid-template-rows:1fr}@supports not (grid-template-rows: 0fr){.mat-expansion-panel-content-wrapper{height:0}.mat-expansion-panel.mat-expanded>.mat-expansion-panel-content-wrapper{height:auto}}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;min-height:0;visibility:hidden;font-family:var(--mat-expansion-container-text-font, var(--mat-sys-body-large-font));font-size:var(--mat-expansion-container-text-size, var(--mat-sys-body-large-size));font-weight:var(--mat-expansion-container-text-weight, var(--mat-sys-body-large-weight));line-height:var(--mat-expansion-container-text-line-height, var(--mat-sys-body-large-line-height));letter-spacing:var(--mat-expansion-container-text-tracking, var(--mat-sys-body-large-tracking))}.mat-expansion-panel-animations-enabled .mat-expansion-panel-content{transition:visibility 190ms linear}.mat-expansion-panel.mat-expanded>.mat-expansion-panel-content-wrapper>.mat-expansion-panel-content{visibility:visible}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color, var(--mat-sys-outline))}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}"],encapsulation:2,changeDetection:0})}return e})(),Sfe=(()=>{class e{panel=re(p8,{host:!0});_element=re(In);_focusMonitor=re(Lx);_changeDetectorRef=re(Bo);_parentChangeSubscription=Ni.EMPTY;constructor(){re(Oc).load(Qv);const t=this.panel,i=re(f8,{optional:!0}),r=re(new pt("tabindex"),{optional:!0}),a=t.accordion?t.accordion._stateChanges.pipe(is(h=>!(!h.hideToggle&&!h.togglePosition))):yd;this.tabIndex=parseInt(r||"")||0,this._parentChangeSubscription=Cl(t.opened,t.closed,a,t._inputChanges.pipe(is(h=>!!(h.hideToggle||h.disabled||h.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe(is(()=>t._containsFocus())).subscribe(()=>this._focusMonitor.focusVia(this._element,"program")),i&&(this.expandedHeight=i.expandedHeight,this.collapsedHeight=i.collapsedHeight)}expandedHeight;collapsedHeight;tabIndex=0;get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){const t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case 32:case 13:Pm(t)||(t.preventDefault(),this._toggle());break;default:return void(this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t))}}focus(t,i){t?this._focusMonitor.focusVia(this._element,t,i):this._element.nativeElement.focus(i)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:13,hostBindings:function(i,r){1&i&&Nn("click",function(){return r._toggle()})("keydown",function(h){return r._keydown(h)}),2&i&&(ui("id",r.panel._headerId)("tabindex",r.disabled?-1:r.tabIndex)("aria-controls",r._getPanelId())("aria-expanded",r._isExpanded())("aria-disabled",r.panel.disabled),Ia("height",r._getHeaderHeight()),Ti("mat-expanded",r._isExpanded())("mat-expansion-toggle-indicator-after","after"===r._getTogglePosition())("mat-expansion-toggle-indicator-before","before"===r._getTogglePosition()))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",t=>null==t?0:Ya(t)]},features:[jr],ngContentSelectors:Cfe,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(i,r){1&i&&(zo(wfe),Fe(0,"span",0),ai(1),ai(2,1),ai(3,2),Ue(),an(4,Tfe,3,0,"span",1)),2&i&&(Ti("mat-content-hide-toggle",!r._showToggle()),Ze(4),Mr(r._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;height:var(--mat-expansion-header-collapsed-state-height, 48px);font-family:var(--mat-expansion-header-text-font, var(--mat-sys-title-medium-font));font-size:var(--mat-expansion-header-text-size, var(--mat-sys-title-medium-size));font-weight:var(--mat-expansion-header-text-weight, var(--mat-sys-title-medium-weight));line-height:var(--mat-expansion-header-text-line-height, var(--mat-sys-title-medium-line-height));letter-spacing:var(--mat-expansion-header-text-tracking, var(--mat-sys-title-medium-tracking))}.mat-expansion-panel-animations-enabled .mat-expansion-panel-header{transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height, 64px)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color, color-mix(in srgb, var(--mat-sys-on-surface) 38%, transparent))}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-hover-state-layer-opacity) * 100%), transparent))}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color, var(--mat-sys-surface))}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color, color-mix(in srgb, var(--mat-sys-on-surface) calc(var(--mat-sys-focus-state-layer-opacity) * 100%), transparent))}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color, var(--mat-sys-on-surface))}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color, var(--mat-sys-on-surface-variant))}.mat-expansion-panel-animations-enabled .mat-expansion-indicator{transition:transform 225ms cubic-bezier(0.4, 0, 0.2, 1)}.mat-expansion-panel-header.mat-expanded .mat-expansion-indicator{transform:rotate(180deg)}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color, var(--mat-sys-on-surface-variant));display:var(--mat-expansion-legacy-header-indicator-display, none)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color, var(--mat-sys-on-surface-variant));display:var(--mat-expansion-header-indicator-display, inline-block)}@media(forced-colors: active){.mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}}'],encapsulation:2,changeDetection:0})}return e})(),Efe=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"]})}return e})(),m8=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or,gfe,g6]})}return e})();const Dfe=["determinateSpinner"];function Ife(e,n){if(1&e&&(Ma(),Fe(0,"svg",11),_n(1,"circle",12),Ue()),2&e){const t=cn();ui("viewBox",t._viewBox()),Ze(),Ia("stroke-dasharray",t._strokeCircumference(),"px")("stroke-dashoffset",t._strokeCircumference()/2,"px")("stroke-width",t._circleStrokeWidth(),"%"),ui("r",t._circleRadius())}}const kfe=new ct("mat-progress-spinner-default-options",{providedIn:"root",factory:function Afe(){return{diameter:_8}}}),_8=100;let y8=(()=>{class e{_elementRef=re(In);_noopAnimations;get color(){return this._color||this._defaultColor}set color(t){this._color=t}_color;_defaultColor="primary";_determinateCircle;constructor(){const t=re(Ga,{optional:!0}),i=re(kfe);this._noopAnimations="NoopAnimations"===t&&!!i&&!i._forceAnimations,this.mode="mat-spinner"===this._elementRef.nativeElement.nodeName.toLowerCase()?"indeterminate":"determinate",i&&(i.color&&(this.color=this._defaultColor=i.color),i.diameter&&(this.diameter=i.diameter),i.strokeWidth&&(this.strokeWidth=i.strokeWidth))}mode;get value(){return"determinate"===this.mode?this._value:0}set value(t){this._value=Math.max(0,Math.min(100,t||0))}_value=0;get diameter(){return this._diameter}set diameter(t){this._diameter=t||0}_diameter=_8;get strokeWidth(){return this._strokeWidth??this.diameter/10}set strokeWidth(t){this._strokeWidth=t||0}_strokeWidth;_circleRadius(){return(this.diameter-10)/2}_viewBox(){const t=2*this._circleRadius()+this.strokeWidth;return`0 0 ${t} ${t}`}_strokeCircumference(){return 2*Math.PI*this._circleRadius()}_strokeDashOffset(){return"determinate"===this.mode?this._strokeCircumference()*(100-this._value)/100:null}_circleStrokeWidth(){return this.strokeWidth/this.diameter*100}static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["mat-progress-spinner"],["mat-spinner"]],viewQuery:function(i,r){if(1&i&&zr(Dfe,5),2&i){let a;ri(a=oi())&&(r._determinateCircle=a.first)}},hostAttrs:["role","progressbar","tabindex","-1",1,"mat-mdc-progress-spinner","mdc-circular-progress"],hostVars:18,hostBindings:function(i,r){2&i&&(ui("aria-valuemin",0)("aria-valuemax",100)("aria-valuenow","determinate"===r.mode?r.value:null)("mode",r.mode),ka("mat-"+r.color),Ia("width",r.diameter,"px")("height",r.diameter,"px")("--mdc-circular-progress-size",r.diameter+"px")("--mdc-circular-progress-active-indicator-width",r.diameter+"px"),Ti("_mat-animation-noopable",r._noopAnimations)("mdc-circular-progress--indeterminate","indeterminate"===r.mode))},inputs:{color:"color",mode:"mode",value:[2,"value","value",Ya],diameter:[2,"diameter","diameter",Ya],strokeWidth:[2,"strokeWidth","strokeWidth",Ya]},exportAs:["matProgressSpinner"],features:[jr],decls:14,vars:11,consts:[["circle",""],["determinateSpinner",""],["aria-hidden","true",1,"mdc-circular-progress__determinate-container"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__determinate-circle-graphic"],["cx","50%","cy","50%",1,"mdc-circular-progress__determinate-circle"],["aria-hidden","true",1,"mdc-circular-progress__indeterminate-container"],[1,"mdc-circular-progress__spinner-layer"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-left"],[3,"ngTemplateOutlet"],[1,"mdc-circular-progress__gap-patch"],[1,"mdc-circular-progress__circle-clipper","mdc-circular-progress__circle-right"],["xmlns","http://www.w3.org/2000/svg","focusable","false",1,"mdc-circular-progress__indeterminate-circle-graphic"],["cx","50%","cy","50%"]],template:function(i,r){if(1&i&&(an(0,Ife,2,8,"ng-template",null,0,wm),Fe(2,"div",2,1),Ma(),Fe(4,"svg",3),_n(5,"circle",4),Ue()(),Xu(),Fe(6,"div",5)(7,"div",6)(8,"div",7),zs(9,8),Ue(),Fe(10,"div",9),zs(11,8),Ue(),Fe(12,"div",10),zs(13,8),Ue()()()),2&i){const a=Za(1);Ze(4),ui("viewBox",r._viewBox()),Ze(),Ia("stroke-dasharray",r._strokeCircumference(),"px")("stroke-dashoffset",r._strokeDashOffset(),"px")("stroke-width",r._circleStrokeWidth(),"%"),ui("r",r._circleRadius()),Ze(4),At("ngTemplateOutlet",a),Ze(2),At("ngTemplateOutlet",a),Ze(2),At("ngTemplateOutlet",a)}},dependencies:[sC],styles:[".mat-mdc-progress-spinner{display:block;overflow:hidden;line-height:0;position:relative;direction:ltr;transition:opacity 250ms cubic-bezier(0.4, 0, 0.6, 1)}.mat-mdc-progress-spinner circle{stroke-width:var(--mdc-circular-progress-active-indicator-width, 4px)}.mat-mdc-progress-spinner._mat-animation-noopable,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__determinate-circle{transition:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__spinner-layer,.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container{animation:none !important}.mat-mdc-progress-spinner._mat-animation-noopable .mdc-circular-progress__indeterminate-container circle{stroke-dasharray:0 !important}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic,.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle{stroke:currentColor;stroke:CanvasText}}.mdc-circular-progress__determinate-container,.mdc-circular-progress__indeterminate-circle-graphic,.mdc-circular-progress__indeterminate-container,.mdc-circular-progress__spinner-layer{position:absolute;width:100%;height:100%}.mdc-circular-progress__determinate-container{transform:rotate(-90deg)}.mdc-circular-progress--indeterminate .mdc-circular-progress__determinate-container{opacity:0}.mdc-circular-progress__indeterminate-container{font-size:0;letter-spacing:0;white-space:nowrap;opacity:0}.mdc-circular-progress--indeterminate .mdc-circular-progress__indeterminate-container{opacity:1;animation:mdc-circular-progress-container-rotate 1568.2352941176ms linear infinite}.mdc-circular-progress__determinate-circle-graphic,.mdc-circular-progress__indeterminate-circle-graphic{fill:rgba(0,0,0,0)}.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:var(--mdc-circular-progress-active-indicator-color, var(--mat-sys-primary))}@media(forced-colors: active){.mat-mdc-progress-spinner .mdc-circular-progress__determinate-circle,.mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:CanvasText}}.mdc-circular-progress__determinate-circle{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1)}.mdc-circular-progress__gap-patch{position:absolute;top:0;left:47.5%;box-sizing:border-box;width:5%;height:100%;overflow:hidden}.mdc-circular-progress__gap-patch .mdc-circular-progress__indeterminate-circle-graphic{left:-900%;width:2000%;transform:rotate(180deg)}.mdc-circular-progress__circle-clipper .mdc-circular-progress__indeterminate-circle-graphic{width:200%}.mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{left:-100%}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-left .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-left-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress--indeterminate .mdc-circular-progress__circle-right .mdc-circular-progress__indeterminate-circle-graphic{animation:mdc-circular-progress-right-spin 1333ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}.mdc-circular-progress__circle-clipper{display:inline-flex;position:relative;width:50%;height:100%;overflow:hidden}.mdc-circular-progress--indeterminate .mdc-circular-progress__spinner-layer{animation:mdc-circular-progress-spinner-layer-rotate 5332ms cubic-bezier(0.4, 0, 0.2, 1) infinite both}@keyframes mdc-circular-progress-container-rotate{to{transform:rotate(360deg)}}@keyframes mdc-circular-progress-spinner-layer-rotate{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes mdc-circular-progress-left-spin{from{transform:rotate(265deg)}50%{transform:rotate(130deg)}to{transform:rotate(265deg)}}@keyframes mdc-circular-progress-right-spin{from{transform:rotate(-265deg)}50%{transform:rotate(-130deg)}to{transform:rotate(-265deg)}}"],encapsulation:2,changeDetection:0})}return e})(),v8=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[or]})}return e})(),w8=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({imports:[_H,or,_H,or]})}return e})();function fF(e=0,n=ND){return e<0&&(e=0),b6(e,e,n)}function C8(e){const n=e.cloneNode(!0),t=n.querySelectorAll("[id]"),i=e.nodeName.toLowerCase();n.removeAttribute("id");for(let r=0;r<t.length;r++)t[r].removeAttribute("id");return"canvas"===i?S8(e,n):("input"===i||"select"===i||"textarea"===i)&&M8(e,n),T8("canvas",e,n,S8),T8("input, textarea, select",e,n,M8),n}function T8(e,n,t,i){const r=n.querySelectorAll(e);if(r.length){const a=t.querySelectorAll(e);for(let h=0;h<r.length;h++)i(r[h],a[h])}}let Ffe=0;function M8(e,n){"file"!==n.type&&(n.value=e.value),"radio"===n.type&&n.name&&(n.name=`mat-clone-${n.name}-${Ffe++}`)}function S8(e,n){const t=n.getContext("2d");if(t)try{t.drawImage(e,0,0)}catch{}}function pF(e){const n=e.getBoundingClientRect();return{top:n.top,right:n.right,bottom:n.bottom,left:n.left,width:n.width,height:n.height,x:n.x,y:n.y}}function mF(e,n,t){const{top:i,bottom:r,left:a,right:h}=e;return t>=i&&t<=r&&n>=a&&n<=h}function iT(e,n,t){e.top+=n,e.bottom=e.top+e.height,e.left+=t,e.right=e.left+e.width}function E8(e,n,t,i){const{top:r,right:a,bottom:h,left:v,width:C,height:P}=e,L=C*n,V=P*n;return i>r-V&&i<h+V&&t>v-L&&t<a+L}class D8{_document;positions=new Map;constructor(n){this._document=n}clear(){this.positions.clear()}cache(n){this.clear(),this.positions.set(this._document,{scrollPosition:this.getViewportScrollPosition()}),n.forEach(t=>{this.positions.set(t,{scrollPosition:{top:t.scrollTop,left:t.scrollLeft},clientRect:pF(t)})})}handleScroll(n){const t=Pc(n),i=this.positions.get(t);if(!i)return null;const r=i.scrollPosition;let a,h;if(t===this._document){const P=this.getViewportScrollPosition();a=P.top,h=P.left}else a=t.scrollTop,h=t.scrollLeft;const v=r.top-a,C=r.left-h;return this.positions.forEach((P,L)=>{P.clientRect&&t!==L&&t.contains(L)&&iT(P.clientRect,v,C)}),r.top=a,r.left=h,{top:v,left:C}}getViewportScrollPosition(){return{top:window.scrollY,left:window.scrollX}}}function I8(e,n){const t=e.rootNodes;if(1===t.length&&t[0].nodeType===n.ELEMENT_NODE)return t[0];const i=n.createElement("div");return t.forEach(r=>i.appendChild(r)),i}function gF(e,n,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];r?e.setProperty(i,r,t?.has(i)?"important":""):e.removeProperty(i)}return e}function Hx(e,n){const t=n?"":"none";gF(e.style,{"touch-action":n?"":"none","-webkit-user-drag":n?"":"none","-webkit-tap-highlight-color":n?"":"transparent","user-select":t,"-ms-user-select":t,"-webkit-user-select":t,"-moz-user-select":t})}function k8(e,n,t){gF(e.style,{position:n?"":"fixed",top:n?"":"0",opacity:n?"":"0",left:n?"":"-999em"},t)}function yI(e,n){return n&&"none"!=n?e+" "+n:e}function A8(e,n){e.style.width=`${n.width}px`,e.style.height=`${n.height}px`,e.style.transform=vI(n.left,n.top)}function vI(e,n){return`translate3d(${Math.round(e)}px, ${Math.round(n)}px, 0)`}function R8(e){const n=e.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(e)*n}function _F(e,n){return e.getPropertyValue(n).split(",").map(i=>i.trim())}const Nfe=new Set(["position"]);class zfe{_document;_rootElement;_direction;_initialDomRect;_previewTemplate;_previewClass;_pickupPositionOnPage;_initialTransform;_zIndex;_renderer;_previewEmbeddedView;_preview;get element(){return this._preview}constructor(n,t,i,r,a,h,v,C,P,L){this._document=n,this._rootElement=t,this._direction=i,this._initialDomRect=r,this._previewTemplate=a,this._previewClass=h,this._pickupPositionOnPage=v,this._initialTransform=C,this._zIndex=P,this._renderer=L}attach(n){this._preview=this._createPreview(),n.appendChild(this._preview),P8(this._preview)&&this._preview.showPopover()}destroy(){this._preview.remove(),this._previewEmbeddedView?.destroy(),this._preview=this._previewEmbeddedView=null}setTransform(n){this._preview.style.transform=n}getBoundingClientRect(){return this._preview.getBoundingClientRect()}addClass(n){this._preview.classList.add(n)}getTransitionDuration(){return function Lfe(e){const n=getComputedStyle(e),t=_F(n,"transition-property"),i=t.find(v=>"transform"===v||"all"===v);if(!i)return 0;const r=t.indexOf(i),a=_F(n,"transition-duration"),h=_F(n,"transition-delay");return R8(a[r])+R8(h[r])}(this._preview)}addEventListener(n,t){return this._renderer.listen(this._preview,n,t)}_createPreview(){const n=this._previewTemplate,t=this._previewClass,i=n?n.template:null;let r;if(i&&n){const a=n.matchSize?this._initialDomRect:null,h=n.viewContainer.createEmbeddedView(i,n.context);h.detectChanges(),r=I8(h,this._document),this._previewEmbeddedView=h,n.matchSize?A8(r,a):r.style.transform=vI(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else r=C8(this._rootElement),A8(r,this._initialDomRect),this._initialTransform&&(r.style.transform=this._initialTransform);return gF(r.style,{"pointer-events":"none",margin:P8(r)?"0 auto 0 0":"0",position:"fixed",top:"0",left:"0","z-index":this._zIndex+""},Nfe),Hx(r,!1),r.classList.add("cdk-drag-preview"),r.setAttribute("popover","manual"),r.setAttribute("dir",this._direction),t&&(Array.isArray(t)?t.forEach(a=>r.classList.add(a)):r.classList.add(t)),r}}function P8(e){return"showPopover"in e}const O8=cu({passive:!0}),bI=cu({passive:!1}),F8=cu({passive:!1,capture:!0}),L8=new Set(["position"]);class Vfe{_config;_document;_ngZone;_viewportRuler;_dragDropRegistry;_renderer;_preview;_previewContainer;_placeholderRef;_placeholder;_pickupPositionInElement;_pickupPositionOnPage;_anchor;_passiveTransform={x:0,y:0};_activeTransform={x:0,y:0};_initialTransform;_hasStartedDragging=ha(!1);_hasMoved;_initialContainer;_initialIndex;_parentPositions;_moveEvents=new Ie;_pointerDirectionDelta;_pointerPositionAtLastDirectionChange;_lastKnownPointerPosition;_rootElement;_ownerSVGElement;_rootElementTapHighlight;_pointerMoveSubscription=Ni.EMPTY;_pointerUpSubscription=Ni.EMPTY;_scrollSubscription=Ni.EMPTY;_resizeSubscription=Ni.EMPTY;_lastTouchEventTime;_dragStartTime;_boundaryElement=null;_nativeInteractionsEnabled=!0;_initialDomRect;_previewRect;_boundaryRect;_previewTemplate;_placeholderTemplate;_handles=[];_disabledHandles=new Set;_dropContainer;_direction="ltr";_parentDragRef;_cachedShadowRoot;lockAxis;dragStartDelay=0;previewClass;scale=1;get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(n){n!==this._disabled&&(this._disabled=n,this._toggleNativeDragInteractions(),this._handles.forEach(t=>Hx(t,n)))}_disabled=!1;beforeStarted=new Ie;started=new Ie;released=new Ie;ended=new Ie;entered=new Ie;exited=new Ie;dropped=new Ie;moved=this._moveEvents;data;constrainPosition;constructor(n,t,i,r,a,h,v){this._config=t,this._document=i,this._ngZone=r,this._viewportRuler=a,this._dragDropRegistry=h,this._renderer=v,this.withRootElement(n).withParent(t.parentDragRef||null),this._parentPositions=new D8(i),h.registerDragItem(this)}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(n){this._handles=n.map(i=>xl(i)),this._handles.forEach(i=>Hx(i,this.disabled)),this._toggleNativeDragInteractions();const t=new Set;return this._disabledHandles.forEach(i=>{this._handles.indexOf(i)>-1&&t.add(i)}),this._disabledHandles=t,this}withPreviewTemplate(n){return this._previewTemplate=n,this}withPlaceholderTemplate(n){return this._placeholderTemplate=n,this}withRootElement(n){const t=xl(n);return t!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{t.addEventListener("mousedown",this._pointerDown,bI),t.addEventListener("touchstart",this._pointerDown,O8),t.addEventListener("dragstart",this._nativeDragStart,bI)}),this._initialTransform=void 0,this._rootElement=t),typeof SVGElement<"u"&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(n){return this._boundaryElement=n?xl(n):null,this._resizeSubscription.unsubscribe(),n&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(n){return this._parentDragRef=n,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&this._rootElement?.remove(),this._anchor?.remove(),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeListeners(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging()&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(n){!this._disabledHandles.has(n)&&this._handles.indexOf(n)>-1&&(this._disabledHandles.add(n),Hx(n,!0))}enableHandle(n){this._disabledHandles.has(n)&&(this._disabledHandles.delete(n),Hx(n,this.disabled))}withDirection(n){return this._direction=n,this}_withDropContainer(n){this._dropContainer=n}getFreeDragPosition(){const n=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:n.x,y:n.y}}setFreeDragPosition(n){return this._activeTransform={x:0,y:0},this._passiveTransform.x=n.x,this._passiveTransform.y=n.y,this._dropContainer||this._applyRootElementTransform(n.x,n.y),this}withPreviewContainer(n){return this._previewContainer=n,this}_sortFromLastPointerPosition(){const n=this._lastKnownPointerPosition;n&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(n),n)}_removeListeners(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe(),this._getShadowRoot()?.removeEventListener("selectstart",z8,F8)}_destroyPreview(){this._preview?.destroy(),this._preview=null}_destroyPlaceholder(){this._placeholder?.remove(),this._placeholderRef?.destroy(),this._placeholder=this._placeholderRef=null}_pointerDown=n=>{if(this.beforeStarted.next(),this._handles.length){const t=this._getTargetHandle(n);t&&!this._disabledHandles.has(t)&&!this.disabled&&this._initializeDragSequence(t,n)}else this.disabled||this._initializeDragSequence(this._rootElement,n)};_pointerMove=n=>{const t=this._getPointerPositionOnPage(n);if(!this._hasStartedDragging()){if(Math.abs(t.x-this._pickupPositionOnPage.x)+Math.abs(t.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const v=Date.now()>=this._dragStartTime+this._getDragStartDelay(n),C=this._dropContainer;if(!v)return void this._endDragSequence(n);(!C||!C.isDragging()&&!C.isReceiving())&&(n.cancelable&&n.preventDefault(),this._hasStartedDragging.set(!0),this._ngZone.run(()=>this._startDragSequence(n)))}return}n.cancelable&&n.preventDefault();const i=this._getConstrainedPointerPosition(t);if(this._hasMoved=!0,this._lastKnownPointerPosition=t,this._updatePointerDirectionDelta(i),this._dropContainer)this._updateActiveDropContainer(i,t);else{const r=this.constrainPosition?this._initialDomRect:this._pickupPositionOnPage,a=this._activeTransform;a.x=i.x-r.x+this._passiveTransform.x,a.y=i.y-r.y+this._passiveTransform.y,this._applyRootElementTransform(a.x,a.y)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:i,event:n,distance:this._getDragDistance(i),delta:this._pointerDirectionDelta})})};_pointerUp=n=>{this._endDragSequence(n)};_endDragSequence(n){if(this._dragDropRegistry.isDragging(this)&&(this._removeListeners(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging()))if(this.released.next({source:this,event:n}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(n),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const t=this._getPointerPositionOnPage(n);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(t),dropPoint:t,event:n})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(n){rT(n)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const t=this._getShadowRoot(),i=this._dropContainer;if(t&&this._ngZone.runOutsideAngular(()=>{t.addEventListener("selectstart",z8,F8)}),i){const r=this._rootElement,a=r.parentNode,h=this._placeholder=this._createPlaceholderElement(),v=this._anchor=this._anchor||this._document.createComment("");a.insertBefore(v,r),this._initialTransform=r.style.transform||"",this._preview=new zfe(this._document,this._rootElement,this._direction,this._initialDomRect,this._previewTemplate||null,this.previewClass||null,this._pickupPositionOnPage,this._initialTransform,this._config.zIndex||1e3,this._renderer),this._preview.attach(this._getPreviewInsertionPoint(a,t)),k8(r,!1,L8),this._document.body.appendChild(a.replaceChild(h,r)),this.started.next({source:this,event:n}),i.start(),this._initialContainer=i,this._initialIndex=i.getItemIndex(this)}else this.started.next({source:this,event:n}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(i?i.getScrollableParents():[])}_initializeDragSequence(n,t){this._parentDragRef&&t.stopPropagation();const i=this.isDragging(),r=rT(t),a=!r&&0!==t.button,h=this._rootElement,v=Pc(t),C=!r&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),P=r?jD(t):UD(t);if(v&&v.draggable&&"mousedown"===t.type&&t.preventDefault(),i||a||C||P)return;if(this._handles.length){const W=h.style;this._rootElementTapHighlight=W.webkitTapHighlightColor||"",W.webkitTapHighlightColor="transparent"}this._hasMoved=!1,this._hasStartedDragging.set(this._hasMoved),this._removeListeners(),this._initialDomRect=this._rootElement.getBoundingClientRect(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(W=>this._updateOnScroll(W)),this._boundaryElement&&(this._boundaryRect=pF(this._boundaryElement));const L=this._previewTemplate;this._pickupPositionInElement=L&&L.template&&!L.matchSize?{x:0,y:0}:this._getPointerPositionInElement(this._initialDomRect,n,t);const V=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(t);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:V.x,y:V.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,t)}_cleanupDragArtifacts(n){k8(this._rootElement,!0,L8),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._initialDomRect=this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const t=this._dropContainer,i=t.getItemIndex(this),r=this._getPointerPositionOnPage(n),a=this._getDragDistance(r),h=t._isOverContainer(r.x,r.y);this.ended.next({source:this,distance:a,dropPoint:r,event:n}),this.dropped.next({item:this,currentIndex:i,previousIndex:this._initialIndex,container:t,previousContainer:this._initialContainer,isPointerOverContainer:h,distance:a,dropPoint:r,event:n}),t.drop(this,i,this._initialIndex,this._initialContainer,h,a,r,n),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:n,y:t},{x:i,y:r}){let a=this._initialContainer._getSiblingContainerFromPosition(this,n,t);!a&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(n,t)&&(a=this._initialContainer),a&&a!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=a,this._dropContainer.enter(this,n,t,a===this._initialContainer&&a.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:a,currentIndex:a.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(i,r),this._dropContainer._sortItem(this,n,t,this._pointerDirectionDelta),this.constrainPosition?this._applyPreviewTransform(n,t):this._applyPreviewTransform(n-this._pickupPositionInElement.x,t-this._pickupPositionInElement.y))}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const n=this._placeholder.getBoundingClientRect();this._preview.addClass("cdk-drag-animating"),this._applyPreviewTransform(n.left,n.top);const t=this._preview.getTransitionDuration();return 0===t?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(i=>{const r=v=>{(!v||this._preview&&Pc(v)===this._preview.element&&"transform"===v.propertyName)&&(h(),i(),clearTimeout(a))},a=setTimeout(r,1.5*t),h=this._preview.addEventListener("transitionend",r)}))}_createPlaceholderElement(){const n=this._placeholderTemplate,t=n?n.template:null;let i;return t?(this._placeholderRef=n.viewContainer.createEmbeddedView(t,n.context),this._placeholderRef.detectChanges(),i=I8(this._placeholderRef,this._document)):i=C8(this._rootElement),i.style.pointerEvents="none",i.classList.add("cdk-drag-placeholder"),i}_getPointerPositionInElement(n,t,i){const r=t===this._rootElement?null:t,a=r?r.getBoundingClientRect():n,h=rT(i)?i.targetTouches[0]:i,v=this._getViewportScrollPosition();return{x:a.left-n.left+(h.pageX-a.left-v.left),y:a.top-n.top+(h.pageY-a.top-v.top)}}_getPointerPositionOnPage(n){const t=this._getViewportScrollPosition(),i=rT(n)?n.touches[0]||n.changedTouches[0]||{pageX:0,pageY:0}:n,r=i.pageX-t.left,a=i.pageY-t.top;if(this._ownerSVGElement){const h=this._ownerSVGElement.getScreenCTM();if(h){const v=this._ownerSVGElement.createSVGPoint();return v.x=r,v.y=a,v.matrixTransform(h.inverse())}}return{x:r,y:a}}_getConstrainedPointerPosition(n){const t=this._dropContainer?this._dropContainer.lockAxis:null;let{x:i,y:r}=this.constrainPosition?this.constrainPosition(n,this,this._initialDomRect,this._pickupPositionInElement):n;if("x"===this.lockAxis||"x"===t?r=this._pickupPositionOnPage.y-(this.constrainPosition?this._pickupPositionInElement.y:0):("y"===this.lockAxis||"y"===t)&&(i=this._pickupPositionOnPage.x-(this.constrainPosition?this._pickupPositionInElement.x:0)),this._boundaryRect){const{x:a,y:h}=this.constrainPosition?{x:0,y:0}:this._pickupPositionInElement,v=this._boundaryRect,{width:C,height:P}=this._getPreviewRect(),L=v.top+h,V=v.bottom-(P-h);i=N8(i,v.left+a,v.right-(C-a)),r=N8(r,L,V)}return{x:i,y:r}}_updatePointerDirectionDelta(n){const{x:t,y:i}=n,r=this._pointerDirectionDelta,a=this._pointerPositionAtLastDirectionChange,h=Math.abs(t-a.x),v=Math.abs(i-a.y);return h>this._config.pointerDirectionChangeThreshold&&(r.x=t>a.x?1:-1,a.x=t),v>this._config.pointerDirectionChangeThreshold&&(r.y=i>a.y?1:-1,a.y=i),r}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const n=this._handles.length>0||!this.isDragging();n!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=n,Hx(this._rootElement,n))}_removeRootElementListeners(n){n.removeEventListener("mousedown",this._pointerDown,bI),n.removeEventListener("touchstart",this._pointerDown,O8),n.removeEventListener("dragstart",this._nativeDragStart,bI)}_applyRootElementTransform(n,t){const i=1/this.scale,r=vI(n*i,t*i),a=this._rootElement.style;null==this._initialTransform&&(this._initialTransform=a.transform&&"none"!=a.transform?a.transform:""),a.transform=yI(r,this._initialTransform)}_applyPreviewTransform(n,t){const i=this._previewTemplate?.template?void 0:this._initialTransform,r=vI(n,t);this._preview.setTransform(yI(r,i))}_getDragDistance(n){const t=this._pickupPositionOnPage;return t?{x:n.x-t.x,y:n.y-t.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:n,y:t}=this._passiveTransform;if(0===n&&0===t||this.isDragging()||!this._boundaryElement)return;const i=this._rootElement.getBoundingClientRect(),r=this._boundaryElement.getBoundingClientRect();if(0===r.width&&0===r.height||0===i.width&&0===i.height)return;const a=r.left-i.left,h=i.right-r.right,v=r.top-i.top,C=i.bottom-r.bottom;r.width>i.width?(a>0&&(n+=a),h>0&&(n-=h)):n=0,r.height>i.height?(v>0&&(t+=v),C>0&&(t-=C)):t=0,(n!==this._passiveTransform.x||t!==this._passiveTransform.y)&&this.setFreeDragPosition({y:t,x:n})}_getDragStartDelay(n){const t=this.dragStartDelay;return"number"==typeof t?t:rT(n)?t.touch:t?t.mouse:0}_updateOnScroll(n){const t=this._parentPositions.handleScroll(n);if(t){const i=Pc(n);this._boundaryRect&&i!==this._boundaryElement&&i.contains(this._boundaryElement)&&iT(this._boundaryRect,t.top,t.left),this._pickupPositionOnPage.x+=t.left,this._pickupPositionOnPage.y+=t.top,this._dropContainer||(this._activeTransform.x-=t.left,this._activeTransform.y-=t.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){return this._parentPositions.positions.get(this._document)?.scrollPosition||this._parentPositions.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=kD(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(n,t){const i=this._previewContainer||"global";if("parent"===i)return n;if("global"===i){const r=this._document;return t||r.fullscreenElement||r.webkitFullscreenElement||r.mozFullScreenElement||r.msFullscreenElement||r.body}return xl(i)}_getPreviewRect(){return(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=this._preview?this._preview.getBoundingClientRect():this._initialDomRect),this._previewRect}_nativeDragStart=n=>{if(this._handles.length){const t=this._getTargetHandle(n);t&&!this._disabledHandles.has(t)&&!this.disabled&&n.preventDefault()}else this.disabled||n.preventDefault()};_getTargetHandle(n){return this._handles.find(t=>n.target&&(n.target===t||t.contains(n.target)))}}function N8(e,n,t){return Math.max(n,Math.min(t,e))}function rT(e){return"t"===e.type[0]}function z8(e){e.preventDefault()}function yF(e,n,t){const i=oT(n,e.length-1),r=oT(t,e.length-1);if(i===r)return;const a=e[i],h=r<i?-1:1;for(let v=i;v!==r;v+=h)e[v]=e[v+h];e[r]=a}function oT(e,n){return Math.max(0,Math.min(n,e))}class B8{_dragDropRegistry;_element;_sortPredicate;_itemPositions=[];_activeDraggables;orientation="vertical";direction;constructor(n){this._dragDropRegistry=n}_previousSwap={drag:null,delta:0,overlaps:!1};start(n){this.withItems(n)}sort(n,t,i,r){const a=this._itemPositions,h=this._getItemIndexFromPointerPosition(n,t,i,r);if(-1===h&&a.length>0)return null;const v="horizontal"===this.orientation,C=a.findIndex(se=>se.drag===n),P=a[h],V=P.clientRect,W=C>h?1:-1,X=this._getItemOffsetPx(a[C].clientRect,V,W),oe=this._getSiblingOffsetPx(C,a,W),he=a.slice();return yF(a,C,h),a.forEach((se,_e)=>{if(he[_e]===se)return;const Se=se.drag===n,$e=Se?X:oe,et=Se?n.getPlaceholderElement():se.drag.getRootElement();se.offset+=$e;const ut=Math.round(se.offset*(1/se.drag.scale));v?(et.style.transform=yI(`translate3d(${ut}px, 0, 0)`,se.initialTransform),iT(se.clientRect,0,$e)):(et.style.transform=yI(`translate3d(0, ${ut}px, 0)`,se.initialTransform),iT(se.clientRect,$e,0))}),this._previousSwap.overlaps=mF(V,t,i),this._previousSwap.drag=P.drag,this._previousSwap.delta=v?r.x:r.y,{previousIndex:C,currentIndex:h}}enter(n,t,i,r){const a=null==r||r<0?this._getItemIndexFromPointerPosition(n,t,i):r,h=this._activeDraggables,v=h.indexOf(n),C=n.getPlaceholderElement();let P=h[a];if(P===n&&(P=h[a+1]),!P&&(null==a||-1===a||a<h.length-1)&&this._shouldEnterAsFirstChild(t,i)&&(P=h[0]),v>-1&&h.splice(v,1),P&&!this._dragDropRegistry.isDragging(P)){const L=P.getRootElement();L.parentElement.insertBefore(C,L),h.splice(a,0,n)}else this._element.appendChild(C),h.push(n);C.style.transform="",this._cacheItemPositions()}withItems(n){this._activeDraggables=n.slice(),this._cacheItemPositions()}withSortPredicate(n){this._sortPredicate=n}reset(){this._activeDraggables?.forEach(n=>{const t=n.getRootElement();if(t){const i=this._itemPositions.find(r=>r.drag===n)?.initialTransform;t.style.transform=i||""}}),this._itemPositions=[],this._activeDraggables=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1}getActiveItemsSnapshot(){return this._activeDraggables}getItemIndex(n){return("horizontal"===this.orientation&&"rtl"===this.direction?this._itemPositions.slice().reverse():this._itemPositions).findIndex(i=>i.drag===n)}updateOnScroll(n,t){this._itemPositions.forEach(({clientRect:i})=>{iT(i,n,t)}),this._itemPositions.forEach(({drag:i})=>{this._dragDropRegistry.isDragging(i)&&i._sortFromLastPointerPosition()})}withElementContainer(n){this._element=n}_cacheItemPositions(){const n="horizontal"===this.orientation;this._itemPositions=this._activeDraggables.map(t=>{const i=t.getVisibleElement();return{drag:t,offset:0,initialTransform:i.style.transform||"",clientRect:pF(i)}}).sort((t,i)=>n?t.clientRect.left-i.clientRect.left:t.clientRect.top-i.clientRect.top)}_getItemOffsetPx(n,t,i){const r="horizontal"===this.orientation;let a=r?t.left-n.left:t.top-n.top;return-1===i&&(a+=r?t.width-n.width:t.height-n.height),a}_getSiblingOffsetPx(n,t,i){const r="horizontal"===this.orientation,a=t[n].clientRect,h=t[n+-1*i];let v=a[r?"width":"height"]*i;if(h){const C=r?"left":"top",P=r?"right":"bottom";-1===i?v-=h.clientRect[C]-a[P]:v+=a[C]-h.clientRect[P]}return v}_shouldEnterAsFirstChild(n,t){if(!this._activeDraggables.length)return!1;const i=this._itemPositions,r="horizontal"===this.orientation;if(i[0].drag!==this._activeDraggables[0]){const h=i[i.length-1].clientRect;return r?n>=h.right:t>=h.bottom}{const h=i[0].clientRect;return r?n<=h.left:t<=h.top}}_getItemIndexFromPointerPosition(n,t,i,r){const a="horizontal"===this.orientation,h=this._itemPositions.findIndex(({drag:v,clientRect:C})=>v!==n&&((!r||v!==this._previousSwap.drag||!this._previousSwap.overlaps||(a?r.x:r.y)!==this._previousSwap.delta)&&(a?t>=Math.floor(C.left)&&t<Math.floor(C.right):i>=Math.floor(C.top)&&i<Math.floor(C.bottom))));return-1!==h&&this._sortPredicate(h,n)?h:-1}}class Ufe{_document;_dragDropRegistry;_element;_sortPredicate;_rootNode;_activeItems;_previousSwap={drag:null,deltaX:0,deltaY:0,overlaps:!1};_relatedNodes=[];constructor(n,t){this._document=n,this._dragDropRegistry=t}start(n){const t=this._element.childNodes;this._relatedNodes=[];for(let i=0;i<t.length;i++){const r=t[i];this._relatedNodes.push([r,r.nextSibling])}this.withItems(n)}sort(n,t,i,r){const a=this._getItemIndexFromPointerPosition(n,t,i),h=this._previousSwap;if(-1===a||this._activeItems[a]===n)return null;const v=this._activeItems[a];if(h.drag===v&&h.overlaps&&h.deltaX===r.x&&h.deltaY===r.y)return null;const C=this.getItemIndex(n),P=n.getPlaceholderElement(),L=v.getRootElement();a>C?L.after(P):L.before(P),yF(this._activeItems,C,a);const V=this._getRootNode().elementFromPoint(t,i);return h.deltaX=r.x,h.deltaY=r.y,h.drag=v,h.overlaps=L===V||L.contains(V),{previousIndex:C,currentIndex:a}}enter(n,t,i,r){let a=null==r||r<0?this._getItemIndexFromPointerPosition(n,t,i):r;-1===a&&(a=this._getClosestItemIndexToPointer(n,t,i));const h=this._activeItems[a],v=this._activeItems.indexOf(n);v>-1&&this._activeItems.splice(v,1),h&&!this._dragDropRegistry.isDragging(h)?(this._activeItems.splice(a,0,n),h.getRootElement().before(n.getPlaceholderElement())):(this._activeItems.push(n),this._element.appendChild(n.getPlaceholderElement()))}withItems(n){this._activeItems=n.slice()}withSortPredicate(n){this._sortPredicate=n}reset(){const n=this._element,t=this._previousSwap;for(let i=this._relatedNodes.length-1;i>-1;i--){const[r,a]=this._relatedNodes[i];r.parentNode===n&&r.nextSibling!==a&&(null===a?n.appendChild(r):a.parentNode===n&&n.insertBefore(r,a))}this._relatedNodes=[],this._activeItems=[],t.drag=null,t.deltaX=t.deltaY=0,t.overlaps=!1}getActiveItemsSnapshot(){return this._activeItems}getItemIndex(n){return this._activeItems.indexOf(n)}updateOnScroll(){this._activeItems.forEach(n=>{this._dragDropRegistry.isDragging(n)&&n._sortFromLastPointerPosition()})}withElementContainer(n){n!==this._element&&(this._element=n,this._rootNode=void 0)}_getItemIndexFromPointerPosition(n,t,i){const r=this._getRootNode().elementFromPoint(Math.floor(t),Math.floor(i)),a=r?this._activeItems.findIndex(h=>{const v=h.getRootElement();return r===v||v.contains(r)}):-1;return-1!==a&&this._sortPredicate(a,n)?a:-1}_getRootNode(){return this._rootNode||(this._rootNode=kD(this._element)||this._document),this._rootNode}_getClosestItemIndexToPointer(n,t,i){if(0===this._activeItems.length)return-1;if(1===this._activeItems.length)return 0;let r=1/0,a=-1;for(let h=0;h<this._activeItems.length;h++){const v=this._activeItems[h];if(v!==n){const{x:C,y:P}=v.getRootElement().getBoundingClientRect(),L=Math.hypot(t-C,i-P);L<r&&(r=L,a=h)}}return a}}var pu=function(e){return e[e.NONE=0]="NONE",e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e}(pu||{}),nc=function(e){return e[e.NONE=0]="NONE",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e}(nc||{});class jfe{_dragDropRegistry;_ngZone;_viewportRuler;element;disabled=!1;sortingDisabled=!1;lockAxis;autoScrollDisabled=!1;autoScrollStep=2;enterPredicate=()=>!0;sortPredicate=()=>!0;beforeStarted=new Ie;entered=new Ie;exited=new Ie;dropped=new Ie;sorted=new Ie;receivingStarted=new Ie;receivingStopped=new Ie;data;_container;_isDragging=!1;_parentPositions;_sortStrategy;_domRect;_draggables=[];_siblings=[];_activeSiblings=new Set;_viewportScrollSubscription=Ni.EMPTY;_verticalScrollDirection=pu.NONE;_horizontalScrollDirection=nc.NONE;_scrollNode;_stopScrollTimers=new Ie;_cachedShadowRoot=null;_document;_scrollableElements=[];_initialScrollSnap;_direction="ltr";constructor(n,t,i,r,a){this._dragDropRegistry=t,this._ngZone=r,this._viewportRuler=a;const h=this.element=xl(n);this._document=i,this.withOrientation("vertical").withElementContainer(h),t.registerDropContainer(this),this._parentPositions=new D8(i)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this.receivingStarted.complete(),this.receivingStopped.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(n,t,i,r){this._draggingStarted(),null==r&&this.sortingDisabled&&(r=this._draggables.indexOf(n)),this._sortStrategy.enter(n,t,i,r),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:n,container:this,currentIndex:this.getItemIndex(n)})}exit(n){this._reset(),this.exited.next({item:n,container:this})}drop(n,t,i,r,a,h,v,C={}){this._reset(),this.dropped.next({item:n,currentIndex:t,previousIndex:i,container:this,previousContainer:r,isPointerOverContainer:a,distance:h,dropPoint:v,event:C})}withItems(n){const t=this._draggables;return this._draggables=n,n.forEach(i=>i._withDropContainer(this)),this.isDragging()&&(t.filter(r=>r.isDragging()).every(r=>-1===n.indexOf(r))?this._reset():this._sortStrategy.withItems(this._draggables)),this}withDirection(n){return this._direction=n,this._sortStrategy instanceof B8&&(this._sortStrategy.direction=n),this}connectedTo(n){return this._siblings=n.slice(),this}withOrientation(n){if("mixed"===n)this._sortStrategy=new Ufe(this._document,this._dragDropRegistry);else{const t=new B8(this._dragDropRegistry);t.direction=this._direction,t.orientation=n,this._sortStrategy=t}return this._sortStrategy.withElementContainer(this._container),this._sortStrategy.withSortPredicate((t,i)=>this.sortPredicate(t,i,this)),this}withScrollableParents(n){const t=this._container;return this._scrollableElements=-1===n.indexOf(t)?[t,...n]:n.slice(),this}withElementContainer(n){if(n===this._container)return this;xl(this.element);const i=this._scrollableElements.indexOf(this._container),r=this._scrollableElements.indexOf(n);return i>-1&&this._scrollableElements.splice(i,1),r>-1&&this._scrollableElements.splice(r,1),this._sortStrategy&&this._sortStrategy.withElementContainer(n),this._cachedShadowRoot=null,this._scrollableElements.unshift(n),this._container=n,this}getScrollableParents(){return this._scrollableElements}getItemIndex(n){return this._isDragging?this._sortStrategy.getItemIndex(n):this._draggables.indexOf(n)}isReceiving(){return this._activeSiblings.size>0}_sortItem(n,t,i,r){if(this.sortingDisabled||!this._domRect||!E8(this._domRect,.05,t,i))return;const a=this._sortStrategy.sort(n,t,i,r);a&&this.sorted.next({previousIndex:a.previousIndex,currentIndex:a.currentIndex,container:this,item:n})}_startScrollingIfNecessary(n,t){if(this.autoScrollDisabled)return;let i,r=pu.NONE,a=nc.NONE;if(this._parentPositions.positions.forEach((h,v)=>{v===this._document||!h.clientRect||i||E8(h.clientRect,.05,n,t)&&([r,a]=function Hfe(e,n,t,i,r){const a=j8(n,r),h=H8(n,i);let v=pu.NONE,C=nc.NONE;if(a){const P=e.scrollTop;a===pu.UP?P>0&&(v=pu.UP):e.scrollHeight-P>e.clientHeight&&(v=pu.DOWN)}if(h){const P=e.scrollLeft;"rtl"===t?h===nc.RIGHT?P<0&&(C=nc.RIGHT):e.scrollWidth+P>e.clientWidth&&(C=nc.LEFT):h===nc.LEFT?P>0&&(C=nc.LEFT):e.scrollWidth-P>e.clientWidth&&(C=nc.RIGHT)}return[v,C]}(v,h.clientRect,this._direction,n,t),(r||a)&&(i=v))}),!r&&!a){const{width:h,height:v}=this._viewportRuler.getViewportSize(),C={width:h,height:v,top:0,right:h,bottom:v,left:0};r=j8(C,t),a=H8(C,n),i=window}i&&(r!==this._verticalScrollDirection||a!==this._horizontalScrollDirection||i!==this._scrollNode)&&(this._verticalScrollDirection=r,this._horizontalScrollDirection=a,this._scrollNode=i,(r||a)&&i?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const n=this._container.style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=n.msScrollSnapType||n.scrollSnapType||"",n.scrollSnapType=n.msScrollSnapType="none",this._sortStrategy.start(this._draggables),this._cacheParentPositions(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){this._parentPositions.cache(this._scrollableElements),this._domRect=this._parentPositions.positions.get(this._container).clientRect}_reset(){this._isDragging=!1;const n=this._container.style;n.scrollSnapType=n.msScrollSnapType=this._initialScrollSnap,this._siblings.forEach(t=>t._stopReceiving(this)),this._sortStrategy.reset(),this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_startScrollInterval=()=>{this._stopScrolling(),fF(0,y6).pipe(Er(this._stopScrollTimers)).subscribe(()=>{const n=this._scrollNode,t=this.autoScrollStep;this._verticalScrollDirection===pu.UP?n.scrollBy(0,-t):this._verticalScrollDirection===pu.DOWN&&n.scrollBy(0,t),this._horizontalScrollDirection===nc.LEFT?n.scrollBy(-t,0):this._horizontalScrollDirection===nc.RIGHT&&n.scrollBy(t,0)})};_isOverContainer(n,t){return null!=this._domRect&&mF(this._domRect,n,t)}_getSiblingContainerFromPosition(n,t,i){return this._siblings.find(r=>r._canReceive(n,t,i))}_canReceive(n,t,i){if(!this._domRect||!mF(this._domRect,t,i)||!this.enterPredicate(n,this))return!1;const r=this._getShadowRoot().elementFromPoint(t,i);return!!r&&(r===this._container||this._container.contains(r))}_startReceiving(n,t){const i=this._activeSiblings;!i.has(n)&&t.every(r=>this.enterPredicate(r,this)||this._draggables.indexOf(r)>-1)&&(i.add(n),this._cacheParentPositions(),this._listenToScrollEvents(),this.receivingStarted.next({initiator:n,receiver:this,items:t}))}_stopReceiving(n){this._activeSiblings.delete(n),this._viewportScrollSubscription.unsubscribe(),this.receivingStopped.next({initiator:n,receiver:this})}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(n=>{if(this.isDragging()){const t=this._parentPositions.handleScroll(n);t&&this._sortStrategy.updateOnScroll(t.top,t.left)}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const n=kD(this._container);this._cachedShadowRoot=n||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const n=this._sortStrategy.getActiveItemsSnapshot().filter(t=>t.isDragging());this._siblings.forEach(t=>t._startReceiving(this,n))}}function j8(e,n){const{top:t,bottom:i,height:r}=e,a=.05*r;return n>=t-a&&n<=t+a?pu.UP:n>=i-a&&n<=i+a?pu.DOWN:pu.NONE}function H8(e,n){const{left:t,right:i,width:r}=e,a=.05*r;return n>=t-a&&n<=t+a?nc.LEFT:n>=i-a&&n<=i+a?nc.RIGHT:nc.NONE}const xI=cu({passive:!1,capture:!0});let $fe=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275cmp=Ln({type:e,selectors:[["ng-component"]],hostAttrs:["cdk-drag-resets-container",""],decls:0,vars:0,template:function(i,r){},styles:["@layer cdk-resets{.cdk-drag-preview{background:none;border:none;padding:0;color:inherit;inset:auto}}.cdk-drag-placeholder *,.cdk-drag-preview *{pointer-events:none !important}"],encapsulation:2,changeDetection:0})}return e})(),vF=(()=>{class e{_ngZone=re(Ht);_document=re(ir);_styleLoader=re(Oc);_dropInstances=new Set;_dragInstances=new Set;_activeDragInstances=ha([]);_globalListeners=new Map;_draggingPredicate=t=>t.isDragging();_domNodesToDirectives=null;pointerMove=new Ie;pointerUp=new Ie;scroll=new Ie;constructor(){}registerDropContainer(t){this._dropInstances.has(t)||this._dropInstances.add(t)}registerDragItem(t){this._dragInstances.add(t),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,xI)})}removeDropContainer(t){this._dropInstances.delete(t)}removeDragItem(t){this._dragInstances.delete(t),this.stopDragging(t),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,xI)}startDragging(t,i){if(!(this._activeDragInstances().indexOf(t)>-1)&&(this._styleLoader.load($fe),this._activeDragInstances.update(r=>[...r,t]),1===this._activeDragInstances().length)){const r=i.type.startsWith("touch"),a={handler:h=>this.pointerUp.next(h),options:!0};r?(this._globalListeners.set("touchend",a),this._globalListeners.set("touchcancel",a)):this._globalListeners.set("mouseup",a),this._globalListeners.set("scroll",{handler:h=>this.scroll.next(h),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:xI}),r||this._globalListeners.set("mousemove",{handler:h=>this.pointerMove.next(h),options:xI}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((h,v)=>{this._document.addEventListener(v,h.handler,h.options)})})}}stopDragging(t){this._activeDragInstances.update(i=>{const r=i.indexOf(t);return r>-1?(i.splice(r,1),[...i]):i}),0===this._activeDragInstances().length&&this._clearGlobalListeners()}isDragging(t){return this._activeDragInstances().indexOf(t)>-1}scrolled(t){const i=[this.scroll];return t&&t!==this._document&&i.push(new Ce(r=>this._ngZone.runOutsideAngular(()=>{const h=v=>{this._activeDragInstances().length&&r.next(v)};return t.addEventListener("scroll",h,!0),()=>{t.removeEventListener("scroll",h,!0)}}))),Cl(...i)}registerDirectiveNode(t,i){this._domNodesToDirectives??=new WeakMap,this._domNodesToDirectives.set(t,i)}removeDirectiveNode(t){this._domNodesToDirectives?.delete(t)}getDragDirectiveForNode(t){return this._domNodesToDirectives?.get(t)||null}ngOnDestroy(){this._dragInstances.forEach(t=>this.removeDragItem(t)),this._dropInstances.forEach(t=>this.removeDropContainer(t)),this._domNodesToDirectives=null,this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_preventDefaultWhileDragging=t=>{this._activeDragInstances().length>0&&t.preventDefault()};_persistentTouchmoveListener=t=>{this._activeDragInstances().length>0&&(this._activeDragInstances().some(this._draggingPredicate)&&t.preventDefault(),this.pointerMove.next(t))};_clearGlobalListeners(){this._globalListeners.forEach((t,i)=>{this._document.removeEventListener(i,t.handler,t.options)}),this._globalListeners.clear()}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Gfe={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let bF=(()=>{class e{_document=re(ir);_ngZone=re(Ht);_viewportRuler=re(QC);_dragDropRegistry=re(vF);_renderer=re(ua).createRenderer(null,null);constructor(){}createDrag(t,i=Gfe){return new Vfe(t,i,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry,this._renderer)}createDropList(t){return new jfe(t,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}static \u0275fac=function(i){return new(i||e)};static \u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const sT=new ct("CDK_DRAG_PARENT"),$8=new ct("CdkDragHandle"),G8=new ct("CDK_DRAG_CONFIG"),q8=new ct("CdkDropList");let W8=(()=>{class e{element=re(In);dropContainer=re(q8,{optional:!0,skipSelf:!0});_ngZone=re(Ht);_viewContainerRef=re(ms);_dir=re(Om,{optional:!0});_changeDetectorRef=re(Bo);_selfHandle=re($8,{optional:!0,self:!0});_parentDrag=re(sT,{optional:!0,skipSelf:!0});_dragDropRegistry=re(vF);_destroyed=new Ie;_handles=new Je([]);_previewTemplate;_placeholderTemplate;_dragRef;data;lockAxis;rootElementSelector;boundaryElement;dragStartDelay;freeDragPosition;get disabled(){return this._disabled||!(!this.dropContainer||!this.dropContainer.disabled)}set disabled(t){this._disabled=t,this._dragRef.disabled=this._disabled}_disabled;constrainPosition;previewClass;previewContainer;scale=1;started=new Dt;released=new Dt;ended=new Dt;entered=new Dt;exited=new Dt;dropped=new Dt;moved=new Ce(t=>{const i=this._dragRef.moved.pipe($t(r=>({source:this,pointerPosition:r.pointerPosition,event:r.event,delta:r.delta,distance:r.distance}))).subscribe(t);return()=>{i.unsubscribe()}});_injector=re(Ye);constructor(){const t=this.dropContainer,i=re(G8,{optional:!0}),r=re(bF);this._dragRef=r.createDrag(this.element,{dragStartThreshold:i&&null!=i.dragStartThreshold?i.dragStartThreshold:5,pointerDirectionChangeThreshold:i&&null!=i.pointerDirectionChangeThreshold?i.pointerDirectionChangeThreshold:5,zIndex:i?.zIndex}),this._dragRef.data=this,this._dragDropRegistry.registerDirectiveNode(this.element.nativeElement,this),i&&this._assignDefaults(i),t&&(this._dragRef._withDropContainer(t._dropListRef),t.addItem(this),t._dropListRef.beforeStarted.pipe(Er(this._destroyed)).subscribe(()=>{this._dragRef.scale=this.scale})),this._syncInputs(this._dragRef),this._handleEvents(this._dragRef)}getPlaceholderElement(){return this._dragRef.getPlaceholderElement()}getRootElement(){return this._dragRef.getRootElement()}reset(){this._dragRef.reset()}getFreeDragPosition(){return this._dragRef.getFreeDragPosition()}setFreeDragPosition(t){this._dragRef.setFreeDragPosition(t)}ngAfterViewInit(){Tc(()=>{this._updateRootElement(),this._setupHandlesListener(),this._dragRef.scale=this.scale,this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)},{injector:this._injector})}ngOnChanges(t){const i=t.rootElementSelector,r=t.freeDragPosition;i&&!i.firstChange&&this._updateRootElement(),this._dragRef.scale=this.scale,r&&!r.firstChange&&this.freeDragPosition&&this._dragRef.setFreeDragPosition(this.freeDragPosition)}ngOnDestroy(){this.dropContainer&&this.dropContainer.removeItem(this),this._dragDropRegistry.removeDirectiveNode(this.element.nativeElement),this._ngZone.runOutsideAngular(()=>{this._handles.complete(),this._destroyed.next(),this._destroyed.complete(),this._dragRef.dispose()})}_addHandle(t){const i=this._handles.getValue();i.push(t),this._handles.next(i)}_removeHandle(t){const i=this._handles.getValue(),r=i.indexOf(t);r>-1&&(i.splice(r,1),this._handles.next(i))}_setPreviewTemplate(t){this._previewTemplate=t}_resetPreviewTemplate(t){t===this._previewTemplate&&(this._previewTemplate=null)}_setPlaceholderTemplate(t){this._placeholderTemplate=t}_resetPlaceholderTemplate(t){t===this._placeholderTemplate&&(this._placeholderTemplate=null)}_updateRootElement(){const t=this.element.nativeElement;let i=t;this.rootElementSelector&&(i=void 0!==t.closest?t.closest(this.rootElementSelector):t.parentElement?.closest(this.rootElementSelector)),this._dragRef.withRootElement(i||t)}_getBoundaryElement(){const t=this.boundaryElement;return t?"string"==typeof t?this.element.nativeElement.closest(t):xl(t):null}_syncInputs(t){t.beforeStarted.subscribe(()=>{if(!t.isDragging()){const i=this._dir,r=this.dragStartDelay,a=this._placeholderTemplate?{template:this._placeholderTemplate.templateRef,context:this._placeholderTemplate.data,viewContainer:this._viewContainerRef}:null,h=this._previewTemplate?{template:this._previewTemplate.templateRef,context:this._previewTemplate.data,matchSize:this._previewTemplate.matchSize,viewContainer:this._viewContainerRef}:null;t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.scale=this.scale,t.dragStartDelay="object"==typeof r&&r?r:Ox(r),t.constrainPosition=this.constrainPosition,t.previewClass=this.previewClass,t.withBoundaryElement(this._getBoundaryElement()).withPlaceholderTemplate(a).withPreviewTemplate(h).withPreviewContainer(this.previewContainer||"global"),i&&t.withDirection(i.value)}}),t.beforeStarted.pipe(Ac(1)).subscribe(()=>{if(this._parentDrag)return void t.withParent(this._parentDrag._dragRef);let i=this.element.nativeElement.parentElement;for(;i;){const r=this._dragDropRegistry.getDragDirectiveForNode(i);if(r){t.withParent(r._dragRef);break}i=i.parentElement}})}_handleEvents(t){t.started.subscribe(i=>{this.started.emit({source:this,event:i.event}),this._changeDetectorRef.markForCheck()}),t.released.subscribe(i=>{this.released.emit({source:this,event:i.event})}),t.ended.subscribe(i=>{this.ended.emit({source:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:i.container.data,item:this,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:i.container.data,item:this})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,isPointerOverContainer:i.isPointerOverContainer,item:this,distance:i.distance,dropPoint:i.dropPoint,event:i.event})})}_assignDefaults(t){const{lockAxis:i,dragStartDelay:r,constrainPosition:a,previewClass:h,boundaryElement:v,draggingDisabled:C,rootElementSelector:P,previewContainer:L}=t;this.disabled=C??!1,this.dragStartDelay=r||0,i&&(this.lockAxis=i),a&&(this.constrainPosition=a),h&&(this.previewClass=h),v&&(this.boundaryElement=v),P&&(this.rootElementSelector=P),L&&(this.previewContainer=L)}_setupHandlesListener(){this._handles.pipe(Vo(t=>{const i=t.map(r=>r.element);this._selfHandle&&this.rootElementSelector&&i.push(this.element),this._dragRef.withHandles(i)}),Aa(t=>Cl(...t.map(i=>i._stateChanges.pipe(Ch(i))))),Er(this._destroyed)).subscribe(t=>{const i=this._dragRef,r=t.element.nativeElement;t.disabled?i.disableHandle(r):i.enableHandle(r)})}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkDrag",""]],hostAttrs:[1,"cdk-drag"],hostVars:4,hostBindings:function(i,r){2&i&&Ti("cdk-drag-disabled",r.disabled)("cdk-drag-dragging",r._dragRef.isDragging())},inputs:{data:[0,"cdkDragData","data"],lockAxis:[0,"cdkDragLockAxis","lockAxis"],rootElementSelector:[0,"cdkDragRootElement","rootElementSelector"],boundaryElement:[0,"cdkDragBoundary","boundaryElement"],dragStartDelay:[0,"cdkDragStartDelay","dragStartDelay"],freeDragPosition:[0,"cdkDragFreeDragPosition","freeDragPosition"],disabled:[2,"cdkDragDisabled","disabled",zn],constrainPosition:[0,"cdkDragConstrainPosition","constrainPosition"],previewClass:[0,"cdkDragPreviewClass","previewClass"],previewContainer:[0,"cdkDragPreviewContainer","previewContainer"],scale:[2,"cdkDragScale","scale",Ya]},outputs:{started:"cdkDragStarted",released:"cdkDragReleased",ended:"cdkDragEnded",entered:"cdkDragEntered",exited:"cdkDragExited",dropped:"cdkDragDropped",moved:"cdkDragMoved"},exportAs:["cdkDrag"],features:[Jn([{provide:sT,useExisting:e}]),jr,sr]})}return e})();const xF=new ct("CdkDropListGroup");let Z8=(()=>{class e{element=re(In);_changeDetectorRef=re(Bo);_scrollDispatcher=re(BO);_dir=re(Om,{optional:!0});_group=re(xF,{optional:!0,skipSelf:!0});_destroyed=new Ie;_scrollableParentsResolved;static _dropLists=[];_dropListRef;connectedTo=[];data;orientation;id=re(du).getId("cdk-drop-list-");lockAxis;get disabled(){return this._disabled||!!this._group&&this._group.disabled}set disabled(t){this._dropListRef.disabled=this._disabled=t}_disabled;sortingDisabled;enterPredicate=()=>!0;sortPredicate=()=>!0;autoScrollDisabled;autoScrollStep;elementContainerSelector;dropped=new Dt;entered=new Dt;exited=new Dt;sorted=new Dt;_unsortedItems=new Set;constructor(){const t=re(bF),i=re(G8,{optional:!0});this._dropListRef=t.createDropList(this.element),this._dropListRef.data=this,i&&this._assignDefaults(i),this._dropListRef.enterPredicate=(r,a)=>this.enterPredicate(r.data,a.data),this._dropListRef.sortPredicate=(r,a,h)=>this.sortPredicate(r,a.data,h.data),this._setupInputSyncSubscription(this._dropListRef),this._handleEvents(this._dropListRef),e._dropLists.push(this),this._group&&this._group._items.add(this)}addItem(t){this._unsortedItems.add(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}removeItem(t){this._unsortedItems.delete(t),this._dropListRef.isDragging()&&this._syncItemsWithRef()}getSortedItems(){return Array.from(this._unsortedItems).sort((t,i)=>t._dragRef.getVisibleElement().compareDocumentPosition(i._dragRef.getVisibleElement())&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)}ngOnDestroy(){const t=e._dropLists.indexOf(this);t>-1&&e._dropLists.splice(t,1),this._group&&this._group._items.delete(this),this._unsortedItems.clear(),this._dropListRef.dispose(),this._destroyed.next(),this._destroyed.complete()}_setupInputSyncSubscription(t){this._dir&&this._dir.change.pipe(Ch(this._dir.value),Er(this._destroyed)).subscribe(i=>t.withDirection(i)),t.beforeStarted.subscribe(()=>{const i=jC(this.connectedTo).map(r=>"string"==typeof r?e._dropLists.find(h=>h.id===r):r);if(this._group&&this._group._items.forEach(r=>{-1===i.indexOf(r)&&i.push(r)}),!this._scrollableParentsResolved){const r=this._scrollDispatcher.getAncestorScrollContainers(this.element).map(a=>a.getElementRef().nativeElement);this._dropListRef.withScrollableParents(r),this._scrollableParentsResolved=!0}if(this.elementContainerSelector){const r=this.element.nativeElement.querySelector(this.elementContainerSelector);t.withElementContainer(r)}t.disabled=this.disabled,t.lockAxis=this.lockAxis,t.sortingDisabled=this.sortingDisabled,t.autoScrollDisabled=this.autoScrollDisabled,t.autoScrollStep=Ox(this.autoScrollStep,2),t.connectedTo(i.filter(r=>r&&r!==this).map(r=>r._dropListRef)).withOrientation(this.orientation)})}_handleEvents(t){t.beforeStarted.subscribe(()=>{this._syncItemsWithRef(),this._changeDetectorRef.markForCheck()}),t.entered.subscribe(i=>{this.entered.emit({container:this,item:i.item.data,currentIndex:i.currentIndex})}),t.exited.subscribe(i=>{this.exited.emit({container:this,item:i.item.data}),this._changeDetectorRef.markForCheck()}),t.sorted.subscribe(i=>{this.sorted.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,container:this,item:i.item.data})}),t.dropped.subscribe(i=>{this.dropped.emit({previousIndex:i.previousIndex,currentIndex:i.currentIndex,previousContainer:i.previousContainer.data,container:i.container.data,item:i.item.data,isPointerOverContainer:i.isPointerOverContainer,distance:i.distance,dropPoint:i.dropPoint,event:i.event}),this._changeDetectorRef.markForCheck()}),Cl(t.receivingStarted,t.receivingStopped).subscribe(()=>this._changeDetectorRef.markForCheck())}_assignDefaults(t){const{lockAxis:i,draggingDisabled:r,sortingDisabled:a,listAutoScrollDisabled:h,listOrientation:v}=t;this.disabled=r??!1,this.sortingDisabled=a??!1,this.autoScrollDisabled=h??!1,this.orientation=v||"vertical",i&&(this.lockAxis=i)}_syncItemsWithRef(){this._dropListRef.withItems(this.getSortedItems().map(t=>t._dragRef))}static \u0275fac=function(i){return new(i||e)};static \u0275dir=Bt({type:e,selectors:[["","cdkDropList",""],["cdk-drop-list"]],hostAttrs:[1,"cdk-drop-list"],hostVars:7,hostBindings:function(i,r){2&i&&(ui("id",r.id),Ti("cdk-drop-list-disabled",r.disabled)("cdk-drop-list-dragging",r._dropListRef.isDragging())("cdk-drop-list-receiving",r._dropListRef.isReceiving()))},inputs:{connectedTo:[0,"cdkDropListConnectedTo","connectedTo"],data:[0,"cdkDropListData","data"],orientation:[0,"cdkDropListOrientation","orientation"],id:"id",lockAxis:[0,"cdkDropListLockAxis","lockAxis"],disabled:[2,"cdkDropListDisabled","disabled",zn],sortingDisabled:[2,"cdkDropListSortingDisabled","sortingDisabled",zn],enterPredicate:[0,"cdkDropListEnterPredicate","enterPredicate"],sortPredicate:[0,"cdkDropListSortPredicate","sortPredicate"],autoScrollDisabled:[2,"cdkDropListAutoScrollDisabled","autoScrollDisabled",zn],autoScrollStep:[0,"cdkDropListAutoScrollStep","autoScrollStep"],elementContainerSelector:[0,"cdkDropListElementContainer","elementContainerSelector"]},outputs:{dropped:"cdkDropListDropped",entered:"cdkDropListEntered",exited:"cdkDropListExited",sorted:"cdkDropListSorted"},exportAs:["cdkDropList"],features:[Jn([{provide:xF,useValue:void 0},{provide:q8,useExisting:e}]),jr]})}return e})(),wF=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=ci({type:e});static \u0275inj=Qt({providers:[bF],imports:[O_]})}return e})(),Sh=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({imports:[EO,PH,NH,$H,n6,f6,N6,G6,q6,Z6,o8,s8,a8,qO,c8,m8,v8,w8,wF,EO,PH,NH,$H,n6,f6,N6,G6,q6,Z6,o8,s8,a8,qO,c8,m8,v8,w8,wF]})}return e})();const Kfe=e=>({"animation-delay":e});function Qfe(e,n){if(1&e&&(Fe(0,"div",10),gt(1),Ue()),2&e){const t=n.$implicit;At("ngStyle",xm(2,Kfe,.5*n.index+"s")),Ze(),Sr(" ",t," ")}}let Y8=(()=>{class e{constructor(){this.items=["Architect","Developer","Designer"]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-landing"]],standalone:!1,decls:27,vars:1,consts:[[1,"landing-page"],[1,"highlight-section"],[1,"title"],[1,"word"],[1,"sparkle"],[1,"sparkle-1"],[1,"sparkle-2"],[1,"sparkle-3"],[1,"animated-section"],["class","animated-item",3,"ngStyle",4,"ngFor","ngForOf"],[1,"animated-item",3,"ngStyle"]],template:function(i,r){1&i&&(Fe(0,"mat-card",0)(1,"mat-card-header")(2,"div",1)(3,"h1",2)(4,"span",3),gt(5,"Jeffrey "),Fe(6,"span",4),gt(7,"\u2728"),Ue(),Fe(8,"span",5),gt(9,"\u2728"),Ue(),Fe(10,"span",6),gt(11,"\u2728"),Ue(),Fe(12,"span",7),gt(13,"\u2728"),Ue()(),Fe(14,"span",3),gt(15,"Sanford "),Fe(16,"span",4),gt(17,"\u2728"),Ue(),Fe(18,"span",5),gt(19,"\u2728"),Ue(),Fe(20,"span",6),gt(21,"\u2728"),Ue(),Fe(22,"span",7),gt(23,"\u2728"),Ue()()()()(),Fe(24,"mat-card-content")(25,"div",8),an(26,Qfe,2,4,"div",9),Ue()()()),2&i&&(Ze(26),At("ngForOf",r.items))},dependencies:[md,DV,hu,R_,WC],styles:[".landing-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;flex:1;padding:2em;background-color:#0000004d;width:100%;height:80vh;overflow:visible;animation:_ngcontent-%COMP%_backgroundAnimation 10s infinite alternate;border-radius:.25em}.landing-page[_ngcontent-%COMP%]   .landing-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;max-width:75em;text-align:center;background-color:#ff00004d;animation:_ngcontent-%COMP%_fadeIn 2s ease-out forwards}.landing-page[_ngcontent-%COMP%]   .highlight-section[_ngcontent-%COMP%]{font-size:1.5vw;position:relative;margin-bottom:3em;animation:_ngcontent-%COMP%_fadeIn 2s ease-out forwards}.landing-page[_ngcontent-%COMP%]   .animated-section[_ngcontent-%COMP%]{font-size:2vw;display:flex;justify-content:center;gap:1.5em;animation:_ngcontent-%COMP%_fadeIn 2s ease-out forwards}.landing-page[_ngcontent-%COMP%]   .animated-section[_ngcontent-%COMP%]   .animated-item[_ngcontent-%COMP%]{font-size:1em;color:gold;opacity:0;transform:translateY(2em);animation:_ngcontent-%COMP%_fadeInUp 2s ease-out forwards}.landing-page[_ngcontent-%COMP%]   .animated-section[_ngcontent-%COMP%]   .animated-item[_ngcontent-%COMP%]:nth-child(1){animation-delay:0s}.landing-page[_ngcontent-%COMP%]   .animated-section[_ngcontent-%COMP%]   .animated-item[_ngcontent-%COMP%]:nth-child(2){animation-delay:.5s}.landing-page[_ngcontent-%COMP%]   .animated-section[_ngcontent-%COMP%]   .animated-item[_ngcontent-%COMP%]:nth-child(3){animation-delay:1s}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:400%;color:red;text-align:center;position:relative;display:flex;justify-content:center;gap:.5em;animation:_ngcontent-%COMP%_textShadow 3s infinite alternate}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]{position:relative;animation:_ngcontent-%COMP%_colorChange 3s ease-out forwards}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(1){animation-delay:0s}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(2){animation-delay:2s}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(3){animation-delay:4s}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%], .landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle-1[_ngcontent-%COMP%], .landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle-2[_ngcontent-%COMP%], .landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle-3[_ngcontent-%COMP%]{position:absolute;font-size:.025em;top:-.5em;right:-1em;font-size:0em;opacity:1}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%]{color:gold;animation:_ngcontent-%COMP%_sparkle .5s ease-out 5s forwards}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle-1[_ngcontent-%COMP%]{color:orange;animation:_ngcontent-%COMP%_sparkle-1 .4s ease-out 5s forwards}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle-2[_ngcontent-%COMP%]{color:green;animation:_ngcontent-%COMP%_sparkle-2 .3s ease-out 5s forwards}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .sparkle-3[_ngcontent-%COMP%]{color:purple;animation:_ngcontent-%COMP%_sparkle-3 .6s ease-out 5s forwards}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(1)   .sparkle[_ngcontent-%COMP%]{animation-delay:3s}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(2)   .sparkle[_ngcontent-%COMP%]{margin-top:-1.5em;animation-delay:5s}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(1)   .sparkle-1[_ngcontent-%COMP%]{animation-delay:3s;color:red}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(2)   .sparkle-2[_ngcontent-%COMP%]{color:#00f;margin-top:-1.5em;animation-delay:5s}.landing-page[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]:nth-child(3)   .sparkle-3[_ngcontent-%COMP%]{color:violet;margin-top:-2em;animation-delay:7s}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(1.25em)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_sparkle{0%{opacity:1;transform:translateY(-1.4em);font-size:.1em;color:#000}25%{opacity:.75;transform:translateY(-1.3em);font-size:.15em;color:#00f}50%{opacity:.25;transform:translateY(-1.2em);font-size:.2em;color:green}75%{opacity:.1;transform:translateY(-1.1em);font-size:.25em}to{opacity:0;transform:translate(-1em);font-size:.3em}}@keyframes _ngcontent-%COMP%_colorChange{0%{color:red}50%{color:orange;transform:scale(1.25)}to{color:gold;text-outline:red}}@keyframes _ngcontent-%COMP%_sparkle-1{0%{opacity:1;transform:translateY(-1.4em) translate(0);font-size:.1em}25%{opacity:.75;transform:translateY(-1.3em) translate(.5em);font-size:.15em}50%{opacity:.25;transform:translateY(-1.2em) translate(1em);font-size:.2em}75%{opacity:.1;transform:translateY(-1.1em) translate(1.5em);font-size:.25em}to{opacity:0;transform:translateY(-1em) translate(2em);font-size:.3em}}@keyframes _ngcontent-%COMP%_sparkle-2{0%{opacity:1;transform:translateY(-1.4em) translate(0);font-size:.1em}25%{opacity:.75;transform:translateY(-1.3em) translate(1em);font-size:.15em}50%{opacity:.25;transform:translateY(-1.2em) translate(2em);font-size:.2em}75%{opacity:.1;transform:translateY(-1.1em) translate(3em);font-size:.25em}to{opacity:0;transform:translateY(-1em) translate(4em);font-size:.3em}}@keyframes _ngcontent-%COMP%_sparkle-3{0%{opacity:1;transform:translateY(-1.4em) translate(0);font-size:.1em}25%{opacity:.75;transform:translateY(-1.3em) translate(1.5em);font-size:.15em}50%{opacity:.25;transform:translateY(-1.2em) translate(3em);font-size:.2em}75%{opacity:.1;transform:translateY(-1.1em) translate(4.5em);font-size:.25em}to{opacity:0;transform:translateY(-1em) translate(6em);font-size:.3em}}@keyframes _ngcontent-%COMP%_backgroundAnimation{0%{background-color:#0000004d}to{background-color:#00000080}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_textShadow{0%{text-shadow:0 0 10px gold}to{text-shadow:0 0 20px red;text-outline:.25em solid red}}@media (max-width: 900px){.title[_ngcontent-%COMP%]{font-size:200%;color:#00f;flex-direction:column;gap:.2em}.title[_ngcontent-%COMP%]   .word[_ngcontent-%COMP%]{font-size:1em}.title[_ngcontent-%COMP%]   .sparkle[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]   .sparkle-1[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]   .sparkle-2[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]   .sparkle-3[_ngcontent-%COMP%]{font-size:.15em}.landing-header[_ngcontent-%COMP%]{font-size:1.5em}.landing-content[_ngcontent-%COMP%]   .landing-description[_ngcontent-%COMP%]{font-size:1em}.landing-content[_ngcontent-%COMP%]   .landing-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.25em .5em;font-size:.75em}.animated-section[_ngcontent-%COMP%]   .animated-item[_ngcontent-%COMP%]{font-size:1em}}"]})}return e})(),Jfe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-peasant-kitchen"]],standalone:!1,decls:6,vars:0,consts:[[1,"container"],[1,"masthead"],["src","../../../assets/images/compressed/kitchen-table-site-logo.png","alt","Kitchen Table Logo",1,"site-logo"],["src","../../../assets/images/compressed/grape-masthead.png","alt","Grape Masthead",1,"grape-masthead"],[1,"content"]],template:function(i,r){1&i&&(Fe(0,"div",0)(1,"div",1),_n(2,"img",2)(3,"img",3),Ue(),Fe(4,"div",4),_n(5,"router-outlet"),Ue()())},dependencies:[nD],styles:[".container[_ngcontent-%COMP%]{position:relative;width:100%;height:80vh;padding:1em;display:flex;flex-direction:column;flex-grow:1;box-sizing:border-box;overflow:visible}.container[_ngcontent-%COMP%]   .masthead[_ngcontent-%COMP%]{position:relative}.container[_ngcontent-%COMP%]   .masthead[_ngcontent-%COMP%]   .site-logo[_ngcontent-%COMP%]{height:10em;width:auto;margin-right:1em}.container[_ngcontent-%COMP%]   .masthead[_ngcontent-%COMP%]   .grape-masthead[_ngcontent-%COMP%]{position:fixed;top:5em;right:1em;z-index:20;opacity:.3}.container[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin-top:5em;padding:1em;border:1px solid purple}@media (max-width: 900px){.landing[_ngcontent-%COMP%]{width:100vw;height:100vh;padding:1em}.site-logo[_ngcontent-%COMP%]{height:15vw}.grape-masthead[_ngcontent-%COMP%]{height:50vw;width:50vw}.content[_ngcontent-%COMP%]{margin-top:5em;padding:1em}}"]})}return e})();const epe=["videoPlayer"];let tpe=(()=>{class e{constructor(t){this.renderer=t}ngOnInit(){this.videoSrc="../../../assets/video/haynes-astronauts.mp4",this.audioSrc="../../../assets/video/haynes-astronauts.ogg"}ngAfterViewInit(){console.log("ngAfterViewInit called"),this.renderer.listen(this.videoPlayer.nativeElement,"canplay",()=>{console.log("canplay event triggered"),this.renderer.setProperty(this.videoPlayer.nativeElement,"muted",!1),this.renderer.setProperty(this.videoPlayer.nativeElement,"autoplay",!0),this.renderer.setProperty(this.videoPlayer.nativeElement,"controls",!0),this.videoPlayer.nativeElement.play().then(()=>{console.log("Video is playing")}).catch(t=>{console.error("Error playing video:",t)})}),this.renderer.setAttribute(this.videoPlayer.nativeElement,"src",this.videoSrc),this.renderer.setProperty(this.videoPlayer.nativeElement,"load",!0)}playVideo(){console.log("playVideo called"),this.renderer.setProperty(this.videoPlayer.nativeElement,"muted",!1),this.videoPlayer.nativeElement.play().then(()=>{console.log("Video is playing")}).catch(t=>{console.error("Error playing video:",t)})}pauseVideo(){console.log("pauseVideo called"),this.videoPlayer.nativeElement.pause()}stopVideo(){console.log("stopVideo called"),this.videoPlayer.nativeElement.pause(),this.renderer.setProperty(this.videoPlayer.nativeElement,"currentTime",0)}rewindVideo(){console.log("rewindVideo called"),this.renderer.setProperty(this.videoPlayer.nativeElement,"currentTime",this.videoPlayer.nativeElement.currentTime-10)}fastForwardVideo(){console.log("fastForwardVideo called"),this.renderer.setProperty(this.videoPlayer.nativeElement,"currentTime",this.videoPlayer.nativeElement.currentTime+10)}changeVolume(t){const i=t.target;console.log("changeVolume called, volume:",i.value),this.renderer.setProperty(this.videoPlayer.nativeElement,"volume",parseFloat(i.value))}seekVideo(t){const i=t.target;console.log("seekVideo called, seek position:",i.value),this.renderer.setProperty(this.videoPlayer.nativeElement,"currentTime",parseFloat(i.value)*this.videoPlayer.nativeElement.duration/100)}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(Ns))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-space-video"]],viewQuery:function(i,r){if(1&i&&zr(epe,7),2&i){let a;ri(a=oi())&&(r.videoPlayer=a.first)}},standalone:!1,decls:13,vars:5,consts:[["videoPlayer",""],["audioPlayer",""],[1,"page-container"],[1,"video-container"],["controls","","autoplay","",1,"player"],["type","video/mp4",3,"src"],["type","video/ogg",3,"src"],["type","video/webm",3,"src"],["controls","",1,"player"],["type","audio/mp3"],["type","audio/ogg"]],template:function(i,r){1&i&&(Fe(0,"div",2)(1,"mat-card",3)(2,"video",4,0),_n(4,"source",5)(5,"source",6)(6,"source",7),gt(7," Your browser does not support the video tag. Please try using a modern browser. "),Ue(),Fe(8,"audio",8,1),_n(10,"source",9)(11,"source",10),gt(12," Your browser does not support the audio tag. Please try using a modern browser. "),Ue()()()),2&i&&(Ze(4),At("src",r.videoSrc,eu),Ze(),At("src",r.videoSrc,eu),Ze(),At("src",r.videoSrc,eu),Ze(4),ui("src",r.audioSrc,eu),Ze(),ui("src",r.audioSrc,eu))},dependencies:[hu],styles:[".page-container[_ngcontent-%COMP%]{background-color:#000c;margin:0;width:100%;height:80vh;display:flex;justify-content:center;align-items:center}.video-container[_ngcontent-%COMP%]{width:90%;height:80%;margin:0 auto;display:flex;flex-direction:column;justify-content:center;align-items:center;background-color:#000c}.player[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}"]})}return e})();class CF extends Map{constructor(n,t=Q8){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=n)for(const[i,r]of n)this.set(i,r)}get(n){return super.get(TF(this,n))}has(n){return super.has(TF(this,n))}set(n,t){return super.set(function X8({_intern:e,_key:n},t){const i=n(t);return e.has(i)?e.get(i):(e.set(i,t),t)}(this,n),t)}delete(n){return super.delete(function K8({_intern:e,_key:n},t){const i=n(t);return e.has(i)&&(t=e.get(i),e.delete(i)),t}(this,n))}}function TF({_intern:e,_key:n},t){const i=n(t);return e.has(i)?e.get(i):t}function Q8(e){return null!==e&&"object"==typeof e?e.valueOf():e}function e$(e,n,...t){return function $x(e,n,t,i){return function r(a,h){if(h>=i.length)return t(a);const v=new CF,C=i[h++];let P=-1;for(const L of a){const V=C(L,++P,a),W=v.get(V);W?W.push(L):v.set(V,[L])}for(const[L,V]of v)v.set(L,r(V,h));return n(v)}(e,0)}(e,Array.from,n,t)}function wI(e,n){let t;if(void 0===n)for(const i of e)null!=i&&(t<i||void 0===t&&i>=i)&&(t=i);else{let i=-1;for(let r of e)null!=(r=n(r,++i,e))&&(t<r||void 0===t&&r>=r)&&(t=r)}return t}function n$(e,n){let t;if(void 0===n)for(const i of e)null!=i&&(t>i||void 0===t&&i>=i)&&(t=i);else{let i=-1;for(let r of e)null!=(r=n(r,++i,e))&&(t>r||void 0===t&&r>=r)&&(t=r)}return t}function ope(e){return e}function spe(e){return"translate("+e+",0)"}function ape(e){return"translate(0,"+e+")"}function lpe(e){return n=>+e(n)}function cpe(e,n){return n=Math.max(0,e.bandwidth()-2*n)/2,e.round()&&(n=Math.round(n)),t=>+e(t)+n}function dpe(){return!this.__axis}function MI(e,n){var t=[],i=null,r=null,a=6,h=6,v=3,C=typeof window<"u"&&window.devicePixelRatio>1?0:.5,P=1===e||4===e?-1:1,L=4===e||2===e?"x":"y",V=1===e||3===e?spe:ape;function W(X){var oe=i??(n.ticks?n.ticks.apply(n,t):n.domain()),he=r??(n.tickFormat?n.tickFormat.apply(n,t):ope),se=Math.max(a,0)+v,_e=n.range(),Se=+_e[0]+C,$e=+_e[_e.length-1]+C,et=(n.bandwidth?cpe:lpe)(n.copy(),C),ut=X.selection?X.selection():X,mt=ut.selectAll(".domain").data([null]),qt=ut.selectAll(".tick").data(oe,n).order(),tn=qt.exit(),Rn=qt.enter().append("g").attr("class","tick"),Pn=qt.select("line"),Kt=qt.select("text");mt=mt.merge(mt.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),qt=qt.merge(Rn),Pn=Pn.merge(Rn.append("line").attr("stroke","currentColor").attr(L+"2",P*a)),Kt=Kt.merge(Rn.append("text").attr("fill","currentColor").attr(L,P*se).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),X!==ut&&(mt=mt.transition(X),qt=qt.transition(X),Pn=Pn.transition(X),Kt=Kt.transition(X),tn=tn.transition(X).attr("opacity",1e-6).attr("transform",function(Mi){return isFinite(Mi=et(Mi))?V(Mi+C):this.getAttribute("transform")}),Rn.attr("opacity",1e-6).attr("transform",function(Mi){var Bn=this.parentNode.__axis;return V((Bn&&isFinite(Bn=Bn(Mi))?Bn:et(Mi))+C)})),tn.remove(),mt.attr("d",4===e||2===e?h?"M"+P*h+","+Se+"H"+C+"V"+$e+"H"+P*h:"M"+C+","+Se+"V"+$e:h?"M"+Se+","+P*h+"V"+C+"H"+$e+"V"+P*h:"M"+Se+","+C+"H"+$e),qt.attr("opacity",1).attr("transform",function(Mi){return V(et(Mi)+C)}),Pn.attr(L+"2",P*a),Kt.attr(L,P*se).text(he),ut.filter(dpe).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),ut.each(function(){this.__axis=et})}return W.scale=function(X){return arguments.length?(n=X,W):n},W.ticks=function(){return t=Array.from(arguments),W},W.tickArguments=function(X){return arguments.length?(t=null==X?[]:Array.from(X),W):t.slice()},W.tickValues=function(X){return arguments.length?(i=null==X?null:Array.from(X),W):i&&i.slice()},W.tickFormat=function(X){return arguments.length?(r=X,W):r},W.tickSize=function(X){return arguments.length?(a=h=+X,W):a},W.tickSizeInner=function(X){return arguments.length?(a=+X,W):a},W.tickSizeOuter=function(X){return arguments.length?(h=+X,W):h},W.tickPadding=function(X){return arguments.length?(v=+X,W):v},W.offset=function(X){return arguments.length?(C=+X,W):C},W}function SF(e){return MI(3,e)}function EF(e){return MI(4,e)}function upe(){}function DF(e){return null==e?upe:function(){return this.querySelector(e)}}function ppe(){return[]}function r$(e){return null==e?ppe:function(){return this.querySelectorAll(e)}}function o$(e){return function(){return this.matches(e)}}function s$(e){return function(n){return n.matches(e)}}Set;var _pe=Array.prototype.find;function vpe(){return this.firstElementChild}var xpe=Array.prototype.filter;function wpe(){return Array.from(this.children)}function a$(e){return new Array(e.length)}function SI(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}function Dpe(e,n,t,i,r,a){for(var v,h=0,C=n.length,P=a.length;h<P;++h)(v=n[h])?(v.__data__=a[h],i[h]=v):t[h]=new SI(e,a[h]);for(;h<C;++h)(v=n[h])&&(r[h]=v)}function Ipe(e,n,t,i,r,a,h){var v,C,X,P=new Map,L=n.length,V=a.length,W=new Array(L);for(v=0;v<L;++v)(C=n[v])&&(W[v]=X=h.call(C,C.__data__,v,n)+"",P.has(X)?r[v]=C:P.set(X,C));for(v=0;v<V;++v)X=h.call(e,a[v],v,a)+"",(C=P.get(X))?(i[v]=C,C.__data__=a[v],P.delete(X)):t[v]=new SI(e,a[v]);for(v=0;v<L;++v)(C=n[v])&&P.get(W[v])===C&&(r[v]=C)}function kpe(e){return e.__data__}function Rpe(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function zpe(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}SI.prototype={constructor:SI,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var IF="http://www.w3.org/1999/xhtml";const l$={svg:"http://www.w3.org/2000/svg",xhtml:IF,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function EI(e){var n=e+="",t=n.indexOf(":");return t>=0&&"xmlns"!==(n=e.slice(0,t))&&(e=e.slice(t+1)),l$.hasOwnProperty(n)?{space:l$[n],local:e}:e}function Gpe(e){return function(){this.removeAttribute(e)}}function qpe(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Wpe(e,n){return function(){this.setAttribute(e,n)}}function Zpe(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function Ype(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}function Xpe(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function c$(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Qpe(e){return function(){this.style.removeProperty(e)}}function Jpe(e,n,t){return function(){this.style.setProperty(e,n,t)}}function eme(e,n,t){return function(){var i=n.apply(this,arguments);null==i?this.style.removeProperty(e):this.style.setProperty(e,i,t)}}function Gx(e,n){return e.style.getPropertyValue(n)||c$(e).getComputedStyle(e,null).getPropertyValue(n)}function nme(e){return function(){delete this[e]}}function ime(e,n){return function(){this[e]=n}}function rme(e,n){return function(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}}function d$(e){return e.trim().split(/^|\s+/)}function kF(e){return e.classList||new u$(e)}function u$(e){this._node=e,this._names=d$(e.getAttribute("class")||"")}function h$(e,n){for(var t=kF(e),i=-1,r=n.length;++i<r;)t.add(n[i])}function f$(e,n){for(var t=kF(e),i=-1,r=n.length;++i<r;)t.remove(n[i])}function sme(e){return function(){h$(this,e)}}function ame(e){return function(){f$(this,e)}}function lme(e,n){return function(){(n.apply(this,arguments)?h$:f$)(this,e)}}function dme(){this.textContent=""}function ume(e){return function(){this.textContent=e}}function hme(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function pme(){this.innerHTML=""}function mme(e){return function(){this.innerHTML=e}}function gme(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function yme(){this.nextSibling&&this.parentNode.appendChild(this)}function bme(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wme(e){return function(){var n=this.ownerDocument,t=this.namespaceURI;return t===IF&&n.documentElement.namespaceURI===IF?n.createElement(e):n.createElementNS(t,e)}}function Cme(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function p$(e){var n=EI(e);return(n.local?Cme:wme)(n)}function Mme(){return null}function Eme(){var e=this.parentNode;e&&e.removeChild(this)}function Ime(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function kme(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function Fme(e){return function(){var n=this.__on;if(n){for(var a,t=0,i=-1,r=n.length;t<r;++t)a=n[t],e.type&&a.type!==e.type||a.name!==e.name?n[++i]=a:this.removeEventListener(a.type,a.listener,a.options);++i?n.length=i:delete this.__on}}}function Lme(e,n,t){return function(){var r,i=this.__on,a=function Pme(e){return function(n){e.call(this,n,this.__data__)}}(n);if(i)for(var h=0,v=i.length;h<v;++h)if((r=i[h]).type===e.type&&r.name===e.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=t),void(r.value=n);this.addEventListener(e.type,a,t),r={type:e.type,name:e.name,value:n,listener:a,options:t},i?i.push(r):this.__on=[r]}}function m$(e,n,t){var i=c$(e),r=i.CustomEvent;"function"==typeof r?r=new r(n,t):(r=i.document.createEvent("Event"),t?(r.initEvent(n,t.bubbles,t.cancelable),r.detail=t.detail):r.initEvent(n,!1,!1)),e.dispatchEvent(r)}function zme(e,n){return function(){return m$(this,e,n)}}function Bme(e,n){return function(){return m$(this,e,n.apply(this,arguments))}}u$.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var g$=[null];function bd(e,n){this._groups=e,this._parents=n}function _$(){return new bd([[document.documentElement]],g$)}bd.prototype=_$.prototype={constructor:bd,select:function hpe(e){"function"!=typeof e&&(e=DF(e));for(var n=this._groups,t=n.length,i=new Array(t),r=0;r<t;++r)for(var C,P,a=n[r],h=a.length,v=i[r]=new Array(h),L=0;L<h;++L)(C=a[L])&&(P=e.call(C,C.__data__,L,a))&&("__data__"in C&&(P.__data__=C.__data__),v[L]=P);return new bd(i,this._parents)},selectAll:function gpe(e){e="function"==typeof e?function mpe(e){return function(){return function fpe(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}(e.apply(this,arguments))}}(e):r$(e);for(var n=this._groups,t=n.length,i=[],r=[],a=0;a<t;++a)for(var C,h=n[a],v=h.length,P=0;P<v;++P)(C=h[P])&&(i.push(e.call(C,C.__data__,P,h)),r.push(C));return new bd(i,r)},selectChild:function bpe(e){return this.select(null==e?vpe:function ype(e){return function(){return _pe.call(this.children,e)}}("function"==typeof e?e:s$(e)))},selectChildren:function Tpe(e){return this.selectAll(null==e?wpe:function Cpe(e){return function(){return xpe.call(this.children,e)}}("function"==typeof e?e:s$(e)))},filter:function Mpe(e){"function"!=typeof e&&(e=o$(e));for(var n=this._groups,t=n.length,i=new Array(t),r=0;r<t;++r)for(var C,a=n[r],h=a.length,v=i[r]=[],P=0;P<h;++P)(C=a[P])&&e.call(C,C.__data__,P,a)&&v.push(C);return new bd(i,this._parents)},data:function Ape(e,n){if(!arguments.length)return Array.from(this,kpe);var t=n?Ipe:Dpe,i=this._parents,r=this._groups;"function"!=typeof e&&(e=function Epe(e){return function(){return e}}(e));for(var a=r.length,h=new Array(a),v=new Array(a),C=new Array(a),P=0;P<a;++P){var L=i[P],V=r[P],W=V.length,X=Rpe(e.call(L,L&&L.__data__,P,i)),oe=X.length,he=v[P]=new Array(oe),se=h[P]=new Array(oe);t(L,V,he,se,C[P]=new Array(W),X,n);for(var et,ut,Se=0,$e=0;Se<oe;++Se)if(et=he[Se]){for(Se>=$e&&($e=Se+1);!(ut=se[$e])&&++$e<oe;);et._next=ut||null}}return(h=new bd(h,i))._enter=v,h._exit=C,h},enter:function Spe(){return new bd(this._enter||this._groups.map(a$),this._parents)},exit:function Ppe(){return new bd(this._exit||this._groups.map(a$),this._parents)},join:function Ope(e,n,t){var i=this.enter(),r=this,a=this.exit();return"function"==typeof e?(i=e(i))&&(i=i.selection()):i=i.append(e+""),null!=n&&(r=n(r))&&(r=r.selection()),null==t?a.remove():t(a),i&&r?i.merge(r).order():r},merge:function Fpe(e){for(var n=e.selection?e.selection():e,t=this._groups,i=n._groups,r=t.length,h=Math.min(r,i.length),v=new Array(r),C=0;C<h;++C)for(var X,P=t[C],L=i[C],V=P.length,W=v[C]=new Array(V),oe=0;oe<V;++oe)(X=P[oe]||L[oe])&&(W[oe]=X);for(;C<r;++C)v[C]=t[C];return new bd(v,this._parents)},selection:function jme(){return this},order:function Lpe(){for(var e=this._groups,n=-1,t=e.length;++n<t;)for(var h,i=e[n],r=i.length-1,a=i[r];--r>=0;)(h=i[r])&&(a&&4^h.compareDocumentPosition(a)&&a.parentNode.insertBefore(h,a),a=h);return this},sort:function Npe(e){function n(V,W){return V&&W?e(V.__data__,W.__data__):!V-!W}e||(e=zpe);for(var t=this._groups,i=t.length,r=new Array(i),a=0;a<i;++a){for(var P,h=t[a],v=h.length,C=r[a]=new Array(v),L=0;L<v;++L)(P=h[L])&&(C[L]=P);C.sort(n)}return new bd(r,this._parents).order()},call:function Bpe(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function Vpe(){return Array.from(this)},node:function Upe(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var i=e[n],r=0,a=i.length;r<a;++r){var h=i[r];if(h)return h}return null},size:function jpe(){let e=0;for(const n of this)++e;return e},empty:function Hpe(){return!this.node()},each:function $pe(e){for(var n=this._groups,t=0,i=n.length;t<i;++t)for(var v,r=n[t],a=0,h=r.length;a<h;++a)(v=r[a])&&e.call(v,v.__data__,a,r);return this},attr:function Kpe(e,n){var t=EI(e);if(arguments.length<2){var i=this.node();return t.local?i.getAttributeNS(t.space,t.local):i.getAttribute(t)}return this.each((null==n?t.local?qpe:Gpe:"function"==typeof n?t.local?Xpe:Ype:t.local?Zpe:Wpe)(t,n))},style:function tme(e,n,t){return arguments.length>1?this.each((null==n?Qpe:"function"==typeof n?eme:Jpe)(e,n,t??"")):Gx(this.node(),e)},property:function ome(e,n){return arguments.length>1?this.each((null==n?nme:"function"==typeof n?rme:ime)(e,n)):this.node()[e]},classed:function cme(e,n){var t=d$(e+"");if(arguments.length<2){for(var i=kF(this.node()),r=-1,a=t.length;++r<a;)if(!i.contains(t[r]))return!1;return!0}return this.each(("function"==typeof n?lme:n?sme:ame)(t,n))},text:function fme(e){return arguments.length?this.each(null==e?dme:("function"==typeof e?hme:ume)(e)):this.node().textContent},html:function _me(e){return arguments.length?this.each(null==e?pme:("function"==typeof e?gme:mme)(e)):this.node().innerHTML},raise:function vme(){return this.each(yme)},lower:function xme(){return this.each(bme)},append:function Tme(e){var n="function"==typeof e?e:p$(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})},insert:function Sme(e,n){var t="function"==typeof e?e:p$(e),i=null==n?Mme:"function"==typeof n?n:DF(n);return this.select(function(){return this.insertBefore(t.apply(this,arguments),i.apply(this,arguments)||null)})},remove:function Dme(){return this.each(Eme)},clone:function Ame(e){return this.select(e?kme:Ime)},datum:function Rme(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function Nme(e,n,t){var r,h,i=function Ome(e){return e.trim().split(/^|\s+/).map(function(n){var t="",i=n.indexOf(".");return i>=0&&(t=n.slice(i+1),n=n.slice(0,i)),{type:n,name:t}})}(e+""),a=i.length;if(!(arguments.length<2)){for(v=n?Lme:Fme,r=0;r<a;++r)this.each(v(i[r],n,t));return this}var v=this.node().__on;if(v)for(var L,C=0,P=v.length;C<P;++C)for(r=0,L=v[C];r<a;++r)if((h=i[r]).type===L.type&&h.name===L.name)return L.value},dispatch:function Vme(e,n){return this.each(("function"==typeof n?Bme:zme)(e,n))},[Symbol.iterator]:function*Ume(){for(var e=this._groups,n=0,t=e.length;n<t;++n)for(var h,i=e[n],r=0,a=i.length;r<a;++r)(h=i[r])&&(yield h)}};const lT=_$;var Hme={value:()=>{}};function y$(){for(var i,e=0,n=arguments.length,t={};e<n;++e){if(!(i=arguments[e]+"")||i in t||/[\s.]/.test(i))throw new Error("illegal type: "+i);t[i]=[]}return new DI(t)}function DI(e){this._=e}function Gme(e,n){for(var r,t=0,i=e.length;t<i;++t)if((r=e[t]).name===n)return r.value}function v$(e,n,t){for(var i=0,r=e.length;i<r;++i)if(e[i].name===n){e[i]=Hme,e=e.slice(0,i).concat(e.slice(i+1));break}return null!=t&&e.push({name:n,value:t}),e}DI.prototype=y$.prototype={constructor:DI,on:function(e,n){var r,t=this._,i=function $me(e,n){return e.trim().split(/^|\s+/).map(function(t){var i="",r=t.indexOf(".");if(r>=0&&(i=t.slice(r+1),t=t.slice(0,r)),t&&!n.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:i}})}(e+"",t),a=-1,h=i.length;if(!(arguments.length<2)){if(null!=n&&"function"!=typeof n)throw new Error("invalid callback: "+n);for(;++a<h;)if(r=(e=i[a]).type)t[r]=v$(t[r],e.name,n);else if(null==n)for(r in t)t[r]=v$(t[r],e.name,null);return this}for(;++a<h;)if((r=(e=i[a]).type)&&(r=Gme(t[r],e.name)))return r},copy:function(){var e={},n=this._;for(var t in n)e[t]=n[t].slice();return new DI(e)},call:function(e,n){if((r=arguments.length-2)>0)for(var r,a,t=new Array(r),i=0;i<r;++i)t[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,r=(a=this._[e]).length;i<r;++i)a[i].value.apply(n,t)},apply:function(e,n,t){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],r=0,a=i.length;r<a;++r)i[r].value.apply(n,t)}};const b$=y$;var II,uT,qx=0,cT=0,dT=0,kI=0,nb=0,AI=0,hT="object"==typeof performance&&performance.now?performance:Date,w$="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function AF(){return nb||(w$(qme),nb=hT.now()+AI)}function qme(){nb=0}function RI(){this._call=this._time=this._next=null}function C$(e,n,t){var i=new RI;return i.restart(e,n,t),i}function T$(){nb=(kI=hT.now())+AI,qx=cT=0;try{!function Wme(){AF(),++qx;for(var n,e=II;e;)(n=nb-e._time)>=0&&e._call.call(void 0,n),e=e._next;--qx}()}finally{qx=0,function Yme(){for(var e,t,n=II,i=1/0;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:II=t);uT=e,RF(i)}(),nb=0}}function Zme(){var e=hT.now(),n=e-kI;n>1e3&&(AI-=n,kI=e)}function RF(e){qx||(cT&&(cT=clearTimeout(cT)),e-nb>24?(e<1/0&&(cT=setTimeout(T$,e-hT.now()-AI)),dT&&(dT=clearInterval(dT))):(dT||(kI=hT.now(),dT=setInterval(Zme,1e3)),qx=1,w$(T$)))}function M$(e,n,t){var i=new RI;return i.restart(r=>{i.stop(),e(r+n)},n=null==n?0:+n,t),i}RI.prototype=C$.prototype={constructor:RI,restart:function(e,n,t){if("function"!=typeof e)throw new TypeError("callback is not a function");t=(null==t?AF():+t)+(null==n?0:+n),!this._next&&uT!==this&&(uT?uT._next=this:II=this,uT=this),this._call=e,this._time=t,RF()},stop:function(){this._call&&(this._call=null,this._time=1/0,RF())}};var Xme=b$("start","end","cancel","interrupt"),Kme=[];function FI(e,n,t,i,r,a){var h=e.__transition;if(h){if(t in h)return}else e.__transition={};!function Qme(e,n,t){var r,i=e.__transition;function h(P){var L,V,W,X;if(1!==t.state)return C();for(L in i)if((X=i[L]).name===t.name){if(3===X.state)return M$(h);4===X.state?(X.state=6,X.timer.stop(),X.on.call("interrupt",e,e.__data__,X.index,X.group),delete i[L]):+L<n&&(X.state=6,X.timer.stop(),X.on.call("cancel",e,e.__data__,X.index,X.group),delete i[L])}if(M$(function(){3===t.state&&(t.state=4,t.timer.restart(v,t.delay,t.time),v(P))}),t.state=2,t.on.call("start",e,e.__data__,t.index,t.group),2===t.state){for(t.state=3,r=new Array(W=t.tween.length),L=0,V=-1;L<W;++L)(X=t.tween[L].value.call(e,e.__data__,t.index,t.group))&&(r[++V]=X);r.length=V+1}}function v(P){for(var L=P<t.duration?t.ease.call(null,P/t.duration):(t.timer.restart(C),t.state=5,1),V=-1,W=r.length;++V<W;)r[V].call(e,L);5===t.state&&(t.on.call("end",e,e.__data__,t.index,t.group),C())}function C(){for(var P in t.state=6,t.timer.stop(),delete i[n],i)return;delete e.__transition}i[n]=t,t.timer=C$(function a(P){t.state=1,t.timer.restart(h,t.delay,t.time),t.delay<=P&&h(P-t.delay)},0,t.time)}(e,t,{name:n,index:i,group:r,on:Xme,tween:Kme,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})}function FF(e,n){var t=Eh(e,n);if(t.state>0)throw new Error("too late; already scheduled");return t}function ep(e,n){var t=Eh(e,n);if(t.state>3)throw new Error("too late; already running");return t}function Eh(e,n){var t=e.__transition;if(!t||!(t=t[n]))throw new Error("transition not found");return t}function LI(e,n){var i,r,h,t=e.__transition,a=!0;if(t){for(h in n=null==n?null:n+"",t)(i=t[h]).name===n?(r=i.state>2&&i.state<5,i.state=6,i.timer.stop(),i.on.call(r?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete t[h]):a=!1;a&&delete e.__transition}}function Dh(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}var NI,I$=180/Math.PI,LF={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function k$(e,n,t,i,r,a){var h,v,C;return(h=Math.sqrt(e*e+n*n))&&(e/=h,n/=h),(C=e*t+n*i)&&(t-=e*C,i-=n*C),(v=Math.sqrt(t*t+i*i))&&(t/=v,i/=v,C/=v),e*i<n*t&&(e=-e,n=-n,C=-C,h=-h),{translateX:r,translateY:a,rotate:Math.atan2(n,e)*I$,skewX:Math.atan(C)*I$,scaleX:h,scaleY:v}}function A$(e,n,t,i){function r(P){return P.length?P.pop()+" ":""}return function(P,L){var V=[],W=[];return P=e(P),L=e(L),function a(P,L,V,W,X,oe){if(P!==V||L!==W){var he=X.push("translate(",null,n,null,t);oe.push({i:he-4,x:Dh(P,V)},{i:he-2,x:Dh(L,W)})}else(V||W)&&X.push("translate("+V+n+W+t)}(P.translateX,P.translateY,L.translateX,L.translateY,V,W),function h(P,L,V,W){P!==L?(P-L>180?L+=360:L-P>180&&(P+=360),W.push({i:V.push(r(V)+"rotate(",null,i)-2,x:Dh(P,L)})):L&&V.push(r(V)+"rotate("+L+i)}(P.rotate,L.rotate,V,W),function v(P,L,V,W){P!==L?W.push({i:V.push(r(V)+"skewX(",null,i)-2,x:Dh(P,L)}):L&&V.push(r(V)+"skewX("+L+i)}(P.skewX,L.skewX,V,W),function C(P,L,V,W,X,oe){if(P!==V||L!==W){var he=X.push(r(X)+"scale(",null,",",null,")");oe.push({i:he-4,x:Dh(P,V)},{i:he-2,x:Dh(L,W)})}else(1!==V||1!==W)&&X.push(r(X)+"scale("+V+","+W+")")}(P.scaleX,P.scaleY,L.scaleX,L.scaleY,V,W),P=L=null,function(X){for(var se,oe=-1,he=W.length;++oe<he;)V[(se=W[oe]).i]=se.x(X);return V.join("")}}}var nge=A$(function ege(e){const n=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?LF:k$(n.a,n.b,n.c,n.d,n.e,n.f)},"px, ","px)","deg)"),ige=A$(function tge(e){return null!=e&&(NI||(NI=document.createElementNS("http://www.w3.org/2000/svg","g")),NI.setAttribute("transform",e),e=NI.transform.baseVal.consolidate())?k$((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):LF},", ",")",")");function rge(e,n){var t,i;return function(){var r=ep(this,e),a=r.tween;if(a!==t)for(var h=0,v=(i=t=a).length;h<v;++h)if(i[h].name===n){(i=i.slice()).splice(h,1);break}r.tween=i}}function oge(e,n,t){var i,r;if("function"!=typeof t)throw new Error;return function(){var a=ep(this,e),h=a.tween;if(h!==i){r=(i=h).slice();for(var v={name:n,value:t},C=0,P=r.length;C<P;++C)if(r[C].name===n){r[C]=v;break}C===P&&r.push(v)}a.tween=r}}function NF(e,n,t){var i=e._id;return e.each(function(){var r=ep(this,i);(r.value||(r.value={}))[n]=t.apply(this,arguments)}),function(r){return Eh(r,i).value[n]}}function zF(e,n,t){e.prototype=n.prototype=t,t.constructor=e}function R$(e,n){var t=Object.create(e.prototype);for(var i in n)t[i]=n[i];return t}function fT(){}var zI=1/.7,Wx="\\s*([+-]?\\d+)\\s*",mT="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",age=/^#([0-9a-f]{3,8})$/,lge=new RegExp(`^rgb\\(${Wx},${Wx},${Wx}\\)$`),cge=new RegExp(`^rgb\\(${tp},${tp},${tp}\\)$`),dge=new RegExp(`^rgba\\(${Wx},${Wx},${Wx},${mT}\\)$`),uge=new RegExp(`^rgba\\(${tp},${tp},${tp},${mT}\\)$`),hge=new RegExp(`^hsl\\(${mT},${tp},${tp}\\)$`),fge=new RegExp(`^hsla\\(${mT},${tp},${tp},${mT}\\)$`),P$={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function O$(){return this.rgb().formatHex()}function F$(){return this.rgb().formatRgb()}function ib(e){var n,t;return e=(e+"").trim().toLowerCase(),(n=age.exec(e))?(t=n[1].length,n=parseInt(n[1],16),6===t?L$(n):3===t?new Lc(n>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):8===t?BI(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):4===t?BI(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|240&n,((15&n)<<4|15&n)/255):null):(n=lge.exec(e))?new Lc(n[1],n[2],n[3],1):(n=cge.exec(e))?new Lc(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=dge.exec(e))?BI(n[1],n[2],n[3],n[4]):(n=uge.exec(e))?BI(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=hge.exec(e))?B$(n[1],n[2]/100,n[3]/100,1):(n=fge.exec(e))?B$(n[1],n[2]/100,n[3]/100,n[4]):P$.hasOwnProperty(e)?L$(P$[e]):"transparent"===e?new Lc(NaN,NaN,NaN,0):null}function L$(e){return new Lc(e>>16&255,e>>8&255,255&e,1)}function BI(e,n,t,i){return i<=0&&(e=n=t=NaN),new Lc(e,n,t,i)}function VI(e,n,t,i){return 1===arguments.length?function gge(e){return e instanceof fT||(e=ib(e)),e?new Lc((e=e.rgb()).r,e.g,e.b,e.opacity):new Lc}(e):new Lc(e,n,t,i??1)}function Lc(e,n,t,i){this.r=+e,this.g=+n,this.b=+t,this.opacity=+i}function N$(){return`#${ob(this.r)}${ob(this.g)}${ob(this.b)}`}function z$(){const e=UI(this.opacity);return`${1===e?"rgb(":"rgba("}${rb(this.r)}, ${rb(this.g)}, ${rb(this.b)}${1===e?")":`, ${e})`}`}function UI(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function rb(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ob(e){return((e=rb(e))<16?"0":"")+e.toString(16)}function B$(e,n,t,i){return i<=0?e=n=t=NaN:t<=0||t>=1?e=n=NaN:n<=0&&(e=NaN),new Ih(e,n,t,i)}function V$(e){if(e instanceof Ih)return new Ih(e.h,e.s,e.l,e.opacity);if(e instanceof fT||(e=ib(e)),!e)return new Ih;if(e instanceof Ih)return e;var n=(e=e.rgb()).r/255,t=e.g/255,i=e.b/255,r=Math.min(n,t,i),a=Math.max(n,t,i),h=NaN,v=a-r,C=(a+r)/2;return v?(h=n===a?(t-i)/v+6*(t<i):t===a?(i-n)/v+2:(n-t)/v+4,v/=C<.5?a+r:2-a-r,h*=60):v=C>0&&C<1?0:h,new Ih(h,v,C,e.opacity)}function Ih(e,n,t,i){this.h=+e,this.s=+n,this.l=+t,this.opacity=+i}function U$(e){return(e=(e||0)%360)<0?e+360:e}function jI(e){return Math.max(0,Math.min(1,e||0))}function BF(e,n,t){return 255*(e<60?n+(t-n)*e/60:e<180?t:e<240?n+(t-n)*(240-e)/60:n)}function j$(e,n,t,i,r){var a=e*e,h=a*e;return((1-3*e+3*a-h)*n+(4-6*a+3*h)*t+(1+3*e+3*a-3*h)*i+h*r)/6}zF(fT,ib,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:O$,formatHex:O$,formatHex8:function pge(){return this.rgb().formatHex8()},formatHsl:function mge(){return V$(this).formatHsl()},formatRgb:F$,toString:F$}),zF(Lc,VI,R$(fT,{brighter(e){return e=null==e?zI:Math.pow(zI,e),new Lc(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new Lc(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Lc(rb(this.r),rb(this.g),rb(this.b),UI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:N$,formatHex:N$,formatHex8:function _ge(){return`#${ob(this.r)}${ob(this.g)}${ob(this.b)}${ob(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:z$,toString:z$})),zF(Ih,function yge(e,n,t,i){return 1===arguments.length?V$(e):new Ih(e,n,t,i??1)},R$(fT,{brighter(e){return e=null==e?zI:Math.pow(zI,e),new Ih(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?.7:Math.pow(.7,e),new Ih(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),n=isNaN(e)||isNaN(this.s)?0:this.s,t=this.l,i=t+(t<.5?t:1-t)*n,r=2*t-i;return new Lc(BF(e>=240?e-240:e+120,r,i),BF(e,r,i),BF(e<120?e+240:e-120,r,i),this.opacity)},clamp(){return new Ih(U$(this.h),jI(this.s),jI(this.l),UI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=UI(this.opacity);return`${1===e?"hsl(":"hsla("}${U$(this.h)}, ${100*jI(this.s)}%, ${100*jI(this.l)}%${1===e?")":`, ${e})`}`}}));const VF=e=>()=>e;function $$(e,n){var t=n-e;return t?function H$(e,n){return function(t){return e+t*n}}(e,t):VF(isNaN(e)?n:e)}const HI=function e(n){var t=function wge(e){return 1==(e=+e)?$$:function(n,t){return t-n?function xge(e,n,t){return e=Math.pow(e,t),n=Math.pow(n,t)-e,t=1/t,function(i){return Math.pow(e+i*n,t)}}(n,t,e):VF(isNaN(n)?t:n)}}(n);function i(r,a){var h=t((r=VI(r)).r,(a=VI(a)).r),v=t(r.g,a.g),C=t(r.b,a.b),P=$$(r.opacity,a.opacity);return function(L){return r.r=h(L),r.g=v(L),r.b=C(L),r.opacity=P(L),r+""}}return i.gamma=e,i}(1);function G$(e){return function(n){var h,v,t=n.length,i=new Array(t),r=new Array(t),a=new Array(t);for(h=0;h<t;++h)v=VI(n[h]),i[h]=v.r||0,r[h]=v.g||0,a[h]=v.b||0;return i=e(i),r=e(r),a=e(a),v.opacity=1,function(C){return v.r=i(C),v.g=r(C),v.b=a(C),v+""}}}G$(function vge(e){var n=e.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),r=e[i],a=e[i+1];return j$((t-i/n)*n,i>0?e[i-1]:2*r-a,r,a,i<n-1?e[i+2]:2*a-r)}}),G$(function bge(e){var n=e.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n);return j$((t-i/n)*n,e[(i+n-1)%n],e[i%n],e[(i+1)%n],e[(i+2)%n])}});var UF=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,jF=new RegExp(UF.source,"g");function q$(e,n){var i,r,a,t=UF.lastIndex=jF.lastIndex=0,h=-1,v=[],C=[];for(e+="",n+="";(i=UF.exec(e))&&(r=jF.exec(n));)(a=r.index)>t&&(a=n.slice(t,a),v[h]?v[h]+=a:v[++h]=a),(i=i[0])===(r=r[0])?v[h]?v[h]+=r:v[++h]=r:(v[++h]=null,C.push({i:h,x:Dh(i,r)})),t=jF.lastIndex;return t<n.length&&(a=n.slice(t),v[h]?v[h]+=a:v[++h]=a),v.length<2?C[0]?function Tge(e){return function(n){return e(n)+""}}(C[0].x):function Cge(e){return function(){return e}}(n):(n=C.length,function(P){for(var V,L=0;L<n;++L)v[(V=C[L]).i]=V.x(P);return v.join("")})}function W$(e,n){var t;return("number"==typeof n?Dh:n instanceof ib?HI:(t=ib(n))?(n=t,HI):q$)(e,n)}function Mge(e){return function(){this.removeAttribute(e)}}function Sge(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Ege(e,n,t){var i,a,r=t+"";return function(){var h=this.getAttribute(e);return h===r?null:h===i?a:a=n(i=h,t)}}function Dge(e,n,t){var i,a,r=t+"";return function(){var h=this.getAttributeNS(e.space,e.local);return h===r?null:h===i?a:a=n(i=h,t)}}function Ige(e,n,t){var i,r,a;return function(){var h,C,v=t(this);return null==v?void this.removeAttribute(e):(h=this.getAttribute(e))===(C=v+"")?null:h===i&&C===r?a:(r=C,a=n(i=h,v))}}function kge(e,n,t){var i,r,a;return function(){var h,C,v=t(this);return null==v?void this.removeAttributeNS(e.space,e.local):(h=this.getAttributeNS(e.space,e.local))===(C=v+"")?null:h===i&&C===r?a:(r=C,a=n(i=h,v))}}function Oge(e,n){var t,i;function r(){var a=n.apply(this,arguments);return a!==i&&(t=(i=a)&&function Pge(e,n){return function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}}(e,a)),t}return r._value=n,r}function Fge(e,n){var t,i;function r(){var a=n.apply(this,arguments);return a!==i&&(t=(i=a)&&function Rge(e,n){return function(t){this.setAttribute(e,n.call(this,t))}}(e,a)),t}return r._value=n,r}function Nge(e,n){return function(){FF(this,e).delay=+n.apply(this,arguments)}}function zge(e,n){return n=+n,function(){FF(this,e).delay=n}}function Vge(e,n){return function(){ep(this,e).duration=+n.apply(this,arguments)}}function Uge(e,n){return n=+n,function(){ep(this,e).duration=n}}var n_e=lT.prototype.constructor;function Z$(e){return function(){this.style.removeProperty(e)}}var b_e=0;function zm(e,n,t,i){this._groups=e,this._parents=n,this._name=t,this._id=i}function Y$(){return++b_e}var Bm=lT.prototype;zm.prototype=function x_e(e){return lT().transition(e)}.prototype={constructor:zm,select:function e_e(e){var n=this._name,t=this._id;"function"!=typeof e&&(e=DF(e));for(var i=this._groups,r=i.length,a=new Array(r),h=0;h<r;++h)for(var L,V,v=i[h],C=v.length,P=a[h]=new Array(C),W=0;W<C;++W)(L=v[W])&&(V=e.call(L,L.__data__,W,v))&&("__data__"in L&&(V.__data__=L.__data__),P[W]=V,FI(P[W],n,t,W,P,Eh(L,t)));return new zm(a,this._parents,n,t)},selectAll:function t_e(e){var n=this._name,t=this._id;"function"!=typeof e&&(e=r$(e));for(var i=this._groups,r=i.length,a=[],h=[],v=0;v<r;++v)for(var L,C=i[v],P=C.length,V=0;V<P;++V)if(L=C[V]){for(var X,W=e.call(L,L.__data__,V,C),oe=Eh(L,t),he=0,se=W.length;he<se;++he)(X=W[he])&&FI(X,n,t,he,W,oe);a.push(W),h.push(L)}return new zm(a,h,n,t)},selectChild:Bm.selectChild,selectChildren:Bm.selectChildren,filter:function Wge(e){"function"!=typeof e&&(e=o$(e));for(var n=this._groups,t=n.length,i=new Array(t),r=0;r<t;++r)for(var C,a=n[r],h=a.length,v=i[r]=[],P=0;P<h;++P)(C=a[P])&&e.call(C,C.__data__,P,a)&&v.push(C);return new zm(i,this._parents,this._name,this._id)},merge:function Zge(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,t=e._groups,i=n.length,a=Math.min(i,t.length),h=new Array(i),v=0;v<a;++v)for(var W,C=n[v],P=t[v],L=C.length,V=h[v]=new Array(L),X=0;X<L;++X)(W=C[X]||P[X])&&(V[X]=W);for(;v<i;++v)h[v]=n[v];return new zm(h,this._parents,this._name,this._id)},selection:function i_e(){return new n_e(this._groups,this._parents)},transition:function y_e(){for(var e=this._name,n=this._id,t=Y$(),i=this._groups,r=i.length,a=0;a<r;++a)for(var C,h=i[a],v=h.length,P=0;P<v;++P)if(C=h[P]){var L=Eh(C,n);FI(C,e,t,P,h,{time:L.time+L.delay+L.duration,delay:0,duration:L.duration,ease:L.ease})}return new zm(i,this._parents,e,t)},call:Bm.call,nodes:Bm.nodes,node:Bm.node,size:Bm.size,empty:Bm.empty,each:Bm.each,on:function Kge(e,n){var t=this._id;return arguments.length<2?Eh(this.node(),t).on.on(e):this.each(function Xge(e,n,t){var i,r,a=function Yge(e){return(e+"").trim().split(/^|\s+/).every(function(n){var t=n.indexOf(".");return t>=0&&(n=n.slice(0,t)),!n||"start"===n})}(n)?FF:ep;return function(){var h=a(this,e),v=h.on;v!==i&&(r=(i=v).copy()).on(n,t),h.on=r}}(t,e,n))},attr:function Age(e,n){var t=EI(e),i="transform"===t?ige:W$;return this.attrTween(e,"function"==typeof n?(t.local?kge:Ige)(t,i,NF(this,"attr."+e,n)):null==n?(t.local?Sge:Mge)(t):(t.local?Dge:Ege)(t,i,n))},attrTween:function Lge(e,n){var t="attr."+e;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(null==n)return this.tween(t,null);if("function"!=typeof n)throw new Error;var i=EI(e);return this.tween(t,(i.local?Oge:Fge)(i,n))},style:function l_e(e,n,t){var i="transform"==(e+="")?nge:W$;return null==n?this.styleTween(e,function r_e(e,n){var t,i,r;return function(){var a=Gx(this,e),h=(this.style.removeProperty(e),Gx(this,e));return a===h?null:a===t&&h===i?r:r=n(t=a,i=h)}}(e,i)).on("end.style."+e,Z$(e)):"function"==typeof n?this.styleTween(e,function s_e(e,n,t){var i,r,a;return function(){var h=Gx(this,e),v=t(this),C=v+"";return null==v&&(this.style.removeProperty(e),C=v=Gx(this,e)),h===C?null:h===i&&C===r?a:(r=C,a=n(i=h,v))}}(e,i,NF(this,"style."+e,n))).each(function a_e(e,n){var t,i,r,v,a="style."+n,h="end."+a;return function(){var C=ep(this,e),P=C.on,L=null==C.value[a]?v||(v=Z$(n)):void 0;(P!==t||r!==L)&&(i=(t=P).copy()).on(h,r=L),C.on=i}}(this._id,e)):this.styleTween(e,function o_e(e,n,t){var i,a,r=t+"";return function(){var h=Gx(this,e);return h===r?null:h===i?a:a=n(i=h,t)}}(e,i,n),t).on("end.style."+e,null)},styleTween:function u_e(e,n,t){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==n)return this.tween(i,null);if("function"!=typeof n)throw new Error;return this.tween(i,function d_e(e,n,t){var i,r;function a(){var h=n.apply(this,arguments);return h!==r&&(i=(r=h)&&function c_e(e,n,t){return function(i){this.style.setProperty(e,n.call(this,i),t)}}(e,h,t)),i}return a._value=n,a}(e,n,t??""))},text:function p_e(e){return this.tween("text","function"==typeof e?function f_e(e){return function(){var n=e(this);this.textContent=n??""}}(NF(this,"text",e)):function h_e(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function __e(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;return this.tween(n,function g_e(e){var n,t;function i(){var r=e.apply(this,arguments);return r!==t&&(n=(t=r)&&function m_e(e){return function(n){this.textContent=e.call(this,n)}}(r)),n}return i._value=e,i}(e))},remove:function Jge(){return this.on("end.remove",function Qge(e){return function(){var n=this.parentNode;for(var t in this.__transition)if(+t!==e)return;n&&n.removeChild(this)}}(this._id))},tween:function sge(e,n){var t=this._id;if(e+="",arguments.length<2){for(var h,i=Eh(this.node(),t).tween,r=0,a=i.length;r<a;++r)if((h=i[r]).name===e)return h.value;return null}return this.each((null==n?rge:oge)(t,e,n))},delay:function Bge(e){var n=this._id;return arguments.length?this.each(("function"==typeof e?Nge:zge)(n,e)):Eh(this.node(),n).delay},duration:function jge(e){var n=this._id;return arguments.length?this.each(("function"==typeof e?Vge:Uge)(n,e)):Eh(this.node(),n).duration},ease:function $ge(e){var n=this._id;return arguments.length?this.each(function Hge(e,n){if("function"!=typeof n)throw new Error;return function(){ep(this,e).ease=n}}(n,e)):Eh(this.node(),n).ease},easeVarying:function qge(e){if("function"!=typeof e)throw new Error;return this.each(function Gge(e,n){return function(){var t=n.apply(this,arguments);if("function"!=typeof t)throw new Error;ep(this,e).ease=t}}(this._id,e))},end:function v_e(){var e,n,t=this,i=t._id,r=t.size();return new Promise(function(a,h){var v={value:h},C={value:function(){0==--r&&a()}};t.each(function(){var P=ep(this,i),L=P.on;L!==e&&((n=(e=L).copy())._.cancel.push(v),n._.interrupt.push(v),n._.end.push(C)),P.on=n}),0===r&&a()})},[Symbol.iterator]:Bm[Symbol.iterator]};var C_e={time:null,delay:0,duration:250,ease:function w_e(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function T_e(e,n){for(var t;!(t=e.__transition)||!(t=t[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return t}lT.prototype.interrupt=function Jme(e){return this.each(function(){LI(this,e)})},lT.prototype.transition=function M_e(e){var n,t;e instanceof zm?(n=e._id,e=e._name):(n=Y$(),(t=C_e).time=AF(),e=null==e?null:e+"");for(var i=this._groups,r=i.length,a=0;a<r;++a)for(var C,h=i[a],v=h.length,P=0;P<v;++P)(C=h[P])&&FI(C,e,n,P,h,t||T_e(C,n));return new zm(i,this._parents,e,n)};Math;function gT(e){return{type:e}}["w","e"].map(gT),["n","s"].map(gT),["n","w","e","s","nw","ne","sw","se"].map(gT);const WF=e=>e;function qI(e,n){e&&nG.hasOwnProperty(e.type)&&nG[e.type](e,n)}var tG={Feature:function(e,n){qI(e.geometry,n)},FeatureCollection:function(e,n){for(var t=e.features,i=-1,r=t.length;++i<r;)qI(t[i].geometry,n)}},nG={Sphere:function(e,n){n.sphere()},Point:function(e,n){n.point((e=e.coordinates)[0],e[1],e[2])},MultiPoint:function(e,n){for(var t=e.coordinates,i=-1,r=t.length;++i<r;)n.point((e=t[i])[0],e[1],e[2])},LineString:function(e,n){ZF(e.coordinates,n,0)},MultiLineString:function(e,n){for(var t=e.coordinates,i=-1,r=t.length;++i<r;)ZF(t[i],n,0)},Polygon:function(e,n){iG(e.coordinates,n)},MultiPolygon:function(e,n){for(var t=e.coordinates,i=-1,r=t.length;++i<r;)iG(t[i],n)},GeometryCollection:function(e,n){for(var t=e.geometries,i=-1,r=t.length;++i<r;)qI(t[i],n)}};function ZF(e,n,t){var a,i=-1,r=e.length-t;for(n.lineStart();++i<r;)n.point((a=e[i])[0],a[1],a[2]);n.lineEnd()}function iG(e,n){var t=-1,i=e.length;for(n.polygonStart();++t<i;)ZF(e[t],n,1);n.polygonEnd()}function Xx(e,n){e&&tG.hasOwnProperty(e.type)?tG[e.type](e,n):qI(e,n)}class Um{constructor(){this._partials=new Float64Array(32),this._n=0}add(n){const t=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const a=t[r],h=n+a,v=Math.abs(n)<Math.abs(a)?n-(h-a):a-(h-n);v&&(t[i++]=v),n=h}return t[i]=n,this._n=i+1,this}valueOf(){const n=this._partials;let i,r,a,t=this._n,h=0;if(t>0){for(h=n[--t];t>0&&(i=h,r=n[--t],h=i+r,a=r-(h-i),!a););t>0&&(a<0&&n[t-1]<0||a>0&&n[t-1]>0)&&(r=2*a,i=h+r,r==i-h&&(h=i))}return h}}var Ir=1e-6,kr=Math.PI,mu=kr/2,rG=kr/4,gu=2*kr,kh=180/kr,ic=kr/180,Uo=Math.abs,O_e=Math.atan,Kx=Math.atan2,os=Math.cos,Co=(Math,Math,Math,Math,Math,Math,Math.sin),WI=Math.sign||function(e){return e>0?1:e<0?-1:0},jm=Math.sqrt;function sb(e){return e>1?mu:e<-1?-mu:Math.asin(e)}function _u(){}Math;var oG,sG,KF,QF,YF=new Um,XF=new Um,L_={point:_u,lineStart:_u,lineEnd:_u,polygonStart:function(){L_.lineStart=L_e,L_.lineEnd=z_e},polygonEnd:function(){L_.lineStart=L_.lineEnd=L_.point=_u,YF.add(Uo(XF)),XF=new Um},result:function(){var e=YF/2;return YF=new Um,e}};function L_e(){L_.point=N_e}function N_e(e,n){L_.point=aG,oG=KF=e,sG=QF=n}function aG(e,n){XF.add(QF*e-KF*n),KF=e,QF=n}function z_e(){aG(oG,sG)}const lG=L_;var Qx=1/0,ZI=Qx,_T=-Qx,YI=_T;const XI={point:function V_e(e,n){e<Qx&&(Qx=e),e>_T&&(_T=e),n<ZI&&(ZI=n),n>YI&&(YI=n)},lineStart:_u,lineEnd:_u,polygonStart:_u,polygonEnd:_u,result:function(){var e=[[Qx,ZI],[_T,YI]];return _T=YI=-(ZI=Qx=1/0),e}};var cG,dG,np,ip,JF=0,eL=0,yT=0,KI=0,QI=0,Jx=0,tL=0,nL=0,vT=0,Ah={point:ab,lineStart:uG,lineEnd:hG,polygonStart:function(){Ah.lineStart=H_e,Ah.lineEnd=$_e},polygonEnd:function(){Ah.point=ab,Ah.lineStart=uG,Ah.lineEnd=hG},result:function(){var e=vT?[tL/vT,nL/vT]:Jx?[KI/Jx,QI/Jx]:yT?[JF/yT,eL/yT]:[NaN,NaN];return JF=eL=yT=KI=QI=Jx=tL=nL=vT=0,e}};function ab(e,n){JF+=e,eL+=n,++yT}function uG(){Ah.point=U_e}function U_e(e,n){Ah.point=j_e,ab(np=e,ip=n)}function j_e(e,n){var t=e-np,i=n-ip,r=jm(t*t+i*i);KI+=r*(np+e)/2,QI+=r*(ip+n)/2,Jx+=r,ab(np=e,ip=n)}function hG(){Ah.point=ab}function H_e(){Ah.point=G_e}function $_e(){fG(cG,dG)}function G_e(e,n){Ah.point=fG,ab(cG=np=e,dG=ip=n)}function fG(e,n){var t=e-np,i=n-ip,r=jm(t*t+i*i);KI+=r*(np+e)/2,QI+=r*(ip+n)/2,Jx+=r,tL+=(r=ip*e-np*n)*(np+e),nL+=r*(ip+n),vT+=3*r,ab(np=e,ip=n)}const pG=Ah;function mG(e){this._context=e}mG.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,n){switch(this._point){case 0:this._context.moveTo(e,n),this._point=1;break;case 1:this._context.lineTo(e,n);break;default:this._context.moveTo(e+this._radius,n),this._context.arc(e,n,this._radius,0,gu)}},result:_u};var rL,gG,_G,bT,xT,iL=new Um,JI={point:_u,lineStart:function(){JI.point=q_e},lineEnd:function(){rL&&yG(gG,_G),JI.point=_u},polygonStart:function(){rL=!0},polygonEnd:function(){rL=null},result:function(){var e=+iL;return iL=new Um,e}};function q_e(e,n){JI.point=yG,gG=bT=e,_G=xT=n}function yG(e,n){iL.add(jm((bT-=e)*bT+(xT-=n)*xT)),bT=e,xT=n}const vG=JI;let bG,ek,xG,wG;class CG{constructor(n){this._append=null==n?TG:function W_e(e){const n=Math.floor(e);if(!(n>=0))throw new RangeError(`invalid digits: ${e}`);if(n>15)return TG;if(n!==bG){const t=10**n;bG=n,ek=function(r){let a=1;this._+=r[0];for(const h=r.length;a<h;++a)this._+=Math.round(arguments[a]*t)/t+r[a]}}return ek}(n),this._radius=4.5,this._=""}pointRadius(n){return this._radius=+n,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(n,t){switch(this._point){case 0:this._append`M${n},${t}`,this._point=1;break;case 1:this._append`L${n},${t}`;break;default:if(this._append`M${n},${t}`,this._radius!==xG||this._append!==ek){const i=this._radius,r=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,xG=i,ek=this._append,wG=this._,this._=r}this._+=wG}}result(){const n=this._;return this._="",n.length?n:null}}function TG(e){let n=1;this._+=e[0];for(const t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function MG(){var n,e=[];return{point:function(t,i,r){n.push([t,i,r])},lineStart:function(){e.push(n=[])},lineEnd:_u,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var t=e;return e=[],n=null,t}}}function tk(e,n){return Uo(e[0]-n[0])<Ir&&Uo(e[1]-n[1])<Ir}function nk(e,n,t,i){this.x=e,this.z=n,this.o=t,this.e=i,this.v=!1,this.n=this.p=null}function SG(e,n,t,i,r){var v,C,a=[],h=[];if(e.forEach(function(oe){if(!((he=oe.length-1)<=0)){var he,Se,se=oe[0],_e=oe[he];if(tk(se,_e)){if(!se[2]&&!_e[2]){for(r.lineStart(),v=0;v<he;++v)r.point((se=oe[v])[0],se[1]);return void r.lineEnd()}_e[0]+=2*Ir}a.push(Se=new nk(se,oe,null,!0)),h.push(Se.o=new nk(se,null,Se,!1)),a.push(Se=new nk(_e,oe,null,!1)),h.push(Se.o=new nk(_e,null,Se,!0))}}),a.length){for(h.sort(n),EG(a),EG(h),v=0,C=h.length;v<C;++v)h[v].e=t=!t;for(var L,V,P=a[0];;){for(var W=P,X=!0;W.v;)if((W=W.n)===P)return;L=W.z,r.lineStart();do{if(W.v=W.o.v=!0,W.e){if(X)for(v=0,C=L.length;v<C;++v)r.point((V=L[v])[0],V[1]);else i(W.x,W.n.x,1,r);W=W.n}else{if(X)for(v=(L=W.p.z).length-1;v>=0;--v)r.point((V=L[v])[0],V[1]);else i(W.x,W.p.x,-1,r);W=W.p}L=(W=W.o).z,X=!X}while(!W.v);r.lineEnd()}}}function EG(e){if(n=e.length){for(var n,r,t=0,i=e[0];++t<n;)i.n=r=e[t],r.p=i,i=r;i.n=r=e[0],r.p=i}}function oL(e){return[Kx(e[1],e[0]),sb(e[2])]}function ew(e){var n=e[0],t=e[1],i=os(t);return[i*os(n),i*Co(n),Co(t)]}function ik(e,n){return e[0]*n[0]+e[1]*n[1]+e[2]*n[2]}function rk(e,n){return[e[1]*n[2]-e[2]*n[1],e[2]*n[0]-e[0]*n[2],e[0]*n[1]-e[1]*n[0]]}function sL(e,n){e[0]+=n[0],e[1]+=n[1],e[2]+=n[2]}function ok(e,n){return[e[0]*n,e[1]*n,e[2]*n]}function aL(e){var n=jm(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=n,e[1]/=n,e[2]/=n}function lL(e){return Uo(e[0])<=kr?e[0]:WI(e[0])*((Uo(e[0])+kr)%gu-kr)}function DG(e){return Array.from(function*X_e(e){for(const n of e)yield*n}(e))}function IG(e,n,t,i){return function(r){var P,L,V,a=n(r),h=MG(),v=n(h),C=!1,W={point:X,lineStart:he,lineEnd:se,polygonStart:function(){W.point=_e,W.lineStart=Se,W.lineEnd=$e,L=[],P=[]},polygonEnd:function(){W.point=X,W.lineStart=he,W.lineEnd=se,L=DG(L);var et=function Y_e(e,n){var t=lL(n),i=n[1],r=Co(i),a=[Co(t),-os(t),0],h=0,v=0,C=new Um;1===r?i=mu+Ir:-1===r&&(i=-mu-Ir);for(var P=0,L=e.length;P<L;++P)if(W=(V=e[P]).length)for(var V,W,X=V[W-1],oe=lL(X),he=X[1]/2+rG,se=Co(he),_e=os(he),Se=0;Se<W;++Se,oe=et,se=mt,_e=qt,X=$e){var $e=V[Se],et=lL($e),ut=$e[1]/2+rG,mt=Co(ut),qt=os(ut),tn=et-oe,Rn=tn>=0?1:-1,Pn=Rn*tn,Kt=Pn>kr,Mi=se*mt;if(C.add(Kx(Mi*Rn*Co(Pn),_e*qt+Mi*os(Pn))),h+=Kt?tn+Rn*gu:tn,Kt^oe>=t^et>=t){var Bn=rk(ew(X),ew($e));aL(Bn);var at=rk(a,Bn);aL(at);var ft=(Kt^tn>=0?-1:1)*sb(at[2]);(i>ft||i===ft&&(Bn[0]||Bn[1]))&&(v+=Kt^tn>=0?1:-1)}}return(h<-Ir||h<Ir&&C<-1e-12)^1&v}(P,i);L.length?(C||(r.polygonStart(),C=!0),SG(L,Q_e,et,t,r)):et&&(C||(r.polygonStart(),C=!0),r.lineStart(),t(null,null,1,r),r.lineEnd()),C&&(r.polygonEnd(),C=!1),L=P=null},sphere:function(){r.polygonStart(),r.lineStart(),t(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function X(et,ut){e(et,ut)&&r.point(et,ut)}function oe(et,ut){a.point(et,ut)}function he(){W.point=oe,a.lineStart()}function se(){W.point=X,a.lineEnd()}function _e(et,ut){V.push([et,ut]),v.point(et,ut)}function Se(){v.lineStart(),V=[]}function $e(){_e(V[0][0],V[0][1]),v.lineEnd();var mt,tn,Rn,Pn,et=v.clean(),ut=h.result(),qt=ut.length;if(V.pop(),P.push(V),V=null,qt){if(1&et){if((tn=(Rn=ut[0]).length-1)>0){for(C||(r.polygonStart(),C=!0),r.lineStart(),mt=0;mt<tn;++mt)r.point((Pn=Rn[mt])[0],Pn[1]);r.lineEnd()}return}qt>1&&2&et&&ut.push(ut.pop().concat(ut.shift())),L.push(ut.filter(K_e))}}return W}}function K_e(e){return e.length>1}function Q_e(e,n){return((e=e.x)[0]<0?e[1]-mu-Ir:mu-e[1])-((n=n.x)[0]<0?n[1]-mu-Ir:mu-n[1])}const kG=IG(function(){return!0},function J_e(e){var r,n=NaN,t=NaN,i=NaN;return{lineStart:function(){e.lineStart(),r=1},point:function(a,h){var v=a>0?kr:-kr,C=Uo(a-n);Uo(C-kr)<Ir?(e.point(n,t=(t+h)/2>0?mu:-mu),e.point(i,t),e.lineEnd(),e.lineStart(),e.point(v,t),e.point(a,t),r=0):i!==v&&C>=kr&&(Uo(n-i)<Ir&&(n-=i*Ir),Uo(a-v)<Ir&&(a-=v*Ir),t=function eye(e,n,t,i){var r,a,h=Co(e-t);return Uo(h)>Ir?O_e((Co(n)*(a=os(i))*Co(t)-Co(i)*(r=os(n))*Co(e))/(r*a*h)):(n+i)/2}(n,t,a,h),e.point(i,t),e.lineEnd(),e.lineStart(),e.point(v,t),r=0),e.point(n=a,t=h),i=v},lineEnd:function(){e.lineEnd(),n=t=NaN},clean:function(){return 2-r}}},function tye(e,n,t,i){var r;if(null==e)i.point(-kr,r=t*mu),i.point(0,r),i.point(kr,r),i.point(kr,0),i.point(kr,-r),i.point(0,-r),i.point(-kr,-r),i.point(-kr,0),i.point(-kr,r);else if(Uo(e[0]-n[0])>Ir){var a=e[0]<n[0]?kr:-kr;i.point(-a,r=t*a/2),i.point(0,r),i.point(a,r)}else i.point(n[0],n[1])},[-kr,-mu]);function RG(e,n){(n=ew(n))[0]-=e,aL(n);var t=function F_e(e){return e>1?0:e<-1?kr:Math.acos(e)}(-n[1]);return((-n[2]<0?-t:t)+gu-Ir)%gu}var wT=1e9,sk=-wT;function cL(e,n){function t(i,r){return i=e(i,r),n(i[0],i[1])}return e.invert&&n.invert&&(t.invert=function(i,r){return(i=n.invert(i,r))&&e.invert(i[0],i[1])}),t}function dL(e,n){return Uo(e)>kr&&(e-=Math.round(e/gu)*gu),[e,n]}function OG(e){return function(n,t){return Uo(n+=e)>kr&&(n-=Math.round(n/gu)*gu),[n,t]}}function FG(e){var n=OG(e);return n.invert=OG(-e),n}function LG(e,n){var t=os(e),i=Co(e),r=os(n),a=Co(n);function h(v,C){var P=os(C),L=os(v)*P,V=Co(v)*P,W=Co(C),X=W*t+L*i;return[Kx(V*r-X*a,L*t-W*i),sb(X*r+V*a)]}return h.invert=function(v,C){var P=os(C),L=os(v)*P,V=Co(v)*P,W=Co(C),X=W*r-V*a;return[Kx(V*r+W*a,L*t+X*i),sb(X*t-L*i)]},h}function ak(e){return function(n){var t=new uL;for(var i in e)t[i]=e[i];return t.stream=n,t}}function uL(){}function hL(e,n,t){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),Xx(t,e.stream(XI)),n(XI.result()),null!=i&&e.clipExtent(i),e}function fL(e,n,t){return hL(e,function(i){var r=n[1][0]-n[0][0],a=n[1][1]-n[0][1],h=Math.min(r/(i[1][0]-i[0][0]),a/(i[1][1]-i[0][1])),v=+n[0][0]+(r-h*(i[1][0]+i[0][0]))/2,C=+n[0][1]+(a-h*(i[1][1]+i[0][1]))/2;e.scale(150*h).translate([v,C])},t)}function NG(e,n,t){return fL(e,[[0,0],n],t)}function zG(e,n,t){return hL(e,function(i){var r=+n,a=r/(i[1][0]-i[0][0]),h=(r-a*(i[1][0]+i[0][0]))/2,v=-a*i[0][1];e.scale(150*a).translate([h,v])},t)}function BG(e,n,t){return hL(e,function(i){var r=+n,a=r/(i[1][1]-i[0][1]),h=-a*i[0][0],v=(r-a*(i[1][1]+i[0][1]))/2;e.scale(150*a).translate([h,v])},t)}dL.invert=dL,uL.prototype={constructor:uL,point:function(e,n){this.stream.point(e,n)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var oye=os(30*ic);function UG(e,n){return+n?function aye(e,n){function t(i,r,a,h,v,C,P,L,V,W,X,oe,he,se){var _e=P-i,Se=L-r,$e=_e*_e+Se*Se;if($e>4*n&&he--){var et=h+W,ut=v+X,mt=C+oe,qt=jm(et*et+ut*ut+mt*mt),tn=sb(mt/=qt),Rn=Uo(Uo(mt)-1)<Ir||Uo(a-V)<Ir?(a+V)/2:Kx(ut,et),Pn=e(Rn,tn),Kt=Pn[0],Mi=Pn[1],Bn=Kt-i,at=Mi-r,ft=Se*Bn-_e*at;(ft*ft/$e>n||Uo((_e*Bn+Se*at)/$e-.5)>.3||h*W+v*X+C*oe<oye)&&(t(i,r,a,h,v,C,Kt,Mi,Rn,et/=qt,ut/=qt,mt,he,se),se.point(Kt,Mi),t(Kt,Mi,Rn,et,ut,mt,P,L,V,W,X,oe,he,se))}}return function(i){var r,a,h,v,C,P,L,V,W,X,oe,he,se={point:_e,lineStart:Se,lineEnd:et,polygonStart:function(){i.polygonStart(),se.lineStart=ut},polygonEnd:function(){i.polygonEnd(),se.lineStart=Se}};function _e(tn,Rn){tn=e(tn,Rn),i.point(tn[0],tn[1])}function Se(){V=NaN,se.point=$e,i.lineStart()}function $e(tn,Rn){var Pn=ew([tn,Rn]),Kt=e(tn,Rn);t(V,W,L,X,oe,he,V=Kt[0],W=Kt[1],L=tn,X=Pn[0],oe=Pn[1],he=Pn[2],16,i),i.point(V,W)}function et(){se.point=_e,i.lineEnd()}function ut(){Se(),se.point=mt,se.lineEnd=qt}function mt(tn,Rn){$e(r=tn,Rn),a=V,h=W,v=X,C=oe,P=he,se.point=$e}function qt(){t(V,W,L,X,oe,he,a,h,r,v,C,P,16,i),se.lineEnd=et,et()}return se}}(e,n):function sye(e){return ak({point:function(n,t){n=e(n,t),this.stream.point(n[0],n[1])}})}(e)}var lye=ak({point:function(e,n){this.stream.point(e*ic,n*ic)}});function jG(e,n,t,i,r,a){if(!a)return function dye(e,n,t,i,r){function a(h,v){return[n+e*(h*=i),t-e*(v*=r)]}return a.invert=function(h,v){return[(h-n)/e*i,(t-v)/e*r]},a}(e,n,t,i,r);var h=os(a),v=Co(a),C=h*e,P=v*e,L=h/e,V=v/e,W=(v*t-h*n)/e,X=(v*n+h*t)/e;function oe(he,se){return[C*(he*=i)-P*(se*=r)+n,t-P*he-C*se]}return oe.invert=function(he,se){return[i*(L*he-V*se+W),r*(X-V*he-L*se)]},oe}function HG(e){var n,L,_e,Se,$e,mt,qt,tn,Rn,Pn,t=150,i=480,r=250,a=0,h=0,v=0,C=0,P=0,V=0,W=1,X=1,oe=null,he=kG,se=null,et=WF,ut=.5;function Kt(ft){return tn(ft[0]*ic,ft[1]*ic)}function Mi(ft){return(ft=tn.invert(ft[0],ft[1]))&&[ft[0]*kh,ft[1]*kh]}function Bn(){var ft=jG(t,0,0,W,X,V).apply(null,n(a,h)),Qe=jG(t,i-ft[0],r-ft[1],W,X,V);return L=function PG(e,n,t){return(e%=gu)?n||t?cL(FG(e),LG(n,t)):FG(e):n||t?LG(n,t):dL}(v,C,P),qt=cL(n,Qe),tn=cL(L,qt),mt=UG(qt,ut),at()}function at(){return Rn=Pn=null,Kt}return Kt.stream=function(ft){return Rn&&Pn===ft?Rn:Rn=lye(function cye(e){return ak({point:function(n,t){var i=e(n,t);return this.stream.point(i[0],i[1])}})}(L)(he(mt(et(Pn=ft)))))},Kt.preclip=function(ft){return arguments.length?(he=ft,oe=void 0,at()):he},Kt.postclip=function(ft){return arguments.length?(et=ft,se=_e=Se=$e=null,at()):et},Kt.clipAngle=function(ft){return arguments.length?(he=+ft?function nye(e){var n=os(e),t=2*ic,i=n>0,r=Uo(n)>Ir;function h(L,V){return os(L)*os(V)>n}function C(L,V,W){var he=[1,0,0],se=rk(ew(L),ew(V)),_e=ik(se,se),Se=se[0],$e=_e-Se*Se;if(!$e)return!W&&L;var et=n*_e/$e,ut=-n*Se/$e,mt=rk(he,se),qt=ok(he,et);sL(qt,ok(se,ut));var Rn=mt,Pn=ik(qt,Rn),Kt=ik(Rn,Rn),Mi=Pn*Pn-Kt*(ik(qt,qt)-1);if(!(Mi<0)){var Bn=jm(Mi),at=ok(Rn,(-Pn-Bn)/Kt);if(sL(at,qt),at=oL(at),!W)return at;var Wt,ft=L[0],Qe=V[0],vt=L[1],Ut=V[1];Qe<ft&&(Wt=ft,ft=Qe,Qe=Wt);var pn=Qe-ft,kn=Uo(pn-kr)<Ir;if(!kn&&Ut<vt&&(Wt=vt,vt=Ut,Ut=Wt),kn||pn<Ir?kn?vt+Ut>0^at[1]<(Uo(at[0]-ft)<Ir?vt:Ut):vt<=at[1]&&at[1]<=Ut:pn>kr^(ft<=at[0]&&at[0]<=Qe)){var Ar=ok(Rn,(-Pn+Bn)/Kt);return sL(Ar,qt),[at,oL(Ar)]}}}function P(L,V){var W=i?e:kr-e,X=0;return L<-W?X|=1:L>W&&(X|=2),V<-W?X|=4:V>W&&(X|=8),X}return IG(h,function v(L){var V,W,X,oe,he;return{lineStart:function(){oe=X=!1,he=1},point:function(se,_e){var $e,Se=[se,_e],et=h(se,_e),ut=i?et?0:P(se,_e):et?P(se+(se<0?kr:-kr),_e):0;if(!V&&(oe=X=et)&&L.lineStart(),et!==X&&(!($e=C(V,Se))||tk(V,$e)||tk(Se,$e))&&(Se[2]=1),et!==X)he=0,et?(L.lineStart(),$e=C(Se,V),L.point($e[0],$e[1])):($e=C(V,Se),L.point($e[0],$e[1],2),L.lineEnd()),V=$e;else if(r&&V&&i^et){var mt;!(ut&W)&&(mt=C(Se,V,!0))&&(he=0,i?(L.lineStart(),L.point(mt[0][0],mt[0][1]),L.point(mt[1][0],mt[1][1]),L.lineEnd()):(L.point(mt[1][0],mt[1][1]),L.lineEnd(),L.lineStart(),L.point(mt[0][0],mt[0][1],3)))}et&&(!V||!tk(V,Se))&&L.point(Se[0],Se[1]),V=Se,X=et,W=ut},lineEnd:function(){X&&L.lineEnd(),V=null},clean:function(){return he|(oe&&X)<<1}}},function a(L,V,W,X){!function AG(e,n,t,i,r,a){if(t){var h=os(n),v=Co(n),C=i*t;null==r?(r=n+i*gu,a=n-C/2):(r=RG(h,r),a=RG(h,a),(i>0?r<a:r>a)&&(r+=i*gu));for(var P,L=r;i>0?L>a:L<a;L-=C)P=oL([h,-v*os(L),-v*Co(L)]),e.point(P[0],P[1])}}(X,e,t,W,L,V)},i?[0,-e]:[-kr,e-kr])}(oe=ft*ic):(oe=null,kG),at()):oe*kh},Kt.clipExtent=function(ft){return arguments.length?(et=null==ft?(se=_e=Se=$e=null,WF):function rye(e,n,t,i){function r(P,L){return e<=P&&P<=t&&n<=L&&L<=i}function a(P,L,V,W){var X=0,oe=0;if(null==P||(X=h(P,V))!==(oe=h(L,V))||C(P,L)<0^V>0)do{W.point(0===X||3===X?e:t,X>1?i:n)}while((X=(X+V+4)%4)!==oe);else W.point(L[0],L[1])}function h(P,L){return Uo(P[0]-e)<Ir?L>0?0:3:Uo(P[0]-t)<Ir?L>0?2:1:Uo(P[1]-n)<Ir?L>0?1:0:L>0?3:2}function v(P,L){return C(P.x,L.x)}function C(P,L){var V=h(P,1),W=h(L,1);return V!==W?V-W:0===V?L[1]-P[1]:1===V?P[0]-L[0]:2===V?P[1]-L[1]:L[0]-P[0]}return function(P){var W,X,oe,he,se,_e,Se,$e,et,ut,mt,L=P,V=MG(),qt={point:tn,lineStart:function Mi(){qt.point=at,X&&X.push(oe=[]),ut=!0,et=!1,Se=$e=NaN},lineEnd:function Bn(){W&&(at(he,se),_e&&et&&V.rejoin(),W.push(V.result())),qt.point=tn,et&&L.lineEnd()},polygonStart:function Pn(){L=V,W=[],X=[],mt=!0},polygonEnd:function Kt(){var ft=function Rn(){for(var ft=0,Qe=0,vt=X.length;Qe<vt;++Qe)for(var Vn,Ar,Ut=X[Qe],Wt=1,pn=Ut.length,kn=Ut[0],bi=kn[0],fo=kn[1];Wt<pn;++Wt)Vn=bi,Ar=fo,bi=(kn=Ut[Wt])[0],fo=kn[1],Ar<=i?fo>i&&(bi-Vn)*(i-Ar)>(fo-Ar)*(e-Vn)&&++ft:fo<=i&&(bi-Vn)*(i-Ar)<(fo-Ar)*(e-Vn)&&--ft;return ft}(),Qe=mt&&ft,vt=(W=DG(W)).length;(Qe||vt)&&(P.polygonStart(),Qe&&(P.lineStart(),a(null,null,1,P),P.lineEnd()),vt&&SG(W,v,ft,a,P),P.polygonEnd()),L=P,W=X=oe=null}};function tn(ft,Qe){r(ft,Qe)&&L.point(ft,Qe)}function at(ft,Qe){var vt=r(ft,Qe);if(X&&oe.push([ft,Qe]),ut)he=ft,se=Qe,_e=vt,ut=!1,vt&&(L.lineStart(),L.point(ft,Qe));else if(vt&&et)L.point(ft,Qe);else{var Ut=[Se=Math.max(sk,Math.min(wT,Se)),$e=Math.max(sk,Math.min(wT,$e))],Wt=[ft=Math.max(sk,Math.min(wT,ft)),Qe=Math.max(sk,Math.min(wT,Qe))];!function iye(e,n,t,i,r,a){var oe,h=e[0],v=e[1],L=0,V=1,W=n[0]-h,X=n[1]-v;if(oe=t-h,W||!(oe>0)){if(oe/=W,W<0){if(oe<L)return;oe<V&&(V=oe)}else if(W>0){if(oe>V)return;oe>L&&(L=oe)}if(oe=r-h,W||!(oe<0)){if(oe/=W,W<0){if(oe>V)return;oe>L&&(L=oe)}else if(W>0){if(oe<L)return;oe<V&&(V=oe)}if(oe=i-v,X||!(oe>0)){if(oe/=X,X<0){if(oe<L)return;oe<V&&(V=oe)}else if(X>0){if(oe>V)return;oe>L&&(L=oe)}if(oe=a-v,X||!(oe<0)){if(oe/=X,X<0){if(oe>V)return;oe>L&&(L=oe)}else if(X>0){if(oe<L)return;oe<V&&(V=oe)}return L>0&&(e[0]=h+L*W,e[1]=v+L*X),V<1&&(n[0]=h+V*W,n[1]=v+V*X),!0}}}}}(Ut,Wt,e,n,t,i)?vt&&(L.lineStart(),L.point(ft,Qe),mt=!1):(et||(L.lineStart(),L.point(Ut[0],Ut[1])),L.point(Wt[0],Wt[1]),vt||L.lineEnd(),mt=!1)}Se=ft,$e=Qe,et=vt}return qt}}(se=+ft[0][0],_e=+ft[0][1],Se=+ft[1][0],$e=+ft[1][1]),at()):null==se?null:[[se,_e],[Se,$e]]},Kt.scale=function(ft){return arguments.length?(t=+ft,Bn()):t},Kt.translate=function(ft){return arguments.length?(i=+ft[0],r=+ft[1],Bn()):[i,r]},Kt.center=function(ft){return arguments.length?(a=ft[0]%360*ic,h=ft[1]%360*ic,Bn()):[a*kh,h*kh]},Kt.rotate=function(ft){return arguments.length?(v=ft[0]%360*ic,C=ft[1]%360*ic,P=ft.length>2?ft[2]%360*ic:0,Bn()):[v*kh,C*kh,P*kh]},Kt.angle=function(ft){return arguments.length?(V=ft%360*ic,Bn()):V*kh},Kt.reflectX=function(ft){return arguments.length?(W=ft?-1:1,Bn()):W<0},Kt.reflectY=function(ft){return arguments.length?(X=ft?-1:1,Bn()):X<0},Kt.precision=function(ft){return arguments.length?(mt=UG(qt,ut=ft*ft),at()):jm(ut)},Kt.fitExtent=function(ft,Qe){return fL(Kt,ft,Qe)},Kt.fitSize=function(ft,Qe){return NG(Kt,ft,Qe)},Kt.fitWidth=function(ft,Qe){return zG(Kt,ft,Qe)},Kt.fitHeight=function(ft,Qe){return BG(Kt,ft,Qe)},function(){return n=e.apply(this,arguments),Kt.invert=n.invert&&Mi,Bn()}}function fye(e,n){var t=Co(e),i=(t+Co(n))/2;if(Uo(i)<Ir)return function hye(e){var n=os(e);function t(i,r){return[i*n,Co(r)/n]}return t.invert=function(i,r){return[i/n,sb(r*n)]},t}(e);var r=1+t*(2*i-t),a=jm(r)/i;function h(v,C){var P=jm(r-2*i*Co(C))/i;return[P*Co(v*=i),a-P*os(v)]}return h.invert=function(v,C){var P=a-C,L=Kx(v,Uo(P))*WI(P);return P*i<0&&(L-=kr*WI(v)*WI(P)),[L/i,sb((r-(v*v+P*P)*i*i)/(2*i))]},h}function pL(){return function uye(e){var n=0,t=kr/3,i=HG(e),r=i(n,t);return r.parallels=function(a){return arguments.length?i(n=a[0]*ic,t=a[1]*ic):[n*kh,t*kh]},r}(fye).scale(155.424).center([0,33.6442])}function lk(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e)}return this}const $G=Symbol("implicit");function GG(){var e=new CF,n=[],t=[],i=$G;function r(a){let h=e.get(a);if(void 0===h){if(i!==$G)return i;e.set(a,h=n.push(a)-1)}return t[h%t.length]}return r.domain=function(a){if(!arguments.length)return n.slice();n=[],e=new CF;for(const h of a)e.has(h)||e.set(h,n.push(h)-1);return r},r.range=function(a){return arguments.length?(t=Array.from(a),r):t.slice()},r.unknown=function(a){return arguments.length?(i=a,r):i},r.copy=function(){return GG(n,t).unknown(i)},lk.apply(r,arguments),r}function mL(){var a,h,e=GG().unknown(void 0),n=e.domain,t=e.range,i=0,r=1,v=!1,C=0,P=0,L=.5;function V(){var W=n().length,X=r<i,oe=X?r:i,he=X?i:r;a=(he-oe)/Math.max(1,W-C+2*P),v&&(a=Math.floor(a)),oe+=(he-oe-a*(W-C))*L,h=a*(1-C),v&&(oe=Math.round(oe),h=Math.round(h));var se=function _ye(e,n,t){e=+e,n=+n,t=(r=arguments.length)<2?(n=e,e=0,1):r<3?1:+t;for(var i=-1,r=0|Math.max(0,Math.ceil((n-e)/t)),a=new Array(r);++i<r;)a[i]=e+i*t;return a}(W).map(function(_e){return oe+a*_e});return t(X?se.reverse():se)}return delete e.unknown,e.domain=function(W){return arguments.length?(n(W),V()):n()},e.range=function(W){return arguments.length?([i,r]=W,i=+i,r=+r,V()):[i,r]},e.rangeRound=function(W){return[i,r]=W,i=+i,r=+r,v=!0,V()},e.bandwidth=function(){return h},e.step=function(){return a},e.round=function(W){return arguments.length?(v=!!W,V()):v},e.padding=function(W){return arguments.length?(C=Math.min(1,P=+W),V()):C},e.paddingInner=function(W){return arguments.length?(C=Math.min(1,W),V()):C},e.paddingOuter=function(W){return arguments.length?(P=+W,V()):P},e.align=function(W){return arguments.length?(L=Math.max(0,Math.min(1,W)),V()):L},e.copy=function(){return mL(n(),[i,r]).round(v).paddingInner(C).paddingOuter(P).align(L)},lk.apply(V(),arguments)}const yye=Math.sqrt(50),vye=Math.sqrt(10),bye=Math.sqrt(2);function ck(e,n,t){const i=(n-e)/Math.max(0,t),r=Math.floor(Math.log10(i)),a=i/Math.pow(10,r),h=a>=yye?10:a>=vye?5:a>=bye?2:1;let v,C,P;return r<0?(P=Math.pow(10,-r)/h,v=Math.round(e*P),C=Math.round(n*P),v/P<e&&++v,C/P>n&&--C,P=-P):(P=Math.pow(10,r)*h,v=Math.round(e/P),C=Math.round(n/P),v*P<e&&++v,C*P>n&&--C),C<v&&.5<=t&&t<2?ck(e,n,2*t):[v,C,P]}function gL(e,n,t){return ck(e=+e,n=+n,t=+t)[2]}function _L(e,n,t){t=+t;const i=(n=+n)<(e=+e),r=i?gL(n,e,t):gL(e,n,t);return(i?-1:1)*(r<0?1/-r:r)}function dk(e,n){return null==e||null==n?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function wye(e,n){return null==e||null==n?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function yL(e){let n,t,i;function r(v,C,P=0,L=v.length){if(P<L){if(0!==n(C,C))return L;do{const V=P+L>>>1;t(v[V],C)<0?P=V+1:L=V}while(P<L)}return P}return 2!==e.length?(n=dk,t=(v,C)=>dk(e(v),C),i=(v,C)=>e(v)-C):(n=e===dk||e===wye?e:Cye,t=e,i=e),{left:r,center:function h(v,C,P=0,L=v.length){const V=r(v,C,P,L-1);return V>P&&i(v[V-1],C)>-i(v[V],C)?V-1:V},right:function a(v,C,P=0,L=v.length){if(P<L){if(0!==n(C,C))return L;do{const V=P+L>>>1;t(v[V],C)<=0?P=V+1:L=V}while(P<L)}return P}}}function Cye(){return 0}const Mye=yL(dk).right,Sye=(yL(function Tye(e){return null===e?NaN:+e}),Mye);function ZG(e,n){var h,t=n?n.length:0,i=e?Math.min(t,e.length):0,r=new Array(i),a=new Array(t);for(h=0;h<i;++h)r[h]=vL(e[h],n[h]);for(;h<t;++h)a[h]=n[h];return function(v){for(h=0;h<i;++h)a[h]=r[h](v);return a}}function Eye(e,n){var t=new Date;return e=+e,n=+n,function(i){return t.setTime(e*(1-i)+n*i),t}}function Dye(e,n){var r,t={},i={};for(r in(null===e||"object"!=typeof e)&&(e={}),(null===n||"object"!=typeof n)&&(n={}),n)r in e?t[r]=vL(e[r],n[r]):i[r]=n[r];return function(a){for(r in t)i[r]=t[r](a);return i}}function Iye(e,n){n||(n=[]);var r,t=e?Math.min(n.length,e.length):0,i=n.slice();return function(a){for(r=0;r<t;++r)i[r]=e[r]*(1-a)+n[r]*a;return i}}function vL(e,n){var i,t=typeof n;return null==n||"boolean"===t?VF(n):("number"===t?Dh:"string"===t?(i=ib(n))?(n=i,HI):q$:n instanceof ib?HI:n instanceof Date?Eye:function kye(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(n)?Iye:Array.isArray(n)?ZG:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?Dye:Dh)(e,n)}function Aye(e,n){return e=+e,n=+n,function(t){return Math.round(e*(1-t)+n*t)}}function Pye(e){return+e}var YG=[0,1];function tw(e){return e}function bL(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:function Rye(e){return function(){return e}}(isNaN(n)?NaN:.5)}function Fye(e,n,t){var i=e[0],r=e[1],a=n[0],h=n[1];return r<i?(i=bL(r,i),a=t(h,a)):(i=bL(i,r),a=t(a,h)),function(v){return a(i(v))}}function Lye(e,n,t){var i=Math.min(e.length,n.length)-1,r=new Array(i),a=new Array(i),h=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++h<i;)r[h]=bL(e[h],e[h+1]),a[h]=t(n[h],n[h+1]);return function(v){var C=Sye(e,v,1,i)-1;return a[C](r[C](v))}}function XG(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function KG(){return function Nye(){var i,r,a,v,C,P,e=YG,n=YG,t=vL,h=tw;function L(){var W=Math.min(e.length,n.length);return h!==tw&&(h=function Oye(e,n){var t;return e>n&&(t=e,e=n,n=t),function(i){return Math.max(e,Math.min(n,i))}}(e[0],e[W-1])),v=W>2?Lye:Fye,C=P=null,V}function V(W){return null==W||isNaN(W=+W)?a:(C||(C=v(e.map(i),n,t)))(i(h(W)))}return V.invert=function(W){return h(r((P||(P=v(n,e.map(i),Dh)))(W)))},V.domain=function(W){return arguments.length?(e=Array.from(W,Pye),L()):e.slice()},V.range=function(W){return arguments.length?(n=Array.from(W),L()):n.slice()},V.rangeRound=function(W){return n=Array.from(W),t=Aye,L()},V.clamp=function(W){return arguments.length?(h=!!W||tw,L()):h!==tw},V.interpolate=function(W){return arguments.length?(t=W,L()):t},V.unknown=function(W){return arguments.length?(a=W,V):a},function(W,X){return i=W,r=X,L()}}()(tw,tw)}var QG,zye=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function uk(e){if(!(n=zye.exec(e)))throw new Error("invalid format: "+e);var n;return new xL({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function xL(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function hk(e,n){if((t=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var t,i=e.slice(0,t);return[i.length>1?i[0]+i.slice(2):i,+e.slice(t+1)]}function nw(e){return(e=hk(Math.abs(e)))?e[1]:NaN}function JG(e,n){var t=hk(e,n);if(!t)return e+"";var i=t[0],r=t[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}uk.prototype=xL.prototype,xL.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const eq={"%":(e,n)=>(100*e).toFixed(n),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function Bye(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,n)=>e.toExponential(n),f:(e,n)=>e.toFixed(n),g:(e,n)=>e.toPrecision(n),o:e=>Math.round(e).toString(8),p:(e,n)=>JG(100*e,n),r:JG,s:function $ye(e,n){var t=hk(e,n);if(!t)return e+"";var i=t[0],r=t[1],a=r-(QG=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,h=i.length;return a===h?i:a>h?i+new Array(a-h+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+hk(e,Math.max(0,n+a-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function tq(e){return e}var fk,rq,oq,nq=Array.prototype.map,iq=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Xye(e){var n=e.domain;return e.ticks=function(t){var i=n();return function xye(e,n,t){if(!((t=+t)>0))return[];if((e=+e)==(n=+n))return[e];const i=n<e,[r,a,h]=i?ck(n,e,t):ck(e,n,t);if(!(a>=r))return[];const v=a-r+1,C=new Array(v);if(i)if(h<0)for(let P=0;P<v;++P)C[P]=(a-P)/-h;else for(let P=0;P<v;++P)C[P]=(a-P)*h;else if(h<0)for(let P=0;P<v;++P)C[P]=(r+P)/-h;else for(let P=0;P<v;++P)C[P]=(r+P)*h;return C}(i[0],i[i.length-1],t??10)},e.tickFormat=function(t,i){var r=n();return function Yye(e,n,t,i){var a,r=_L(e,n,t);switch((i=uk(i??",f")).type){case"s":var h=Math.max(Math.abs(e),Math.abs(n));return null==i.precision&&!isNaN(a=function Vye(e,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(nw(n)/3)))-nw(Math.abs(e)))}(r,h))&&(i.precision=a),oq(i,h);case"":case"e":case"g":case"p":case"r":null==i.precision&&!isNaN(a=function Wye(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,nw(n)-nw(e))+1}(r,Math.max(Math.abs(e),Math.abs(n))))&&(i.precision=a-("e"===i.type));break;case"f":case"%":null==i.precision&&!isNaN(a=function Zye(e){return Math.max(0,-nw(Math.abs(e)))}(r))&&(i.precision=a-2*("%"===i.type))}return rq(i)}(r[0],r[r.length-1],t??10,i)},e.nice=function(t){null==t&&(t=10);var C,P,i=n(),r=0,a=i.length-1,h=i[r],v=i[a],L=10;for(v<h&&(P=h,h=v,v=P,P=r,r=a,a=P);L-- >0;){if((P=gL(h,v,t))===C)return i[r]=h,i[a]=v,n(i);if(P>0)h=Math.floor(h/P)*P,v=Math.ceil(v/P)*P;else{if(!(P<0))break;h=Math.ceil(h*P)/P,v=Math.floor(v*P)/P}C=P}return e},e}function pk(){var e=KG();return e.copy=function(){return XG(e,pk())},lk.apply(e,arguments),Xye(e)}!function qye(e){fk=function Gye(e){var n=void 0===e.grouping||void 0===e.thousands?tq:function Uye(e,n){return function(t,i){for(var r=t.length,a=[],h=0,v=e[0],C=0;r>0&&v>0&&(C+v+1>i&&(v=Math.max(1,i-C)),a.push(t.substring(r-=v,r+v)),!((C+=v+1)>i));)v=e[h=(h+1)%e.length];return a.reverse().join(n)}}(nq.call(e.grouping,Number),e.thousands+""),t=void 0===e.currency?"":e.currency[0]+"",i=void 0===e.currency?"":e.currency[1]+"",r=void 0===e.decimal?".":e.decimal+"",a=void 0===e.numerals?tq:function jye(e){return function(n){return n.replace(/[0-9]/g,function(t){return e[+t]})}}(nq.call(e.numerals,String)),h=void 0===e.percent?"%":e.percent+"",v=void 0===e.minus?"\u2212":e.minus+"",C=void 0===e.nan?"NaN":e.nan+"";function P(V){var W=(V=uk(V)).fill,X=V.align,oe=V.sign,he=V.symbol,se=V.zero,_e=V.width,Se=V.comma,$e=V.precision,et=V.trim,ut=V.type;"n"===ut?(Se=!0,ut="g"):eq[ut]||(void 0===$e&&($e=12),et=!0,ut="g"),(se||"0"===W&&"="===X)&&(se=!0,W="0",X="=");var mt="$"===he?t:"#"===he&&/[boxX]/.test(ut)?"0"+ut.toLowerCase():"",qt="$"===he?i:/[%p]/.test(ut)?h:"",tn=eq[ut],Rn=/[defgprs%]/.test(ut);function Pn(Kt){var at,ft,Qe,Mi=mt,Bn=qt;if("c"===ut)Bn=tn(Kt)+Bn,Kt="";else{var vt=(Kt=+Kt)<0||1/Kt<0;if(Kt=isNaN(Kt)?C:tn(Math.abs(Kt),$e),et&&(Kt=function Hye(e){e:for(var r,n=e.length,t=1,i=-1;t<n;++t)switch(e[t]){case".":i=r=t;break;case"0":0===i&&(i=t),r=t;break;default:if(!+e[t])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(r+1):e}(Kt)),vt&&0==+Kt&&"+"!==oe&&(vt=!1),Mi=(vt?"("===oe?oe:v:"-"===oe||"("===oe?"":oe)+Mi,Bn=("s"===ut?iq[8+QG/3]:"")+Bn+(vt&&"("===oe?")":""),Rn)for(at=-1,ft=Kt.length;++at<ft;)if(48>(Qe=Kt.charCodeAt(at))||Qe>57){Bn=(46===Qe?r+Kt.slice(at+1):Kt.slice(at))+Bn,Kt=Kt.slice(0,at);break}}Se&&!se&&(Kt=n(Kt,1/0));var Ut=Mi.length+Kt.length+Bn.length,Wt=Ut<_e?new Array(_e-Ut+1).join(W):"";switch(Se&&se&&(Kt=n(Wt+Kt,Wt.length?_e-Bn.length:1/0),Wt=""),X){case"<":Kt=Mi+Kt+Bn+Wt;break;case"=":Kt=Mi+Wt+Kt+Bn;break;case"^":Kt=Wt.slice(0,Ut=Wt.length>>1)+Mi+Kt+Bn+Wt.slice(Ut);break;default:Kt=Wt+Mi+Kt+Bn}return a(Kt)}return $e=void 0===$e?6:/[gprs]/.test(ut)?Math.max(1,Math.min(21,$e)):Math.max(0,Math.min(20,$e)),Pn.toString=function(){return V+""},Pn}return{format:P,formatPrefix:function L(V,W){var X=P(((V=uk(V)).type="f",V)),oe=3*Math.max(-8,Math.min(8,Math.floor(nw(W)/3))),he=Math.pow(10,-oe),se=iq[8+oe/3];return function(_e){return X(he*_e)+se}}}}(e),rq=fk.format,oq=fk.formatPrefix}({thousands:",",grouping:[3],currency:["$",""]});const Hm=1e3,yu=6e4,$m=60*yu,Gm=24*$m,wL=7*Gm,sq=30*Gm,CL=365*Gm,TL=new Date,ML=new Date;function ma(e,n,t,i){function r(a){return e(a=0===arguments.length?new Date:new Date(+a)),a}return r.floor=a=>(e(a=new Date(+a)),a),r.ceil=a=>(e(a=new Date(a-1)),n(a,1),e(a),a),r.round=a=>{const h=r(a),v=r.ceil(a);return a-h<v-a?h:v},r.offset=(a,h)=>(n(a=new Date(+a),null==h?1:Math.floor(h)),a),r.range=(a,h,v)=>{const C=[];if(a=r.ceil(a),v=null==v?1:Math.floor(v),!(a<h&&v>0))return C;let P;do{C.push(P=new Date(+a)),n(a,v),e(a)}while(P<a&&a<h);return C},r.filter=a=>ma(h=>{if(h>=h)for(;e(h),!a(h);)h.setTime(h-1)},(h,v)=>{if(h>=h)if(v<0)for(;++v<=0;)for(;n(h,-1),!a(h););else for(;--v>=0;)for(;n(h,1),!a(h););}),t&&(r.count=(a,h)=>(TL.setTime(+a),ML.setTime(+h),e(TL),e(ML),Math.floor(t(TL,ML))),r.every=a=>(a=Math.floor(a),isFinite(a)&&a>0?a>1?r.filter(i?h=>i(h)%a==0:h=>r.count(0,h)%a==0):r:null)),r}const mk=ma(()=>{},(e,n)=>{e.setTime(+e+n)},(e,n)=>n-e);mk.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?ma(n=>{n.setTime(Math.floor(n/e)*e)},(n,t)=>{n.setTime(+n+t*e)},(n,t)=>(t-n)/e):mk:null);const iw=ma(e=>{e.setTime(e-e.getMilliseconds())},(e,n)=>{e.setTime(+e+n*Hm)},(e,n)=>(n-e)/Hm,e=>e.getUTCSeconds()),SL=ma(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hm)},(e,n)=>{e.setTime(+e+n*yu)},(e,n)=>(n-e)/yu,e=>e.getMinutes()),aq=ma(e=>{e.setUTCSeconds(0,0)},(e,n)=>{e.setTime(+e+n*yu)},(e,n)=>(n-e)/yu,e=>e.getUTCMinutes()),EL=ma(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hm-e.getMinutes()*yu)},(e,n)=>{e.setTime(+e+n*$m)},(e,n)=>(n-e)/$m,e=>e.getHours()),lq=ma(e=>{e.setUTCMinutes(0,0,0)},(e,n)=>{e.setTime(+e+n*$m)},(e,n)=>(n-e)/$m,e=>e.getUTCHours()),CT=ma(e=>e.setHours(0,0,0,0),(e,n)=>e.setDate(e.getDate()+n),(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*yu)/Gm,e=>e.getDate()-1),DL=ma(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/Gm,e=>e.getUTCDate()-1),cq=ma(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/Gm,e=>Math.floor(e/Gm));function lb(e){return ma(n=>{n.setDate(n.getDate()-(n.getDay()+7-e)%7),n.setHours(0,0,0,0)},(n,t)=>{n.setDate(n.getDate()+7*t)},(n,t)=>(t-n-(t.getTimezoneOffset()-n.getTimezoneOffset())*yu)/wL)}const gk=lb(0),_k=lb(1),rw=(lb(2),lb(3),lb(4));function cb(e){return ma(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7),n.setUTCHours(0,0,0,0)},(n,t)=>{n.setUTCDate(n.getUTCDate()+7*t)},(n,t)=>(t-n)/wL)}lb(5),lb(6);const IL=cb(0),yk=cb(1),ow=(cb(2),cb(3),cb(4)),kL=(cb(5),cb(6),ma(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,n)=>{e.setMonth(e.getMonth()+n)},(e,n)=>n.getMonth()-e.getMonth()+12*(n.getFullYear()-e.getFullYear()),e=>e.getMonth())),dq=ma(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCMonth(e.getUTCMonth()+n)},(e,n)=>n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth()),rp=ma(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n)},(e,n)=>n.getFullYear()-e.getFullYear(),e=>e.getFullYear());rp.every=e=>isFinite(e=Math.floor(e))&&e>0?ma(n=>{n.setFullYear(Math.floor(n.getFullYear()/e)*e),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,t)=>{n.setFullYear(n.getFullYear()+t*e)}):null;const N_=ma(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n)},(e,n)=>n.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());function uq(e,n,t,i,r,a){const h=[[iw,1,Hm],[iw,5,5e3],[iw,15,15e3],[iw,30,3e4],[a,1,yu],[a,5,5*yu],[a,15,15*yu],[a,30,30*yu],[r,1,$m],[r,3,3*$m],[r,6,6*$m],[r,12,12*$m],[i,1,Gm],[i,2,2*Gm],[t,1,wL],[n,1,sq],[n,3,3*sq],[e,1,CL]];function C(P,L,V){const W=Math.abs(L-P)/V,X=yL(([,,se])=>se).right(h,W);if(X===h.length)return e.every(_L(P/CL,L/CL,V));if(0===X)return mk.every(Math.max(_L(P,L,V),1));const[oe,he]=h[W/h[X-1][2]<h[X][2]/W?X-1:X];return oe.every(he)}return[function v(P,L,V){const W=L<P;W&&([P,L]=[L,P]);const X=V&&"function"==typeof V.range?V:C(P,L,V),oe=X?X.range(P,+L+1):[];return W?oe.reverse():oe},C]}N_.every=e=>isFinite(e=Math.floor(e))&&e>0?ma(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/e)*e),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,t)=>{n.setUTCFullYear(n.getUTCFullYear()+t*e)}):null;const[nOe,iOe]=uq(N_,dq,IL,cq,lq,aq),[ove,sve]=uq(rp,kL,gk,CT,EL,SL);function AL(e){if(0<=e.y&&e.y<100){var n=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return n.setFullYear(e.y),n}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function RL(e){if(0<=e.y&&e.y<100){var n=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return n.setUTCFullYear(e.y),n}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function TT(e,n,t){return{y:e,m:n,d:t,H:0,M:0,S:0,L:0}}var sw,PL,hq={"-":"",_:" ",0:"0"},Pa=/^\s*\d+/,lve=/^%/,cve=/[\\^$*+?|[\]().{}]/g;function $r(e,n,t){var i=e<0?"-":"",r=(i?-e:e)+"",a=r.length;return i+(a<t?new Array(t-a+1).join(n)+r:r)}function dve(e){return e.replace(cve,"\\$&")}function MT(e){return new RegExp("^(?:"+e.map(dve).join("|")+")","i")}function ST(e){return new Map(e.map((n,t)=>[n.toLowerCase(),t]))}function uve(e,n,t){var i=Pa.exec(n.slice(t,t+1));return i?(e.w=+i[0],t+i[0].length):-1}function hve(e,n,t){var i=Pa.exec(n.slice(t,t+1));return i?(e.u=+i[0],t+i[0].length):-1}function fve(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.U=+i[0],t+i[0].length):-1}function pve(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.V=+i[0],t+i[0].length):-1}function mve(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.W=+i[0],t+i[0].length):-1}function fq(e,n,t){var i=Pa.exec(n.slice(t,t+4));return i?(e.y=+i[0],t+i[0].length):-1}function pq(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),t+i[0].length):-1}function gve(e,n,t){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(t,t+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),t+i[0].length):-1}function _ve(e,n,t){var i=Pa.exec(n.slice(t,t+1));return i?(e.q=3*i[0]-3,t+i[0].length):-1}function yve(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.m=i[0]-1,t+i[0].length):-1}function mq(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.d=+i[0],t+i[0].length):-1}function vve(e,n,t){var i=Pa.exec(n.slice(t,t+3));return i?(e.m=0,e.d=+i[0],t+i[0].length):-1}function gq(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.H=+i[0],t+i[0].length):-1}function bve(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.M=+i[0],t+i[0].length):-1}function xve(e,n,t){var i=Pa.exec(n.slice(t,t+2));return i?(e.S=+i[0],t+i[0].length):-1}function wve(e,n,t){var i=Pa.exec(n.slice(t,t+3));return i?(e.L=+i[0],t+i[0].length):-1}function Cve(e,n,t){var i=Pa.exec(n.slice(t,t+6));return i?(e.L=Math.floor(i[0]/1e3),t+i[0].length):-1}function Tve(e,n,t){var i=lve.exec(n.slice(t,t+1));return i?t+i[0].length:-1}function Mve(e,n,t){var i=Pa.exec(n.slice(t));return i?(e.Q=+i[0],t+i[0].length):-1}function Sve(e,n,t){var i=Pa.exec(n.slice(t));return i?(e.s=+i[0],t+i[0].length):-1}function _q(e,n){return $r(e.getDate(),n,2)}function Eve(e,n){return $r(e.getHours(),n,2)}function Dve(e,n){return $r(e.getHours()%12||12,n,2)}function Ive(e,n){return $r(1+CT.count(rp(e),e),n,3)}function yq(e,n){return $r(e.getMilliseconds(),n,3)}function kve(e,n){return yq(e,n)+"000"}function Ave(e,n){return $r(e.getMonth()+1,n,2)}function Rve(e,n){return $r(e.getMinutes(),n,2)}function Pve(e,n){return $r(e.getSeconds(),n,2)}function Ove(e){var n=e.getDay();return 0===n?7:n}function Fve(e,n){return $r(gk.count(rp(e)-1,e),n,2)}function vq(e){var n=e.getDay();return n>=4||0===n?rw(e):rw.ceil(e)}function Lve(e,n){return e=vq(e),$r(rw.count(rp(e),e)+(4===rp(e).getDay()),n,2)}function Nve(e){return e.getDay()}function zve(e,n){return $r(_k.count(rp(e)-1,e),n,2)}function Bve(e,n){return $r(e.getFullYear()%100,n,2)}function Vve(e,n){return $r((e=vq(e)).getFullYear()%100,n,2)}function Uve(e,n){return $r(e.getFullYear()%1e4,n,4)}function jve(e,n){var t=e.getDay();return $r((e=t>=4||0===t?rw(e):rw.ceil(e)).getFullYear()%1e4,n,4)}function Hve(e){var n=e.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+$r(n/60|0,"0",2)+$r(n%60,"0",2)}function bq(e,n){return $r(e.getUTCDate(),n,2)}function $ve(e,n){return $r(e.getUTCHours(),n,2)}function Gve(e,n){return $r(e.getUTCHours()%12||12,n,2)}function qve(e,n){return $r(1+DL.count(N_(e),e),n,3)}function xq(e,n){return $r(e.getUTCMilliseconds(),n,3)}function Wve(e,n){return xq(e,n)+"000"}function Zve(e,n){return $r(e.getUTCMonth()+1,n,2)}function Yve(e,n){return $r(e.getUTCMinutes(),n,2)}function Xve(e,n){return $r(e.getUTCSeconds(),n,2)}function Kve(e){var n=e.getUTCDay();return 0===n?7:n}function Qve(e,n){return $r(IL.count(N_(e)-1,e),n,2)}function wq(e){var n=e.getUTCDay();return n>=4||0===n?ow(e):ow.ceil(e)}function Jve(e,n){return e=wq(e),$r(ow.count(N_(e),e)+(4===N_(e).getUTCDay()),n,2)}function ebe(e){return e.getUTCDay()}function tbe(e,n){return $r(yk.count(N_(e)-1,e),n,2)}function nbe(e,n){return $r(e.getUTCFullYear()%100,n,2)}function ibe(e,n){return $r((e=wq(e)).getUTCFullYear()%100,n,2)}function rbe(e,n){return $r(e.getUTCFullYear()%1e4,n,4)}function obe(e,n){var t=e.getUTCDay();return $r((e=t>=4||0===t?ow(e):ow.ceil(e)).getUTCFullYear()%1e4,n,4)}function sbe(){return"+0000"}function Cq(){return"%"}function Tq(e){return+e}function Mq(e){return Math.floor(+e/1e3)}function hbe(e){return new Date(e)}function fbe(e){return e instanceof Date?+e:+new Date(+e)}function Sq(e,n,t,i,r,a,h,v,C,P){var L=KG(),V=L.invert,W=L.domain,X=P(".%L"),oe=P(":%S"),he=P("%I:%M"),se=P("%I %p"),_e=P("%a %d"),Se=P("%b %d"),$e=P("%B"),et=P("%Y");function ut(mt){return(C(mt)<mt?X:v(mt)<mt?oe:h(mt)<mt?he:a(mt)<mt?se:i(mt)<mt?r(mt)<mt?_e:Se:t(mt)<mt?$e:et)(mt)}return L.invert=function(mt){return new Date(V(mt))},L.domain=function(mt){return arguments.length?W(Array.from(mt,fbe)):W().map(hbe)},L.ticks=function(mt){var qt=W();return e(qt[0],qt[qt.length-1],mt??10)},L.tickFormat=function(mt,qt){return null==qt?ut:P(qt)},L.nice=function(mt){var qt=W();return(!mt||"function"!=typeof mt.range)&&(mt=n(qt[0],qt[qt.length-1],mt??10)),mt?W(function ube(e,n){var h,t=0,i=(e=e.slice()).length-1,r=e[t],a=e[i];return a<r&&(h=t,t=i,i=h,h=r,r=a,a=h),e[t]=n.floor(r),e[i]=n.ceil(a),e}(qt,mt)):L},L.copy=function(){return XG(L,Sq(e,n,t,i,r,a,h,v,C,P))},L}function Eq(){return lk.apply(Sq(ove,sve,rp,kL,gk,CT,EL,SL,iw,PL).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Sl(e){return"string"==typeof e?new bd([[document.querySelector(e)]],[document.documentElement]):new bd([[e]],g$)}function aw(e){return function(){return e}}function Dq(e){this._context=e}function mbe(e){return new Dq(e)}!function dbe(e){sw=function ave(e){var n=e.dateTime,t=e.date,i=e.time,r=e.periods,a=e.days,h=e.shortDays,v=e.months,C=e.shortMonths,P=MT(r),L=ST(r),V=MT(a),W=ST(a),X=MT(h),oe=ST(h),he=MT(v),se=ST(v),_e=MT(C),Se=ST(C),$e={a:function vt(fn){return h[fn.getDay()]},A:function Ut(fn){return a[fn.getDay()]},b:function Wt(fn){return C[fn.getMonth()]},B:function pn(fn){return v[fn.getMonth()]},c:null,d:_q,e:_q,f:kve,g:Vve,G:jve,H:Eve,I:Dve,j:Ive,L:yq,m:Ave,M:Rve,p:function kn(fn){return r[+(fn.getHours()>=12)]},q:function Vn(fn){return 1+~~(fn.getMonth()/3)},Q:Tq,s:Mq,S:Pve,u:Ove,U:Fve,V:Lve,w:Nve,W:zve,x:null,X:null,y:Bve,Y:Uve,Z:Hve,"%":Cq},et={a:function Ar(fn){return h[fn.getUTCDay()]},A:function bi(fn){return a[fn.getUTCDay()]},b:function fo(fn){return C[fn.getUTCMonth()]},B:function Oa(fn){return v[fn.getUTCMonth()]},c:null,d:bq,e:bq,f:Wve,g:ibe,G:obe,H:$ve,I:Gve,j:qve,L:xq,m:Zve,M:Yve,p:function Wi(fn){return r[+(fn.getUTCHours()>=12)]},q:function jo(fn){return 1+~~(fn.getUTCMonth()/3)},Q:Tq,s:Mq,S:Xve,u:Kve,U:Qve,V:Jve,w:ebe,W:tbe,x:null,X:null,y:nbe,Y:rbe,Z:sbe,"%":Cq},ut={a:function Pn(fn,Ui,dr){var nn=X.exec(Ui.slice(dr));return nn?(fn.w=oe.get(nn[0].toLowerCase()),dr+nn[0].length):-1},A:function Kt(fn,Ui,dr){var nn=V.exec(Ui.slice(dr));return nn?(fn.w=W.get(nn[0].toLowerCase()),dr+nn[0].length):-1},b:function Mi(fn,Ui,dr){var nn=_e.exec(Ui.slice(dr));return nn?(fn.m=Se.get(nn[0].toLowerCase()),dr+nn[0].length):-1},B:function Bn(fn,Ui,dr){var nn=he.exec(Ui.slice(dr));return nn?(fn.m=se.get(nn[0].toLowerCase()),dr+nn[0].length):-1},c:function at(fn,Ui,dr){return tn(fn,n,Ui,dr)},d:mq,e:mq,f:Cve,g:pq,G:fq,H:gq,I:gq,j:vve,L:wve,m:yve,M:bve,p:function Rn(fn,Ui,dr){var nn=P.exec(Ui.slice(dr));return nn?(fn.p=L.get(nn[0].toLowerCase()),dr+nn[0].length):-1},q:_ve,Q:Mve,s:Sve,S:xve,u:hve,U:fve,V:pve,w:uve,W:mve,x:function ft(fn,Ui,dr){return tn(fn,t,Ui,dr)},X:function Qe(fn,Ui,dr){return tn(fn,i,Ui,dr)},y:pq,Y:fq,Z:gve,"%":Tve};function mt(fn,Ui){return function(dr){var oc,Pi,vs,nn=[],ys=-1,oo=0,rc=fn.length;for(dr instanceof Date||(dr=new Date(+dr));++ys<rc;)37===fn.charCodeAt(ys)&&(nn.push(fn.slice(oo,ys)),null!=(Pi=hq[oc=fn.charAt(++ys)])?oc=fn.charAt(++ys):Pi="e"===oc?" ":"0",(vs=Ui[oc])&&(oc=vs(dr,Pi)),nn.push(oc),oo=ys+1);return nn.push(fn.slice(oo,ys)),nn.join("")}}function qt(fn,Ui){return function(dr){var oo,rc,nn=TT(1900,void 0,1);if(tn(nn,fn,dr+="",0)!=dr.length)return null;if("Q"in nn)return new Date(nn.Q);if("s"in nn)return new Date(1e3*nn.s+("L"in nn?nn.L:0));if(Ui&&!("Z"in nn)&&(nn.Z=0),"p"in nn&&(nn.H=nn.H%12+12*nn.p),void 0===nn.m&&(nn.m="q"in nn?nn.q:0),"V"in nn){if(nn.V<1||nn.V>53)return null;"w"in nn||(nn.w=1),"Z"in nn?(rc=(oo=RL(TT(nn.y,0,1))).getUTCDay(),oo=rc>4||0===rc?yk.ceil(oo):yk(oo),oo=DL.offset(oo,7*(nn.V-1)),nn.y=oo.getUTCFullYear(),nn.m=oo.getUTCMonth(),nn.d=oo.getUTCDate()+(nn.w+6)%7):(rc=(oo=AL(TT(nn.y,0,1))).getDay(),oo=rc>4||0===rc?_k.ceil(oo):_k(oo),oo=CT.offset(oo,7*(nn.V-1)),nn.y=oo.getFullYear(),nn.m=oo.getMonth(),nn.d=oo.getDate()+(nn.w+6)%7)}else("W"in nn||"U"in nn)&&("w"in nn||(nn.w="u"in nn?nn.u%7:"W"in nn?1:0),rc="Z"in nn?RL(TT(nn.y,0,1)).getUTCDay():AL(TT(nn.y,0,1)).getDay(),nn.m=0,nn.d="W"in nn?(nn.w+6)%7+7*nn.W-(rc+5)%7:nn.w+7*nn.U-(rc+6)%7);return"Z"in nn?(nn.H+=nn.Z/100|0,nn.M+=nn.Z%100,RL(nn)):AL(nn)}}function tn(fn,Ui,dr,nn){for(var oc,Pi,ys=0,oo=Ui.length,rc=dr.length;ys<oo;){if(nn>=rc)return-1;if(37===(oc=Ui.charCodeAt(ys++))){if(oc=Ui.charAt(ys++),!(Pi=ut[oc in hq?Ui.charAt(ys++):oc])||(nn=Pi(fn,dr,nn))<0)return-1}else if(oc!=dr.charCodeAt(nn++))return-1}return nn}return $e.x=mt(t,$e),$e.X=mt(i,$e),$e.c=mt(n,$e),et.x=mt(t,et),et.X=mt(i,et),et.c=mt(n,et),{format:function(fn){var Ui=mt(fn+="",$e);return Ui.toString=function(){return fn},Ui},parse:function(fn){var Ui=qt(fn+="",!1);return Ui.toString=function(){return fn},Ui},utcFormat:function(fn){var Ui=mt(fn+="",et);return Ui.toString=function(){return fn},Ui},utcParse:function(fn){var Ui=qt(fn+="",!0);return Ui.toString=function(){return fn},Ui}}}(e),PL=sw.format}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Dq.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n)}}};const OL=Math.PI,FL=2*OL,db=1e-6,gbe=FL-db;function Iq(e){this._+=e[0];for(let n=1,t=e.length;n<t;++n)this._+=arguments[n]+e[n]}class vk{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==n?Iq:function _be(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return Iq;const t=10**n;return function(i){this._+=i[0];for(let r=1,a=i.length;r<a;++r)this._+=Math.round(arguments[r]*t)/t+i[r]}}(n)}moveTo(n,t){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,t){this._append`L${this._x1=+n},${this._y1=+t}`}quadraticCurveTo(n,t,i,r){this._append`Q${+n},${+t},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(n,t,i,r,a,h){this._append`C${+n},${+t},${+i},${+r},${this._x1=+a},${this._y1=+h}`}arcTo(n,t,i,r,a){if(n=+n,t=+t,i=+i,r=+r,(a=+a)<0)throw new Error(`negative radius: ${a}`);let h=this._x1,v=this._y1,C=i-n,P=r-t,L=h-n,V=v-t,W=L*L+V*V;if(null===this._x1)this._append`M${this._x1=n},${this._y1=t}`;else if(W>db)if(Math.abs(V*C-P*L)>db&&a){let X=i-h,oe=r-v,he=C*C+P*P,se=X*X+oe*oe,_e=Math.sqrt(he),Se=Math.sqrt(W),$e=a*Math.tan((OL-Math.acos((he+W-se)/(2*_e*Se)))/2),et=$e/Se,ut=$e/_e;Math.abs(et-1)>db&&this._append`L${n+et*L},${t+et*V}`,this._append`A${a},${a},0,0,${+(V*X>L*oe)},${this._x1=n+ut*C},${this._y1=t+ut*P}`}else this._append`L${this._x1=n},${this._y1=t}`}arc(n,t,i,r,a,h){if(n=+n,t=+t,h=!!h,(i=+i)<0)throw new Error(`negative radius: ${i}`);let v=i*Math.cos(r),C=i*Math.sin(r),P=n+v,L=t+C,V=1^h,W=h?r-a:a-r;null===this._x1?this._append`M${P},${L}`:(Math.abs(this._x1-P)>db||Math.abs(this._y1-L)>db)&&this._append`L${P},${L}`,i&&(W<0&&(W=W%FL+FL),W>gbe?this._append`A${i},${i},0,1,${V},${n-v},${t-C}A${i},${i},0,1,${V},${this._x1=P},${this._y1=L}`:W>db&&this._append`A${i},${i},0,${+(W>=OL)},${V},${this._x1=n+i*Math.cos(a)},${this._y1=t+i*Math.sin(a)}`)}rect(n,t,i,r){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+t}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function bbe(e){return e[0]}function xbe(e){return e[1]}function bk(e,n){var t=aw(!0),i=null,r=mbe,a=null,h=function vbe(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(null==t)n=null;else{const i=Math.floor(t);if(!(i>=0))throw new RangeError(`invalid digits: ${t}`);n=i}return e},()=>new vk(n)}(v);function v(C){var P,V,X,L=(C=function pbe(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}(C)).length,W=!1;for(null==i&&(a=r(X=h())),P=0;P<=L;++P)!(P<L&&t(V=C[P],P,C))===W&&((W=!W)?a.lineStart():a.lineEnd()),W&&a.point(+e(V,P,C),+n(V,P,C));if(X)return a=null,X+""||null}return e="function"==typeof e?e:void 0===e?bbe:aw(e),n="function"==typeof n?n:void 0===n?xbe:aw(n),v.x=function(C){return arguments.length?(e="function"==typeof C?C:aw(+C),v):e},v.y=function(C){return arguments.length?(n="function"==typeof C?C:aw(+C),v):n},v.defined=function(C){return arguments.length?(t="function"==typeof C?C:aw(!!C),v):t},v.curve=function(C){return arguments.length?(r=C,null!=i&&(a=r(i)),v):r},v.context=function(C){return arguments.length?(null==C?i=a=null:a=r(i=C),v):i},v}const LL={capture:!0,passive:!1};function NL(e){e.preventDefault(),e.stopImmediatePropagation()}function kq(e){return((e=Math.exp(e))+1/e)/2}const Ebe=function e(n,t,i){function r(a,h){var se,_e,v=a[0],C=a[1],P=a[2],W=h[2],X=h[0]-v,oe=h[1]-C,he=X*X+oe*oe;if(he<1e-12)_e=Math.log(W/P)/n,se=function(qt){return[v+qt*X,C+qt*oe,P*Math.exp(n*qt*_e)]};else{var Se=Math.sqrt(he),$e=(W*W-P*P+i*he)/(2*P*t*Se),et=(W*W-P*P-i*he)/(2*W*t*Se),ut=Math.log(Math.sqrt($e*$e+1)-$e),mt=Math.log(Math.sqrt(et*et+1)-et);_e=(mt-ut)/n,se=function(qt){var tn=qt*_e,Rn=kq(ut),Pn=P/(t*Se)*(Rn*function Sbe(e){return((e=Math.exp(2*e))-1)/(e+1)}(n*tn+ut)-function Mbe(e){return((e=Math.exp(e))-1/e)/2}(ut));return[v+Pn*X,C+Pn*oe,P*Rn/kq(n*tn+ut)]}}return se.duration=1e3*_e*n/Math.SQRT2,se}return r.rho=function(a){var h=Math.max(.001,+a),v=h*h;return e(h,v,v*v)},r}(Math.SQRT2,2,4);function ub(e,n){if(e=function Dbe(e){let n;for(;n=e.sourceEvent;)e=n;return e}(e),void 0===n&&(n=e.currentTarget),n){var t=n.ownerSVGElement||n;if(t.createSVGPoint){var i=t.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(n.getScreenCTM().inverse())).x,i.y]}if(n.getBoundingClientRect){var r=n.getBoundingClientRect();return[e.clientX-r.left-n.clientLeft,e.clientY-r.top-n.clientTop]}}return[e.pageX,e.pageY]}const xk=e=>()=>e;function Ibe(e,{sourceEvent:n,target:t,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function qm(e,n,t){this.k=e,this.x=n,this.y=t}qm.prototype={constructor:qm,scale:function(e){return 1===e?this:new qm(this.k*e,this.x,this.y)},translate:function(e,n){return 0===e&0===n?this:new qm(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var zL=new qm(1,0,0);function BL(e){e.stopImmediatePropagation()}function ET(e){e.preventDefault(),e.stopImmediatePropagation()}function Abe(e){return!(e.ctrlKey&&"wheel"!==e.type||e.button)}function Rbe(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function Aq(){return this.__zoom||zL}function Pbe(e){return-e.deltaY*(1===e.deltaMode?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Obe(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fbe(e,n,t){var i=e.invertX(n[0][0])-t[0][0],r=e.invertX(n[1][0])-t[1][0],a=e.invertY(n[0][1])-t[0][1],h=e.invertY(n[1][1])-t[1][1];return e.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),h>a?(a+h)/2:Math.min(0,a)||Math.max(0,h))}function Nbe(e,n){if(1&e&&(Fe(0,"div",4),gt(1),Ue()),2&e){const t=n.$implicit,i=n.index;Ia("background-color",cn(2).colors[i]),Ze(),Sr(" ",t.month," ")}}function zbe(e,n){if(1&e&&(co(0),_n(1,"div",1),Fe(2,"div",2),an(3,Nbe,2,3,"div",3),Ue(),uo()),2&e){const t=cn();Ze(3),At("ngForOf",t.data)}}let Bbe=(()=>{class e{constructor(t){this.el=t,this.title="Bar Chart",this.colors=[]}ngOnInit(){this.createChart()}createChart(){const t=this.el.nativeElement,i=this.data;if(i){this.colors=["#69b3a2","#404080","#ff4d4d"];const r={top:10,right:30,bottom:40,left:40},a=390-r.left-r.right,h=200-r.top-r.bottom,v=Sl(t).append("svg").attr("width",a+r.left+r.right).attr("height",h+r.top+r.bottom).append("g").attr("transform",`translate(${r.left},${r.top})`),C=mL().domain(i.map(L=>L.month)).range([0,a]).padding(.2);v.append("g").attr("transform",`translate(0,${h})`).call(SF(C));const P=pk().domain([0,wI(i,L=>Math.max(...L.values.map(V=>V.amount)))]).nice().range([h,0]);v.append("g").call(EF(P)),i.forEach((L,V)=>{L.values.forEach((W,X)=>{v.append("rect").attr("class",`bar${X+1}`).attr("x",C(L.month)+C.bandwidth()/L.values.length*X).attr("y",P(W.amount)).attr("width",C.bandwidth()/L.values.length).attr("height",h-P(W.amount)).attr("fill",this.colors[X])})})}}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(In))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-bar-chart"]],inputs:{data:"data"},standalone:!1,decls:1,vars:1,consts:[[4,"ngIf"],[1,"bar-chart-container"],[1,"bar-chart-legend"],["class","bar-chart-legend-item",3,"backgroundColor",4,"ngFor","ngForOf"],[1,"bar-chart-legend-item"]],template:function(i,r){1&i&&an(0,zbe,4,1,"ng-container",0),2&i&&At("ngIf",r.data)},dependencies:[md,qf],styles:[".bar-chart-legend[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5em;padding:.5em;margin-right:1.5em}.bar-chart-legend-item[_ngcontent-%COMP%]{padding:.2em .5em;border-radius:3px;font-size:.8em;color:#fff}.bar-chart-legend-item-color[_ngcontent-%COMP%]{width:1em;height:1em;border-radius:50%;margin-right:.5em}.bar-chart-legend-item-label[_ngcontent-%COMP%]{display:flex;align-items:center}.bar-chart-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;margin-top:-1.75em}"]})}return e})();const Vbe=["chart"];let Ube=(()=>{class e{constructor(){this.data=[]}ngOnInit(){}ngAfterViewInit(){this.createChart()}createChart(){if(!this.chartContainer)return;const t=this.chartContainer.nativeElement;Sl(t).select("svg").remove();const i=Sl(t).append("svg").attr("width","100%").attr("height","100%"),a=t.offsetWidth-50-20,h=t.offsetHeight-20-30,v=i.append("g").attr("transform","translate(50,20)"),C=Eq().range([0,a]),P=pk().range([h,0]),L=bk().x(he=>C(he.date)).y(he=>P(he.series1)),V=bk().x(he=>C(he.date)).y(he=>P(he.series2)),W=bk().x(he=>C(he.date)).y(he=>P(he.series3)),X=function npe(e,n){let t,i;if(void 0===n)for(const r of e)null!=r&&(void 0===t?r>=r&&(t=i=r):(t>r&&(t=r),i<r&&(i=r)));else{let r=-1;for(let a of e)null!=(a=n(a,++r,e))&&(void 0===t?a>=a&&(t=i=a):(t>a&&(t=a),i<a&&(i=a)))}return[t,i]}(this.data,he=>he.date);C.domain(X),P.domain([0,wI(this.data.map(he=>Math.max(he.series1,he.series2,he.series3)))]);const oe=SF(C).tickFormat((he,se)=>PL("%b")(he));v.append("g").attr("transform",`translate(0,${h})`).call(oe),v.append("g").call(EF(P)),v.append("path").datum(this.data).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5).attr("d",L(this.data)),v.append("path").datum(this.data).attr("fill","none").attr("stroke","green").attr("stroke-width",1.5).attr("d",V(this.data)),v.append("path").datum(this.data).attr("fill","none").attr("stroke","red").attr("stroke-width",1.5).attr("d",W(this.data))}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-line-chart"]],viewQuery:function(i,r){if(1&i&&zr(Vbe,5),2&i){let a;ri(a=oi())&&(r.chartContainer=a.first)}},inputs:{data:"data"},standalone:!1,decls:3,vars:0,consts:[["chart",""],[1,"line-chart-container"],[1,"line-chart"]],template:function(i,r){1&i&&(Fe(0,"div",1),_n(1,"div",2,0),Ue())},styles:[".line-chart-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;overflow:hidden}.line-chart[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return e})();const Rh_mapbox_accessToken="pk.eyJ1IjoiamVmZnJleXNhbmZvcmQiLCJhIjoiY201c2psaW8yMG1vMDJrcTJ4ZzNic3YxbyJ9.7e5Pub4Ub0v-tHK9uzIuEA",Rh_flightRadar24_apiKey="9df1bdd8-b573-4e99-9b23-ff47fab4c035|PxsBdnqI1p0vbt3PiAi079zIDoq8TK01PTi3ZITYd19a63d7",Rh_flightRadar24_endpoint="https://fr24api.flightradar24.com/api/sandbox",Rh_flightAware_apiKey="nfLsA7DYMbptvaOF4KIkCkSM79WIXArZ",Rh_flightAware_endpoint="https://aeroapi.flightaware.com/aeroapi";let Rq=(()=>{class e{constructor(t){this.http=t,this.baseUrl="https://finnhub.io/api/v1",this.apiKey="cps6s5hr01qkode1001gcps6s5hr01qkode10020"}getStockData(t,i,r,a){const v={symbol:t,resolution:i,from:r.toString(),to:a.toString(),token:this.apiKey};return this.http.get("http://finnhub.io/api/v1/stock/candle",{params:v})}static#e=this.\u0275fac=function(i){return new(i||e)(un(k_))};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const jbe=["chart"];function Hbe(e,n){if(1&e&&(Fe(0,"div",5),_n(1,"span",6),Fe(2,"span",7),gt(3),Ue()()),2&e){const t=n.$implicit;Ze(),Ia("background-color",t.value),Ze(2),br(t.key)}}let $be=(()=>{class e{constructor(t,i){this.renderer=t,this.datavisualizationService=i,this.data=[],this.colors={LOL:"blue",OMG:"green",WTF:"purple",BBQ:"orange",ROFL:"cyan"}}ngInit(){["BAH","BA","AAPL","MSFT","AMZN","GOOGL","TSLA","NVDA","JPM","V","PG"].forEach(i=>{this.datavisualizationService.getStockData(i,"D",1704067200,1717238400).subscribe(r=>{console.log(r),this.data=r})})}ngOnChanges(t){t.data&&this.renderChart()}renderChart(){if(this.data&&this.chartContainer){let oe=function(se){return(se.startValue+se.endValue)/2};const t=this.renderer.selectRootElement(this.chartContainer.nativeElement);Sl(t).selectAll("*").remove();const i={top:10,right:10,bottom:60,left:30},r=t.offsetWidth-i.left-i.right,a=t.offsetHeight-i.top-i.bottom,h=Sl(t).append("svg").attr("width",r+i.left+i.right).attr("height",a+i.top+i.bottom).append("g").attr("transform",`translate(${i.left},${i.top})`),v=Sl(t).append("div").attr("class","tooltip").style("opacity",0),C=this.data.filter(se=>"extreme"!==se.group&&("buy"===se.trade||"sell"===se.trade)),P=this.data.filter(se=>"extreme"===se.group),L=Eq().domain([n$(C,se=>se.startTime),wI(C,se=>se.endTime)]).range([0,r]),V=pk().domain([n$(C,se=>Math.min(se.startValue,se.endValue)),wI(C,se=>Math.max(se.startValue,se.endValue))]).range([a,0]),W=SF(L).ticks(rp.every(1)),X=EF(V).ticks(5);h.append("g").attr("class","x axis").attr("transform",`translate(0,${a})`).call(W),h.append("g").attr("class","y axis").call(X),h.selectAll(".bar").data(C).enter().append("rect").attr("class","bar").attr("x",se=>L(se.startTime)).attr("y",se=>V(Math.max(se.startValue,se.endValue))).attr("width",se=>L(se.endTime)-L(se.startTime)).attr("height",se=>Math.abs(V(se.startValue)-V(se.endValue))).attr("fill",se=>this.colors[se.stockIndicator]||"black").on("mouseover",function(se,_e){v.transition().duration(200).style("opacity",.9),v.html(`Start: ${_e.startValue}<br>End: ${_e.endValue}`).style("left",se.pageX+5+"px").style("top",se.pageY-28+"px")}).on("mouseout",function(){v.transition().duration(500).style("opacity",0)}),h.selectAll(".extreme-bar").data(P).enter().append("rect").attr("class","extreme-bar").attr("x",se=>{const _e=L(se.startTime)-2.5;return console.log(`x: ${_e}, startTime: ${se.startTime}`),_e}).attr("y",se=>{const _e=oe(se),Se=V(_e);return console.log(`y: ${Se}, avgValue: ${_e}`),Se}).attr("width",5).attr("height",se=>{const _e=Math.abs(V(se.startValue)-V(se.endValue));return console.log(`height: ${_e}, startValue: ${se.startValue}, endValue: ${se.endValue}`),_e}).attr("fill","none").attr("stroke","red").attr("stroke-width",2).on("mouseover",function(se,_e){v.transition().duration(200).style("opacity",.9),v.html(`Start: ${_e.startValue}<br>End: ${_e.endValue}`).style("left",se.pageX+5+"px").style("top",se.pageY-28+"px")}).on("mouseout",function(){v.transition().duration(500).style("opacity",0)}),h.selectAll(".line").data(C).enter().append("line").attr("x1",se=>L(se.startTime)).attr("y1",se=>V(se.startValue)).attr("x2",se=>L(se.endTime)).attr("y2",se=>V(se.endValue)).attr("stroke",se=>this.colors[se.stockIndicator]||"black").attr("stroke-dasharray","5,5"),Object.keys(this.colors).filter(se=>"extreme"!==se).forEach(se=>{const Se=e$(C.filter(et=>et.stockIndicator===se),et=>function rpe(e,n){let t=0,i=0;if(void 0===n)for(let r of e)null!=r&&(r=+r)>=r&&(++t,i+=r);else{let r=-1;for(let a of e)null!=(a=n(a,++r,e))&&(a=+a)>=a&&(++t,i+=a)}if(t)return i/t}(et,ut=>(ut.startValue+ut.endValue)/2),et=>et.startTime.getFullYear()).filter(et=>void 0!==et[1]),$e=bk().x(et=>L(new Date(et[0],0,1))).y(et=>V(et[1]));h.append("path").datum(Se).attr("class","avg-line").attr("fill","none").attr("stroke",this.colors[se]).attr("stroke-width",2).attr("d",$e)})}}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(Ns),Rt(Rq))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-fintech-chart"]],viewQuery:function(i,r){if(1&i&&zr(jbe,7),2&i){let a;ri(a=oi())&&(r.chartContainer=a.first)}},inputs:{data:"data"},standalone:!1,features:[sr],decls:6,vars:3,consts:[["chart",""],[1,"fintech-chart-container"],[1,"fintech-chart"],[1,"legend-container"],["class","legend-item",4,"ngFor","ngForOf"],[1,"legend-item"],[1,"legend-color"],[1,"legend-label"]],template:function(i,r){1&i&&(Fe(0,"div",1),_n(1,"div",2,0),Fe(3,"div",3),an(4,Hbe,4,3,"div",4),Iv(5,"keyvalue"),Ue()()),2&i&&(Ze(4),At("ngForOf",kv(5,1,r.colors)))},dependencies:[md,IV],styles:[".fintech-chart-container[_ngcontent-%COMP%]{width:100%;height:25vh;display:flex;justify-content:center;align-items:center;overflow:hidden}.fintech-chart[_ngcontent-%COMP%]{width:100%;height:100%}.legend[_ngcontent-%COMP%]{transform:translateY(1em)}.legend-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;position:absolute;bottom:1em;left:50%;transform:translate(-50%);background:#0000004d;padding:.5em;border-radius:.5em;width:90%;max-width:600px;margin-top:1em}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:1em}.legend-color[_ngcontent-%COMP%]{width:1em;height:1em;margin-right:.5em;border-radius:.25em}.legend-label[_ngcontent-%COMP%]{font-size:.875em}.tooltip[_ngcontent-%COMP%]{position:absolute;text-align:center;width:120px;height:auto;padding:5px;font:12px sans-serif;background:#b0c4de;border:0px;border-radius:8px;pointer-events:none;z-index:10}"]})}return e})();const Gbe=["chart"];let qbe=(()=>{class e{constructor(t,i){this.renderer=t,this.http=i,this.logoUrl="https://www.naturalearthdata.com/wp-content/themes/NEV/images/nev_logo.png",this.destroy$=new Ie}ngOnInit(){console.log("Step 1: Component initialized")}ngAfterViewInit(){console.log("Step 2: AfterViewInit - Start loading shapefile"),this.chartContainer&&this.geojsonData&&(console.log("Step 3: GeoJSON data provided, starting D3 map creation"),this.createUSMap(this.geojsonData))}ngOnDestroy(){console.log("Component is being destroyed. Cleaning up subscriptions."),this.destroy$.next(),this.destroy$.complete()}createUSMap(t){console.log("Step 4: Creating D3 map visualization"),console.log("GeoJSON Data:",t);const i=this.chartContainer?.nativeElement,r=i.clientWidth,a=i.clientHeight,h=this.renderer.createElement("svg","svg");this.renderer.setAttribute(h,"width",`${r}`),this.renderer.setAttribute(h,"height",`${a}`),this.renderer.appendChild(i,h);const v=Sl(h),C=function gye(){var e,n,i,a,v,C,t=function pye(){return pL().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}(),r=pL().rotate([154,0]).center([-2,58.5]).parallels([55,65]),h=pL().rotate([157,0]).center([-3,19.9]).parallels([8,18]),P={point:function(W,X){C=[W,X]}};function L(W){var X=W[0],oe=W[1];return C=null,i.point(X,oe),C||(a.point(X,oe),C)||(v.point(X,oe),C)}function V(){return e=n=null,L}return L.invert=function(W){var X=t.scale(),oe=t.translate(),he=(W[0]-oe[0])/X,se=(W[1]-oe[1])/X;return(se>=.12&&se<.234&&he>=-.425&&he<-.214?r:se>=.166&&se<.234&&he>=-.214&&he<-.115?h:t).invert(W)},L.stream=function(W){return e&&n===W?e:e=function mye(e){var n=e.length;return{point:function(t,i){for(var r=-1;++r<n;)e[r].point(t,i)},sphere:function(){for(var t=-1;++t<n;)e[t].sphere()},lineStart:function(){for(var t=-1;++t<n;)e[t].lineStart()},lineEnd:function(){for(var t=-1;++t<n;)e[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<n;)e[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<n;)e[t].polygonEnd()}}}([t.stream(n=W),r.stream(W),h.stream(W)])},L.precision=function(W){return arguments.length?(t.precision(W),r.precision(W),h.precision(W),V()):t.precision()},L.scale=function(W){return arguments.length?(t.scale(W),r.scale(.35*W),h.scale(W),L.translate(t.translate())):t.scale()},L.translate=function(W){if(!arguments.length)return t.translate();var X=t.scale(),oe=+W[0],he=+W[1];return i=t.translate(W).clipExtent([[oe-.455*X,he-.238*X],[oe+.455*X,he+.238*X]]).stream(P),a=r.translate([oe-.307*X,he+.201*X]).clipExtent([[oe-.425*X+Ir,he+.12*X+Ir],[oe-.214*X-Ir,he+.234*X-Ir]]).stream(P),v=h.translate([oe-.205*X,he+.212*X]).clipExtent([[oe-.214*X+Ir,he+.166*X+Ir],[oe-.115*X-Ir,he+.234*X-Ir]]).stream(P),V()},L.fitExtent=function(W,X){return fL(L,W,X)},L.fitSize=function(W,X){return NG(L,W,X)},L.fitWidth=function(W,X){return zG(L,W,X)},L.fitHeight=function(W,X){return BG(L,W,X)},L.scale(1070)}().fitSize([r,a],t),P=function Z_e(e,n){let r,a,t=3,i=4.5;function h(v){return v&&("function"==typeof i&&a.pointRadius(+i.apply(this,arguments)),Xx(v,r(a))),a.result()}return h.area=function(v){return Xx(v,r(lG)),lG.result()},h.measure=function(v){return Xx(v,r(vG)),vG.result()},h.bounds=function(v){return Xx(v,r(XI)),XI.result()},h.centroid=function(v){return Xx(v,r(pG)),pG.result()},h.projection=function(v){return arguments.length?(r=null==v?(e=null,WF):(e=v).stream,h):e},h.context=function(v){return arguments.length?(a=null==v?(n=null,new CG(t)):new mG(n=v),"function"!=typeof i&&a.pointRadius(i),h):n},h.pointRadius=function(v){return arguments.length?(i="function"==typeof v?v:(a.pointRadius(+v),+v),h):i},h.digits=function(v){if(!arguments.length)return t;if(null==v)t=null;else{const C=Math.floor(v);if(!(C>=0))throw new RangeError(`invalid digits: ${v}`);t=C}return null===n&&(a=new CG(t)),h},h.projection(e).digits(t).context(n)}().projection(C),L=v.append("g"),V=function Lbe(){var L,V,W,e=Abe,n=Rbe,t=Fbe,i=Pbe,r=Obe,a=[0,1/0],h=[[-1/0,-1/0],[1/0,1/0]],v=250,C=Ebe,P=b$("start","zoom","end"),he=0,se=10;function _e(at){at.property("__zoom",Aq).on("wheel.zoom",tn,{passive:!1}).on("mousedown.zoom",Rn).on("dblclick.zoom",Pn).filter(r).on("touchstart.zoom",Kt).on("touchmove.zoom",Mi).on("touchend.zoom touchcancel.zoom",Bn).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function Se(at,ft){return(ft=Math.max(a[0],Math.min(a[1],ft)))===at.k?at:new qm(ft,at.x,at.y)}function $e(at,ft,Qe){var vt=ft[0]-Qe[0]*at.k,Ut=ft[1]-Qe[1]*at.k;return vt===at.x&&Ut===at.y?at:new qm(at.k,vt,Ut)}function et(at){return[(+at[0][0]+ +at[1][0])/2,(+at[0][1]+ +at[1][1])/2]}function ut(at,ft,Qe,vt){at.on("start.zoom",function(){mt(this,arguments).event(vt).start()}).on("interrupt.zoom end.zoom",function(){mt(this,arguments).event(vt).end()}).tween("zoom",function(){var Ut=this,Wt=arguments,pn=mt(Ut,Wt).event(vt),kn=n.apply(Ut,Wt),Vn=null==Qe?et(kn):"function"==typeof Qe?Qe.apply(Ut,Wt):Qe,Ar=Math.max(kn[1][0]-kn[0][0],kn[1][1]-kn[0][1]),bi=Ut.__zoom,fo="function"==typeof ft?ft.apply(Ut,Wt):ft,Oa=C(bi.invert(Vn).concat(Ar/bi.k),fo.invert(Vn).concat(Ar/fo.k));return function(Wi){if(1===Wi)Wi=fo;else{var jo=Oa(Wi),fn=Ar/jo[2];Wi=new qm(fn,Vn[0]-jo[0]*fn,Vn[1]-jo[1]*fn)}pn.zoom(null,Wi)}})}function mt(at,ft,Qe){return!Qe&&at.__zooming||new qt(at,ft)}function qt(at,ft){this.that=at,this.args=ft,this.active=0,this.sourceEvent=null,this.extent=n.apply(at,ft),this.taps=0}function tn(at,...ft){if(e.apply(this,arguments)){var Qe=mt(this,ft).event(at),vt=this.__zoom,Ut=Math.max(a[0],Math.min(a[1],vt.k*Math.pow(2,i.apply(this,arguments)))),Wt=ub(at);if(Qe.wheel)(Qe.mouse[0][0]!==Wt[0]||Qe.mouse[0][1]!==Wt[1])&&(Qe.mouse[1]=vt.invert(Qe.mouse[0]=Wt)),clearTimeout(Qe.wheel);else{if(vt.k===Ut)return;Qe.mouse=[Wt,vt.invert(Wt)],LI(this),Qe.start()}ET(at),Qe.wheel=setTimeout(function pn(){Qe.wheel=null,Qe.end()},150),Qe.zoom("mouse",t($e(Se(vt,Ut),Qe.mouse[0],Qe.mouse[1]),Qe.extent,h))}}function Rn(at,...ft){if(!W&&e.apply(this,arguments)){var Qe=at.currentTarget,vt=mt(this,ft,!0).event(at),Ut=Sl(at.view).on("mousemove.zoom",function Vn(bi){if(ET(bi),!vt.moved){var fo=bi.clientX-pn,Oa=bi.clientY-kn;vt.moved=fo*fo+Oa*Oa>he}vt.event(bi).zoom("mouse",t($e(vt.that.__zoom,vt.mouse[0]=ub(bi,Qe),vt.mouse[1]),vt.extent,h))},!0).on("mouseup.zoom",function Ar(bi){Ut.on("mousemove.zoom mouseup.zoom",null),function Cbe(e,n){var t=e.document.documentElement,i=Sl(e).on("dragstart.drag",null);n&&(i.on("click.drag",NL,LL),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in t?i.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}(bi.view,vt.moved),ET(bi),vt.event(bi).end()},!0),Wt=ub(at,Qe),pn=at.clientX,kn=at.clientY;(function wbe(e){var n=e.document.documentElement,t=Sl(e).on("dragstart.drag",NL,LL);"onselectstart"in n?t.on("selectstart.drag",NL,LL):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")})(at.view),BL(at),vt.mouse=[Wt,this.__zoom.invert(Wt)],LI(this),vt.start()}}function Pn(at,...ft){if(e.apply(this,arguments)){var Qe=this.__zoom,vt=ub(at.changedTouches?at.changedTouches[0]:at,this),Ut=Qe.invert(vt),pn=t($e(Se(Qe,Qe.k*(at.shiftKey?.5:2)),vt,Ut),n.apply(this,ft),h);ET(at),v>0?Sl(this).transition().duration(v).call(ut,pn,vt,at):Sl(this).call(_e.transform,pn,vt,at)}}function Kt(at,...ft){if(e.apply(this,arguments)){var Wt,pn,kn,Vn,Qe=at.touches,vt=Qe.length,Ut=mt(this,ft,at.changedTouches.length===vt).event(at);for(BL(at),pn=0;pn<vt;++pn)Vn=[Vn=ub(kn=Qe[pn],this),this.__zoom.invert(Vn),kn.identifier],Ut.touch0?!Ut.touch1&&Ut.touch0[2]!==Vn[2]&&(Ut.touch1=Vn,Ut.taps=0):(Ut.touch0=Vn,Wt=!0,Ut.taps=1+!!L);L&&(L=clearTimeout(L)),Wt&&(Ut.taps<2&&(V=Vn[0],L=setTimeout(function(){L=null},500)),LI(this),Ut.start())}}function Mi(at,...ft){if(this.__zooming){var Wt,pn,kn,Vn,Qe=mt(this,ft).event(at),vt=at.changedTouches,Ut=vt.length;for(ET(at),Wt=0;Wt<Ut;++Wt)kn=ub(pn=vt[Wt],this),Qe.touch0&&Qe.touch0[2]===pn.identifier?Qe.touch0[0]=kn:Qe.touch1&&Qe.touch1[2]===pn.identifier&&(Qe.touch1[0]=kn);if(pn=Qe.that.__zoom,Qe.touch1){var Ar=Qe.touch0[0],bi=Qe.touch0[1],fo=Qe.touch1[0],Oa=Qe.touch1[1],Wi=(Wi=fo[0]-Ar[0])*Wi+(Wi=fo[1]-Ar[1])*Wi,jo=(jo=Oa[0]-bi[0])*jo+(jo=Oa[1]-bi[1])*jo;pn=Se(pn,Math.sqrt(Wi/jo)),kn=[(Ar[0]+fo[0])/2,(Ar[1]+fo[1])/2],Vn=[(bi[0]+Oa[0])/2,(bi[1]+Oa[1])/2]}else{if(!Qe.touch0)return;kn=Qe.touch0[0],Vn=Qe.touch0[1]}Qe.zoom("touch",t($e(pn,kn,Vn),Qe.extent,h))}}function Bn(at,...ft){if(this.__zooming){var Wt,pn,Qe=mt(this,ft).event(at),vt=at.changedTouches,Ut=vt.length;for(BL(at),W&&clearTimeout(W),W=setTimeout(function(){W=null},500),Wt=0;Wt<Ut;++Wt)pn=vt[Wt],Qe.touch0&&Qe.touch0[2]===pn.identifier?delete Qe.touch0:Qe.touch1&&Qe.touch1[2]===pn.identifier&&delete Qe.touch1;if(Qe.touch1&&!Qe.touch0&&(Qe.touch0=Qe.touch1,delete Qe.touch1),Qe.touch0)Qe.touch0[1]=this.__zoom.invert(Qe.touch0[0]);else if(Qe.end(),2===Qe.taps&&(pn=ub(pn,this),Math.hypot(V[0]-pn[0],V[1]-pn[1])<se)){var kn=Sl(this).on("dblclick.zoom");kn&&kn.apply(this,arguments)}}}return _e.transform=function(at,ft,Qe,vt){var Ut=at.selection?at.selection():at;Ut.property("__zoom",Aq),at!==Ut?ut(at,ft,Qe,vt):Ut.interrupt().each(function(){mt(this,arguments).event(vt).start().zoom(null,"function"==typeof ft?ft.apply(this,arguments):ft).end()})},_e.scaleBy=function(at,ft,Qe,vt){_e.scaleTo(at,function(){return this.__zoom.k*("function"==typeof ft?ft.apply(this,arguments):ft)},Qe,vt)},_e.scaleTo=function(at,ft,Qe,vt){_e.transform(at,function(){var Ut=n.apply(this,arguments),Wt=this.__zoom,pn=null==Qe?et(Ut):"function"==typeof Qe?Qe.apply(this,arguments):Qe,kn=Wt.invert(pn),Vn="function"==typeof ft?ft.apply(this,arguments):ft;return t($e(Se(Wt,Vn),pn,kn),Ut,h)},Qe,vt)},_e.translateBy=function(at,ft,Qe,vt){_e.transform(at,function(){return t(this.__zoom.translate("function"==typeof ft?ft.apply(this,arguments):ft,"function"==typeof Qe?Qe.apply(this,arguments):Qe),n.apply(this,arguments),h)},null,vt)},_e.translateTo=function(at,ft,Qe,vt,Ut){_e.transform(at,function(){var Wt=n.apply(this,arguments),pn=this.__zoom,kn=null==vt?et(Wt):"function"==typeof vt?vt.apply(this,arguments):vt;return t(zL.translate(kn[0],kn[1]).scale(pn.k).translate("function"==typeof ft?-ft.apply(this,arguments):-ft,"function"==typeof Qe?-Qe.apply(this,arguments):-Qe),Wt,h)},vt,Ut)},qt.prototype={event:function(at){return at&&(this.sourceEvent=at),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(at,ft){return this.mouse&&"mouse"!==at&&(this.mouse[1]=ft.invert(this.mouse[0])),this.touch0&&"touch"!==at&&(this.touch0[1]=ft.invert(this.touch0[0])),this.touch1&&"touch"!==at&&(this.touch1[1]=ft.invert(this.touch1[0])),this.that.__zoom=ft,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(at){var ft=Sl(this.that).datum();P.call(at,this.that,new Ibe(at,{sourceEvent:this.sourceEvent,target:_e,type:at,transform:this.that.__zoom,dispatch:P}),ft)}},_e.wheelDelta=function(at){return arguments.length?(i="function"==typeof at?at:xk(+at),_e):i},_e.filter=function(at){return arguments.length?(e="function"==typeof at?at:xk(!!at),_e):e},_e.touchable=function(at){return arguments.length?(r="function"==typeof at?at:xk(!!at),_e):r},_e.extent=function(at){return arguments.length?(n="function"==typeof at?at:xk([[+at[0][0],+at[0][1]],[+at[1][0],+at[1][1]]]),_e):n},_e.scaleExtent=function(at){return arguments.length?(a[0]=+at[0],a[1]=+at[1],_e):[a[0],a[1]]},_e.translateExtent=function(at){return arguments.length?(h[0][0]=+at[0][0],h[1][0]=+at[1][0],h[0][1]=+at[0][1],h[1][1]=+at[1][1],_e):[[h[0][0],h[0][1]],[h[1][0],h[1][1]]]},_e.constrain=function(at){return arguments.length?(t=at,_e):t},_e.duration=function(at){return arguments.length?(v=+at,_e):v},_e.interpolate=function(at){return arguments.length?(C=at,_e):C},_e.on=function(){var at=P.on.apply(P,arguments);return at===P?_e:at},_e.clickDistance=function(at){return arguments.length?(he=(at=+at)*at,_e):Math.sqrt(he)},_e.tapDistance=function(at){return arguments.length?(se=+at,_e):se},_e}().scaleExtent([1,8]).on("zoom",W=>{L.attr("transform",W.transform.toString())});v.call(V),L.selectAll("path").data(t.features).enter().append("path").attr("d",W=>{const X=P(W);return console.log("Path Data:",X),X||(console.error("Invalid path data for feature:",W),console.error("Feature Geometry:",W.geometry)),X}).attr("fill","#69b3a2").attr("stroke","black").on("mouseover",function(){Sl(this).attr("fill","orange")}).on("mouseout",function(){Sl(this).attr("fill","#69b3a2")}),console.log("Step 4.3: All states rendered")}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(Ns),Rt(k_))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-map-chart"]],viewQuery:function(i,r){if(1&i&&zr(Gbe,5),2&i){let a;ri(a=oi())&&(r.chartContainer=a.first)}},inputs:{data:"data",geojsonData:"geojsonData"},standalone:!1,decls:6,vars:1,consts:[["chart",""],[1,"chart"],[1,"logo-container"],["alt","Natural Earth Logo",1,"logo",3,"src"],[1,"data-source"]],template:function(i,r){1&i&&(_n(0,"div",1,0),Fe(2,"div",2),_n(3,"img",3),Fe(4,"p",4),gt(5,"Data Source: Natural Earth"),Ue()()),2&i&&(Ze(3),At("src",r.logoUrl,eu))},styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px auto;padding:20px;border-radius:8px;box-shadow:0 4px 8px #0000001a;height:40em}.chart[_ngcontent-%COMP%]{width:calc(100% - 40px);margin:0 auto;min-height:20em}svg[_ngcontent-%COMP%]{font-family:Arial,sans-serif;background-color:transparent}text.title[_ngcontent-%COMP%]{font-size:24px;font-weight:700;fill:#333}text.description[_ngcontent-%COMP%]{font-size:14px;fill:#666}path[_ngcontent-%COMP%]{fill:#69b3a2;stroke:#000;transition:fill .3s ease,stroke-width .3s ease}path[_ngcontent-%COMP%]:hover{fill:orange;stroke-width:2px}.logo-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-around;align-items:center;margin-top:20px;animation:_ngcontent-%COMP%_fadeInLogo 2s forwards}.logo-container[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{width:150px;color:#000;margin-bottom:10px;transform:scale(.8);transition:transform .3s ease-in-out}.logo-container[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]:hover{transform:scale(1)}.logo-container[_ngcontent-%COMP%]   .data-source[_ngcontent-%COMP%]{font-size:1em;color:#fff}@keyframes _ngcontent-%COMP%_fadeInLogo{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.map-chart-container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center;overflow:hidden}.map-chart[_ngcontent-%COMP%]{width:100%;height:100%}"]})}return e})();var Wbe=op(247),wk=op.n(Wbe);let Zbe=(()=>{class e{constructor(){this.map=null,wk().accessToken=Rh_mapbox_accessToken,console.log("Mapbox access token:",Rh_mapbox_accessToken)}initializeMap(t,i=[-118.2437,34.0522],r=10){return this.map&&this.map.remove(),this.map=new(wk().Map)({container:t,style:"mapbox://styles/mapbox/streets-v11",center:i,zoom:r}),this.map}addMarker(t,i){if(!this.map)return void console.error("Map is not initialized. Call initializeMap() first.");const r=(new(wk().Marker)).setLngLat(t).addTo(this.map);if(i){const a=(new(wk().Popup)).setText(i);r.setPopup(a).togglePopup()}}addPolyline(t){this.map?this.map.addLayer({id:"route",type:"line",source:{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:t}}},layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":8}}):console.error("Map is not initialized. Call initializeMap() first.")}destroyMap(){this.map&&(this.map.remove(),this.map=null)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Pq=(()=>{class e{constructor(t){this.http=t,this.baseUrl=Rh_flightRadar24_endpoint,this.apiKey=Rh_flightRadar24_apiKey,console.log("STEP 1: FlightRadarService initialized")}getHeaders(){return(new Ja).set("Accept","application/json").set("Accept-Version","v1").set("Authorization",`Bearer ${this.apiKey}`)}getFlightsByBoundingBox(t,i,r,a){console.log("STEP 2: Fetching flights by bounding box",{lat1:t,lon1:i,lat2:r,lon2:a});const h=`${this.baseUrl}/live/flight-positions/full?bounds=${t},${r},${i},${a}`,v=this.getHeaders();return console.log("Firing flightradar24 with url: ",h),this.http.get(h,{headers:v}).pipe(rs(C=>(C.error instanceof ErrorEvent?console.error("STEP 3: Client-side error:",C.error.message):console.error(`STEP 3: Backend returned code ${C.status}, body was: ${C.error}`),wh(()=>new Error("Failed to fetch flights.")))))}getFlightById(t){console.log("STEP 4: Fetching flight by ID",t);const i=`${this.baseUrl}/flight-tracks?flight_id=${t}`,r=this.getHeaders();return this.http.get(i,{headers:r}).pipe(rs(a=>(404===a.status?console.warn("Error fetching flight by ID: Flight not found",t):console.error("Error fetching flight by ID",a),wh(()=>new Error("Failed to fetch flight.")))))}getAirportsByIcao(t){console.log("STEP 5: Fetching airport by ICAO code",t);const i=`${this.baseUrl}/airport/${t}`,r=this.getHeaders();return this.http.get(i,{headers:r}).pipe(rs(a=>(console.error("Error fetching airport by ICAO code",a),wh(()=>new Error("Failed to fetch airport.")))))}static#e=this.\u0275fac=function(i){return new(i||e)(un(k_))};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),Oq=(()=>{class e{constructor(t){this.http=t,this.baseUrl=Rh_flightAware_endpoint,this.apiKey=Rh_flightAware_apiKey}searchFlights(t,i,r,a){const h=`${this.baseUrl}/flights/search`,v=(new Qf).set("query",`bounds:[${t},${i},${r},${a}]`),C=(new Ja).set("Accept","application/json").set("Accept-Version","v1").set("Authorization",`Bearer ${this.apiKey}`);return console.log("Firing flightaware with url: ",h),this.http.get(h,{headers:C,params:v}).pipe(rs(P=>(console.error("Error searching flights by bounding box",{message:P.message,status:P.status,statusText:P.statusText,url:P.url}),wh(()=>new Error("Failed to search flights.")))))}getFlightsByAircraftType(t){const i=`${this.baseUrl}/flights`,r=(new Qf).set("type",t),a=(new Ja).set("Accept","application/json").set("Authorization",`Bearer ${this.apiKey}`);return this.http.get(i,{headers:a,params:r}).pipe(rs(h=>(console.error("Error fetching flights by aircraft type",{message:h.message,status:h.status,statusText:h.statusText,url:h.url}),wh(()=>new Error("Failed to fetch flights.")))))}getFlightPositions(t){const i=`${this.baseUrl}/flights/${t}/position`,r=(new Ja).set("x-apikey",this.apiKey).set("Authorization",`Bearer ${this.apiKey}`);return this.http.get(i,{headers:r}).pipe(rs(a=>(console.error("Error fetching flight positions",{message:a.message,status:a.status,statusText:a.statusText,url:a.url}),wh(()=>new Error("Failed to fetch flight positions.")))))}static#e=this.\u0275fac=function(i){return new(i||e)(un(k_))};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Ybe(e,n){if(1&e&&(Fe(0,"li"),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t)}}function Xbe(e,n){if(1&e&&(Fe(0,"li"),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),cx(" ",t.callSign," - Altitude: ",t.altitude," ")}}function Kbe(e,n){if(1&e){const t=Is();Fe(0,"li",8),Nn("click",function(){const r=Di(t).$implicit;return Ii(cn().focusAlert(r))}),gt(1),Ue()}if(2&e){const t=n.$implicit;Ze(),Sr(" ",t.name," ")}}let Qbe=(()=>{class e{constructor(t,i,r){this.mapboxService=t,this.flightRadarService=i,this.flightAwareService=r,this.alerts=[],this.fr24Flights=[],this.legendItems=["High Priority","Medium Priority","Low Priority"],this.cityCoordinates={"Los Angeles":[-118.2437,34.0522],"New York":[-74.006,40.7128],Chicago:[-87.6298,41.8781]},this.flights=[],console.log("STEP 1: FireAlertComponent initialized")}ngOnInit(){console.log("STEP 2: ngOnInit called")}ngAfterViewInit(){console.log("STEP 3: ngAfterViewInit called"),this.initializeMap("Los Angeles"),this.fetchFlightData()}initializeMap(t){console.log("STEP 4: Initializing map for city",t),this.mapboxService.initializeMap("map",this.cityCoordinates[t],12).on("click",a=>{const h=a.lngLat,v=`Alert triggered at [${h.lng}, ${h.lat}]`;this.alerts.push(v),this.mapboxService.addMarker([h.lng,h.lat],v),console.log("STEP 5: Map clicked, alert triggered",v)})}fetchFlightData(){console.log("STEP 6: Fetching flight data"),this.flightRadarService.getFlightsByBoundingBox(33.5,-118.5,34.5,-117.5).subscribe(h=>{console.log("STEP 7: Flight data fetched",h),this.fr24Flights=h.data,this.fr24Flights.forEach(v=>{const C=[v.lon,v.lat];this.flightRadarService.getFlightById(v.fr24_id).subscribe(P=>{console.log("STEP 7.1: Flight data fetched",P);const L=P[0],V={flight:L.flight,aircraft:{type:"",registration:""},origin:"",destination:"",altitude:0,speed:0,identity:L.ident,r24_id:L.r24_id,tracks:L.tracks};if(V.aircraft.type=L.aircraft.type,V.aircraft.registration=L.aircraft.registration,V.origin=L.origin,V.destination=L.destination,V.altitude=L.altitude,V.speed=L.speed,this.mapboxService.addMarker(C,`Flight: ${V.flight} - ${V.origin} to ${V.destination} - ${V.aircraft.type}`),V.tracks&&V.tracks.length>1){const W=V.tracks.map(X=>[X.lon,X.lat]);this.mapboxService.addPolyline(W)}this.mapboxService.addMarker(C,`Flight: ${V.flight} - ${V.origin} to ${V.destination} - ${V.aircraft.type}`)},P=>{404===P.status?console.warn("STEP 7.2: Flight not found",v.flight):console.error("STEP 7.2: Error fetching flight data",P)},()=>{console.log("STEP 7.3: Flight data fetched",v)})})},h=>{console.error("STEP 9: Error fetching flight data",h),alert("Failed to fetch flight data. Please check your API key and network connection.")})}focusAlert(t){console.log("STEP 10: Focused alert",t)}ngOnDestroy(){console.log("STEP 11: ngOnDestroy called"),this.mapboxService.destroyMap()}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(Zbe),Rt(Pq),Rt(Oq))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-fire-alert"]],inputs:{alerts:"alerts"},standalone:!1,decls:21,vars:3,consts:[[1,"mat-mdc-card-header-text"],[1,"fire-alert-container"],["id","map",1,"map-container"],[1,"legend"],[4,"ngFor","ngForOf"],[1,"flights-list"],[1,"alerts-list"],[3,"click",4,"ngFor","ngForOf"],[3,"click"]],template:function(i,r){1&i&&(Fe(0,"mat-card")(1,"mat-card-header"),_n(2,"div",0),Ue(),Fe(3,"mat-card-content")(4,"div",1),_n(5,"div",2),Fe(6,"div",3)(7,"h3"),gt(8,"Legend"),Ue(),Fe(9,"ul"),an(10,Ybe,2,1,"li",4),Ue()(),Fe(11,"div",5)(12,"h3"),gt(13,"Nearby Flights"),Ue(),Fe(14,"ul"),an(15,Xbe,2,2,"li",4),Ue()(),Fe(16,"div",6)(17,"h3"),gt(18,"Active Alerts"),Ue(),Fe(19,"ul"),an(20,Kbe,2,1,"li",7),Ue()()()()()),2&i&&(Ze(10),At("ngForOf",r.legendItems),Ze(5),At("ngForOf",r.flights),Ze(5),At("ngForOf",r.alerts))},dependencies:[md,hu,R_,WC],styles:[".container[_ngcontent-%COMP%]{width:100%;height:22em;position:relative}.container[_ngcontent-%COMP%]   .alert-panel[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;padding:10px;border-radius:5px;z-index:1;color:purple}#map[_ngcontent-%COMP%]{width:100%;height:18em}.map-container[_ngcontent-%COMP%]{position:relative;height:400px;width:100%}.map[_ngcontent-%COMP%]{width:100%;height:100%}.legend[_ngcontent-%COMP%]{position:absolute;bottom:10px;right:10px;background:#ffffffe6;border:1px solid #ccc;border-radius:8px;padding:8px}.alert-panel[_ngcontent-%COMP%]{margin-top:16px}.mat-mdc-card-header[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px;border-bottom:1px solid #ddd}.mat-mdc-card-header-text[_ngcontent-%COMP%]{flex:1}.mat-mdc-card-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:500}.fire-alert-container[_ngcontent-%COMP%]{position:relative;padding:16px;border:1px solid #ccc;border-radius:8px;background-color:#fff;box-shadow:0 4px 8px #0000001a}.fire-alert-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem;color:#333;margin-bottom:16px}.fire-alert-container[_ngcontent-%COMP%]   .map-container[_ngcontent-%COMP%]{width:100%;height:300px;border-radius:8px;overflow:hidden;margin-bottom:16px}.fire-alert-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]{position:absolute;bottom:16px;right:16px;background:#ffffffe6;border-radius:8px;padding:8px;box-shadow:0 2px 4px #0003}.fire-alert-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:.875rem;margin-bottom:8px}.fire-alert-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.fire-alert-container[_ngcontent-%COMP%]   .legend[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.75rem;margin-bottom:4px;color:#555}.fire-alert-container[_ngcontent-%COMP%]   .alerts-list[_ngcontent-%COMP%]{margin-top:16px}.fire-alert-container[_ngcontent-%COMP%]   .alerts-list[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:8px}.fire-alert-container[_ngcontent-%COMP%]   .alerts-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0}.fire-alert-container[_ngcontent-%COMP%]   .alerts-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{cursor:pointer;color:#007bff;text-decoration:underline;margin-bottom:4px}.fire-alert-container[_ngcontent-%COMP%]   .alerts-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{color:#0056b3}"]})}return e})();function Jbe(e,n){if(1&e&&(co(0),_n(1,"app-line-chart",6),uo()),2&e){const t=cn().$implicit;Ze(),At("data",t.data)}}function e0e(e,n){if(1&e&&(co(0),_n(1,"app-bar-chart",6),uo()),2&e){const t=cn().$implicit;Ze(),At("data",t.data)}}function t0e(e,n){if(1&e&&(co(0),_n(1,"app-fintech-chart",6),uo()),2&e){const t=cn().$implicit;Ze(),At("data",t.data)}}function n0e(e,n){if(1&e&&(co(0),_n(1,"app-map-chart",7),uo()),2&e){const t=cn().$implicit;Ze(),At("data",t.data)}}function i0e(e,n){1&e&&(co(0),_n(1,"app-fire-alert"),uo())}function r0e(e,n){if(1&e){const t=Is();Fe(0,"div",2)(1,"mat-card",3),Nn("click",function(){const r=Di(t).index;return Ii(cn().openTile(r))})("keydown.enter",function(){const r=Di(t).index;return Ii(cn().openTile(r))})("keydown.space",function(){const r=Di(t).index;return Ii(cn().openTile(r))}),Fe(2,"mat-card-header")(3,"mat-card-title",4),gt(4),Ue()(),Fe(5,"mat-card-content"),an(6,Jbe,2,1,"ng-container",5)(7,e0e,2,1,"ng-container",5)(8,t0e,2,1,"ng-container",5)(9,n0e,2,1,"ng-container",5)(10,i0e,2,0,"ng-container",5),Ue()()()}if(2&e){const t=n.$implicit,i=n.index,r=cn();At("cdkDragData",t),Ze(),Ti("expanded",r.expandedTileIndex===i),Ze(3),br(t.name),Ze(2),At("ngIf","app-line-chart"===t.component),Ze(),At("ngIf","app-bar-chart"===t.component),Ze(),At("ngIf","app-fintech-chart"===t.component),Ze(),At("ngIf","app-map-chart"===t.component),Ze(),At("ngIf","app-fire-alert"===t.component)}}let o0e=(()=>{class e{constructor(t){this.breakpointObserver=t,this.isMobile=!1,this.expandedTileIndex=null,this.barChartData=[{month:"January",values:[{label:"value1",amount:150},{label:"value2",amount:200},{label:"value3",amount:180}]},{month:"February",values:[{label:"value1",amount:200},{label:"value2",amount:180},{label:"value3",amount:220}]},{month:"March",values:[{label:"value1",amount:250},{label:"value2",amount:230},{label:"value3",amount:210}]}],this.lineChartData=[{date:new Date("2024-01-01"),series1:500,series2:3e3,series3:7e3},{date:new Date("2024-02-01"),series1:1500,series2:6200,series3:6800},{date:new Date("2024-03-01"),series1:5800,series2:6400,series3:7200},{date:new Date("2024-04-01"),series1:6e3,series2:6600,series3:7400},{date:new Date("2024-05-01"),series1:6200,series2:6800,series3:7600},{date:new Date("2024-06-01"),series1:6400,series2:7e3,series3:7800},{date:new Date("2024-07-01"),series1:6600,series2:7200,series3:8e3},{date:new Date("2024-08-01"),series1:6800,series2:7400,series3:8200},{date:new Date("2024-09-01"),series1:7e3,series2:7600,series3:8400},{date:new Date("2024-10-01"),series1:7200,series2:7800,series3:8600},{date:new Date("2024-11-01"),series1:7400,series2:8e3,series3:8800},{date:new Date("2024-12-01"),series1:7600,series2:8200,series3:9e3}],this.fintechChartData=[{task:"Buy LOL",startTime:new Date("2020-01-10"),endTime:new Date("2020-01-12"),startValue:100,endValue:105,group:"normal",stockIndicator:"LOL",trade:"buy"},{task:"Sell OMG",startTime:new Date("2020-02-15"),endTime:new Date("2020-02-18"),startValue:110,endValue:108,group:"normal",stockIndicator:"OMG",trade:"sell"},{task:"Buy WTF",startTime:new Date("2020-03-20"),endTime:new Date("2020-03-22"),startValue:115,endValue:120,group:"normal",stockIndicator:"WTF",trade:"buy"},{task:"Sell BBQ",startTime:new Date("2020-04-25"),endTime:new Date("2020-04-28"),startValue:125,endValue:123,group:"normal",stockIndicator:"BBQ",trade:"sell"},{task:"Buy ROFL",startTime:new Date("2020-05-01"),endTime:new Date("2020-05-03"),startValue:130,endValue:135,group:"normal",stockIndicator:"ROFL",trade:"buy"},{task:"Sell LOL",startTime:new Date("2020-06-05"),endTime:new Date("2020-06-07"),startValue:140,endValue:138,group:"normal",stockIndicator:"LOL",trade:"sell"},{task:"Buy OMG",startTime:new Date("2020-07-10"),endTime:new Date("2020-07-12"),startValue:145,endValue:150,group:"normal",stockIndicator:"OMG",trade:"buy"},{task:"Sell WTF",startTime:new Date("2020-08-15"),endTime:new Date("2020-08-18"),startValue:150,endValue:148,group:"normal",stockIndicator:"WTF",trade:"sell"},{task:"Buy BBQ",startTime:new Date("2020-09-20"),endTime:new Date("2020-09-22"),startValue:140,endValue:120,group:"normal",stockIndicator:"BBQ",trade:"buy"},{task:"Sell ROFL",startTime:new Date("2020-10-25"),endTime:new Date("2020-10-28"),startValue:130,endValue:128,group:"normal",stockIndicator:"ROFL",trade:"sell"},{task:"Buy LOL",startTime:new Date("2020-11-01"),endTime:new Date("2020-11-03"),startValue:135,endValue:140,group:"normal",stockIndicator:"LOL",trade:"buy"},{task:"Sell OMG",startTime:new Date("2020-12-05"),endTime:new Date("2020-12-07"),startValue:145,endValue:143,group:"normal",stockIndicator:"OMG",trade:"sell"},{task:"Buy WTF",startTime:new Date("2021-01-10"),endTime:new Date("2021-01-12"),startValue:150,endValue:155,group:"normal",stockIndicator:"WTF",trade:"buy"},{task:"Sell BBQ",startTime:new Date("2021-02-15"),endTime:new Date("2021-02-18"),startValue:140,endValue:138,group:"normal",stockIndicator:"BBQ",trade:"sell"},{task:"Buy ROFL",startTime:new Date("2021-03-20"),endTime:new Date("2021-03-22"),startValue:145,endValue:150,group:"normal",stockIndicator:"ROFL",trade:"buy"},{task:"Sell LOL",startTime:new Date("2021-04-25"),endTime:new Date("2021-04-28"),startValue:150,endValue:148,group:"normal",stockIndicator:"LOL",trade:"sell"},{task:"Buy OMG",startTime:new Date("2021-05-01"),endTime:new Date("2021-05-03"),startValue:140,endValue:145,group:"normal",stockIndicator:"OMG",trade:"buy"},{task:"Sell WTF",startTime:new Date("2021-06-05"),endTime:new Date("2021-06-07"),startValue:145,endValue:143,group:"normal",stockIndicator:"WTF",trade:"sell"},{task:"Buy BBQ",startTime:new Date("2021-07-10"),endTime:new Date("2021-07-12"),startValue:150,endValue:155,group:"normal",stockIndicator:"BBQ",trade:"buy"},{task:"Sell ROFL",startTime:new Date("2021-08-15"),endTime:new Date("2021-08-18"),startValue:140,endValue:138,group:"normal",stockIndicator:"ROFL",trade:"sell"},{task:"Buy LOL",startTime:new Date("2021-09-20"),endTime:new Date("2021-09-22"),startValue:130,endValue:110,group:"normal",stockIndicator:"LOL",trade:"buy"},{task:"Sell OMG",startTime:new Date("2021-10-25"),endTime:new Date("2021-10-28"),startValue:120,endValue:118,group:"normal",stockIndicator:"OMG",trade:"sell"},{task:"Buy WTF",startTime:new Date("2021-11-01"),endTime:new Date("2021-11-03"),startValue:125,endValue:130,group:"normal",stockIndicator:"WTF",trade:"buy"},{task:"Sell BBQ",startTime:new Date("2021-12-05"),endTime:new Date("2021-12-07"),startValue:135,endValue:133,group:"normal",stockIndicator:"BBQ",trade:"sell"},{task:"Buy ROFL",startTime:new Date("2022-01-10"),endTime:new Date("2022-01-12"),startValue:140,endValue:145,group:"normal",stockIndicator:"ROFL",trade:"buy"},{task:"Sell LOL",startTime:new Date("2022-02-15"),endTime:new Date("2022-02-18"),startValue:145,endValue:143,group:"normal",stockIndicator:"LOL",trade:"sell"},{task:"Buy OMG",startTime:new Date("2022-03-20"),endTime:new Date("2022-03-22"),startValue:140,endValue:145,group:"normal",stockIndicator:"OMG",trade:"buy"},{task:"Sell WTF",startTime:new Date("2022-04-25"),endTime:new Date("2022-04-28"),startValue:145,endValue:143,group:"normal",stockIndicator:"WTF",trade:"sell"},{task:"Buy BBQ",startTime:new Date("2022-05-01"),endTime:new Date("2022-05-03"),startValue:150,endValue:155,group:"normal",stockIndicator:"BBQ",trade:"buy"},{task:"Sell ROFL",startTime:new Date("2022-06-05"),endTime:new Date("2022-06-07"),startValue:140,endValue:138,group:"normal",stockIndicator:"ROFL",trade:"sell"},{task:"Buy LOL",startTime:new Date("2022-07-10"),endTime:new Date("2022-07-12"),startValue:130,endValue:135,group:"normal",stockIndicator:"LOL",trade:"buy"},{task:"Sell OMG",startTime:new Date("2022-08-15"),endTime:new Date("2022-08-18"),startValue:135,endValue:133,group:"normal",stockIndicator:"OMG",trade:"sell"},{task:"Buy WTF",startTime:new Date("2022-09-20"),endTime:new Date("2022-09-22"),startValue:140,endValue:120,group:"normal",stockIndicator:"WTF",trade:"buy"},{task:"Sell BBQ",startTime:new Date("2022-10-25"),endTime:new Date("2022-10-28"),startValue:130,endValue:128,group:"normal",stockIndicator:"BBQ",trade:"sell"},{task:"Buy ROFL",startTime:new Date("2022-11-01"),endTime:new Date("2022-11-03"),startValue:135,endValue:140,group:"normal",stockIndicator:"ROFL",trade:"buy"},{task:"Sell LOL",startTime:new Date("2022-12-05"),endTime:new Date("2022-12-07"),startValue:140,endValue:138,group:"normal",stockIndicator:"LOL",trade:"sell"},{task:"Buy OMG",startTime:new Date("2023-01-10"),endTime:new Date("2023-01-12"),startValue:145,endValue:150,group:"normal",stockIndicator:"OMG",trade:"buy"},{task:"Sell WTF",startTime:new Date("2023-02-15"),endTime:new Date("2023-02-18"),startValue:150,endValue:148,group:"normal",stockIndicator:"WTF",trade:"sell"},{task:"Buy BBQ",startTime:new Date("2023-03-20"),endTime:new Date("2023-03-22"),startValue:140,endValue:145,group:"normal",stockIndicator:"BBQ",trade:"buy"},{task:"Sell ROFL",startTime:new Date("2023-04-25"),endTime:new Date("2023-04-28"),startValue:145,endValue:143,group:"normal",stockIndicator:"ROFL",trade:"sell"},{task:"Buy LOL",startTime:new Date("2023-05-01"),endTime:new Date("2023-05-03"),startValue:150,endValue:155,group:"normal",stockIndicator:"LOL",trade:"buy"},{task:"Sell OMG",startTime:new Date("2023-06-05"),endTime:new Date("2023-06-07"),startValue:140,endValue:138,group:"normal",stockIndicator:"OMG",trade:"sell"},{task:"Buy WTF",startTime:new Date("2023-07-10"),endTime:new Date("2023-07-12"),startValue:145,endValue:150,group:"normal",stockIndicator:"WTF",trade:"buy"},{task:"Sell BBQ",startTime:new Date("2023-08-15"),endTime:new Date("2023-08-18"),startValue:150,endValue:148,group:"normal",stockIndicator:"BBQ",trade:"sell"},{task:"Buy ROFL",startTime:new Date("2023-09-20"),endTime:new Date("2023-09-22"),startValue:140,endValue:120,group:"normal",stockIndicator:"ROFL",trade:"buy"},{task:"Sell LOL",startTime:new Date("2023-10-25"),endTime:new Date("2023-10-28"),startValue:130,endValue:128,group:"normal",stockIndicator:"LOL",trade:"sell"},{task:"Buy OMG",startTime:new Date("2023-11-01"),endTime:new Date("2023-11-03"),startValue:135,endValue:140,group:"normal",stockIndicator:"OMG",trade:"buy"},{task:"Sell WTF",startTime:new Date("2023-12-05"),endTime:new Date("2023-12-07"),startValue:140,endValue:138,group:"normal",stockIndicator:"WTF",trade:"sell"}],this.mapChartData=[{name:"Restaurant A",coordinates:[40.7128,-74.006],city:"New York",state:"NY"},{name:"Restaurant B",coordinates:[34.0522,-118.2437],city:"Los Angeles",state:"CA"},{name:"Restaurant C",coordinates:[41.8781,-87.6298],city:"Chicago",state:"IL"}],this.charts=[{name:"Line Chart",component:"app-line-chart",color:"blue",data:this.lineChartData},{name:"Bar Chart",component:"app-bar-chart",color:"green",data:this.barChartData},{name:"FinTech Chart",component:"app-fintech-chart",color:"red",data:this.fintechChartData},{name:"Map Chart",component:"app-map-chart",color:"purple",data:this.mapChartData},{name:"Fire Alert Chart",component:"app-fire-alert",color:"orange",data:[]}]}ngOnInit(){this.breakpointObserver.observe([pO_Handset]).subscribe(t=>{this.isMobile=t.matches;const i=[...this.fintechChartData].sort((a,h)=>a.endValue-a.startValue-(h.endValue-h.startValue)),r=Math.ceil(.1*this.fintechChartData.length);i.slice(0,r).forEach(a=>a.group="extreme"),i.slice(-r).forEach(a=>a.group="extreme"),this.updateAverageLines()})}openTile(t){this.expandedTileIndex=this.expandedTileIndex===t?null:t}drop(t){yF(this.charts,t.previousIndex,t.currentIndex)}updateAverageLines(){}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(zD))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-data-visualizations"]],standalone:!1,decls:2,vars:1,consts:[["cdkDropList","",1,"dashboard",3,"cdkDropListDropped"],["class","dashboard-tile","cdkDrag","",3,"cdkDragData",4,"ngFor","ngForOf"],["cdkDrag","",1,"dashboard-tile",3,"cdkDragData"],["tabindex","0",1,"chart-card",3,"click","keydown.enter","keydown.space"],[1,"chart-name"],[4,"ngIf"],[3,"data"],[1,"map-chart",3,"data"]],template:function(i,r){1&i&&(Fe(0,"div",0),Nn("cdkDropListDropped",function(h){return r.drop(h)}),an(1,r0e,11,9,"div",1),Ue()),2&i&&(Ze(),At("ngForOf",r.charts))},dependencies:[md,qf,hu,R_,WC,Bx,Z8,W8,Bbe,Ube,$be,qbe,Qbe],styles:[".dashboard[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1em}.dashboard-tile[_ngcontent-%COMP%]{flex:1 1 calc(33.333% - 1em);max-width:calc(33.333% - 1em);box-sizing:border-box;color:#ff0;height:300px}.chart-card[_ngcontent-%COMP%]{background-color:#0003;color:#fff;transition:transform .3s ease;cursor:pointer;border:1px solid darkred}.chart-name[_ngcontent-%COMP%]{font-size:1.5em;margin-bottom:.5em;color:gold}.chart-card[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.chart-card.expanded[_ngcontent-%COMP%]{transform:scale(1.1)}"]})}return e})();const s0e=Us("detailExpand",[Or("collapsed",yi({height:"0px",minHeight:"0",visibility:"hidden"})),Or("expanded",yi({height:"*",visibility:"visible"})),Hr("expanded <=> collapsed",no("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))]),a0e=Us("flyIn",[Hr(":enter",[yi({transform:"translateX(-100%)"}),no("1s ease-in-out",yi({transform:"translateX(0)"}))])]);let Fq=(()=>{class e{constructor(t){this.http=t,this.isProduction=false,this.apiUrl="http://localhost:3000/api",this.recordSize=100,this.servers=[{name:"Nest",language:"NestJS (Node.js)",api:"api",port:3e3,swagger:"/api/swagger"},{name:"Go",language:"Go",api:"api-go",port:4e3,swagger:"/swagger"}],this.currentServer=this.servers[0],console.log("API Service: Production mode is",this.isProduction?"ON":"OFF"),console.log(`API Service: Initial API URL is ${this.apiUrl}`)}getHeaders(){return new Ja({"Content-Type":"application/json",Authorization:"Bearer YOUR_TOKEN_HERE"})}get(t){return this.http.get(`${this.apiUrl}/${t}`,{headers:this.getHeaders()})}post(t,i){return this.http.post(`${this.apiUrl}/${t}`,i,{headers:this.getHeaders()})}put(t,i){return this.http.put(`${this.apiUrl}/${t}`,i,{headers:this.getHeaders()})}delete(t){return this.http.delete(`${this.apiUrl}/${t}`,{headers:this.getHeaders()})}setApiUrl(t){const i=this.servers.find(r=>r.name===t);return i?(this.currentServer=i,this.apiUrl=`${this.isProduction?"https":"http"}://${this.isProduction?"jeffreysanford.us":"localhost"}:${i.port}/${i.api}`,console.log(`API Service: API URL set to ${this.apiUrl}`)):(this.apiUrl="",console.error(`API Service: Server with name '${t}' not found`)),this.apiUrl}getApiUrl(){return this.apiUrl}setRecordSize(t){this.recordSize=t,console.log(`API Service: Record size set to ${this.recordSize}`)}setServerType(t){const i=this.servers.find(r=>r.name===t);i?(this.currentServer=i,this.setApiUrl(t),console.log(`API Service: Server switched to ${i.name}`)):console.error("API Service: Server not found")}getPerformanceDetails(){console.log(`API Service: Performance details for ${this.recordSize} records on ${this.currentServer.name} server`)}generatePerformanceReport(t,i,r,a){return`Using the backend server language, ${t.language}, Mock record set of ${i} records was generated in ${r} and delivered in ${a}.`}static#e=this.\u0275fac=function(i){return new(i||e)(un(k_))};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),VL=(()=>{class e{constructor(t){this.apiService=t,this.selectedUserID="0000000"}getRecordByUID(t){const i=`records/${t}`;return console.log(`Fetching record by UID: ${t} from URL: ${this.apiService.getApiUrl()}/${i}`),this.apiService.get(i)}getAllRecords(){const t="records";return console.log(`Fetching all records from URL: ${this.apiService.getApiUrl()}/${t}`),this.apiService.get(t).pipe(rs(i=>(console.error("Error: getAllRecords failed:",i),vn([]))))}addRecord(t){const i="records";return console.log(`Adding record to URL: ${this.apiService.getApiUrl()}/${i}`),this.apiService.post(i,t)}setSelectedUID(t){console.log(`Setting selected user ID: ${t}`),this.selectedUserID=t}getSelectedUID(){return console.log(`Getting selected user ID: ${this.selectedUserID}`),this.selectedUserID}generateNewRecordSet(t){const i=`records/generate?count=${t}`;return console.log(`Generating new record set with count: ${t} from URL: ${this.apiService.getApiUrl()}/${i}`),this.apiService.get(i).pipe(rs(r=>(console.error("Error: generateNewRecordSet failed:",r),vn([]))))}getCreationTime(){const t="records/time";return console.log(`Fetching creation time from URL: ${this.apiService.getApiUrl()}/${t}`),this.apiService.get(t).pipe(rs(i=>(console.error("Error: getCreationTime failed:",i),vn(0))))}setServerResource(t){return console.log(`Setting server resource: ${t}`),this.apiService.setApiUrl(t)}static#e=this.\u0275fac=function(i){return new(i||e)(un(Fq))};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})(),c0e=(()=>{class e{transform(t){return t.reduce((i,r)=>i+r.annualSalary,0)}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275pipe=Xl({name:"employmentIncome",type:e,pure:!0,standalone:!1})}return e})();const d0e=["filterInput"],DT=e=>({fadeToRed:e}),u0e=()=>["expandedDetail"],h0e=()=>[5,25,100];function f0e(e,n){1&e&&(Fe(0,"div",38),_n(1,"mat-progress-spinner",39),Ue()),2&e&&(Ze(),Ia("color","teal"),At("diameter",100))}function p0e(e,n){if(1&e&&(Fe(0,"mat-option",40),gt(1),Ue()),2&e){const t=n.$implicit;At("value",t),Ze(),Sr(" ",t," ")}}function m0e(e,n){if(1&e&&(Fe(0,"mat-option",40),gt(1),Ue()),2&e){const t=n.$implicit;At("value",t.name),Ze(),Sr(" ",t.name," ")}}function g0e(e,n){1&e&&(Fe(0,"th",41),gt(1,"User ID"),Ue())}function _0e(e,n){if(1&e&&(Fe(0,"td",42),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t.UID)}}function y0e(e,n){1&e&&(Fe(0,"th",41),gt(1,"Name"),Ue())}function v0e(e,n){if(1&e&&(Fe(0,"td",42),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),cx("",t.firstName,"\xa0",t.lastName,"")}}function b0e(e,n){1&e&&(Fe(0,"th",41),gt(1,"Address"),Ue())}function x0e(e,n){if(1&e&&(Fe(0,"td",42),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t.address.street)}}function w0e(e,n){1&e&&(Fe(0,"th",41),gt(1,"City"),Ue())}function C0e(e,n){if(1&e&&(Fe(0,"td",42),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t.address.city)}}function T0e(e,n){1&e&&(Fe(0,"th",41),gt(1,"State"),Ue())}function M0e(e,n){if(1&e&&(Fe(0,"td",42),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t.address.state)}}function S0e(e,n){1&e&&(Fe(0,"th",41),gt(1,"Zip"),Ue())}function E0e(e,n){if(1&e&&(Fe(0,"td",42),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t.address.zipcode)}}function D0e(e,n){1&e&&(Fe(0,"th",41),gt(1,"Phone"),Ue())}function I0e(e,n){if(1&e&&(Fe(0,"td",42),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t.phone.number)}}function k0e(e,n){1&e&&(Fe(0,"th",43),gt(1,"Actions"),Ue())}function A0e(e,n){if(1&e){const t=Is();Fe(0,"td",42)(1,"button",44),Nn("click",function(){const r=Di(t).$implicit;return Ii(cn().showDetailView(r))}),Fe(2,"mat-icon"),gt(3,"person"),Ue()()()}}function R0e(e,n){if(1&e&&(Fe(0,"li")(1,"p"),gt(2),Iv(3,"currency"),Ue()()),2&e){const t=n.$implicit;Ze(2),cx("Company: ",t.companyName," (",kv(3,2,t.annualSalary),")")}}function P0e(e,n){if(1&e&&(Fe(0,"td",42)(1,"div",45)(2,"div",46)(3,"strong"),gt(4,"Employment Income:"),Ue(),Fe(5,"ul"),an(6,R0e,4,4,"li",47),Ue(),Fe(7,"strong"),gt(8),Iv(9,"employmentIncome"),Iv(10,"currency"),Ue()()()()),2&e){const t=n.$implicit,i=cn();ui("colspan",i.displayedColumns.length),Ze(),At("@detailExpand",t===i.expandedElement?"expanded":"collapsed"),Ze(),At("@flyIn",void 0),Ze(4),At("ngForOf",t.salary),Ze(2),Sr("Total Annual Salary: ",kv(10,7,kv(9,5,t.salary)),"")}}function O0e(e,n){1&e&&_n(0,"tr",48)}function F0e(e,n){if(1&e){const t=Is();Fe(0,"tr",49),Nn("click",function(){const r=Di(t).$implicit;return Ii(cn().expandRow(r))}),Ue()}}function L0e(e,n){if(1&e&&_n(0,"tr",50),2&e){const t=n.$implicit;At("@detailExpand",cn().expandedElement===t?"expanded":"collapsed")}}function N0e(e,n){1&e&&zs(0)}function z0e(e,n){if(1&e&&(Fe(0,"div",51),an(1,N0e,1,0,"ng-container",52),Ue()),2&e){cn();const t=Za(1);Ze(),At("ngTemplateOutlet",t)}}let B0e=(()=>{class e{constructor(t,i,r){this.router=t,this.recordService=i,this.changeDetectorRef=r,this.rowExpanded=!1,this.filterValue="",this.dataSetSizes=[100,1e3,15e3,1e5,1e6],this.resolved=!1,this.dataSource=new efe,this.startTime=0,this.generationTimeLabel="",this.roundtripLabel="",this.networkPerformance="",this.diskTransferTime="",this.showAddressColumns=!0,this.showMediumColumns=!0,this.showMinimalColumns=!1,this.displayedColumns=["userID","name","address","city","state","zip","phone","icons"],this.destroy$=new Ie,this.resolvedSubject=new Je(!0),this.resolved$=this.resolvedSubject.asObservable(),this.totalRecords=100,this.newData=!1,this.records=[],this.servers=[{name:"Nest",language:"NestJS",swagger:this.getSwaggerUrl("Nest")},{name:"Go",language:"Go",swagger:this.getSwaggerUrl("Go")}],this.server=this.servers[0],this.apiURL="",this.fadeToRedClass=!1,this.dataSubject=new Je([]),this.data$=this.dataSubject.asObservable(),this.reportSubject=new Je(null),this.report$=this.reportSubject.asObservable(),console.log("Constructor: RecordListComponent created"),console.log("Initial servers:",this.servers)}onResize(t){console.log("Event: Window resized"),this.updateDisplayedColumns()}ngOnInit(){console.log("Lifecycle: ngOnInit called"),this.resolved=!1,this.startTime=(new Date).getTime();const t=this.servers[0];this.server=t,this.apiURL=this.recordService.setServerResource(t.name),this.fetchData(100),this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,this.filterInput.nativeElement.focus(),this.data$.pipe(Er(this.destroy$)).subscribe(i=>{this.dataSource.data=i,this.changeDetectorRef.detectChanges()}),this.report$.pipe(Er(this.destroy$)).subscribe(i=>{i&&(console.log("Report:",i),this.roundtripLabel=i.roundtripLabel,this.generationTimeLabel=i.generationTimeLabel,this.networkPerformance=i.networkPerformance,this.diskTransferTime=i.diskTransferTime)})}ngOnDestroy(){console.log("Lifecycle: ngOnDestroy called"),this.destroy$.next(),this.destroy$.complete()}onTableChange(t){console.log("Event: Display row change with event:",t),this.paginator.pageSize=t.pageSize}onSelectedServerChange(t){console.log("Event (Server Name): Selected server changed with event:",t),console.log("Available servers:",this.servers);const i=this.servers.find(r=>t===r.name);i?(console.log("Found server:",i),this.apiURL=this.recordService.setServerResource(i.name),this.clearDataSource(),this.server=i,console.log("Server: Selected server updated to:",this.server.name),this.fetchData(this.totalRecords)):console.error("Error: No matching server found for event:",t)}updateDisplayedColumns(){console.log("Method: updateDisplayedColumns called");const t=window.innerWidth;t<800?(this.displayedColumns=["userID","icons"],console.log("Displayed Columns: Width < 800, updated to:",this.displayedColumns)):t<900?(this.displayedColumns=["userID","name","icons"],console.log("Displayed Columns: Width < 900, updated to:",this.displayedColumns)):t<1e3?(this.displayedColumns=["userID","name","icons"],console.log("Displayed Columns: Width < 1000, updated to:",this.displayedColumns)):t<1200?(this.displayedColumns=["userID","name","state","zip","icons"],console.log("Displayed Columns: Width < 1200, updated to:",this.displayedColumns)):t<1400?(this.displayedColumns=["userID","name","city","state","zip","icons"],console.log("Displayed Columns: Width < 1400, updated to:",this.displayedColumns)):(this.displayedColumns=["userID","name","address","city","state","zip","phone","icons"],console.log("Displayed Columns: Width >= 1400, updated to:",this.displayedColumns))}onDatasetChange(t){this.resolved=!1,this.totalRecords=0,this.clearDataSource(),console.log("Event: Dataset change requested with count:",t),this.startTime=(new Date).getTime(),this.recordService.generateNewRecordSet(t).pipe(Er(this.destroy$),Aa(i=>(i&&(this.dataSource.data=i,this.resolved=!0,this.newData=!0,this.paginator.pageIndex=0,this.paginator.pageSize=5,this.paginator.length=i.length,this.changeDetectorRef.detectChanges(),this.dataSource.filterPredicate=(r,a)=>r.UID.toLowerCase().includes(a),this.sort={active:"userID",direction:"asc"},this.updateDisplayedColumns(),this.totalRecords=i.length,console.log("Data: New record set generated with length:",i.length),this.updateCreationTime(),this.triggerFadeToRed()),vn([]))),rs(i=>(console.error("Error: generateNewRecordSet failed:",i),this.resolvedSubject.next(!0),this.changeDetectorRef.detectChanges(),vn([])))).subscribe()}fetchData(t){this.recordService.generateNewRecordSet(t).pipe(Er(this.destroy$),Aa(i=>(i&&(this.dataSource.data=i,this.resolved=!0,this.newData=!0,this.paginator.length=i.length,this.dataSource.filterPredicate=(r,a)=>r.UID.toLowerCase().includes(a),this.sort={active:"userID",direction:"asc"},this.updateDisplayedColumns(),this.totalRecords=i.length,console.log("Data: New record set generated with length:",i.length),this.updateCreationTime(),this.triggerFadeToRed(),this.changeDetectorRef.detectChanges()),vn([]))),rs(i=>(console.error("Error: generateNewRecordSet failed:",i),this.resolvedSubject.next(!0),this.changeDetectorRef.detectChanges(),vn([])))).subscribe()}clearFilter(){console.log("Event: Clear filter requested"),this.filterValue="",this.dataSource.filter="",this.resolved=!1,console.log("Filter: Cleared")}expandRow(t){console.log("Event: Row expand requested for record:",t),this.expandedElement=this.expandedElement?.UID===t.UID?null:t,console.log("Row: Expanded state updated")}showDetailView(t){console.log("Event: Show detail view requested for record:",t),this.recordService.setSelectedUID(t.UID),this.router.navigate(["table/:",t.UID]),console.log("Navigation: Navigated to record detail view")}sortData(t){console.log("Sort: Sorting data with event:",t);const{active:i,direction:r}=t;if(!r)return;const a="asc"===r,h=[...this.dataSource.data].sort((v,C)=>{switch(i){case"UID":return this.compare(v.UID,C.UID,a);case"name":return console.log("Sort: Sorting by name"),this.compare(v.name,C.name,a);case"address":return this.compare(v.address.street,C.address.street,a);case"city":return this.compare(v.city,C.city,a);case"state":return this.compare(v.state,C.state,a);case"zip":return this.compare(v.zip,C.zip,a);case"phone":return this.compare(v.phone.number,C.phone.number,a);default:return 0}});this.dataSource.data=h,this.paginator&&this.dataSource.paginator&&this.dataSource.paginator.firstPage(),console.log("Sort: Data sorted successfully")}compare(t,i,r){return null==t||null==i?0:(t<i?-1:t>i?1:0)*(r?1:-1)}applyFilter(t){console.log("Event: Filter applied with event:",t);const i=t.target.value;(i.length>=2||""===i)&&(this.dataSource.filter=i.trim().toLowerCase(),console.log("Filter: Applied with value:",i))}updateCreationTime(){this.recordService.getCreationTime().pipe(Er(this.destroy$),Vo(t=>{const i=(new Date).getTime(),r=i-this.startTime,a=r>1e3?`${(r/1e3).toFixed(2)} seconds`:`${r.toFixed(2)} milliseconds`,h=t>1e3?`${(t/1e3).toFixed(2)} seconds`:`${t.toFixed(2)} milliseconds`,v=`${(r-t).toFixed(2)} milliseconds`,C=`${(t/2).toFixed(2)} milliseconds`,P={roundtripLabel:a,generationTimeLabel:h,networkPerformance:v,diskTransferTime:C};console.log("Start Time:",this.startTime),console.log("End Time:",i),console.log("Roundtrip Time:",r),console.log("Generation Time:",t),this.reportSubject.next(P),console.log("Timing: Data generation time:",h,"Roundtrip time:",a,"Network performance:",v,"Disk transfer time:",C),this.resolvedSubject.next(!0),this.changeDetectorRef.detectChanges()}),rs(t=>(console.error("Error: getCreationTime failed:",t),this.resolvedSubject.next(!0),this.changeDetectorRef.detectChanges(),vn("")))).subscribe()}getSwaggerUrl(t){return`${"localhost"===window.location.hostname?"http://localhost":"https://jeffreysanford.us"}:${"Nest"===t?"3000":"4000"}/api/api-docs`}triggerFadeToRed(){this.fadeToRedClass=!0,setTimeout(()=>{this.fadeToRedClass=!1,this.changeDetectorRef.detectChanges()},1e3)}clearDataSource(){this.dataSource.data=[],this.changeDetectorRef.detectChanges()}onSwaggerButtonClick(){console.log("Event: Swagger button clicked"),window.open(this.server.swagger,"_blank"),console.log("Navigation: Opened Swagger UI")}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(Qa),Rt(VL),Rt(Bo))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-record-list"]],viewQuery:function(i,r){if(1&i&&(zr(ZO,7),zr(WO,7),zr(d0e,7)),2&i){let a;ri(a=oi())&&(r.sort=a.first),ri(a=oi())&&(r.paginator=a.first),ri(a=oi())&&(r.filterInput=a.first)}},hostBindings:function(i,r){1&i&&Nn("resize",function(h){return r.onResize(h)},0,v0)},standalone:!1,decls:79,vars:41,consts:[["noData",""],["filterInput",""],[1,"table-container"],[1,"record-collection"],[1,"report"],[1,"report-text"],[3,"hidden"],[3,"ngClass"],[1,"button-container"],["mat-raised-button","","color","primary",1,"swagger-button",3,"click"],[1,"selectors"],["appearance","outline"],[1,"selector",3,"valueChange","selectionChange","value"],[3,"value",4,"ngFor","ngForOf"],[1,"selector",3,"selectionChange","value"],["appearance","outline",1,"filter","mat-elevation-z8"],["matInput","","placeholder","Type to search...",3,"keyup","ngModelChange","ngModel"],["mat-icon-button","","matSuffix","",1,"clear-button",3,"click"],[1,"scrollable-container",3,"hidden"],[1,"table-wrapper"],["mat-table","","matSort","","matSortActive","userID","matSortDirection","asc","multiTemplateDataRows","",1,"mat-elevation-z8","stripped",3,"matSortChange","dataSource"],["matColumnDef","userID"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","address"],["matColumnDef","city"],["matColumnDef","state"],["matColumnDef","zip"],["matColumnDef","phone"],["matColumnDef","icons"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","expandedDetail"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","normal-row",3,"click",4,"matRowDef","matRowDefColumns"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",1,"mat-elevation-z8",3,"page","length","pageSize","pageSizeOptions"],["class","loading-container",4,"ngIf"],[1,"no-data"],["mode","indeterminate",3,"diameter"],[3,"value"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","title","view record",3,"click"],[1,"expand-element-detail"],[1,"expand-element-description"],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row","",1,"normal-row",3,"click"],["mat-row",""],[1,"loading-container"],[4,"ngTemplateOutlet"]],template:function(i,r){if(1&i){const a=Is();an(0,f0e,2,3,"ng-template",null,0,wm),Fe(2,"div",2)(3,"mat-card",3)(4,"mat-card-content")(5,"div",4)(6,"div",5)(7,"p",6),gt(8," Using the backend server language, "),Fe(9,"span",7),gt(10),Ue(),gt(11," , a mock record set of "),Fe(12,"span",7),gt(13),Ue(),gt(14," records was generated in "),Fe(15,"span",7),gt(16),Ue(),gt(17," and delivered in "),Fe(18,"span",7),gt(19),Ue(),gt(20," to the Angular frontend with a latency of "),Fe(21,"span",7),gt(22),Ue()()(),Fe(23,"div",8)(24,"button",9),Nn("click",function(){return Di(a),Ii(r.onSwaggerButtonClick())}),gt(25),Ue()()(),Fe(26,"div",10)(27,"mat-form-field",11)(28,"mat-label"),gt(29,"Select dataset size"),Ue(),Fe(30,"mat-select",12),YS("valueChange",function(v){return Di(a),SR(r.totalRecords,v)||(r.totalRecords=v),Ii(v)}),Nn("selectionChange",function(v){return Di(a),Ii(r.onDatasetChange(v.value))}),an(31,p0e,2,2,"mat-option",13),Ue()(),Fe(32,"mat-form-field",11)(33,"mat-label"),gt(34,"Select backend server"),Ue(),Fe(35,"mat-select",14),Nn("selectionChange",function(v){return Di(a),Ii(r.onSelectedServerChange(v.value))}),an(36,m0e,2,2,"mat-option",13),Ue()(),Fe(37,"mat-form-field",15)(38,"mat-label"),gt(39,"Filter"),Ue(),Fe(40,"input",16,1),Nn("keyup",function(v){return Di(a),Ii(r.applyFilter(v))}),YS("ngModelChange",function(v){return Di(a),SR(r.dataSource.filter,v)||(r.dataSource.filter=v),Ii(v)}),Ue(),Fe(42,"button",17),Nn("click",function(){return Di(a),Ii(r.clearFilter())}),Fe(43,"mat-icon"),gt(44,"close"),Ue()()()()()(),Fe(45,"div",18)(46,"div",19)(47,"table",20),Nn("matSortChange",function(v){return Di(a),Ii(r.sortData(v))}),co(48,21),an(49,g0e,2,0,"th",22)(50,_0e,2,1,"td",23),uo(),co(51,24),an(52,y0e,2,0,"th",22)(53,v0e,2,2,"td",23),uo(),co(54,25),an(55,b0e,2,0,"th",22)(56,x0e,2,1,"td",23),uo(),co(57,26),an(58,w0e,2,0,"th",22)(59,C0e,2,1,"td",23),uo(),co(60,27),an(61,T0e,2,0,"th",22)(62,M0e,2,1,"td",23),uo(),co(63,28),an(64,S0e,2,0,"th",22)(65,E0e,2,1,"td",23),uo(),co(66,29),an(67,D0e,2,0,"th",22)(68,I0e,2,1,"td",23),uo(),co(69,30),an(70,k0e,2,0,"th",31)(71,A0e,4,0,"td",23),uo(),co(72,32),an(73,P0e,11,9,"td",23),uo(),an(74,O0e,1,0,"tr",33)(75,F0e,1,0,"tr",34)(76,L0e,1,1,"tr",35),Ue()(),Fe(77,"mat-paginator",36),Nn("page",function(v){return Di(a),Ii(r.onTableChange(v))}),Ue()()(),an(78,z0e,2,1,"div",37)}2&i&&(Ze(3),At("@flyIn",void 0),Ze(4),At("hidden",!r.resolved),Ze(2),At("ngClass",xm(29,DT,r.fadeToRedClass)),Ze(),br(r.server.language),Ze(2),At("ngClass",xm(31,DT,r.fadeToRedClass)),Ze(),br(r.totalRecords),Ze(2),At("ngClass",xm(33,DT,r.fadeToRedClass)),Ze(),br(r.generationTimeLabel),Ze(2),At("ngClass",xm(35,DT,r.fadeToRedClass)),Ze(),br(r.roundtripLabel),Ze(2),At("ngClass",xm(37,DT,r.fadeToRedClass)),Ze(),br(r.networkPerformance),Ze(3),Sr("Swagger API for ",r.server.language,""),Ze(),At("@flyIn",void 0),Ze(4),ZS("value",r.totalRecords),Ze(),At("ngForOf",r.dataSetSizes),Ze(4),At("value",r.server.name),Ze(),At("ngForOf",r.servers),Ze(4),ZS("ngModel",r.dataSource.filter),Ze(5),At("hidden",!r.resolved),Ze(2),At("dataSource",r.dataSource)("@flyIn",void 0),Ze(27),At("matHeaderRowDef",r.displayedColumns),Ze(),At("matRowDefColumns",r.displayedColumns),Ze(),At("matRowDefColumns",KS(39,u0e)),Ze(),At("length",r.totalRecords)("pageSize",5)("pageSizeOptions",KS(40,h0e)),Ze(),At("ngIf",!r.resolved))},dependencies:[w_,md,qf,sC,uD,BU,qP,ZD,qC,hu,R_,P_,mde,t6,kO,sde,WO,ZO,Rhe,lF,pI,cF,mI,fI,dF,gI,_I,uF,hF,V6,wO,y8,c2,c0e],styles:[".no-data[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;width:100%;position:fixed;top:0;left:0;background-color:#0000004d;z-index:1000}.record-collection[_ngcontent-%COMP%]{height:13em;margin-bottom:1em;border-radius:.25em}.record-collection[_ngcontent-%COMP%]   .report[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;width:100%;font-size:1.25em;margin-bottom:1em}.record-collection[_ngcontent-%COMP%]   .report[_ngcontent-%COMP%]   .report-text[_ngcontent-%COMP%]{min-height:3em;flex:1;border:1px solid #0000ff;border-radius:.25em;color:#00008b;margin-right:1em;padding:.25em .5em}.record-collection[_ngcontent-%COMP%]   .report[_ngcontent-%COMP%]   .swagger-button[_ngcontent-%COMP%], .record-collection[_ngcontent-%COMP%]   .report[_ngcontent-%COMP%]   .button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.record-collection[_ngcontent-%COMP%]   .report[_ngcontent-%COMP%]   .swagger-button[_ngcontent-%COMP%]{border:1px solid blue;background-color:#fff;color:teal;padding:.5em 1em;border-radius:.25em;cursor:pointer;transition:background-color .3s ease,color .3s ease}.record-collection[_ngcontent-%COMP%]   .report[_ngcontent-%COMP%]   .swagger-button[_ngcontent-%COMP%]:hover{background-color:#00008b;color:#fff}.record-collection[_ngcontent-%COMP%]   .selectors[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;padding:.25em}.record-collection[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%], .record-collection[_ngcontent-%COMP%]   .mat-paginator[_ngcontent-%COMP%]{padding:.55em;width:99%;height:77vh;display:flex;flex-direction:column;flex-grow:1;overflow:hidden}.record-collection[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]{display:block;max-height:29em;overflow-x:auto;white-space:nowrap;flex-grow:1}.record-collection[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]{position:sticky;top:0;border:1px solid #008080;color:teal;text-align:left;z-index:1;padding:.25em;line-height:1em;height:1em;margin:.25em}.record-collection[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:last-child, .record-collection[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]:last-child{text-align:right}.record-collection[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{display:block;max-height:29em;overflow-y:auto}.record-collection[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .record-collection[_ngcontent-%COMP%]   .table-wrapper[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}[_nghost-%COMP%]     .mat-mdc-table thead th{background-color:#00008b;color:#fff}[_nghost-%COMP%]     .mat-mdc-table thead th .mat-sort-header-arrow{color:teal}[_nghost-%COMP%]     .mat-mdc-table thead tbody td .odd-row{background-color:#f5fffa}[_nghost-%COMP%]     .mat-mdc-table thead tbody td .even-row{background-color:#fff}[_nghost-%COMP%]     .mat-mdc-table thead tbody td :hover{background-color:#add8e6}@keyframes _ngcontent-%COMP%_flyIn{0%{transform:translate(-100%)}to{transform:translate(0)}}.flyIn[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_flyIn 1s ease-in-out}@keyframes _ngcontent-%COMP%_fadeToRed{0%,to{color:inherit}50%{color:red}}.fadeToRed[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeToRed 2s ease-in-out}"],data:{animation:[s0e,a0e]}})}return e})();const V0e=()=>["totalSalary"];function U0e(e,n){1&e&&_n(0,"mat-progress-spinner",3),2&e&&(Ia("color","lightblue"),At("diameter",100))}function j0e(e,n){1&e&&(Fe(0,"th",19),gt(1," Company "),Ue())}function H0e(e,n){if(1&e&&(Fe(0,"td",20),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),Sr(" ",t.companyName," ")}}function $0e(e,n){1&e&&(Fe(0,"th",19),gt(1," Salary "),Ue())}function G0e(e,n){if(1&e&&(Fe(0,"td",20),gt(1),Iv(2,"currency"),Ue()),2&e){const t=n.$implicit;Ze(),Sr(" ",kv(2,1,t.annualSalary)," ")}}function q0e(e,n){if(1&e&&(Fe(0,"td",21)(1,"p"),gt(2),Iv(3,"currency"),Ue()()),2&e){const t=cn(2);Ze(2),Sr("Total Annual Income: ",kv(3,1,t.getTotalSalary()),"")}}function W0e(e,n){1&e&&_n(0,"tr",22)}function Z0e(e,n){1&e&&_n(0,"tr",23)}function Y0e(e,n){1&e&&_n(0,"tr",24)}function X0e(e,n){if(1&e&&(Fe(0,"div",4,0)(2,"div",5)(3,"mat-card",6)(4,"mat-card-header")(5,"p")(6,"strong"),gt(7,"Name:"),Ue(),gt(8),Ue()(),Fe(9,"mat-card-content")(10,"mat-card-title"),gt(11,"User Address"),Ue(),Fe(12,"p")(13,"strong"),gt(14,"Address:"),Ue(),gt(15),Ue(),Fe(16,"p")(17,"strong"),gt(18,"City:"),Ue(),gt(19),Ue(),Fe(20,"p")(21,"strong"),gt(22,"State:"),Ue(),gt(23),Ue(),Fe(24,"p")(25,"strong"),gt(26,"Zipcode:"),Ue(),gt(27),Ue(),Fe(28,"p")(29,"strong"),gt(30,"Telephone:"),Ue(),gt(31),Ue()()()(),_n(32,"br"),Fe(33,"div",7)(34,"mat-card",8)(35,"mat-card-header")(36,"mat-card-title"),gt(37,"Company Group"),Ue()(),Fe(38,"mat-card-content")(39,"table",9),co(40,10),an(41,j0e,2,0,"th",11)(42,H0e,2,1,"td",12),uo(),co(43,13),an(44,$0e,2,0,"th",11)(45,G0e,3,3,"td",12),uo(),co(46,14),an(47,q0e,4,3,"td",15),uo(),an(48,W0e,1,0,"tr",16)(49,Z0e,1,0,"tr",17)(50,Y0e,1,0,"tr",18),Ue()()()()()),2&e){const t=cn();Ze(8),cx(" ",t.user.firstName," ",t.user.lastName,""),Ze(7),Sr(" ",t.user.address.street,""),Ze(4),Sr(" ",t.user.address.city,""),Ze(4),Sr(" ",t.user.address.state,""),Ze(4),Sr(" ",t.user.address.zipcode,""),Ze(4),Sr(" (",t.user.phone.number,")"),Ze(8),At("dataSource",t.user.salary),Ze(9),At("matHeaderRowDef",t.salaryDisplayedColumns),Ze(),At("matRowDefColumns",t.salaryDisplayedColumns),Ze(),At("matFooterRowDef",KS(11,V0e))}}let K0e=(()=>{class e{constructor(t,i){this.recordService=t,this.router=i,this.totalAnnualSalary=0,this.selectedUserId=t.getSelectedUID(),"0000000"===this.selectedUserId&&this.router.navigate(["/records"]),this.userSub=this.recordService.getRecordByUID(this.selectedUserId).subscribe(r=>{this.user=r,this.user.phone=r.phone,this.user.address=r.address})}ngOnDestroy(){this.userSub&&this.userSub.unsubscribe()}ngOnInit(){this.salaryDisplayedColumns=["company","salary"]}getTotalSalary(){return this.totalAnnualSalary=0,this.user?.salary.forEach(t=>{this.totalAnnualSalary+=t.annualSalary}),this.totalAnnualSalary}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(VL),Rt(Qa))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-record-detail"]],standalone:!1,decls:2,vars:2,consts:[["loading",""],["mode","indeterminate",3,"diameter","color",4,"ngIf"],["else","",4,"ngIf"],["mode","indeterminate",3,"diameter"],["else",""],[1,"personal-info"],[1,"address-card"],[1,"companies"],[1,"company-card"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","company"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","salary"],["matColumnDef","totalSalary"],["mat-footer-cell","",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef"],["mat-header-cell",""],["mat-cell",""],["mat-footer-cell",""],["mat-header-row",""],["mat-row",""],["mat-footer-row",""]],template:function(i,r){1&i&&an(0,U0e,1,3,"mat-progress-spinner",1)(1,X0e,51,12,"div",2),2&i&&(At("ngIf",!r.user),Ze(),At("ngIf",r.user))},dependencies:[qf,hu,R_,WC,Bx,lF,pI,cF,mI,fI,dF,t8,i8,gI,_I,n8,uF,hF,r8,y8,c2],styles:["mat-progress-spinner[_ngcontent-%COMP%]{margin:25% auto}.mat-progress-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{stroke:#add8e6!important}.address-card[_ngcontent-%COMP%]{max-width:50%;margin:1em auto 0;background:#f5f5f5;border-radius:.5em;box-shadow:0 4px 8px #0003}.address-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff}.address-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:24px}.address-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0}.company-card[_ngcontent-%COMP%]{max-width:50%;margin:auto;background:#f5f5f5;border-radius:4px;box-shadow:0 4px 8px #0003}.company-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff}.company-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:24px}.company-card[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:calc(100% - 1em);margin:1em .5em 0;border-collapse:collapse}.company-card[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#3f51b5;color:#fff;font-size:1.25em;font-weight:700;padding:8px;text-align:left;z-index:1}.company-card[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;text-align:left}"]})}return e})();function Q0e(e,n){if(1&e&&(Fe(0,"div",2)(1,"mat-icon"),gt(2),Ue(),Fe(3,"span"),gt(4),Ue()()),2&e){const t=n.$implicit,i=n.index;At("ngClass",cn().getTileClass(i)),Ze(2),br(t),Ze(2),br(t)}}let J0e=(()=>{class e{constructor(){this.materialIcons=["home","favorite","search","account_circle","alarm","settings","check_circle","thumb_up","delete","info","warning","shopping_cart","help","star","lock","visibility","attach_file","photo_camera","event","email","print","save","download","upload","cloud_upload","refresh","share","edit","arrow_forward","cancel","folder","file_copy","cloud","phone","map","place","location_on","directions","local_offer","local_hospital","local_shipping","restaurant","flight","hotel","directions_car","directions_bike","directions_bus","directions_walk","train","subway","tram","directions_boat","local_pizza","fastfood","local_cafe","local_bar","beach_access","local_florist","local_mall","shopping_bag","store","attach_money","local_grocery_store","local_gas_station","local_pharmacy","local_laundry_service","local_library","local_movies","local_dining","local_hotel","local_activity","local_car_wash","local_atm","local_post_office","local_printshop","local_see","local_drink","local_play","local_convenience_store","local_parking","local_taxi","local_airport_shuttle","local_phone","local_airport","local_parking","local_fire_department","local_police","local_emergency","local_drugstore","local_baby_care","local_gym","local_office","local_fitness_center","local_library_books","local_child_care","local_forest","local_wildlife","local_park","local_travel"]}getTileClass(t){const i=["red-tile","blue-tile","white-tile"];return console.log("index",t),console.log("color",i[t%i.length]),i[t%i.length]}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-material-icons"]],standalone:!1,decls:2,vars:1,consts:[[1,"icons-container"],["class","icon-item",3,"ngClass",4,"ngFor","ngForOf"],[1,"icon-item",3,"ngClass"]],template:function(i,r){1&i&&(Fe(0,"div",0),an(1,Q0e,5,3,"div",1),Ue()),2&i&&(Ze(),At("ngForOf",r.materialIcons))},dependencies:[w_,md,P_],styles:[".icons-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:16px;padding:16px}.icon-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100px;height:100px;border:1px solid #ccc;border-radius:8px;padding:8px;box-shadow:0 2px 4px #0000001a;background-color:#fff}.icon-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:8px}.icon-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;text-align:center}.red-tile[_ngcontent-%COMP%]{background-color:red;color:#fff}.blue-tile[_ngcontent-%COMP%]{background-color:#00f;color:#fff}.white-tile[_ngcontent-%COMP%]{background-color:#fff;color:#000}"]})}return e})(),exe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-material-buttons"]],standalone:!1,decls:43,vars:0,consts:[[1,"container"],[1,"button-grid"],[1,"button-card"],["mat-button","",1,"elevated-button"],["mat-raised-button","",1,"elevated-button"],["mat-flat-button","",1,"elevated-button"],["mat-stroked-button","",1,"elevated-button"],["mat-icon-button","",1,"elevated-button"],["svgIcon","thumbs-up"],["mat-fab","",1,"elevated-button"],["mat-mini-fab","",1,"elevated-button"],["mat-fab","","color","primary","aria-label","Example icon button with a heart icon",1,"elevated-button"]],template:function(i,r){1&i&&(Fe(0,"div",0)(1,"h1"),gt(2,"Material Buttons Showcase"),Ue(),Fe(3,"p"),gt(4,"Explore various types of Material buttons with different styles and icons."),Ue(),Fe(5,"div",1)(6,"mat-card",2)(7,"mat-card-title"),gt(8,"Basic Buttons"),Ue(),Fe(9,"mat-card-content")(10,"button",3),gt(11,"Click me!"),Ue(),Fe(12,"button",4),gt(13,"Click me!"),Ue(),Fe(14,"button",5),gt(15,"Click me!"),Ue(),Fe(16,"button",6),gt(17,"Click me!"),Ue()()(),Fe(18,"mat-card",2)(19,"mat-card-title"),gt(20,"Icon Buttons"),Ue(),Fe(21,"mat-card-content")(22,"button",7)(23,"mat-icon"),gt(24,"menu"),Ue()(),Fe(25,"button",3),_n(26,"mat-icon",8),gt(27," Click me! "),Ue()()(),Fe(28,"mat-card",2)(29,"mat-card-title"),gt(30,"Fab Buttons"),Ue(),Fe(31,"mat-card-content")(32,"button",9)(33,"mat-icon"),gt(34,"favorite"),Ue()(),Fe(35,"button",10)(36,"mat-icon"),gt(37,"favorite"),Ue()(),Fe(38,"button",11)(39,"mat-icon"),gt(40,"favorite"),Ue(),Fe(41,"span"),gt(42,"Favorite"),Ue()()()()()())},dependencies:[ZD,qC,AH,Kle,hu,R_,Bx,P_],styles:[".container[_ngcontent-%COMP%]{text-align:center;padding:20px;background-color:#ff00001a;color:#000}.container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000}.button-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;gap:20px;margin-top:20px}.button-card[_ngcontent-%COMP%]{width:250px;padding:15px;background-color:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a}.button-card[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:16px;color:red}.button-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.button-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px 0}.elevated-button[_ngcontent-%COMP%]{box-shadow:0 4px 6px #0000001a;transition:box-shadow .3s ease}.elevated-button[_ngcontent-%COMP%]:hover{box-shadow:0 8px 12px #0003}button.mat-raised-button-primary[_ngcontent-%COMP%]{background-color:red;color:#f99}button.mat-raised-button-primary[_ngcontent-%COMP%]:hover{background-color:#c00}button.mat-raised-button-accent[_ngcontent-%COMP%]{background-color:#f99;color:red}button.mat-raised-button-accent[_ngcontent-%COMP%]:hover{background-color:#e66}button.mat-raised-button-warn[_ngcontent-%COMP%]{background-color:red;color:#fff}button.mat-raised-button-warn[_ngcontent-%COMP%]:hover{background-color:#c00}.button[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{color:#000}"]})}return e})(),UL=(()=>{class e{constructor(t){this.apiService=t,this.endpoint="recipes"}getRecipes(){return console.log("Fetching all recipes"),this.apiService.get(this.endpoint).pipe(Vo(t=>console.log(`Retrieved ${t.length} recipes`)),rs(t=>(console.error("Error fetching recipes:",t),vn([]))))}setRecipe(t){console.log("Setting current recipe:",t.id),this.recipe=t}getRecipe(){if(!this.recipe)throw new Error("No recipe currently selected");return console.log("Getting current recipe:",this.recipe.id),this.recipe}addRecipe(t){return console.log("Adding new recipe:",t),this.apiService.post(this.endpoint,t).pipe(Vo(i=>console.log("Created recipe:",i.id)),rs(i=>{throw console.error("Error creating recipe:",i),i}))}updateRecipe(t){return console.log("Updating recipe:",t.id),this.apiService.put(`${this.endpoint}/${t.id}`,t).pipe(Vo(i=>console.log("Updated recipe:",i.id)),rs(i=>{throw console.error("Error updating recipe:",i),i}))}deleteRecipe(t){return console.log("Deleting recipe:",t),this.apiService.delete(`${this.endpoint}/${t}`).pipe(Vo(()=>console.log("Deleted recipe:",t)),rs(i=>{throw console.error("Error deleting recipe:",i),i}))}static#e=this.\u0275fac=function(i){return new(i||e)(un(Fq))};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})();function txe(e,n){if(1&e&&(Fe(0,"li"),gt(1),Ue()),2&e){const t=n.$implicit;Ze(),br(t)}}function nxe(e,n){if(1&e&&(Fe(0,"div")(1,"p",10),gt(2),Ue()()),2&e){const t=n.$implicit;Ze(2),br(t)}}function ixe(e,n){if(1&e&&(Fe(0,"mat-card",1)(1,"mat-card-title-group")(2,"mat-icon",2),gt(3,"local_restaurant"),Ue(),Fe(4,"mat-card-title"),gt(5),Ue()(),Fe(6,"mat-card-content",3)(7,"div",4),gt(8),Ue(),Fe(9,"div",5)(10,"strong"),gt(11,"Country of Origin:"),Ue(),gt(12),Ue(),Fe(13,"div",6)(14,"strong"),gt(15,"Serving Size:"),Ue(),gt(16),Ue(),Fe(17,"div",7)(18,"strong"),gt(19,"Ingredients:"),Ue(),Fe(20,"ul"),an(21,txe,2,1,"li",8),Ue()(),Fe(22,"div",9)(23,"strong"),gt(24,"Directions:"),Ue(),an(25,nxe,3,1,"div",8),Ue()()()),2&e){const t=cn();Ze(5),br(t.recipe.name),Ze(3),br(t.recipe.description),Ze(4),Sr(" ",t.recipe.countryOfOrigin," "),Ze(4),Sr(" ",t.recipe.servingSize," "),Ze(5),At("ngForOf",t.recipe.ingredients),Ze(4),At("ngForOf",t.recipe.directions)}}let rxe=(()=>{class e{constructor(t,i){this.recipeService=t,this.router=i}ngOnInit(){this.recipe=this.recipeService.getRecipe(),this.recipe||this.router.navigate(["/peasant-kitchen"])}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(UL),Rt(Qa))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-recipe"]],standalone:!1,decls:1,vars:1,consts:[["class","card mat-elevation-z4",4,"ngIf"],[1,"card","mat-elevation-z4"],[1,"recipe-icon"],[1,"card-description"],[1,"description"],[1,"country-of-origin"],[1,"serving-size"],[1,"ingredients"],[4,"ngFor","ngForOf"],[1,"directions"],[1,"step"]],template:function(i,r){1&i&&an(0,ixe,26,6,"mat-card",0),2&i&&At("ngIf",r.recipe)},dependencies:[md,qf,hu,R_,Bx,RH,P_],styles:[".card[_ngcontent-%COMP%]{overflow-x:hidden;overflow-y:auto;position:relative;top:10em;width:100%;box-sizing:border-box;margin-top:20px}.serving-size[_ngcontent-%COMP%]{border:1px solid green;padding:10px;margin-top:10px}.ingredients[_ngcontent-%COMP%]{border:1px solid blue;padding:10px;margin-top:10px}.directions[_ngcontent-%COMP%]{border:1px solid orange;padding:10px;margin-top:10px}.card[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.card[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:linear-gradient(to bottom,red,#fff,#00f);border-radius:10px}.card[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:linear-gradient(to bottom,#8b0000,#d3d3d3,#00008b)}"]})}return e})();function oxe(e,n){if(1&e){const t=Is();co(0),Fe(1,"mat-card",5),Nn("click",function(){const r=Di(t).$implicit;return Ii(cn(2).navigateToRecipe(r))}),Fe(2,"mat-icon",6),gt(3,"restaurant"),Ue(),Fe(4,"mat-card-title",7),gt(5),Ue(),Fe(6,"button",8),Nn("click",function(){const r=Di(t).$implicit;return Ii(cn(2).navigateToRecipe(r))}),Fe(7,"mat-icon"),gt(8,"arrow_forward"),Ue()()(),uo()}if(2&e){const t=n.$implicit;Ze(5),br(t.name)}}function sxe(e,n){if(1&e&&(co(0),an(1,oxe,9,1,"ng-container",4),uo()),2&e){const t=cn();Ze(),At("ngForOf",t.recipes)}}function axe(e,n){1&e&&(co(0),Fe(1,"p"),gt(2,"No recipes available."),Ue(),uo())}function lxe(e,n){if(1&e&&an(0,axe,3,0,"ng-container",3),2&e){const t=cn(),i=Za(5);At("ngIf",t.loaded)("ngIfElse",i)}}function cxe(e,n){1&e&&(Fe(0,"p"),gt(1,"Loading recipes..."),Ue())}const dxe=[{path:"home",component:Y8},{path:"table",component:B0e},{path:"table/:id",component:K0e},{path:"data-visualizations",component:o0e},{path:"peasant-kitchen",component:Jfe,children:[{path:"",component:(()=>{class e{constructor(t,i){this.peasantKitchenService=t,this.router=i,this.recipes=[],this.loaded=!1,this.allRecipes=!0}ngOnDestroy(){this.recipeSubscription&&this.recipeSubscription.unsubscribe()}ngOnInit(){this.recipeSubscription=this.peasantKitchenService.getRecipes().subscribe({next:t=>{this.recipes=t,this.loaded=!0},error:t=>{console.error("Error fetching recipes:",t),this.loaded=!1},complete:()=>{console.log("Recipe fetch complete")}})}navigateToRecipe(t){console.log("Navigating to recipe:",t),this.peasantKitchenService.setRecipe(t),this.router.navigate([`/peasant-kitchen/recipe/:${t.url}`])}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(UL),Rt(Qa))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-recipes"]],standalone:!1,decls:6,vars:2,consts:[["noRecipesOrLoading",""],["loading",""],[1,"content"],[4,"ngIf","ngIfElse"],[4,"ngFor","ngForOf"],[1,"recipe-card",3,"click"],[1,"recipe-icon"],[1,"recipe-title"],["mat-mini-fab","","color","primary",1,"recipe-button",3,"click"]],template:function(i,r){if(1&i&&(Fe(0,"mat-card",2),an(1,sxe,2,1,"ng-container",3)(2,lxe,1,2,"ng-template",null,0,wm)(4,cxe,2,0,"ng-template",null,1,wm),Ue()),2&i){const a=Za(3);Ze(),At("ngIf",r.loaded&&r.recipes.length>0)("ngIfElse",a)}},dependencies:[md,qf,AH,hu,Bx,P_],styles:[".content[_ngcontent-%COMP%]{padding:2em;width:88%;flex-grow:1;overflow:auto;z-index:1;display:grid;grid-template-columns:repeat(auto-fill,minmax(12em,1fr));gap:16px;background-color:#0000004d}.content[_ngcontent-%COMP%]   mat-card.recipe-card[_ngcontent-%COMP%]{width:100%;height:12em;border:1px solid blue;padding:1em;position:relative;display:flex;flex-direction:column;justify-content:space-between;align-items:flex-start;text-align:left}.content[_ngcontent-%COMP%]   .recipe-card[_ngcontent-%COMP%]   .recipe-icon[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .recipe-icon[_ngcontent-%COMP%]{position:absolute;top:.5em;right:.5em;font-size:2em}.content[_ngcontent-%COMP%]   .recipe-card[_ngcontent-%COMP%]   .recipe-title[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .recipe-title[_ngcontent-%COMP%]{font-size:.8em;white-space:normal;overflow:hidden;text-overflow:ellipsis;width:90%;text-align:left;padding:.5em 0;background-color:#fffc}.content[_ngcontent-%COMP%]   .recipe-card[_ngcontent-%COMP%]   .recipe-button[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   .recipe-button[_ngcontent-%COMP%]{position:absolute;bottom:.5em;right:.5em}"]})}return e})()},{path:"recipe/:id",component:rxe}]},{path:"space-video",component:tpe},{path:"material-icons",component:J0e},{path:"material-buttons",component:exe},{path:"resume",component:(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-resume"]],decls:4,vars:0,consts:[[1,"pdf-container"],["data",d0`../../../assets/documents/Resume - Jeffrey Sanford - Web Developer.pdf`,"type","application/pdf","width","100%","height","600px"]],template:function(i,r){1&i&&(Fe(0,"div",0)(1,"object",1)(2,"p"),gt(3,"It appears you don't have a PDF plugin for this browser."),Ue()()())},styles:[".pdf-container[_ngcontent-%COMP%]{border:2px solid green;padding:10px}"]})}return e})()},{path:"404",component:Y8},{path:"",redirectTo:"/home",pathMatch:"full"},{path:"**",redirectTo:"/404"}],uxe=["drawer"],hxe=e=>({active:e});function fxe(e,n){if(1&e&&(Fe(0,"span",6),gt(1),Ue()),2&e){const t=cn().$implicit;Ti("collapsed",cn().isCollapsed),Ze(),br(t.label)}}function pxe(e,n){if(1&e){const t=Is();Fe(0,"mat-nav-list",3)(1,"button",4),Nn("click",function(){const r=Di(t).$implicit;return Ii(cn().setActive(r))}),Fe(2,"mat-icon"),gt(3),Ue(),an(4,fxe,2,3,"span",5),Ue()()}if(2&e){const t=n.$implicit,i=cn();Ze(),Ti("mat-elevation-z8",t.active)("collapsed",i.isCollapsed),At("routerLink",t.routerLink)("ngClass",xm(8,hxe,t.active)),Ze(2),br(t.icon),Ze(),At("ngIf",!i.isCollapsed)}}let mxe=(()=>{class e{constructor(t,i){this.breakpointObserver=t,this.router=i,this.sidebarToggle=new Dt,this.isSmallScreen=!1,this.isCollapsed=!1,this.isMobile=!1,this.menuGroups=[{title:"Main",icon:"home",items:[{icon:"home",label:"Home",routerLink:"/home",active:!0},{icon:"table_chart",label:"Table",routerLink:"/table",active:!1},{icon:"bar_chart",label:"Data Visualizations",routerLink:"/data-visualizations",active:!1},{icon:"restaurant",label:"Peasant Kitchen",routerLink:"/peasant-kitchen",active:!1},{icon:"movie",label:"HTML Video",routerLink:"/space-video",active:!1}]}],this.menuItems=this.menuGroups.reduce((r,a)=>r.concat(a.items),[])}ngOnInit(){this.breakpointObserver.observe([pO_Handset]).subscribe(t=>{this.isMobile=t.matches}),this.router.events.subscribe(()=>{const t=this.router.url;this.menuItems.forEach(i=>{i.active=i.routerLink===t})})}onResize(t){this.isCollapsed=t.target.innerWidth<900,this.isSmallScreen=!0,this.sidebarToggle.emit(!this.isCollapsed)}toggleCollapse(){this.isCollapsed=!this.isCollapsed,this.sidebarToggle.emit(!this.isCollapsed)}setActive(t){this.menuItems.forEach(i=>i.active=!1),t.active=!0}getActiveItemLabel(){const t=this.menuItems.find(i=>i.active);return t?t.label:""}toggleMenu(){this.isCollapsed=!this.isCollapsed,this.isSmallScreen&&this.drawer.toggle()}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(zD),Rt(Qa))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-sidebar"]],viewQuery:function(i,r){if(1&i&&zr(uxe,5),2&i){let a;ri(a=oi())&&(r.drawer=a.first)}},hostVars:2,hostBindings:function(i,r){1&i&&Nn("resize",function(h){return r.onResize(h)},0,v0),2&i&&Ti("collapsed",r.isCollapsed)},inputs:{isSmallScreen:"isSmallScreen",isCollapsed:"isCollapsed"},outputs:{sidebarToggle:"sidebarToggle"},standalone:!1,decls:5,vars:4,consts:[[1,"sidebar-container"],["class","sidenav",4,"ngFor","ngForOf"],["mat-icon-button","",1,"toggle",3,"click"],[1,"sidenav"],["mat-raised-button","",1,"mat-elevation-z10","menu-item",3,"click","routerLink","ngClass"],["class","menu-text",3,"collapsed",4,"ngIf"],[1,"menu-text"]],template:function(i,r){1&i&&(Fe(0,"div",0),an(1,pxe,5,10,"mat-nav-list",1),Fe(2,"button",2),Nn("click",function(){return r.toggleMenu()}),Fe(3,"mat-icon"),gt(4),Ue()()()),2&i&&(Ti("collapsed",r.isCollapsed),Ze(),At("ngForOf",r.menuItems),Ze(3),Sr(" ",r.isCollapsed?"menu_closed":"menu_open"," "))},dependencies:[w_,md,qf,ZD,qC,P_,Ude,dD],styles:[".sidebar-container[_ngcontent-%COMP%]{background-color:#00f3;padding:1em;height:100%;margin:0 0 0 .125em;border-radius:.25em}.sidebar-container.collapsed[_ngcontent-%COMP%]{width:7em}.sidebar-container[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]{position:absolute;top:38em;left:2em;right:0;color:#0ff;border:1px solid #00FFFF;font-size:1em;cursor:pointer;transition:color .3s ease}.sidebar-container[_ngcontent-%COMP%]   .toggle[_ngcontent-%COMP%]:hover{color:teal}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin:0 .25em;width:13em;height:3em;line-height:1.25em;text-align:right;border-radius:.25em;border:1px solid darkblue;outline:.1em solid rgba(4,0,252,.3);background-color:#0400fcb3!important;color:#fff}.menu-item.collapsed[_ngcontent-%COMP%]{width:5em;margin:0 auto}.menu-item[_ngcontent-%COMP%]:hover{transform:scale(1.1);outline-color:#6021f3cc;box-shadow:0 .375em 1.25em #00000026,0 0 .9375em #2196f34d}.menu-item.active[_ngcontent-%COMP%]{outline-color:#21ecf3cc;box-shadow:0 .375em 1.25em #00000026,0 0 .9375em #21c2f34d;color:#0ff}.menu-item.active[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .menu-item.active[_ngcontent-%COMP%]   .menu-text[_ngcontent-%COMP%]{color:#0ff}.menu-item[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:2.25em;height:1em;width:2em;margin:.25em .25em .25em 0;text-align:left;transition:transform .3s ease}.menu-item[_ngcontent-%COMP%]   .menu-text[_ngcontent-%COMP%]{color:#fff;flex-grow:1;text-align:right;opacity:1;transform:translate(-1.25em);transition:all .3s cubic-bezier(.4,0,.2,1)}.sidebar[_ngcontent-%COMP%]{color:#fff;width:250px;background-color:#f8f9fa;padding:15px;border-right:1px solid #dee2e6}.sidebar[_ngcontent-%COMP%]   .sidebar-header[_ngcontent-%COMP%]{font-size:18px;font-weight:700;margin-bottom:10px}.sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .sidebar-item[_ngcontent-%COMP%]{padding:10px;transition:background-color .3s}.sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .sidebar-item[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.sidebar[_ngcontent-%COMP%]   .sidebar-content[_ngcontent-%COMP%]   .sidebar-item.collapsed[_ngcontent-%COMP%]{width:7em;border:1px solid #00FFFF}.sidebar[_ngcontent-%COMP%]   .sidebar-footer[_ngcontent-%COMP%]{margin-top:auto;font-size:14px;color:#6c757d}[_nghost-%COMP%]     .collapsed .menu-item.mdc-button{padding:0 0 0 1.25em;max-width:7em}"],data:{animation:[Us("flyInOut",[Or("in",yi({transform:"translateX(0)"})),Or("out",yi({transform:"translateX(0)"})),Hr("in => out",[no("1s ease-in")]),Hr("out => in",[no("1s ease-out")])])]}})}return e})();function gxe(e,n){if(1&e){const t=Is();Fe(0,"button",6),Nn("click",function(){const r=Di(t).$implicit;return Ii(cn().handleUserMenuAction(r.action))}),Fe(1,"mat-icon"),gt(2),Ue(),Fe(3,"span"),gt(4),Ue()()}if(2&e){const t=n.$implicit;Ze(2),br(t.icon),Ze(2),br(t.label)}}let _xe=(()=>{class e{constructor(){this.title="frontend",this.isExpanded=!1,this.isSmallScreen=!1,this.isCollapsed=!1,this.menuItems=[{label:"Home",icon:"home",routerLink:"/home",active:!1}],this.polling=!0,this.userMenuItems=[{label:"Profile",icon:"person",action:"profile"},{label:"Settings",icon:"settings",action:"settings"},{label:"Theme",icon:"palette",action:"theme"},{label:"Reports",icon:"bar_chart",action:"reports"},{label:"Login",icon:"login",action:"login"}]}setActive(t){this.menuItems.forEach(i=>i.active=!1),t.active=!0}handleUserMenuAction(t){"login"===t&&console.log("Login triggered")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-header"]],standalone:!1,decls:8,vars:2,consts:[["userMenu","matMenu"],[1,"header-card"],[1,"header-content"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"profile-icon"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"]],template:function(i,r){if(1&i&&(Fe(0,"mat-card",1)(1,"div",2)(2,"button",3)(3,"mat-icon",4),gt(4,"person"),Ue()(),Fe(5,"mat-menu",null,0),an(7,gxe,5,2,"button",5),Ue()()()),2&i){const a=Za(6);Ze(2),At("matMenuTriggerFor",a),Ze(5),At("ngForOf",r.userMenuItems)}},dependencies:[md,qC,hu,P_,JC,rI,Uue],styles:[".header-card[_ngcontent-%COMP%]{width:100%;height:4em;margin-bottom:.5em;background:linear-gradient(to right,#ff0000b3,#ffffffb3 20%,#0000ffb3 30%,#008080b3);display:flex;align-items:center;justify-content:space-between;box-shadow:none;border-radius:.25em}.header-content[_ngcontent-%COMP%]{height:3.5em;display:flex;align-items:center;width:100%;justify-content:space-between;position:relative;padding:0 1em;border-radius:0}button[_ngcontent-%COMP%]{position:relative;right:.5em;top:-.1em;margin-left:auto}.profile-icon[_ngcontent-%COMP%]{color:#ffdf00;border:2px solid #00f0ff;padding:.15em;border-radius:.25em}.cdk-overlay-pane[_ngcontent-%COMP%]{background-color:#ffffffe6;border:2px solid #000;padding:.5em;margin-top:1em;width:auto}.cdk-overlay-pane[_ngcontent-%COMP%]   mat-menu-item[_ngcontent-%COMP%]{color:#000;font-size:1em;padding:.5em 1em;transition:background-color .3s}.cdk-overlay-pane[_ngcontent-%COMP%]   mat-menu-item[_ngcontent-%COMP%]:hover{background-color:#0000001a}.cdk-overlay-pane[_ngcontent-%COMP%]   mat-menu-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5em}"]})}return e})();function yxe(e,n){if(1&e&&_n(0,"img",19),2&e){const t=n.$implicit;ka(t.class),At("src",t.src,eu)("alt",t.alt)}}let vxe=(()=>{class e{constructor(t){this.router=t,this.performanceMetrics={memoryUsage:"N/A",cpuLoad:"N/A",appUptime:"N/A",networkLatency:"N/A"},this.logoLinks=[{src:"assets/images/compressed/nodejs-new-pantone-white.png",alt:"Node.js"},{src:"assets/images/mongo.svg",alt:"MongoDB"},{src:"assets/images/compressed/angular.png",alt:"Angular"},{src:"assets/images/compressed/us-army-logo.png",alt:"United States Army (DOD)",class:"army"},{src:"assets/images/compressed/US-GOVT-DLA.png",alt:"Defense Logistics Agency",class:"DLA"},{src:"assets/images/compressed/US-GOVT-DVA-Seal.png",alt:"Department of Veterans Affairs",class:"DVA"},{src:"assets/images/compressed/US-GOVT-DTIC.png",alt:"Defense Technical Information Center",class:"DTIC"}],this.appStartTime=performance.now()}ngOnInit(){this.startPerformanceMonitoring()}ngOnDestroy(){this.stopPerformanceMonitoring()}startPerformanceMonitoring(){console.log("Starting performance monitoring");const t=fF(3e3);this.performanceSubscription=t.subscribe(()=>{this.updatePerformanceMetrics()})}stopPerformanceMonitoring(){console.log("Stopping performance monitoring"),this.performanceSubscription&&this.performanceSubscription.unsubscribe()}updatePerformanceMetrics(){if(performance.memory){const P=performance.memory;this.performanceMetrics.memoryUsage=`${(P.usedJSHeapSize/P.totalJSHeapSize*100).toFixed(2)}%`}else this.performanceMetrics.memoryUsage="N/A";const t=100*Math.random();this.performanceMetrics.cpuLoad=`${t.toFixed(2)}%`;const a=(performance.now()-this.appStartTime)/1e3,h=a/60,v=h/60,C=v/24;this.performanceMetrics.appUptime=C>=1?`${C.toFixed(2)} days`:v>=1?`${v.toFixed(2)} hours`:h>=1?`${h.toFixed(2)} minutes`:`${a.toFixed(2)} seconds`,this.measureNetworkLatency()}measureNetworkLatency(){const t=new RTCPeerConnection({iceServers:[]});t.createDataChannel("latencyCheck");const i=performance.now();t.createOffer().then(r=>t.setLocalDescription(r)).then(()=>{const a=performance.now()-i;this.performanceMetrics.networkLatency=`${a.toFixed(2)} ms`,t.close()}).catch(()=>{this.performanceMetrics.networkLatency="N/A",t.close()})}getMemoryUsageClass(){const t=parseFloat(this.performanceMetrics.memoryUsage);return t<50?"green-text":t<75?"yellow-text":"red-text"}getCpuLoadClass(){const t=parseFloat(this.performanceMetrics.cpuLoad);return t<50?"green-text":t<75?"yellow-text":"red-text"}getNetworkLatencyClass(){const t=parseFloat(this.performanceMetrics.networkLatency);return t<100?"green-text":t<200?"yellow-text":"red-text"}navigateToResume(){this.router.navigate(["/resume"])}sendEmail(){window.location.href="mailto:jeffreysanford@gmail.com"}openGitHub(){window.open("https://github.com/JeffreySanford/craft-fusion/","_blank")}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(Qa))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-footer"]],standalone:!1,decls:50,vars:8,consts:[[1,"footer-container"],[1,"footer-content"],[1,"contact-block"],["mat-raised-button","",3,"click"],[1,"logo-performance-block"],[1,"logo-row"],[3,"src","alt","class",4,"ngFor","ngForOf"],[1,"performance-card"],[1,"performance-metrics"],[1,"metric",3,"ngClass"],["for","memoryUsage"],["id","memoryUsage"],["for","cpuLoad"],["id","cpuLoad"],[1,"metric"],["for","appUptime"],["id","appUptime"],["for","networkLatency"],["id","networkLatency"],[3,"src","alt"]],template:function(i,r){1&i&&(Fe(0,"div",0)(1,"mat-expansion-panel")(2,"mat-expansion-panel-header")(3,"mat-panel-title")(4,"mat-icon"),gt(5,"star"),Ue(),Fe(6,"p"),gt(7,"Jeffrey Sanford"),Ue()()(),Fe(8,"div",1)(9,"div",2)(10,"button",3),Nn("click",function(){return r.sendEmail()}),Fe(11,"mat-icon"),gt(12,"email"),Ue(),Fe(13,"p"),gt(14,"e-mail"),Ue()(),Fe(15,"button",3),Nn("click",function(){return r.openGitHub()}),Fe(16,"mat-icon"),gt(17,"code"),Ue(),Fe(18,"p"),gt(19,"github"),Ue()(),Fe(20,"button",3),Nn("click",function(){return r.navigateToResume()}),Fe(21,"mat-icon"),gt(22,"description"),Ue(),Fe(23,"p"),gt(24,"resume"),Ue()()(),Fe(25,"div",4)(26,"div",5),an(27,yxe,1,4,"img",6),Ue(),Fe(28,"mat-card",7)(29,"div",8)(30,"div",9)(31,"label",10),gt(32,"Memory Usage:"),Ue(),Fe(33,"span",11),gt(34),Ue()(),Fe(35,"div",9)(36,"label",12),gt(37,"CPU Load:"),Ue(),Fe(38,"span",13),gt(39),Ue()(),Fe(40,"div",14)(41,"label",15),gt(42,"App Uptime:"),Ue(),Fe(43,"span",16),gt(44),Ue()(),Fe(45,"div",9)(46,"label",17),gt(47,"Network Latency:"),Ue(),Fe(48,"span",18),gt(49),Ue()()()()()()()()),2&i&&(Ze(27),At("ngForOf",r.logoLinks),Ze(3),At("ngClass",r.getMemoryUsageClass()),Ze(4),br(r.performanceMetrics.memoryUsage),Ze(),At("ngClass",r.getCpuLoadClass()),Ze(4),br(r.performanceMetrics.cpuLoad),Ze(5),br(r.performanceMetrics.appUptime),Ze(),At("ngClass",r.getNetworkLatencyClass()),Ze(4),br(r.performanceMetrics.networkLatency))},dependencies:[w_,md,ZD,hu,P_,p8,Sfe,Efe],styles:[".mat-expansion-panel[_ngcontent-%COMP%]{border-radius:.25em}.footer-container[_ngcontent-%COMP%]{position:fixed;bottom:1em;display:flex;flex-direction:column;justify-content:space-between;align-items:center;width:99%;overflow:visible}.footer-container[_ngcontent-%COMP%]   .top-containers[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.footer-container[_ngcontent-%COMP%]   .contact-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start;padding:.625em;width:10em}.footer-container[_ngcontent-%COMP%]   .contact-block[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.8em;color:#fff;margin:0;padding-left:1em}.footer-container[_ngcontent-%COMP%]   .contact-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1em;display:flex;align-items:center;margin:0 0 .25em;padding:.125em 0;color:#fff;background-color:#ffffff1a;border:none;cursor:pointer;text-decoration:none}.footer-container[_ngcontent-%COMP%]   .contact-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{text-decoration:underline}.footer-container[_ngcontent-%COMP%]   .contact-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.5em}.footer-container[_ngcontent-%COMP%]   .logo-performance-block[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;position:relative;z-index:10;overflow:visible}.footer-container[_ngcontent-%COMP%]   .logo-performance-block[_ngcontent-%COMP%]   .logo-row[_ngcontent-%COMP%]{display:flex!important;flex-wrap:wrap;justify-content:flex-end;align-items:center;margin:.5em 0 1em;overflow:visible}.footer-container[_ngcontent-%COMP%]   .logo-performance-block[_ngcontent-%COMP%]   .logo-row[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:3.5em;padding:.25em;margin:0 1.5em;border:.0625em solid blue;background:linear-gradient(to bottom,#00008b,#000);transition:transform .3s,z-index .3s;position:relative}.footer-container[_ngcontent-%COMP%]   .logo-performance-block[_ngcontent-%COMP%]   .logo-row[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(3);z-index:9999}.footer-container[_ngcontent-%COMP%]   .performance-card[_ngcontent-%COMP%]{background-color:#0006;height:3em;width:80%}.footer-container[_ngcontent-%COMP%]   .performance-metrics[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:.8em;margin-right:.25em}.footer-container[_ngcontent-%COMP%]   .performance-metrics[_ngcontent-%COMP%]   .metric[_ngcontent-%COMP%]{display:flex;align-items:center;margin:.5em;padding:.5em;color:#fff}.footer-container[_ngcontent-%COMP%]   .performance-metrics[_ngcontent-%COMP%]   .metric[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{margin-right:.5em}.footer-container[_ngcontent-%COMP%]   .performance-metrics[_ngcontent-%COMP%]   .green-text[_ngcontent-%COMP%]{color:#0f0}.footer-container[_ngcontent-%COMP%]   .performance-metrics[_ngcontent-%COMP%]   .yellow-text[_ngcontent-%COMP%]{color:#ff0}.footer-container[_ngcontent-%COMP%]   .performance-metrics[_ngcontent-%COMP%]   .red-text[_ngcontent-%COMP%]{color:red}.mat-panel-title[_ngcontent-%COMP%]{display:flex;align-items:center}.mat-panel-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:1em;background-color:teal}mat-expansion-panel[expanded][_ngcontent-%COMP%]{height:auto}.mat-expansion-panel-header-title[_ngcontent-%COMP%], .mat-expansion-panel-header-description[_ngcontent-%COMP%]{color:gold}.mat-expansion-panel-header-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .mat-expansion-panel-header-description[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.25em;margin:0 0 0 .15em}mat-expansion-panel[_ngcontent-%COMP%]{width:100%;color:gold;background:linear-gradient(to right,#0000ffb3,#000080b3,#000064b3,#000032b3,#000000b3)}.footer-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:auto}.footer-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}"]})}return e})();const bxe=e=>({collapsed:e});let xxe=(()=>{class e{constructor(t,i,r){this.router=t,this.route=i,this.breakpointObserver=r,this.isCollapsed=!1,this.isSmallScreen=!1,this.isExpanded=!1,this.title="frontend",this.menuItems=[{label:"Home",icon:"home",routerLink:"/home",active:!1}],this.polling=!0,this.handleUserInteraction=()=>{this.polling&&(console.log("User interaction detected"),this.ensureVideoIsPlaying())}}ngOnInit(){this.breakpointObserver.observe([pO_Handset]).subscribe(t=>{this.isSmallScreen=t.matches,this.isCollapsed=this.isSmallScreen}),this.routerSubscription&&this.routerSubscription.unsubscribe(),this.videoCheckSubscription&&this.videoCheckSubscription.unsubscribe(),this.isSmallScreen=this.breakpointObserver.isMatched("(max-width: 599px)")}ngAfterViewInit(){console.log("Step 2: ngAfterViewInit called"),this.ensureVideoIsPlaying(),this.addUserInteractionListener(),this.startVideoCheckPolling()}ngOnDestroy(){console.log("Step 4: ngOnDestroy called"),this.removeUserInteractionListener(),this.stopVideoCheckPolling()}setActive(t){this.menuItems.forEach(i=>i.active=!1),t.active=!0}ensureVideoIsPlaying(){const t=document.getElementById("background-video");t?(t.playbackRate=.5,t.paused||t.ended?t.play().then(()=>{this.stopVideoCheckPolling(),this.polling=!1}).catch(i=>{}):this.polling&&(console.log("Video is already playing, stopping polling"),this.stopVideoCheckPolling())):console.error("Video element not found")}addUserInteractionListener(){console.log("Adding user interaction listeners"),document.addEventListener("click",this.handleUserInteraction),document.addEventListener("keydown",this.handleUserInteraction)}removeUserInteractionListener(){console.log("Removing user interaction listeners"),document.removeEventListener("click",this.handleUserInteraction),document.removeEventListener("keydown",this.handleUserInteraction)}startVideoCheckPolling(){const t=fF(5e3);this.videoCheckSubscription=t.subscribe(()=>{this.ensureVideoIsPlaying()})}stopVideoCheckPolling(){this.videoCheckSubscription&&this.videoCheckSubscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||e)(Rt(Qa),Rt(jv),Rt(zD))};static#t=this.\u0275cmp=Ln({type:e,selectors:[["app-root"]],standalone:!1,decls:11,vars:5,consts:[[1,"page-container"],[1,"layout-container"],[1,"sidebar"],[3,"isSmallScreen","isCollapsed","ngClass"],[1,"main-stage"],["id","background-video","autoplay","","loop","","muted",""],["src","assets/us-flag-disa-navy.mp4","type","video/mp4"]],template:function(i,r){1&i&&(Fe(0,"div",0),_n(1,"app-header"),Fe(2,"div",1)(3,"aside",2),_n(4,"app-sidebar",3),Ue(),Fe(5,"main",4),_n(6,"router-outlet"),Ue()(),_n(7,"app-footer"),Fe(8,"video",5),_n(9,"source",6),gt(10," Your browser does not support the video tag. "),Ue()()),2&i&&(Ze(4),At("isSmallScreen",r.isSmallScreen)("isCollapsed",r.isCollapsed)("ngClass",xm(3,bxe,!r.isCollapsed)))},dependencies:[w_,nD,mxe,_xe,vxe],styles:[".page-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow:hidden;font-size:.8em;width:100%;height:88%}.page-container[_ngcontent-%COMP%]   .layout-container[_ngcontent-%COMP%]{display:flex;width:100%;height:100%;overflow:hidden}.page-container[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{width:auto;height:35em;transition:width .3s ease-in-out;flex-shrink:0;margin-right:1em;z-index:20}.page-container[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]   .collapsed[_ngcontent-%COMP%]{max-width:0;width:5em}.page-container[_ngcontent-%COMP%]   .main-stage[_ngcontent-%COMP%]{background-color:#ff000080;display:flex;flex-direction:column;justify-content:stretch;align-items:stretch;flex-grow:1;padding:1em;box-sizing:border-box;overflow:visible;margin:.15em .15em .5em;width:80%;height:83vh;border-radius:.25em}"]})}return e})(),wxe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({imports:[Dm,Sh]})}return e})(),Cxe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({imports:[Dm,Sh,Sh]})}return e})(),Txe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({imports:[Dm,Sh]})}return e})(),Mxe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({imports:[Dm,Sh]})}return e})(),Sxe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({providers:[Rq,Oq,Pq],imports:[Dm,Sh,wF]})}return e})(),Exe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({imports:[Dm,Sh]})}return e})(),Dxe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({providers:[VL],imports:[Dm,gj,Sh]})}return e})(),Ixe=(()=>{class e{static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e});static#n=this.\u0275inj=Qt({providers:[UL],imports:[Dm,Sh,kP]})}return e})(),kxe=(()=>{class e{constructor(){}increment(t){console.log(t)}decrement(){console.log("Busy cleared")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275prov=Nt({token:e,factory:e.\u0275fac})}return e})(),Axe=(()=>{class e{constructor(){console.log("AppModule loaded")}static#e=this.\u0275fac=function(i){return new(i||e)};static#t=this.\u0275mod=ci({type:e,bootstrap:[xxe]});static#n=this.\u0275inj=Qt({providers:[kxe,rO,Wte()],imports:[o4,qte,kP.forRoot(dxe),Sh,gj,wxe,Cxe,Txe,Sxe,Ixe,Exe,Dxe,Mxe,jse,yae.forRoot({timeOut:3e3,positionClass:"toast-bottom-center",preventDuplicates:!0}),kP,Sh]})}return e})();GJ().bootstrapModule(Axe).catch(e=>console.error(e))},247:function(lw){lw.exports=function(){"use strict";var Wm,op,Zm;function Ph(f,To){if(Wm)if(op){var Gs="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Wm+")(sharedChunk); ("+op+")(sharedChunk); self.onerror = null;",xi={};Wm(xi),Zm=To(xi),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(Zm.workerUrl=window.URL.createObjectURL(new Blob([Gs],{type:"text/javascript"})))}else op=To;else Wm=To}return Ph(0,function(f){function To(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}var Gs,xi={},Xn={};function ks(){if(Gs)return Xn;Gs=1,Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.setMatrixArrayType=function(_){Xn.ARRAY_TYPE=o=_},Xn.toRadian=function(_){return _*u},Xn.equals=function(_,p){return Math.abs(_-p)<=d*Math.max(1,Math.abs(_),Math.abs(p))},Xn.RANDOM=Xn.ARRAY_TYPE=Xn.EPSILON=void 0;var d=1e-6;Xn.EPSILON=d;var o=typeof Float32Array<"u"?Float32Array:Array;Xn.ARRAY_TYPE=o;var l=Math.random;Xn.RANDOM=l;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var _=0,p=arguments.length;p--;)_+=arguments[p]*arguments[p];return Math.sqrt(_)}),Xn}var xd,mr={};function Oi(){if(xd)return mr;function d(p){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(y){return typeof y}:function(y){return y&&"function"==typeof Symbol&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}xd=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.create=function(){var p=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p},mr.clone=function(p){var y=new o.ARRAY_TYPE(4);return y[0]=p[0],y[1]=p[1],y[2]=p[2],y[3]=p[3],y},mr.copy=function(p,y){return p[0]=y[0],p[1]=y[1],p[2]=y[2],p[3]=y[3],p},mr.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p},mr.fromValues=function(p,y,T,E){var R=new o.ARRAY_TYPE(4);return R[0]=p,R[1]=y,R[2]=T,R[3]=E,R},mr.set=function(p,y,T,E,R){return p[0]=y,p[1]=T,p[2]=E,p[3]=R,p},mr.transpose=function(p,y){if(p===y){var T=y[1];p[1]=y[2],p[2]=T}else p[0]=y[0],p[1]=y[2],p[2]=y[1],p[3]=y[3];return p},mr.invert=function(p,y){var T=y[0],E=y[1],R=y[2],w=y[3],D=T*w-R*E;return D?(p[0]=w*(D=1/D),p[1]=-E*D,p[2]=-R*D,p[3]=T*D,p):null},mr.adjoint=function(p,y){var T=y[0];return p[0]=y[3],p[1]=-y[1],p[2]=-y[2],p[3]=T,p},mr.determinant=function(p){return p[0]*p[3]-p[2]*p[1]},mr.multiply=u,mr.rotate=function(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=Math.sin(T),S=Math.cos(T);return p[0]=E*S+w*k,p[1]=R*S+D*k,p[2]=E*-k+w*S,p[3]=R*-k+D*S,p},mr.scale=function(p,y,T){var E=y[1],R=y[2],w=y[3],D=T[0],k=T[1];return p[0]=y[0]*D,p[1]=E*D,p[2]=R*k,p[3]=w*k,p},mr.fromRotation=function(p,y){var T=Math.sin(y),E=Math.cos(y);return p[0]=E,p[1]=T,p[2]=-T,p[3]=E,p},mr.fromScaling=function(p,y){return p[0]=y[0],p[1]=0,p[2]=0,p[3]=y[1],p},mr.str=function(p){return"mat2("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+")"},mr.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3])},mr.LDU=function(p,y,T,E){return p[2]=E[2]/E[0],T[0]=E[0],T[1]=E[1],T[3]=E[3]-p[2]*T[1],[p,y,T]},mr.add=function(p,y,T){return p[0]=y[0]+T[0],p[1]=y[1]+T[1],p[2]=y[2]+T[2],p[3]=y[3]+T[3],p},mr.subtract=_,mr.exactEquals=function(p,y){return p[0]===y[0]&&p[1]===y[1]&&p[2]===y[2]&&p[3]===y[3]},mr.equals=function(p,y){var T=p[0],E=p[1],R=p[2],w=p[3],D=y[0],k=y[1],S=y[2],I=y[3];return Math.abs(T-D)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(D))&&Math.abs(E-k)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(k))&&Math.abs(R-S)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(S))&&Math.abs(w-I)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(I))},mr.multiplyScalar=function(p,y,T){return p[0]=y[0]*T,p[1]=y[1]*T,p[2]=y[2]*T,p[3]=y[3]*T,p},mr.multiplyScalarAndAdd=function(p,y,T,E){return p[0]=y[0]+T[0]*E,p[1]=y[1]+T[1]*E,p[2]=y[2]+T[2]*E,p[3]=y[3]+T[3]*E,p},mr.sub=mr.mul=void 0;var o=function(p){if(p&&p.__esModule)return p;if(null===p||"object"!==d(p)&&"function"!=typeof p)return{default:p};var T=l(void 0);if(T&&T.has(p))return T.get(p);var E={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if("default"!==w&&Object.prototype.hasOwnProperty.call(p,w)){var D=R?Object.getOwnPropertyDescriptor(p,w):null;D&&(D.get||D.set)?Object.defineProperty(E,w,D):E[w]=p[w]}return E.default=p,T&&T.set(p,E),E}(ks());function l(p){if("function"!=typeof WeakMap)return null;var y=new WeakMap,T=new WeakMap;return(l=function(E){return E?T:y})(p)}function u(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=T[0],S=T[1],I=T[2],O=T[3];return p[0]=E*k+w*S,p[1]=R*k+D*S,p[2]=E*I+w*O,p[3]=R*I+D*O,p}function _(p,y,T){return p[0]=y[0]-T[0],p[1]=y[1]-T[1],p[2]=y[2]-T[2],p[3]=y[3]-T[3],p}return mr.mul=u,mr.sub=_,mr}var ss,Ji={};function wd(){if(ss)return Ji;function d(p){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(y){return typeof y}:function(y){return y&&"function"==typeof Symbol&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}ss=1,Object.defineProperty(Ji,"__esModule",{value:!0}),Ji.create=function(){var p=new o.ARRAY_TYPE(6);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[4]=0,p[5]=0),p[0]=1,p[3]=1,p},Ji.clone=function(p){var y=new o.ARRAY_TYPE(6);return y[0]=p[0],y[1]=p[1],y[2]=p[2],y[3]=p[3],y[4]=p[4],y[5]=p[5],y},Ji.copy=function(p,y){return p[0]=y[0],p[1]=y[1],p[2]=y[2],p[3]=y[3],p[4]=y[4],p[5]=y[5],p},Ji.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=0,p[5]=0,p},Ji.fromValues=function(p,y,T,E,R,w){var D=new o.ARRAY_TYPE(6);return D[0]=p,D[1]=y,D[2]=T,D[3]=E,D[4]=R,D[5]=w,D},Ji.set=function(p,y,T,E,R,w,D){return p[0]=y,p[1]=T,p[2]=E,p[3]=R,p[4]=w,p[5]=D,p},Ji.invert=function(p,y){var T=y[0],E=y[1],R=y[2],w=y[3],D=y[4],k=y[5],S=T*w-E*R;return S?(p[0]=w*(S=1/S),p[1]=-E*S,p[2]=-R*S,p[3]=T*S,p[4]=(R*k-w*D)*S,p[5]=(E*D-T*k)*S,p):null},Ji.determinant=function(p){return p[0]*p[3]-p[1]*p[2]},Ji.multiply=u,Ji.rotate=function(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=y[4],S=y[5],I=Math.sin(T),O=Math.cos(T);return p[0]=E*O+w*I,p[1]=R*O+D*I,p[2]=E*-I+w*O,p[3]=R*-I+D*O,p[4]=k,p[5]=S,p},Ji.scale=function(p,y,T){var E=y[1],R=y[2],w=y[3],D=y[4],k=y[5],S=T[0],I=T[1];return p[0]=y[0]*S,p[1]=E*S,p[2]=R*I,p[3]=w*I,p[4]=D,p[5]=k,p},Ji.translate=function(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=y[4],S=y[5],I=T[0],O=T[1];return p[0]=E,p[1]=R,p[2]=w,p[3]=D,p[4]=E*I+w*O+k,p[5]=R*I+D*O+S,p},Ji.fromRotation=function(p,y){var T=Math.sin(y),E=Math.cos(y);return p[0]=E,p[1]=T,p[2]=-T,p[3]=E,p[4]=0,p[5]=0,p},Ji.fromScaling=function(p,y){return p[0]=y[0],p[1]=0,p[2]=0,p[3]=y[1],p[4]=0,p[5]=0,p},Ji.fromTranslation=function(p,y){return p[0]=1,p[1]=0,p[2]=0,p[3]=1,p[4]=y[0],p[5]=y[1],p},Ji.str=function(p){return"mat2d("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+")"},Ji.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],1)},Ji.add=function(p,y,T){return p[0]=y[0]+T[0],p[1]=y[1]+T[1],p[2]=y[2]+T[2],p[3]=y[3]+T[3],p[4]=y[4]+T[4],p[5]=y[5]+T[5],p},Ji.subtract=_,Ji.multiplyScalar=function(p,y,T){return p[0]=y[0]*T,p[1]=y[1]*T,p[2]=y[2]*T,p[3]=y[3]*T,p[4]=y[4]*T,p[5]=y[5]*T,p},Ji.multiplyScalarAndAdd=function(p,y,T,E){return p[0]=y[0]+T[0]*E,p[1]=y[1]+T[1]*E,p[2]=y[2]+T[2]*E,p[3]=y[3]+T[3]*E,p[4]=y[4]+T[4]*E,p[5]=y[5]+T[5]*E,p},Ji.exactEquals=function(p,y){return p[0]===y[0]&&p[1]===y[1]&&p[2]===y[2]&&p[3]===y[3]&&p[4]===y[4]&&p[5]===y[5]},Ji.equals=function(p,y){var T=p[0],E=p[1],R=p[2],w=p[3],D=p[4],k=p[5],S=y[0],I=y[1],O=y[2],B=y[3],U=y[4],q=y[5];return Math.abs(T-S)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(S))&&Math.abs(E-I)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(I))&&Math.abs(R-O)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(O))&&Math.abs(w-B)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(B))&&Math.abs(D-U)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs(U))&&Math.abs(k-q)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(q))},Ji.sub=Ji.mul=void 0;var o=function(p){if(p&&p.__esModule)return p;if(null===p||"object"!==d(p)&&"function"!=typeof p)return{default:p};var T=l(void 0);if(T&&T.has(p))return T.get(p);var E={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if("default"!==w&&Object.prototype.hasOwnProperty.call(p,w)){var D=R?Object.getOwnPropertyDescriptor(p,w):null;D&&(D.get||D.set)?Object.defineProperty(E,w,D):E[w]=p[w]}return E.default=p,T&&T.set(p,E),E}(ks());function l(p){if("function"!=typeof WeakMap)return null;var y=new WeakMap,T=new WeakMap;return(l=function(E){return E?T:y})(p)}function u(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=y[4],S=y[5],I=T[0],O=T[1],B=T[2],U=T[3],q=T[4],Z=T[5];return p[0]=E*I+w*O,p[1]=R*I+D*O,p[2]=E*B+w*U,p[3]=R*B+D*U,p[4]=E*q+w*Z+k,p[5]=R*q+D*Z+S,p}function _(p,y,T){return p[0]=y[0]-T[0],p[1]=y[1]-T[1],p[2]=y[2]-T[2],p[3]=y[3]-T[3],p[4]=y[4]-T[4],p[5]=y[5]-T[5],p}return Ji.mul=u,Ji.sub=_,Ji}var Oh,$i={};function Fh(){if(Oh)return $i;function d(p){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(y){return typeof y}:function(y){return y&&"function"==typeof Symbol&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y})(p)}Oh=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.create=function(){var p=new o.ARRAY_TYPE(9);return o.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[5]=0,p[6]=0,p[7]=0),p[0]=1,p[4]=1,p[8]=1,p},$i.fromMat4=function(p,y){return p[0]=y[0],p[1]=y[1],p[2]=y[2],p[3]=y[4],p[4]=y[5],p[5]=y[6],p[6]=y[8],p[7]=y[9],p[8]=y[10],p},$i.clone=function(p){var y=new o.ARRAY_TYPE(9);return y[0]=p[0],y[1]=p[1],y[2]=p[2],y[3]=p[3],y[4]=p[4],y[5]=p[5],y[6]=p[6],y[7]=p[7],y[8]=p[8],y},$i.copy=function(p,y){return p[0]=y[0],p[1]=y[1],p[2]=y[2],p[3]=y[3],p[4]=y[4],p[5]=y[5],p[6]=y[6],p[7]=y[7],p[8]=y[8],p},$i.fromValues=function(p,y,T,E,R,w,D,k,S){var I=new o.ARRAY_TYPE(9);return I[0]=p,I[1]=y,I[2]=T,I[3]=E,I[4]=R,I[5]=w,I[6]=D,I[7]=k,I[8]=S,I},$i.set=function(p,y,T,E,R,w,D,k,S,I){return p[0]=y,p[1]=T,p[2]=E,p[3]=R,p[4]=w,p[5]=D,p[6]=k,p[7]=S,p[8]=I,p},$i.identity=function(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},$i.transpose=function(p,y){if(p===y){var T=y[1],E=y[2],R=y[5];p[1]=y[3],p[2]=y[6],p[3]=T,p[5]=y[7],p[6]=E,p[7]=R}else p[0]=y[0],p[1]=y[3],p[2]=y[6],p[3]=y[1],p[4]=y[4],p[5]=y[7],p[6]=y[2],p[7]=y[5],p[8]=y[8];return p},$i.invert=function(p,y){var T=y[0],E=y[1],R=y[2],w=y[3],D=y[4],k=y[5],S=y[6],I=y[7],O=y[8],B=O*D-k*I,U=-O*w+k*S,q=I*w-D*S,Z=T*B+E*U+R*q;return Z?(p[0]=B*(Z=1/Z),p[1]=(-O*E+R*I)*Z,p[2]=(k*E-R*D)*Z,p[3]=U*Z,p[4]=(O*T-R*S)*Z,p[5]=(-k*T+R*w)*Z,p[6]=q*Z,p[7]=(-I*T+E*S)*Z,p[8]=(D*T-E*w)*Z,p):null},$i.adjoint=function(p,y){var T=y[0],E=y[1],R=y[2],w=y[3],D=y[4],k=y[5],S=y[6],I=y[7],O=y[8];return p[0]=D*O-k*I,p[1]=R*I-E*O,p[2]=E*k-R*D,p[3]=k*S-w*O,p[4]=T*O-R*S,p[5]=R*w-T*k,p[6]=w*I-D*S,p[7]=E*S-T*I,p[8]=T*D-E*w,p},$i.determinant=function(p){var y=p[3],T=p[4],E=p[5],R=p[6],w=p[7],D=p[8];return p[0]*(D*T-E*w)+p[1]*(-D*y+E*R)+p[2]*(w*y-T*R)},$i.multiply=u,$i.translate=function(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=y[4],S=y[5],I=y[6],O=y[7],B=y[8],U=T[0],q=T[1];return p[0]=E,p[1]=R,p[2]=w,p[3]=D,p[4]=k,p[5]=S,p[6]=U*E+q*D+I,p[7]=U*R+q*k+O,p[8]=U*w+q*S+B,p},$i.rotate=function(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=y[4],S=y[5],I=y[6],O=y[7],B=y[8],U=Math.sin(T),q=Math.cos(T);return p[0]=q*E+U*D,p[1]=q*R+U*k,p[2]=q*w+U*S,p[3]=q*D-U*E,p[4]=q*k-U*R,p[5]=q*S-U*w,p[6]=I,p[7]=O,p[8]=B,p},$i.scale=function(p,y,T){var E=T[0],R=T[1];return p[0]=E*y[0],p[1]=E*y[1],p[2]=E*y[2],p[3]=R*y[3],p[4]=R*y[4],p[5]=R*y[5],p[6]=y[6],p[7]=y[7],p[8]=y[8],p},$i.fromTranslation=function(p,y){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=1,p[5]=0,p[6]=y[0],p[7]=y[1],p[8]=1,p},$i.fromRotation=function(p,y){var T=Math.sin(y),E=Math.cos(y);return p[0]=E,p[1]=T,p[2]=0,p[3]=-T,p[4]=E,p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},$i.fromScaling=function(p,y){return p[0]=y[0],p[1]=0,p[2]=0,p[3]=0,p[4]=y[1],p[5]=0,p[6]=0,p[7]=0,p[8]=1,p},$i.fromMat2d=function(p,y){return p[0]=y[0],p[1]=y[1],p[2]=0,p[3]=y[2],p[4]=y[3],p[5]=0,p[6]=y[4],p[7]=y[5],p[8]=1,p},$i.fromQuat=function(p,y){var T=y[0],E=y[1],R=y[2],w=y[3],D=T+T,k=E+E,S=R+R,I=T*D,O=E*D,B=E*k,U=R*D,q=R*k,Z=R*S,$=w*D,Y=w*k,K=w*S;return p[0]=1-B-Z,p[3]=O-K,p[6]=U+Y,p[1]=O+K,p[4]=1-I-Z,p[7]=q-$,p[2]=U-Y,p[5]=q+$,p[8]=1-I-B,p},$i.normalFromMat4=function(p,y){var T=y[0],E=y[1],R=y[2],w=y[3],D=y[4],k=y[5],S=y[6],I=y[7],O=y[8],B=y[9],U=y[10],q=y[11],Z=y[12],$=y[13],Y=y[14],K=y[15],ee=T*k-E*D,ue=T*S-R*D,de=T*I-w*D,ce=E*S-R*k,we=E*I-w*k,fe=R*I-w*S,Te=O*$-B*Z,ke=O*Y-U*Z,De=O*K-q*Z,Pe=B*Y-U*$,Ne=B*K-q*$,je=U*K-q*Y,Le=ee*je-ue*Ne+de*Pe+ce*De-we*ke+fe*Te;return Le?(p[0]=(k*je-S*Ne+I*Pe)*(Le=1/Le),p[1]=(S*De-D*je-I*ke)*Le,p[2]=(D*Ne-k*De+I*Te)*Le,p[3]=(R*Ne-E*je-w*Pe)*Le,p[4]=(T*je-R*De+w*ke)*Le,p[5]=(E*De-T*Ne-w*Te)*Le,p[6]=($*fe-Y*we+K*ce)*Le,p[7]=(Y*de-Z*fe-K*ue)*Le,p[8]=(Z*we-$*de+K*ee)*Le,p):null},$i.projection=function(p,y,T){return p[0]=2/y,p[1]=0,p[2]=0,p[3]=0,p[4]=-2/T,p[5]=0,p[6]=-1,p[7]=1,p[8]=1,p},$i.str=function(p){return"mat3("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+")"},$i.frob=function(p){return Math.hypot(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8])},$i.add=function(p,y,T){return p[0]=y[0]+T[0],p[1]=y[1]+T[1],p[2]=y[2]+T[2],p[3]=y[3]+T[3],p[4]=y[4]+T[4],p[5]=y[5]+T[5],p[6]=y[6]+T[6],p[7]=y[7]+T[7],p[8]=y[8]+T[8],p},$i.subtract=_,$i.multiplyScalar=function(p,y,T){return p[0]=y[0]*T,p[1]=y[1]*T,p[2]=y[2]*T,p[3]=y[3]*T,p[4]=y[4]*T,p[5]=y[5]*T,p[6]=y[6]*T,p[7]=y[7]*T,p[8]=y[8]*T,p},$i.multiplyScalarAndAdd=function(p,y,T,E){return p[0]=y[0]+T[0]*E,p[1]=y[1]+T[1]*E,p[2]=y[2]+T[2]*E,p[3]=y[3]+T[3]*E,p[4]=y[4]+T[4]*E,p[5]=y[5]+T[5]*E,p[6]=y[6]+T[6]*E,p[7]=y[7]+T[7]*E,p[8]=y[8]+T[8]*E,p},$i.exactEquals=function(p,y){return p[0]===y[0]&&p[1]===y[1]&&p[2]===y[2]&&p[3]===y[3]&&p[4]===y[4]&&p[5]===y[5]&&p[6]===y[6]&&p[7]===y[7]&&p[8]===y[8]},$i.equals=function(p,y){var T=p[0],E=p[1],R=p[2],w=p[3],D=p[4],k=p[5],S=p[6],I=p[7],O=p[8],B=y[0],U=y[1],q=y[2],Z=y[3],$=y[4],Y=y[5],K=y[6],ee=y[7],ue=y[8];return Math.abs(T-B)<=o.EPSILON*Math.max(1,Math.abs(T),Math.abs(B))&&Math.abs(E-U)<=o.EPSILON*Math.max(1,Math.abs(E),Math.abs(U))&&Math.abs(R-q)<=o.EPSILON*Math.max(1,Math.abs(R),Math.abs(q))&&Math.abs(w-Z)<=o.EPSILON*Math.max(1,Math.abs(w),Math.abs(Z))&&Math.abs(D-$)<=o.EPSILON*Math.max(1,Math.abs(D),Math.abs($))&&Math.abs(k-Y)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(Y))&&Math.abs(S-K)<=o.EPSILON*Math.max(1,Math.abs(S),Math.abs(K))&&Math.abs(I-ee)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(ee))&&Math.abs(O-ue)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(ue))},$i.sub=$i.mul=void 0;var o=function(p){if(p&&p.__esModule)return p;if(null===p||"object"!==d(p)&&"function"!=typeof p)return{default:p};var T=l(void 0);if(T&&T.has(p))return T.get(p);var E={},R=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in p)if("default"!==w&&Object.prototype.hasOwnProperty.call(p,w)){var D=R?Object.getOwnPropertyDescriptor(p,w):null;D&&(D.get||D.set)?Object.defineProperty(E,w,D):E[w]=p[w]}return E.default=p,T&&T.set(p,E),E}(ks());function l(p){if("function"!=typeof WeakMap)return null;var y=new WeakMap,T=new WeakMap;return(l=function(E){return E?T:y})(p)}function u(p,y,T){var E=y[0],R=y[1],w=y[2],D=y[3],k=y[4],S=y[5],I=y[6],O=y[7],B=y[8],U=T[0],q=T[1],Z=T[2],$=T[3],Y=T[4],K=T[5],ee=T[6],ue=T[7],de=T[8];return p[0]=U*E+q*D+Z*I,p[1]=U*R+q*k+Z*O,p[2]=U*w+q*S+Z*B,p[3]=$*E+Y*D+K*I,p[4]=$*R+Y*k+K*O,p[5]=$*w+Y*S+K*B,p[6]=ee*E+ue*D+de*I,p[7]=ee*R+ue*k+de*O,p[8]=ee*w+ue*S+de*B,p}function _(p,y,T){return p[0]=y[0]-T[0],p[1]=y[1]-T[1],p[2]=y[2]-T[2],p[3]=y[3]-T[3],p[4]=y[4]-T[4],p[5]=y[5]-T[5],p[6]=y[6]-T[6],p[7]=y[7]-T[7],p[8]=y[8]-T[8],p}return $i.mul=u,$i.sub=_,$i}var sc,bn={};function el(){if(sc)return bn;function d(w){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(D){return typeof D}:function(D){return D&&"function"==typeof Symbol&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D})(w)}sc=1,Object.defineProperty(bn,"__esModule",{value:!0}),bn.create=function(){var w=new o.ARRAY_TYPE(16);return o.ARRAY_TYPE!=Float32Array&&(w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=0,w[12]=0,w[13]=0,w[14]=0),w[0]=1,w[5]=1,w[10]=1,w[15]=1,w},bn.clone=function(w){var D=new o.ARRAY_TYPE(16);return D[0]=w[0],D[1]=w[1],D[2]=w[2],D[3]=w[3],D[4]=w[4],D[5]=w[5],D[6]=w[6],D[7]=w[7],D[8]=w[8],D[9]=w[9],D[10]=w[10],D[11]=w[11],D[12]=w[12],D[13]=w[13],D[14]=w[14],D[15]=w[15],D},bn.copy=function(w,D){return w[0]=D[0],w[1]=D[1],w[2]=D[2],w[3]=D[3],w[4]=D[4],w[5]=D[5],w[6]=D[6],w[7]=D[7],w[8]=D[8],w[9]=D[9],w[10]=D[10],w[11]=D[11],w[12]=D[12],w[13]=D[13],w[14]=D[14],w[15]=D[15],w},bn.fromValues=function(w,D,k,S,I,O,B,U,q,Z,$,Y,K,ee,ue,de){var ce=new o.ARRAY_TYPE(16);return ce[0]=w,ce[1]=D,ce[2]=k,ce[3]=S,ce[4]=I,ce[5]=O,ce[6]=B,ce[7]=U,ce[8]=q,ce[9]=Z,ce[10]=$,ce[11]=Y,ce[12]=K,ce[13]=ee,ce[14]=ue,ce[15]=de,ce},bn.set=function(w,D,k,S,I,O,B,U,q,Z,$,Y,K,ee,ue,de,ce){return w[0]=D,w[1]=k,w[2]=S,w[3]=I,w[4]=O,w[5]=B,w[6]=U,w[7]=q,w[8]=Z,w[9]=$,w[10]=Y,w[11]=K,w[12]=ee,w[13]=ue,w[14]=de,w[15]=ce,w},bn.identity=u,bn.transpose=function(w,D){if(w===D){var k=D[1],S=D[2],I=D[3],O=D[6],B=D[7],U=D[11];w[1]=D[4],w[2]=D[8],w[3]=D[12],w[4]=k,w[6]=D[9],w[7]=D[13],w[8]=S,w[9]=O,w[11]=D[14],w[12]=I,w[13]=B,w[14]=U}else w[0]=D[0],w[1]=D[4],w[2]=D[8],w[3]=D[12],w[4]=D[1],w[5]=D[5],w[6]=D[9],w[7]=D[13],w[8]=D[2],w[9]=D[6],w[10]=D[10],w[11]=D[14],w[12]=D[3],w[13]=D[7],w[14]=D[11],w[15]=D[15];return w},bn.invert=function(w,D){var k=D[0],S=D[1],I=D[2],O=D[3],B=D[4],U=D[5],q=D[6],Z=D[7],$=D[8],Y=D[9],K=D[10],ee=D[11],ue=D[12],de=D[13],ce=D[14],we=D[15],fe=k*U-S*B,Te=k*q-I*B,ke=k*Z-O*B,De=S*q-I*U,Pe=S*Z-O*U,Ne=I*Z-O*q,je=$*de-Y*ue,Le=$*ce-K*ue,it=$*we-ee*ue,_t=Y*ce-K*de,rt=Y*we-ee*de,Et=K*we-ee*ce,St=fe*Et-Te*rt+ke*_t+De*it-Pe*Le+Ne*je;return St?(w[0]=(U*Et-q*rt+Z*_t)*(St=1/St),w[1]=(I*rt-S*Et-O*_t)*St,w[2]=(de*Ne-ce*Pe+we*De)*St,w[3]=(K*Pe-Y*Ne-ee*De)*St,w[4]=(q*it-B*Et-Z*Le)*St,w[5]=(k*Et-I*it+O*Le)*St,w[6]=(ce*ke-ue*Ne-we*Te)*St,w[7]=($*Ne-K*ke+ee*Te)*St,w[8]=(B*rt-U*it+Z*je)*St,w[9]=(S*it-k*rt-O*je)*St,w[10]=(ue*Pe-de*ke+we*fe)*St,w[11]=(Y*ke-$*Pe-ee*fe)*St,w[12]=(U*Le-B*_t-q*je)*St,w[13]=(k*_t-S*Le+I*je)*St,w[14]=(de*Te-ue*De-ce*fe)*St,w[15]=($*De-Y*Te+K*fe)*St,w):null},bn.adjoint=function(w,D){var k=D[0],S=D[1],I=D[2],O=D[3],B=D[4],U=D[5],q=D[6],Z=D[7],$=D[8],Y=D[9],K=D[10],ee=D[11],ue=D[12],de=D[13],ce=D[14],we=D[15];return w[0]=U*(K*we-ee*ce)-Y*(q*we-Z*ce)+de*(q*ee-Z*K),w[1]=-(S*(K*we-ee*ce)-Y*(I*we-O*ce)+de*(I*ee-O*K)),w[2]=S*(q*we-Z*ce)-U*(I*we-O*ce)+de*(I*Z-O*q),w[3]=-(S*(q*ee-Z*K)-U*(I*ee-O*K)+Y*(I*Z-O*q)),w[4]=-(B*(K*we-ee*ce)-$*(q*we-Z*ce)+ue*(q*ee-Z*K)),w[5]=k*(K*we-ee*ce)-$*(I*we-O*ce)+ue*(I*ee-O*K),w[6]=-(k*(q*we-Z*ce)-B*(I*we-O*ce)+ue*(I*Z-O*q)),w[7]=k*(q*ee-Z*K)-B*(I*ee-O*K)+$*(I*Z-O*q),w[8]=B*(Y*we-ee*de)-$*(U*we-Z*de)+ue*(U*ee-Z*Y),w[9]=-(k*(Y*we-ee*de)-$*(S*we-O*de)+ue*(S*ee-O*Y)),w[10]=k*(U*we-Z*de)-B*(S*we-O*de)+ue*(S*Z-O*U),w[11]=-(k*(U*ee-Z*Y)-B*(S*ee-O*Y)+$*(S*Z-O*U)),w[12]=-(B*(Y*ce-K*de)-$*(U*ce-q*de)+ue*(U*K-q*Y)),w[13]=k*(Y*ce-K*de)-$*(S*ce-I*de)+ue*(S*K-I*Y),w[14]=-(k*(U*ce-q*de)-B*(S*ce-I*de)+ue*(S*q-I*U)),w[15]=k*(U*K-q*Y)-B*(S*K-I*Y)+$*(S*q-I*U),w},bn.determinant=function(w){var D=w[0],k=w[1],S=w[2],I=w[3],O=w[4],B=w[5],U=w[6],q=w[7],Z=w[8],$=w[9],Y=w[10],K=w[11],ee=w[12],ue=w[13],de=w[14],ce=w[15];return(D*B-k*O)*(Y*ce-K*de)-(D*U-S*O)*($*ce-K*ue)+(D*q-I*O)*($*de-Y*ue)+(k*U-S*B)*(Z*ce-K*ee)-(k*q-I*B)*(Z*de-Y*ee)+(S*q-I*U)*(Z*ue-$*ee)},bn.multiply=_,bn.translate=function(w,D,k){var S,I,O,B,U,q,Z,$,Y,K,ee,ue,de=k[0],ce=k[1],we=k[2];return D===w?(w[12]=D[0]*de+D[4]*ce+D[8]*we+D[12],w[13]=D[1]*de+D[5]*ce+D[9]*we+D[13],w[14]=D[2]*de+D[6]*ce+D[10]*we+D[14],w[15]=D[3]*de+D[7]*ce+D[11]*we+D[15]):(I=D[1],O=D[2],B=D[3],U=D[4],q=D[5],Z=D[6],$=D[7],Y=D[8],K=D[9],ee=D[10],ue=D[11],w[0]=S=D[0],w[1]=I,w[2]=O,w[3]=B,w[4]=U,w[5]=q,w[6]=Z,w[7]=$,w[8]=Y,w[9]=K,w[10]=ee,w[11]=ue,w[12]=S*de+U*ce+Y*we+D[12],w[13]=I*de+q*ce+K*we+D[13],w[14]=O*de+Z*ce+ee*we+D[14],w[15]=B*de+$*ce+ue*we+D[15]),w},bn.scale=function(w,D,k){var S=k[0],I=k[1],O=k[2];return w[0]=D[0]*S,w[1]=D[1]*S,w[2]=D[2]*S,w[3]=D[3]*S,w[4]=D[4]*I,w[5]=D[5]*I,w[6]=D[6]*I,w[7]=D[7]*I,w[8]=D[8]*O,w[9]=D[9]*O,w[10]=D[10]*O,w[11]=D[11]*O,w[12]=D[12],w[13]=D[13],w[14]=D[14],w[15]=D[15],w},bn.rotate=function(w,D,k,S){var I,O,B,U,q,Z,$,Y,K,ee,ue,de,ce,we,fe,Te,ke,De,Pe,Ne,je,Le,it,_t,rt=S[0],Et=S[1],St=S[2],zt=Math.hypot(rt,Et,St);return zt<o.EPSILON?null:(rt*=zt=1/zt,Et*=zt,St*=zt,I=Math.sin(k),O=Math.cos(k),q=D[1],Z=D[2],$=D[3],K=D[5],ee=D[6],ue=D[7],ce=D[9],we=D[10],fe=D[11],Te=rt*rt*(B=1-O)+O,Pe=rt*Et*B-St*I,Ne=Et*Et*B+O,je=St*Et*B+rt*I,Le=rt*St*B+Et*I,it=Et*St*B-rt*I,_t=St*St*B+O,w[0]=(U=D[0])*Te+(Y=D[4])*(ke=Et*rt*B+St*I)+(de=D[8])*(De=St*rt*B-Et*I),w[1]=q*Te+K*ke+ce*De,w[2]=Z*Te+ee*ke+we*De,w[3]=$*Te+ue*ke+fe*De,w[4]=U*Pe+Y*Ne+de*je,w[5]=q*Pe+K*Ne+ce*je,w[6]=Z*Pe+ee*Ne+we*je,w[7]=$*Pe+ue*Ne+fe*je,w[8]=U*Le+Y*it+de*_t,w[9]=q*Le+K*it+ce*_t,w[10]=Z*Le+ee*it+we*_t,w[11]=$*Le+ue*it+fe*_t,D!==w&&(w[12]=D[12],w[13]=D[13],w[14]=D[14],w[15]=D[15]),w)},bn.rotateX=function(w,D,k){var S=Math.sin(k),I=Math.cos(k),O=D[4],B=D[5],U=D[6],q=D[7],Z=D[8],$=D[9],Y=D[10],K=D[11];return D!==w&&(w[0]=D[0],w[1]=D[1],w[2]=D[2],w[3]=D[3],w[12]=D[12],w[13]=D[13],w[14]=D[14],w[15]=D[15]),w[4]=O*I+Z*S,w[5]=B*I+$*S,w[6]=U*I+Y*S,w[7]=q*I+K*S,w[8]=Z*I-O*S,w[9]=$*I-B*S,w[10]=Y*I-U*S,w[11]=K*I-q*S,w},bn.rotateY=function(w,D,k){var S=Math.sin(k),I=Math.cos(k),O=D[0],B=D[1],U=D[2],q=D[3],Z=D[8],$=D[9],Y=D[10],K=D[11];return D!==w&&(w[4]=D[4],w[5]=D[5],w[6]=D[6],w[7]=D[7],w[12]=D[12],w[13]=D[13],w[14]=D[14],w[15]=D[15]),w[0]=O*I-Z*S,w[1]=B*I-$*S,w[2]=U*I-Y*S,w[3]=q*I-K*S,w[8]=O*S+Z*I,w[9]=B*S+$*I,w[10]=U*S+Y*I,w[11]=q*S+K*I,w},bn.rotateZ=function(w,D,k){var S=Math.sin(k),I=Math.cos(k),O=D[0],B=D[1],U=D[2],q=D[3],Z=D[4],$=D[5],Y=D[6],K=D[7];return D!==w&&(w[8]=D[8],w[9]=D[9],w[10]=D[10],w[11]=D[11],w[12]=D[12],w[13]=D[13],w[14]=D[14],w[15]=D[15]),w[0]=O*I+Z*S,w[1]=B*I+$*S,w[2]=U*I+Y*S,w[3]=q*I+K*S,w[4]=Z*I-O*S,w[5]=$*I-B*S,w[6]=Y*I-U*S,w[7]=K*I-q*S,w},bn.fromTranslation=function(w,D){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=D[0],w[13]=D[1],w[14]=D[2],w[15]=1,w},bn.fromScaling=function(w,D){return w[0]=D[0],w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=D[1],w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=D[2],w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},bn.fromRotation=function(w,D,k){var S,I,O,B=k[0],U=k[1],q=k[2],Z=Math.hypot(B,U,q);return Z<o.EPSILON?null:(B*=Z=1/Z,U*=Z,q*=Z,S=Math.sin(D),I=Math.cos(D),w[0]=B*B*(O=1-I)+I,w[1]=U*B*O+q*S,w[2]=q*B*O-U*S,w[3]=0,w[4]=B*U*O-q*S,w[5]=U*U*O+I,w[6]=q*U*O+B*S,w[7]=0,w[8]=B*q*O+U*S,w[9]=U*q*O-B*S,w[10]=q*q*O+I,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w)},bn.fromXRotation=function(w,D){var k=Math.sin(D),S=Math.cos(D);return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=S,w[6]=k,w[7]=0,w[8]=0,w[9]=-k,w[10]=S,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},bn.fromYRotation=function(w,D){var k=Math.sin(D),S=Math.cos(D);return w[0]=S,w[1]=0,w[2]=-k,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=k,w[9]=0,w[10]=S,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},bn.fromZRotation=function(w,D){var k=Math.sin(D),S=Math.cos(D);return w[0]=S,w[1]=k,w[2]=0,w[3]=0,w[4]=-k,w[5]=S,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},bn.fromRotationTranslation=p,bn.fromQuat2=function(w,D){var k=new o.ARRAY_TYPE(3),S=-D[0],I=-D[1],O=-D[2],B=D[3],U=D[4],q=D[5],Z=D[6],$=D[7],Y=S*S+I*I+O*O+B*B;return Y>0?(k[0]=2*(U*B+$*S+q*O-Z*I)/Y,k[1]=2*(q*B+$*I+Z*S-U*O)/Y,k[2]=2*(Z*B+$*O+U*I-q*S)/Y):(k[0]=2*(U*B+$*S+q*O-Z*I),k[1]=2*(q*B+$*I+Z*S-U*O),k[2]=2*(Z*B+$*O+U*I-q*S)),p(w,D,k),w},bn.getTranslation=function(w,D){return w[0]=D[12],w[1]=D[13],w[2]=D[14],w},bn.getScaling=y,bn.getRotation=function(w,D){var k=new o.ARRAY_TYPE(3);y(k,D);var S=1/k[0],I=1/k[1],O=1/k[2],B=D[0]*S,U=D[1]*I,q=D[2]*O,Z=D[4]*S,$=D[5]*I,Y=D[6]*O,K=D[8]*S,ee=D[9]*I,ue=D[10]*O,de=B+$+ue,ce=0;return de>0?(ce=2*Math.sqrt(de+1),w[3]=.25*ce,w[0]=(Y-ee)/ce,w[1]=(K-q)/ce,w[2]=(U-Z)/ce):B>$&&B>ue?(ce=2*Math.sqrt(1+B-$-ue),w[3]=(Y-ee)/ce,w[0]=.25*ce,w[1]=(U+Z)/ce,w[2]=(K+q)/ce):$>ue?(ce=2*Math.sqrt(1+$-B-ue),w[3]=(K-q)/ce,w[0]=(U+Z)/ce,w[1]=.25*ce,w[2]=(Y+ee)/ce):(ce=2*Math.sqrt(1+ue-B-$),w[3]=(U-Z)/ce,w[0]=(K+q)/ce,w[1]=(Y+ee)/ce,w[2]=.25*ce),w},bn.fromRotationTranslationScale=function(w,D,k,S){var I=D[0],O=D[1],B=D[2],U=D[3],q=I+I,Z=O+O,$=B+B,Y=I*q,K=I*Z,ee=I*$,ue=O*Z,de=O*$,ce=B*$,we=U*q,fe=U*Z,Te=U*$,ke=S[0],De=S[1],Pe=S[2];return w[0]=(1-(ue+ce))*ke,w[1]=(K+Te)*ke,w[2]=(ee-fe)*ke,w[3]=0,w[4]=(K-Te)*De,w[5]=(1-(Y+ce))*De,w[6]=(de+we)*De,w[7]=0,w[8]=(ee+fe)*Pe,w[9]=(de-we)*Pe,w[10]=(1-(Y+ue))*Pe,w[11]=0,w[12]=k[0],w[13]=k[1],w[14]=k[2],w[15]=1,w},bn.fromRotationTranslationScaleOrigin=function(w,D,k,S,I){var O=D[0],B=D[1],U=D[2],q=D[3],Z=O+O,$=B+B,Y=U+U,K=O*Z,ee=O*$,ue=O*Y,de=B*$,ce=B*Y,we=U*Y,fe=q*Z,Te=q*$,ke=q*Y,De=S[0],Pe=S[1],Ne=S[2],je=I[0],Le=I[1],it=I[2],_t=(1-(de+we))*De,rt=(ee+ke)*De,Et=(ue-Te)*De,St=(ee-ke)*Pe,zt=(1-(K+we))*Pe,lt=(ce+fe)*Pe,en=(ue+Te)*Ne,It=(ce-fe)*Ne,Xt=(1-(K+de))*Ne;return w[0]=_t,w[1]=rt,w[2]=Et,w[3]=0,w[4]=St,w[5]=zt,w[6]=lt,w[7]=0,w[8]=en,w[9]=It,w[10]=Xt,w[11]=0,w[12]=k[0]+je-(_t*je+St*Le+en*it),w[13]=k[1]+Le-(rt*je+zt*Le+It*it),w[14]=k[2]+it-(Et*je+lt*Le+Xt*it),w[15]=1,w},bn.fromQuat=function(w,D){var k=D[0],S=D[1],I=D[2],O=D[3],B=k+k,U=S+S,q=I+I,Z=k*B,$=S*B,Y=S*U,K=I*B,ee=I*U,ue=I*q,de=O*B,ce=O*U,we=O*q;return w[0]=1-Y-ue,w[1]=$+we,w[2]=K-ce,w[3]=0,w[4]=$-we,w[5]=1-Z-ue,w[6]=ee+de,w[7]=0,w[8]=K+ce,w[9]=ee-de,w[10]=1-Z-Y,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w},bn.frustum=function(w,D,k,S,I,O,B){var U=1/(k-D),q=1/(I-S),Z=1/(O-B);return w[0]=2*O*U,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=2*O*q,w[6]=0,w[7]=0,w[8]=(k+D)*U,w[9]=(I+S)*q,w[10]=(B+O)*Z,w[11]=-1,w[12]=0,w[13]=0,w[14]=B*O*2*Z,w[15]=0,w},bn.perspectiveNO=T,bn.perspectiveZO=function(w,D,k,S,I){var O,B=1/Math.tan(D/2);return w[0]=B/k,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=B,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,null!=I&&I!==1/0?(w[10]=I*(O=1/(S-I)),w[14]=I*S*O):(w[10]=-1,w[14]=-S),w},bn.perspectiveFromFieldOfView=function(w,D,k,S){var I=Math.tan(D.upDegrees*Math.PI/180),O=Math.tan(D.downDegrees*Math.PI/180),B=Math.tan(D.leftDegrees*Math.PI/180),U=Math.tan(D.rightDegrees*Math.PI/180),q=2/(B+U),Z=2/(I+O);return w[0]=q,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=Z,w[6]=0,w[7]=0,w[8]=-(B-U)*q*.5,w[9]=(I-O)*Z*.5,w[10]=S/(k-S),w[11]=-1,w[12]=0,w[13]=0,w[14]=S*k/(k-S),w[15]=0,w},bn.orthoNO=E,bn.orthoZO=function(w,D,k,S,I,O,B){var U=1/(D-k),q=1/(S-I),Z=1/(O-B);return w[0]=-2*U,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*q,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=Z,w[11]=0,w[12]=(D+k)*U,w[13]=(I+S)*q,w[14]=O*Z,w[15]=1,w},bn.lookAt=function(w,D,k,S){var I,O,B,U,q,Z,$,Y,K,ee,ue=D[0],de=D[1],ce=D[2],we=S[0],fe=S[1],Te=S[2],ke=k[0],De=k[1],Pe=k[2];return Math.abs(ue-ke)<o.EPSILON&&Math.abs(de-De)<o.EPSILON&&Math.abs(ce-Pe)<o.EPSILON?u(w):($=ue-ke,Y=de-De,K=ce-Pe,I=fe*(K*=ee=1/Math.hypot($,Y,K))-Te*(Y*=ee),O=Te*($*=ee)-we*K,B=we*Y-fe*$,(ee=Math.hypot(I,O,B))?(I*=ee=1/ee,O*=ee,B*=ee):(I=0,O=0,B=0),U=Y*B-K*O,q=K*I-$*B,Z=$*O-Y*I,(ee=Math.hypot(U,q,Z))?(U*=ee=1/ee,q*=ee,Z*=ee):(U=0,q=0,Z=0),w[0]=I,w[1]=U,w[2]=$,w[3]=0,w[4]=O,w[5]=q,w[6]=Y,w[7]=0,w[8]=B,w[9]=Z,w[10]=K,w[11]=0,w[12]=-(I*ue+O*de+B*ce),w[13]=-(U*ue+q*de+Z*ce),w[14]=-($*ue+Y*de+K*ce),w[15]=1,w)},bn.targetTo=function(w,D,k,S){var I=D[0],O=D[1],B=D[2],U=S[0],q=S[1],Z=S[2],$=I-k[0],Y=O-k[1],K=B-k[2],ee=$*$+Y*Y+K*K;ee>0&&($*=ee=1/Math.sqrt(ee),Y*=ee,K*=ee);var ue=q*K-Z*Y,de=Z*$-U*K,ce=U*Y-q*$;return(ee=ue*ue+de*de+ce*ce)>0&&(ue*=ee=1/Math.sqrt(ee),de*=ee,ce*=ee),w[0]=ue,w[1]=de,w[2]=ce,w[3]=0,w[4]=Y*ce-K*de,w[5]=K*ue-$*ce,w[6]=$*de-Y*ue,w[7]=0,w[8]=$,w[9]=Y,w[10]=K,w[11]=0,w[12]=I,w[13]=O,w[14]=B,w[15]=1,w},bn.str=function(w){return"mat4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+", "+w[8]+", "+w[9]+", "+w[10]+", "+w[11]+", "+w[12]+", "+w[13]+", "+w[14]+", "+w[15]+")"},bn.frob=function(w){return Math.hypot(w[0],w[1],w[2],w[3],w[4],w[5],w[6],w[7],w[8],w[9],w[10],w[11],w[12],w[13],w[14],w[15])},bn.add=function(w,D,k){return w[0]=D[0]+k[0],w[1]=D[1]+k[1],w[2]=D[2]+k[2],w[3]=D[3]+k[3],w[4]=D[4]+k[4],w[5]=D[5]+k[5],w[6]=D[6]+k[6],w[7]=D[7]+k[7],w[8]=D[8]+k[8],w[9]=D[9]+k[9],w[10]=D[10]+k[10],w[11]=D[11]+k[11],w[12]=D[12]+k[12],w[13]=D[13]+k[13],w[14]=D[14]+k[14],w[15]=D[15]+k[15],w},bn.subtract=R,bn.multiplyScalar=function(w,D,k){return w[0]=D[0]*k,w[1]=D[1]*k,w[2]=D[2]*k,w[3]=D[3]*k,w[4]=D[4]*k,w[5]=D[5]*k,w[6]=D[6]*k,w[7]=D[7]*k,w[8]=D[8]*k,w[9]=D[9]*k,w[10]=D[10]*k,w[11]=D[11]*k,w[12]=D[12]*k,w[13]=D[13]*k,w[14]=D[14]*k,w[15]=D[15]*k,w},bn.multiplyScalarAndAdd=function(w,D,k,S){return w[0]=D[0]+k[0]*S,w[1]=D[1]+k[1]*S,w[2]=D[2]+k[2]*S,w[3]=D[3]+k[3]*S,w[4]=D[4]+k[4]*S,w[5]=D[5]+k[5]*S,w[6]=D[6]+k[6]*S,w[7]=D[7]+k[7]*S,w[8]=D[8]+k[8]*S,w[9]=D[9]+k[9]*S,w[10]=D[10]+k[10]*S,w[11]=D[11]+k[11]*S,w[12]=D[12]+k[12]*S,w[13]=D[13]+k[13]*S,w[14]=D[14]+k[14]*S,w[15]=D[15]+k[15]*S,w},bn.exactEquals=function(w,D){return w[0]===D[0]&&w[1]===D[1]&&w[2]===D[2]&&w[3]===D[3]&&w[4]===D[4]&&w[5]===D[5]&&w[6]===D[6]&&w[7]===D[7]&&w[8]===D[8]&&w[9]===D[9]&&w[10]===D[10]&&w[11]===D[11]&&w[12]===D[12]&&w[13]===D[13]&&w[14]===D[14]&&w[15]===D[15]},bn.equals=function(w,D){var k=w[0],S=w[1],I=w[2],O=w[3],B=w[4],U=w[5],q=w[6],Z=w[7],$=w[8],Y=w[9],K=w[10],ee=w[11],ue=w[12],de=w[13],ce=w[14],we=w[15],fe=D[0],Te=D[1],ke=D[2],De=D[3],Pe=D[4],Ne=D[5],je=D[6],Le=D[7],it=D[8],_t=D[9],rt=D[10],Et=D[11],St=D[12],zt=D[13],lt=D[14],en=D[15];return Math.abs(k-fe)<=o.EPSILON*Math.max(1,Math.abs(k),Math.abs(fe))&&Math.abs(S-Te)<=o.EPSILON*Math.max(1,Math.abs(S),Math.abs(Te))&&Math.abs(I-ke)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(ke))&&Math.abs(O-De)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(De))&&Math.abs(B-Pe)<=o.EPSILON*Math.max(1,Math.abs(B),Math.abs(Pe))&&Math.abs(U-Ne)<=o.EPSILON*Math.max(1,Math.abs(U),Math.abs(Ne))&&Math.abs(q-je)<=o.EPSILON*Math.max(1,Math.abs(q),Math.abs(je))&&Math.abs(Z-Le)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Le))&&Math.abs($-it)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(it))&&Math.abs(Y-_t)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(_t))&&Math.abs(K-rt)<=o.EPSILON*Math.max(1,Math.abs(K),Math.abs(rt))&&Math.abs(ee-Et)<=o.EPSILON*Math.max(1,Math.abs(ee),Math.abs(Et))&&Math.abs(ue-St)<=o.EPSILON*Math.max(1,Math.abs(ue),Math.abs(St))&&Math.abs(de-zt)<=o.EPSILON*Math.max(1,Math.abs(de),Math.abs(zt))&&Math.abs(ce-lt)<=o.EPSILON*Math.max(1,Math.abs(ce),Math.abs(lt))&&Math.abs(we-en)<=o.EPSILON*Math.max(1,Math.abs(we),Math.abs(en))},bn.sub=bn.mul=bn.ortho=bn.perspective=void 0;var o=function(w){if(w&&w.__esModule)return w;if(null===w||"object"!==d(w)&&"function"!=typeof w)return{default:w};var k=l(void 0);if(k&&k.has(w))return k.get(w);var S={},I=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in w)if("default"!==O&&Object.prototype.hasOwnProperty.call(w,O)){var B=I?Object.getOwnPropertyDescriptor(w,O):null;B&&(B.get||B.set)?Object.defineProperty(S,O,B):S[O]=w[O]}return S.default=w,k&&k.set(w,S),S}(ks());function l(w){if("function"!=typeof WeakMap)return null;var D=new WeakMap,k=new WeakMap;return(l=function(S){return S?k:D})(w)}function u(w){return w[0]=1,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=1,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=1,w[11]=0,w[12]=0,w[13]=0,w[14]=0,w[15]=1,w}function _(w,D,k){var S=D[0],I=D[1],O=D[2],B=D[3],U=D[4],q=D[5],Z=D[6],$=D[7],Y=D[8],K=D[9],ee=D[10],ue=D[11],de=D[12],ce=D[13],we=D[14],fe=D[15],Te=k[0],ke=k[1],De=k[2],Pe=k[3];return w[0]=Te*S+ke*U+De*Y+Pe*de,w[1]=Te*I+ke*q+De*K+Pe*ce,w[2]=Te*O+ke*Z+De*ee+Pe*we,w[3]=Te*B+ke*$+De*ue+Pe*fe,w[4]=(Te=k[4])*S+(ke=k[5])*U+(De=k[6])*Y+(Pe=k[7])*de,w[5]=Te*I+ke*q+De*K+Pe*ce,w[6]=Te*O+ke*Z+De*ee+Pe*we,w[7]=Te*B+ke*$+De*ue+Pe*fe,w[8]=(Te=k[8])*S+(ke=k[9])*U+(De=k[10])*Y+(Pe=k[11])*de,w[9]=Te*I+ke*q+De*K+Pe*ce,w[10]=Te*O+ke*Z+De*ee+Pe*we,w[11]=Te*B+ke*$+De*ue+Pe*fe,w[12]=(Te=k[12])*S+(ke=k[13])*U+(De=k[14])*Y+(Pe=k[15])*de,w[13]=Te*I+ke*q+De*K+Pe*ce,w[14]=Te*O+ke*Z+De*ee+Pe*we,w[15]=Te*B+ke*$+De*ue+Pe*fe,w}function p(w,D,k){var S=D[0],I=D[1],O=D[2],B=D[3],U=S+S,q=I+I,Z=O+O,$=S*U,Y=S*q,K=S*Z,ee=I*q,ue=I*Z,de=O*Z,ce=B*U,we=B*q,fe=B*Z;return w[0]=1-(ee+de),w[1]=Y+fe,w[2]=K-we,w[3]=0,w[4]=Y-fe,w[5]=1-($+de),w[6]=ue+ce,w[7]=0,w[8]=K+we,w[9]=ue-ce,w[10]=1-($+ee),w[11]=0,w[12]=k[0],w[13]=k[1],w[14]=k[2],w[15]=1,w}function y(w,D){var k=D[4],S=D[5],I=D[6],O=D[8],B=D[9],U=D[10];return w[0]=Math.hypot(D[0],D[1],D[2]),w[1]=Math.hypot(k,S,I),w[2]=Math.hypot(O,B,U),w}function T(w,D,k,S,I){var O,B=1/Math.tan(D/2);return w[0]=B/k,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=B,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[11]=-1,w[12]=0,w[13]=0,w[15]=0,null!=I&&I!==1/0?(w[10]=(I+S)*(O=1/(S-I)),w[14]=2*I*S*O):(w[10]=-1,w[14]=-2*S),w}function E(w,D,k,S,I,O,B){var U=1/(D-k),q=1/(S-I),Z=1/(O-B);return w[0]=-2*U,w[1]=0,w[2]=0,w[3]=0,w[4]=0,w[5]=-2*q,w[6]=0,w[7]=0,w[8]=0,w[9]=0,w[10]=2*Z,w[11]=0,w[12]=(D+k)*U,w[13]=(I+S)*q,w[14]=(B+O)*Z,w[15]=1,w}function R(w,D,k){return w[0]=D[0]-k[0],w[1]=D[1]-k[1],w[2]=D[2]-k[2],w[3]=D[3]-k[3],w[4]=D[4]-k[4],w[5]=D[5]-k[5],w[6]=D[6]-k[6],w[7]=D[7]-k[7],w[8]=D[8]-k[8],w[9]=D[9]-k[9],w[10]=D[10]-k[10],w[11]=D[11]-k[11],w[12]=D[12]-k[12],w[13]=D[13]-k[13],w[14]=D[14]-k[14],w[15]=D[15]-k[15],w}return bn.perspective=T,bn.ortho=E,bn.mul=_,bn.sub=R,bn}var tl,xn={},Sn={};function ac(){if(tl)return Sn;function d(I){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(O){return typeof O}:function(O){return O&&"function"==typeof Symbol&&O.constructor===Symbol&&O!==Symbol.prototype?"symbol":typeof O})(I)}tl=1,Object.defineProperty(Sn,"__esModule",{value:!0}),Sn.create=u,Sn.clone=function(I){var O=new o.ARRAY_TYPE(3);return O[0]=I[0],O[1]=I[1],O[2]=I[2],O},Sn.length=_,Sn.fromValues=function(I,O,B){var U=new o.ARRAY_TYPE(3);return U[0]=I,U[1]=O,U[2]=B,U},Sn.copy=function(I,O){return I[0]=O[0],I[1]=O[1],I[2]=O[2],I},Sn.set=function(I,O,B,U){return I[0]=O,I[1]=B,I[2]=U,I},Sn.add=function(I,O,B){return I[0]=O[0]+B[0],I[1]=O[1]+B[1],I[2]=O[2]+B[2],I},Sn.subtract=p,Sn.multiply=y,Sn.divide=T,Sn.ceil=function(I,O){return I[0]=Math.ceil(O[0]),I[1]=Math.ceil(O[1]),I[2]=Math.ceil(O[2]),I},Sn.floor=function(I,O){return I[0]=Math.floor(O[0]),I[1]=Math.floor(O[1]),I[2]=Math.floor(O[2]),I},Sn.min=function(I,O,B){return I[0]=Math.min(O[0],B[0]),I[1]=Math.min(O[1],B[1]),I[2]=Math.min(O[2],B[2]),I},Sn.max=function(I,O,B){return I[0]=Math.max(O[0],B[0]),I[1]=Math.max(O[1],B[1]),I[2]=Math.max(O[2],B[2]),I},Sn.round=function(I,O){return I[0]=Math.round(O[0]),I[1]=Math.round(O[1]),I[2]=Math.round(O[2]),I},Sn.scale=function(I,O,B){return I[0]=O[0]*B,I[1]=O[1]*B,I[2]=O[2]*B,I},Sn.scaleAndAdd=function(I,O,B,U){return I[0]=O[0]+B[0]*U,I[1]=O[1]+B[1]*U,I[2]=O[2]+B[2]*U,I},Sn.distance=E,Sn.squaredDistance=R,Sn.squaredLength=w,Sn.negate=function(I,O){return I[0]=-O[0],I[1]=-O[1],I[2]=-O[2],I},Sn.inverse=function(I,O){return I[0]=1/O[0],I[1]=1/O[1],I[2]=1/O[2],I},Sn.normalize=function(I,O){var B=O[0],U=O[1],q=O[2],Z=B*B+U*U+q*q;return Z>0&&(Z=1/Math.sqrt(Z)),I[0]=O[0]*Z,I[1]=O[1]*Z,I[2]=O[2]*Z,I},Sn.dot=D,Sn.cross=function(I,O,B){var U=O[0],q=O[1],Z=O[2],$=B[0],Y=B[1],K=B[2];return I[0]=q*K-Z*Y,I[1]=Z*$-U*K,I[2]=U*Y-q*$,I},Sn.lerp=function(I,O,B,U){var q=O[0],Z=O[1],$=O[2];return I[0]=q+U*(B[0]-q),I[1]=Z+U*(B[1]-Z),I[2]=$+U*(B[2]-$),I},Sn.hermite=function(I,O,B,U,q,Z){var $=Z*Z,Y=$*(2*Z-3)+1,K=$*(Z-2)+Z,ee=$*(Z-1),ue=$*(3-2*Z);return I[0]=O[0]*Y+B[0]*K+U[0]*ee+q[0]*ue,I[1]=O[1]*Y+B[1]*K+U[1]*ee+q[1]*ue,I[2]=O[2]*Y+B[2]*K+U[2]*ee+q[2]*ue,I},Sn.bezier=function(I,O,B,U,q,Z){var $=1-Z,Y=$*$,K=Z*Z,ee=Y*$,ue=3*Z*Y,de=3*K*$,ce=K*Z;return I[0]=O[0]*ee+B[0]*ue+U[0]*de+q[0]*ce,I[1]=O[1]*ee+B[1]*ue+U[1]*de+q[1]*ce,I[2]=O[2]*ee+B[2]*ue+U[2]*de+q[2]*ce,I},Sn.random=function(I,O){O=O||1;var B=2*o.RANDOM()*Math.PI,U=2*o.RANDOM()-1,q=Math.sqrt(1-U*U)*O;return I[0]=Math.cos(B)*q,I[1]=Math.sin(B)*q,I[2]=U*O,I},Sn.transformMat4=function(I,O,B){var U=O[0],q=O[1],Z=O[2],$=B[3]*U+B[7]*q+B[11]*Z+B[15];return I[0]=(B[0]*U+B[4]*q+B[8]*Z+B[12])/($=$||1),I[1]=(B[1]*U+B[5]*q+B[9]*Z+B[13])/$,I[2]=(B[2]*U+B[6]*q+B[10]*Z+B[14])/$,I},Sn.transformMat3=function(I,O,B){var U=O[0],q=O[1],Z=O[2];return I[0]=U*B[0]+q*B[3]+Z*B[6],I[1]=U*B[1]+q*B[4]+Z*B[7],I[2]=U*B[2]+q*B[5]+Z*B[8],I},Sn.transformQuat=function(I,O,B){var U=B[0],q=B[1],Z=B[2],$=O[0],Y=O[1],K=O[2],ee=q*K-Z*Y,ue=Z*$-U*K,de=U*Y-q*$,ce=q*de-Z*ue,we=Z*ee-U*de,fe=U*ue-q*ee,Te=2*B[3];return ue*=Te,de*=Te,we*=2,fe*=2,I[0]=$+(ee*=Te)+(ce*=2),I[1]=Y+ue+we,I[2]=K+de+fe,I},Sn.rotateX=function(I,O,B,U){var q=[],Z=[];return q[0]=O[0]-B[0],q[1]=O[1]-B[1],q[2]=O[2]-B[2],Z[0]=q[0],Z[1]=q[1]*Math.cos(U)-q[2]*Math.sin(U),Z[2]=q[1]*Math.sin(U)+q[2]*Math.cos(U),I[0]=Z[0]+B[0],I[1]=Z[1]+B[1],I[2]=Z[2]+B[2],I},Sn.rotateY=function(I,O,B,U){var q=[],Z=[];return q[0]=O[0]-B[0],q[1]=O[1]-B[1],q[2]=O[2]-B[2],Z[0]=q[2]*Math.sin(U)+q[0]*Math.cos(U),Z[1]=q[1],Z[2]=q[2]*Math.cos(U)-q[0]*Math.sin(U),I[0]=Z[0]+B[0],I[1]=Z[1]+B[1],I[2]=Z[2]+B[2],I},Sn.rotateZ=function(I,O,B,U){var q=[],Z=[];return q[0]=O[0]-B[0],q[1]=O[1]-B[1],q[2]=O[2]-B[2],Z[0]=q[0]*Math.cos(U)-q[1]*Math.sin(U),Z[1]=q[0]*Math.sin(U)+q[1]*Math.cos(U),Z[2]=q[2],I[0]=Z[0]+B[0],I[1]=Z[1]+B[1],I[2]=Z[2]+B[2],I},Sn.angle=function(I,O){var B=I[0],U=I[1],q=I[2],Z=O[0],$=O[1],Y=O[2],K=Math.sqrt(B*B+U*U+q*q)*Math.sqrt(Z*Z+$*$+Y*Y),ee=K&&D(I,O)/K;return Math.acos(Math.min(Math.max(ee,-1),1))},Sn.zero=function(I){return I[0]=0,I[1]=0,I[2]=0,I},Sn.str=function(I){return"vec3("+I[0]+", "+I[1]+", "+I[2]+")"},Sn.exactEquals=function(I,O){return I[0]===O[0]&&I[1]===O[1]&&I[2]===O[2]},Sn.equals=function(I,O){var B=I[0],U=I[1],q=I[2],Z=O[0],$=O[1],Y=O[2];return Math.abs(B-Z)<=o.EPSILON*Math.max(1,Math.abs(B),Math.abs(Z))&&Math.abs(U-$)<=o.EPSILON*Math.max(1,Math.abs(U),Math.abs($))&&Math.abs(q-Y)<=o.EPSILON*Math.max(1,Math.abs(q),Math.abs(Y))},Sn.forEach=Sn.sqrLen=Sn.len=Sn.sqrDist=Sn.dist=Sn.div=Sn.mul=Sn.sub=void 0;var o=function(I){if(I&&I.__esModule)return I;if(null===I||"object"!==d(I)&&"function"!=typeof I)return{default:I};var B=l(void 0);if(B&&B.has(I))return B.get(I);var U={},q=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Z in I)if("default"!==Z&&Object.prototype.hasOwnProperty.call(I,Z)){var $=q?Object.getOwnPropertyDescriptor(I,Z):null;$&&($.get||$.set)?Object.defineProperty(U,Z,$):U[Z]=I[Z]}return U.default=I,B&&B.set(I,U),U}(ks());function l(I){if("function"!=typeof WeakMap)return null;var O=new WeakMap,B=new WeakMap;return(l=function(U){return U?B:O})(I)}function u(){var I=new o.ARRAY_TYPE(3);return o.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0),I}function _(I){return Math.hypot(I[0],I[1],I[2])}function p(I,O,B){return I[0]=O[0]-B[0],I[1]=O[1]-B[1],I[2]=O[2]-B[2],I}function y(I,O,B){return I[0]=O[0]*B[0],I[1]=O[1]*B[1],I[2]=O[2]*B[2],I}function T(I,O,B){return I[0]=O[0]/B[0],I[1]=O[1]/B[1],I[2]=O[2]/B[2],I}function E(I,O){return Math.hypot(O[0]-I[0],O[1]-I[1],O[2]-I[2])}function R(I,O){var B=O[0]-I[0],U=O[1]-I[1],q=O[2]-I[2];return B*B+U*U+q*q}function w(I){var O=I[0],B=I[1],U=I[2];return O*O+B*B+U*U}function D(I,O){return I[0]*O[0]+I[1]*O[1]+I[2]*O[2]}Sn.sub=p,Sn.mul=y,Sn.div=T,Sn.dist=E,Sn.sqrDist=R,Sn.len=_,Sn.sqrLen=w;var k,S=(k=u(),function(I,O,B,U,q,Z){var $,Y;for(O||(O=3),B||(B=0),Y=U?Math.min(U*O+B,I.length):I.length,$=B;$<Y;$+=O)k[0]=I[$],k[1]=I[$+1],k[2]=I[$+2],q(k,k,Z),I[$]=k[0],I[$+1]=k[1],I[$+2]=k[2];return I});return Sn.forEach=S,Sn}var nl,vu,ei={};function bs(){if(nl)return ei;function d(S){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(I){return typeof I}:function(I){return I&&"function"==typeof Symbol&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I})(S)}nl=1,Object.defineProperty(ei,"__esModule",{value:!0}),ei.create=u,ei.clone=function(S){var I=new o.ARRAY_TYPE(4);return I[0]=S[0],I[1]=S[1],I[2]=S[2],I[3]=S[3],I},ei.fromValues=function(S,I,O,B){var U=new o.ARRAY_TYPE(4);return U[0]=S,U[1]=I,U[2]=O,U[3]=B,U},ei.copy=function(S,I){return S[0]=I[0],S[1]=I[1],S[2]=I[2],S[3]=I[3],S},ei.set=function(S,I,O,B,U){return S[0]=I,S[1]=O,S[2]=B,S[3]=U,S},ei.add=function(S,I,O){return S[0]=I[0]+O[0],S[1]=I[1]+O[1],S[2]=I[2]+O[2],S[3]=I[3]+O[3],S},ei.subtract=_,ei.multiply=p,ei.divide=y,ei.ceil=function(S,I){return S[0]=Math.ceil(I[0]),S[1]=Math.ceil(I[1]),S[2]=Math.ceil(I[2]),S[3]=Math.ceil(I[3]),S},ei.floor=function(S,I){return S[0]=Math.floor(I[0]),S[1]=Math.floor(I[1]),S[2]=Math.floor(I[2]),S[3]=Math.floor(I[3]),S},ei.min=function(S,I,O){return S[0]=Math.min(I[0],O[0]),S[1]=Math.min(I[1],O[1]),S[2]=Math.min(I[2],O[2]),S[3]=Math.min(I[3],O[3]),S},ei.max=function(S,I,O){return S[0]=Math.max(I[0],O[0]),S[1]=Math.max(I[1],O[1]),S[2]=Math.max(I[2],O[2]),S[3]=Math.max(I[3],O[3]),S},ei.round=function(S,I){return S[0]=Math.round(I[0]),S[1]=Math.round(I[1]),S[2]=Math.round(I[2]),S[3]=Math.round(I[3]),S},ei.scale=function(S,I,O){return S[0]=I[0]*O,S[1]=I[1]*O,S[2]=I[2]*O,S[3]=I[3]*O,S},ei.scaleAndAdd=function(S,I,O,B){return S[0]=I[0]+O[0]*B,S[1]=I[1]+O[1]*B,S[2]=I[2]+O[2]*B,S[3]=I[3]+O[3]*B,S},ei.distance=T,ei.squaredDistance=E,ei.length=R,ei.squaredLength=w,ei.negate=function(S,I){return S[0]=-I[0],S[1]=-I[1],S[2]=-I[2],S[3]=-I[3],S},ei.inverse=function(S,I){return S[0]=1/I[0],S[1]=1/I[1],S[2]=1/I[2],S[3]=1/I[3],S},ei.normalize=function(S,I){var O=I[0],B=I[1],U=I[2],q=I[3],Z=O*O+B*B+U*U+q*q;return Z>0&&(Z=1/Math.sqrt(Z)),S[0]=O*Z,S[1]=B*Z,S[2]=U*Z,S[3]=q*Z,S},ei.dot=function(S,I){return S[0]*I[0]+S[1]*I[1]+S[2]*I[2]+S[3]*I[3]},ei.cross=function(S,I,O,B){var U=O[0]*B[1]-O[1]*B[0],q=O[0]*B[2]-O[2]*B[0],Z=O[0]*B[3]-O[3]*B[0],$=O[1]*B[2]-O[2]*B[1],Y=O[1]*B[3]-O[3]*B[1],K=O[2]*B[3]-O[3]*B[2],ee=I[0],ue=I[1],de=I[2],ce=I[3];return S[0]=ue*K-de*Y+ce*$,S[1]=-ee*K+de*Z-ce*q,S[2]=ee*Y-ue*Z+ce*U,S[3]=-ee*$+ue*q-de*U,S},ei.lerp=function(S,I,O,B){var U=I[0],q=I[1],Z=I[2],$=I[3];return S[0]=U+B*(O[0]-U),S[1]=q+B*(O[1]-q),S[2]=Z+B*(O[2]-Z),S[3]=$+B*(O[3]-$),S},ei.random=function(S,I){var O,B,U,q,Z,$;I=I||1;do{Z=(O=2*o.RANDOM()-1)*O+(B=2*o.RANDOM()-1)*B}while(Z>=1);do{$=(U=2*o.RANDOM()-1)*U+(q=2*o.RANDOM()-1)*q}while($>=1);var Y=Math.sqrt((1-Z)/$);return S[0]=I*O,S[1]=I*B,S[2]=I*U*Y,S[3]=I*q*Y,S},ei.transformMat4=function(S,I,O){var B=I[0],U=I[1],q=I[2],Z=I[3];return S[0]=O[0]*B+O[4]*U+O[8]*q+O[12]*Z,S[1]=O[1]*B+O[5]*U+O[9]*q+O[13]*Z,S[2]=O[2]*B+O[6]*U+O[10]*q+O[14]*Z,S[3]=O[3]*B+O[7]*U+O[11]*q+O[15]*Z,S},ei.transformQuat=function(S,I,O){var B=I[0],U=I[1],q=I[2],Z=O[0],$=O[1],Y=O[2],K=O[3],ee=K*B+$*q-Y*U,ue=K*U+Y*B-Z*q,de=K*q+Z*U-$*B,ce=-Z*B-$*U-Y*q;return S[0]=ee*K+ce*-Z+ue*-Y-de*-$,S[1]=ue*K+ce*-$+de*-Z-ee*-Y,S[2]=de*K+ce*-Y+ee*-$-ue*-Z,S[3]=I[3],S},ei.zero=function(S){return S[0]=0,S[1]=0,S[2]=0,S[3]=0,S},ei.str=function(S){return"vec4("+S[0]+", "+S[1]+", "+S[2]+", "+S[3]+")"},ei.exactEquals=function(S,I){return S[0]===I[0]&&S[1]===I[1]&&S[2]===I[2]&&S[3]===I[3]},ei.equals=function(S,I){var O=S[0],B=S[1],U=S[2],q=S[3],Z=I[0],$=I[1],Y=I[2],K=I[3];return Math.abs(O-Z)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(Z))&&Math.abs(B-$)<=o.EPSILON*Math.max(1,Math.abs(B),Math.abs($))&&Math.abs(U-Y)<=o.EPSILON*Math.max(1,Math.abs(U),Math.abs(Y))&&Math.abs(q-K)<=o.EPSILON*Math.max(1,Math.abs(q),Math.abs(K))},ei.forEach=ei.sqrLen=ei.len=ei.sqrDist=ei.dist=ei.div=ei.mul=ei.sub=void 0;var o=function(S){if(S&&S.__esModule)return S;if(null===S||"object"!==d(S)&&"function"!=typeof S)return{default:S};var O=l(void 0);if(O&&O.has(S))return O.get(S);var B={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in S)if("default"!==q&&Object.prototype.hasOwnProperty.call(S,q)){var Z=U?Object.getOwnPropertyDescriptor(S,q):null;Z&&(Z.get||Z.set)?Object.defineProperty(B,q,Z):B[q]=S[q]}return B.default=S,O&&O.set(S,B),B}(ks());function l(S){if("function"!=typeof WeakMap)return null;var I=new WeakMap,O=new WeakMap;return(l=function(B){return B?O:I})(S)}function u(){var S=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0,S[2]=0,S[3]=0),S}function _(S,I,O){return S[0]=I[0]-O[0],S[1]=I[1]-O[1],S[2]=I[2]-O[2],S[3]=I[3]-O[3],S}function p(S,I,O){return S[0]=I[0]*O[0],S[1]=I[1]*O[1],S[2]=I[2]*O[2],S[3]=I[3]*O[3],S}function y(S,I,O){return S[0]=I[0]/O[0],S[1]=I[1]/O[1],S[2]=I[2]/O[2],S[3]=I[3]/O[3],S}function T(S,I){return Math.hypot(I[0]-S[0],I[1]-S[1],I[2]-S[2],I[3]-S[3])}function E(S,I){var O=I[0]-S[0],B=I[1]-S[1],U=I[2]-S[2],q=I[3]-S[3];return O*O+B*B+U*U+q*q}function R(S){return Math.hypot(S[0],S[1],S[2],S[3])}function w(S){var I=S[0],O=S[1],B=S[2],U=S[3];return I*I+O*O+B*B+U*U}ei.sub=_,ei.mul=p,ei.div=y,ei.dist=T,ei.sqrDist=E,ei.len=R,ei.sqrLen=w;var D,k=(D=u(),function(S,I,O,B,U,q){var Z,$;for(I||(I=4),O||(O=0),$=B?Math.min(B*I+O,S.length):S.length,Z=O;Z<$;Z+=I)D[0]=S[Z],D[1]=S[Z+1],D[2]=S[Z+2],D[3]=S[Z+3],U(D,D,q),S[Z]=D[0],S[Z+1]=D[1],S[Z+2]=D[2],S[Z+3]=D[3];return S});return ei.forEach=k,ei}function El(){if(vu)return xn;function d(fe){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Te){return typeof Te}:function(Te){return Te&&"function"==typeof Symbol&&Te.constructor===Symbol&&Te!==Symbol.prototype?"symbol":typeof Te})(fe)}vu=1,Object.defineProperty(xn,"__esModule",{value:!0}),xn.create=T,xn.identity=function(fe){return fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe},xn.setAxisAngle=E,xn.getAxisAngle=function(fe,Te){var ke=2*Math.acos(Te[3]),De=Math.sin(ke/2);return De>o.EPSILON?(fe[0]=Te[0]/De,fe[1]=Te[1]/De,fe[2]=Te[2]/De):(fe[0]=1,fe[1]=0,fe[2]=0),ke},xn.getAngle=function(fe,Te){var ke=O(fe,Te);return Math.acos(2*ke*ke-1)},xn.multiply=R,xn.rotateX=function(fe,Te,ke){ke*=.5;var De=Te[0],Pe=Te[1],Ne=Te[2],je=Te[3],Le=Math.sin(ke),it=Math.cos(ke);return fe[0]=De*it+je*Le,fe[1]=Pe*it+Ne*Le,fe[2]=Ne*it-Pe*Le,fe[3]=je*it-De*Le,fe},xn.rotateY=function(fe,Te,ke){ke*=.5;var De=Te[0],Pe=Te[1],Ne=Te[2],je=Te[3],Le=Math.sin(ke),it=Math.cos(ke);return fe[0]=De*it-Ne*Le,fe[1]=Pe*it+je*Le,fe[2]=Ne*it+De*Le,fe[3]=je*it-Pe*Le,fe},xn.rotateZ=function(fe,Te,ke){ke*=.5;var De=Te[0],Pe=Te[1],Ne=Te[2],je=Te[3],Le=Math.sin(ke),it=Math.cos(ke);return fe[0]=De*it+Pe*Le,fe[1]=Pe*it-De*Le,fe[2]=Ne*it+je*Le,fe[3]=je*it-Ne*Le,fe},xn.calculateW=function(fe,Te){var ke=Te[0],De=Te[1],Pe=Te[2];return fe[0]=ke,fe[1]=De,fe[2]=Pe,fe[3]=Math.sqrt(Math.abs(1-ke*ke-De*De-Pe*Pe)),fe},xn.exp=w,xn.ln=D,xn.pow=function(fe,Te,ke){return D(fe,Te),I(fe,fe,ke),w(fe,fe),fe},xn.slerp=k,xn.random=function(fe){var Te=o.RANDOM(),ke=o.RANDOM(),De=o.RANDOM(),Pe=Math.sqrt(1-Te),Ne=Math.sqrt(Te);return fe[0]=Pe*Math.sin(2*Math.PI*ke),fe[1]=Pe*Math.cos(2*Math.PI*ke),fe[2]=Ne*Math.sin(2*Math.PI*De),fe[3]=Ne*Math.cos(2*Math.PI*De),fe},xn.invert=function(fe,Te){var ke=Te[0],De=Te[1],Pe=Te[2],Ne=Te[3],je=ke*ke+De*De+Pe*Pe+Ne*Ne,Le=je?1/je:0;return fe[0]=-ke*Le,fe[1]=-De*Le,fe[2]=-Pe*Le,fe[3]=Ne*Le,fe},xn.conjugate=function(fe,Te){return fe[0]=-Te[0],fe[1]=-Te[1],fe[2]=-Te[2],fe[3]=Te[3],fe},xn.fromMat3=S,xn.fromEuler=function(fe,Te,ke,De){var Pe=.5*Math.PI/180;Te*=Pe,ke*=Pe,De*=Pe;var Ne=Math.sin(Te),je=Math.cos(Te),Le=Math.sin(ke),it=Math.cos(ke),_t=Math.sin(De),rt=Math.cos(De);return fe[0]=Ne*it*rt-je*Le*_t,fe[1]=je*Le*rt+Ne*it*_t,fe[2]=je*it*_t-Ne*Le*rt,fe[3]=je*it*rt+Ne*Le*_t,fe},xn.str=function(fe){return"quat("+fe[0]+", "+fe[1]+", "+fe[2]+", "+fe[3]+")"},xn.setAxes=xn.sqlerp=xn.rotationTo=xn.equals=xn.exactEquals=xn.normalize=xn.sqrLen=xn.squaredLength=xn.len=xn.length=xn.lerp=xn.dot=xn.scale=xn.mul=xn.add=xn.set=xn.copy=xn.fromValues=xn.clone=void 0;var o=y(ks()),l=y(Fh()),u=y(ac()),_=y(bs());function p(fe){if("function"!=typeof WeakMap)return null;var Te=new WeakMap,ke=new WeakMap;return(p=function(De){return De?ke:Te})(fe)}function y(fe,Te){if(fe&&fe.__esModule)return fe;if(null===fe||"object"!==d(fe)&&"function"!=typeof fe)return{default:fe};var ke=p(Te);if(ke&&ke.has(fe))return ke.get(fe);var De={},Pe=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Ne in fe)if("default"!==Ne&&Object.prototype.hasOwnProperty.call(fe,Ne)){var je=Pe?Object.getOwnPropertyDescriptor(fe,Ne):null;je&&(je.get||je.set)?Object.defineProperty(De,Ne,je):De[Ne]=fe[Ne]}return De.default=fe,ke&&ke.set(fe,De),De}function T(){var fe=new o.ARRAY_TYPE(4);return o.ARRAY_TYPE!=Float32Array&&(fe[0]=0,fe[1]=0,fe[2]=0),fe[3]=1,fe}function E(fe,Te,ke){ke*=.5;var De=Math.sin(ke);return fe[0]=De*Te[0],fe[1]=De*Te[1],fe[2]=De*Te[2],fe[3]=Math.cos(ke),fe}function R(fe,Te,ke){var De=Te[0],Pe=Te[1],Ne=Te[2],je=Te[3],Le=ke[0],it=ke[1],_t=ke[2],rt=ke[3];return fe[0]=De*rt+je*Le+Pe*_t-Ne*it,fe[1]=Pe*rt+je*it+Ne*Le-De*_t,fe[2]=Ne*rt+je*_t+De*it-Pe*Le,fe[3]=je*rt-De*Le-Pe*it-Ne*_t,fe}function w(fe,Te){var ke=Te[0],De=Te[1],Pe=Te[2],Ne=Te[3],je=Math.sqrt(ke*ke+De*De+Pe*Pe),Le=Math.exp(Ne),it=je>0?Le*Math.sin(je)/je:0;return fe[0]=ke*it,fe[1]=De*it,fe[2]=Pe*it,fe[3]=Le*Math.cos(je),fe}function D(fe,Te){var ke=Te[0],De=Te[1],Pe=Te[2],Ne=Te[3],je=Math.sqrt(ke*ke+De*De+Pe*Pe),Le=je>0?Math.atan2(je,Ne)/je:0;return fe[0]=ke*Le,fe[1]=De*Le,fe[2]=Pe*Le,fe[3]=.5*Math.log(ke*ke+De*De+Pe*Pe+Ne*Ne),fe}function k(fe,Te,ke,De){var Pe,Ne,je,Le,it,_t=Te[0],rt=Te[1],Et=Te[2],St=Te[3],zt=ke[0],lt=ke[1],en=ke[2],It=ke[3];return(Ne=_t*zt+rt*lt+Et*en+St*It)<0&&(Ne=-Ne,zt=-zt,lt=-lt,en=-en,It=-It),1-Ne>o.EPSILON?(Pe=Math.acos(Ne),je=Math.sin(Pe),Le=Math.sin((1-De)*Pe)/je,it=Math.sin(De*Pe)/je):(Le=1-De,it=De),fe[0]=Le*_t+it*zt,fe[1]=Le*rt+it*lt,fe[2]=Le*Et+it*en,fe[3]=Le*St+it*It,fe}function S(fe,Te){var ke,De=Te[0]+Te[4]+Te[8];if(De>0)ke=Math.sqrt(De+1),fe[3]=.5*ke,fe[0]=(Te[5]-Te[7])*(ke=.5/ke),fe[1]=(Te[6]-Te[2])*ke,fe[2]=(Te[1]-Te[3])*ke;else{var Pe=0;Te[4]>Te[0]&&(Pe=1),Te[8]>Te[3*Pe+Pe]&&(Pe=2);var Ne=(Pe+1)%3,je=(Pe+2)%3;ke=Math.sqrt(Te[3*Pe+Pe]-Te[3*Ne+Ne]-Te[3*je+je]+1),fe[Pe]=.5*ke,fe[3]=(Te[3*Ne+je]-Te[3*je+Ne])*(ke=.5/ke),fe[Ne]=(Te[3*Ne+Pe]+Te[3*Pe+Ne])*ke,fe[je]=(Te[3*je+Pe]+Te[3*Pe+je])*ke}return fe}xn.clone=_.clone,xn.fromValues=_.fromValues,xn.copy=_.copy,xn.set=_.set,xn.add=_.add,xn.mul=R;var I=_.scale;xn.scale=I;var O=_.dot;xn.dot=O,xn.lerp=_.lerp;var B=_.length;xn.length=B,xn.len=B;var U=_.squaredLength;xn.squaredLength=U,xn.sqrLen=U;var q=_.normalize;xn.normalize=q,xn.exactEquals=_.exactEquals,xn.equals=_.equals;var Z,$,Y,K=(Z=u.create(),$=u.fromValues(1,0,0),Y=u.fromValues(0,1,0),function(fe,Te,ke){var De=u.dot(Te,ke);return De<-.999999?(u.cross(Z,$,Te),u.len(Z)<1e-6&&u.cross(Z,Y,Te),u.normalize(Z,Z),E(fe,Z,Math.PI),fe):De>.999999?(fe[0]=0,fe[1]=0,fe[2]=0,fe[3]=1,fe):(u.cross(Z,Te,ke),fe[0]=Z[0],fe[1]=Z[1],fe[2]=Z[2],fe[3]=1+De,q(fe,fe))});xn.rotationTo=K;var ee,ue,de=(ee=T(),ue=T(),function(fe,Te,ke,De,Pe,Ne){return k(ee,Te,Pe,Ne),k(ue,ke,De,Ne),k(fe,ee,ue,2*Ne*(1-Ne)),fe});xn.sqlerp=de;var ce,we=(ce=l.create(),function(fe,Te,ke,De){return ce[0]=ke[0],ce[3]=ke[1],ce[6]=ke[2],ce[1]=De[0],ce[4]=De[1],ce[7]=De[2],ce[2]=-Te[0],ce[5]=-Te[1],ce[8]=-Te[2],q(fe,S(fe,ce))});return xn.setAxes=we,xn}var Cd,Un={};var sp,Lh,Fn={};function Nh(){if(sp)return Fn;function d(S){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(I){return typeof I}:function(I){return I&&"function"==typeof Symbol&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I})(S)}sp=1,Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.create=u,Fn.clone=function(S){var I=new o.ARRAY_TYPE(2);return I[0]=S[0],I[1]=S[1],I},Fn.fromValues=function(S,I){var O=new o.ARRAY_TYPE(2);return O[0]=S,O[1]=I,O},Fn.copy=function(S,I){return S[0]=I[0],S[1]=I[1],S},Fn.set=function(S,I,O){return S[0]=I,S[1]=O,S},Fn.add=function(S,I,O){return S[0]=I[0]+O[0],S[1]=I[1]+O[1],S},Fn.subtract=_,Fn.multiply=p,Fn.divide=y,Fn.ceil=function(S,I){return S[0]=Math.ceil(I[0]),S[1]=Math.ceil(I[1]),S},Fn.floor=function(S,I){return S[0]=Math.floor(I[0]),S[1]=Math.floor(I[1]),S},Fn.min=function(S,I,O){return S[0]=Math.min(I[0],O[0]),S[1]=Math.min(I[1],O[1]),S},Fn.max=function(S,I,O){return S[0]=Math.max(I[0],O[0]),S[1]=Math.max(I[1],O[1]),S},Fn.round=function(S,I){return S[0]=Math.round(I[0]),S[1]=Math.round(I[1]),S},Fn.scale=function(S,I,O){return S[0]=I[0]*O,S[1]=I[1]*O,S},Fn.scaleAndAdd=function(S,I,O,B){return S[0]=I[0]+O[0]*B,S[1]=I[1]+O[1]*B,S},Fn.distance=T,Fn.squaredDistance=E,Fn.length=R,Fn.squaredLength=w,Fn.negate=function(S,I){return S[0]=-I[0],S[1]=-I[1],S},Fn.inverse=function(S,I){return S[0]=1/I[0],S[1]=1/I[1],S},Fn.normalize=function(S,I){var O=I[0],B=I[1],U=O*O+B*B;return U>0&&(U=1/Math.sqrt(U)),S[0]=I[0]*U,S[1]=I[1]*U,S},Fn.dot=function(S,I){return S[0]*I[0]+S[1]*I[1]},Fn.cross=function(S,I,O){var B=I[0]*O[1]-I[1]*O[0];return S[0]=S[1]=0,S[2]=B,S},Fn.lerp=function(S,I,O,B){var U=I[0],q=I[1];return S[0]=U+B*(O[0]-U),S[1]=q+B*(O[1]-q),S},Fn.random=function(S,I){I=I||1;var O=2*o.RANDOM()*Math.PI;return S[0]=Math.cos(O)*I,S[1]=Math.sin(O)*I,S},Fn.transformMat2=function(S,I,O){var B=I[0],U=I[1];return S[0]=O[0]*B+O[2]*U,S[1]=O[1]*B+O[3]*U,S},Fn.transformMat2d=function(S,I,O){var B=I[0],U=I[1];return S[0]=O[0]*B+O[2]*U+O[4],S[1]=O[1]*B+O[3]*U+O[5],S},Fn.transformMat3=function(S,I,O){var B=I[0],U=I[1];return S[0]=O[0]*B+O[3]*U+O[6],S[1]=O[1]*B+O[4]*U+O[7],S},Fn.transformMat4=function(S,I,O){var B=I[0],U=I[1];return S[0]=O[0]*B+O[4]*U+O[12],S[1]=O[1]*B+O[5]*U+O[13],S},Fn.rotate=function(S,I,O,B){var U=I[0]-O[0],q=I[1]-O[1],Z=Math.sin(B),$=Math.cos(B);return S[0]=U*$-q*Z+O[0],S[1]=U*Z+q*$+O[1],S},Fn.angle=function(S,I){var O=S[0],B=S[1],U=I[0],q=I[1],Z=Math.sqrt(O*O+B*B)*Math.sqrt(U*U+q*q);return Math.acos(Math.min(Math.max(Z&&(O*U+B*q)/Z,-1),1))},Fn.zero=function(S){return S[0]=0,S[1]=0,S},Fn.str=function(S){return"vec2("+S[0]+", "+S[1]+")"},Fn.exactEquals=function(S,I){return S[0]===I[0]&&S[1]===I[1]},Fn.equals=function(S,I){var O=S[0],B=S[1],U=I[0],q=I[1];return Math.abs(O-U)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(U))&&Math.abs(B-q)<=o.EPSILON*Math.max(1,Math.abs(B),Math.abs(q))},Fn.forEach=Fn.sqrLen=Fn.sqrDist=Fn.dist=Fn.div=Fn.mul=Fn.sub=Fn.len=void 0;var o=function(S){if(S&&S.__esModule)return S;if(null===S||"object"!==d(S)&&"function"!=typeof S)return{default:S};var O=l(void 0);if(O&&O.has(S))return O.get(S);var B={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in S)if("default"!==q&&Object.prototype.hasOwnProperty.call(S,q)){var Z=U?Object.getOwnPropertyDescriptor(S,q):null;Z&&(Z.get||Z.set)?Object.defineProperty(B,q,Z):B[q]=S[q]}return B.default=S,O&&O.set(S,B),B}(ks());function l(S){if("function"!=typeof WeakMap)return null;var I=new WeakMap,O=new WeakMap;return(l=function(B){return B?O:I})(S)}function u(){var S=new o.ARRAY_TYPE(2);return o.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0),S}function _(S,I,O){return S[0]=I[0]-O[0],S[1]=I[1]-O[1],S}function p(S,I,O){return S[0]=I[0]*O[0],S[1]=I[1]*O[1],S}function y(S,I,O){return S[0]=I[0]/O[0],S[1]=I[1]/O[1],S}function T(S,I){return Math.hypot(I[0]-S[0],I[1]-S[1])}function E(S,I){var O=I[0]-S[0],B=I[1]-S[1];return O*O+B*B}function R(S){return Math.hypot(S[0],S[1])}function w(S){var I=S[0],O=S[1];return I*I+O*O}Fn.len=R,Fn.sub=_,Fn.mul=p,Fn.div=y,Fn.dist=T,Fn.sqrDist=E,Fn.sqrLen=w;var D,k=(D=u(),function(S,I,O,B,U,q){var Z,$;for(I||(I=2),O||(O=0),$=B?Math.min(B*I+O,S.length):S.length,Z=O;Z<$;Z+=I)D[0]=S[Z],D[1]=S[Z+1],U(D,D,q),S[Z]=D[0],S[Z+1]=D[1];return S});return Fn.forEach=k,Fn}var qs,zh,Ym,Bh,Oe=function Dl(){if(Lh)return xi;function d(S){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(I){return typeof I}:function(I){return I&&"function"==typeof Symbol&&I.constructor===Symbol&&I!==Symbol.prototype?"symbol":typeof I})(S)}Lh=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.vec4=xi.vec3=xi.vec2=xi.quat2=xi.quat=xi.mat4=xi.mat3=xi.mat2d=xi.mat2=xi.glMatrix=void 0;var o=k(ks());xi.glMatrix=o;var l=k(Oi());xi.mat2=l;var u=k(wd());xi.mat2d=u;var _=k(Fh());xi.mat3=_;var p=k(el());xi.mat4=p;var y=k(El());xi.quat=y;var T=k(function lc(){if(Cd)return Un;function d(k){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(S){return typeof S}:function(S){return S&&"function"==typeof Symbol&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S})(k)}Cd=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.create=function(){var k=new o.ARRAY_TYPE(8);return o.ARRAY_TYPE!=Float32Array&&(k[0]=0,k[1]=0,k[2]=0,k[4]=0,k[5]=0,k[6]=0,k[7]=0),k[3]=1,k},Un.clone=function(k){var S=new o.ARRAY_TYPE(8);return S[0]=k[0],S[1]=k[1],S[2]=k[2],S[3]=k[3],S[4]=k[4],S[5]=k[5],S[6]=k[6],S[7]=k[7],S},Un.fromValues=function(k,S,I,O,B,U,q,Z){var $=new o.ARRAY_TYPE(8);return $[0]=k,$[1]=S,$[2]=I,$[3]=O,$[4]=B,$[5]=U,$[6]=q,$[7]=Z,$},Un.fromRotationTranslationValues=function(k,S,I,O,B,U,q){var Z=new o.ARRAY_TYPE(8);Z[0]=k,Z[1]=S,Z[2]=I,Z[3]=O;var $=.5*B,Y=.5*U,K=.5*q;return Z[4]=$*O+Y*I-K*S,Z[5]=Y*O+K*k-$*I,Z[6]=K*O+$*S-Y*k,Z[7]=-$*k-Y*S-K*I,Z},Un.fromRotationTranslation=y,Un.fromTranslation=function(k,S){return k[0]=0,k[1]=0,k[2]=0,k[3]=1,k[4]=.5*S[0],k[5]=.5*S[1],k[6]=.5*S[2],k[7]=0,k},Un.fromRotation=function(k,S){return k[0]=S[0],k[1]=S[1],k[2]=S[2],k[3]=S[3],k[4]=0,k[5]=0,k[6]=0,k[7]=0,k},Un.fromMat4=function(k,S){var I=l.create();u.getRotation(I,S);var O=new o.ARRAY_TYPE(3);return u.getTranslation(O,S),y(k,I,O),k},Un.copy=T,Un.identity=function(k){return k[0]=0,k[1]=0,k[2]=0,k[3]=1,k[4]=0,k[5]=0,k[6]=0,k[7]=0,k},Un.set=function(k,S,I,O,B,U,q,Z,$){return k[0]=S,k[1]=I,k[2]=O,k[3]=B,k[4]=U,k[5]=q,k[6]=Z,k[7]=$,k},Un.getDual=function(k,S){return k[0]=S[4],k[1]=S[5],k[2]=S[6],k[3]=S[7],k},Un.setDual=function(k,S){return k[4]=S[0],k[5]=S[1],k[6]=S[2],k[7]=S[3],k},Un.getTranslation=function(k,S){var I=S[4],O=S[5],B=S[6],U=S[7],q=-S[0],Z=-S[1],$=-S[2],Y=S[3];return k[0]=2*(I*Y+U*q+O*$-B*Z),k[1]=2*(O*Y+U*Z+B*q-I*$),k[2]=2*(B*Y+U*$+I*Z-O*q),k},Un.translate=function(k,S,I){var O=S[0],B=S[1],U=S[2],q=S[3],Z=.5*I[0],$=.5*I[1],Y=.5*I[2],K=S[4],ee=S[5],ue=S[6],de=S[7];return k[0]=O,k[1]=B,k[2]=U,k[3]=q,k[4]=q*Z+B*Y-U*$+K,k[5]=q*$+U*Z-O*Y+ee,k[6]=q*Y+O*$-B*Z+ue,k[7]=-O*Z-B*$-U*Y+de,k},Un.rotateX=function(k,S,I){var O=-S[0],B=-S[1],U=-S[2],q=S[3],Z=S[4],$=S[5],Y=S[6],K=S[7],ee=Z*q+K*O+$*U-Y*B,ue=$*q+K*B+Y*O-Z*U,de=Y*q+K*U+Z*B-$*O,ce=K*q-Z*O-$*B-Y*U;return l.rotateX(k,S,I),k[4]=ee*(q=k[3])+ce*(O=k[0])+ue*(U=k[2])-de*(B=k[1]),k[5]=ue*q+ce*B+de*O-ee*U,k[6]=de*q+ce*U+ee*B-ue*O,k[7]=ce*q-ee*O-ue*B-de*U,k},Un.rotateY=function(k,S,I){var O=-S[0],B=-S[1],U=-S[2],q=S[3],Z=S[4],$=S[5],Y=S[6],K=S[7],ee=Z*q+K*O+$*U-Y*B,ue=$*q+K*B+Y*O-Z*U,de=Y*q+K*U+Z*B-$*O,ce=K*q-Z*O-$*B-Y*U;return l.rotateY(k,S,I),k[4]=ee*(q=k[3])+ce*(O=k[0])+ue*(U=k[2])-de*(B=k[1]),k[5]=ue*q+ce*B+de*O-ee*U,k[6]=de*q+ce*U+ee*B-ue*O,k[7]=ce*q-ee*O-ue*B-de*U,k},Un.rotateZ=function(k,S,I){var O=-S[0],B=-S[1],U=-S[2],q=S[3],Z=S[4],$=S[5],Y=S[6],K=S[7],ee=Z*q+K*O+$*U-Y*B,ue=$*q+K*B+Y*O-Z*U,de=Y*q+K*U+Z*B-$*O,ce=K*q-Z*O-$*B-Y*U;return l.rotateZ(k,S,I),k[4]=ee*(q=k[3])+ce*(O=k[0])+ue*(U=k[2])-de*(B=k[1]),k[5]=ue*q+ce*B+de*O-ee*U,k[6]=de*q+ce*U+ee*B-ue*O,k[7]=ce*q-ee*O-ue*B-de*U,k},Un.rotateByQuatAppend=function(k,S,I){var O=I[0],B=I[1],U=I[2],q=I[3],Z=S[0],$=S[1],Y=S[2],K=S[3];return k[0]=Z*q+K*O+$*U-Y*B,k[1]=$*q+K*B+Y*O-Z*U,k[2]=Y*q+K*U+Z*B-$*O,k[3]=K*q-Z*O-$*B-Y*U,k[4]=(Z=S[4])*q+(K=S[7])*O+($=S[5])*U-(Y=S[6])*B,k[5]=$*q+K*B+Y*O-Z*U,k[6]=Y*q+K*U+Z*B-$*O,k[7]=K*q-Z*O-$*B-Y*U,k},Un.rotateByQuatPrepend=function(k,S,I){var O=S[0],B=S[1],U=S[2],q=S[3],Z=I[0],$=I[1],Y=I[2],K=I[3];return k[0]=O*K+q*Z+B*Y-U*$,k[1]=B*K+q*$+U*Z-O*Y,k[2]=U*K+q*Y+O*$-B*Z,k[3]=q*K-O*Z-B*$-U*Y,k[4]=O*(K=I[7])+q*(Z=I[4])+B*(Y=I[6])-U*($=I[5]),k[5]=B*K+q*$+U*Z-O*Y,k[6]=U*K+q*Y+O*$-B*Z,k[7]=q*K-O*Z-B*$-U*Y,k},Un.rotateAroundAxis=function(k,S,I,O){if(Math.abs(O)<o.EPSILON)return T(k,S);var B=Math.hypot(I[0],I[1],I[2]);O*=.5;var U=Math.sin(O),q=U*I[0]/B,Z=U*I[1]/B,$=U*I[2]/B,Y=Math.cos(O),K=S[0],ee=S[1],ue=S[2],de=S[3];k[0]=K*Y+de*q+ee*$-ue*Z,k[1]=ee*Y+de*Z+ue*q-K*$,k[2]=ue*Y+de*$+K*Z-ee*q,k[3]=de*Y-K*q-ee*Z-ue*$;var ce=S[4],we=S[5],fe=S[6],Te=S[7];return k[4]=ce*Y+Te*q+we*$-fe*Z,k[5]=we*Y+Te*Z+fe*q-ce*$,k[6]=fe*Y+Te*$+ce*Z-we*q,k[7]=Te*Y-ce*q-we*Z-fe*$,k},Un.add=function(k,S,I){return k[0]=S[0]+I[0],k[1]=S[1]+I[1],k[2]=S[2]+I[2],k[3]=S[3]+I[3],k[4]=S[4]+I[4],k[5]=S[5]+I[5],k[6]=S[6]+I[6],k[7]=S[7]+I[7],k},Un.multiply=E,Un.scale=function(k,S,I){return k[0]=S[0]*I,k[1]=S[1]*I,k[2]=S[2]*I,k[3]=S[3]*I,k[4]=S[4]*I,k[5]=S[5]*I,k[6]=S[6]*I,k[7]=S[7]*I,k},Un.lerp=function(k,S,I,O){var B=1-O;return R(S,I)<0&&(O=-O),k[0]=S[0]*B+I[0]*O,k[1]=S[1]*B+I[1]*O,k[2]=S[2]*B+I[2]*O,k[3]=S[3]*B+I[3]*O,k[4]=S[4]*B+I[4]*O,k[5]=S[5]*B+I[5]*O,k[6]=S[6]*B+I[6]*O,k[7]=S[7]*B+I[7]*O,k},Un.invert=function(k,S){var I=D(S);return k[0]=-S[0]/I,k[1]=-S[1]/I,k[2]=-S[2]/I,k[3]=S[3]/I,k[4]=-S[4]/I,k[5]=-S[5]/I,k[6]=-S[6]/I,k[7]=S[7]/I,k},Un.conjugate=function(k,S){return k[0]=-S[0],k[1]=-S[1],k[2]=-S[2],k[3]=S[3],k[4]=-S[4],k[5]=-S[5],k[6]=-S[6],k[7]=S[7],k},Un.normalize=function(k,S){var I=D(S);if(I>0){I=Math.sqrt(I);var O=S[0]/I,B=S[1]/I,U=S[2]/I,q=S[3]/I,Z=S[4],$=S[5],Y=S[6],K=S[7],ee=O*Z+B*$+U*Y+q*K;k[0]=O,k[1]=B,k[2]=U,k[3]=q,k[4]=(Z-O*ee)/I,k[5]=($-B*ee)/I,k[6]=(Y-U*ee)/I,k[7]=(K-q*ee)/I}return k},Un.str=function(k){return"quat2("+k[0]+", "+k[1]+", "+k[2]+", "+k[3]+", "+k[4]+", "+k[5]+", "+k[6]+", "+k[7]+")"},Un.exactEquals=function(k,S){return k[0]===S[0]&&k[1]===S[1]&&k[2]===S[2]&&k[3]===S[3]&&k[4]===S[4]&&k[5]===S[5]&&k[6]===S[6]&&k[7]===S[7]},Un.equals=function(k,S){var I=k[0],O=k[1],B=k[2],U=k[3],q=k[4],Z=k[5],$=k[6],Y=k[7],K=S[0],ee=S[1],ue=S[2],de=S[3],ce=S[4],we=S[5],fe=S[6],Te=S[7];return Math.abs(I-K)<=o.EPSILON*Math.max(1,Math.abs(I),Math.abs(K))&&Math.abs(O-ee)<=o.EPSILON*Math.max(1,Math.abs(O),Math.abs(ee))&&Math.abs(B-ue)<=o.EPSILON*Math.max(1,Math.abs(B),Math.abs(ue))&&Math.abs(U-de)<=o.EPSILON*Math.max(1,Math.abs(U),Math.abs(de))&&Math.abs(q-ce)<=o.EPSILON*Math.max(1,Math.abs(q),Math.abs(ce))&&Math.abs(Z-we)<=o.EPSILON*Math.max(1,Math.abs(Z),Math.abs(we))&&Math.abs($-fe)<=o.EPSILON*Math.max(1,Math.abs($),Math.abs(fe))&&Math.abs(Y-Te)<=o.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Te))},Un.sqrLen=Un.squaredLength=Un.len=Un.length=Un.dot=Un.mul=Un.setReal=Un.getReal=void 0;var o=p(ks()),l=p(El()),u=p(el());function _(k){if("function"!=typeof WeakMap)return null;var S=new WeakMap,I=new WeakMap;return(_=function(O){return O?I:S})(k)}function p(k,S){if(k&&k.__esModule)return k;if(null===k||"object"!==d(k)&&"function"!=typeof k)return{default:k};var I=_(S);if(I&&I.has(k))return I.get(k);var O={},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in k)if("default"!==U&&Object.prototype.hasOwnProperty.call(k,U)){var q=B?Object.getOwnPropertyDescriptor(k,U):null;q&&(q.get||q.set)?Object.defineProperty(O,U,q):O[U]=k[U]}return O.default=k,I&&I.set(k,O),O}function y(k,S,I){var O=.5*I[0],B=.5*I[1],U=.5*I[2],q=S[0],Z=S[1],$=S[2],Y=S[3];return k[0]=q,k[1]=Z,k[2]=$,k[3]=Y,k[4]=O*Y+B*$-U*Z,k[5]=B*Y+U*q-O*$,k[6]=U*Y+O*Z-B*q,k[7]=-O*q-B*Z-U*$,k}function T(k,S){return k[0]=S[0],k[1]=S[1],k[2]=S[2],k[3]=S[3],k[4]=S[4],k[5]=S[5],k[6]=S[6],k[7]=S[7],k}function E(k,S,I){var O=S[0],B=S[1],U=S[2],q=S[3],Z=I[4],$=I[5],Y=I[6],K=I[7],ee=S[4],ue=S[5],de=S[6],ce=S[7],we=I[0],fe=I[1],Te=I[2],ke=I[3];return k[0]=O*ke+q*we+B*Te-U*fe,k[1]=B*ke+q*fe+U*we-O*Te,k[2]=U*ke+q*Te+O*fe-B*we,k[3]=q*ke-O*we-B*fe-U*Te,k[4]=O*K+q*Z+B*Y-U*$+ee*ke+ce*we+ue*Te-de*fe,k[5]=B*K+q*$+U*Z-O*Y+ue*ke+ce*fe+de*we-ee*Te,k[6]=U*K+q*Y+O*$-B*Z+de*ke+ce*Te+ee*fe-ue*we,k[7]=q*K-O*Z-B*$-U*Y+ce*ke-ee*we-ue*fe-de*Te,k}Un.getReal=l.copy,Un.setReal=l.copy,Un.mul=E;var R=l.dot;Un.dot=R;var w=l.length;Un.length=w,Un.len=w;var D=l.squaredLength;return Un.squaredLength=D,Un.sqrLen=D,Un}());xi.quat2=T;var E=k(Nh());xi.vec2=E;var R=k(ac());xi.vec3=R;var w=k(bs());function D(S){if("function"!=typeof WeakMap)return null;var I=new WeakMap,O=new WeakMap;return(D=function(B){return B?O:I})(S)}function k(S,I){if(S&&S.__esModule)return S;if(null===S||"object"!==d(S)&&"function"!=typeof S)return{default:S};var O=D(I);if(O&&O.has(S))return O.get(S);var B={},U=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var q in S)if("default"!==q&&Object.prototype.hasOwnProperty.call(S,q)){var Z=U?Object.getOwnPropertyDescriptor(S,q):null;Z&&(Z.get||Z.set)?Object.defineProperty(B,q,Z):B[q]=S[q]}return B.default=S,O&&O.set(S,B),B}return xi.vec4=w,xi}(),Nc=function(){if(zh)return qs;function d(o,l,u,_){this.cx=3*o,this.bx=3*(u-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(_-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=l,this.p2x=u,this.p2y=_}return zh=1,qs=d,d.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,l){if(void 0===l&&(l=1e-6),o<0)return 0;if(o>1)return 1;for(var u=o,_=0;_<8;_++){var p=this.sampleCurveX(u)-o;if(Math.abs(p)<l)return u;var y=this.sampleCurveDerivativeX(u);if(Math.abs(y)<1e-6)break;u-=p/y}var T=0,E=1;for(u=o,_=0;_<20&&(p=this.sampleCurveX(u),!(Math.abs(p-o)<l));_++)o>p?T=u:E=u,u=.5*(E-T)+T;return u},solve:function(o,l){return this.sampleCurveY(this.solveCurveX(o,l))}},qs}(),bu=To(Nc);function xu(){if(Bh)return Ym;function d(o,l){this.x=o,this.y=l}return Bh=1,Ym=d,d.prototype={clone:function(){return new d(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,l){return this.clone()._rotateAround(o,l)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var l=o.x-this.x,u=o.y-this.y;return l*l+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,l){return Math.atan2(this.x*l-this.y*o,this.x*o+this.y*l)},_matMult:function(o){var l=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=l,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var l=Math.cos(o),u=Math.sin(o),_=u*this.x+l*this.y;return this.x=l*this.x-u*this.y,this.y=_,this},_rotateAround:function(o,l){var u=Math.cos(o),_=Math.sin(o),p=l.y+_*(this.x-l.x)+u*(this.y-l.y);return this.x=l.x+u*(this.x-l.x)-_*(this.y-l.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},d.convert=function(o){return o instanceof d?o:Array.isArray(o)?new d(o[0],o[1]):o},Ym}var Ft=To(xu());function zc(d,o){if(Array.isArray(d)){if(!Array.isArray(o)||d.length!==o.length)return!1;for(let l=0;l<d.length;l++)if(!zc(d[l],o[l]))return!1;return!0}if("object"==typeof d&&null!==d&&null!==o){if("object"!=typeof o||Object.keys(d).length!==Object.keys(o).length)return!1;for(const l in d)if(!zc(d[l],o[l]))return!1;return!0}return d===o}const Ho=Math.PI/180,Bc=180/Math.PI;function vi(d){return d*Ho}function pi(d){return d*Bc}const Fa=[[0,0],[1,0],[1,1],[0,1]];function Vc(d){if(d<=0)return 0;if(d>=1)return 1;const o=d*d,l=o*d;return 4*(d<.5?l:3*(d-o)+l-.75)}function Il(d,o,l,u){const _=new bu(d,o,l,u);return function(p){return _.solve(p)}}const Ni=Il(.25,.1,.25,1);function En(d,o,l){return Math.min(l,Math.max(o,d))}function wu(d,o,l){return(l=En((l-d)/(o-d),0,1))*l*(3-2*l)}function cc(d,o,l){const u=l-o,_=((d-o)%u+u)%u+o;return _===o?l:_}function La(d,o,l){if(!d.length)return l(null,[]);let u=d.length;const _=new Array(d.length);let p=null;d.forEach((y,T)=>{o(y,(E,R)=>{E&&(p=E),_[T]=R,0==--u&&l(p,_)})})}function $o(d,...o){for(const l of o)for(const u in l)d[u]=l[u];return d}let ga=1;function Cu(){return ga++}function ap(d){return d<=1?1:Math.pow(2,Math.ceil(Math.log(d)/Math.LN2))}function Vh(d,o){d.forEach(l=>{o[l]&&(o[l]=o[l].bind(o))})}function Uc(d,o){return-1!==d.indexOf(o,d.length-o.length)}function jc(d,o,l){const u={};for(const _ in d)u[_]=o.call(this,d[_],_,d);return u}function il(d,o,l){const u={};for(const _ in d)o.call(this,d[_],_,d)&&(u[_]=d[_]);return u}function Ws(d){return Array.isArray(d)?d.map(Ws):"object"==typeof d&&d?jc(d,Ws):d}const lp={};function Yn(d){lp[d]||(typeof console<"u"&&console.warn(d),lp[d]=!0)}function dc(d,o,l){return(l.y-d.y)*(o.x-d.x)>(o.y-d.y)*(l.x-d.x)}function Uh(d){let o=0;for(let l,u,_=0,p=d.length,y=p-1;_<p;y=_++)l=d[_],u=d[y],o+=(u.x-l.x)*(l.y+u.y);return o}function Zs([d,o,l]){const u=vi(o+90),_=vi(l);return{x:d*Math.cos(u)*Math.sin(_),y:d*Math.sin(u)*Math.sin(_),z:d*Math.cos(_),azimuthal:o,polar:l}}function kl(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Td(d){const o={};if(d.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,u,_,p)=>{const y=_||p;return o[u]=!y||y.toLowerCase(),""}),o["max-age"]){const l=parseInt(o["max-age"],10);isNaN(l)?delete o["max-age"]:o["max-age"]=l}return o}let cp=null;function Md(d,o){return[d[4*o],d[4*o+1],d[4*o+2],d[4*o+3]]}function dp(d,o,l,u){for(;o<l;){const _=o+l>>1;d[_]<u?o=_+1:l=_}return o}function tt(d,o,l,u){for(;o<l;){const _=o+l>>1;d[_]<=u?o=_+1:l=_}return o}function ie(d){return d>0?1/(1.001-d):1+d}function ae(d){return d>0?1-1/(1.001-d):-d}const ge={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ge.API_URL)return null;try{const d=new URL(ge.API_URL);return"api.mapbox.cn"===d.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===d.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Ce(d){return ge.API_URL_REGEX.test(d)}function Me(d){return ge.API_SPRITE_REGEX.test(d)}let ze,We,Ve,Ie,nt,Je;function xt(){return null==ze&&(ze=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),ze}const Tt={now:()=>void 0!==Ie?Ie:performance.now(),setNow(d){Ie=d},restoreNow(){Ie=void 0},frame(d){const o=requestAnimationFrame(d);return{cancel:()=>cancelAnimationFrame(o)}},getImageData(d,o=0){const{width:l,height:u}=d;nt||(nt=document.createElement("canvas"));const _=nt.getContext("2d",{willReadFrequently:!0});if(!_)throw new Error("failed to create canvas 2d context");return(l>nt.width||u>nt.height)&&(nt.width=l,nt.height=u),_.clearRect(-o,-o,l+2*o,u+2*o),_.drawImage(d,0,0,l,u),_.getImageData(-o,-o,l+2*o,u+2*o)},resolveURL:d=>(We||(We=document.createElement("a")),We.href=d,We.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(null==Ve&&(Ve=window.matchMedia("(prefers-reduced-motion: reduce)")),Ve.matches)},hasCanvasFingerprintNoise(){if(void 0!==Je)return Je;if(!xt())return Je=!1,!1;const d=new OffscreenCanvas(85,1),o=d.getContext("2d",{willReadFrequently:!0});let l=0;for(let _=0;_<d.width;++_)o.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,o.fillRect(_,0,1,1);const u=o.getImageData(0,0,d.width,d.height);l=0;for(let _=0;_<u.data.length;++_)if(_%4!=3&&l++!==u.data[_])return Je=!0,!0;return Je=!1,!1}};function Mt(d,o){const l=d.indexOf("?");if(l<0)return`${d}?${new URLSearchParams(o).toString()}`;const u=new URLSearchParams(d.slice(l));for(const _ in o)u.set(_,o[_]);return`${d.slice(0,l)}?${u.toString()}`}function yn(d,o={persistentParams:[]}){const l=d.indexOf("?");if(l<0)return d;const u=new URLSearchParams,_=new URLSearchParams(d.slice(l));for(const y of o.persistentParams){const T=_.get(y);T&&u.set(y,T)}const p=u.toString();return`${d.slice(0,l)}${p.length>0?`?${p}`:""}`}const $t="mapbox-tiles";let Dn=500,wn=50;const ot=["language","worldview","jobid"];let mi,Kn;function Gi(){try{return caches}catch{}}function er(){const d=Gi();d&&null==mi&&(mi=d.open($t))}let Mo=1/0;const xs={supported:!1,testSupport:function(d){!rl&&so&&(Ys?jh(d):Br=d)}};let Br,so,rl=!1,Ys=!1;const Xm=typeof self<"u"?self:{};function jh(d){const o=d.createTexture();d.bindTexture(d.TEXTURE_2D,o);try{if(d.texImage2D(d.TEXTURE_2D,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,so),d.isContextLost())return;xs.supported=!0}catch{}d.deleteTexture(o),rl=!0}Xm.document&&(so=Xm.document.createElement("img"),so.onload=function(){Br&&jh(Br),Br=null,Ys=!0},so.onerror=function(){rl=!0,Br=null},so.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ol={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};"function"==typeof Object.freeze&&Object.freeze(ol);class B_ extends Error{constructor(o,l,u){401===l&&Ce(u)&&(o+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(o),this.status=l,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Rr=kl()?()=>self.worker&&self.worker.referrer:()=>("blob:"===location.protocol?parent:self).location.href,Sd=function(d,o){if(!(/^file:/.test(l=d.url)||/^file:/.test(Rr())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,_){const p=new AbortController,y=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Rr(),referrerPolicy:u.referrerPolicy,signal:p.signal});let T=!1,E=!1;const R=(w=y.url).indexOf("sku=")>0&&Ce(w);var w;"json"===u.type&&y.headers.set("Accept","application/json");const D=(S,I,O)=>{if(E)return;if(S&&"SecurityError"!==S.message&&Yn(S.toString()),I&&O)return k(I);const B=Date.now();fetch(y).then(U=>{if(U.ok){const q=R?U.clone():null;return k(U,q,B)}return _(new B_(U.statusText,U.status,u.url))}).catch(U=>{"AbortError"!==U.name&&_(new Error(`${U.message} ${u.url}`))})},k=(S,I,O)=>{("arrayBuffer"===u.type?S.arrayBuffer():"json"===u.type?S.json():S.text()).then(B=>{E||(I&&O&&function(U,q,Z){if(er(),null==mi)return;const $=Td(q.headers.get("Cache-Control")||"");if($["no-store"])return;const Y={status:q.status,statusText:q.statusText,headers:new Headers};q.headers.forEach((ue,de)=>Y.headers.set(de,ue)),$["max-age"]&&Y.headers.set("Expires",new Date(Z+1e3*$["max-age"]).toUTCString());const K=Y.headers.get("Expires");if(!K||new Date(K).getTime()-Z<42e4)return;let ee=yn(U.url,{persistentParams:ot});if(206===q.status){const ue=U.headers.get("Range");if(!ue)return;Y.status=200,ee=Mt(ee,{range:ue})}!function(ue,de){if(void 0===Kn)try{new Response(new ReadableStream),Kn=!0}catch{Kn=!1}Kn?de(ue.body):ue.blob().then(de)}(q,ue=>{const de=new Response(200!==(ce=q.status)&&404!==ce&&[101,103,204,205,304].includes(ce)?null:ue,Y);var ce;er(),mi?.then(we=>we.put(ee,de)).catch(we=>Yn(we.message))})}(y,I,O),T=!0,_(null,B,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(B=>{E||_(new Error(B.message))})};return R?function(S,I){if(er(),null==mi)return I(null);mi.then(O=>{let B=yn(S.url,{persistentParams:ot});const U=S.headers.get("Range");U&&(B=Mt(B,{range:U})),O.match(B).then(q=>{const Z=function($){if(!$)return!1;const Y=new Date($.headers.get("Expires")||0),K=Td($.headers.get("Cache-Control")||"");return Y>Date.now()&&!K["no-cache"]}(q);O.delete(B),Z&&O.put(B,q.clone()),I(null,q,Z)}).catch(I)}).catch(I)}(y,D):D(null,null),{cancel:()=>{E=!0,T||p.abort()}}}(d,o);if(kl()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",d,o,void 0,!0)}var l;return function(u,_){const p=new XMLHttpRequest;p.open(u.method||"GET",u.url,!0),"arrayBuffer"===u.type&&(p.responseType="arraybuffer");for(const y in u.headers)p.setRequestHeader(y,u.headers[y]);return"json"===u.type&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials="include"===u.credentials,p.onerror=()=>{_(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||0===p.status)&&null!==p.response){let y=p.response;if("json"===u.type)try{y=JSON.parse(p.response)}catch(T){return _(T)}_(null,y,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else _(new B_(p.statusText,p.status,u.url))},p.send(u.body),{cancel:()=>p.abort()}}(d,o)},Hh=function(d,o){return Sd($o(d,{type:"arrayBuffer"}),o)};function xr(d){const o=document.createElement("a");return o.href=d,o.protocol===location.protocol&&o.host===location.host}const hb="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let So,Tu;So=[],Tu=0;const V_=function(d,o){if(xs.supported&&(d.headers||(d.headers={}),d.headers.accept="image/webp,*/*"),Tu>=ge.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:d,callback:o,cancelled:!1,cancel(){this.cancelled=!0}};return So.push(p),p}Tu++;let l=!1;const u=()=>{if(!l)for(l=!0,Tu--;So.length&&Tu<ge.MAX_PARALLEL_IMAGE_REQUESTS;){const p=So.shift(),{requestParameters:y,callback:T,cancelled:E}=p;E||(p.cancel=V_(y,T).cancel)}},_=Hh(d,(p,y,T,E)=>{u(),p?o(p):y&&(self.createImageBitmap?function(R,w){const D=new Blob([new Uint8Array(R)],{type:"image/png"});createImageBitmap(D).then(k=>{w(null,k)}).catch(k=>{w(new Error(`Could not load image because of ${k.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(R,w)=>o(R,w,T,E)):function(R,w){const D=new Image;D.onload=()=>{w(null,D),URL.revokeObjectURL(D.src),D.onload=null,requestAnimationFrame(()=>{D.src=hb})},D.onerror=()=>w(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const k=new Blob([new Uint8Array(R)],{type:"image/png"});D.src=R.byteLength?URL.createObjectURL(k):hb}(y,(R,w)=>o(R,w,T,E)))});return{cancel:()=>{_.cancel(),u()}}};var U_,zi,qn,Xs={exports:{}},po={exports:{}},Ed={exports:{}},Km=function(){if(qn)return Xs.exports;qn=1;var d=(U_||(U_=1,po.exports=function(l,u){var _,p,y,T,E,R,w,D;for(p=l.length-(_=3&l.length),y=u,E=3432918353,R=461845907,D=0;D<p;)w=255&l.charCodeAt(D)|(255&l.charCodeAt(++D))<<8|(255&l.charCodeAt(++D))<<16|(255&l.charCodeAt(++D))<<24,++D,y=27492+(65535&(T=5*(65535&(y=(y^=w=(65535&(w=(w=(65535&w)*E+(((w>>>16)*E&65535)<<16)&4294967295)<<15|w>>>17))*R+(((w>>>16)*R&65535)<<16)&4294967295)<<13|y>>>19))+((5*(y>>>16)&65535)<<16)&4294967295))+((58964+(T>>>16)&65535)<<16);switch(w=0,_){case 3:w^=(255&l.charCodeAt(D+2))<<16;case 2:w^=(255&l.charCodeAt(D+1))<<8;case 1:y^=w=(65535&(w=(w=(65535&(w^=255&l.charCodeAt(D)))*E+(((w>>>16)*E&65535)<<16)&4294967295)<<15|w>>>17))*R+(((w>>>16)*R&65535)<<16)&4294967295}return y^=l.length,y=2246822507*(65535&(y^=y>>>16))+((2246822507*(y>>>16)&65535)<<16)&4294967295,y=3266489909*(65535&(y^=y>>>13))+((3266489909*(y>>>16)&65535)<<16)&4294967295,(y^=y>>>16)>>>0}),po.exports),o=(zi||(zi=1,Ed.exports=function(l,u){for(var _,p=l.length,y=u^p,T=0;p>=4;)_=1540483477*(65535&(_=255&l.charCodeAt(T)|(255&l.charCodeAt(++T))<<8|(255&l.charCodeAt(++T))<<16|(255&l.charCodeAt(++T))<<24))+((1540483477*(_>>>16)&65535)<<16),y=1540483477*(65535&y)+((1540483477*(y>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),p-=4,++T;switch(p){case 3:y^=(255&l.charCodeAt(T+2))<<16;case 2:y^=(255&l.charCodeAt(T+1))<<8;case 1:y=1540483477*(65535&(y^=255&l.charCodeAt(T)))+((1540483477*(y>>>16)&65535)<<16)}return y=1540483477*(65535&(y^=y>>>13))+((1540483477*(y>>>16)&65535)<<16),(y^=y>>>15)>>>0}),Ed.exports);return Xs.exports=d,Xs.exports.murmur3=d,Xs.exports.murmur2=o,Xs.exports}(),Qm=To(Km);class Ks{constructor(o,...l){$o(this,l[0]||{}),this.type=o}}class Mu extends Ks{constructor(o,l={}){super("error",$o({error:o},l))}}function j_(d,o,l){l[d]&&-1!==l[d].indexOf(o)||(l[d]=l[d]||[],l[d].push(o))}function fb(d,o,l){if(l&&l[d]){const u=l[d].indexOf(o);-1!==u&&l[d].splice(u,1)}}class up{on(o,l){return this._listeners=this._listeners||{},j_(o,l,this._listeners),this}off(o,l){return fb(o,l,this._listeners),fb(o,l,this._oneTimeListeners),this}once(o,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},j_(o,l,this._oneTimeListeners),this):new Promise(u=>this.once(o,u))}fire(o,l){const u="string"==typeof o?new Ks(o,l):o,_=u.type;if(this.listens(_)){u.target=this;const p=this._listeners&&this._listeners[_]?this._listeners[_].slice():[];for(const E of p)E.call(this,u);const y=this._oneTimeListeners&&this._oneTimeListeners[_]?this._oneTimeListeners[_].slice():[];for(const E of y)fb(_,E,this._oneTimeListeners),E.call(this,u);const T=this._eventedParent;T&&($o(u,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),T.fire(u))}else u instanceof Mu&&console.error(u.error);return this}listens(o){return!!(this._listeners&&this._listeners[o]&&this._listeners[o].length>0||this._oneTimeListeners&&this._oneTimeListeners[o]&&this._oneTimeListeners[o].length>0||this._eventedParent&&this._eventedParent.listens(o))}setEventedParent(o,l){return this._eventedParent=o,this._eventedParentData=l,this}}var sl,H_={},Jm=function(){if(sl)return H_;sl=1;var d={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function o(p){return(p=Math.round(p))<0?0:p>255?255:p}function l(p){return o("%"===p[p.length-1]?parseFloat(p)/100*255:parseInt(p))}function u(p){return(y="%"===p[p.length-1]?parseFloat(p)/100:parseFloat(p))<0?0:y>1?1:y;var y}function _(p,y,T){return T<0?T+=1:T>1&&(T-=1),6*T<1?p+(y-p)*T*6:2*T<1?y:3*T<2?p+(y-p)*(2/3-T)*6:p}try{H_.parseCSSColor=function(p){var y,T=p.replace(/ /g,"").toLowerCase();if(T in d)return d[T].slice();if("#"===T[0])return 4===T.length?(y=parseInt(T.substr(1),16))>=0&&y<=4095?[(3840&y)>>4|(3840&y)>>8,240&y|(240&y)>>4,15&y|(15&y)<<4,1]:null:7===T.length&&(y=parseInt(T.substr(1),16))>=0&&y<=16777215?[(16711680&y)>>16,(65280&y)>>8,255&y,1]:null;var E=T.indexOf("("),R=T.indexOf(")");if(-1!==E&&R+1===T.length){var w=T.substr(0,E),D=T.substr(E+1,R-(E+1)).split(","),k=1;switch(w){case"rgba":if(4!==D.length)return null;k=u(D.pop());case"rgb":return 3!==D.length?null:[l(D[0]),l(D[1]),l(D[2]),k];case"hsla":if(4!==D.length)return null;k=u(D.pop());case"hsl":if(3!==D.length)return null;var S=(parseFloat(D[0])%360+360)%360/360,I=u(D[1]),O=u(D[2]),B=O<=.5?O*(I+1):O+I-O*I,U=2*O-B;return[o(255*_(U,B,S+1/3)),o(255*_(U,B,S)),o(255*_(U,B,S-1/3)),k];default:return null}}return null}}catch{}return H_}();class ki{constructor(o,l,u,_=1){this.r=o,this.g=l,this.b=u,this.a=_}static parse(o){if(!o)return;if(o instanceof ki)return o;if("string"!=typeof o)return;const l=Jm.parseCSSColor(o);return l?new ki(l[0]/255*l[3],l[1]/255*l[3],l[2]/255*l[3],l[3]):void 0}toStringPremultipliedAlpha(){const[o,l,u,_]=0===this.a?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(o)},${Math.round(l)},${Math.round(u)},${_})`}toString(){const[o,l,u,_]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*o)},${Math.round(255*l)},${Math.round(255*u)},${_})`}toRenderColor(o){const{r:l,g:u,b:_,a:p}=this;return new _a(o,l,u,_,p)}clone(){return new ki(this.r,this.g,this.b,this.a)}}class _a{constructor(o,l,u,_,p){if(o){const y=o.image.height,T=y*y;l=0===p?0:l/p*(y-1),u=0===p?0:u/p*(y-1),_=0===p?0:_/p*(y-1);const E=Math.floor(l),R=Math.floor(u),w=Math.floor(_),D=Math.ceil(l),k=Math.ceil(u),S=Math.ceil(_),I=l-E,O=u-R,B=_-w,U=o.image.data,q=4*(E+R*T+w*y),Z=4*(E+R*T+S*y),$=4*(E+k*T+w*y),Y=4*(E+k*T+S*y),K=4*(D+R*T+w*y),ee=4*(D+R*T+S*y),ue=4*(D+k*T+w*y),de=4*(D+k*T+S*y);if(q<0||de>=U.length)throw new Error("out of range");this.r=Lt(Lt(Lt(U[q],U[Z],B),Lt(U[$],U[Y],B),O),Lt(Lt(U[K],U[ee],B),Lt(U[ue],U[de],B),O),I)/255*p,this.g=Lt(Lt(Lt(U[q+1],U[Z+1],B),Lt(U[$+1],U[Y+1],B),O),Lt(Lt(U[K+1],U[ee+1],B),Lt(U[ue+1],U[de+1],B),O),I)/255*p,this.b=Lt(Lt(Lt(U[q+2],U[Z+2],B),Lt(U[$+2],U[Y+2],B),O),Lt(Lt(U[K+2],U[ee+2],B),Lt(U[ue+2],U[de+2],B),O),I)/255*p,this.a=p}else this.r=l,this.g=u,this.b=_,this.a=p}toArray(){const{r:o,g:l,b:u,a:_}=this;return 0===_?[0,0,0,0]:[255*o/_,255*l/_,255*u/_,_]}toHslaArray(){if(0===this.a)return[0,0,0,0];const{r:o,g:l,b:u,a:_}=this,p=Math.min(Math.max(o/_,0),1),y=Math.min(Math.max(l/_,0),1),T=Math.min(Math.max(u/_,0),1),E=Math.min(p,y,T),R=Math.max(p,y,T),w=(E+R)/2;if(E===R)return[0,0,100*w,_];const D=R-E,k=w>.5?D/(2-R-E):D/(R+E);let S=0;return R===p?S=(y-T)/D+(y<T?6:0):R===y?S=(T-p)/D+2:R===T&&(S=(p-y)/D+4),S*=60,[Math.min(Math.max(S,0),360),Math.min(Math.max(100*k,0),100),Math.min(Math.max(100*w,0),100),_]}toArray01(){const{r:o,g:l,b:u,a:_}=this;return 0===_?[0,0,0,0]:[o/_,l/_,u/_,_]}toArray01Scaled(o){const{r:l,g:u,b:_,a:p}=this;return 0===p?[0,0,0]:[l/p*o,u/p*o,_/p*o]}toArray01PremultipliedAlpha(){const{r:o,g:l,b:u,a:_}=this;return[o,l,u,_]}toArray01Linear(){const{r:o,g:l,b:u,a:_}=this;return 0===_?[0,0,0,0]:[Math.pow(o/_,2.2),Math.pow(l/_,2.2),Math.pow(u/_,2.2),_]}}function Lt(d,o,l){return d*(1-l)+o*l}function pb(d,o,l){return d.map((u,_)=>Lt(u,o[_],l))}ki.black=new ki(0,0,0,1),ki.white=new ki(1,1,1,1),ki.transparent=new ki(0,0,0,0),ki.red=new ki(1,0,0,1),ki.blue=new ki(0,0,1,1);var Ei=Object.freeze({__proto__:null,array:pb,color:function(d,o,l){return new ki(Lt(d.r,o.r,l),Lt(d.g,o.g,l),Lt(d.b,o.b,l),Lt(d.a,o.a,l))},number:Lt});function $_(d,...o){for(const l of o)for(const u in l)d[u]=l[u];return d}class Al extends Error{constructor(o,l){super(l),this.message=l,this.key=o}}class mb{constructor(o,l=[]){this.parent=o,this.bindings={};for(const[u,_]of l)this.bindings[u]=_}concat(o){return new mb(this,o)}get(o){if(this.bindings[o])return this.bindings[o];if(this.parent)return this.parent.get(o);throw new Error(`${o} not found in scope.`)}has(o){return!!this.bindings[o]||!!this.parent&&this.parent.has(o)}}const Nt={kind:"null"},Yt={kind:"number"},Qt={kind:"string"},gi={kind:"boolean"},ya={kind:"color"},Dd={kind:"object"},_i={kind:"value"},Su={kind:"collator"},al={kind:"formatted"},Hc={kind:"resolvedImage"};function as(d,o){return{kind:"array",itemType:d,N:o}}function ur(d){if("array"===d.kind){const o=ur(d.itemType);return"number"==typeof d.N?`array<${o}, ${d.N}>`:"value"===d.itemType.kind?"array":`array<${o}>`}return d.kind}const ct=[Nt,Yt,Qt,gi,ya,al,Dd,as(_i),Hc];function Eu(d,o){if("error"===o.kind)return null;if("array"===d.kind){if("array"===o.kind&&(0===o.N&&"value"===o.itemType.kind||!Eu(d.itemType,o.itemType))&&("number"!=typeof d.N||d.N===o.N))return null}else{if(d.kind===o.kind)return null;if("value"===d.kind)for(const l of ct)if(!Eu(l,o))return null}return`Expected ${ur(d)} but found ${ur(o)} instead.`}function $h(d,o){return o.some(l=>l.kind===d.kind)}function Du(d,o){return o.some(l=>"null"===l?null===d:"array"===l?Array.isArray(d):"object"===l?d&&!Array.isArray(d)&&"object"==typeof d:l===typeof d)}class Gh{constructor(o,l,u){this.sensitivity=o?l?"variant":"case":l?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(o,l){return this.collator.compare(o,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class hp{constructor(o,l,u,_,p){this.text=o.normalize?o.normalize():o,this.image=l,this.scale=u,this.fontStack=_,this.textColor=p}}class Xo{constructor(o){this.sections=o}static fromString(o){return new Xo([new hp(o,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(o=>0!==o.text.length||o.image&&o.image.namePrimary)}static factory(o){return o instanceof Xo?o:Xo.fromString(o)}toString(){return 0===this.sections.length?"":this.sections.map(o=>o.text).join("")}serialize(){const o=["format"];for(const l of this.sections){if(l.image){o.push(["image",l.image.namePrimary]);continue}o.push(l.text);const u={};l.fontStack&&(u["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(u["font-scale"]=l.scale),l.textColor&&(u["text-color"]=["rgba"].concat(l.textColor.toRenderColor(null).toArray())),o.push(u)}return o}}class $c{constructor(o,l){if(this.id=o,this.options=l||{params:{}},this.options.transform){const{a:u,b:_,c:p,d:y,e:T,f:E}=this.options.transform;this.options.transform=new DOMMatrix([u,_,p,y,T,E])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeId(o){return JSON.parse(o).id}static deserializeFromString(o){const l=JSON.parse(o),{a:u,b:_,c:p,d:y,e:T,f:E}=l.options.transform;return new DOMMatrix([u,_,p,y,T,E]),new $c(l.id,l.options)}scaleSelf(o){return this.options.transform=this.options.transform.scale(o),this}serialize(){const o={id:this.id};this.options&&(o.options=this.options);const{a:l,b:u,c:_,d:p,e:y,f:T}=this.options.transform;return o.options.transform={a:l,b:u,c:_,d:p,e:y,f:T},JSON.stringify(o)}}class Ko{constructor(o){this.namePrimary=o.namePrimary,o.nameSecondary&&(this.nameSecondary=o.nameSecondary),o.optionsPrimary&&(this.optionsPrimary=o.optionsPrimary),o.optionsSecondary&&(this.optionsSecondary=o.optionsSecondary),this.available=o.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new $c(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new $c(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(o){return"string"==typeof o?Ko.build(o):o}static build(o,l,u,_){return o?new Ko({namePrimary:o,nameSecondary:l,optionsPrimary:u,optionsSecondary:_,available:!1}):null}}function qh(d,o,l,u){return"number"==typeof d&&d>=0&&d<=255&&"number"==typeof o&&o>=0&&o<=255&&"number"==typeof l&&l>=0&&l<=255?void 0===u||"number"==typeof u&&u>=0&&u<=1?null:`Invalid rgba value [${[d,o,l,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof u?[d,o,l,u]:[d,o,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wh(d){if(null===d||"string"==typeof d||"boolean"==typeof d||"number"==typeof d||d instanceof ki||d instanceof Gh||d instanceof Xo||d instanceof Ko)return!0;if(Array.isArray(d)){for(const o of d)if(!Wh(o))return!1;return!0}if("object"==typeof d){for(const o in d)if(!Wh(d[o]))return!1;return!0}return!1}function gr(d){if(null===d)return Nt;if("string"==typeof d)return Qt;if("boolean"==typeof d)return gi;if("number"==typeof d)return Yt;if(d instanceof ki)return ya;if(d instanceof Gh)return Su;if(d instanceof Xo)return al;if(d instanceof Ko)return Hc;if(Array.isArray(d)){const o=d.length;let l;for(const u of d){const _=gr(u);if(l){if(l===_)continue;l=_i;break}l=_}return as(l||_i,o)}return Dd}function Qs(d){const o=typeof d;return null===d?"":"string"===o||"number"===o||"boolean"===o?String(d):d instanceof ki?d.toStringPremultipliedAlpha():d instanceof Xo||d instanceof Ko?d.toString():JSON.stringify(d)}class va{constructor(o,l){this.type=o,this.value=l}static parse(o,l){if(2!==o.length)return l.error(`'literal' expression requires exactly one argument, but found ${o.length-1} instead.`);if(!Wh(o[1]))return l.error("invalid value");const u=o[1];let _=gr(u);const p=l.expectedType;return"array"!==_.kind||0!==_.N||!p||"array"!==p.kind||"number"==typeof p.N&&0!==p.N||(_=p),new va(_,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ki?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof Xo?this.value.serialize():this.value}}class Xr{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}}const Zh={string:Qt,number:Yt,boolean:gi,object:Dd};class Go{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");let u,_=1;const p=o[0];if("array"===p){let T,E;if(o.length>2){const R=o[1];if("string"!=typeof R||!(R in Zh)||"object"===R)return l.error('The item type argument of "array" must be one of string, number, boolean',1);T=Zh[R],_++}else T=_i;if(o.length>3){if(null!==o[2]&&("number"!=typeof o[2]||o[2]<0||o[2]!==Math.floor(o[2])))return l.error('The length argument to "array" must be a positive integer literal',2);E=o[2],_++}u=as(T,E)}else u=Zh[p];const y=[];for(;_<o.length;_++){const T=l.parse(o[_],_,_i);if(!T)return null;y.push(T)}return new Go(u,y)}evaluate(o){for(let l=0;l<this.args.length;l++){const u=this.args[l].evaluate(o);if(!Eu(this.type,gr(u)))return u;if(l===this.args.length-1)throw new Xr(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${ur(gr(u))} but was expected to be of type ${ur(this.type)}.`)}return null}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=this.type,l=[o.kind];if("array"===o.kind){const u=o.itemType;if("string"===u.kind||"number"===u.kind||"boolean"===u.kind){l.push(u.kind);const _=o.N;("number"==typeof _||this.args.length>1)&&l.push(_)}}return l.concat(this.args.map(u=>u.serialize()))}}class Na{constructor(o){this.type=al,this.sections=o}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const u=o[1];if(!Array.isArray(u)&&"object"==typeof u)return l.error("First argument must be an image or text section.");const _=[];let p=!1;for(let y=1;y<=o.length-1;++y){const T=o[y];if(p&&"object"==typeof T&&!Array.isArray(T)){p=!1;let E=null;if(T["font-scale"]&&(E=l.parseObjectValue(T["font-scale"],y,"font-scale",Yt),!E))return null;let R=null;if(T["text-font"]&&(R=l.parseObjectValue(T["text-font"],y,"text-font",as(Qt)),!R))return null;let w=null;if(T["text-color"]&&(w=l.parseObjectValue(T["text-color"],y,"text-color",ya),!w))return null;const D=_[_.length-1];D.scale=E,D.font=R,D.textColor=w}else{const E=l.parse(o[y],y,_i);if(!E)return null;const R=E.type.kind;if("string"!==R&&"value"!==R&&"null"!==R&&"resolvedImage"!==R)return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,_.push({content:E,scale:null,font:null,textColor:null})}}return new Na(_)}evaluate(o){return new Xo(this.sections.map(l=>{const u=l.content.evaluate(o);return gr(u)===Hc?new hp("",u,null,null,null):new hp(Qs(u),null,l.scale?l.scale.evaluate(o):null,l.font?l.font.evaluate(o).join(","):null,l.textColor?l.textColor.evaluate(o):null)}))}eachChild(o){for(const l of this.sections)o(l.content),l.scale&&o(l.scale),l.font&&o(l.font),l.textColor&&o(l.textColor)}outputDefined(){return!1}serialize(){const o=["format"];for(const l of this.sections){o.push(l.content.serialize());const u={};l.scale&&(u["font-scale"]=l.scale.serialize()),l.font&&(u["text-font"]=l.font.serialize()),l.textColor&&(u["text-color"]=l.textColor.serialize()),o.push(u)}return o}}class Iu{constructor(o,l,u,_){this._imageWarnHistory={},this.type=Hc,this.inputPrimary=o,this.inputSecondary=l,this.inputPrimaryParams=u,this.inputSecondaryParams=_}static parse(o,l){if(o.length<2)return l.error("Expected two or more arguments.");let u=1;const _=[];function p(){if(u<o.length){const T=l.parse(o[u],u++,Qt);return T?(_.push({image:T,options:void 0}),!0):(l.error(_.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function y(){if(u<o.length){if(null===(T=o[u])||"object"!=typeof T||Array.isArray(T))return!0;const E=o[u].params,R=l.concat(u);if(!E)return u++,!0;if("object"!=typeof E||E.constructor!==Object)return R.error('Image options "params" should be an object'),!1;const w={},D=R.concat(void 0,"params");for(const k in E){if(!k)return D.error("Image parameter name should be non-empty"),!1;const S=D.concat(void 0,k).parse(E[k],void 0,ya,void 0,{typeAnnotation:"coerce"});if(!S)return!1;w[k]=S}return _[_.length-1].options=w,u++,!0}var T;return!0}for(let T=0;T<2;T++)if(!p()||!y())return;return new Iu(_[0].image,_[1]?_[1].image:void 0,_[0].options,_[1]?_[1].options:void 0)}evaluateParams(o,l){const u={};if(l){for(const _ in l)if(l[_])try{const p=l[_].evaluate(o),y=`Ignoring image parameter "${_}" with semi-transparent color ${p.toString()}`;if(1!==p.a){this._imageWarnHistory[y]||(console.warn(y),this._imageWarnHistory[y]=!0);continue}u[_]=p}catch{continue}if(0!==Object.keys(u).length)return{params:u}}}evaluate(o){const l=Ko.build(this.inputPrimary.evaluate(o),this.inputSecondary?this.inputSecondary.evaluate(o):void 0,this.inputPrimaryParams?this.evaluateParams(o,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(o,this.inputSecondaryParams):void 0);return l&&o.availableImages&&(l.available=o.availableImages.indexOf(l.namePrimary)>-1,l.nameSecondary&&l.available&&o.availableImages&&(l.available=o.availableImages.indexOf(l.nameSecondary)>-1)),l}eachChild(o){if(o(this.inputPrimary),this.inputPrimaryParams)for(const l in this.inputPrimaryParams)this.inputPrimaryParams[l]&&o(this.inputPrimaryParams[l]);if(this.inputSecondary&&(o(this.inputSecondary),this.inputSecondaryParams))for(const l in this.inputSecondaryParams)this.inputSecondaryParams[l]&&o(this.inputSecondaryParams[l])}outputDefined(){return!1}serializeParams(o){const l={};if(o){for(const u in o)o[u]&&(l[u]=o[u].serialize());return{params:l}}}serialize(){const o=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&o.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(o.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&o.push(this.serializeParams(this.inputSecondaryParams))),o}}function hi(d){return d instanceof Number?"number":d instanceof String?"string":d instanceof Boolean?"boolean":Array.isArray(d)?"array":null===d?"null":typeof d}const wr={"to-boolean":gi,"to-color":ya,"to-number":Yt,"to-string":Qt};class Id{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expected at least one argument.");const u=o[0],_=[];let p=Nt;if("to-array"===u){if(!Array.isArray(o[1]))return null;const y=o[1].length;if(l.expectedType){if("array"!==l.expectedType.kind)return l.error(`Expected ${l.expectedType.kind} but found array.`);p=as(l.expectedType.itemType,y)}else{if(!(y>0&&Wh(o[1][0])))return null;p=as(gr(o[1][0]),y)}for(let T=0;T<y;T++){const E=o[1][T];let R;if("array"===hi(E))R=l.parse(E,void 0,p.itemType);else{const w=hi(E);if(w!==p.itemType.kind)return l.error(`Expected ${p.itemType.kind} but found ${w}.`);R=l.registry.literal.parse(["literal",void 0===E?null:E],l)}if(!R)return null;_.push(R)}}else{if(("to-boolean"===u||"to-string"===u)&&2!==o.length)return l.error("Expected one argument.");p=wr[u];for(let y=1;y<o.length;y++){const T=l.parse(o[y],y,_i);if(!T)return null;_.push(T)}}return new Id(p,_)}evaluate(o){if("boolean"===this.type.kind)return!!this.args[0].evaluate(o);if("color"===this.type.kind){let l,u;for(const _ of this.args){if(l=_.evaluate(o),u=null,l instanceof ki)return l;if("string"==typeof l){const p=o.parseColor(l);if(p)return p}else if(Array.isArray(l)&&(u=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:qh(l[0],l[1],l[2],l[3]),!u))return new ki(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Xr(u||`Could not parse color from value '${"string"==typeof l?l:String(JSON.stringify(l))}'`)}if("number"===this.type.kind){let l=null;for(const u of this.args){if(l=u.evaluate(o),null===l)return 0;const _=Number(l);if(!isNaN(_))return _}throw new Xr(`Could not convert ${JSON.stringify(l)} to number.`)}return"formatted"===this.type.kind?Xo.fromString(Qs(this.args[0].evaluate(o))):"resolvedImage"===this.type.kind?Ko.build(Qs(this.args[0].evaluate(o))):"array"===this.type.kind?this.args.map(l=>l.evaluate(o)):Qs(this.args[0].evaluate(o))}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Na([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Iu(this.args[0]).serialize();const o="array"===this.type.kind?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{o.push(l.serialize())}),o}}const gb=["Unknown","Point","LineString","Polygon"];class eg{constructor(o,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=o,this.options=l}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?gb[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(o){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:u,y:_}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*l-o[0])+this.featureDistanceData.bearing[1]*(_*l-o[1])}return 0}parseColor(o){let l=this._parseColorCache[o];return l||(l=this._parseColorCache[o]=ki.parse(o)),l}getConfig(o){return this.options?this.options.get(o):null}}class za{constructor(o,l,u,_,p){this.name=o,this.type=l,this._evaluate=u,this.args=_,this._overloadIndex=p}evaluate(o){if(!this._evaluate){const l=za.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(o,this.args)}eachChild(o){this.args.forEach(o)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(o=>o.serialize()))}static parse(o,l){const u=o[0],_=za.definitions[u];if(!_)return l.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(_)?_[0]:_.type,y=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,T=[];let E=null,R=-1;for(const[w,D]of y){if(Array.isArray(w)&&w.length!==o.length-1)continue;T.push(w),R++,E=new Zc(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);const k=[];let S=!1;for(let I=1;I<o.length;I++){const O=o[I],B=Array.isArray(w)?w[I-1]:w.type,U=E.parse(O,1+k.length,B);if(!U){S=!0;break}k.push(U)}if(!S)if(Array.isArray(w)&&w.length!==k.length)E.error(`Expected ${w.length} arguments, but found ${k.length} instead.`);else{for(let I=0;I<k.length;I++){const O=Array.isArray(w)?w[I]:w.type,B=k[I];E.concat(I+1).checkSubtype(O,B.type)}if(0===E.errors.length)return new za(u,p,D,k,R)}}if(1===T.length)l.errors.push(...E.errors);else{const w=(T.length?T:y.map(([k])=>k)).map(tg).join(" | "),D=[];for(let k=1;k<o.length;k++){const S=l.parse(o[k],1+D.length);if(!S)return null;D.push(ur(S.type))}l.error(`Expected arguments of type ${w}, but found (${D.join(", ")}) instead.`)}return null}static register(o,l){za.definitions=l;for(const u in l)o[u]=za}}function tg(d){return Array.isArray(d)?`(${d.map(ur).join(", ")})`:`(${ur(d.type)}...)`}class Yh{constructor(o,l,u){this.type=Su,this.locale=u,this.caseSensitive=o,this.diacriticSensitive=l}static parse(o,l){if(2!==o.length)return l.error("Expected one argument.");const u=o[1];if("object"!=typeof u||Array.isArray(u))return l.error("Collator options argument must be an object.");const _=void 0===u["case-sensitive"]?l.parse(!1,1,gi):l.parseObjectValue(u["case-sensitive"],1,"case-sensitive",gi);if(!_)return null;const p=void 0===u["diacritic-sensitive"]?l.parse(!1,1,gi):l.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",gi);if(!p)return null;let y=null;return u.locale&&(y=l.parseObjectValue(u.locale,1,"locale",Qt),!y)?null:new Yh(_,p,y)}evaluate(o){return new Gh(this.caseSensitive.evaluate(o),this.diacriticSensitive.evaluate(o),this.locale?this.locale.evaluate(o):null)}eachChild(o){o(this.caseSensitive),o(this.diacriticSensitive),this.locale&&o(this.locale)}outputDefined(){return!1}serialize(){const o={};return o["case-sensitive"]=this.caseSensitive.serialize(),o["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(o.locale=this.locale.serialize()),["collator",o]}}function Xi(d,o,l=0,u=d.length-1,_=_b){for(;u>l;){if(u-l>600){const E=u-l+1,R=o-l+1,w=Math.log(E),D=.5*Math.exp(2*w/3),k=.5*Math.sqrt(w*D*(E-D)/E)*(R-E/2<0?-1:1);Xi(d,o,Math.max(l,Math.floor(o-R*D/E+k)),Math.min(u,Math.floor(o+(E-R)*D/E+k)),_)}const p=d[o];let y=l,T=u;for(ku(d,l,o),_(d[u],p)>0&&ku(d,l,u);y<T;){for(ku(d,y,T),y++,T--;_(d[y],p)<0;)y++;for(;_(d[T],p)>0;)T--}0===_(d[l],p)?ku(d,l,T):(T++,ku(d,T,u)),T<=o&&(l=T+1),o<=T&&(u=T-1)}}function ku(d,o,l){const u=d[o];d[o]=d[l],d[l]=u}function _b(d,o){return d<o?-1:d>o?1:0}function ba(d){let o=0;for(let l,u,_=0,p=d.length,y=p-1;_<p;y=_++)l=d[_],u=d[y],o+=(u.x-l.x)*(l.y+u.y);return o}function Xh(d,o){d[0]=Math.min(d[0],o[0]),d[1]=Math.min(d[1],o[1]),d[2]=Math.max(d[2],o[0]),d[3]=Math.max(d[3],o[1])}function ng(d,o){return!(d[0]<=o[0]||d[2]>=o[2]||d[1]<=o[1]||d[3]>=o[3])}function cw(d,o,l){const u=d[0]-o[0],_=d[1]-o[1],p=d[0]-l[0],y=d[1]-l[1];return u*y-p*_==0&&u*p<=0&&_*y<=0}function Js(d,o,l=!1){let u=!1;for(let T=0,E=o.length;T<E;T++){const R=o[T];for(let w=0,D=R.length,k=D-1;w<D;k=w++){const S=R[k],I=R[w];if(cw(d,S,I))return l;(p=S)[1]>(_=d)[1]!=(y=I)[1]>_[1]&&_[0]<(y[0]-p[0])*(_[1]-p[1])/(y[1]-p[1])+p[0]&&(u=!u)}}var _,p,y;return u}function ig(d,o,l,u){const _=u[0]-l[0],p=u[1]-l[1],y=(d[0]-l[0])*p-_*(d[1]-l[1]),T=(o[0]-l[0])*p-_*(o[1]-l[1]);return y>0&&T<0||y<0&&T>0}function Au(d,o,l,u){return(_=[u[0]-l[0],u[1]-l[1]])[0]*(p=[o[0]-d[0],o[1]-d[1]])[1]-_[1]*p[0]!=0&&!(!ig(d,o,l,u)||!ig(l,u,d,o));var _,p}const uc=8192;function dw(d,o){const l=(180+d[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d[1]*Math.PI/360)))/360,_=Math.pow(2,o.z);return[Math.round(l*_*uc),Math.round(u*_*uc)]}function uw(d,o){for(let l=0;l<o.length;l++)if(Js(d,o[l]))return!0;return!1}function yb(d,o,l){for(const u of l)for(let _=0,p=u.length,y=p-1;_<p;y=_++)if(Au(d,o,u[y],u[_]))return!0;return!1}function Ru(d,o){for(let l=0;l<d.length;++l)if(!Js(d[l],o))return!1;for(let l=0;l<d.length-1;++l)if(yb(d[l],d[l+1],o))return!1;return!0}function Kh(d,o){for(let l=0;l<o.length;l++)if(Ru(d,o[l]))return!0;return!1}function An(d,o,l){const u=[];for(let _=0;_<d.length;_++){const p=[];for(let y=0;y<d[_].length;y++){const T=dw(d[_][y],l);Xh(o,T),p.push(T)}u.push(p)}return u}function on(d,o,l){const u=[];for(let _=0;_<d.length;_++){const p=An(d[_],o,l);u.push(p)}return u}function un(d,o,l,u){if(d[0]<l[0]||d[0]>l[2]){const _=.5*u;let p=d[0]-l[0]>_?-u:l[0]-d[0]>_?u:0;0===p&&(p=d[0]-l[2]>_?-u:l[2]-d[0]>_?u:0),d[0]+=p}Xh(o,d)}function Tn(d,o,l,u){const _=Math.pow(2,u.z)*uc,p=[u.x*uc,u.y*uc],y=[];if(!d)return y;for(const T of d)for(const E of T){const R=[E.x+p[0],E.y+p[1]];un(R,o,l,_),y.push(R)}return y}function re(d,o,l,u){const _=Math.pow(2,u.z)*uc,p=[u.x*uc,u.y*uc],y=[];if(!d)return y;for(const E of d){const R=[];for(const w of E){const D=[w.x+p[0],w.y+p[1]];Xh(o,D),R.push(D)}y.push(R)}if(o[2]-o[0]<=_/2){(T=o)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const E of y)for(const R of E)un(R,o,l,_)}var T;return y}class ll{constructor(o,l){this.type=gi,this.geojson=o,this.geometries=l}static parse(o,l){if(2!==o.length)return l.error(`'within' expression requires exactly one argument, but found ${o.length-1} instead.`);if(Wh(o[1])){const u=o[1];if("FeatureCollection"===u.type)for(let _=0;_<u.features.length;++_){const p=u.features[_].geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new ll(u,u.features[_].geometry)}else if("Feature"===u.type){const _=u.geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new ll(u,u.geometry)}else if("Polygon"===u.type||"MultiPolygon"===u.type)return new ll(u,u)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(o){if(null!=o.geometry()&&null!=o.canonicalID()){if("Point"===o.geometryType())return function(l,u){const _=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=l.canonicalID();if(!y)return!1;if("Polygon"===u.type){const T=An(u.coordinates,p,y),E=Tn(l.geometry(),_,p,y);if(!ng(_,p))return!1;for(const R of E)if(!Js(R,T))return!1}if("MultiPolygon"===u.type){const T=on(u.coordinates,p,y),E=Tn(l.geometry(),_,p,y);if(!ng(_,p))return!1;for(const R of E)if(!uw(R,T))return!1}return!0}(o,this.geometries);if("LineString"===o.geometryType())return function(l,u){const _=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],y=l.canonicalID();if(!y)return!1;if("Polygon"===u.type){const T=An(u.coordinates,p,y),E=re(l.geometry(),_,p,y);if(!ng(_,p))return!1;for(const R of E)if(!Ru(R,T))return!1}if("MultiPolygon"===u.type){const T=on(u.coordinates,p,y),E=re(l.geometry(),_,p,y);if(!ng(_,p))return!1;for(const R of E)if(!Kh(R,T))return!1}return!0}(o,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const mn={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},Pu=1/298.257223563,rg=Pu*(2-Pu),Qh=Math.PI/180;class Jh{static fromTile(o,l,u){const _=Math.PI*(1-2*(o+.5)/Math.pow(2,l)),p=Math.atan(.5*(Math.exp(_)-Math.exp(-_)))/Qh;return new Jh(p,u)}static get units(){return mn}constructor(o,l){if(void 0===o)throw new Error("No latitude given.");if(l&&!mn[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(mn).join(", ")}`);const u=6378.137*Qh*(l?mn[l]:1),_=Math.cos(o*Qh),p=1/(1-rg*(1-_*_)),y=Math.sqrt(p);this.kx=u*y*_,this.ky=u*y*p*(1-rg)}distance(o,l){const u=xa(o[0]-l[0])*this.kx,_=(o[1]-l[1])*this.ky;return Math.sqrt(u*u+_*_)}bearing(o,l){const u=xa(l[0]-o[0])*this.kx;return Math.atan2(u,(l[1]-o[1])*this.ky)/Qh}destination(o,l,u){const _=u*Qh;return this.offset(o,Math.sin(_)*l,Math.cos(_)*l)}offset(o,l,u){return[o[0]+l/this.kx,o[1]+u/this.ky]}lineDistance(o){let l=0;for(let u=0;u<o.length-1;u++)l+=this.distance(o[u],o[u+1]);return l}area(o){let l=0;for(let u=0;u<o.length;u++){const _=o[u];for(let p=0,y=_.length,T=y-1;p<y;T=p++)l+=xa(_[p][0]-_[T][0])*(_[p][1]+_[T][1])*(u?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(o,l){let u=0;if(l<=0)return o[0];for(let _=0;_<o.length-1;_++){const p=o[_],y=o[_+1],T=this.distance(p,y);if(u+=T,u>l)return Kr(p,y,(l-(u-T))/T)}return o[o.length-1]}pointToSegmentDistance(o,l,u){let[_,p]=l,y=xa(u[0]-_)*this.kx,T=(u[1]-p)*this.ky;if(0!==y||0!==T){const E=(xa(o[0]-_)*this.kx*y+(o[1]-p)*this.ky*T)/(y*y+T*T);E>1?(_=u[0],p=u[1]):E>0&&(_+=y/this.kx*E,p+=T/this.ky*E)}return y=xa(o[0]-_)*this.kx,T=(o[1]-p)*this.ky,Math.sqrt(y*y+T*T)}pointOnLine(o,l){let u=1/0,_=o[0][0],p=o[0][1],y=0,T=0;for(let E=0;E<o.length-1;E++){let R=o[E][0],w=o[E][1],D=xa(o[E+1][0]-R)*this.kx,k=(o[E+1][1]-w)*this.ky,S=0;0===D&&0===k||(S=(xa(l[0]-R)*this.kx*D+(l[1]-w)*this.ky*k)/(D*D+k*k),S>1?(R=o[E+1][0],w=o[E+1][1]):S>0&&(R+=D/this.kx*S,w+=k/this.ky*S)),D=xa(l[0]-R)*this.kx,k=(l[1]-w)*this.ky;const I=D*D+k*k;I<u&&(u=I,_=R,p=w,y=E,T=S)}return{point:[_,p],index:y,t:Math.max(0,Math.min(1,T))}}lineSlice(o,l,u){let _=this.pointOnLine(u,o),p=this.pointOnLine(u,l);if(_.index>p.index||_.index===p.index&&_.t>p.t){const R=_;_=p,p=R}const y=[_.point],T=_.index+1,E=p.index;!fp(u[T],y[0])&&T<=E&&y.push(u[T]);for(let R=T+1;R<=E;R++)y.push(u[R]);return fp(u[E],p.point)||y.push(p.point),y}lineSliceAlong(o,l,u){let _=0;const p=[];for(let y=0;y<u.length-1;y++){const T=u[y],E=u[y+1],R=this.distance(T,E);if(_+=R,_>o&&0===p.length&&p.push(Kr(T,E,(o-(_-R))/R)),_>=l)return p.push(Kr(T,E,(l-(_-R))/R)),p;_>o&&p.push(E)}return p}bufferPoint(o,l){const u=l/this.ky,_=l/this.kx;return[o[0]-_,o[1]-u,o[0]+_,o[1]+u]}bufferBBox(o,l){const u=l/this.ky,_=l/this.kx;return[o[0]-_,o[1]-u,o[2]+_,o[3]+u]}insideBBox(o,l){return xa(o[0]-l[0])>=0&&xa(o[0]-l[2])<=0&&o[1]>=l[1]&&o[1]<=l[3]}}function fp(d,o){return d[0]===o[0]&&d[1]===o[1]}function Kr(d,o,l){const u=xa(o[0]-d[0]);return[d[0]+u*l,d[1]+(o[1]-d[1])*l]}function xa(d){for(;d<-180;)d+=360;for(;d>180;)d-=360;return d}class hc{constructor(o=[],l=(u,_)=>u<_?-1:u>_?1:0){if(this.data=o,this.length=this.data.length,this.compare=l,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(o){this.data.push(o),this._up(this.length++)}pop(){if(0===this.length)return;const o=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),o}peek(){return this.data[0]}_up(o){const{data:l,compare:u}=this,_=l[o];for(;o>0;){const p=o-1>>1,y=l[p];if(u(_,y)>=0)break;l[o]=y,o=p}l[o]=_}_down(o){const{data:l,compare:u}=this,_=this.length>>1,p=l[o];for(;o<_;){let y=1+(o<<1);const T=y+1;if(T<this.length&&u(l[T],l[y])<0&&(y=T),u(l[y],p)>=0)break;l[o]=l[y],o=y}l[o]=p}}var Ot=8192;function fc(d,o){return o.dist-d.dist}function Ou(d){const o=[1/0,1/0,-1/0,-1/0];if(o.length!==d.length)return!1;for(let l=0;l<o.length;l++)if(o[l]!==d[l])return!1;return!0}function pp(d){return d[1]-d[0]+1}function cl(d,o){const l=d[1]>=d[0]&&d[1]<o;return l||console.warn("Distance Expression: Index is out of range"),l}function qc(d,o){if(d[0]>d[1])return[null,null];const l=pp(d);if(o){if(2===l)return[d,null];const u=Math.floor(l/2);return[[d[0],d[0]+u],[d[0]+u,d[1]]]}{if(1===l)return[d,null];const u=Math.floor(l/2)-1;return[[d[0],d[0]+u],[d[0]+u+1,d[1]]]}}function pc(d,o){const l=[1/0,1/0,-1/0,-1/0];if(!cl(o,d.length))return l;for(let u=o[0];u<=o[1];++u)Xh(l,d[u]);return l}function mp(d){const o=[1/0,1/0,-1/0,-1/0];for(let l=0;l<d.length;++l)for(let u=0;u<d[l].length;++u)Xh(o,d[l][u]);return o}function Fu(d,o,l){if(Ou(d)||Ou(o))return NaN;let u=0,_=0;return d[2]<o[0]&&(u=o[0]-d[2]),d[0]>o[2]&&(u=d[0]-o[2]),d[1]>o[3]&&(_=d[1]-o[3]),d[3]<o[1]&&(_=o[1]-d[3]),l.distance([0,0],[u,_])}function AT(d){return 360*d-180}function Ba(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function gp(d,o){const l=Math.pow(2,o.z),u=(d.y/Ot+o.y)/l;return[AT((d.x/Ot+o.x)/l),Ba(u)]}function Lu(d,o){const l=[];for(let u=0;u<d.length;++u)l.push(gp(d[u],o));return l}function hw(d,o,l){const u=l.pointOnLine(o,d).point;return l.distance(d,u)}function G_(d,o,l,u,_){const p=l.slice(u[0],u[1]+1);let y=1/0;for(let T=o[0];T<=o[1];++T)if(0===(y=Math.min(y,hw(d[T],p,_))))return 0;return y}function ls(d,o,l,u,_){const p=Math.min(_.pointToSegmentDistance(d,l,u),_.pointToSegmentDistance(o,l,u)),y=Math.min(_.pointToSegmentDistance(l,d,o),_.pointToSegmentDistance(u,d,o));return Math.min(p,y)}function vr(d,o,l,u,_){if(!cl(o,d.length)||!cl(u,l.length))return NaN;let p=1/0;for(let y=o[0];y<o[1];++y)for(let T=u[0];T<u[1];++T){if(Au(d[y],d[y+1],l[T],l[T+1]))return 0;p=Math.min(p,ls(d[y],d[y+1],l[T],l[T+1],_))}return p}function dl(d,o,l,u,_){if(!cl(o,d.length)||!cl(u,l.length))return NaN;let p=1/0;for(let y=o[0];y<=o[1];++y)for(let T=u[0];T<=u[1];++T)if(0===(p=Math.min(p,_.distance(d[y],l[T]))))return p;return p}function og(d,o,l){if(Js(d,o,!0))return 0;let u=1/0;for(const _ of o){const p=_.length;if(p<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(_[0]!==_[p-1]&&0===(u=Math.min(u,l.pointToSegmentDistance(d,_[p-1],_[0])))||0===(u=Math.min(u,hw(d,_,l))))return u}return u}function sg(d,o,l,u){if(!cl(o,d.length))return NaN;for(let p=o[0];p<=o[1];++p)if(Js(d[p],l,!0))return 0;let _=1/0;for(let p=o[0];p<o[1];++p)for(const y of l)for(let T=0,E=y.length,R=E-1;T<E;R=T++){if(Au(d[p],d[p+1],y[R],y[T]))return 0;_=Math.min(_,ls(d[p],d[p+1],y[R],y[T],u))}return _}function ef(d,o){for(const l of d)for(let u=0;u<=l.length-1;++u)if(Js(l[u],o,!0))return!0;return!1}function Qr(d,o,l,u=1/0){const _=mp(d),p=mp(o);if(u!==1/0&&Fu(_,p,l)>=u)return u;if(ng(_,p)){if(ef(d,o))return 0}else if(ef(o,d))return 0;let y=u;for(const T of d)for(let E=0,R=T.length,w=R-1;E<R;w=E++)for(const D of o)for(let k=0,S=D.length,I=S-1;k<S;I=k++){if(Au(T[w],T[E],D[I],D[k]))return 0;y=Math.min(y,ls(T[w],T[E],D[I],D[k],l))}return y}function Ai(d,o,l,u,_,p,y){if(null===p||null===y)return;const T=Fu(pc(u,p),pc(_,y),l);T<o&&d.push({dist:T,range1:p,range2:y})}function qo(d,o,l,u,_=1/0){let p=Math.min(u.distance(d[0],l[0][0]),_);if(0===p)return p;const y=new hc([{dist:0,range1:[0,d.length-1],range2:[0,0]}],fc),T=o?50:100,E=mp(l);for(;y.length;){const R=y.pop();if(R.dist>=p)continue;const w=R.range1;if(pp(w)<=T){if(!cl(w,d.length))return NaN;if(o){const D=sg(d,w,l,u);if(0===(p=Math.min(p,D)))return p}else for(let D=w[0];D<=w[1];++D){const k=og(d[D],l,u);if(0===(p=Math.min(p,k)))return p}}else{const D=qc(w,o);if(null!==D[0]){const k=Fu(pc(d,D[0]),E,u);k<p&&y.push({dist:k,range1:D[0],range2:[0,0]})}if(null!==D[1]){const k=Fu(pc(d,D[1]),E,u);k<p&&y.push({dist:k,range1:D[1],range2:[0,0]})}}}return p}function Qo(d,o,l,u,_,p=1/0){let y=Math.min(p,_.distance(d[0],l[0]));if(0===y)return y;const T=new hc([{dist:0,range1:[0,d.length-1],range2:[0,l.length-1]}],fc),E=o?50:100,R=u?50:100;for(;T.length;){const w=T.pop();if(w.dist>=y)continue;const D=w.range1,k=w.range2;if(pp(D)<=E&&pp(k)<=R){if(!cl(D,d.length)||!cl(k,l.length))return NaN;if(o&&u?y=Math.min(y,vr(d,D,l,k,_)):o||u?o&&!u?y=Math.min(y,G_(l,k,d,D,_)):!o&&u&&(y=Math.min(y,G_(d,D,l,k,_))):y=Math.min(y,dl(d,D,l,k,_)),0===y)return y}else{const S=qc(D,o),I=qc(k,u);Ai(T,y,_,d,l,S[0],I[0]),Ai(T,y,_,d,l,S[0],I[1]),Ai(T,y,_,d,l,S[1],I[0]),Ai(T,y,_,d,l,S[1],I[1])}}return y}function Rl(d,o,l,u,_=1/0){let p=_;const y=pc(d,[0,d.length-1]);for(const T of l)if(!(p!==1/0&&Fu(y,pc(T,[0,T.length-1]),u)>=p)&&(p=Math.min(p,Qo(d,o,T,!0,u,p)),0===p))return p;return p}function Va(d,o,l,u,_=1/0){let p=_;const y=pc(d,[0,d.length-1]);for(const T of l){if(p!==1/0&&Fu(y,mp(T),u)>=p)continue;const E=qo(d,o,T,u,p);if(isNaN(E))return E;if(0===(p=Math.min(p,E)))return p}return p}function q_(d){return"Point"===d||"MultiPoint"===d||"LineString"===d||"MultiLineString"===d||"Polygon"===d||"MultiPolygon"===d}class kd{constructor(o,l){this.type=Yt,this.geojson=o,this.geometries=l}static parse(o,l){if(2!==o.length)return l.error(`'distance' expression requires either one argument, but found ' ${o.length-1} instead.`);if(Wh(o[1])){const u=o[1];if("FeatureCollection"===u.type){for(let _=0;_<u.features.length;++_)if(q_(u.features[_].geometry.type))return new kd(u,u.features[_].geometry)}else if("Feature"===u.type){if(q_(u.geometry.type))return new kd(u,u.geometry)}else if(q_(u.type))return new kd(u,u)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(o){const l=o.geometry(),u=o.canonicalID();if(null!=l&&null!=u){if("Point"===o.geometryType())return function(_,p,y){const T=[];for(const R of _)for(const w of R)T.push(gp(w,p));const E=new Jh(T[0][1],"meters");return"Point"===y.type||"MultiPoint"===y.type||"LineString"===y.type?Qo(T,!1,"Point"===y.type?[y.coordinates]:y.coordinates,"LineString"===y.type,E):"MultiLineString"===y.type?Rl(T,!1,y.coordinates,E):"Polygon"===y.type||"MultiPolygon"===y.type?Va(T,!1,"Polygon"===y.type?[y.coordinates]:y.coordinates,E):null}(l,u,this.geometries);if("LineString"===o.geometryType())return function(_,p,y){const T=[];for(const R of _){const w=[];for(const D of R)w.push(gp(D,p));T.push(w)}const E=new Jh(T[0][0][1],"meters");if("Point"===y.type||"MultiPoint"===y.type||"LineString"===y.type)return Rl("Point"===y.type?[y.coordinates]:y.coordinates,"LineString"===y.type,T,E);if("MultiLineString"===y.type){let R=1/0;for(let w=0;w<y.coordinates.length;w++){const D=Rl(y.coordinates[w],!0,T,E,R);if(isNaN(D))return D;if(0===(R=Math.min(R,D)))return R}return R}if("Polygon"===y.type||"MultiPolygon"===y.type){let R=1/0;for(let w=0;w<T.length;w++){const D=Va(T[w],!0,"Polygon"===y.type?[y.coordinates]:y.coordinates,E,R);if(isNaN(D))return D;if(0===(R=Math.min(R,D)))return R}return R}return null}(l,u,this.geometries);if("Polygon"===o.geometryType())return function(_,p,y){const T=[];for(const R of function(w){const k=w.length;if(k<=1)return[w];const S=[];let I,O;for(let B=0;B<k;B++){const U=ba(w[B]);0!==U&&(w[B].area=Math.abs(U),void 0===O&&(O=U<0),O===U<0?(I&&S.push(I),I=[w[B]]):I.push(w[B]))}return I&&S.push(I),S}(_)){const w=[];for(let D=0;D<R.length;++D)w.push(Lu(R[D],p));T.push(w)}const E=new Jh(T[0][0][0][1],"meters");if("Point"===y.type||"MultiPoint"===y.type||"LineString"===y.type)return Va("Point"===y.type?[y.coordinates]:y.coordinates,"LineString"===y.type,T,E);if("MultiLineString"===y.type){let R=1/0;for(let w=0;w<y.coordinates.length;w++){const D=Va(y.coordinates[w],!0,T,E,R);if(isNaN(D))return D;if(0===(R=Math.min(R,D)))return R}return R}return"Polygon"===y.type||"MultiPolygon"===y.type?function(R,w,D){let k=1/0;for(const S of R)for(const I of w){const O=Qr(S,I,D,k);if(isNaN(O))return O;if(0===(k=Math.min(k,O)))return k}return k}("Polygon"===y.type?[y.coordinates]:y.coordinates,T,E):null}(l,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function tf(d,o){switch(d){case"string":return Qs(o);case"number":return+o;case"boolean":return!!o;case"color":return ki.parse(o);case"formatted":return Xo.fromString(Qs(o));case"resolvedImage":return Ko.build(Qs(o))}return o}function ag(d,o,l,u){return void 0!==u&&(d=u*Math.round(d/u)),void 0!==o&&d<o&&(d=o),void 0!==l&&d>l&&(d=l),d}class mc{constructor(o,l,u){this.type=o,this.key=l,this.scope=u}static parse(o,l){let u=l.expectedType;if(null==u&&(u=_i),o.length<2||o.length>3)return l.error("Invalid number of arguments for 'config' expression.");const _=l.parse(o[1],1);if(!(_ instanceof va))return l.error("Key name of 'config' expression must be a string literal.");if(o.length>=3){const p=l.parse(o[2],2);return p instanceof va?new mc(u,Qs(_.value),Qs(p.value)):l.error("Scope of 'config' expression must be a string literal.")}return new mc(u,Qs(_.value))}evaluate(o){const l=[this.key,this.scope,o.scope].filter(Boolean).join("\x1f"),u=o.getConfig(l);if(!u)return null;const{type:_,value:p,values:y,minValue:T,maxValue:E,stepValue:R}=u,w=u.default.evaluate(o);let D=w;if(p){const k=o.scope;o.scope=(k||"").split("\x1f").slice(1).join("\x1f"),D=p.evaluate(o),o.scope=k}return _&&(D=tf(_,D)),void 0===D||void 0===T&&void 0===E&&void 0===R||("number"==typeof D?D=ag(D,T,E,R):Array.isArray(D)&&(D=D.map(k=>"number"==typeof k?ag(k,T,E,R):k))),void 0!==p&&void 0!==D&&y&&!y.includes(D)&&(D=w,_&&(D=tf(_,D))),(_&&_!==this.type||void 0!==D&&gr(D)!==this.type)&&(D=tf(this.type.kind,D)),D}eachChild(){}outputDefined(){return!1}serialize(){const o=["config",this.key];return this.scope&&o.concat(this.key),o}}function _p(d){if(d instanceof za&&("get"===d.name&&1===d.args.length||"feature-state"===d.name||"has"===d.name&&1===d.args.length||"properties"===d.name||"geometry-type"===d.name||"id"===d.name||/^filter-/.test(d.name))||d instanceof ll||d instanceof kd)return!1;let o=!0;return d.eachChild(l=>{o&&!_p(l)&&(o=!1)}),o}function Wc(d){if(d instanceof za&&"feature-state"===d.name)return!1;let o=!0;return d.eachChild(l=>{o&&!Wc(l)&&(o=!1)}),o}function Nu(d){if(d instanceof mc)return new Set([d.key]);let o=new Set;return d.eachChild(l=>{o=new Set([...o,...Nu(l)])}),o}function Pl(d,o){if(d instanceof za&&o.indexOf(d.name)>=0)return!1;let l=!0;return d.eachChild(u=>{l&&!Pl(u,o)&&(l=!1)}),l}class nf{constructor(o,l){this.type=l.type,this.name=o,this.boundExpression=l}static parse(o,l){if(2!==o.length||"string"!=typeof o[1])return l.error("'var' expression requires exactly one string literal argument.");const u=o[1];return l.scope.has(u)?new nf(u,l.scope.get(u)):l.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(o){return this.boundExpression.evaluate(o)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class yp{constructor(o,l=[],u,_=new mb,p=[],y,T){this.registry=o,this.path=l,this.key=l.map(E=>"string"==typeof E?`['${E}']`:`[${E}]`).join(""),this.scope=_,this.errors=p,this.expectedType=u,this._scope=y,this.options=T}parse(o,l,u,_,p={}){return l||u?this.concat(l,null,u,_)._parse(o,p):this._parse(o,p)}parseObjectValue(o,l,u,_,p,y={}){return this.concat(l,u,_,p)._parse(o,y)}_parse(o,l){function u(_,p,y){return"assert"===y?new Go(p,[_]):"coerce"===y?new Id(p,[_]):_}if(null!==o&&"string"!=typeof o&&"boolean"!=typeof o&&"number"!=typeof o||(o=["literal",o]),Array.isArray(o)){if(0===o.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _="string"==typeof o[0]?this.registry[o[0]]:void 0;if(_){let p=_.parse(o,this);if(!p)return null;if(this.expectedType){const y=this.expectedType,T=p.type;if("string"!==y.kind&&"number"!==y.kind&&"boolean"!==y.kind&&"object"!==y.kind&&"array"!==y.kind||"value"!==T.kind)if("color"!==y.kind&&"formatted"!==y.kind&&"resolvedImage"!==y.kind||"value"!==T.kind&&"string"!==T.kind){if(this.checkSubtype(y,T))return null}else p=u(p,y,l.typeAnnotation||"coerce");else p=u(p,y,l.typeAnnotation||"assert")}if(!(p instanceof va)&&"resolvedImage"!==p.type.kind&&Ad(p)){const y=new eg(this._scope,this.options);try{p=new va(p.type,p.evaluate(y))}catch(T){return this.error(T.message),null}}return p}return Id.parse(["to-array",o],this)}return this.error(void 0===o?"'undefined' value invalid. Use null instead.":"object"==typeof o?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof o} instead.`)}concat(o,l,u,_){let p="number"==typeof o?this.path.concat(o):this.path;p="string"==typeof l?p.concat(l):p;const y=_?this.scope.concat(_):this.scope;return new yp(this.registry,p,u||null,y,this.errors,this._scope,this.options)}error(o,...l){const u=`${this.key}${l.map(_=>`[${_}]`).join("")}`;this.errors.push(new Al(u,o))}checkSubtype(o,l){const u=Eu(o,l);return u&&this.error(u),u}}var Zc=yp;function Ad(d){if(d instanceof nf)return Ad(d.boundExpression);if(d instanceof za&&"error"===d.name||d instanceof Yh||d instanceof ll||d instanceof kd||d instanceof mc)return!1;const o=d instanceof Id||d instanceof Go;let l=!0;return d.eachChild(u=>{l=o?l&&Ad(u):l&&u instanceof va}),!!l&&_p(d)&&Pl(d,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function li(d,o){const l=d.length-1;let u,_,p=0,y=l,T=0;for(;p<=y;)if(T=Math.floor((p+y)/2),u=d[T],_=d[T+1],u<=o){if(T===l||o<_)return T;p=T+1}else{if(!(u>o))throw new Xr("Input is not a number.");y=T-1}return 0}class Rd{constructor(o,l,u){this.type=o,this.input=l,this.labels=[],this.outputs=[];for(const[_,p]of u)this.labels.push(_),this.outputs.push(p)}static parse(o,l){if(o.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if((o.length-1)%2!=0)return l.error("Expected an even number of arguments.");const u=l.parse(o[1],1,Yt);if(!u)return null;const _=[];let p=null;l.expectedType&&"value"!==l.expectedType.kind&&(p=l.expectedType);for(let y=1;y<o.length;y+=2){const T=1===y?-1/0:o[y],E=o[y+1],R=y,w=y+1;if("number"!=typeof T)return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(_.length&&_[_.length-1][0]>=T)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const D=l.parse(E,w,p);if(!D)return null;p=p||D.type,_.push([T,D])}return new Rd(p,u,_)}evaluate(o){const l=this.labels,u=this.outputs;if(1===l.length)return u[0].evaluate(o);const _=this.input.evaluate(o);if(_<=l[0])return u[0].evaluate(o);const p=l.length;return _>=l[p-1]?u[p-1].evaluate(o):u[li(l,_)].evaluate(o)}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){const o=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&o.push(this.labels[l]),o.push(this.outputs[l].serialize());return o}}const rf=4/29,Eo=6/29,tr=3*Eo*Eo,W_=Eo*Eo*Eo,fw=Math.PI/180,pw=180/Math.PI;function cg(d){return d>W_?Math.pow(d,1/3):d/tr+rf}function zu(d){return d>Eo?d*d*d:tr*(d-rf)}function Pd(d){return 255*(d<=.0031308?12.92*d:1.055*Math.pow(d,1/2.4)-.055)}function Z_(d){return(d/=255)<=.04045?d/12.92:Math.pow((d+.055)/1.055,2.4)}function bb(d){const o=Z_(d.r),l=Z_(d.g),u=Z_(d.b),_=cg((.4124564*o+.3575761*l+.1804375*u)/.95047),p=cg((.2126729*o+.7151522*l+.072175*u)/1);return{l:116*p-16,a:500*(_-p),b:200*(p-cg((.0193339*o+.119192*l+.9503041*u)/1.08883)),alpha:d.a}}function xb(d){let o=(d.l+16)/116,l=isNaN(d.a)?o:o+d.a/500,u=isNaN(d.b)?o:o-d.b/200;return o=1*zu(o),l=.95047*zu(l),u=1.08883*zu(u),new ki(Pd(3.2404542*l-1.5371385*o-.4985314*u),Pd(-.969266*l+1.8760108*o+.041556*u),Pd(.0556434*l-.2040259*o+1.0572252*u),d.alpha)}function Y_(d,o,l){const u=o-d;return d+l*(u>180||u<-180?u-360*Math.round(u/360):u)}const As={forward:bb,reverse:xb,interpolate:function(d,o,l){return{l:Lt(d.l,o.l,l),a:Lt(d.a,o.a,l),b:Lt(d.b,o.b,l),alpha:Lt(d.alpha,o.alpha,l)}}},sf={forward:function(d){const{l:o,a:l,b:u}=bb(d),_=Math.atan2(u,l)*pw;return{h:_<0?_+360:_,c:Math.sqrt(l*l+u*u),l:o,alpha:d.a}},reverse:function(d){const o=d.h*fw,l=d.c;return xb({l:d.l,a:Math.cos(o)*l,b:Math.sin(o)*l,alpha:d.alpha})},interpolate:function(d,o,l){return{h:Y_(d.h,o.h,l),c:Lt(d.c,o.c,l),l:Lt(d.l,o.l,l),alpha:Lt(d.alpha,o.alpha,l)}}};var Bu=Object.freeze({__proto__:null,hcl:sf,lab:As});class Jo{constructor(o,l,u,_,p,y){this.type=o,this.operator=l,this.interpolation=u,this.input=_,this.dynamicStops=p,this.labels=[],this.outputs=[];for(const[T,E]of y)this.labels.push(T),this.outputs.push(E)}static interpolationFactor(o,l,u,_){let p=0;if("exponential"===o.name)p=X_(l,o.base,u,_);else if("linear"===o.name)p=X_(l,1,u,_);else if("cubic-bezier"===o.name){const y=o.controlPoints;p=new bu(y[0],y[1],y[2],y[3]).solve(X_(l,1,u,_))}return p}static parse(o,l){let[u,_,p,...y]=o;if(!Array.isArray(_)||0===_.length)return l.error("Expected an interpolation type expression.",1);if("linear"===_[0])_={name:"linear"};else if("exponential"===_[0]){const R=_[1];if("number"!=typeof R)return l.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:R}}else{if("cubic-bezier"!==_[0])return l.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const R=_.slice(1);if(4!==R.length||R.some(w=>"number"!=typeof w||w<0||w>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:R}}}if(o.length-1<3)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length-1>3&&(o.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(p=l.parse(p,2,Yt),!p)return null;const T=[];let E=null;if("interpolate-hcl"===u||"interpolate-lab"===u?E=ya:l.expectedType&&"value"!==l.expectedType.kind&&(E=l.expectedType),o.length-1==3){const R=l.parse(y[0],3,_i);return R?new Jo(E,u,_,p,R,T):null}for(let R=0;R<y.length;R+=2){const w=y[R],D=y[R+1],k=R+3,S=R+4;if("number"!=typeof w)return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(T.length&&T[T.length-1][0]>=w)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',k);const I=l.parse(D,S,E);if(!I)return null;E=E||I.type,T.push([w,I])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Jo(E,u,_,p,null,T):l.error(`Type ${ur(E)} is not interpolatable.`)}evaluate(o){let l=this.labels,u=this.outputs;if(this.dynamicStops){const w=this.dynamicStops.evaluate(o);if(w.length%2!=0)throw new Xr("Expected an even number of arguments.");l=[],u=[];for(let D=0;D<w.length;D+=2){const k=w[D],S=new va(Yt,w[D+1]);if("number"!=typeof k)throw new Xr('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(l.length&&l[l.length-1]>=k)throw new Xr('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');l.push(k),u.push(S)}if(0===l.length)throw new Xr("Expected at least one input/output pair.")}if(1===l.length)return u[0].evaluate(o);const _=this.input.evaluate(o);if(_<=l[0])return u[0].evaluate(o);const p=l.length;if(_>=l[p-1])return u[p-1].evaluate(o);const y=li(l,_),T=Jo.interpolationFactor(this.interpolation,_,l[y],l[y+1]),E=u[y].evaluate(o),R=u[y+1].evaluate(o);return"interpolate"===this.operator?Ei[this.type.kind.toLowerCase()](E,R,T):"interpolate-hcl"===this.operator?sf.reverse(sf.interpolate(sf.forward(E),sf.forward(R),T)):As.reverse(As.interpolate(As.forward(E),As.forward(R),T))}eachChild(o){o(this.input);for(const l of this.outputs)o(l)}outputDefined(){return this.outputs.every(o=>o.outputDefined())}serialize(){let o;o="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const l=[this.operator,o,this.input.serialize()];if(this.dynamicStops)l.push(this.dynamicStops.serialize());else for(let u=0;u<this.labels.length;u++)l.push(this.labels[u],this.outputs[u].serialize());return l}}function X_(d,o,l,u){const _=u-l,p=d-l;return 0===_?0:1===o?p/_:(Math.pow(o,p)-1)/(Math.pow(o,_)-1)}class dg{constructor(o,l){this.type=o,this.args=l}static parse(o,l){if(o.length<2)return l.error("Expectected at least one argument.");let u=null;const _=l.expectedType;_&&"value"!==_.kind&&(u=_);const p=[];for(const T of o.slice(1)){const E=l.parse(T,1+p.length,u,void 0,{typeAnnotation:"omit"});if(!E)return null;u=u||E.type,p.push(E)}const y=_&&p.some(T=>Eu(_,T.type));return new dg(y?_i:u,p)}evaluate(o){let l,u=null,_=0;for(const p of this.args){if(_++,u=p.evaluate(o),u&&u instanceof Ko&&!u.available&&(l||(l=u),u=null,_===this.args.length))return l;if(null!==u)break}return u}eachChild(o){this.args.forEach(o)}outputDefined(){return this.args.every(o=>o.outputDefined())}serialize(){const o=["coalesce"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class Do{constructor(o,l){this.type=l.type,this.bindings=[].concat(o),this.result=l}evaluate(o){return this.result.evaluate(o)}eachChild(o){for(const l of this.bindings)o(l[1]);o(this.result)}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found ${o.length-1} instead.`);const u=[];for(let p=1;p<o.length-1;p+=2){const y=o[p];if("string"!=typeof y)return l.error(`Expected string, but found ${typeof y} instead.`,p);if(/[^a-zA-Z0-9_]/.test(y))return l.error("Variable names must contain only alphanumeric characters or '_'.",p);const T=l.parse(o[p+1],p+1);if(!T)return null;u.push([y,T])}const _=l.parse(o[o.length-1],o.length-1,l.expectedType,u);return _?new Do(u,_):null}outputDefined(){return this.result.outputDefined()}serialize(){const o=["let"];for(const[l,u]of this.bindings)o.push(l,u.serialize());return o.push(this.result.serialize()),o}}class ug{constructor(o,l,u){this.type=o,this.index=l,this.input=u}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const u=l.parse(o[1],1,Yt),_=l.parse(o[2],2,as(l.expectedType||_i));return u&&_?new ug(_.type.itemType,u,_):null}evaluate(o){const l=this.index.evaluate(o),u=this.input.evaluate(o);if(l<0)throw new Xr(`Array index out of bounds: ${l} < 0.`);if(l>u.length-1)throw new Xr(`Array index out of bounds: ${l} > ${u.length-1}.`);if(l===Math.floor(l))return u[l];const _=Math.floor(l),p=Math.ceil(l),y=u[_],T=u[p];if("number"!=typeof y||"number"!=typeof T)throw new Xr(`Cannot interpolate between non-number values at index ${l}.`);const E=l-_;return y*(1-E)+T*E}eachChild(o){o(this.index),o(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class K_{constructor(o,l){this.type=gi,this.needle=o,this.haystack=l}static parse(o,l){if(3!==o.length)return l.error(`Expected 2 arguments, but found ${o.length-1} instead.`);const u=l.parse(o[1],1,_i),_=l.parse(o[2],2,_i);return u&&_?$h(u.type,[gi,Qt,Yt,Nt,_i])?new K_(u,_):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(u.type)} instead`):null}evaluate(o){const l=this.needle.evaluate(o),u=this.haystack.evaluate(o);if(null==u)return!1;if(!Du(l,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${ur(gr(l))} instead.`);if(!Du(u,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${ur(gr(u))} instead.`);return u.indexOf(l)>=0}eachChild(o){o(this.needle),o(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Od{constructor(o,l,u){this.type=Yt,this.needle=o,this.haystack=l,this.fromIndex=u}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const u=l.parse(o[1],1,_i),_=l.parse(o[2],2,_i);if(!u||!_)return null;if(!$h(u.type,[gi,Qt,Yt,Nt,_i]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ur(u.type)} instead`);if(4===o.length){const p=l.parse(o[3],3,Yt);return p?new Od(u,_,p):null}return new Od(u,_)}evaluate(o){const l=this.needle.evaluate(o),u=this.haystack.evaluate(o);if(!Du(l,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${ur(gr(l))} instead.`);if(!Du(u,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${ur(gr(u))} instead.`);if(this.fromIndex){const _=this.fromIndex.evaluate(o);return u.indexOf(l,_)}return u.indexOf(l)}eachChild(o){o(this.needle),o(this.haystack),this.fromIndex&&o(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const o=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),o]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Q_{constructor(o,l,u,_,p,y){this.inputType=o,this.type=l,this.input=u,this.cases=_,this.outputs=p,this.otherwise=y}static parse(o,l){if(o.length<5)return l.error(`Expected at least 4 arguments, but found only ${o.length-1}.`);if(o.length%2!=1)return l.error("Expected an even number of arguments.");let u,_;l.expectedType&&"value"!==l.expectedType.kind&&(_=l.expectedType);const p={},y=[];for(let R=2;R<o.length-1;R+=2){let w=o[R];const D=o[R+1];Array.isArray(w)||(w=[w]);const k=l.concat(R);if(0===w.length)return k.error("Expected at least one branch label.");for(const I of w){if("number"!=typeof I&&"string"!=typeof I)return k.error("Branch labels must be numbers or strings.");if("number"==typeof I&&Math.abs(I)>Number.MAX_SAFE_INTEGER)return k.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof I&&Math.floor(I)!==I)return k.error("Numeric branch labels must be integer values.");if(u){if(k.checkSubtype(u,gr(I)))return null}else u=gr(I);if(void 0!==p[String(I)])return k.error("Branch labels must be unique.");p[String(I)]=y.length}const S=l.parse(D,R,_);if(!S)return null;_=_||S.type,y.push(S)}const T=l.parse(o[1],1,_i);if(!T)return null;const E=l.parse(o[o.length-1],o.length-1,_);return E?"value"!==T.type.kind&&l.concat(1).checkSubtype(u,T.type)?null:new Q_(u,_,T,p,y,E):null}evaluate(o){const l=this.input.evaluate(o);return(gr(l)===this.inputType&&this.outputs[this.cases[l]]||this.otherwise).evaluate(o)}eachChild(o){o(this.input),this.outputs.forEach(o),o(this.otherwise)}outputDefined(){return this.outputs.every(o=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),u=[],_={};for(const y of l){const T=_[this.cases[y]];void 0===T?(_[this.cases[y]]=u.length,u.push([this.cases[y],[y]])):u[T][1].push(y)}const p=y=>"number"===this.inputType.kind?Number(y):y;for(const[y,T]of u)o.push(1===T.length?p(T[0]):T.map(p)),o.push(this.outputs[y].serialize());return o.push(this.otherwise.serialize()),o}}class J_{constructor(o,l,u){this.type=o,this.branches=l,this.otherwise=u}static parse(o,l){if(o.length<4)return l.error(`Expected at least 3 arguments, but found only ${o.length-1}.`);if(o.length%2!=0)return l.error("Expected an odd number of arguments.");let u;l.expectedType&&"value"!==l.expectedType.kind&&(u=l.expectedType);const _=[];for(let y=1;y<o.length-1;y+=2){const T=l.parse(o[y],y,gi);if(!T)return null;const E=l.parse(o[y+1],y+1,u);if(!E)return null;_.push([T,E]),u=u||E.type}const p=l.parse(o[o.length-1],o.length-1,u);return p?new J_(u,_,p):null}evaluate(o){for(const[l,u]of this.branches)if(l.evaluate(o))return u.evaluate(o);return this.otherwise.evaluate(o)}eachChild(o){for(const[l,u]of this.branches)o(l),o(u);o(this.otherwise)}outputDefined(){return this.branches.every(([o,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const o=["case"];return this.eachChild(l=>{o.push(l.serialize())}),o}}class hg{constructor(o,l,u,_){this.type=o,this.input=l,this.beginIndex=u,this.endIndex=_}static parse(o,l){if(o.length<=2||o.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${o.length-1} instead.`);const u=l.parse(o[1],1,_i),_=l.parse(o[2],2,Yt);if(!u||!_)return null;if(!$h(u.type,[as(_i),Qt,_i]))return l.error(`Expected first argument to be of type array or string, but found ${ur(u.type)} instead`);if(4===o.length){const p=l.parse(o[3],3,Yt);return p?new hg(u.type,u,_,p):null}return new hg(u.type,u,_)}evaluate(o){const l=this.input.evaluate(o),u=this.beginIndex.evaluate(o);if(!Du(l,["string","array"]))throw new Xr(`Expected first argument to be of type array or string, but found ${ur(gr(l))} instead.`);if(this.endIndex){const _=this.endIndex.evaluate(o);return l.slice(u,_)}return l.slice(u)}eachChild(o){o(this.input),o(this.beginIndex),this.endIndex&&o(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const o=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),o]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function wb(d,o){return"=="===d||"!="===d?"boolean"===o.kind||"string"===o.kind||"number"===o.kind||"null"===o.kind||"value"===o.kind:"string"===o.kind||"number"===o.kind||"value"===o.kind}function Cb(d,o,l,u){return 0===u.compare(o,l)}function af(d,o,l){const u="=="!==d&&"!="!==d;return class Lq{constructor(p,y,T){this.type=gi,this.lhs=p,this.rhs=y,this.collator=T,this.hasUntypedArgument="value"===p.type.kind||"value"===y.type.kind}static parse(p,y){if(3!==p.length&&4!==p.length)return y.error("Expected two or three arguments.");const T=p[0];let E=y.parse(p[1],1,_i);if(!E)return null;if(!wb(T,E.type))return y.concat(1).error(`"${T}" comparisons are not supported for type '${ur(E.type)}'.`);let R=y.parse(p[2],2,_i);if(!R)return null;if(!wb(T,R.type))return y.concat(2).error(`"${T}" comparisons are not supported for type '${ur(R.type)}'.`);if(E.type.kind!==R.type.kind&&"value"!==E.type.kind&&"value"!==R.type.kind)return y.error(`Cannot compare types '${ur(E.type)}' and '${ur(R.type)}'.`);u&&("value"===E.type.kind&&"value"!==R.type.kind?E=new Go(R.type,[E]):"value"!==E.type.kind&&"value"===R.type.kind&&(R=new Go(E.type,[R])));let w=null;if(4===p.length){if("string"!==E.type.kind&&"string"!==R.type.kind&&"value"!==E.type.kind&&"value"!==R.type.kind)return y.error("Cannot use collator to compare non-string types.");if(w=y.parse(p[3],3,Su),!w)return null}return new Lq(E,R,w)}evaluate(p){const y=this.lhs.evaluate(p),T=this.rhs.evaluate(p);if(u&&this.hasUntypedArgument){const E=gr(y),R=gr(T);if(E.kind!==R.kind||"string"!==E.kind&&"number"!==E.kind)throw new Xr(`Expected arguments for "${d}" to be (string, string) or (number, number), but found (${E.kind}, ${R.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const E=gr(y),R=gr(T);if("string"!==E.kind||"string"!==R.kind)return o(p,y,T)}return this.collator?l(p,y,T,this.collator.evaluate(p)):o(p,y,T)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[d];return this.eachChild(y=>{p.push(y.serialize())}),p}}}const ey=af("==",function(d,o,l){return o===l},Cb),fg=af("!=",function(d,o,l){return o!==l},function(d,o,l,u){return!Cb(0,o,l,u)}),Jr=af("<",function(d,o,l){return o<l},function(d,o,l,u){return u.compare(o,l)<0}),Jt=af(">",function(d,o,l){return o>l},function(d,o,l,u){return u.compare(o,l)>0}),Wn=af("<=",function(d,o,l){return o<=l},function(d,o,l,u){return u.compare(o,l)<=0}),ao=af(">=",function(d,o,l){return o>=l},function(d,o,l,u){return u.compare(o,l)>=0});class cs{constructor(o,l,u,_,p,y){this.type=Qt,this.number=o,this.locale=l,this.currency=u,this.unit=_,this.minFractionDigits=p,this.maxFractionDigits=y}static parse(o,l){if(3!==o.length)return l.error("Expected two arguments.");const u=l.parse(o[1],1,Yt);if(!u)return null;const _=o[2];if("object"!=typeof _||Array.isArray(_))return l.error("NumberFormat options argument must be an object.");let p=null;if(_.locale&&(p=l.parseObjectValue(_.locale,2,"locale",Qt),!p))return null;let y=null;if(_.currency&&(y=l.parseObjectValue(_.currency,2,"currency",Qt),!y))return null;let T=null;if(_.unit&&(T=l.parseObjectValue(_.unit,2,"unit",Qt),!T))return null;let E=null;if(_["min-fraction-digits"]&&(E=l.parseObjectValue(_["min-fraction-digits"],2,"min-fraction-digits",Yt),!E))return null;let R=null;return _["max-fraction-digits"]&&(R=l.parseObjectValue(_["max-fraction-digits"],2,"max-fraction-digits",Yt),!R)?null:new cs(u,p,y,T,E,R)}evaluate(o){return new Intl.NumberFormat(this.locale?this.locale.evaluate(o):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(o):void 0,unit:this.unit?this.unit.evaluate(o):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(o):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(o):void 0}).format(this.number.evaluate(o))}eachChild(o){o(this.number),this.locale&&o(this.locale),this.currency&&o(this.currency),this.unit&&o(this.unit),this.minFractionDigits&&o(this.minFractionDigits),this.maxFractionDigits&&o(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const o={};return this.locale&&(o.locale=this.locale.serialize()),this.currency&&(o.currency=this.currency.serialize()),this.unit&&(o.unit=this.unit.serialize()),this.minFractionDigits&&(o["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(o["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),o]}}class Oo{constructor(o){this.type=Yt,this.input=o}static parse(o,l){if(2!==o.length)return l.error(`Expected 1 argument, but found ${o.length-1} instead.`);const u=l.parse(o[1],1);return u?"array"!==u.type.kind&&"string"!==u.type.kind&&"value"!==u.type.kind?l.error(`Expected argument of type string or array, but found ${ur(u.type)} instead.`):new Oo(u):null}evaluate(o){const l=this.input.evaluate(o);if("string"==typeof l||Array.isArray(l))return l.length;throw new Xr(`Expected value to be of type string or array, but found ${ur(gr(l))} instead.`)}eachChild(o){o(this.input)}outputDefined(){return!1}serialize(){const o=["length"];return this.eachChild(l=>{o.push(l.serialize())}),o}}function Rs(d){return function(){d=1831565813+(d|=0)|0;let o=Math.imul(d^d>>>15,1|d);return o=o+Math.imul(o^o>>>7,61|o)^o,((o^o>>>14)>>>0)/4294967296}}const Ol={"==":ey,"!=":fg,">":Jt,"<":Jr,">=":ao,"<=":Wn,array:Go,at:ug,boolean:Go,case:J_,coalesce:dg,collator:Yh,format:Na,image:Iu,in:K_,"index-of":Od,interpolate:Jo,"interpolate-hcl":Jo,"interpolate-lab":Jo,length:Oo,let:Do,literal:va,match:Q_,number:Go,"number-format":cs,object:Go,slice:hg,step:Rd,string:Go,"to-boolean":Id,"to-color":Id,"to-number":Id,"to-string":Id,var:nf,within:ll,distance:kd,config:mc};function Vr(d,[o,l,u,_]){o=o.evaluate(d),l=l.evaluate(d),u=u.evaluate(d);const p=_?_.evaluate(d):1,y=qh(o,l,u,p);if(y)throw new Xr(y);return new ki(o/255*p,l/255*p,u/255*p,p)}function mo(d,[o,l,u,_]){o=o.evaluate(d),l=l.evaluate(d),u=u.evaluate(d);const p=_?_.evaluate(d):1,y=(w=l,D=u,k=p,"number"==typeof(R=o)&&R>=0&&R<=360?"number"==typeof w&&w>=0&&w<=100&&"number"==typeof D&&D>=0&&D<=100?void 0===k||"number"==typeof k&&k>=0&&k<=1?null:`Invalid hsla value [${[R,w,D,k].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${("number"==typeof k?[R,w,D,k]:[R,w,D]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${("number"==typeof k?[R,w,D,k]:[R,w,D]).join(", ")}]: 'h' must be between 0 and 360.`);var R,w,D,k;if(y)throw new Xr(y);const T=`hsla(${o}, ${l}%, ${u}%, ${p})`,E=ki.parse(T);if(!E)throw new Xr(`Failed to parse HSLA color: ${T}`);return E}function ul(d,o){return d in o}function ti(d,o){const l=o[d];return void 0===l?null:l}function wa(d){return{type:d}}function lf(d){return{result:"success",value:d}}function Ua(d){return{result:"error",value:d}}function Ur(d,o){return!!d&&!!d.parameters&&d.parameters.indexOf(o)>-1}function hl(d){return"data-driven"===d["property-type"]}function Vu(d){return Ur(d.expression,"measure-light")}function gc(d){return Ur(d.expression,"zoom")}function Yc(d){return!!d.expression&&d.expression.interpolated}function vp(d){return"object"==typeof d&&null!==d&&!Array.isArray(d)}function Fd(d){return d}function bp(d,o){const l="color"===o.type,u=d.stops&&"object"==typeof d.stops[0][0],_=u||!(u||void 0!==d.property),p=d.type||(Yc(o)?"exponential":"interval");if(l&&((d=$_({},d)).stops&&(d.stops=d.stops.map(R=>[R[0],ki.parse(R[1])])),d.default=ki.parse(d.default?d.default:o.default)),d.colorSpace&&"rgb"!==d.colorSpace&&!Bu[d.colorSpace])throw new Error(`Unknown color space: ${d.colorSpace}`);let y,T,E;if("exponential"===p)y=Uu;else if("interval"===p)y=Mn;else if("categorical"===p){y=Ca,T=Object.create(null);for(const R of d.stops)T[R[0]]=R[1];E=typeof d.stops[0][0]}else{if("identity"!==p)throw new Error(`Unknown function type "${p}"`);y=Xc}if(u){const R={},w=[];for(let S=0;S<d.stops.length;S++){const I=d.stops[S],O=I[0].zoom;void 0===R[O]&&(R[O]={zoom:O,type:d.type,property:d.property,default:d.default,stops:[]},w.push(O)),R[O].stops.push([I[0].value,I[1]])}const D=[];for(const S of w)D.push([R[S].zoom,bp(R[S],o)]);const k={name:"linear"};return{kind:"composite",interpolationType:k,interpolationFactor:Jo.interpolationFactor.bind(void 0,k),zoomStops:D.map(S=>S[0]),evaluate:({zoom:S},I)=>Uu({stops:D,base:d.base},o,S).evaluate(S,I)}}if(_){const R="exponential"===p?{name:"exponential",base:void 0!==d.base?d.base:1}:null;return{kind:"camera",interpolationType:R,interpolationFactor:Jo.interpolationFactor.bind(void 0,R),zoomStops:d.stops.map(w=>w[0]),evaluate:({zoom:w})=>y(d,o,w,T,E)}}return{kind:"source",evaluate(R,w){const D=w&&w.properties?w.properties[d.property]:void 0;return void 0===D?Fl(d.default,o.default):y(d,o,D,T,E)}}}function Fl(d,o,l){return void 0!==d?d:void 0!==o?o:void 0!==l?l:void 0}function Ca(d,o,l,u,_){return Fl(typeof l===_?u[l]:void 0,d.default,o.default)}function Mn(d,o,l){if("number"!==hi(l))return Fl(d.default,o.default);const u=d.stops.length;if(1===u||l<=d.stops[0][0])return d.stops[0][1];if(l>=d.stops[u-1][0])return d.stops[u-1][1];const _=li(d.stops.map(p=>p[0]),l);return d.stops[_][1]}function Uu(d,o,l){const u=void 0!==d.base?d.base:1;if("number"!==hi(l))return Fl(d.default,o.default);const _=d.stops.length;if(1===_||l<=d.stops[0][0])return d.stops[0][1];if(l>=d.stops[_-1][0])return d.stops[_-1][1];const p=li(d.stops.map(w=>w[0]),l),y=function(w,D,k,S){const I=S-k,O=w-k;return 0===I?0:1===D?O/I:(Math.pow(D,O)-1)/(Math.pow(D,I)-1)}(l,u,d.stops[p][0],d.stops[p+1][0]),T=d.stops[p][1],E=d.stops[p+1][1];let R=Ei[o.type]||Fd;if(d.colorSpace&&"rgb"!==d.colorSpace){const w=Bu[d.colorSpace];R=(D,k)=>w.reverse(w.interpolate(w.forward(D),w.forward(k),y))}return"function"==typeof T.evaluate?{evaluate(...w){const D=T.evaluate.apply(void 0,w),k=E.evaluate.apply(void 0,w);if(void 0!==D&&void 0!==k)return R(D,k,y)}}:R(T,E,y)}function Xc(d,o,l){return"color"===o.type?l=ki.parse(l):"formatted"===o.type?l=Xo.fromString(l.toString()):"resolvedImage"===o.type?l=Ko.build(l.toString()):hi(l)===o.type||"enum"===o.type&&o.values[l]||(l=void 0),Fl(l,d.default,o.default)}za.register(Ol,{error:[{kind:"error"},[Qt],(d,[o])=>{throw new Xr(o.evaluate(d))}],typeof:[Qt,[_i],(d,[o])=>ur(gr(o.evaluate(d)))],"to-rgba":[as(Yt,4),[ya],(d,[o])=>o.evaluate(d).toRenderColor(null).toArray()],"to-hsla":[as(Yt,4),[ya],(d,[o])=>o.evaluate(d).toRenderColor(null).toHslaArray()],rgb:[ya,[Yt,Yt,Yt],Vr],rgba:[ya,[Yt,Yt,Yt,Yt],Vr],hsl:[ya,[Yt,Yt,Yt],mo],hsla:[ya,[Yt,Yt,Yt,Yt],mo],has:{type:gi,overloads:[[[Qt],(d,[o])=>ul(o.evaluate(d),d.properties())],[[Qt,Dd],(d,[o,l])=>ul(o.evaluate(d),l.evaluate(d))]]},get:{type:_i,overloads:[[[Qt],(d,[o])=>ti(o.evaluate(d),d.properties())],[[Qt,Dd],(d,[o,l])=>ti(o.evaluate(d),l.evaluate(d))]]},"feature-state":[_i,[Qt],(d,[o])=>ti(o.evaluate(d),d.featureState||{})],properties:[Dd,[],d=>d.properties()],"geometry-type":[Qt,[],d=>d.geometryType()],id:[_i,[],d=>d.id()],zoom:[Yt,[],d=>d.globals.zoom],pitch:[Yt,[],d=>d.globals.pitch||0],"distance-from-center":[Yt,[],d=>d.distanceFromCenter()],"measure-light":[Yt,[Qt],(d,[o])=>d.measureLight(o.evaluate(d))],"heatmap-density":[Yt,[],d=>d.globals.heatmapDensity||0],"line-progress":[Yt,[],d=>d.globals.lineProgress||0],"raster-value":[Yt,[],d=>d.globals.rasterValue||0],"raster-particle-speed":[Yt,[],d=>d.globals.rasterParticleSpeed||0],"sky-radial-progress":[Yt,[],d=>d.globals.skyRadialProgress||0],accumulated:[_i,[],d=>void 0===d.globals.accumulated?null:d.globals.accumulated],"+":[Yt,wa(Yt),(d,o)=>{let l=0;for(const u of o)l+=u.evaluate(d);return l}],"*":[Yt,wa(Yt),(d,o)=>{let l=1;for(const u of o)l*=u.evaluate(d);return l}],"-":{type:Yt,overloads:[[[Yt,Yt],(d,[o,l])=>o.evaluate(d)-l.evaluate(d)],[[Yt],(d,[o])=>-o.evaluate(d)]]},"/":[Yt,[Yt,Yt],(d,[o,l])=>o.evaluate(d)/l.evaluate(d)],"%":[Yt,[Yt,Yt],(d,[o,l])=>o.evaluate(d)%l.evaluate(d)],ln2:[Yt,[],()=>Math.LN2],pi:[Yt,[],()=>Math.PI],e:[Yt,[],()=>Math.E],"^":[Yt,[Yt,Yt],(d,[o,l])=>Math.pow(o.evaluate(d),l.evaluate(d))],sqrt:[Yt,[Yt],(d,[o])=>Math.sqrt(o.evaluate(d))],log10:[Yt,[Yt],(d,[o])=>Math.log(o.evaluate(d))/Math.LN10],ln:[Yt,[Yt],(d,[o])=>Math.log(o.evaluate(d))],log2:[Yt,[Yt],(d,[o])=>Math.log(o.evaluate(d))/Math.LN2],sin:[Yt,[Yt],(d,[o])=>Math.sin(o.evaluate(d))],cos:[Yt,[Yt],(d,[o])=>Math.cos(o.evaluate(d))],tan:[Yt,[Yt],(d,[o])=>Math.tan(o.evaluate(d))],asin:[Yt,[Yt],(d,[o])=>Math.asin(o.evaluate(d))],acos:[Yt,[Yt],(d,[o])=>Math.acos(o.evaluate(d))],atan:[Yt,[Yt],(d,[o])=>Math.atan(o.evaluate(d))],min:[Yt,wa(Yt),(d,o)=>Math.min(...o.map(l=>l.evaluate(d)))],max:[Yt,wa(Yt),(d,o)=>Math.max(...o.map(l=>l.evaluate(d)))],abs:[Yt,[Yt],(d,[o])=>Math.abs(o.evaluate(d))],round:[Yt,[Yt],(d,[o])=>{const l=o.evaluate(d);return l<0?-Math.round(-l):Math.round(l)}],floor:[Yt,[Yt],(d,[o])=>Math.floor(o.evaluate(d))],ceil:[Yt,[Yt],(d,[o])=>Math.ceil(o.evaluate(d))],"filter-==":[gi,[Qt,_i],(d,[o,l])=>d.properties()[o.value]===l.value],"filter-id-==":[gi,[_i],(d,[o])=>d.id()===o.value],"filter-type-==":[gi,[Qt],(d,[o])=>d.geometryType()===o.value],"filter-<":[gi,[Qt,_i],(d,[o,l])=>{const u=d.properties()[o.value],_=l.value;return typeof u==typeof _&&u<_}],"filter-id-<":[gi,[_i],(d,[o])=>{const l=d.id(),u=o.value;return typeof l==typeof u&&l<u}],"filter->":[gi,[Qt,_i],(d,[o,l])=>{const u=d.properties()[o.value],_=l.value;return typeof u==typeof _&&u>_}],"filter-id->":[gi,[_i],(d,[o])=>{const l=d.id(),u=o.value;return typeof l==typeof u&&l>u}],"filter-<=":[gi,[Qt,_i],(d,[o,l])=>{const u=d.properties()[o.value],_=l.value;return typeof u==typeof _&&u<=_}],"filter-id-<=":[gi,[_i],(d,[o])=>{const l=d.id(),u=o.value;return typeof l==typeof u&&l<=u}],"filter->=":[gi,[Qt,_i],(d,[o,l])=>{const u=d.properties()[o.value],_=l.value;return typeof u==typeof _&&u>=_}],"filter-id->=":[gi,[_i],(d,[o])=>{const l=d.id(),u=o.value;return typeof l==typeof u&&l>=u}],"filter-has":[gi,[_i],(d,[o])=>o.value in d.properties()],"filter-has-id":[gi,[],d=>null!==d.id()&&void 0!==d.id()],"filter-type-in":[gi,[as(Qt)],(d,[o])=>o.value.indexOf(d.geometryType())>=0],"filter-id-in":[gi,[as(_i)],(d,[o])=>o.value.indexOf(d.id())>=0],"filter-in-small":[gi,[Qt,as(_i)],(d,[o,l])=>l.value.indexOf(d.properties()[o.value])>=0],"filter-in-large":[gi,[Qt,as(_i)],(d,[o,l])=>function(u,_,p,y){for(;p<=y;){const T=p+y>>1;if(_[T]===u)return!0;_[T]>u?y=T-1:p=T+1}return!1}(d.properties()[o.value],l.value,0,l.value.length-1)],all:{type:gi,overloads:[[[gi,gi],(d,[o,l])=>o.evaluate(d)&&l.evaluate(d)],[wa(gi),(d,o)=>{for(const l of o)if(!l.evaluate(d))return!1;return!0}]]},any:{type:gi,overloads:[[[gi,gi],(d,[o,l])=>o.evaluate(d)||l.evaluate(d)],[wa(gi),(d,o)=>{for(const l of o)if(l.evaluate(d))return!0;return!1}]]},"!":[gi,[gi],(d,[o])=>!o.evaluate(d)],"is-supported-script":[gi,[Qt],(d,[o])=>{const l=d.globals&&d.globals.isSupportedScript;return!l||l(o.evaluate(d))}],upcase:[Qt,[Qt],(d,[o])=>o.evaluate(d).toUpperCase()],downcase:[Qt,[Qt],(d,[o])=>o.evaluate(d).toLowerCase()],concat:[Qt,wa(_i),(d,o)=>o.map(l=>Qs(l.evaluate(d))).join("")],"resolved-locale":[Qt,[Su],(d,[o])=>o.evaluate(d).resolvedLocale()],random:[Yt,[Yt,Yt,_i],(d,o)=>{const[l,u,_]=o.map(y=>y.evaluate(d));if(l>u||l===u)return l;let p;if("string"==typeof _)p=function(y){let T=0;if(0===y.length)return T;for(let E=0;E<y.length;E++)T=(T<<5)-T+y.charCodeAt(E),T|=0;return T}(_);else{if("number"!=typeof _)throw new Xr(`Invalid seed input: ${_}`);p=_}return l+Rs(p)()*(u-l)}]});class ja{constructor(o,l,u,_){var p;this.expression=o,this._warningHistory={},this._evaluator=new eg(u,_),this._defaultValue=l?"color"===(p=l).type&&(vp(p.default)||Array.isArray(p.default))?new ki(0,0,0,0):"color"===p.type?ki.parse(p.default)||null:void 0===p.default?null:p.default:null,this._enumValues=l&&"enum"===l.type?l.values:null,this.configDependencies=Nu(o)}evaluateWithoutErrorHandling(o,l,u,_,p,y,T,E){return this._evaluator.globals=o,this._evaluator.feature=l,this._evaluator.featureState=u,this._evaluator.canonical=_||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(o,l,u,_,p,y,T,E){this._evaluator.globals=o,this._evaluator.feature=l||null,this._evaluator.featureState=u||null,this._evaluator.canonical=_||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=E||null;try{const R=this.expression.evaluate(this._evaluator);if(null==R||"number"==typeof R&&R!=R)return this._defaultValue;if(this._enumValues&&!(R in this._enumValues))throw new Xr(`Expected value to be one of ${Object.keys(this._enumValues).map(w=>JSON.stringify(w)).join(", ")}, but found ${JSON.stringify(R)} instead.`);return R}catch(R){return this._warningHistory[R.message]||(this._warningHistory[R.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${R.message}`)),this._defaultValue}}}function cf(d){return Array.isArray(d)&&d.length>0&&"string"==typeof d[0]&&d[0]in Ol}function _c(d,o,l,u){const _=new Zc(Ol,[],o?function(y){const T={color:ya,string:Qt,number:Yt,enum:Qt,boolean:gi,formatted:al,resolvedImage:Hc};return"array"===y.type?as(T[y.value]||_i,y.length):T[y.type]}(o):void 0,void 0,void 0,l,u),p=_.parse(d,void 0,void 0,void 0,o&&"string"===o.type?{typeAnnotation:"coerce"}:void 0);return p?lf(new ja(p,o,l,u)):Ua(_.errors)}class io{constructor(o,l,u,_){this.kind=o,this._styleExpression=l,this.isLightConstant=u,this.isLineProgressConstant=_,this.isStateDependent="constant"!==o&&!Wc(l.expression),this.configDependencies=Nu(l.expression)}evaluateWithoutErrorHandling(o,l,u,_,p,y){return this._styleExpression.evaluateWithoutErrorHandling(o,l,u,_,p,y)}evaluate(o,l,u,_,p,y){return this._styleExpression.evaluate(o,l,u,_,p,y)}}class Kc{constructor(o,l,u,_,p,y){this.kind=o,this.zoomStops=u,this._styleExpression=l,this.isStateDependent="camera"!==o&&!Wc(l.expression),this.isLightConstant=p,this.isLineProgressConstant=y,this.configDependencies=Nu(l.expression),this.interpolationType=_}evaluateWithoutErrorHandling(o,l,u,_,p,y){return this._styleExpression.evaluateWithoutErrorHandling(o,l,u,_,p,y)}evaluate(o,l,u,_,p,y){return this._styleExpression.evaluate(o,l,u,_,p,y)}interpolationFactor(o,l,u){return this.interpolationType?Jo.interpolationFactor(this.interpolationType,o,l,u):0}}function go(d,o,l,u){if("error"===(d=_c(d,o,l,u)).result)return d;const _=d.value.expression,p=_p(_);if(!p&&!hl(o))return Ua([new Al("","data expressions not supported")]);const y=Pl(_,["zoom","pitch","distance-from-center"]);if(!y&&!gc(o))return Ua([new Al("","zoom expressions not supported")]);const T=Pl(_,["measure-light"]);if(!T&&!Vu(o))return Ua([new Al("","measure-light expression not supported")]);const E=Pl(_,["line-progress"]);if(!E&&!Ur(o.expression,"line-progress"))return Ua([new Al("","line-progress expression not supported")]);const R=o.expression&&o.expression.relaxZoomRestriction,w=df(_);return w||y||R?w instanceof Al?Ua([w]):w instanceof Jo&&!Yc(o)?Ua([new Al("",'"interpolate" expressions cannot be used with this property')]):lf(w?new Kc(p&&E?"camera":"composite",d.value,w.labels,w instanceof Jo?w.interpolation:void 0,T,E):new io(p&&E?"constant":"source",d.value,T,E)):Ua([new Al("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Io{constructor(o,l){this._parameters=o,this._specification=l,$_(this,bp(this._parameters,this._specification))}static deserialize(o){return new Io(o._parameters,o._specification)}static serialize(o){return{_parameters:o._parameters,_specification:o._specification}}}function df(d){let o=null;if(d instanceof Do)o=df(d.result);else if(d instanceof dg){for(const l of d.args)if(o=df(l),o)break}else(d instanceof Rd||d instanceof Jo)&&d.input instanceof za&&"zoom"===d.input.name&&(o=d);return o instanceof Al||d.eachChild(l=>{const u=df(l);u instanceof Al?o=u:o&&u&&o!==u&&(o=new Al("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),o}var Ll,xp,Nl=function(){if(xp)return Ll;xp=1,Ll=o;var d=3;function o(l,u,_){var p=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var y=new Int32Array(this.arrayBuffer);l=y[0],this.d=(u=y[1])+2*(_=y[2]);for(var T=0;T<this.d*this.d;T++){var E=y[d+T],R=y[d+T+1];p.push(E===R?null:y.subarray(E,R))}var w=y[d+p.length+1];this.keys=y.subarray(y[d+p.length],w),this.bboxes=y.subarray(w),this.insert=this._insertReadonly}else{this.d=u+2*_;for(var D=0;D<this.d*this.d;D++)p.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=l,this.padding=_,this.scale=u/l,this.uid=0;var k=_/u*l;this.min=-k,this.max=l+k}return o.prototype.insert=function(l,u,_,p,y){this._forEachCell(u,_,p,y,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(u),this.bboxes.push(_),this.bboxes.push(p),this.bboxes.push(y)},o.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},o.prototype._insertCell=function(l,u,_,p,y,T){this.cells[y].push(T)},o.prototype.query=function(l,u,_,p,y){var T=this.min,E=this.max;if(l<=T&&u<=T&&E<=_&&E<=p&&!y)return Array.prototype.slice.call(this.keys);var R=[];return this._forEachCell(l,u,_,p,this._queryCell,R,{},y),R},o.prototype._queryCell=function(l,u,_,p,y,T,E,R){var w=this.cells[y];if(null!==w)for(var D=this.keys,k=this.bboxes,S=0;S<w.length;S++){var I=w[S];if(void 0===E[I]){var O=4*I;(R?R(k[O+0],k[O+1],k[O+2],k[O+3]):l<=k[O+2]&&u<=k[O+3]&&_>=k[O+0]&&p>=k[O+1])?(E[I]=!0,T.push(D[I])):E[I]=!1}}},o.prototype._forEachCell=function(l,u,_,p,y,T,E,R){for(var w=this._convertToCellCoord(l),D=this._convertToCellCoord(u),k=this._convertToCellCoord(_),S=this._convertToCellCoord(p),I=w;I<=k;I++)for(var O=D;O<=S;O++){var B=this.d*O+I;if((!R||R(this._convertFromCellCoord(I),this._convertFromCellCoord(O),this._convertFromCellCoord(I+1),this._convertFromCellCoord(O+1)))&&y.call(this,l,u,_,p,B,T,E,R))return}},o.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},o.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},o.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,u=d+this.cells.length+1+1,_=0,p=0;p<this.cells.length;p++)_+=this.cells[p].length;var y=new Int32Array(u+_+this.keys.length+this.bboxes.length);y[0]=this.extent,y[1]=this.n,y[2]=this.padding;for(var T=u,E=0;E<l.length;E++){var R=l[E];y[d+E]=T,y.set(R,T),T+=R.length}return y[d+l.length]=T,y.set(this.keys,T),y[d+l.length+1]=T+=this.keys.length,y.set(this.bboxes,T),T+=this.bboxes.length,y.buffer},Ll}(),zl=To(Nl);const uf={};function Zt(d,o,l={}){Object.defineProperty(d,"_classRegistryKey",{value:o,writable:!1}),uf[o]={klass:d,omit:l.omit||[]}}Zt(Object,"Object"),zl.serialize=function(d,o){const l=d.toArrayBuffer();return o&&o.add(l),{buffer:l}},zl.deserialize=function(d){return new zl(d.buffer)},Object.defineProperty(zl,"name",{value:"Grid"}),Zt(zl,"Grid"),typeof DOMMatrix<"u"&&Zt(DOMMatrix,"DOMMatrix"),Zt(ki,"Color"),Zt(Error,"Error"),Zt(Xo,"Formatted"),Zt(hp,"FormattedSection"),Zt(B_,"AJAXError"),Zt(Ko,"ResolvedImage"),Zt(Io,"StylePropertyFunction"),Zt(ja,"StyleExpression",{omit:["_evaluator"]}),Zt($c,"ImageIdWithOptions"),Zt(Kc,"ZoomDependentExpression"),Zt(io,"ZoomConstantExpression"),Zt(za,"CompoundExpression",{omit:["_evaluate"]});for(const d in Ol)uf[Ol[d]._classRegistryKey]||Zt(Ol[d],`Expression${d}`);function pg(d){return d&&typeof ArrayBuffer<"u"&&(d instanceof ArrayBuffer||d.constructor&&"ArrayBuffer"===d.constructor.name)}function Ld(d){return self.ImageBitmap&&d instanceof ImageBitmap}function ju(d,o){if(null==d||"boolean"==typeof d||"number"==typeof d||"string"==typeof d||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp)return d;if(pg(d)||Ld(d))return o&&o.add(d),d;if(ArrayBuffer.isView(d))return o&&o.add(d.buffer),d;if(d instanceof ImageData)return o&&o.add(d.data.buffer),d;if(Array.isArray(d)){const l=[];for(const u of d)l.push(ju(u,o));return l}if(d instanceof Map){const l={$name:"Map"};for(const[u,_]of d.entries())l[u]=ju(_);return l}if(d instanceof Set){const l={$name:"Set"};let u=0;for(const _ of d.values())l[++u]=ju(_);return l}if("object"==typeof d){const l=d.constructor,u=l._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${u}".`);const _=l.serialize?l.serialize(d,o):{};if(!l.serialize){for(const p in d)d.hasOwnProperty(p)&&(uf[u].omit.indexOf(p)>=0||(_[p]=ju(d[p],o)));d instanceof Error&&(_.message=d.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==u&&(_.$name=u),_}throw new Error("can't serialize object of type "+typeof d)}function Qc(d){if(null==d||"boolean"==typeof d||"number"==typeof d||"string"==typeof d||d instanceof Boolean||d instanceof Number||d instanceof String||d instanceof Date||d instanceof RegExp||pg(d)||Ld(d)||ArrayBuffer.isView(d)||d instanceof ImageData)return d;if(Array.isArray(d))return d.map(Qc);if("object"==typeof d){const o=d.$name||"Object";if("Map"===o){const _=new Map;for(const p of Object.keys(d))"$name"!==p&&_.set(p,Qc(d[p]));return _}if("Set"===o){const _=new Set;for(const p of Object.keys(d))"$name"!==p&&_.add(Qc(d[p]));return _}const{klass:l}=uf[o];if(!l)throw new Error(`Can't deserialize unregistered class "${o}".`);if(l.deserialize)return l.deserialize(d);const u=Object.create(l.prototype);for(const _ of Object.keys(d))"$name"!==_&&(u[_]=Qc(d[_]));return u}throw new Error("can't deserialize object of type "+typeof d)}const rn_Latin_1_Supplement=d=>d>=128&&d<=255,rn_Arabic=d=>d>=1536&&d<=1791,rn_Arabic_Supplement=d=>d>=1872&&d<=1919,rn_Arabic_Extended_A=d=>d>=2208&&d<=2303,rn_Hangul_Jamo=d=>d>=4352&&d<=4607,rn_Unified_Canadian_Aboriginal_Syllabics=d=>d>=5120&&d<=5759,rn_Khmer=d=>d>=6016&&d<=6143,rn_Unified_Canadian_Aboriginal_Syllabics_Extended=d=>d>=6320&&d<=6399,rn_General_Punctuation=d=>d>=8192&&d<=8303,rn_Letterlike_Symbols=d=>d>=8448&&d<=8527,rn_Number_Forms=d=>d>=8528&&d<=8591,rn_Miscellaneous_Technical=d=>d>=8960&&d<=9215,rn_Control_Pictures=d=>d>=9216&&d<=9279,rn_Optical_Character_Recognition=d=>d>=9280&&d<=9311,rn_Enclosed_Alphanumerics=d=>d>=9312&&d<=9471,rn_Geometric_Shapes=d=>d>=9632&&d<=9727,rn_Miscellaneous_Symbols=d=>d>=9728&&d<=9983,rn_Miscellaneous_Symbols_and_Arrows=d=>d>=11008&&d<=11263,rn_CJK_Radicals_Supplement=d=>d>=11904&&d<=12031,rn_Kangxi_Radicals=d=>d>=12032&&d<=12255,rn_Ideographic_Description_Characters=d=>d>=12272&&d<=12287,rn_CJK_Symbols_and_Punctuation=d=>d>=12288&&d<=12351,rn_Hiragana=d=>d>=12352&&d<=12447,rn_Katakana=d=>d>=12448&&d<=12543,rn_Bopomofo=d=>d>=12544&&d<=12591,rn_Hangul_Compatibility_Jamo=d=>d>=12592&&d<=12687,rn_Kanbun=d=>d>=12688&&d<=12703,rn_Bopomofo_Extended=d=>d>=12704&&d<=12735,rn_CJK_Strokes=d=>d>=12736&&d<=12783,rn_Katakana_Phonetic_Extensions=d=>d>=12784&&d<=12799,rn_Enclosed_CJK_Letters_and_Months=d=>d>=12800&&d<=13055,rn_CJK_Compatibility=d=>d>=13056&&d<=13311,rn_CJK_Unified_Ideographs_Extension_A=d=>d>=13312&&d<=19903,rn_Yijing_Hexagram_Symbols=d=>d>=19904&&d<=19967,rn_CJK_Unified_Ideographs=d=>d>=19968&&d<=40959,rn_Yi_Syllables=d=>d>=40960&&d<=42127,rn_Yi_Radicals=d=>d>=42128&&d<=42191,rn_Hangul_Jamo_Extended_A=d=>d>=43360&&d<=43391,rn_Hangul_Syllables=d=>d>=44032&&d<=55215,rn_Hangul_Jamo_Extended_B=d=>d>=55216&&d<=55295,rn_Private_Use_Area=d=>d>=57344&&d<=63743,rn_CJK_Compatibility_Ideographs=d=>d>=63744&&d<=64255,rn_Arabic_Presentation_Forms_A=d=>d>=64336&&d<=65023,rn_Vertical_Forms=d=>d>=65040&&d<=65055,rn_CJK_Compatibility_Forms=d=>d>=65072&&d<=65103,rn_Small_Form_Variants=d=>d>=65104&&d<=65135,rn_Arabic_Presentation_Forms_B=d=>d>=65136&&d<=65279,rn_Halfwidth_and_Fullwidth_Forms=d=>d>=65280&&d<=65519,rn_Osage=d=>d>=66736&&d<=66815,rn_CJK_Unified_Ideographs_Extension_B=d=>d>=131072&&d<=173791;function ty(d){for(const o of d)if(ny(o.charCodeAt(0)))return!0;return!1}function mw(d){for(const o of d)if(!gw(o.charCodeAt(0)))return!1;return!0}function gw(d){return!(rn_Arabic(d)||rn_Arabic_Supplement(d)||rn_Arabic_Extended_A(d)||rn_Arabic_Presentation_Forms_A(d)||rn_Arabic_Presentation_Forms_B(d))}function ny(d){return!(746!==d&&747!==d&&(d<4352||!(rn_Bopomofo_Extended(d)||rn_Bopomofo(d)||rn_CJK_Compatibility_Forms(d)&&!(d>=65097&&d<=65103)||rn_CJK_Compatibility_Ideographs(d)||rn_CJK_Compatibility(d)||rn_CJK_Radicals_Supplement(d)||rn_CJK_Strokes(d)||!(!rn_CJK_Symbols_and_Punctuation(d)||d>=12296&&d<=12305||d>=12308&&d<=12319||12336===d)||rn_CJK_Unified_Ideographs_Extension_A(d)||rn_CJK_Unified_Ideographs(d)||rn_Enclosed_CJK_Letters_and_Months(d)||rn_Hangul_Compatibility_Jamo(d)||rn_Hangul_Jamo_Extended_A(d)||rn_Hangul_Jamo_Extended_B(d)||rn_Hangul_Jamo(d)||rn_Hangul_Syllables(d)||rn_Hiragana(d)||rn_Ideographic_Description_Characters(d)||rn_Kanbun(d)||rn_Kangxi_Radicals(d)||rn_Katakana_Phonetic_Extensions(d)||rn_Katakana(d)&&12540!==d||!(!rn_Halfwidth_and_Fullwidth_Forms(d)||65288===d||65289===d||65293===d||d>=65306&&d<=65310||65339===d||65341===d||65343===d||d>=65371&&d<=65503||65507===d||d>=65512&&d<=65519)||!(!rn_Small_Form_Variants(d)||d>=65112&&d<=65118||d>=65123&&d<=65126)||rn_Unified_Canadian_Aboriginal_Syllabics(d)||rn_Unified_Canadian_Aboriginal_Syllabics_Extended(d)||rn_Vertical_Forms(d)||rn_Yijing_Hexagram_Symbols(d)||rn_Yi_Syllables(d)||rn_Yi_Radicals(d))))}function iy(d){return!(ny(d)||(o=d,rn_Latin_1_Supplement(o)&&(167===o||169===o||174===o||177===o||188===o||189===o||190===o||215===o||247===o)||rn_General_Punctuation(o)&&(8214===o||8224===o||8225===o||8240===o||8241===o||8251===o||8252===o||8258===o||8263===o||8264===o||8265===o||8273===o)||rn_Letterlike_Symbols(o)||rn_Number_Forms(o)||rn_Miscellaneous_Technical(o)&&(o>=8960&&o<=8967||o>=8972&&o<=8991||o>=8996&&o<=9e3||9003===o||o>=9085&&o<=9114||o>=9150&&o<=9165||9167===o||o>=9169&&o<=9179||o>=9186&&o<=9215)||rn_Control_Pictures(o)&&9251!==o||rn_Optical_Character_Recognition(o)||rn_Enclosed_Alphanumerics(o)||rn_Geometric_Shapes(o)||rn_Miscellaneous_Symbols(o)&&!(o>=9754&&o<=9759)||rn_Miscellaneous_Symbols_and_Arrows(o)&&(o>=11026&&o<=11055||o>=11088&&o<=11097||o>=11192&&o<=11243)||rn_CJK_Symbols_and_Punctuation(o)||rn_Katakana(o)||rn_Private_Use_Area(o)||rn_CJK_Compatibility_Forms(o)||rn_Small_Form_Variants(o)||rn_Halfwidth_and_Fullwidth_Forms(o)||8734===o||8756===o||8757===o||o>=9984&&o<=10087||o>=10102&&o<=10131||65532===o||65533===o));var o}function ry(d){return d>=1424&&d<=2303||rn_Arabic_Presentation_Forms_A(d)||rn_Arabic_Presentation_Forms_B(d)}function _w(d,o){return!(!o&&ry(d)||d>=2304&&d<=3583||d>=3840&&d<=4255||rn_Khmer(d))}function RT(d){for(const o of d)if(ry(o.charCodeAt(0)))return!0;return!1}const oy="deferred",Tb="loading",Mb="loaded";let wp=null,ea="unavailable",yc=null;const Sb=function(d){d&&"string"==typeof d&&d.indexOf("NetworkError")>-1&&(ea="error"),wp&&wp(d)};function Cp(){sy.fire(new Ks("pluginStateChange",{pluginStatus:ea,pluginURL:yc}))}const sy=new up,ay=function(){return ea},ly=function(){if(ea!==oy||!yc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ea=Tb,Cp(),yc&&Hh({url:yc},d=>{d?Sb(d):(ea=Mb,Cp())})},sr={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ea===Mb||null!=sr.applyArabicShaping,isLoading:()=>ea===Tb,setState(d){ea=d.pluginStatus,yc=d.pluginURL},isParsed:()=>null!=sr.applyArabicShaping&&null!=sr.processBidirectionalText&&null!=sr.processStyledBidirectionalText,getPluginURL:()=>yc};class _r{constructor(o,l){this.zoom=o,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(o){return function(l,u){for(const _ of l)if(!_w(_.charCodeAt(0),u))return!1;return!0}(o,sr.isLoaded())}}class Tp{constructor(o,l,u,_){this.property=o,this.value=l,this.expression=function(p,y,T,E){if(vp(p))return new Io(p,y);if(cf(p)||Array.isArray(p)&&p.length>0){const R=go(p,y,T,E);if("error"===R.result)throw new Error(R.value.map(w=>`${w.key}: ${w.message}`).join(", "));return R.value}{let R=p;return"string"==typeof p&&"color"===y.type&&(R=ki.parse(p)),{kind:"constant",configDependencies:new Set,evaluate:()=>R}}}(void 0===l?o.specification.default:l,o.specification,u,_)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(o,l,u){return this.property.possiblyEvaluate(this,o,l,u)}}class hf{constructor(o,l,u){this.property=o,this.value=new Tp(o,void 0,l,u)}transitioned(o,l){return new cy(this.property,this.value,l,$o({},o.transition,this.transition),o.now)}untransitioned(){return new cy(this.property,this.value,null,{},0)}}class Nd{constructor(o,l,u){this._properties=o,this._values=Object.create(o.defaultTransitionablePropertyValues),this._scope=l,this._options=u,this.configDependencies=new Set}getValue(o){return Ws(this._values[o].value.value)}setValue(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new hf(this._values[o].property,this._scope,this._options)),this._values[o].value=new Tp(this._values[o].property,null===l?void 0:Ws(l),this._scope,this._options),this._values[o].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].value.expression.configDependencies]))}setTransitionOrValue(o,l){l&&(this._options=l);const u=this._properties.properties;if(o)for(const _ in o){const p=o[_];if(Uc(_,"-transition")){const y=_.slice(0,-11);u[y]&&this.setTransition(y,p)}else u.hasOwnProperty(_)&&this.setValue(_,p)}}getTransition(o){return Ws(this._values[o].transition)}setTransition(o,l){this._values.hasOwnProperty(o)||(this._values[o]=new hf(this._values[o].property)),this._values[o].transition=Ws(l)||void 0}serialize(){const o={};for(const l of Object.keys(this._values)){const u=this.getValue(l);void 0!==u&&(o[l]=u);const _=this.getTransition(l);void 0!==_&&(o[`${l}-transition`]=_)}return o}transitioned(o,l){const u=new Eb(this._properties);for(const _ of Object.keys(this._values))u._values[_]=this._values[_].transitioned(o,l._values[_]);return u}untransitioned(){const o=new Eb(this._properties);for(const l of Object.keys(this._values))o._values[l]=this._values[l].untransitioned();return o}}class cy{constructor(o,l,u,_,p){const y=_.delay||0,T=_.duration||0;p=p||0,this.property=o,this.value=l,this.begin=p+y,this.end=this.begin+T,o.specification.transition&&(_.delay||_.duration)&&(this.prior=u)}possiblyEvaluate(o,l,u){const _=o.now||0,p=this.value.possiblyEvaluate(o,l,u),y=this.prior;if(y){if(_>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(_<this.begin)return y.possiblyEvaluate(o,l,u);{const T=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(o,l,u),p,Vc(T))}}return p}}class Eb{constructor(o){this._properties=o,this._values=Object.create(o.defaultTransitioningPropertyValues)}possiblyEvaluate(o,l,u){const _=new ta(this._properties);for(const p of Object.keys(this._values))_._values[p]=this._values[p].possiblyEvaluate(o,l,u);return _}hasTransition(){for(const o of Object.keys(this._values))if(this._values[o].prior)return!0;return!1}}class dy{constructor(o,l,u){this._properties=o,this._values=Object.create(o.defaultPropertyValues),this._scope=l,this._options=u,this.configDependencies=new Set}getValue(o){return Ws(this._values[o].value)}setValue(o,l){this._values[o]=new Tp(this._values[o].property,null===l?void 0:Ws(l),this._scope,this._options),this._values[o].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[o].expression.configDependencies]))}serialize(){const o={};for(const l of Object.keys(this._values)){const u=this.getValue(l);void 0!==u&&(o[l]=u)}return o}possiblyEvaluate(o,l,u){const _=new ta(this._properties);for(const p of Object.keys(this._values))_._values[p]=this._values[p].possiblyEvaluate(o,l,u);return _}}class ff{constructor(o,l,u){this.property=o,this.value=l,this.parameters=u}isConstant(){return"constant"===this.value.kind}constantOr(o){return"constant"===this.value.kind?this.value.value:o}evaluate(o,l,u,_){return this.property.evaluate(this.value,this.parameters,o,l,u,_)}}class ta{constructor(o){this._properties=o,this._values=Object.create(o.defaultPossiblyEvaluatedValues)}get(o){return this._values[o]}}class wt{constructor(o){this.specification=o}possiblyEvaluate(o,l){return o.expression.evaluate(l)}interpolate(o,l,u){const _=Ei[this.specification.type];return _?_(o,l,u):o}}class jt{constructor(o,l){this.specification=o,this.overrides=l}possiblyEvaluate(o,l,u,_){return new ff(this,"constant"===o.expression.kind||"camera"===o.expression.kind?{kind:"constant",value:o.expression.evaluate(l,null,{},u,_)}:o.expression,l)}interpolate(o,l,u){if("constant"!==o.value.kind||"constant"!==l.value.kind)return o;if(void 0===o.value.value||void 0===l.value.value)return new ff(this,{kind:"constant",value:void 0},o.parameters);const _=Ei[this.specification.type];return _?new ff(this,{kind:"constant",value:_(o.value.value,l.value.value,u)},o.parameters):o}evaluate(o,l,u,_,p,y){return"constant"===o.kind?o.value:o.evaluate(l,u,_,p,y)}}class Ki{constructor(o){this.specification=o}possiblyEvaluate(o,l,u,_){return!!o.expression.evaluate(l,null,{},u,_)}interpolate(){return!1}}class Pr{constructor(o){this.properties=o,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new _r(0,{});for(const u in o){const _=o[u];_.specification.overridable&&this.overridableProperties.push(u);const p=this.defaultPropertyValues[u]=new Tp(_,void 0),y=this.defaultTransitionablePropertyValues[u]=new hf(_);this.defaultTransitioningPropertyValues[u]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=p.possiblyEvaluate(l)}}}Zt(jt,"DataDrivenProperty"),Zt(wt,"DataConstantProperty"),Zt(Ki,"ColorRampProperty");var Ge=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ps(d){return d instanceof Number||d instanceof String||d instanceof Boolean?d.valueOf():d}function mg(d){if(Array.isArray(d))return d.map(mg);if(d instanceof Object&&!(d instanceof Number||d instanceof String||d instanceof Boolean)){const o={};for(const l in d)o[l]=mg(d[l]);return o}return Ps(d)}function zd(d){if(!0===d||!1===d)return!0;if(!Array.isArray(d)||0===d.length)return!1;switch(d[0]){case"has":return d.length>=2&&"$id"!==d[1]&&"$type"!==d[1];case"in":return d.length>=3&&("string"!=typeof d[1]||Array.isArray(d[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==d.length||Array.isArray(d[1])||Array.isArray(d[2]);case"any":case"all":for(const o of d.slice(1))if(!zd(o)&&"boolean"!=typeof o)return!1;return!0;default:return!0}}function Bd(d,o="",l=null,u="fill"){if(null==d)return{filter:()=>!0,needGeometry:!1,needFeature:!1};zd(d)||(d=Hu(d));const _=d;let p=!0;try{p=function(w){if(!Vd(w))return w;let D=mg(w);return Db(D),D=Ta(D),D}(_)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(_,null,2)}\n        `)}let y=null,T=null;if("background"!==u&&"sky"!==u&&"slot"!==u){T=Ge[`filter_${u}`];const w=_c(p,T,o,l);if("error"===w.result)throw new Error(w.value.map(D=>`${D.key}: ${D.message}`).join(", "));y=(D,k,S)=>w.value.evaluate(D,k,{},S)}let E=null,R=null;if(p!==_){const w=_c(_,T,o,l);if("error"===w.result)throw new Error(w.value.map(D=>`${D.key}: ${D.message}`).join(", "));E=(D,k,S,I,O)=>w.value.evaluate(D,k,{},S,void 0,void 0,I,O),R=!_p(w.value.expression)}return{filter:y,dynamicFilter:E||void 0,needGeometry:gg(p),needFeature:!!R}}function Ta(d){if(!Array.isArray(d))return d;const o=function(l){if(yw.has(l[0]))for(let u=1;u<l.length;u++)if(Vd(l[u]))return!0;return l}(d);return!0===o?o:o.map(l=>Ta(l))}function Db(d){let o=!1;const l=[];if("case"===d[0]){for(let u=1;u<d.length-1;u+=2)o=o||Vd(d[u]),l.push(d[u+1]);l.push(d[d.length-1])}else if("match"===d[0]){o=o||Vd(d[1]);for(let u=2;u<d.length-1;u+=2)l.push(d[u+1]);l.push(d[d.length-1])}else if("step"===d[0]){o=o||Vd(d[1]);for(let u=1;u<d.length-1;u+=2)l.push(d[u+1])}o&&(d.length=0,d.push("any",...l));for(let u=1;u<d.length;u++)Db(d[u])}function Vd(d){if(!Array.isArray(d))return!1;if("pitch"===(o=d[0])||"distance-from-center"===o)return!0;var o;for(let l=1;l<d.length;l++)if(Vd(d[l]))return!0;return!1}const yw=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ws(d,o){return d<o?-1:d>o?1:0}function gg(d){if(!Array.isArray(d))return!1;if("within"===d[0]||"distance"===d[0])return!0;for(let o=1;o<d.length;o++)if(gg(d[o]))return!0;return!1}function Hu(d){if(!d)return!0;const o=d[0];return d.length<=1?"any"!==o:"=="===o?$u(d[1],d[2],"=="):"!="===o?na($u(d[1],d[2],"==")):"<"===o||">"===o||"<="===o||">="===o?$u(d[1],d[2],o):"any"===o?(l=d.slice(1),["any"].concat(l.map(Hu))):"all"===o?["all"].concat(d.slice(1).map(Hu)):"none"===o?["all"].concat(d.slice(1).map(Hu).map(na)):"in"===o?Mp(d[1],d.slice(2)):"!in"===o?na(Mp(d[1],d.slice(2))):"has"===o?_g(d[1]):"!has"!==o||na(_g(d[1]));var l}function $u(d,o,l){switch(d){case"$type":return[`filter-type-${l}`,o];case"$id":return[`filter-id-${l}`,o];default:return[`filter-${l}`,d,o]}}function Mp(d,o){if(0===o.length)return!1;switch(d){case"$type":return["filter-type-in",["literal",o]];case"$id":return["filter-id-in",["literal",o]];default:return o.length>200&&!o.some(l=>typeof l!=typeof o[0])?["filter-in-large",d,["literal",o.sort(ws)]]:["filter-in-small",d,["literal",o]]}}function _g(d){switch(d){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",d]}}function na(d){return["!",d]}function Cs(d,o){return o?`${d}\x1f${o}`:d}const vc="-transition",wi=new Set(["fill","line","background","hillshade","raster"]);class ds extends up{constructor(o,l,u,_,p){if(super(),this.id=o.id,this.fqid=Cs(this.id,u),this.type=o.type,this.scope=u,this.lut=_,this.options=p,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,"custom"!==o.type){if(this.metadata=o.metadata,this.minzoom=o.minzoom,this.maxzoom=o.maxzoom,o.type&&"background"!==o.type&&"sky"!==o.type&&"slot"!==o.type){this.source=o.source,this.sourceLayer=o["source-layer"],this.filter=o.filter;const y=_c(this.filter,Ge[`filter_${o.type}`]);"error"!==y.result&&(this.configDependencies=new Set([...this.configDependencies,...y.value.configDependencies]))}if(o.slot&&(this.slot=o.slot),l.layout&&(this._unevaluatedLayout=new dy(l.layout,this.scope,p),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new Nd(l.paint,this.scope,p);for(const y in o.paint)this.setPaintProperty(y,o.paint[y]);for(const y in o.layout)this.setLayoutProperty(y,o.layout[y]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ta(l.paint)}}}onAdd(o){}onRemove(o){}isDraped(o){return!this.is3D()&&wi.has(this.type)}getLayoutProperty(o){return"visibility"===o?this.visibility:this._unevaluatedLayout.getValue(o)}setLayoutProperty(o,l){if("custom"===this.type&&"visibility"===o)return void(this.visibility=l);const u=this._unevaluatedLayout;u._properties.properties[o]&&(u.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),"visibility"===o&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(o){return Uc(o,vc)?this._transitionablePaint.getTransition(o.slice(0,-11)):this._transitionablePaint.getValue(o)}setPaintProperty(o,l){const u=this._transitionablePaint,_=u._properties.properties;if(Uc(o,vc)){const D=o.slice(0,-11);return _[D]&&u.setTransition(D,l||void 0),!1}if(!_[o])return!1;const p=u._values[o],y=p.value.isDataDriven(),T=p.value;u.setValue(o,l),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(o);const E=u._values[o].value,R=E.isDataDriven(),w=Uc(o,"pattern")||"line-dasharray"===o;return R||y||w||this._handleOverridablePaintPropertyUpdate(o,T,E)}_handleSpecialPaintPropertyUpdate(o){}getProgramIds(){return null}getDefaultProgramParams(o,l,u){return null}_handleOverridablePaintPropertyUpdate(o,l,u){return!1}isHidden(o){return!!(this.minzoom&&o<this.minzoom)||!!(this.maxzoom&&o>=this.maxzoom)||"none"===this.visibility}updateTransitions(o){this._transitioningPaint=this._transitionablePaint.transitioned(o,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(o,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(o,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(o,void 0,l)}serialize(){return il({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(o,l)=>!(void 0===o||"layout"===l&&!Object.keys(o).length||"paint"===l&&!Object.keys(o).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const o in this.paint._values){const l=this.paint.get(o);if(l instanceof ff&&hl(l.property.specification)&&("source"===l.value.kind||"composite"===l.value.kind)&&l.value.isStateDependent)return!0}return!1}compileFilter(o){this._filterCompiled||(this._featureFilter=Bd(this.filter,this.scope,o),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(o){this._stats&&("shadow"===o.renderPass?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(o){}queryIntersectsFeature(o,l,u,_,p,y,T,E,R){}}const uy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Gu{constructor(o,l){this._structArray=o,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class yr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(o,l){return o._trim(),l&&(o.isTransferred=!0,l.add(o.arrayBuffer)),{length:o.length,arrayBuffer:o.arrayBuffer}}static deserialize(o){const l=Object.create(this.prototype);return l.arrayBuffer=o.arrayBuffer,l.length=o.length,l.capacity=o.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(o){this.reserve(o),this.length=o}reserve(o){if(o>this.capacity){this.capacity=Math.max(o,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...o){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...o){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ri(d,o=1){let l=0,u=0;return{members:d.map(_=>{const p=uy[_.type].BYTES_PER_ELEMENT,y=l=Sp(l,Math.max(o,p)),T=_.components||1;return u=Math.max(u,p),l+=p*T,{name:_.name,type:_.type,components:T,offset:y}}),size:Sp(l,Math.max(u,o)),alignment:o}}function Sp(d,o){return Math.ceil(d/o)*o}class Jc extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l){const u=this.length;return this.resize(u+1),this.emplace(u,o,l)}emplace(o,l,u){const _=2*o;return this.int16[_+0]=l,this.int16[_+1]=u,o}}Jc.prototype.bytesPerElement=4,Zt(Jc,"StructArrayLayout2i4");class qu extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,u)}emplace(o,l,u,_){const p=3*o;return this.int16[p+0]=l,this.int16[p+1]=u,this.int16[p+2]=_,o}}qu.prototype.bytesPerElement=6,Zt(qu,"StructArrayLayout3i6");class fl extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,_){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,u,_)}emplace(o,l,u,_,p){const y=4*o;return this.int16[y+0]=l,this.int16[y+1]=u,this.int16[y+2]=_,this.int16[y+3]=p,o}}fl.prototype.bytesPerElement=8,Zt(fl,"StructArrayLayout4i8");class pl extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,u,_,p)}emplace(o,l,u,_,p,y){const T=5*o;return this.int16[T+0]=l,this.int16[T+1]=u,this.int16[T+2]=_,this.int16[T+3]=p,this.int16[T+4]=y,o}}pl.prototype.bytesPerElement=10,Zt(pl,"StructArrayLayout5i10");class hy extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,u,_,p,y,T)}emplace(o,l,u,_,p,y,T,E){const R=6*o,w=12*o,D=3*o;return this.int16[R+0]=l,this.int16[R+1]=u,this.uint8[w+4]=_,this.uint8[w+5]=p,this.uint8[w+6]=y,this.uint8[w+7]=T,this.float32[D+2]=E,o}}hy.prototype.bytesPerElement=12,Zt(hy,"StructArrayLayout2i4ub1f12");class ed extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,u,_)}emplace(o,l,u,_,p){const y=4*o;return this.float32[y+0]=l,this.float32[y+1]=u,this.float32[y+2]=_,this.float32[y+3]=p,o}}ed.prototype.bytesPerElement=16,Zt(ed,"StructArrayLayout4f16");class jd extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,u)}emplace(o,l,u,_){const p=3*o;return this.float32[p+0]=l,this.float32[p+1]=u,this.float32[p+2]=_,o}}jd.prototype.bytesPerElement=12,Zt(jd,"StructArrayLayout3f12");class Hd extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,u,_,p)}emplace(o,l,u,_,p,y){const T=6*o,E=3*o;return this.uint16[T+0]=l,this.uint16[T+1]=u,this.uint16[T+2]=_,this.uint16[T+3]=p,this.float32[E+2]=y,o}}Hd.prototype.bytesPerElement=12,Zt(Hd,"StructArrayLayout4ui1f12");class yt extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,_){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,u,_)}emplace(o,l,u,_,p){const y=4*o;return this.uint16[y+0]=l,this.uint16[y+1]=u,this.uint16[y+2]=_,this.uint16[y+3]=p,o}}yt.prototype.bytesPerElement=8,Zt(yt,"StructArrayLayout4ui8");class fi extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,o,l,u,_,p,y)}emplace(o,l,u,_,p,y,T){const E=6*o;return this.int16[E+0]=l,this.int16[E+1]=u,this.int16[E+2]=_,this.int16[E+3]=p,this.int16[E+4]=y,this.int16[E+5]=T,o}}fi.prototype.bytesPerElement=12,Zt(fi,"StructArrayLayout6i12");class Di extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T,E,R,w,D,k){const S=this.length;return this.resize(S+1),this.emplace(S,o,l,u,_,p,y,T,E,R,w,D,k)}emplace(o,l,u,_,p,y,T,E,R,w,D,k,S){const I=12*o;return this.int16[I+0]=l,this.int16[I+1]=u,this.int16[I+2]=_,this.int16[I+3]=p,this.uint16[I+4]=y,this.uint16[I+5]=T,this.uint16[I+6]=E,this.uint16[I+7]=R,this.int16[I+8]=w,this.int16[I+9]=D,this.int16[I+10]=k,this.int16[I+11]=S,o}}Di.prototype.bytesPerElement=24,Zt(Di,"StructArrayLayout4i4ui4i24");class Ii extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,o,l,u,_,p,y)}emplace(o,l,u,_,p,y,T){const E=10*o,R=5*o;return this.int16[E+0]=l,this.int16[E+1]=u,this.int16[E+2]=_,this.float32[R+2]=p,this.float32[R+3]=y,this.float32[R+4]=T,o}}Ii.prototype.bytesPerElement=20,Zt(Ii,"StructArrayLayout3i3f20");class Bi extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint32[1*o+0]=l,o}}Bi.prototype.bytesPerElement=4,Zt(Bi,"StructArrayLayout1ul4");class td extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l){const u=this.length;return this.resize(u+1),this.emplace(u,o,l)}emplace(o,l,u){const _=2*o;return this.uint16[_+0]=l,this.uint16[_+1]=u,o}}td.prototype.bytesPerElement=4,Zt(td,"StructArrayLayout2ui4");class Wu extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T,E,R,w,D,k,S){const I=this.length;return this.resize(I+1),this.emplace(I,o,l,u,_,p,y,T,E,R,w,D,k,S)}emplace(o,l,u,_,p,y,T,E,R,w,D,k,S,I){const O=20*o,B=10*o;return this.int16[O+0]=l,this.int16[O+1]=u,this.int16[O+2]=_,this.int16[O+3]=p,this.int16[O+4]=y,this.float32[B+3]=T,this.float32[B+4]=E,this.float32[B+5]=R,this.float32[B+6]=w,this.int16[O+14]=D,this.uint32[B+8]=k,this.uint16[O+18]=S,this.uint16[O+19]=I,o}}Wu.prototype.bytesPerElement=40,Zt(Wu,"StructArrayLayout5i4f1i1ul2ui40");class ia extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,u,_,p,y,T)}emplace(o,l,u,_,p,y,T,E){const R=8*o;return this.int16[R+0]=l,this.int16[R+1]=u,this.int16[R+2]=_,this.int16[R+4]=p,this.int16[R+5]=y,this.int16[R+6]=T,this.int16[R+7]=E,o}}ia.prototype.bytesPerElement=16,Zt(ia,"StructArrayLayout3i2i2i16");class Ep extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,u,_,p)}emplace(o,l,u,_,p,y){const T=4*o,E=8*o;return this.float32[T+0]=l,this.float32[T+1]=u,this.float32[T+2]=_,this.int16[E+6]=p,this.int16[E+7]=y,o}}Ep.prototype.bytesPerElement=16,Zt(Ep,"StructArrayLayout2f1f2i16");class Dp extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y){const T=this.length;return this.resize(T+1),this.emplace(T,o,l,u,_,p,y)}emplace(o,l,u,_,p,y,T){const E=20*o,R=5*o;return this.uint8[E+0]=l,this.uint8[E+1]=u,this.float32[R+1]=_,this.float32[R+2]=p,this.float32[R+3]=y,this.float32[R+4]=T,o}}Dp.prototype.bytesPerElement=20,Zt(Dp,"StructArrayLayout2ub4f20");class es extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u){const _=this.length;return this.resize(_+1),this.emplace(_,o,l,u)}emplace(o,l,u,_){const p=3*o;return this.uint16[p+0]=l,this.uint16[p+1]=u,this.uint16[p+2]=_,o}}es.prototype.bytesPerElement=6,Zt(es,"StructArrayLayout3ui6");class fy extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U,q,Z,$,Y){const K=this.length;return this.resize(K+1),this.emplace(K,o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U,q,Z,$,Y)}emplace(o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U,q,Z,$,Y,K){const ee=30*o,ue=15*o,de=60*o;return this.int16[ee+0]=l,this.int16[ee+1]=u,this.int16[ee+2]=_,this.float32[ue+2]=p,this.float32[ue+3]=y,this.uint16[ee+8]=T,this.uint16[ee+9]=E,this.uint32[ue+5]=R,this.uint32[ue+6]=w,this.uint32[ue+7]=D,this.uint16[ee+16]=k,this.uint16[ee+17]=S,this.uint16[ee+18]=I,this.float32[ue+10]=O,this.float32[ue+11]=B,this.uint8[de+48]=U,this.uint8[de+49]=q,this.uint8[de+50]=Z,this.uint32[ue+13]=$,this.int16[ee+28]=Y,this.uint8[de+58]=K,o}}fy.prototype.bytesPerElement=60,Zt(fy,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class py extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U,q,Z,$,Y,K,ee,ue,de,ce,we,fe,Te,ke,De,Pe){const Ne=this.length;return this.resize(Ne+1),this.emplace(Ne,o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U,q,Z,$,Y,K,ee,ue,de,ce,we,fe,Te,ke,De,Pe)}emplace(o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U,q,Z,$,Y,K,ee,ue,de,ce,we,fe,Te,ke,De,Pe,Ne){const je=20*o,Le=40*o,it=80*o;return this.float32[je+0]=l,this.float32[je+1]=u,this.int16[Le+4]=_,this.int16[Le+5]=p,this.int16[Le+6]=y,this.int16[Le+7]=T,this.int16[Le+8]=E,this.int16[Le+9]=R,this.int16[Le+10]=w,this.int16[Le+11]=D,this.int16[Le+12]=k,this.uint16[Le+13]=S,this.uint16[Le+14]=I,this.uint16[Le+15]=O,this.uint16[Le+16]=B,this.uint16[Le+17]=U,this.uint16[Le+18]=q,this.uint16[Le+19]=Z,this.uint16[Le+20]=$,this.uint16[Le+21]=Y,this.uint16[Le+22]=K,this.uint16[Le+23]=ee,this.uint16[Le+24]=ue,this.uint16[Le+25]=de,this.uint16[Le+26]=ce,this.uint16[Le+27]=we,this.uint32[je+14]=fe,this.float32[je+15]=Te,this.float32[je+16]=ke,this.float32[je+17]=De,this.float32[je+18]=Pe,this.uint8[it+76]=Ne,o}}py.prototype.bytesPerElement=80,Zt(py,"StructArrayLayout2f9i15ui1ul4f1ub80");class Ha extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.float32[1*o+0]=l,o}}Ha.prototype.bytesPerElement=4,Zt(Ha,"StructArrayLayout1f4");class nd extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p){const y=this.length;return this.resize(y+1),this.emplace(y,o,l,u,_,p)}emplace(o,l,u,_,p,y){const T=5*o;return this.float32[T+0]=l,this.float32[T+1]=u,this.float32[T+2]=_,this.float32[T+3]=p,this.float32[T+4]=y,o}}nd.prototype.bytesPerElement=20,Zt(nd,"StructArrayLayout5f20");class pf extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,u,_,p,y,T)}emplace(o,l,u,_,p,y,T,E){const R=7*o;return this.float32[R+0]=l,this.float32[R+1]=u,this.float32[R+2]=_,this.float32[R+3]=p,this.float32[R+4]=y,this.float32[R+5]=T,this.float32[R+6]=E,o}}pf.prototype.bytesPerElement=28,Zt(pf,"StructArrayLayout7f28");class Ts extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T,E,R,w,D){const k=this.length;return this.resize(k+1),this.emplace(k,o,l,u,_,p,y,T,E,R,w,D)}emplace(o,l,u,_,p,y,T,E,R,w,D,k){const S=11*o;return this.float32[S+0]=l,this.float32[S+1]=u,this.float32[S+2]=_,this.float32[S+3]=p,this.float32[S+4]=y,this.float32[S+5]=T,this.float32[S+6]=E,this.float32[S+7]=R,this.float32[S+8]=w,this.float32[S+9]=D,this.float32[S+10]=k,o}}Ts.prototype.bytesPerElement=44,Zt(Ts,"StructArrayLayout11f44");class Bl extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T,E,R){const w=this.length;return this.resize(w+1),this.emplace(w,o,l,u,_,p,y,T,E,R)}emplace(o,l,u,_,p,y,T,E,R,w){const D=9*o;return this.float32[D+0]=l,this.float32[D+1]=u,this.float32[D+2]=_,this.float32[D+3]=p,this.float32[D+4]=y,this.float32[D+5]=T,this.float32[D+6]=E,this.float32[D+7]=R,this.float32[D+8]=w,o}}Bl.prototype.bytesPerElement=36,Zt(Bl,"StructArrayLayout9f36");class bc extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l){const u=this.length;return this.resize(u+1),this.emplace(u,o,l)}emplace(o,l,u){const _=2*o;return this.float32[_+0]=l,this.float32[_+1]=u,o}}bc.prototype.bytesPerElement=8,Zt(bc,"StructArrayLayout2f8");class ra extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o,l,u,_){const p=this.length;return this.resize(p+1),this.emplace(p,o,l,u,_)}emplace(o,l,u,_,p){const y=6*o;return this.uint32[3*o+0]=l,this.uint16[y+2]=u,this.uint16[y+3]=_,this.uint16[y+4]=p,o}}ra.prototype.bytesPerElement=12,Zt(ra,"StructArrayLayout1ul3ui12");class Vl extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint16[1*o+0]=l,o}}Vl.prototype.bytesPerElement=2,Zt(Vl,"StructArrayLayout1ui2");class yg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B){const U=this.length;return this.resize(U+1),this.emplace(U,o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B)}emplace(o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U){const q=16*o;return this.float32[q+0]=l,this.float32[q+1]=u,this.float32[q+2]=_,this.float32[q+3]=p,this.float32[q+4]=y,this.float32[q+5]=T,this.float32[q+6]=E,this.float32[q+7]=R,this.float32[q+8]=w,this.float32[q+9]=D,this.float32[q+10]=k,this.float32[q+11]=S,this.float32[q+12]=I,this.float32[q+13]=O,this.float32[q+14]=B,this.float32[q+15]=U,o}}yg.prototype.bytesPerElement=64,Zt(yg,"StructArrayLayout16f64");class Ip extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(o,l,u,_,p,y,T){const E=this.length;return this.resize(E+1),this.emplace(E,o,l,u,_,p,y,T)}emplace(o,l,u,_,p,y,T,E){const R=10*o,w=5*o;return this.uint16[R+0]=l,this.uint16[R+1]=u,this.uint16[R+2]=_,this.uint16[R+3]=p,this.float32[w+2]=y,this.float32[w+3]=T,this.float32[w+4]=E,o}}Ip.prototype.bytesPerElement=20,Zt(Ip,"StructArrayLayout4ui3f20");class vg extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.int16[1*o+0]=l,o}}vg.prototype.bytesPerElement=2,Zt(vg,"StructArrayLayout1i2");class mf extends yr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(o){const l=this.length;return this.resize(l+1),this.emplace(l,o)}emplace(o,l){return this.uint8[1*o+0]=l,o}}mf.prototype.bytesPerElement=1,Zt(mf,"StructArrayLayout1ub1");class bg extends Gu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}bg.prototype.size=40;class xg extends Wu{get(o){return new bg(this,o)}}Zt(xg,"CollisionBoxArray");class wg extends Gu{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(o){this._structArray.uint8[this._pos1+49]=o}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(o){this._structArray.uint8[this._pos1+50]=o}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(o){this._structArray.uint32[this._pos4+13]=o}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(o){this._structArray.uint8[this._pos1+58]=o}}wg.prototype.size=60;class kp extends fy{get(o){return new wg(this,o)}}Zt(kp,"PlacedSymbolArray");class Ib extends Gu{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(o){this._structArray.uint32[this._pos4+14]=o}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(o){this._structArray.float32[this._pos4+18]=o}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}Ib.prototype.size=80;class gf extends py{get(o){return new Ib(this,o)}}Zt(gf,"SymbolInstanceArray");class Zu extends Ha{getoffsetX(o){return this.float32[1*o+0]}}Zt(Zu,"GlyphOffsetArray");class oa extends Jc{getx(o){return this.int16[2*o+0]}gety(o){return this.int16[2*o+1]}}Zt(oa,"SymbolLineVertexArray");class _f extends Gu{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}_f.prototype.size=12;class my extends ra{get(o){return new _f(this,o)}}Zt(my,"FeatureIndexArray");class gy extends td{geta_centroid_pos0(o){return this.uint16[2*o+0]}geta_centroid_pos1(o){return this.uint16[2*o+1]}}Zt(gy,"FillExtrusionCentroidArray");class Cg extends Gu{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Cg.prototype.size=6;class kb extends qu{get(o){return new Cg(this,o)}}Zt(kb,"FillExtrusionWallArray");const ts=Ri([{name:"a_pos",components:2,type:"Int16"}],4),Yu=Ri([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ni{constructor(o=[]){this.segments=o}_prepareSegment(o,l,u,_){let p=this.segments[this.segments.length-1];return o>ni.MAX_VERTEX_ARRAY_LENGTH&&Yn(`Max vertices per segment is ${ni.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${o}`),(!p||p.vertexLength+o>ni.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==_)&&(p={vertexOffset:l,primitiveOffset:u,vertexLength:0,primitiveLength:0},void 0!==_&&(p.sortKey=_),this.segments.push(p)),p}prepareSegment(o,l,u,_){return this._prepareSegment(o,l.length,u.length,_)}get(){return this.segments}destroy(){for(const o of this.segments)for(const l in o.vaos)o.vaos[l].destroy()}static simpleSegment(o,l,u,_){return new ni([{vertexOffset:o,primitiveOffset:l,vertexLength:u,primitiveLength:_,vaos:{},sortKey:0}])}}function Ma(d,o){return 256*(d=En(Math.floor(d),0,255))+En(Math.floor(o),0,255)}ni.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Zt(ni,"SegmentVector");const vw=Ri([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Xu=Ri([{name:"a_dash",components:4,type:"Uint16"}]);class Ap{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(o,l,u,_){this.ids.push(Tg(o)),this.positions.push(l,u,_)}eachPosition(o,l){const u=Tg(o);let _=0,p=this.ids.length-1;for(;_<p;){const y=_+p>>1;this.ids[y]>=u?p=y:_=y+1}for(;this.ids[_]===u;)l(this.positions[3*_],this.positions[3*_+1],this.positions[3*_+2]),_++}static serialize(o,l){const u=new Float64Array(o.ids),_=new Uint32Array(o.positions);return Rp(u,_,0,u.length-1),l&&(l.add(u.buffer),l.add(_.buffer)),{ids:u,positions:_}}static deserialize(o){const l=new Ap;let u;l.ids=o.ids,l.positions=o.positions;for(const _ of l.ids)_!==u&&l.uniqueIds.push(_),u=_;return l.indexed=!0,l}}function Tg(d){const o=+d;return!isNaN(o)&&Number.MIN_SAFE_INTEGER<=o&&o<=Number.MAX_SAFE_INTEGER?o:Qm(String(d))}function Rp(d,o,l,u){for(;l<u;){const _=d[l+u>>1];let p=l-1,y=u+1;for(;;){do{p++}while(d[p]<_);do{y--}while(d[y]>_);if(p>=y)break;$d(d,p,y),$d(o,3*p,3*y),$d(o,3*p+1,3*y+1),$d(o,3*p+2,3*y+2)}y-l<u-y?(Rp(d,o,l,y),l=y+1):(Rp(d,o,y+1,u),u=y)}}function $d(d,o,l){const u=d[o];d[o]=d[l],d[l]=u}Zt(Ap,"FeaturePositionMap");class Wo{constructor(o){this.gl=o.gl,this.initialized=!1}fetchUniformLocation(o,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(o,l),this.initialized=!0),!!this.location}set(o,l,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Ku extends Wo{constructor(o){super(o),this.current=0}set(o,l,u){this.fetchUniformLocation(o,l)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class Fr extends Wo{constructor(o){super(o),this.current=0}set(o,l,u){this.fetchUniformLocation(o,l)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class $a extends Wo{constructor(o){super(o),this.current=[0,0]}set(o,l,u){this.fetchUniformLocation(o,l)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class Qu extends Wo{constructor(o){super(o),this.current=[0,0,0]}set(o,l,u){this.fetchUniformLocation(o,l)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class yf extends Wo{constructor(o){super(o),this.current=[0,0,0,0]}set(o,l,u){this.fetchUniformLocation(o,l)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class Pp extends Wo{constructor(o){super(o),this.current=ki.transparent.toRenderColor(null)}set(o,l,u){this.fetchUniformLocation(o,l)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const Ab=new Float32Array(16);class Op extends Wo{constructor(o){super(o),this.current=Ab}set(o,l,u){if(this.fetchUniformLocation(o,l)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let _=1;_<16;_++)if(u[_]!==this.current[_]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const vf=new Float32Array(9),Fp=new Float32Array(4);class Mg extends Wo{constructor(o){super(o),this.current=Fp}set(o,l,u){if(this.fetchUniformLocation(o,l))for(let _=0;_<4;_++)if(u[_]!==this.current[_]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}function Lp(d){return[Ma(255*d.r,255*d.g),Ma(255*d.b,255*d.a)]}class Gd{constructor(o,l,u,_){this.value=o,this.uniformNames=l.map(p=>`u_${p}`),this.type=u,this.context=_}setUniform(o,l,u,_,p){const y=_.constantOr(this.value);l.set(o,p,y instanceof ki?y.toRenderColor(this.ignoreLut?null:this.context.lut):y)}getBinding(o,l){return"color"===this.type?new Pp(o):new Fr(o)}}class bf{constructor(o,l){this.uniformNames=l.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(o){this.pixelRatio=o.pixelRatio||1,this.pattern=o.tl.concat(o.br)}setUniform(o,l,u,_,p){const y="u_pattern"===p||"u_dash"===p?this.pattern:"u_pixel_ratio"===p?this.pixelRatio:null;y&&l.set(o,p,y)}getBinding(o,l){return"u_pattern"===l||"u_dash"===l?new yf(o):new Fr(o)}}class id{constructor(o,l,u,_){this.expression=o,this.type=u,this.maxValue=0,this.paintVertexAttributes=l.map(p=>({name:`a_${p}`,type:"Float32",components:"color"===u?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(o,l,u,_,p,y,T){const E=this.paintVertexArray.length,R=this.expression.evaluate(new _r(0,{brightness:y}),l,{},p,_,T);this.paintVertexArray.resize(o),this._setPaintValue(E,o,R,this.context)}updatePaintArray(o,l,u,_,p,y,T){const E=this.expression.evaluate({zoom:0,brightness:T},u,_,void 0,p);this._setPaintValue(o,l,E,this.context)}_setPaintValue(o,l,u,_){if("color"===this.type){const p=Lp(u.toRenderColor(this.ignoreLut?null:_.lut));for(let y=o;y<l;y++)this.paintVertexArray.emplace(y,p[0],p[1])}else{for(let p=o;p<l;p++)this.paintVertexArray.emplace(p,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ul{constructor(o,l,u,_,p,y){this.expression=o,this.uniformNames=l.map(T=>`u_${T}_t`),this.type=u,this.useIntegerZoom=_,this.context=p,this.maxValue=0,this.paintVertexAttributes=l.map(T=>({name:`a_${T}`,type:"Float32",components:"color"===u?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(o,l,u,_,p,y,T){const E=this.expression.evaluate(new _r(this.context.zoom,{brightness:y}),l,{},p,_,T),R=this.expression.evaluate(new _r(this.context.zoom+1,{brightness:y}),l,{},p,_,T),w=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValue(w,o,E,R,this.context)}updatePaintArray(o,l,u,_,p,y,T){const E=this.expression.evaluate({zoom:this.context.zoom,brightness:T},u,_,void 0,p),R=this.expression.evaluate({zoom:this.context.zoom+1,brightness:T},u,_,void 0,p);this._setPaintValue(o,l,E,R,this.context)}_setPaintValue(o,l,u,_,p){if("color"===this.type){const y=Lp(u.toRenderColor(this.ignoreLut?null:p.lut)),T=Lp(u.toRenderColor(this.ignoreLut?null:p.lut));for(let E=o;E<l;E++)this.paintVertexArray.emplace(E,y[0],y[1],T[0],T[1])}else{for(let y=o;y<l;y++)this.paintVertexArray.emplace(y,u,_);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(_))}}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(o,l,u,_,p){const y=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,T=En(this.expression.interpolationFactor(y,this.context.zoom,this.context.zoom+1),0,1);l.set(o,p,T)}getBinding(o,l){return new Fr(o)}}class Ju{constructor(o,l,u,_,p){this.expression=o,this.layerId=p,this.paintVertexAttributes=("array"===u?Xu:vw).members;for(let y=0;y<l.length;++y);this.paintVertexArray=new _}populatePaintArray(o,l,u,_){const p=this.paintVertexArray.length;this.paintVertexArray.resize(o),this._setPaintValues(p,o,l.patterns&&l.patterns[this.layerId],u)}updatePaintArray(o,l,u,_,p,y,T){this._setPaintValues(o,l,u.patterns&&u.patterns[this.layerId],y)}_setPaintValues(o,l,u,_){if(!_||!u)return;const p=_[u];if(!p)return;const{tl:y,br:T,pixelRatio:E}=p;for(let R=o;R<l;R++)this.paintVertexArray.emplace(R,y[0],y[1],T[0],T[1],E)}upload(o){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=o.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class xf{constructor(o,l,u=()=>!0){this.binders={},this._buffers=[],this.context=l;const _=[];for(const p in o.paint._values){const y=o.paint.get(p),T=o.paint.get(`${p}-use-theme`);if(p.endsWith("-use-theme")||!u(p)||!(y instanceof ff&&hl(y.property.specification)))continue;const E=Rb(p,o.type),R=y.value,w=y.property.specification.type,D=!!y.property.useIntegerZoom,k="line-dasharray"===p||p.endsWith("pattern"),S="line-dasharray"===p&&"constant"!==o.layout.get("line-cap").value.kind;if("constant"!==R.kind||S)if("source"===R.kind||S||k){const I=Sg(p,w,"source");this.binders[p]=k?new Ju(R,E,w,I,o.id):new id(R,E,w,I),_.push(`/a_${p}`)}else{const I=Sg(p,w,"composite");this.binders[p]=new Ul(R,E,w,D,l,I),_.push(`/z_${p}`)}else this.binders[p]=k?new bf(R.value,E):new Gd(R.value,E,w,l),_.push(`/u_${p}`);T&&(this.binders[p].ignoreLut="none"===T.constantOr("default"),this.binders[p].checkUseTheme=!0)}this.cacheKey=_.sort().join("")}getMaxValue(o){const l=this.binders[o];return l instanceof id||l instanceof Ul?l.maxValue:0}populatePaintArrays(o,l,u,_,p,y,T){for(const E in this.binders){const R=this.binders[E];R.context=this.context,(R instanceof id||R instanceof Ul||R instanceof Ju)&&R.populatePaintArray(o,l,u,_,p,y,T)}}setConstantPatternPositions(o){for(const l in this.binders){const u=this.binders[l];u instanceof bf&&u.setConstantPatternPositions(o)}}updatePaintArrays(o,l,u,_,p,y,T,E,R){let w=!1;const D=Object.keys(o),k=0!==D.length&&!E,S=k?D:l.uniqueIds;this.context.lut=p.lut;for(const I in this.binders){const O=this.binders[I];if(O.context=this.context,(O instanceof id||O instanceof Ul||O instanceof Ju)&&(!0===O.expression.isStateDependent||!1===O.expression.isLightConstant)){const B=p.paint.get(I);O.expression=B.value;for(const U of S){const q=o[U.toString()];l.eachPosition(U,(Z,$,Y)=>{const K=_.feature(Z);O.updatePaintArray($,Y,K,q,y,T,R)})}if(!k)for(const U of u.uniqueIds){const q=o[U.toString()];u.eachPosition(U,(Z,$,Y)=>{const K=_.feature(Z);O.updatePaintArray($,Y,K,q,y,T,R)})}w=!0}}return w}defines(){const o=[];for(const l in this.binders){const u=this.binders[l];(u instanceof Gd||u instanceof bf)&&o.push(...u.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return o}getBinderAttributes(){const o=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof id||u instanceof Ul||u instanceof Ju)for(let _=0;_<u.paintVertexAttributes.length;_++)o.push(u.paintVertexAttributes[_].name)}return o}getBinderUniforms(){const o=[];for(const l in this.binders){const u=this.binders[l];if(u instanceof Gd||u instanceof bf||u instanceof Ul)for(const _ of u.uniformNames)o.push(_)}return o}getPaintVertexBuffers(){return this._buffers}getUniforms(o){const l=[];for(const u in this.binders){const _=this.binders[u];if(_ instanceof Gd||_ instanceof bf||_ instanceof Ul)for(const p of _.uniformNames)l.push({name:p,property:u,binding:_.getBinding(o,p)})}return l}setUniforms(o,l,u,_,p){for(const{name:y,property:T,binding:E}of u){if(this.binders[T].checkUseTheme&&this.binders[T]instanceof Gd){const R=_.get(`${T}-use-theme`);R.isConstant()&&(this.binders[T].ignoreLut="none"===R.constantOr("default"))}this.binders[T].setUniform(o,E,p,_.get(T),y)}}updatePaintBuffers(){this._buffers=[];for(const o in this.binders){const l=this.binders[o];(l instanceof id||l instanceof Ul||l instanceof Ju)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer)}}upload(o){for(const l in this.binders){const u=this.binders[l];(u instanceof id||u instanceof Ul||u instanceof Ju)&&u.upload(o)}this.updatePaintBuffers()}destroy(){for(const o in this.binders){const l=this.binders[o];(l instanceof id||l instanceof Ul||l instanceof Ju)&&l.destroy()}}}class xc{constructor(o,l,u=()=>!0){this.programConfigurations={};for(const _ of o)this.programConfigurations[_.id]=new xf(_,l,u);this.needsUpload=!1,this._featureMap=new Ap,this._featureMapWithoutIds=new Ap,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(o,l,u,_,p,y,T,E){for(const R in this.programConfigurations)this.programConfigurations[R].populatePaintArrays(o,l,_,p,y,T,E);void 0!==l.id?this._featureMap.add(l.id,u,this._bufferOffset,o):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,o),this._idlessCounter+=1),this._bufferOffset=o,this.needsUpload=!0}updatePaintArrays(o,l,u,_,p,y,T){for(const E of u)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(o,this._featureMap,this._featureMapWithoutIds,l,E,_,p,y,T||0)||this.needsUpload}get(o){return this.programConfigurations[o]}upload(o){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(o);this.needsUpload=!1}}destroy(){for(const o in this.programConfigurations)this.programConfigurations[o].destroy()}}const Np={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Rb(d,o){return Np[d]||[d.replace(`${o}-`,"").replace(/-/g,"_")]}const zp={"line-pattern":{source:Hd,composite:Hd},"fill-pattern":{source:Hd,composite:Hd},"fill-extrusion-pattern":{source:Hd,composite:Hd},"line-dasharray":{source:yt,composite:yt}},Bp={color:{source:bc,composite:ed},number:{source:Ha,composite:bc}};function Sg(d,o,l){const u=zp[d];return u&&u[l]||Bp[o][l]}Zt(Gd,"ConstantBinder"),Zt(bf,"PatternConstantBinder"),Zt(id,"SourceExpressionBinder"),Zt(Ju,"PatternCompositeBinder"),Zt(Ul,"CompositeExpressionBinder"),Zt(xf,"ProgramConfiguration",{omit:["_buffers"]}),Zt(xc,"ProgramConfigurationSet");const _o=Ot/Math.PI/2,_y=[64,32,16],Sa=-_o,sa=_o;function wf(d,o,l,u=_o){return l=vi(l),[d*Math.sin(l)*u,-o*u,d*Math.cos(l)*u]}function qd(d,o,l){return wf(Math.cos(vi(d)),Math.sin(vi(d)),o,l)}const th=6371008.8,yy=2*Math.PI*th;class ii{constructor(o,l){if(isNaN(o)||isNaN(l))throw new Error(`Invalid LngLat object: (${o}, ${l})`);if(this.lng=+o,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ii(cc(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(o){const l=Math.PI/180,u=this.lat*l,_=o.lat*l,p=Math.sin(u)*Math.sin(_)+Math.cos(u)*Math.cos(_)*Math.cos((o.lng-this.lng)*l);return th*Math.acos(Math.min(p,1))}toBounds(o=0){const l=360*o/40075017,u=l/Math.cos(Math.PI/180*this.lat);return new Wd({lng:this.lng-u,lat:this.lat-l},{lng:this.lng+u,lat:this.lat+l})}toEcef(o){return qd(this.lat,this.lng,_o+o*_o/th)}static convert(o){if(o instanceof ii)return o;if(Array.isArray(o)&&(2===o.length||3===o.length))return new ii(Number(o[0]),Number(o[1]));if(!Array.isArray(o)&&"object"==typeof o&&null!==o)return new ii(Number("lng"in o?o.lng:o.lon),Number(o.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Wd{constructor(o,l){if(o)if(l)this.setSouthWest(o).setNorthEast(l);else if(4===o.length){const u=o;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=o;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(o){return this._ne=o instanceof ii?new ii(o.lng,o.lat):ii.convert(o),this}setSouthWest(o){return this._sw=o instanceof ii?new ii(o.lng,o.lat):ii.convert(o),this}extend(o){const l=this._sw,u=this._ne;let _,p;if(o instanceof ii)_=o,p=o;else{if(!(o instanceof Wd))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(Wd.convert(o)):this.extend(ii.convert(o)):"object"==typeof o&&null!==o&&o.hasOwnProperty("lat")&&(o.hasOwnProperty("lon")||o.hasOwnProperty("lng"))?this.extend(ii.convert(o)):this;if(_=o._sw,p=o._ne,!_||!p)return this}return l||u?(l.lng=Math.min(_.lng,l.lng),l.lat=Math.min(_.lat,l.lat),u.lng=Math.max(p.lng,u.lng),u.lat=Math.max(p.lat,u.lat)):(this._sw=new ii(_.lng,_.lat),this._ne=new ii(p.lng,p.lat)),this}getCenter(){return new ii((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ii(this.getWest(),this.getNorth())}getSouthEast(){return new ii(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:l,lat:u}=ii.convert(o);let _=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&_}static convert(o){if(o)return o instanceof Wd?o:new Wd(o)}}function Cf(d){return yy*Math.cos(d*Math.PI/180)}function Hl(d){return(180+d)/360}function $l(d){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+d*Math.PI/360)))/360}function Os(d,o){return d/Cf(o)}function aa(d){return 360*d-180}function Zo(d){return 360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90}function Eg(d,o){return d*Cf(Zo(o))}const eo=85.051129;function m(d){return Math.cos(vi(En(d,-eo,eo)))}function s(d,o){const l=En(o,0,25.5),u=Math.pow(2,l);return m(d)*yy/(512*u)}function c(d){return 1/Math.cos(d*Math.PI/180)}function g(d,o=0){const l=Math.exp(Math.PI*(1-(d.y+o/Ot)/(1<<d.z)*2));return 80150034*l/(l*l+1)/Ot/(1<<d.z)}class b{constructor(o,l,u=0){this.x=+o,this.y=+l,this.z=+u}static fromLngLat(o,l=0){const u=ii.convert(o);return new b(Hl(u.lng),$l(u.lat),Os(l,u.lat))}toLngLat(){return new ii(aa(this.x),Zo(this.y))}toAltitude(){return Eg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/yy*c(Zo(this.y))}}function x(d,o,l,u,_,p,y,T,E){const R=(o+u)/2,w=(l+_)/2,D=new Ft(R,w);T(D),function(k,S,I,O,B,U){const q=I-B,Z=O-U;return Math.abs((O-S)*q-(I-k)*Z)/Math.hypot(q,Z)}(D.x,D.y,p.x,p.y,y.x,y.y)>=E?(x(d,o,l,R,w,p,D,T,E),x(d,R,w,u,_,D,y,T,E)):d.push(y)}function M(d,o,l){let u=d[0],_=u.x,p=u.y;o(u);const y=[u];for(let T=1;T<d.length;T++){const E=d[T],{x:R,y:w}=E;o(E),x(y,_,p,R,w,u,E,o,l),_=R,p=w,u=E}return y}function A(d,o,l,u){if(u(o,l)){const _=o.add(l)._mult(.5);A(d,o,_,u),A(d,_,l,u)}else d.push(l)}function F(d,o){let l=d[0];const u=[l];for(let _=1;_<d.length;_++){const p=d[_];A(u,l,p,o),l=p}return u}const N=Math.pow(2,14)-1,z=-N-1;function H(d,o){const l=Math.round(d.x*o),u=Math.round(d.y*o);return d.x=En(l,z,N),d.y=En(u,z,N),(l<d.x||l>d.x+1||u<d.y||u>d.y+1)&&Yn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),d}function j(d,o,l){const u=d.loadGeometry(),_=d.extent,p=Ot/_;if(o&&l&&l.projection.isReprojectedInTileSpace){const y=1<<o.z,{scale:T,x:E,y:R,projection:w}=l,D=k=>{const S=aa((o.x+k.x/_)/y),I=Zo((o.y+k.y/_)/y),O=w.project(S,I);k.x=(O.x*T-E)*_,k.y=(O.y*T-R)*_};for(let k=0;k<u.length;k++)if(1!==d.type)u[k]=M(u[k],D,1);else{const S=[];for(const I of u[k])I.x<0||I.x>=_||I.y<0||I.y>=_||(D(I),S.push(I));u[k]=S}}for(const y of u)for(const T of y)H(T,p);return u}function G(d,o){return{type:d.type,id:d.id,properties:d.properties,geometry:o?j(d):[]}}function J(d,o,l,u,_){d.emplaceBack(2*o+(u+1)/2,2*l+(_+1)/2)}function Q(d,o,l){d.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class te{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.projection=o.projection,this.layoutVertexArray=new Jc,this.indexArray=new es,this.segments=new ni,this.programConfigurations=new xc(o.layers,{zoom:o.zoom,lut:o.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id)}updateFootprints(o,l){}populate(o,l,u,_){const p=this.layers[0],y=[];let T=null;"circle"===p.type&&(T=p.layout.get("circle-sort-key"));for(const{feature:R,id:w,index:D,sourceLayerIndex:k}of o){const S=this.layers[0]._featureFilter.needGeometry,I=G(R,S);if(!this.layers[0]._featureFilter.filter(new _r(this.zoom),I,u))continue;const O=T?T.evaluate(I,{},u):void 0,B={id:w,properties:R.properties,type:R.type,sourceLayerIndex:k,index:D,geometry:S?I.geometry:j(R,u,_),patterns:{},sortKey:O};y.push(B)}T&&y.sort((R,w)=>R.sortKey-w.sortKey);let E=null;"globe"===_.projection.name&&(this.globeExtVertexArray=new fi,E=_.projection);for(const R of y){const{geometry:w,index:D,sourceLayerIndex:k}=R,S=o[D].feature;this.addFeature(R,w,D,l.availableImages,u,E,l.brightness),l.featureIndex.insert(S,w,D,k,this.index)}}update(o,l,u,_,p,y,T){this.programConfigurations.updatePaintArrays(o,l,p,u,_,y,T)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,ts.members),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Yu.members))),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(o,l,u,_,p,y,T){for(const E of l)for(const R of E){const w=R.x,D=R.y;if(w<0||w>=Ot||D<0||D>=Ot)continue;if(y){const I=y.projectTilePoint(w,D,p),O=y.upVector(p,w,D),B=this.globeExtVertexArray;Q(B,I,O),Q(B,I,O),Q(B,I,O),Q(B,I,O)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,o.sortKey),S=k.vertexLength;J(this.layoutVertexArray,w,D,-1,-1),J(this.layoutVertexArray,w,D,1,-1),J(this.layoutVertexArray,w,D,1,1),J(this.layoutVertexArray,w,D,-1,1),this.indexArray.emplaceBack(S,S+1,S+2),this.indexArray.emplaceBack(S,S+2,S+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,{},_,p,T)}}function ne(d,o){for(let l=0;l<d.length;l++)if(Re(o,d[l]))return!0;for(let l=0;l<o.length;l++)if(Re(d,o[l]))return!0;return!!xe(d,o)}function le(d,o,l){return!!Re(d,o)||!!be(o,d,l)}function me(d,o){if(1===d.length)return Ee(o,d[0]);for(let l=0;l<o.length;l++){const u=o[l];for(let _=0;_<u.length;_++)if(Re(d,u[_]))return!0}for(let l=0;l<d.length;l++)if(Ee(o,d[l]))return!0;for(let l=0;l<o.length;l++)if(xe(d,o[l]))return!0;return!1}function pe(d,o,l){if(d.length>1){if(xe(d,o))return!0;for(let u=0;u<o.length;u++)if(be(o[u],d,l))return!0}for(let u=0;u<d.length;u++)if(be(d[u],o,l))return!0;return!1}function xe(d,o){if(0===d.length||0===o.length)return!1;for(let l=0;l<d.length-1;l++){const u=d[l],_=d[l+1];for(let p=0;p<o.length-1;p++)if(ve(u,_,o[p],o[p+1]))return!0}return!1}function ve(d,o,l,u){return dc(d,l,u)!==dc(o,l,u)&&dc(d,o,l)!==dc(d,o,u)}function be(d,o,l){const u=l*l;if(1===o.length)return d.distSqr(o[0])<u;for(let _=1;_<o.length;_++)if(ye(d,o[_-1],o[_])<u)return!0;return!1}function ye(d,o,l){const u=o.distSqr(l);if(0===u)return d.distSqr(o);const _=((d.x-o.x)*(l.x-o.x)+(d.y-o.y)*(l.y-o.y))/u;return d.distSqr(_<0?o:_>1?l:l.sub(o)._mult(_)._add(o))}function Ee(d,o){let l,u,_,p=!1;for(let y=0;y<d.length;y++){l=d[y];for(let T=0,E=l.length-1;T<l.length;E=T++)u=l[T],_=l[E],u.y>o.y!=_.y>o.y&&o.x<(_.x-u.x)*(o.y-u.y)/(_.y-u.y)+u.x&&(p=!p)}return p}function Re(d,o){let l=!1;for(let u=0,_=d.length-1;u<d.length;_=u++){const p=d[u],y=d[_];p.y>o.y!=y.y>o.y&&o.x<(y.x-p.x)*(o.y-p.y)/(y.y-p.y)+p.x&&(l=!l)}return l}function Xe(d,o,l,u,_){for(const y of d)if(o<=y.x&&l<=y.y&&u>=y.x&&_>=y.y)return!0;const p=[new Ft(o,l),new Ft(o,_),new Ft(u,_),new Ft(u,l)];if(d.length>2)for(const y of p)if(Re(d,y))return!0;for(let y=0;y<d.length-1;y++)if(qe(d[y],d[y+1],p))return!0;return!1}function qe(d,o,l){const u=l[0],_=l[2];if(d.x<u.x&&o.x<u.x||d.x>_.x&&o.x>_.x||d.y<u.y&&o.y<u.y||d.y>_.y&&o.y>_.y)return!1;const p=dc(d,o,l[0]);return p!==dc(d,o,l[1])||p!==dc(d,o,l[2])||p!==dc(d,o,l[3])}function Ae(d,o,l,u,_,p){let y=o.y-d.y,T=d.x-o.x;if(p=p||0){const E=y*y+T*T;if(0===E)return!0;const R=Math.sqrt(E);y/=R,T/=R}return!((l.x-d.x)*y+(l.y-d.y)*T-p<0||(u.x-d.x)*y+(u.y-d.y)*T-p<0||(_.x-d.x)*y+(_.y-d.y)*T-p<0)}function Be(d,o,l,u,_,p,y){return!(Ae(d,o,u,_,p,y)||Ae(o,l,u,_,p,y)||Ae(l,d,u,_,p,y)||Ae(u,_,d,o,l,y)||Ae(_,p,d,o,l,y)||Ae(p,u,d,o,l,y))}function Ye(d,o,l){const u=o.paint.get(d).value;return"constant"===u.kind?u.value:l.programConfigurations.get(o.id).getMaxValue(d)}function pt(d){return Math.sqrt(d[0]*d[0]+d[1]*d[1])}function Ct(d,o,l,u,_){if(!o[0]&&!o[1])return d;const p=Ft.convert(o)._mult(_);"viewport"===l&&p._rotate(-u);const y=[];for(let T=0;T<d.length;T++)y.push(d[T].sub(p));return y}function He(d,o,l,u){const _=Ft.convert(d)._mult(u);return"viewport"===o&&_._rotate(-l),_}let dt,Ke;Zt(te,"CircleBucket",{omit:["layers"]});var bt,ht={exports:{}},st=(bt||(bt=1,function(l){function u(p,y,T){var E=_(256*p,256*(y=Math.pow(2,T)-y-1),T),R=_(256*(p+1),256*(y+1),T);return E[0]+","+E[1]+","+R[0]+","+R[1]}function _(p,y,T){var E=2*Math.PI*6378137/256/Math.pow(2,T);return[p*E-2*Math.PI*6378137/2,y*E-2*Math.PI*6378137/2]}l.getURL=function(p,y,T,E,R,w){return w=w||{},p+"?"+["bbox="+u(T,E,R),"format="+(w.format||"image/png"),"service="+(w.service||"WMS"),"version="+(w.version||"1.1.1"),"request="+(w.request||"GetMap"),"srs="+(w.srs||"EPSG:3857"),"width="+(w.width||256),"height="+(w.height||256),"layers="+y].join("&")},l.getTileBBox=u,l.getMercCoords=_,Object.defineProperty(l,"__esModule",{value:!0})}(ht.exports)),ht.exports);class Pt{constructor(o,l,u){this.z=o,this.x=l,this.y=u,this.key=Gt(0,o,o,l,u)}equals(o){return this.z===o.z&&this.x===o.x&&this.y===o.y}url(o,l){const u=st.getTileBBox(this.x,this.y,this.z),_=function(p,y,T){let E,R="";for(let w=p;w>0;w--)E=1<<w-1,R+=(y&E?1:0)+(T&E?2:0);return R}(this.z,this.x,this.y);return o[(this.x+this.y)%o.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===l?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",_).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Vt{constructor(o,l){this.wrap=o,this.canonical=l,this.key=Gt(o,l.z,l.z,l.x,l.y)}}class kt{constructor(o,l,u,_,p){this.overscaledZ=o,this.wrap=l,this.canonical=new Pt(u,+_,+p),this.key=0===l&&o===u?this.canonical.key:Gt(l,o,u,_,p)}equals(o){return this.overscaledZ===o.overscaledZ&&this.wrap===o.wrap&&this.canonical.equals(o.canonical)}scaledTo(o){const l=this.canonical.z-o;return o>this.canonical.z?new kt(o,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new kt(o,this.wrap,o,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(o,l=!0){if(this.overscaledZ===o&&l)return this.key;if(o>this.canonical.z)return Gt(this.wrap*+l,o,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-o;return Gt(this.wrap*+l,o,o,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(o){if(o.wrap!==this.wrap)return!1;const l=this.canonical.z-o.canonical.z;return 0===o.overscaledZ||o.overscaledZ<this.overscaledZ&&o.canonical.z<this.canonical.z&&o.canonical.x===this.canonical.x>>l&&o.canonical.y===this.canonical.y>>l}children(o){if(this.overscaledZ>=o)return[new kt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,u=2*this.canonical.x,_=2*this.canonical.y;return[new kt(l,this.wrap,l,u,_),new kt(l,this.wrap,l,u+1,_),new kt(l,this.wrap,l,u,_+1),new kt(l,this.wrap,l,u+1,_+1)]}isLessThan(o){return this.wrap<o.wrap||!(this.wrap>o.wrap)&&(this.overscaledZ<o.overscaledZ||!(this.overscaledZ>o.overscaledZ)&&(this.canonical.x<o.canonical.x||!(this.canonical.x>o.canonical.x)&&this.canonical.y<o.canonical.y))}wrapped(){return new kt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(o){return new kt(this.overscaledZ,o,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vt(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Gt(d,o,l,u,_){const p=1<<Math.min(l,22);let y=p*(_%p)+u%p;return d&&l<22&&(y+=p*p*((d<0?-2*d-1:2*d)%(1<<2*(22-l)))),16*(32*y+l)+(o-l)}const hn=[d=>{let o=d.canonical.x-1,l=d.wrap;return o<0&&(o=(1<<d.canonical.z)-1,l--),new kt(d.overscaledZ,l,d.canonical.z,o,d.canonical.y)},d=>{let o=d.canonical.x+1,l=d.wrap;return o===1<<d.canonical.z&&(o=0,l++),new kt(d.overscaledZ,l,d.canonical.z,o,d.canonical.y)},d=>new kt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,(0===d.canonical.y?1<<d.canonical.z:d.canonical.y)-1),d=>new kt(d.overscaledZ,d.wrap,d.canonical.z,d.canonical.x,d.canonical.y===(1<<d.canonical.z)-1?0:d.canonical.y+1)];Zt(Pt,"CanonicalTileID"),Zt(kt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const ln=Ri([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:sn}=ln,Dt=Ri([{name:"a_pos_3",components:3,type:"Int16"}]);var si=Ri([{name:"a_pos",type:"Int16",components:2}]);class jn{constructor(o,l){this.pos=o,this.dir=l}intersectsPlane(o,l,u){const _=Oe.vec3.dot(l,this.dir);if(Math.abs(_)<1e-6)return!1;const p=((o[0]-this.pos[0])*l[0]+(o[1]-this.pos[1])*l[1]+(o[2]-this.pos[2])*l[2])/_;return u[0]=this.pos[0]+this.dir[0]*p,u[1]=this.pos[1]+this.dir[1]*p,u[2]=this.pos[2]+this.dir[2]*p,!0}closestPointOnSphere(o,l,u){if(Oe.vec3.equals(this.pos,o)||0===l)return u[0]=u[1]=u[2]=0,!1;const[_,p,y]=this.dir,T=this.pos[0]-o[0],E=this.pos[1]-o[1],R=this.pos[2]-o[2],w=_*_+p*p+y*y,D=2*(T*_+E*p+R*y),k=D*D-4*w*(T*T+E*E+R*R-l*l);if(k<0){const S=Math.max(-D/2,0),I=T+_*S,O=E+p*S,B=R+y*S,U=Math.hypot(I,O,B);return u[0]=I*l/U,u[1]=O*l/U,u[2]=B*l/U,!1}{const S=(-D-Math.sqrt(k))/(2*w);if(S<0){const I=Math.hypot(T,E,R);return u[0]=T*l/I,u[1]=E*l/I,u[2]=R*l/I,!1}return u[0]=T+_*S,u[1]=E+p*S,u[2]=R+y*S,!0}}}class hr{constructor(o,l,u,_,p){this.TL=o,this.TR=l,this.BR=u,this.BL=_,this.horizon=p}static fromInvProjectionMatrix(o,l,u){const _=[-1,1,1],p=[1,1,1],y=[1,-1,1],T=[-1,-1,1],E=Oe.vec3.transformMat4(_,_,o),R=Oe.vec3.transformMat4(p,p,o),w=Oe.vec3.transformMat4(y,y,o),D=Oe.vec3.transformMat4(T,T,o);return new hr(E,R,w,D,l/u)}}function fr(d,o,l){let u=1/0,_=-1/0;const p=[];for(const y of d){Oe.vec3.sub(p,y,o);const T=Oe.vec3.dot(p,l);u=Math.min(u,T),_=Math.max(_,T)}return[u,_]}function Fi(d,o){let l=!0;for(let u=0;u<d.planes.length;u++){const _=d.planes[u];let p=0;for(let y=0;y<o.length;y++)p+=Oe.vec3.dot(_,o[y])+_[3]>=0;if(0===p)return 0;p!==o.length&&(l=!1)}return l?2:1}function ji(d,o){for(const l of d.projections){const u=fr(o,d.points[0],l.axis);if(l.projection[1]<u[0]||l.projection[0]>u[1])return 0}return 1}function Zn(d,o){let l=0;const u=[0,0,0,0];for(let _=0;_<d.length;_++)u[0]=d[_][0],u[1]=d[_][1],u[2]=d[_][2],u[3]=1,Oe.vec4.dot(u,o)>=0&&l++;return l}class Ht{constructor(o,l){this.points=o||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=gn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Oe.vec3.sub([],this.points[2],this.points[3]),Oe.vec3.sub([],this.points[0],this.points[3]),Oe.vec3.sub([],this.points[4],this.points[0]),Oe.vec3.sub([],this.points[5],this.points[1]),Oe.vec3.sub([],this.points[6],this.points[2]),Oe.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const _=[0,-u[2],u[1]],p=[u[2],0,-u[0]];this.projections.push({axis:_,projection:fr(this.points,this.points[0],_)}),this.projections.push({axis:p,projection:fr(this.points,this.points[0],p)})}}static fromInvProjectionMatrix(o,l,u,_){const p=Math.pow(2,u),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(R=>{const w=Oe.vec4.transformMat4([],R,o),D=1/w[3]/l*p;return Oe.vec4.mul(w,w,[D,D,_?1/w[3]:D,D])}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(R=>{const w=Oe.vec3.sub([],y[R[0]],y[R[1]]),D=Oe.vec3.sub([],y[R[2]],y[R[1]]),k=Oe.vec3.normalize([],Oe.vec3.cross([],w,D)),S=-Oe.vec3.dot(k,y[R[1]]);return k.concat(S)}),E=[];for(let R=0;R<y.length;R++)E.push([y[R][0],y[R][1],y[R][2]]);return new Ht(E,T)}intersectsPrecise(o,l,u){for(let _=0;_<l.length;_++)if(!Zn(o,l[_]))return 0;for(let _=0;_<this.planes.length;_++)if(!Zn(o,this.planes[_]))return 0;for(const _ of u)for(const p of this.frustumEdges){const y=Oe.vec3.cross([],_,p),T=Oe.vec3.length(y);if(0===T)continue;Oe.vec3.scale(y,y,1/T);const E=fr(this.points,this.points[0],y),R=fr(o,this.points[0],y);if(E[0]>R[1]||R[0]>E[1])return 0}return 1}containsPoint(o){for(const l of this.planes){const u=l[3];if(Oe.vec3.dot([l[0],l[1],l[2]],o)+u<0)return!1}return!0}}class gn{static fromPoints(o){const l=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const _ of o)Oe.vec3.min(l,l,_),Oe.vec3.max(u,u,_);return new gn(l,u)}static fromTileIdAndHeight(o,l,u){const _=1<<o.canonical.z,p=o.canonical.x,y=o.canonical.y;return new gn([p/_,y/_,l],[(p+1)/_,(y+1)/_,u])}static applyTransform(o,l){const u=o.getCorners();for(let _=0;_<u.length;++_)Oe.vec3.transformMat4(u[_],u[_],l);return gn.fromPoints(u)}static applyTransformFast(o,l){const u=[l[12],l[13],l[14]],_=[...u];for(let p=0;p<3;p++)for(let y=0;y<3;y++){const T=l[4*y+p],E=T*o.min[y],R=T*o.max[y];u[p]+=Math.min(E,R),_[p]+=Math.max(E,R)}return new gn(u,_)}static projectAabbCorners(o,l){const u=o.getCorners();for(let _=0;_<u.length;++_)Oe.vec3.transformMat4(u[_],u[_],l);return u}constructor(o,l){this.min=o,this.max=l,this.center=Oe.vec3.scale([],Oe.vec3.add([],this.min,this.max),.5)}quadrant(o){const l=[o%2==0,o<2],u=Oe.vec3.clone(this.min),_=Oe.vec3.clone(this.max);for(let p=0;p<l.length;p++)u[p]=l[p]?this.min[p]:this.center[p],_[p]=l[p]?this.center[p]:this.max[p];return _[2]=this.max[2],new gn(u,_)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}distanceZ(o){return Math.max(Math.min(this.max[2],o[2]),this.min[2])-o[2]}getCorners(){const o=this.min,l=this.max;return[[o[0],o[1],o[2]],[l[0],o[1],o[2]],[l[0],l[1],o[2]],[o[0],l[1],o[2]],[o[0],o[1],l[2]],[l[0],o[1],l[2]],[l[0],l[1],l[2]],[o[0],l[1],l[2]]]}intersects(o){return this.intersectsAabb(o.bounds)?Fi(o,this.getCorners()):0}intersectsFlat(o){return this.intersectsAabb(o.bounds)?Fi(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(o,l){return l||this.intersects(o)?ji(o,this.getCorners()):0}intersectsPreciseFlat(o,l){return l||this.intersectsFlat(o)?ji(o,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(o){for(let l=0;l<3;++l)if(this.min[l]>o.max[l]||o.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(o){return!(this.min[0]>o.max[0]||o.min[0]>this.max[0]||this.min[1]>o.max[1]||o.min[1]>this.max[1])}encapsulate(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o.min[l]),this.max[l]=Math.max(this.max[l],o.max[l])}encapsulatePoint(o){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],o[l]),this.max[l]=Math.max(this.max[l],o[l])}closestPoint(o){return[Math.max(Math.min(this.max[0],o[0]),this.min[0]),Math.max(Math.min(this.max[1],o[1]),this.min[1]),Math.max(Math.min(this.max[2],o[2]),this.min[2])]}}function Si(d){return d*_o/th}Zt(gn,"Aabb");const Lr=[new gn([Sa,Sa,Sa],[sa,sa,sa]),new gn([Sa,Sa,Sa],[0,0,sa]),new gn([0,Sa,Sa],[sa,0,sa]),new gn([Sa,0,Sa],[0,sa,sa]),new gn([0,0,Sa],[sa,sa,sa])];function Yo(d,o,l,u=!0){const _=Oe.vec3.scale([],d._camera.position,d.worldSize),p=[o,l,1,1];Oe.vec4.transformMat4(p,p,d.pixelMatrixInverse),Oe.vec4.scale(p,p,1/p[3]);const y=Oe.vec3.sub([],p,_),T=Oe.vec3.normalize([],y),E=d.globeMatrix,R=[E[12],E[13],E[14]],w=Oe.vec3.sub([],R,_),D=Oe.vec3.length(w),k=Oe.vec3.normalize([],w),S=d.worldSize/(2*Math.PI),I=Oe.vec3.dot(k,T),O=Math.asin(S/D);if(O<Math.acos(I)){if(!u)return null;const we=[],fe=[];Oe.vec3.scale(we,T,D/I),Oe.vec3.normalize(fe,Oe.vec3.sub(fe,we,w)),Oe.vec3.normalize(T,Oe.vec3.add(T,w,Oe.vec3.scale(T,fe,Math.tan(O)*D)))}const B=[];new jn(_,T).closestPointOnSphere(R,S,B);const U=Oe.vec3.normalize([],Md(E,0)),q=Oe.vec3.normalize([],Md(E,1)),Z=Oe.vec3.normalize([],Md(E,2)),$=Oe.vec3.dot(U,B),Y=Oe.vec3.dot(q,B),K=Oe.vec3.dot(Z,B),ee=pi(Math.asin(-Y/S));let ue=pi(Math.atan2($,K));ue=d.center.lng+function(we,fe){const Te=(fe-we+180)%360-180;return Te<-180?Te+360:Te}(d.center.lng,ue);const de=Hl(ue),ce=En($l(ee),0,1);return new b(de,ce)}class Fs{constructor(o,l,u){this.a=Oe.vec3.sub([],o,u),this.b=Oe.vec3.sub([],l,u),this.center=u;const _=Oe.vec3.normalize([],this.a),p=Oe.vec3.normalize([],this.b);this.angle=Math.acos(Oe.vec3.dot(_,p))}}function us(d,o){if(0===d.angle)return null;let l;return l=0===d.a[o]?1/d.angle*.5*Math.PI:1/d.angle*Math.atan(d.b[o]/d.a[o]/Math.sin(d.angle)-1/Math.tan(d.angle)),l<0||l>1?null:function(u,_,p,y){const T=Math.sin(p);return u*(Math.sin((1-y)*p)/T)+_*(Math.sin(y*p)/T)}(d.a[o],d.b[o],d.angle,En(l,0,1))+d.center[o]}function ko(d){if(d.z<=1)return Lr[d.z+2*d.y+d.x];const o=Ci(nr(d));return gn.fromPoints(o)}function to(d,o,l){return Oe.vec3.scale(d,d,1-l),Oe.vec3.scaleAndAdd(d,d,o,l)}function Gr(d,o,l){for(const u of d)Oe.vec3.transformMat4(u,u,o),Oe.vec3.scale(u,u,l)}function pr(d,o,l,u){const _=o/d.worldSize,p=d.globeMatrix;if(l.z<=1){const de=ko(l).getCorners();return Gr(de,p,_),gn.fromPoints(de)}const y=nr(l,u),T=Ci(y,_o+Si(d._tileCoverLift));Gr(T,p,_);const E=Number.MAX_VALUE,R=[-E,-E,-E],w=[E,E,E];if(y.contains(d.center)){for(const we of T)Oe.vec3.min(w,w,we),Oe.vec3.max(R,R,we);R[2]=0;const de=d.point,ce=[de.x*_,de.y*_,0];return Oe.vec3.min(w,w,ce),Oe.vec3.max(R,R,ce),new gn(w,R)}if(d._tileCoverLift>0){for(const de of T)Oe.vec3.min(w,w,de),Oe.vec3.max(R,R,de);return new gn(w,R)}const D=[p[12]*_,p[13]*_,p[14]*_],k=y.getCenter(),S=En(d.center.lat,-eo,eo),I=En(k.lat,-eo,eo),O=Hl(d.center.lng),B=$l(S);let U=O-Hl(k.lng);const q=B-$l(I);U>.5?U-=1:U<-.5&&(U+=1);let Z=0;if(Math.abs(U)>Math.abs(q))Z=U>=0?1:3;else{Z=q>=0?0:2;const de=[p[4]*_,p[5]*_,p[6]*_],ce=-Math.sin(vi(q>=0?y.getSouth():y.getNorth()))*_o;Oe.vec3.scaleAndAdd(D,D,de,ce)}const $=T[Z],Y=T[(Z+1)%4],K=new Fs($,Y,D),ee=[us(K,0)||$[0],us(K,1)||$[1],us(K,2)||$[2]],ue=Ss(d.zoom);if(ue>0){const de=function({x:we,y:fe,z:Te},ke,De,Pe,Ne){const je=1/(1<<Te);let Le=we*je,it=Le+je,_t=fe*je,rt=_t+je,Et=0;const St=(Le+it)/2-Pe;return St>.5?Et=-1:St<-.5&&(Et=1),Le=((Le+Et)*ke-(Pe*=ke))*De+Pe,it=((it+Et)*ke-Pe)*De+Pe,_t=(_t*ke-(Ne*=ke))*De+Ne,rt=(rt*ke-Ne)*De+Ne,[[Le,rt,0],[it,rt,0],[it,_t,0],[Le,_t,0]]}(l,o,d._pixelsPerMercatorPixel,O,B);for(let we=0;we<T.length;we++)to(T[we],de[we],ue);const ce=Oe.vec3.add([],de[Z],de[(Z+1)%4]);Oe.vec3.scale(ce,ce,.5),to(ee,ce,ue)}for(const de of T)Oe.vec3.min(w,w,de),Oe.vec3.max(R,R,de);return w[2]=Math.min($[2],Y[2]),Oe.vec3.min(w,w,ee),Oe.vec3.max(R,R,ee),new gn(w,R)}function nr({x:d,y:o,z:l},u=!1){const _=1/(1<<l),p=new ii(aa(d*_),o===(1<<l)-1&&u?-90:Zo((o+1)*_)),y=new ii(aa((d+1)*_),0===o&&u?90:Zo(o*_));return new Wd(p,y)}function Ci(d,o=_o){const l=vi(d.getNorth()),u=vi(d.getSouth()),_=Math.cos(l),p=Math.cos(u),y=Math.sin(l),T=Math.sin(u),E=d.getWest(),R=d.getEast();return[wf(p,T,E,o),wf(p,T,R,o),wf(_,y,R,o),wf(_,y,E,o)]}function Zi(d,o,l,u){const _=1<<l.z,p=(d/Ot+l.x)/_;return qd(Zo((o/Ot+l.y)/_),aa(p),u)}function Fo({min:d,max:o}){return 16383/Math.max(o[0]-d[0],o[1]-d[1],o[2]-d[2])}const ar=new Float64Array(16);function Ms(d){const o=Fo(d),l=Oe.mat4.fromScaling(ar,[o,o,o]);return Oe.mat4.translate(l,l,Oe.vec3.negate([],d.min))}function ml(d){const o=Oe.mat4.fromTranslation(ar,d.min),l=1/Fo(d);return Oe.mat4.scale(o,o,[l,l,l])}function Ls(d){const o=Ot/(2*Math.PI);return d/(2*Math.PI)/o}function rd(d,o){return Ot/(512*Math.pow(2,d))*Fo(ko(o))}function wc(d,o,l,u,_){const p=Ls(l),y=[d,o,-l/(2*Math.PI)],T=Oe.mat4.identity(new Float64Array(16));return Oe.mat4.translate(T,T,y),Oe.mat4.scale(T,T,[p,p,p]),Oe.mat4.rotateX(T,T,vi(-_)),Oe.mat4.rotateY(T,T,vi(-u)),T}function Ss(d){return wu(5,6,d)}function hs(d,o){const l=qd(o.lat,o.lng),u=function(p){const y=qd(p._center.lat,p._center.lng),T=Oe.vec3.fromValues(0,1,0);let E=Oe.vec3.cross([],T,y);const R=Oe.mat4.fromRotation([],-p.angle,y);E=Oe.vec3.transformMat4(E,E,R),Oe.mat4.fromRotation(R,-p._pitch,E);const w=Oe.vec3.normalize([],y);return Oe.vec3.scale(w,w,Si(p.cameraToCenterDistance/p.pixelsPerMeter)),Oe.vec3.transformMat4(w,w,R),Oe.vec3.add([],y,w)}(d),_=Oe.vec3.subtract([],u,l);return Oe.vec3.angle(_,l)}function In(d,o){return hs(d,o)>Math.PI/2*1.01}const gl=vi(85),nh=Math.cos(gl),od=Math.sin(gl),ih=Oe.mat4.create(),Dg=d=>{const o=[];return"map"===d.paint.get("circle-pitch-alignment")&&o.push("PITCH_WITH_MAP"),"map"===d.paint.get("circle-pitch-scale")&&o.push("SCALE_WITH_MAP"),o};function Ob(d,o,l,u,_,p,y,T,E){if(p&&d.queryGeometry.isAboveHorizon)return!1;p&&(E*=d.pixelToTileUnitsFactor);const R=d.tileID.canonical,w=l.projection.upVectorScale(R,l.center.lat,l.worldSize).metersToTile;for(const D of o)for(const k of D){const S=k.add(T),I=_&&l.elevation?l.elevation.exaggeration()*_.getElevationAt(S.x,S.y,!0):0,O=l.projection.projectTilePoint(S.x,S.y,R);if(I>0){const Z=l.projection.upVector(R,S.x,S.y);O.x+=Z[0]*w*I,O.y+=Z[1]*w*I,O.z+=Z[2]*w*I}const B=p?S:PT(O.x,O.y,O.z,u),U=p?d.tilespaceRays.map(Z=>OT(Z,I)):d.queryGeometry.screenGeometry,q=Oe.vec4.transformMat4([],[O.x,O.y,O.z,1],u);if(!y&&p?E*=q[3]/l.cameraToCenterDistance:y&&!p&&(E*=l.cameraToCenterDistance/q[3]),p){const Z=Zo((k.y/Ot+R.y)/(1<<R.z));E/=l.projection.pixelsPerMeter(Z,1)/Os(1,Z)}if(le(U,B,E))return!0}return!1}function PT(d,o,l,u){const _=Oe.vec4.transformMat4([],[d,o,l,1],u);return new Ft(_[0]/_[3],_[1]/_[3])}const Ig=Oe.vec3.fromValues(0,0,0),vy=Oe.vec3.fromValues(0,0,1);function OT(d,o){const l=Oe.vec3.create();return Ig[2]=o,d.intersectsPlane(Ig,vy,l),new Ft(l[0],l[1])}class by extends te{}let xy,FT,LT,NT;function bw(d,{width:o,height:l},u,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==o*l*u)throw new RangeError("mismatched image size")}else _=new Uint8Array(o*l*u);return d.width=o,d.height=l,d.data=_,d}function Fb(d,o,l){const{width:u,height:_}=o;u===d.width&&_===d.height||(xw(d,o,{x:0,y:0},{x:0,y:0},{width:Math.min(d.width,u),height:Math.min(d.height,_)},l,null),d.width=u,d.height=_,d.data=o.data)}function xw(d,o,l,u,_,p,y,T){if(0===_.width||0===_.height)return o;if(_.width>d.width||_.height>d.height||l.x>d.width-_.width||l.y>d.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>o.width||_.height>o.height||u.x>o.width-_.width||u.y>o.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const E=d.data,R=o.data,w=4===p&&T;for(let D=0;D<_.height;D++){const k=((l.y+D)*d.width+l.x)*p,S=((u.y+D)*o.width+u.x)*p;if(w)for(let I=0;I<_.width;I++){const O=k+I*p+3,B=S+I*p;R[B+0]=255,R[B+1]=255,R[B+2]=255,R[B+3]=E[O]}else if(y)for(let I=0;I<_.width;I++){const O=k+I*p,B=S+I*p,U=E[O+3],q=new ki(E[O+0]/255*U,E[O+1]/255*U,E[O+2]/255*U,U).toRenderColor(y).toArray();R[B+0]=q[0],R[B+1]=q[1],R[B+2]=q[2],R[B+3]=q[3]}else for(let I=0;I<_.width*p;I++)R[S+I]=E[k+I]}return o}Zt(by,"HeatmapBucket",{omit:["layers"]});class Tf{constructor(o,l){bw(this,o,1,l)}resize(o){Fb(this,new Tf(o),1)}clone(){return new Tf({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,u,_,p){xw(o,l,u,_,p,1,null)}}class Nr{constructor(o,l){bw(this,o,4,l)}resize(o){Fb(this,new Nr(o),4)}replace(o,l){l?this.data.set(o):this.data=o instanceof Uint8ClampedArray?new Uint8Array(o.buffer):o}clone(){return new Nr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(o,l,u,_,p,y,T){xw(o,l,u,_,p,4,y,T)}}class Lb{constructor(o,l){this.width=o.width,this.height=o.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function kg(d){const o={},l=d.resolution||256,u=d.clips?d.clips.length:1,_=d.image||new Nr({width:l,height:u}),p=(y,T,E)=>{o[d.evaluationKey]=E;const R=d.expression.evaluate(o);R&&(_.data[y+T+0]=Math.floor(255*R.r/R.a),_.data[y+T+1]=Math.floor(255*R.g/R.a),_.data[y+T+2]=Math.floor(255*R.b/R.a),_.data[y+T+3]=Math.floor(255*R.a))};if(d.clips)for(let y=0,T=0;y<u;++y,T+=4*l)for(let E=0,R=0;E<l;E++,R+=4){const w=E/(l-1),{start:D,end:k}=d.clips[y];p(T,R,D*(1-w)+k*w)}else for(let y=0,T=0;y<l;y++,T+=4)p(0,T,y/(l-1));return _}Zt(Tf,"AlphaImage"),Zt(Nr,"RGBAImage");const Nb=Ri([{name:"a_pos",components:2,type:"Int16"}],4),{members:jL}=Nb;function zb(d,o,l=2){const u=o&&o.length,_=u?o[0]*l:d.length;let p=la(d,0,_,l,!0);const y=[];if(!p||p.next===p.prev)return y;let T,E,R;if(u&&(p=function(w,D,k,S){const I=[];for(let O=0,B=D.length;O<B;O++){const U=la(w,D[O]*S,O<B-1?D[O+1]*S:w.length,S,!1);U===U.next&&(U.steiner=!0),I.push(Sk(U))}I.sort(VT);for(let O=0;O<I.length;O++)k=Mk(I[O],k);return k}(d,o,p,l)),d.length>80*l){T=1/0,E=1/0;let w=-1/0,D=-1/0;for(let k=l;k<_;k+=l){const S=d[k],I=d[k+1];S<T&&(T=S),I<E&&(E=I),S>w&&(w=S),I>D&&(D=I)}R=Math.max(w-T,D-E),R=0!==R?32767/R:0}return Hp(p,y,l,T,E,R,0),y}function la(d,o,l,u,_){let p;if(_===function(y,T,E,R){let w=0;for(let D=T,k=E-R;D<E;D+=R)w+=(y[k]-y[D])*(y[D+1]+y[k+1]),k=D;return w}(d,o,l,u)>0)for(let y=o;y<l;y+=u)p=Mw(y/u|0,d[y],d[y+1],p);else for(let y=l-u;y>=o;y-=u)p=Mw(y/u|0,d[y],d[y+1],p);return p&&wy(p,p.next)&&(Ty(p),p=p.next),p}function Cc(d,o){if(!d)return d;o||(o=d);let l,u=d;do{if(l=!1,u.steiner||!wy(u,u.next)&&0!==Ao(u.prev,u,u.next))u=u.next;else{if(Ty(u),u=o=u.prev,u===u.next)break;l=!0}}while(l||u!==o);return o}function Hp(d,o,l,u,_,p,y){if(!d)return;!y&&p&&function(E,R,w,D){let k=E;do{0===k.z&&(k.z=ww(k.x,k.y,R,w,D)),k.prevZ=k.prev,k.nextZ=k.next,k=k.next}while(k!==E);k.prevZ.nextZ=null,k.prevZ=null,function(S){let I,O=1;do{let B,U=S;S=null;let q=null;for(I=0;U;){I++;let Z=U,$=0;for(let K=0;K<O&&($++,Z=Z.nextZ,Z);K++);let Y=O;for(;$>0||Y>0&&Z;)0!==$&&(0===Y||!Z||U.z<=Z.z)?(B=U,U=U.nextZ,$--):(B=Z,Z=Z.nextZ,Y--),q?q.nextZ=B:S=B,B.prevZ=q,q=B;U=Z}q.nextZ=null,O*=2}while(I>1)}(k)}(d,u,_,p);let T=d;for(;d.prev!==d.next;){const E=d.prev,R=d.next;if(p?Ck(d,u,_,p):zT(d))o.push(E.i,d.i,R.i),Ty(d),d=R.next,T=R.next;else if((d=R)===T){y?1===y?Hp(d=BT(Cc(d),o),o,l,u,_,p,2):2===y&&Tk(d,o,l,u,_,p):Hp(Cc(d),o,l,u,_,p,1);break}}}function zT(d){const o=d.prev,l=d,u=d.next;if(Ao(o,l,u)>=0)return!1;const _=o.x,p=l.x,y=u.x,T=o.y,E=l.y,R=u.y,w=_<p?_<y?_:y:p<y?p:y,D=T<E?T<R?T:R:E<R?E:R,k=_>p?_>y?_:y:p>y?p:y,S=T>E?T>R?T:R:E>R?E:R;let I=u.next;for(;I!==o;){if(I.x>=w&&I.x<=k&&I.y>=D&&I.y<=S&&Ag(_,T,p,E,y,R,I.x,I.y)&&Ao(I.prev,I,I.next)>=0)return!1;I=I.next}return!0}function Ck(d,o,l,u){const _=d.prev,p=d,y=d.next;if(Ao(_,p,y)>=0)return!1;const T=_.x,E=p.x,R=y.x,w=_.y,D=p.y,k=y.y,S=T<E?T<R?T:R:E<R?E:R,I=w<D?w<k?w:k:D<k?D:k,O=T>E?T>R?T:R:E>R?E:R,B=w>D?w>k?w:k:D>k?D:k,U=ww(S,I,o,l,u),q=ww(O,B,o,l,u);let Z=d.prevZ,$=d.nextZ;for(;Z&&Z.z>=U&&$&&$.z<=q;){if(Z.x>=S&&Z.x<=O&&Z.y>=I&&Z.y<=B&&Z!==_&&Z!==y&&Ag(T,w,E,D,R,k,Z.x,Z.y)&&Ao(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,$.x>=S&&$.x<=O&&$.y>=I&&$.y<=B&&$!==_&&$!==y&&Ag(T,w,E,D,R,k,$.x,$.y)&&Ao($.prev,$,$.next)>=0))return!1;$=$.nextZ}for(;Z&&Z.z>=U;){if(Z.x>=S&&Z.x<=O&&Z.y>=I&&Z.y<=B&&Z!==_&&Z!==y&&Ag(T,w,E,D,R,k,Z.x,Z.y)&&Ao(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;$&&$.z<=q;){if($.x>=S&&$.x<=O&&$.y>=I&&$.y<=B&&$!==_&&$!==y&&Ag(T,w,E,D,R,k,$.x,$.y)&&Ao($.prev,$,$.next)>=0)return!1;$=$.nextZ}return!0}function BT(d,o){let l=d;do{const u=l.prev,_=l.next.next;!wy(u,_)&&Cw(u,l,l.next,_)&&Rg(u,_)&&Rg(_,u)&&(o.push(u.i,l.i,_.i),Ty(l),Ty(l.next),l=d=_),l=l.next}while(l!==d);return Cc(l)}function Tk(d,o,l,u,_,p){let y=d;do{let T=y.next.next;for(;T!==y.prev;){if(y.i!==T.i&&Ek(y,T)){let E=Tw(y,T);return y=Cc(y,y.next),E=Cc(E,E.next),Hp(y,o,l,u,_,p,0),void Hp(E,o,l,u,_,p,0)}T=T.next}y=y.next}while(y!==d)}function VT(d,o){return d.x-o.x}function Mk(d,o){const l=function(_,p){let y=p;const T=_.x,E=_.y;let R,w=-1/0;do{if(E<=y.y&&E>=y.next.y&&y.next.y!==y.y){const O=y.x+(E-y.y)*(y.next.x-y.x)/(y.next.y-y.y);if(O<=T&&O>w&&(w=O,R=y.x<y.next.x?y:y.next,O===T))return R}y=y.next}while(y!==p);if(!R)return null;const D=R,k=R.x,S=R.y;let I=1/0;y=R;do{if(T>=y.x&&y.x>=k&&T!==y.x&&Ag(E<S?T:w,E,k,S,E<S?w:T,E,y.x,y.y)){const O=Math.abs(E-y.y)/(T-y.x);Rg(y,_)&&(O<I||O===I&&(y.x>R.x||y.x===R.x&&UT(R,y)))&&(R=y,I=O)}y=y.next}while(y!==D);return R}(d,o);if(!l)return o;const u=Tw(l,d);return Cc(u,u.next),Cc(l,l.next)}function UT(d,o){return Ao(d.prev,d,o.prev)<0&&Ao(o.next,d,d.next)<0}function ww(d,o,l,u,_){return(d=1431655765&((d=858993459&((d=252645135&((d=16711935&((d=(d-l)*_|0)|d<<8))|d<<4))|d<<2))|d<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-u)*_|0)|o<<8))|o<<4))|o<<2))|o<<1))<<1}function Sk(d){let o=d,l=d;do{(o.x<l.x||o.x===l.x&&o.y<l.y)&&(l=o),o=o.next}while(o!==d);return l}function Ag(d,o,l,u,_,p,y,T){return(_-y)*(o-T)>=(d-y)*(p-T)&&(d-y)*(u-T)>=(l-y)*(o-T)&&(l-y)*(p-T)>=(_-y)*(u-T)}function Ek(d,o){return d.next.i!==o.i&&d.prev.i!==o.i&&!function(l,u){let _=l;do{if(_.i!==l.i&&_.next.i!==l.i&&_.i!==u.i&&_.next.i!==u.i&&Cw(_,_.next,l,u))return!0;_=_.next}while(_!==l);return!1}(d,o)&&(Rg(d,o)&&Rg(o,d)&&function(l,u){let _=l,p=!1;const y=(l.x+u.x)/2,T=(l.y+u.y)/2;do{_.y>T!=_.next.y>T&&_.next.y!==_.y&&y<(_.next.x-_.x)*(T-_.y)/(_.next.y-_.y)+_.x&&(p=!p),_=_.next}while(_!==l);return p}(d,o)&&(Ao(d.prev,d,o.prev)||Ao(d,o.prev,o))||wy(d,o)&&Ao(d.prev,d,d.next)>0&&Ao(o.prev,o,o.next)>0)}function Ao(d,o,l){return(o.y-d.y)*(l.x-o.x)-(o.x-d.x)*(l.y-o.y)}function wy(d,o){return d.x===o.x&&d.y===o.y}function Cw(d,o,l,u){const _=Cy(Ao(d,o,l)),p=Cy(Ao(d,o,u)),y=Cy(Ao(l,u,d)),T=Cy(Ao(l,u,o));return _!==p&&y!==T||!(0!==_||!$p(d,l,o))||!(0!==p||!$p(d,u,o))||!(0!==y||!$p(l,d,u))||!(0!==T||!$p(l,o,u))}function $p(d,o,l){return o.x<=Math.max(d.x,l.x)&&o.x>=Math.min(d.x,l.x)&&o.y<=Math.max(d.y,l.y)&&o.y>=Math.min(d.y,l.y)}function Cy(d){return d>0?1:d<0?-1:0}function Rg(d,o){return Ao(d.prev,d,d.next)<0?Ao(d,o,d.next)>=0&&Ao(d,d.prev,o)>=0:Ao(d,o,d.prev)<0||Ao(d,d.next,o)<0}function Tw(d,o){const l=Sw(d.i,d.x,d.y),u=Sw(o.i,o.x,o.y),_=d.next,p=o.prev;return d.next=o,o.prev=d,l.next=_,_.prev=l,u.next=l,l.prev=u,p.next=u,u.prev=p,u}function Mw(d,o,l,u){const _=Sw(d,o,l);return u?(_.next=u.next,_.prev=u,u.next.prev=_,u.next=_):(_.prev=_,_.next=_),_}function Ty(d){d.next.prev=d.prev,d.prev.next=d.next,d.prevZ&&(d.prevZ.nextZ=d.nextZ),d.nextZ&&(d.nextZ.prevZ=d.prevZ)}function Sw(d,o,l){return{i:d,x:o,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Bb(d,o){const l=d.length;if(l<=1)return[d];const u=[];let _,p;for(let y=0;y<l;y++){const T=Uh(d[y]);0!==T&&(d[y].area=Math.abs(T),void 0===p&&(p=T<0),p===T<0?(_&&u.push(_),_=[d[y]]):_.push(d[y]))}if(_&&u.push(_),o>1)for(let y=0;y<u.length;y++)u[y].length<=o||(Xi(u[y],o,1,u[y].length-1,Dk),u[y]=u[y].slice(0,o));return u}function Dk(d,o){return o.area-d.area}function Ew(d,o){if(!d)return null;const l="string"==typeof d?d:d.getPrimary().id;o[l]||(o[l]=[]);const u=Ko.from(d).getPrimary();return o[l].push(u),u.serialize()}function jT(d,o,l){const u=l.patternDependencies;let _=!1;for(const p of o){const y=p.paint.get(`${d}-pattern`);y.isConstant()||(_=!0),Ew(y.constantOr(null),u)&&(_=!0)}return _}function Vb(d,o,l,u,_){const p=_.patternDependencies;for(const y of o){const T=y.paint.get(`${d}-pattern`).value;if("constant"!==T.kind){let E=T.evaluate({zoom:u},l,{},_.availableImages);E=E&&E.name?E.name:E;const R=Ew(E,p);R&&(l.patterns[y.id]=R)}}return l}class Dw{constructor(o){this.zoom=o.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Jc,this.indexArray=new es,this.indexArray2=new td,this.programConfigurations=new xc(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new ni,this.segments2=new ni,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=o.projection}updateFootprints(o,l){}populate(o,l,u,_){this.hasPattern=jT("fill",this.layers,l);const p=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:T,id:E,index:R,sourceLayerIndex:w}of o){const D=this.layers[0]._featureFilter.needGeometry,k=G(T,D);if(!this.layers[0]._featureFilter.filter(new _r(this.zoom),k,u))continue;const S=p?p.evaluate(k,{},u,l.availableImages):void 0,I={id:E,properties:T.properties,type:T.type,sourceLayerIndex:w,index:R,geometry:D?k.geometry:j(T,u,_),patterns:{},sortKey:S};y.push(I)}p&&y.sort((T,E)=>T.sortKey-E.sortKey);for(const T of y){const{geometry:E,index:R,sourceLayerIndex:w}=T;if(this.hasPattern){const D=Vb("fill",this.layers,T,this.zoom,l);this.patternFeatures.push(D)}else this.addFeature(T,E,R,u,{},l.availableImages,l.brightness);l.featureIndex.insert(o[R].feature,E,R,w,this.index)}}update(o,l,u,_,p,y,T){this.programConfigurations.updatePaintArrays(o,l,p,u,_,y,T)}addFeatures(o,l,u,_,p,y){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,l,u,_,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,jL),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.indexBuffer2=o.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(o,l,u,_,p,y=[],T){for(const E of Bb(l,500)){let R=0;for(const O of E)R+=O.length;const w=this.segments.prepareSegment(R,this.layoutVertexArray,this.indexArray),D=w.vertexLength,k=[],S=[];for(const O of E){if(0===O.length)continue;O!==E[0]&&S.push(k.length/2);const B=this.segments2.prepareSegment(O.length,this.layoutVertexArray,this.indexArray2),U=B.vertexLength;this.layoutVertexArray.emplaceBack(O[0].x,O[0].y),this.indexArray2.emplaceBack(U+O.length-1,U),k.push(O[0].x),k.push(O[0].y);for(let q=1;q<O.length;q++)this.layoutVertexArray.emplaceBack(O[q].x,O[q].y),this.indexArray2.emplaceBack(U+q-1,U+q),k.push(O[q].x),k.push(O[q].y);B.vertexLength+=O.length,B.primitiveLength+=O.length}const I=zb(k,S);for(let O=0;O<I.length;O+=3)this.indexArray.emplaceBack(D+I[O],D+I[O+1],D+I[O+2]);w.vertexLength+=R,w.primitiveLength+=I.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,p,y,_,T)}}let HT,Ik,$T,Iw;Zt(Dw,"FillBucket",{omit:["layers","patternFeatures"]});class My{constructor(o,l,u,_){if(this.triangleCount=l.length/3,this.min=new Ft(0,0),this.max=new Ft(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],0===this.triangleCount||0===o.length)return;const[p,y]=[o[0].clone(),o[0].clone()];for(let D=1;D<o.length;++D){const k=o[D];p.x=Math.min(p.x,k.x),p.y=Math.min(p.y,k.y),y.x=Math.max(y.x,k.x),y.y=Math.max(y.y,k.y)}if(_){const D=Math.ceil(Math.max(y.x-p.x,y.y-p.y)/_);u=Math.max(u,D)}if(0===u)return;this.min=p,this.max=y;const T=this.max.sub(this.min);T.x=Math.max(T.x,1),T.y=Math.max(T.y,1);const E=Math.max(T.x,T.y)/u;this.cellsX=Math.max(1,Math.ceil(T.x/E)),this.cellsY=Math.max(1,Math.ceil(T.y/E)),this.xScale=1/E,this.yScale=1/E;const R=[];for(let D=0;D<this.triangleCount;D++){const k=o[l[3*D+0]].sub(this.min),S=o[l[3*D+1]].sub(this.min),I=o[l[3*D+2]].sub(this.min),O=Zd(Math.floor(Math.min(k.x,S.x,I.x)),this.xScale,this.cellsX),B=Zd(Math.floor(Math.max(k.x,S.x,I.x)),this.xScale,this.cellsX),U=Zd(Math.floor(Math.min(k.y,S.y,I.y)),this.yScale,this.cellsY),q=Zd(Math.floor(Math.max(k.y,S.y,I.y)),this.yScale,this.cellsY),Z=new Ft(0,0),$=new Ft(0,0),Y=new Ft(0,0),K=new Ft(0,0);for(let ee=U;ee<=q;++ee){Z.y=$.y=ee*E,Y.y=K.y=(ee+1)*E;for(let ue=O;ue<=B;++ue)Z.x=Y.x=ue*E,$.x=K.x=(ue+1)*E,(Be(k,S,I,Z,$,K)||Be(k,S,I,Z,K,Y))&&R.push({cellIdx:ee*this.cellsX+ue,triIdx:D})}}if(0===R.length)return;R.sort((D,k)=>D.cellIdx-k.cellIdx||D.triIdx-k.triIdx);let w=0;for(;w<R.length;){const D=R[w].cellIdx,k={start:this.payload.length,len:0};for(;w<R.length&&R[w].cellIdx===D;)++k.len,this.payload.push(R[w++].triIdx);this.cells[D]=k}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(o,l){if(0===this.triangleCount||0===this.cells.length||o.x>this.max.x||this.min.x>o.x||o.y>this.max.y||this.min.y>o.y)return;const u=Zd(o.x-this.min.x,this.xScale,this.cellsX),_=Zd(o.y-this.min.y,this.yScale,this.cellsY),p=this.cells[_*this.cellsX+u];if(p){this._lazyInitLookup();for(let y=0;y<p.len;y++){const T=this.payload[p.start+y],E=Math.floor(T/8),R=1<<T%8;if(!(this.lookup[E]&R)&&(this.lookup[E]|=R,l.push(T),l.length===this.triangleCount))return}}}query(o,l,u){if(0===this.triangleCount||0===this.cells.length||o.x>this.max.x||this.min.x>l.x||o.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const _=Zd(o.x-this.min.x,this.xScale,this.cellsX),p=Zd(l.x-this.min.x,this.xScale,this.cellsX),y=Zd(o.y-this.min.y,this.yScale,this.cellsY),T=Zd(l.y-this.min.y,this.yScale,this.cellsY);for(let E=y;E<=T;E++)for(let R=_;R<=p;R++){const w=this.cells[E*this.cellsX+R];if(w)for(let D=0;D<w.len;D++){const k=this.payload[w.start+D],S=Math.floor(k/8),I=1<<k%8;if(!(this.lookup[S]&I)&&(this.lookup[S]|=I,u.push(k),u.length===this.triangleCount))return}}}}function Zd(d,o,l){return Math.max(0,Math.min(l-1,Math.floor(d*o)))}Zt(My,"TriangleGridIndex");class sd{constructor(o){this.zoom=o.zoom,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[]}updateFootprints(o,l){for(const u of this.footprints)l.push({footprint:u,id:o})}populate(o,l,u,_){const p=[];for(const{feature:y,id:T,index:E,sourceLayerIndex:R}of o){const w=this.layers[0]._featureFilter.needGeometry,D=G(y,w);if(!this.layers[0]._featureFilter.filter(new _r(this.zoom),D,u))continue;const k={id:T,properties:y.properties,type:y.type,sourceLayerIndex:R,index:E,geometry:w?D.geometry:j(y,u,_),patterns:{}};p.push(k)}for(const y of p){const{geometry:T,index:E,sourceLayerIndex:R}=y;this.addFeature(y,T,E,u,{},l.availableImages,l.brightness),l.featureIndex.insert(o[E].feature,T,E,R,this.index)}}isEmpty(){return 0===this.footprints.length}uploadPending(){return!1}upload(o){}update(o,l,u,_,p,y,T){}destroy(){}addFeature(o,l,u,_,p,y=[],T){for(const E of Bb(l,2)){const R=[],w=[],D=[],k=new Ft(1/0,1/0),S=new Ft(-1/0,-1/0);for(const B of E)if(0!==B.length){B!==E[0]&&D.push(w.length/2);for(let U=0;U<B.length;U++)w.push(B[U].x),w.push(B[U].y),R.push(B[U]),k.x=Math.min(k.x,B[U].x),k.y=Math.min(k.y,B[U].y),S.x=Math.max(S.x,B[U].x),S.y=Math.max(S.y,B[U].y)}const I=zb(w,D),O=new My(R,I,8,256);this.footprints.push({vertices:R,indices:I,grid:O,min:k,max:S})}}}Zt(sd,"ClipBucket",{omit:["layers"]});const Mf=Ri([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),kk=Ri([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),kw=Ri([{name:"a_centroid_pos",components:2,type:"Uint16"}]),rh=Ri([{name:"a_join_normal_inside",components:3,type:"Int16"}]),HL=Ri([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Ga=Ri([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Aw}=Mf;var Rw,GT,qT,WT,oh,ZT,Ub,Pg={};function Gp(){if(GT)return Rw;GT=1;var d=xu();function o(_,p,y,T,E){this.properties={},this.extent=y,this.type=0,this._pbf=_,this._geometry=-1,this._keys=T,this._values=E,_.readFields(l,this,p)}function l(_,p,y){1==_?p.id=y.readVarint():2==_?function(T,E){for(var R=T.readVarint()+T.pos;T.pos<R;){var w=E._keys[T.readVarint()],D=E._values[T.readVarint()];E.properties[w]=D}}(y,p):3==_?p.type=y.readVarint():4==_&&(p._geometry=y.pos)}function u(_){for(var p,y,T=0,E=0,R=_.length,w=R-1;E<R;w=E++)T+=((y=_[w]).x-(p=_[E]).x)*(p.y+y.y);return T}return Rw=o,o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var _=this._pbf;_.pos=this._geometry;for(var p,y=_.readVarint()+_.pos,T=1,E=0,R=0,w=0,D=[];_.pos<y;){if(E<=0){var k=_.readVarint();T=7&k,E=k>>3}if(E--,1===T||2===T)R+=_.readSVarint(),w+=_.readSVarint(),1===T&&(p&&D.push(p),p=[]),p.push(new d(R,w));else{if(7!==T)throw new Error("unknown command "+T);p&&p.push(p[0].clone())}}return p&&D.push(p),D},o.prototype.bbox=function(){var _=this._pbf;_.pos=this._geometry;for(var p=_.readVarint()+_.pos,y=1,T=0,E=0,R=0,w=1/0,D=-1/0,k=1/0,S=-1/0;_.pos<p;){if(T<=0){var I=_.readVarint();y=7&I,T=I>>3}if(T--,1===y||2===y)(E+=_.readSVarint())<w&&(w=E),E>D&&(D=E),(R+=_.readSVarint())<k&&(k=R),R>S&&(S=R);else if(7!==y)throw new Error("unknown command "+y)}return[w,k,D,S]},o.prototype.toGeoJSON=function(_,p,y){var T,E,R=this.extent*Math.pow(2,y),w=this.extent*_,D=this.extent*p,k=this.loadGeometry(),S=o.types[this.type];function I(U){for(var q=0;q<U.length;q++){var Z=U[q];U[q]=[360*(Z.x+w)/R-180,360/Math.PI*Math.atan(Math.exp((180-360*(Z.y+D)/R)*Math.PI/180))-90]}}switch(this.type){case 1:var O=[];for(T=0;T<k.length;T++)O[T]=k[T][0];I(k=O);break;case 2:for(T=0;T<k.length;T++)I(k[T]);break;case 3:for(k=function(U){var q=U.length;if(q<=1)return[U];for(var Z,$,Y=[],K=0;K<q;K++){var ee=u(U[K]);0!==ee&&(void 0===$&&($=ee<0),$===ee<0?(Z&&Y.push(Z),Z=[U[K]]):Z.push(U[K]))}return Z&&Y.push(Z),Y}(k),T=0;T<k.length;T++)for(E=0;E<k[T].length;E++)I(k[T][E])}1===k.length?k=k[0]:S="Multi"+S;var B={type:"Feature",geometry:{type:S,coordinates:k},properties:this.properties};return"id"in this&&(B.id=this.id),B},Rw}function Sy(){if(WT)return qT;WT=1;var d=Gp();function o(u,_){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(l,this,_),this.length=this._features.length}function l(u,_,p){15===u?_.version=p.readVarint():1===u?_.name=p.readString():5===u?_.extent=p.readVarint():2===u?_._features.push(p.pos):3===u?_._keys.push(p.readString()):4===u&&_._values.push(function(y){for(var T=null,E=y.readVarint()+y.pos;y.pos<E;){var R=y.readVarint()>>3;T=1===R?y.readString():2===R?y.readFloat():3===R?y.readDouble():4===R?y.readVarint64():5===R?y.readVarint():6===R?y.readSVarint():7===R?y.readBoolean():null}return T}(p))}return qT=o,o.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var _=this._pbf.readVarint()+this._pbf.pos;return new d(this._pbf,_,this.extent,this._keys,this._values)},qT}function jb(){return Ub||(Ub=1,Pg.VectorTile=function(){if(ZT)return oh;ZT=1;var d=Sy();function o(l,u,_){if(3===l){var p=new d(_,_.readVarint()+_.pos);p.length&&(u[p.name]=p)}}return oh=function(l,u){this.layers=l.readFields(o,{},u)}}(),Pg.VectorTileFeature=Gp(),Pg.VectorTileLayer=Sy()),Pg}var Yd=jb();class Xd extends Ft{constructor(o,l,u){super(o,l),this.z=u}}class sh extends Xd{constructor(o,l,u,_){super(o,l,u),this.w=_}}function Og(d,o,l,u){const _=[],p=0===u?(y,T,E,R,w,D)=>{y.push(new Ft(D,E+(D-T)/(R-T)*(w-E)))}:(y,T,E,R,w,D)=>{y.push(new Ft(T+(D-E)/(w-E)*(R-T),D))};for(const y of d){const T=[];for(const E of y){if(E.length<=2)continue;const R=[];for(let k=0;k<E.length-1;k++){const S=E[k].x,I=E[k].y,O=E[k+1].x,B=E[k+1].y,U=0===u?S:I,q=0===u?O:B;U<o?q>o&&p(R,S,I,O,B,o):U>l?q<l&&p(R,S,I,O,B,l):R.push(E[k]),q<o&&U>=o&&p(R,S,I,O,B,o),q>l&&U<=l&&p(R,S,I,O,B,l)}let w=E[E.length-1];const D=0===u?w.x:w.y;D>=o&&D<=l&&R.push(w),R.length&&(w=R[R.length-1],R[0].x===w.x&&R[0].y===w.y||R.push(R[0]),T.push(R))}T.length&&_.push(T)}return _}function Ey(d,o,l,u){const _="x"===l?"y":"x",p=(u-d[l])/(o[l]-d[l]);d[_]=d[_]+(o[_]-d[_])*p,d[l]=u,d.hasOwnProperty("z")&&(d.z=Lt(d.z,o.z,p)),d.hasOwnProperty("w")&&(d.w=Lt(d.w,o.w,p))}function Fg(d,o,l,u){const _=l,p=u;for(const y of["x","y"]){let T=d,E=o;T[y]>=E[y]&&(T=o,E=d),T[y]<_&&E[y]>_&&Ey(T,E,y,_),T[y]<p&&E[y]>p&&Ey(E,T,y,p)}}const Lg=Number.MAX_SAFE_INTEGER;function Hb(d,o,l,u){return d.order<o||d.order===Lg||!(d.clipMask&l)||(_=u,0!==(p=d.clipScope).length&&void 0===p.find(y=>y===_));var _,p}function qp(d,o){return d.x-o.x||d.y-o.y}function Pw(d,o){return 0===qp(d.min,o.min)&&0===qp(d.max,o.max)}function Dy(d,o){return!(d.min.x>o.max.x||d.max.x<o.min.x||d.min.y>o.max.y||d.max.y<o.min.y)}function YT(d,o){if(d.length!==o.length)return!1;for(let l=0;l<d.length;l++)if(d[l].sourceId!==o[l].sourceId||!Pw(d[l],o[l])||d[l].order!==o[l].order||d[l].clipMask!==o[l].clipMask||!zc(d[l].clipScope,o[l].clipScope))return!1;return!0}function Wp(d,o,l){const u=1/Ot,_=1/(1<<l.canonical.z),p=(o.x*u+l.canonical.x)*_+l.wrap,y=(o.y*u+l.canonical.y)*_;return{min:new Ft((d.x*u+l.canonical.x)*_+l.wrap,(d.y*u+l.canonical.y)*_),max:new Ft(p,y)}}function XT(d,o,l){const u=1<<l.canonical.z,_=((o.x-l.wrap)*u-l.canonical.x)*Ot,p=(o.y*u-l.canonical.y)*Ot;return{min:new Ft(((d.x-l.wrap)*u-l.canonical.x)*Ot,(d.y*u-l.canonical.y)*Ot),max:new Ft(_,p)}}function Ow(d,o,l,u,_,p,y){const T=d.indices,E=d.vertices,R=[];for(let w=u;w<u+_;w+=3){const D=o[l[w+0]+p],k=o[l[w+1]+p],S=o[l[w+2]+p],I=Math.min(D.x,k.x,S.x),O=Math.max(D.x,k.x,S.x),B=Math.min(D.y,k.y,S.y),U=Math.max(D.y,k.y,S.y);R.length=0,d.grid.query(new Ft(I,B),new Ft(O,U),R);for(let q=0;q<R.length;q++){const Z=R[q];if(Be(E[T[3*Z+0]],E[T[3*Z+1]],E[T[3*Z+2]],D,k,S,y))return!0}}return!1}function Fw(d,o,l,u){if(!d||!l)return!1;let _=d.vertices;if(!o.canonical.equals(u.canonical)||o.wrap!==u.wrap){if(l.vertices.length<d.vertices.length)return Fw(l,u,d,o);const p=o.canonical,y=u.canonical,T=Math.pow(2,y.z-p.z);_=d.vertices.map(E=>new Ft((E.x+p.x*Ot)*T-y.x*Ot,(E.y+p.y*Ot)*T-y.y*Ot))}return Ow(l,_,d.indices,0,d.indices.length,0,0)}function $b(d,o,l,u){const _=Math.pow(2,u.z-l.z);return new Ft((d+l.x*Ot)*_-u.x*Ot,(o+l.y*Ot)*_-u.y*Ot)}function Lw(d,o){const l=[];o.grid.queryPoint(d,l);const u=o.indices,_=o.vertices;for(let p=0;p<l.length;p++){const y=l[p];if(Re([_[u[3*y+0]],_[u[3*y+1]],_[u[3*y+2]]],d))return!0}return!1}const Gb=[new Ft(0,0),new Ft(Ot,0),new Ft(Ot,Ot),new Ft(0,Ot)];function qb(d,o){const l=[];let u=[];if(!o||d.length<2)return[d];if(2===d.length)return qe(d[0],d[1],Gb)?[d]:[];for(let _=0;_<d.length+2;_++){const p=d[_%d.length],y=d[(_+1)%d.length],T=qe(0===_?d[d.length-1]:d[(_-1)%d.length],p,Gb),E=qe(p,y,Gb),R=T||E;R&&u.push(p),R&&E||u.length>0&&(u.length>1&&l.push(u),u=[])}return u.length>1&&l.push(u),l}const Iy=Yd.VectorTileFeature.types,ky=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],KT=["fill-extrusion-flood-light-ground-radius"],Es=Math.pow(2,13),$L=Math.pow(2,15)-1,Zp=new Ft(0,1),Kd=2147483648;function Ng(d,o,l,u,_,p,y,T){d.emplaceBack((o<<1)+y,(l<<1)+p,(Math.floor(u*Es)<<1)+_,Math.round(T))}function zg(d,o,l){d.emplaceBack(o.x*Ot,o.y*Ot,l?1:0)}function Ay(d,o,l,u,_,p){d.emplaceBack(o.x,o.y,(l.x<<1)+u,(l.y<<1)+_,p)}function Yp(d,o,l){d.emplaceBack(o.x,o.y,o.z,16384*l[0],16384*l[1],16384*l[2])}class Tc{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class QT{constructor(){this.centroidXY=new Ft(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Ft(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Ft(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Ft(this.max.x-this.min.x,this.max.y-this.min.y)}}class Nw{constructor(){this.acc=new Ft(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(o,l){o.min.x===Number.MAX_VALUE&&(o.min.x=o.max.x=l.x,o.min.y=o.max.y=l.y)}appendEdge(o,l,u){this.accCount++,this.acc._add(l);let _=!!this.borders;l.x<o.min.x?(o.min.x=l.x,_=!0):l.x>o.max.x&&(o.max.x=l.x,_=!0),l.y<o.min.y?(o.min.y=l.y,_=!0):l.y>o.max.y&&(o.max.y=l.y,_=!0),((0===l.x||l.x===Ot)&&l.x===u.x)!=((0===l.y||l.y===Ot)&&l.y===u.y)&&this.processBorderOverlap(l,u),_&&this.checkBorderIntersection(l,u)}checkBorderIntersection(o,l){l.x<0!=o.x<0&&this.addBorderIntersection(0,Lt(l.y,o.y,(0-l.x)/(o.x-l.x))),l.x>Ot!=o.x>Ot&&this.addBorderIntersection(1,Lt(l.y,o.y,(Ot-l.x)/(o.x-l.x))),l.y<0!=o.y<0&&this.addBorderIntersection(2,Lt(l.x,o.x,(0-l.y)/(o.y-l.y))),l.y>Ot!=o.y>Ot&&this.addBorderIntersection(3,Lt(l.x,o.x,(Ot-l.y)/(o.y-l.y)))}addBorderIntersection(o,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[o];l<u[0]&&(u[0]=l),l>u[1]&&(u[1]=l)}processBorderOverlap(o,l){if(o.x===l.x){if(o.y===l.y)return;const u=0===o.x?0:1;this.addBorderIntersection(u,l.y),this.addBorderIntersection(u,o.y)}else{const u=0===o.y?2:3;this.addBorderIntersection(u,l.x),this.addBorderIntersection(u,o.x)}}centroid(){return 0===this.accCount?new Ft(0,0):new Ft(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((o,l)=>o+ +(l[0]!==Number.MAX_VALUE),0):0}}function Ak(d,o){const l=d.add(o)._unit(),u=En(d.x*l.x+d.y*l.y,-1,1);var _,p,y;return y=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(y)))/4*$L*((_=d).x*(p=o).y-_.y*p.x<0?-1:1)}const ns=[d=>d.x<0,d=>d.x>Ot,d=>d.y<0,d=>d.y>Ot];function JT(d,o,l,u){const _=[4];if(0===u)return _;l._mult(u);const p=d.sub(l),y=o.sub(l),T=[d,o,p,y];for(let E=0;E<4;E++)for(const R of T)if(ns[E](R)){_.push(E);break}return _}class eM{constructor(o){this.vertexArray=new pl,this.indexArray=new es,this.programConfigurations=new xc(o.layers,{zoom:o.zoom,lut:o.lut},l=>KT.includes(l)),this._segments=new ni,this.hiddenByLandmarkVertexArray=new mf,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ni}getDefaultSegment(){return this.regionSegments[4]}hasData(){return 0!==this.vertexArray.length}addData(o,l,u,_=!1){const p=o.length;if(p>2){let y=Math.max(0,this._segments.get().length-1);const T=this._segments._prepareSegment(4*p,this.vertexArray.length,2*this._segmentToGroundQuads[y].length);let E;y!==this._segments.get().length-1&&(y++,this._segmentToGroundQuads[y]=[],this._segmentToRegionTriCounts[y]=[0,0,0,0,0]);{const R=o[0],w=o[1];E=Ak(R.sub(o[p-1])._perp()._unit(),w.sub(R)._perp()._unit())}for(let R=0;R<p;R++){const w=R===p-1?0:R+1,D=o[R],k=o[w],S=o[w===p-1?0:w+1],I=k.sub(D)._perp()._unit(),O=Ak(I,S.sub(k)._perp()._unit()),B=E,U=O;if(Xp(D,k,l)||_&&Ry(D,l)&&Ry(k,l)){E=O;continue}const q=T.vertexLength;Ay(this.vertexArray,D,k,1,1,B),Ay(this.vertexArray,D,k,1,0,B),Ay(this.vertexArray,D,k,0,1,U),Ay(this.vertexArray,D,k,0,0,U),T.vertexLength+=4;const Z=JT(D,k,I,u);for(const $ of Z)this._segmentToGroundQuads[y].push({id:q,region:$}),this._segmentToRegionTriCounts[y][$]+=2,T.primitiveLength+=2;E=O}}}prepareBorderSegments(){if(!this.hasData())return;const o=this._segments.get(),l=o.length;for(let u=0;u<l;u++)this._segmentToGroundQuads[u].sort((_,p)=>_.region-p.region);for(let u=0;u<l;u++){const _=this._segmentToGroundQuads[u],p=o[u],y=this._segmentToRegionTriCounts[u];y.reduce((E,R)=>E+R,0);let T=0;for(let E=0;E<=4;E++){const R=y[E];if(0!==R){let w=this.regionSegments[E];w||(w=this.regionSegments[E]=new ni);const D={vertexOffset:p.vertexOffset,primitiveOffset:p.primitiveOffset+T,vertexLength:p.vertexLength,primitiveLength:R};w.get().push(D)}T+=R}for(let E=0;E<_.length;E++){const R=_[E].id;this.indexArray.emplaceBack(R,R+1,R+3),this.indexArray.emplaceBack(R,R+3,R+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(o,l,u,_,p,y){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,o,l,u,_,p,y)}upload(o){this.hasData()&&(this.vertexBuffer=o.createVertexBuffer(this.vertexArray,kk.members),this.indexBuffer=o.createIndexBuffer(this.indexArray))}uploadPaintProperties(o){this.hasData()&&this.programConfigurations.upload(o)}update(o,l,u,_,p,y,T){this.hasData()&&this.programConfigurations.updatePaintArrays(o,l,u,_,p,y,T)}updateHiddenByLandmark(o){if(!this.hasData())return;const l=o.groundVertexCount+o.groundVertexArrayOffset;if(0===o.groundVertexCount)return;const u=o.flags&Kd?1:0;for(let _=o.groundVertexArrayOffset;_<l;++_)this.hiddenByLandmarkVertexArray.emplace(_,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(o){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=o.createVertexBuffer(this.hiddenByLandmarkVertexArray,HL.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let o=0;o<=4;o++){const l=this.regionSegments[o];l&&l.destroy()}}}}class lo{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=o.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new es,this.footprintVertices=new Jc,this.footprintSegments=[],this.layoutVertexArray=new fl,this.centroidVertexArray=new gy,this.wallVertexArray=new kb,this.indexArray=new es,this.programConfigurations=new xc(o.layers,{zoom:o.zoom,lut:o.lut},l=>ky.includes(l)),this.segments=new ni,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new eM(o),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(o,l){}populate(o,l,u,_){this.features=[],this.hasPattern=jT("fill-extrusion",this.layers,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=g(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=0!==this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1);for(const{feature:p,id:y,index:T,sourceLayerIndex:E}of o){const R=this.layers[0]._featureFilter.needGeometry,w=G(p,R);if(!this.layers[0]._featureFilter.filter(new _r(this.zoom),w,u))continue;const D={id:y,sourceLayerIndex:E,index:T,geometry:R?w.geometry:j(p,u,_),properties:p.properties,type:p.type,patterns:{}},k=this.layoutVertexArray.length,S="Polygon"===Iy[D.type];if(this.hasPattern)this.features.push(Vb("fill-extrusion",this.layers,D,this.zoom,l));else if(this.wallMode)for(const I of D.geometry)for(const O of qb(I,S))this.addFeature(D,[O],T,u,{},l.availableImages,_,l.brightness);else this.addFeature(D,D.geometry,T,u,{},l.availableImages,_,l.brightness);l.featureIndex.insert(p,D.geometry,T,E,this.index,k)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(o,l,u,_,p,y){for(const T of this.features){const E="Polygon"===Iy[T.type],{geometry:R}=T;if(this.wallMode)for(const w of R)for(const D of qb(w,E))this.addFeature(T,[D],T.index,l,u,_,p,y);else this.addFeature(T,R,T.index,l,u,_,p,y)}this.sortBorders(),"mercator"===this.projection.name&&this.splitToSubtiles()}update(o,l,u,_,p,y,T){this.programConfigurations.updatePaintArrays(o,l,p,u,_,y,T),this.groundEffect.update(o,l,p,u,_,y,T)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(o){this.uploaded||(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Aw),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.wallVertexBuffer=o.createVertexBuffer(this.wallVertexArray,rh.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=o.createVertexBuffer(this.layoutVertexExtArray,Ga.members,!0)),this.groundEffect.upload(o)),this.groundEffect.uploadPaintProperties(o),this.programConfigurations.upload(o),this.uploaded=!0}uploadCentroid(o){this.groundEffect.uploadHiddenByLandmark(o),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=o.createVertexBuffer(this.centroidVertexArray,kw.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(o,l,u,_,p,y,T,E){const R=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,w=[new Ft(0,0),new Ft(Ot,Ot)],D=T.projection,k="globe"===D.name,S=this.wallMode||"Polygon"===Iy[o.type],I=new Nw;I.centroidDataIndex=this.centroidData.length;const O=new QT,B=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},_)<=0,U=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},_);let q;if(O.height=U,O.vertexArrayOffset=this.layoutVertexArray.length,O.groundVertexArrayOffset=this.groundEffect.vertexArray.length,k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new fi),this.wallMode){if(k)return void Yn("Non zero fill-extrusion-line-width is not yet supported on globe.");if(1!==l.length)return;q=function(ce){const we=ce[0].x===ce[ce.length-1].x&&ce[0].y===ce[ce.length-1].y;(function(zt){let lt=0;const en=zt.length;for(let It=0;It<en;It++)lt+=(zt[(It+1)%en].x-zt[It].x)*(zt[(It+1)%en].y+zt[It].y);return lt>=0})(ce)||(ce=ce.reverse());const Te={geometry:[],joinNormals:[],indices:[]},ke=[],De=[],Pe=[];let Ne=ce.length;for(;Ne>=2&&ce[Ne-1].equals(ce[Ne-2]);)Ne--;if(Ne<(we?3:2))return Te;let je,Le,it,_t,rt,Et=0;for(;Et<Ne-1&&ce[Et].equals(ce[Et+1]);)Et++;we&&(je=ce[Ne-2],rt=ce[Et].sub(je)._unit()._perp());for(let zt=Et;zt<Ne;zt++){if(it=zt===Ne-1?we?ce[Et+1]:void 0:ce[zt+1],it&&ce[zt].equals(it))continue;rt&&(_t=rt),je&&(Le=je),je=ce[zt],rt=it?it.sub(je)._unit()._perp():_t,_t=_t||rt;let lt=_t.add(rt);0===lt.x&&0===lt.y||lt._unit();const en=lt.x*rt.x+lt.y*rt.y,It=0!==en?1/en:1/0,Xt=_t.x*rt.y-_t.y*rt.x>0;let dn="miter";const On=2;"miter"===dn&&It>On&&(dn="bevel"),"bevel"===dn&&(It>100&&(dn="flipbevel"),It<On&&(dn="miter"));const Hn=(Qn,$n,di,lr)=>{const qi=new Ft(Qn.x,Qn.y),Cn=new Ft(Qn.x,Qn.y);qi.x+=$n.x*lr,qi.y+=$n.y*lr,Cn.x-=$n.x*Math.max(di,1),Cn.y-=$n.y*Math.max(di,1),Pe.push($n),ke.push(qi),De.push(Cn)};if("miter"===dn)lt._mult(It),Hn(je,lt,0,0);else if("flipbevel"===dn)lt=rt.mult(-1),Hn(je,lt,0,0),Hn(je,lt.mult(-1),0,0);else{const Qn=-Math.sqrt(It*It-1),$n=Xt?Qn:0,di=Xt?0:Qn;Le&&Hn(je,_t,$n,di),it&&Hn(je,rt,$n,di)}}Te.geometry=[...ke,...De.reverse(),ke[0]],Te.joinNormals=[...Pe,...Pe.reverse(),Pe[Pe.length-1]];const St=Te.geometry.length-1;for(let zt=0;zt<St/2;zt++)if(zt+1<St/2){let lt=zt,en=zt+1,It=St-1-zt,Xt=St-2-zt;lt=0===lt?St-1:lt-1,en=0===en?St-1:en-1,It=0===It?St-1:It-1,Xt=0===Xt?St-1:Xt-1,Te.indices.push(It),Te.indices.push(en),Te.indices.push(lt),Te.indices.push(It),Te.indices.push(Xt),Te.indices.push(en)}return Te}(l[0]),l=[q.geometry]}const Z=(ce,we)=>ce<(we.length-1)/2||ce===we.length-1,$=this.wallMode?[l]:Bb(l,500);for(let ce=$.length-1;ce>=0;ce--){const we=$[ce];(0===we.length||(Y=we[0]).every(fe=>fe.x<=0)||Y.every(fe=>fe.x>=Ot)||Y.every(fe=>fe.y<=0)||Y.every(fe=>fe.y>=Ot))&&$.splice(ce,1)}var Y;let K;if(k)K=iM($,w,_);else{K=[];for(const ce of $)K.push({polygon:ce,bounds:w})}const ee=S?this.edgeRadius:0,ue=ee>0&&this.zoom<17,de=(ce,we)=>{if(0===ce.length)return!1;const fe=ce[ce.length-1];return we.x===fe.x&&we.y===fe.y};for(const{polygon:ce,bounds:we}of K){let fe=0,Te=0;for(const Ne of ce)S&&!Ne[0].equals(Ne[Ne.length-1])&&Ne.push(Ne[0]),Te+=S?Ne.length-1:Ne.length;const ke=this.segments.prepareSegment((S?5:4)*Te,this.layoutVertexArray,this.indexArray);O.footprintSegIdx<0&&(O.footprintSegIdx=this.footprintSegments.length),O.polygonSegIdx<0&&(O.polygonSegIdx=this.polygonSegments.length);const De={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Pe=new Tc;if(Pe.vertexOffset=this.footprintVertices.length,Pe.indexOffset=3*this.footprintIndices.length,Pe.ringIndices=[],S){const Ne=[],je=[];fe=ke.vertexLength;for(let it=0;it<ce.length;it++){const _t=ce[it];_t.length&&0!==it&&je.push(Ne.length/2);const rt=[];let Et,St;Et=_t[1].sub(_t[0])._perp()._unit(),Pe.ringIndices.push(_t.length-1);for(let zt=1;zt<_t.length;zt++){const lt=_t[zt],en=_t[zt===_t.length-1?1:zt+1],It=lt.clone();if(ee){St=en.sub(lt)._perp()._unit();const Xt=Et.add(St)._unit(),dn=ee*Math.min(4,1/(Et.x*Xt.x+Et.y*Xt.y));It.x+=dn*Xt.x,It.y+=dn*Xt.y,It.x=Math.round(It.x),It.y=Math.round(It.y),Et=St}if(!B||0!==ee&&!ue||de(rt,It)||rt.push(It),Ng(this.layoutVertexArray,It.x,It.y,0,0,1,1,0),this.wallMode){const Xt=Z(zt,_t);zg(this.wallVertexArray,q.joinNormals[zt],!Xt)}ke.vertexLength++,this.footprintVertices.emplaceBack(lt.x,lt.y),Ne.push(lt.x,lt.y),k&&Yp(this.layoutVertexExtArray,D.projectTilePoint(It.x,It.y,_),D.upVector(_,It.x,It.y))}B&&(0===ee||ue)&&(0!==rt.length&&de(rt,rt[0])&&rt.pop(),this.groundEffect.addData(rt,we,R))}const Le=this.wallMode?q.indices:zb(Ne,je);for(let it=0;it<Le.length;it+=3)this.footprintIndices.emplaceBack(Pe.vertexOffset+Le[it+0],Pe.vertexOffset+Le[it+1],Pe.vertexOffset+Le[it+2]),this.indexArray.emplaceBack(fe+Le[it],fe+Le[it+2],fe+Le[it+1]),ke.primitiveLength++;Pe.indexCount+=Le.length,Pe.vertexCount+=this.footprintVertices.length-Pe.vertexOffset}for(let Ne=0;Ne<ce.length;Ne++){const je=ce[Ne];I.startRing(O,je[0]);let Le=je.length>4&&tM(je[je.length-2],je[0],je[1]),it=ee?Vg(je[je.length-2],je[0],je[1],ee):0;const _t=[];let rt,Et,St;Et=je[1].sub(je[0])._perp()._unit();let zt=!0;for(let lt=1,en=0;lt<je.length;lt++){let It=je[lt-1],Xt=je[lt];const dn=je[lt===je.length-1?1:lt+1];if(I.appendEdge(O,Xt,It),Xp(Xt,It,we)){ee&&(Et=dn.sub(Xt)._perp()._unit(),zt=!zt);continue}const On=Xt.sub(It)._perp(),Hn=On.x/(Math.abs(On.x)+Math.abs(On.y)),Qn=On.y>0?1:0,$n=It.dist(Xt);if(en+$n>32768&&(en=0),ee){St=dn.sub(Xt)._perp()._unit();let Cn=Sf(It,Xt,dn,Bg(Et,St),ee);isNaN(Cn)&&(Cn=0);const Qi=Xt.sub(It)._unit();It=It.add(Qi.mult(it))._round(),Xt=Xt.add(Qi.mult(-Cn))._round(),it=Cn,Et=St,B&&this.zoom>=17&&(de(_t,It)||_t.push(It),de(_t,Xt)||_t.push(Xt))}const di=ke.vertexLength,lr=je.length>4&&tM(It,Xt,dn);let qi=nM(en,Le,zt);if(Ng(this.layoutVertexArray,It.x,It.y,Hn,Qn,0,0,qi),Ng(this.layoutVertexArray,It.x,It.y,Hn,Qn,0,1,qi),this.wallMode){const Cn=Z(lt-1,je),Qi=q.joinNormals[lt-1];zg(this.wallVertexArray,Qi,Cn),zg(this.wallVertexArray,Qi,Cn)}if(en+=$n,qi=nM(en,lr,!zt),Le=lr,Ng(this.layoutVertexArray,Xt.x,Xt.y,Hn,Qn,0,0,qi),Ng(this.layoutVertexArray,Xt.x,Xt.y,Hn,Qn,0,1,qi),this.wallMode){const Cn=Z(lt,je),Qi=q.joinNormals[lt];zg(this.wallVertexArray,Qi,Cn),zg(this.wallVertexArray,Qi,Cn)}if(ke.vertexLength+=4,this.indexArray.emplaceBack(di+0,di+1,di+2),this.indexArray.emplaceBack(di+1,di+3,di+2),ke.primitiveLength+=2,ee){const Cn=fe+(1===lt?je.length-2:lt-2),Qi=1===lt?fe:Cn+1;if(this.indexArray.emplaceBack(di+1,Cn,di+3),this.indexArray.emplaceBack(Cn,Qi,di+3),ke.primitiveLength+=2,void 0===rt&&(rt=di),!Xp(dn,je[lt],we)){const Yi=lt===je.length-1?rt:ke.vertexLength;this.indexArray.emplaceBack(di+2,di+3,Yi),this.indexArray.emplaceBack(di+3,Yi+1,Yi),this.indexArray.emplaceBack(di+3,Qi,Yi+1),ke.primitiveLength+=3}zt=!zt}if(k){const Cn=this.layoutVertexExtArray,Qi=D.projectTilePoint(It.x,It.y,_),Yi=D.projectTilePoint(Xt.x,Xt.y,_),Hi=D.upVector(_,It.x,It.y),qr=D.upVector(_,Xt.x,Xt.y);Yp(Cn,Qi,Hi),Yp(Cn,Qi,Hi),Yp(Cn,Yi,qr),Yp(Cn,Yi,qr)}}S&&(fe+=je.length-1),B&&ee&&this.zoom>=17&&(0!==_t.length&&de(_t,_t[0])&&_t.pop(),this.groundEffect.addData(_t,we,R,ee>0))}this.footprintSegments.push(Pe),De.triangleCount=this.indexArray.length-De.triangleArrayOffset,this.polygonSegments.push(De),++O.footprintSegLen,++O.polygonSegLen}if(O.vertexCount=this.layoutVertexArray.length-O.vertexArrayOffset,O.groundVertexCount=this.groundEffect.vertexArray.length-O.groundVertexArrayOffset,0!==O.vertexCount){if(O.centroidXY=I.borders?Zp:this.encodeCentroid(I,O),this.centroidData.push(O),I.borders){this.featuresOnBorder.push(I);const ce=this.featuresOnBorder.length-1;for(let we=0;we<I.borders.length;we++)I.borders[we][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[we].push(ce)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,p,y,_,E),this.groundEffect.addPaintPropertiesData(o,u,p,y,_,E),this.maxHeight=Math.max(this.maxHeight,U)}}sortBorders(){for(let o=0;o<this.borderFeatureIndices.length;o++)this.borderFeatureIndices[o].sort((l,u)=>this.featuresOnBorder[l].borders[o][0]-this.featuresOnBorder[u].borders[o][0])}splitToSubtiles(){const o=[];for(let T=0;T<this.centroidData.length;T++){const E=this.centroidData[T],R=+(E.min.y+E.max.y>Ot),w=2*R+(+(E.min.x+E.max.x>Ot)^R);for(let D=0;D<E.polygonSegLen;D++){const k=E.polygonSegIdx+D;o.push({centroidIdx:T,subtile:w,polygonSegmentIdx:k,triangleSegmentIdx:this.polygonSegments[k].triangleSegIdx})}}const l=new es;o.sort((T,E)=>T.triangleSegmentIdx===E.triangleSegmentIdx?T.subtile-E.subtile:T.triangleSegmentIdx-E.triangleSegmentIdx);let u=0,_=0,p=0;for(const T of o){if(T.triangleSegmentIdx!==u)break;p++}const y=o.length;for(;_!==o.length;){u=o[_].triangleSegmentIdx;let T=0,E=_,R=_;for(let w=E;w<p&&o[w].subtile===T;w++)R++;for(;E!==p;){const w=o[E];T=w.subtile;const D=this.centroidData[w.centroidIdx].min.clone(),k=this.centroidData[w.centroidIdx].max.clone(),S={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let I=E;I<R;I++){const O=o[I],B=this.polygonSegments[O.polygonSegmentIdx],U=this.centroidData[O.centroidIdx].min,q=this.centroidData[O.centroidIdx].max,Z=this.indexArray.uint16;for(let $=B.triangleArrayOffset;$<B.triangleArrayOffset+B.triangleCount;$++)l.emplaceBack(Z[3*$],Z[3*$+1],Z[3*$+2]);S.primitiveLength+=B.triangleCount,D.x=Math.min(D.x,U.x),D.y=Math.min(D.y,U.y),k.x=Math.max(k.x,q.x),k.y=Math.max(k.y,q.y)}S.primitiveLength>0&&this.triangleSubSegments.push({segment:S,min:D,max:k}),E=R;for(let I=E;I<p&&o[I].subtile===o[E].subtile;I++)R++}_=p;for(let w=_;w<y&&o[w].triangleSegmentIdx===o[_].triangleSegmentIdx;w++)p++}l._trim(),this.indexArray=l}getVisibleSegments(o,l,u){const _=new ni;if(this.wallMode){for(const O of this.triangleSubSegments)_.segments.push(O.segment);return _}let p=0,y=0;const T=1<<o.canonical.z;if(l){const O=l.getMinMaxForTile(o);O&&(p=O.min,y=O.max)}y+=this.maxHeight;const E=o.toUnwrapped();let R;const w=[E.canonical.x/T+E.wrap,E.canonical.y/T],D=[(E.canonical.x+1)/T+E.wrap,(E.canonical.y+1)/T],k=(O,B,U)=>[O[0]*(1-U[0])+B[0]*U[0],O[1]*(1-U[1])+B[1]*U[1]],S=[],I=[];for(const O of this.triangleSubSegments){S[0]=O.min.x/Ot,S[1]=O.min.y/Ot,I[0]=O.max.x/Ot,I[1]=O.max.y/Ot;const B=k(w,D,S),U=k(w,D,I);if(0===new gn([B[0],B[1],p],[U[0],U[1],y]).intersectsPrecise(u)){R&&(_.segments.push(R),R=void 0);continue}const q=O.segment;R&&R.vertexOffset!==q.vertexOffset&&(_.segments.push(R),R=void 0),R?(R.vertexLength+=q.vertexLength,R.primitiveLength+=q.primitiveLength):R={vertexOffset:q.vertexOffset,primitiveLength:q.primitiveLength,vertexLength:q.vertexLength,primitiveOffset:q.primitiveOffset,sortKey:void 0,vaos:{}}}return R&&_.segments.push(R),_}encodeCentroid(o,l){const u=o.centroid(),_=l.span(),p=Math.min(7,Math.round(_.x*this.tileToMeter/10)),y=Math.min(7,Math.round(_.y*this.tileToMeter/10));return new Ft(En(u.x,1,8191)<<3|p,En(u.y,1,8191)<<3|y)}encodeBorderCentroid(o){if(!o.borders)return new Ft(0,0);const l=o.borders,u=Number.MAX_VALUE;if(l[0][0]!==u||l[1][0]!==u){const _=l[0][0]!==u?0:1;return new Ft(6|(l[0][0]!==u?0:65528),(l[_][0]+l[_][1])/2<<3|6)}{const _=l[2][0]!==u?2:3;return new Ft((l[_][0]+l[_][1])/2<<3|6,6|(l[2][0]!==u?0:65528))}}showCentroid(o){const l=this.centroidData[o.centroidDataIndex];l.flags&=Kd,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(o){this.groundEffect.updateHiddenByLandmark(o);const l=o.vertexArrayOffset,u=o.vertexCount+o.vertexArrayOffset,_=o.flags&Kd?Zp:o.centroidXY,p=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==_.y||p!==_.x){for(let y=l;y<u;++y)this.centroidVertexArray.emplace(y,_.x,_.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const o of this.centroidData)this.writeCentroidToBuffer(o)}updateReplacement(o,l,u){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const _=l.getReplacementRegionsForTile(o.toUnwrapped());if(YT(this.activeReplacements,_))return;if(this.activeReplacements=_,0===this.centroidVertexArray.length)this.createCentroidsBuffer();else for(const y of this.centroidData)y.flags&=2147483647;const p=[];for(const y of this.activeReplacements){if(y.order<u)continue;const T=Math.max(1,Math.pow(2,y.footprintTileId.canonical.z-o.canonical.z));for(const E of this.centroidData)if(!(E.flags&Kd||y.min.x>E.max.x||E.min.x>y.max.x||y.min.y>E.max.y||E.min.y>y.max.y))for(let R=0;R<E.footprintSegLen;R++){const w=this.footprintSegments[E.footprintSegIdx+R];if(p.length=0,Ug(this.footprintVertices,w.vertexOffset,w.vertexCount,y.footprintTileId.canonical,o.canonical,p),Ow(y.footprint,p,this.footprintIndices.uint16,w.indexOffset,w.indexCount,-w.vertexOffset,-T)){E.flags|=Kd;break}}}for(const y of this.centroidData)this.writeCentroidToBuffer(y);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(o,l,u){let _=!1;for(let p=0;p<u.footprintSegLen;p++){const y=this.footprintSegments[u.footprintSegIdx+p];let T=0;for(const E of y.ringIndices){for(let R=T,w=E+T-1;R<E+T;w=R++){const D=this.footprintVertices.int16[2*(R+y.vertexOffset)+0],k=this.footprintVertices.int16[2*(R+y.vertexOffset)+1],S=this.footprintVertices.int16[2*(w+y.vertexOffset)+1];k>l!=S>l&&o<(this.footprintVertices.int16[2*(w+y.vertexOffset)+0]-D)*(l-k)/(S-k)+D&&(_=!_)}T=E}}return _}getHeightAtTileCoord(o,l){let u=Number.NEGATIVE_INFINITY,_=!0;const p=4*(o+Ot)*Ot+(l+Ot);if(this.partLookup.hasOwnProperty(p)){const y=this.partLookup[p];return y?{height:y.height,hidden:!!(y.flags&Kd)}:void 0}for(const y of this.centroidData)o>y.max.x||y.min.x>o||l>y.max.y||y.min.y>l||this.footprintContainsPoint(o,l,y)&&y&&y.height>u&&(u=y.height,this.partLookup[p]=y,_=!!(y.flags&Kd));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:_};this.partLookup[p]=void 0}}function Bg(d,o){const l=d.add(o)._unit();return d.x*l.x+d.y*l.y}function Vg(d,o,l,u){const _=o.sub(d)._perp()._unit(),p=l.sub(o)._perp()._unit();return Sf(d,o,l,Bg(_,p),u)}function Sf(d,o,l,u,_){const p=Math.sqrt(1-u*u);return Math.min(d.dist(o)/3,o.dist(l)/3,_*p/u)}function Xp(d,o,l){return d.x<l[0].x&&o.x<l[0].x||d.x>l[1].x&&o.x>l[1].x||d.y<l[0].y&&o.y<l[0].y||d.y>l[1].y&&o.y>l[1].y}function Ry(d,o){return d.x<o[0].x||d.x>o[1].x||d.y<o[0].y||d.y>o[1].y}function tM(d,o,l){if(d.x<0||d.x>=Ot||o.x<0||o.x>=Ot||l.x<0||l.x>=Ot)return!1;const u=l.sub(o),_=u.perp(),p=d.sub(o);return(u.x*p.x+u.y*p.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(p.x*p.x+p.y*p.y))>-.866&&_.x*p.x+_.y*p.y<0}function nM(d,o,l){const u=o?2|d:-3&d;return l?1|u:-2&u}function Py(){const d=Math.PI/32,o=Math.tan(d),l=th;return l*Math.sqrt(1+2*o*o)-l}function iM(d,o,l){const u=1<<l.z,_=aa(l.x/u),p=aa((l.x+1)/u),y=Zo(l.y/u),T=Zo((l.y+1)/u);return function(E,R,w,D,k=0,S){const I=[];if(!E.length||!w||!D)return I;const O=(K,ee)=>{for(const ue of K)I.push({polygon:ue,bounds:ee})},B=Math.ceil(Math.log2(w)),U=Math.ceil(Math.log2(D)),q=B-U,Z=[];for(let K=0;K<Math.abs(q);K++)Z.push(q>0?0:1);for(let K=0;K<Math.min(B,U);K++)Z.push(0),Z.push(1);let $=E;if($=Og($,R[0].y-k,R[1].y+k,1),$=Og($,R[0].x-k,R[1].x+k,0),!$.length)return I;const Y=[];for(Z.length?Y.push({polygons:$,bounds:R,depth:0}):O($,R);Y.length;){const K=Y.pop(),ee=K.depth,ue=Z[ee],de=K.bounds[0],ce=K.bounds[1],we=0===ue?de.x:de.y,fe=0===ue?ce.x:ce.y,Te=S?S(ue,we,fe):.5*(we+fe),ke=Og(K.polygons,we-k,Te+k,ue),De=Og(K.polygons,Te-k,fe+k,ue);if(ke.length){const Pe=[de,new Ft(0===ue?Te:ce.x,1===ue?Te:ce.y)];Z.length>ee+1?Y.push({polygons:ke,bounds:Pe,depth:ee+1}):O(ke,Pe)}if(De.length){const Pe=[new Ft(0===ue?Te:de.x,1===ue?Te:de.y),ce];Z.length>ee+1?Y.push({polygons:De,bounds:Pe,depth:ee+1}):O(De,Pe)}}return I}(d,o,Math.ceil((p-_)/11.25),Math.ceil((y-T)/11.25),1,(E,R,w)=>{if(0===E)return.5*(R+w);{const D=Zo((l.y+R/Ot)/u);return($l(.5*(Zo((l.y+w/Ot)/u)+D))*u-l.y)*Ot}})}function Ug(d,o,l,u,_,p){const y=Math.pow(2,u.z-_.z);for(let T=0;T<l;T++){let E=d.int16[2*(T+o)+0],R=d.int16[2*(T+o)+1];E=(E+_.x*Ot)*y-u.x*Ot,R=(R+_.y*Ot)*y-u.y*Ot,p.push(new Ft(E,R))}}let rM,zw;function ah(d,o){return d.x*o.x+d.y*o.y}function Oy(d,o){if(1===d.length){let l=0;const u=o[l++];let _;for(;!_||u.equals(_);)if(_=o[l++],!_)return 1/0;for(;l<o.length;l++){const p=o[l],y=d[0],T=_.sub(u),E=p.sub(u),R=y.sub(u),w=ah(T,T),D=ah(T,E),k=ah(E,E),S=ah(R,T),I=ah(R,E),O=w*k-D*D,B=(k*S-D*I)/O,U=(w*I-D*S)/O,q=u.z*(1-B-U)+_.z*B+p.z*U;if(isFinite(q))return q}return 1/0}{let l=1/0;for(const u of o)l=Math.min(l,u.z);return l}}function Bw(d,o,l,u,_,p,y,T){const E=y*_.getElevationAt(d,o,!0,!0),R=0!==p[0],w=R?0===p[1]?y*(p[0]/7-450):y*function(D,k,S){const I=Math.floor(k[0]/8),O=Math.floor(k[1]/8),B=10*(k[0]-8*I),U=10*(k[1]-8*O),q=D.getElevationAt(I,O,!0,!0),Z=D.getMeterToDEM(S),$=Math.floor(.5*(B*Z-1)),Y=Math.floor(.5*(U*Z-1)),K=D.tileCoordToPixel(I,O),ee=2*$+1,ue=2*Y+1,de=(je=ee,Le=ue,[(De=D).getElevationAtPixel(Pe=K.x-$,Ne=K.y-Y,!0),De.getElevationAtPixel(Pe+Le,Ne,!0),De.getElevationAtPixel(Pe,Ne+Le,!0),De.getElevationAtPixel(Pe+je,Ne+Le,!0)]),ce=Math.abs(de[0]-de[1]),we=Math.abs(de[2]-de[3]),fe=Math.abs(de[0]-de[2])+Math.abs(de[1]-de[3]),Te=Math.min(.25,.5*Z*(ce+we)/ee),ke=Math.min(.25,.5*Z*fe/ue);var De,Pe,Ne,je,Le;return q+Math.max(Te*B,ke*U)}(_,p,T):E;return{base:E+(0===l?-1:l),top:R?Math.max(w+u,E+l+2):E+u}}Zt(lo,"FillExtrusionBucket",{omit:["layers","features"]}),Zt(QT,"PartData"),Zt(Tc,"FootprintSegment"),Zt(Nw,"BorderCentroidData"),Zt(eM,"GroundEffect");const oM=Ri([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),Fy=Ri([{name:"a_z_offset_width",components:2,type:"Float32"}],4),{members:Gl}=oM,Rk=Ri([{name:"a_packed",components:4,type:"Float32"}]),{members:ca}=Rk,Pk=Ri([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:Ok}=Pk;class Wb{constructor(o,l){this.width=o,this.height=l,this.nextRow=0,this.image=new Tf({width:o,height:l}),this.positions={},this.uploaded=!1}getDash(o,l){const u=this.getKey(o,l);return this.positions[u]}trim(){const o=this.width,l=this.height=ap(this.nextRow);this.image.resize({width:o,height:l})}getKey(o,l){return o.join(",")+l}getDashRanges(o,l,u){const _=[];let p=o.length%2==1?-o[o.length-1]*u:0,y=o[0]*u,T=!0;_.push({left:p,right:y,isDash:T,zeroLength:0===o[0]});let E=o[0];for(let R=1;R<o.length;R++){T=!T;const w=o[R];p=E*u,E+=w,y=E*u,_.push({left:p,right:y,isDash:T,zeroLength:0===w})}return _}addRoundDash(o,l,u){const _=l/2;for(let p=-u;p<=u;p++){const y=this.width*(this.nextRow+u+p);let T=0,E=o[T];for(let R=0;R<this.width;R++){R/E.right>1&&(E=o[++T]);const w=Math.abs(R-E.left),D=Math.abs(R-E.right),k=Math.min(w,D);let S;const I=p/u*(_+1);if(E.isDash){const O=_-Math.abs(I);S=Math.sqrt(k*k+O*O)}else S=_-Math.sqrt(k*k+I*I);this.image.data[y+R]=Math.max(0,Math.min(255,S+128))}}}addRegularDash(o,l){for(let E=o.length-1;E>=0;--E){const R=o[E],w=o[E+1];R.zeroLength?o.splice(E,1):w&&w.isDash===R.isDash&&(w.left=R.left,o.splice(E,1))}const u=o[0],_=o[o.length-1];u.isDash===_.isDash&&(u.left=_.left-this.width,_.right=u.right+this.width);const p=this.width*this.nextRow;let y=0,T=o[y];for(let E=0;E<this.width;E++){E/T.right>1&&(T=o[++y]);const R=Math.abs(E-T.left),w=Math.abs(E-T.right),D=Math.min(R,w);this.image.data[p+E]=Math.max(0,Math.min(255,(T.isDash?D:-D)+l+128))}}addDash(o,l){const u=this.getKey(o,l);if(this.positions[u])return this.positions[u];const _="round"===l,p=_?7:0,y=2*p+1;if(this.nextRow+y>this.height)return Yn("LineAtlas out of space"),null;0===o.length&&o.push(1);let T=0;for(let w=0;w<o.length;w++)o[w]<0&&(Yn("Negative value is found in line dasharray, replacing values with 0"),o[w]=0),T+=o[w];if(0!==T){const w=this.width/T,D=this.getDashRanges(o,this.width,w);_?this.addRoundDash(D,w,p):this.addRegularDash(D,"square"===l?.5*w:0)}const E=this.nextRow+p;this.nextRow+=y;const R={tl:[E,p],br:[T,0]};return this.positions[u]=R,R}}Zt(Wb,"LineAtlas");const sM=Yd.VectorTileFeature.types,aM=Math.cos(Math.PI/180*37.5),Fk=Math.cos(Math.PI/180*5);class lM{constructor(o){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=o.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=o.index,this.projection=o.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new hy,this.layoutVertexArray2=new ed,this.patternVertexArray=new jd,this.indexArray=new es,this.programConfigurations=new xc(o.layers,{zoom:o.zoom,lut:o.lut}),this.segments=new ni,this.maxLineLength=0,this.zOffsetVertexArray=new bc,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=o.tessellationStep?o.tessellationStep:128}updateFootprints(o,l){}populate(o,l,u,_){this.hasPattern=jT("line",this.layers,l);const p=this.layers[0].layout.get("line-sort-key");this.tileToMeter=g(u),this.hasZOffset=!this.layers[0].isDraped();const y=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&"none"===y&&Yn(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const T=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&void 0!==T;const E=[];for(const{feature:k,id:S,index:I,sourceLayerIndex:O}of o){const B=this.layers[0]._featureFilter.needGeometry,U=G(k,B);if(!this.layers[0]._featureFilter.filter(new _r(this.zoom),U,u))continue;const q=p?p.evaluate(U,{},u):void 0,Z={id:S,properties:k.properties,type:k.type,sourceLayerIndex:O,index:I,geometry:B?U.geometry:j(k,u,_),patterns:{},sortKey:q};E.push(Z)}p&&E.sort((k,S)=>k.sortKey-S.sortKey);const{lineAtlas:R,featureIndex:w}=l,D=this.addConstantDashes(R);for(const k of E){const{geometry:S,index:I,sourceLayerIndex:O}=k;if(D&&this.addFeatureDashes(k,R),this.hasPattern){const B=Vb("line",this.layers,k,this.zoom,l);this.patternFeatures.push(B)}else this.addFeature(k,S,I,u,R.positions,l.availableImages,l.brightness);w.insert(o[I].feature,S,I,O,this.index)}}addConstantDashes(o){let l=!1;for(const u of this.layers){const _=u.paint.get("line-dasharray").value,p=u.layout.get("line-cap").value;if("constant"!==_.kind||"constant"!==p.kind)l=!0;else{const y=p.value,T=_.value;if(!T)continue;o.addDash(T,y)}}return l}addFeatureDashes(o,l){const u=this.zoom;for(const _ of this.layers){const p=_.paint.get("line-dasharray").value,y=_.layout.get("line-cap").value;if("constant"===p.kind&&"constant"===y.kind)continue;let T,E;if("constant"===p.kind){if(T=p.value,!T)continue}else T=p.evaluate({zoom:u},o);E="constant"===y.kind?y.value:y.evaluate({zoom:u},o),l.addDash(T,E),o.patterns[_.id]=l.getKey(T,E)}}update(o,l,u,_,p,y,T){this.programConfigurations.updatePaintArrays(o,l,p,u,_,y,T)}addFeatures(o,l,u,_,p,y){for(const T of this.patternFeatures)this.addFeature(T,T.geometry,T.index,l,u,_,y)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(o){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=o.createVertexBuffer(this.layoutVertexArray2,ca)),0!==this.patternVertexArray.length&&(this.patternVertexBuffer=o.createVertexBuffer(this.patternVertexArray,Ok)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Fy.members,!0)),this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Gl),this.indexBuffer=o.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(o),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(o){if(o.properties&&o.properties.hasOwnProperty("mapbox_clip_start")&&o.properties.hasOwnProperty("mapbox_clip_end"))return{start:+o.properties.mapbox_clip_start,end:+o.properties.mapbox_clip_end}}addFeature(o,l,u,_,p,y,T){const E=this.layers[0].layout,R=E.get("line-join").evaluate(o,{}),w=E.get("line-cap").evaluate(o,{}),D=E.get("line-miter-limit"),k=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(o),this.lineFeature=o,this.zOffsetValue=E.get("line-z-offset").value;const S=this.layers[0].paint.get("line-width").value;"constant"!==S.kind&&!1===S.isLineProgressConstant&&(this.variableWidthValue=S);for(const I of l)this.addLine(I,o,_,R,w,D,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,u,p,y,_,T)}addLine(o,l,u,_,p,y,T){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const E="none"===_;if(this.patternJoinNone=this.hasPattern&&E,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Z=0;Z<o.length-1;Z++)this.totalDistance+=o[Z].dist(o[Z+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R="Polygon"===sM[l.type];let w=o.length;for(;w>=2&&o[w-1].equals(o[w-2]);)w--;let D=0;for(;D<w-1&&o[D].equals(o[D+1]);)D++;if(w<(R?3:2))return;"bevel"===_&&(y=1.05);const k=this.segments.prepareSegment(10*w,this.layoutVertexArray,this.indexArray);let S,I,O,B,U,q;this.e1=this.e2=-1,R&&(S=o[w-2],U=o[D].sub(S)._unit()._perp());for(let Z=D;Z<w;Z++){if(O=Z===w-1?R?o[D+1]:void 0:o[Z+1],O&&o[Z].equals(O))continue;U&&(B=U),S&&(I=S),S=o[Z],q=this.evaluateLineProgressFeatures(I?I.dist(S):0),U=O?O.sub(S)._unit()._perp():B,B=B||U;const $=I&&O;let Y=$?_:R||E?"butt":p;const K=B.x*U.x+B.y*U.y;if(E){const ke=function(De){if(De.patternJoinNone){const Pe=De.segmentPoints.length/2,Ne=De.lineSoFar-De.segmentStart;for(let je=0;je<Pe;++je){const Le=De.segmentPoints[2*je+1],it=Math.round(De.segmentPoints[2*je])+.5+.25*Le;De.patternVertexArray.emplaceBack(it,Ne,De.segmentStart),De.patternVertexArray.emplaceBack(it,Ne,De.segmentStart)}De.segmentPoints.length=0}De.e1=De.e2=-1};if($&&K<Fk){this.updateDistance(I,S),this.addCurrentVertex(S,B,1,1,k,q),ke(this),this.addCurrentVertex(S,U,-1,-1,k,q);continue}if(I){if(!O){this.updateDistance(I,S),this.addCurrentVertex(S,B,1,1,k,q),ke(this);continue}Y="miter"}}let ee=B.add(U);0===ee.x&&0===ee.y||ee._unit();const ue=ee.x*U.x+ee.y*U.y,de=0!==ue?1/ue:1/0,ce=2*Math.sqrt(2-2*ue),we=ue<aM&&I&&O,fe=B.x*U.y-B.y*U.x>0,Te=this.overscaling<=16?15*Ot/(512*this.overscaling):0;if($&&"round"===Y)if(de<T)Y="miter";else if(de<=2){const ke=Zb(S,-10,8202);Y=this.hasZOffset&&(ke||this.hasCrossSlope)?"miter":"fakeround"}if("miter"===Y&&de>y&&(Y="bevel"),"bevel"===Y&&(de>2&&(Y="flipbevel"),de<y&&(Y="miter")),I&&!("miter"===Y&&we)&&this.updateDistance(I,S),"miter"===Y)if(we){const ke=S.dist(I);if(ke>2*Te){const Pe=S.sub(S.sub(I)._mult(Te/ke)._round());this.updateDistance(I,Pe),this.addCurrentVertex(Pe,B,0,0,k,q),I=Pe}this.updateDistance(I,S),ee._mult(de),this.addCurrentVertex(S,ee,0,0,k,q);const De=S.dist(O);if(De>2*Te){const Pe=S.add(O.sub(S)._mult(Te/De)._round());this.updateDistance(S,Pe),this.addCurrentVertex(Pe,U,0,0,k,q),S=Pe}}else ee._mult(de),this.addCurrentVertex(S,ee,0,0,k,q);else if("flipbevel"===Y){if(de>100)ee=U.mult(-1);else{const ke=de*B.add(U).mag()/B.sub(U).mag();ee._perp()._mult(ke*(fe?-1:1))}this.addCurrentVertex(S,ee,0,0,k,q),this.addCurrentVertex(S,ee.mult(-1),0,0,k,q)}else if("bevel"===Y||"fakeround"===Y){null!=q&&I&&this.addCurrentVertex(S,B,-1,-1,k,q);const ke=S.dist(I)<=2*Te&&"bevel"!==Y,De=ee.mult(fe?1:-1);De._mult(de);const Pe=U.mult(fe?-1:1),Ne=B.mult(fe?-1:1),je=this.evaluateLineProgressFeatures(this.distance);if(null==q&&(this.addHalfVertex(S,De.x,De.y,!1,!fe,0,k,je),ke||this.addHalfVertex(S,De.x+2*Ne.x,De.y+2*Ne.y,!1,fe,0,k,je)),"fakeround"===Y){const Le=Math.round(180*ce/Math.PI/20);this.addHalfVertex(S,Ne.x,Ne.y,!1,fe,0,k,je);for(let it=0;it<Le;it++){let _t=it/Le;if(.5!==_t){const Et=_t-.5;_t+=_t*Et*(_t-1)*((1.0904+K*(K*(3.55645-1.43519*K)-3.2452))*Et*Et+(.848013+K*(.215638*K-1.06021)))}const rt=Pe.sub(Ne)._mult(_t)._add(Ne)._unit();this.addHalfVertex(S,rt.x,rt.y,!1,fe,0,k,je)}this.addHalfVertex(S,Pe.x,Pe.y,!1,fe,0,k,je)}ke||null!=q||this.addHalfVertex(S,De.x+2*Pe.x,De.y+2*Pe.y,!1,fe,0,k,je),null!=q&&O&&this.addCurrentVertex(S,U,1,1,k,q)}else"butt"===Y?this.addCurrentVertex(S,ee,0,0,k,q):"square"===Y?(I||this.addCurrentVertex(S,ee,-1,-1,k,q),this.addCurrentVertex(S,ee,0,0,k,q),I&&this.addCurrentVertex(S,ee,1,1,k,q)):"round"===Y&&(I&&(this.addCurrentVertex(S,B,0,0,k,q),this.addCurrentVertex(S,B,1,1,k,q,!0)),O&&(this.addCurrentVertex(S,U,-1,-1,k,q,!0),this.addCurrentVertex(S,U,0,0,k,q)))}}addVerticesTo(o,l,u,_,p,y,T,E,R,w){const D=(l.w-o.w)/this.tessellationStep|0;let k=0;const S=this.scaledDistance;if(D>1){this.lineSoFar=o.w;const O=(l.x-o.x)/D,B=(l.y-o.y)/D,U=(l.z-o.z)/D,q=(l.w-o.w)/D;for(let Z=1;Z<D;++Z){o.x+=O,o.y+=B,o.z+=U,this.lineSoFar+=q,k+=q;const $=this.evaluateLineProgressFeatures(this.prevDistance+k);this.scaledDistance=(this.prevDistance+k)/this.totalDistance,this.addHalfVertex(o,u,_,w,!1,T,R,$),this.addHalfVertex(o,p,y,w,!0,-E,R,$)}}this.lineSoFar=l.w,this.scaledDistance=S;const I=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,u,_,w,!1,T,R,I),this.addHalfVertex(l,p,y,w,!0,-E,R,I)}evaluateLineProgressFeatures(o){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+o)/this.totalFeatureLength):Yn(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&"constant"!==this.variableWidthValue.kind&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?"constant"===this.zOffsetValue.kind?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}:{zOffset:0,variableWidth:l}}addCurrentVertex(o,l,u,_,p,y,T=!1){const E=l.x+l.y*u,R=l.y-l.x*u,w=l.y*_-l.x,D=-l.y-l.x*_;if(null!=y){const k=this.hasZOffset,S=-10,I=8202,O=y.zOffset,B=new sh(o.x,o.y,O,this.lineSoFar),U=!!k&&Zb(o,S,I),q=this.lineSoFar,Z=this.distance;if(this.currentVertex)if(U){const $=this.currentVertexIsOutside,Y=this.currentVertex,K=new sh(o.x,o.y,O,this.lineSoFar);if(Fg(Y,K,S,I),!Zb(K,S,I)){if($){this.e1=this.e2=-1,this.distance-=Y.dist(B),this.lineSoFar=Y.w;const ee=this.evaluateLineProgressFeatures(Y.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Y,E,R,T,!1,u,p,ee),this.addHalfVertex(Y,w,D,T,!0,-_,p,ee),this.prevDistance=this.distance}this.distance=this.prevDistance+Y.dist(K),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Y,K,E,R,w,D,u,_,p,T),this.distance=Z,this.scaledDistance=this.distance/this.totalDistance}}else{const $=this.currentVertex;if(this.currentVertexIsOutside){Fg($,B,S,I),this.e1=this.e2=-1,this.distance-=$.dist(B),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=$.w;const Y=this.evaluateLineProgressFeatures($.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex($,E,R,T,!1,u,p,Y),this.addHalfVertex($,w,D,T,!0,-_,p,Y),this.prevDistance=this.distance,this.distance=Z,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo($,B,E,R,w,D,u,_,p,T)}else U||(this.addHalfVertex(o,E,R,T,!1,u,p,y),this.addHalfVertex(o,w,D,T,!0,-_,p,y));this.currentVertex=B,this.currentVertexIsOutside=U,this.lineSoFar=q}else this.addHalfVertex(o,E,R,T,!1,u,p,y),this.addHalfVertex(o,w,D,T,!0,-_,p,y)}addHalfVertex({x:o,y:l},u,_,p,y,T,E,R){this.patternJoinNone&&(0===this.segmentPoints.length&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),y||this.segmentPoints.push(this.lineSoFar-this.segmentStart,T)),this.layoutVertexArray.emplaceBack((o<<1)+(p?1:0),(l<<1)+(y?1:0),Math.round(63*u)+128,Math.round(63*_)+128,1+(0===T?0:T<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const w=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,w),E.primitiveLength++),y?this.e2=w:this.e1=w,null!=R&&this.zOffsetVertexArray.emplaceBack(R.zOffset,R.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(o,l){this.prevDistance=this.distance,this.distance+=o.dist(l),this.updateScaledDistance()}}function Zb(d,o,l){return d.x<o||d.x>l||d.y<o||d.y>l}let cM,Ly;function Yb(d,o,l){return o*(Ot/(d.tileSize*Math.pow(2,l-d.tileID.overscaledZ)))}Zt(lM,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const Xb=(d,o,l)=>(1-l)*d+l*o;function Kp(d,o){return 1/Yb(d,1,o.tileZoom)}function Ny(d,o,l,u){return d.translatePosMatrix(u||o.tileID.projMatrix,o,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const zy=d=>{const o=[];Qp(d)&&o.push("RENDER_LINE_DASH"),d.paint.get("line-gradient")&&o.push("RENDER_LINE_GRADIENT");const l=d.paint.get("line-trim-offset");0===l[0]&&0===l[1]||o.push("RENDER_LINE_TRIM_OFFSET"),0!==d.paint.get("line-border-width").constantOr(1)&&o.push("RENDER_LINE_BORDER");const u="none"===d.layout.get("line-join").constantOr("miter"),_=!!d.paint.get("line-pattern").constantOr(1);return u&&_&&o.push("LINE_JOIN_NONE"),o};function Qp(d){const o=d.paint.get("line-dasharray").value;return o.value||"constant"!==o.kind}let By;const Kb=()=>By||(By={layout:cM||(cM=new Pr({"line-cap":new jt(Ge.layout_line["line-cap"]),"line-join":new jt(Ge.layout_line["line-join"]),"line-miter-limit":new wt(Ge.layout_line["line-miter-limit"]),"line-round-limit":new wt(Ge.layout_line["line-round-limit"]),"line-sort-key":new jt(Ge.layout_line["line-sort-key"]),"line-z-offset":new jt(Ge.layout_line["line-z-offset"]),"line-elevation-reference":new wt(Ge.layout_line["line-elevation-reference"]),"line-cross-slope":new wt(Ge.layout_line["line-cross-slope"]),visibility:new wt(Ge.layout_line.visibility),"line-width-unit":new wt(Ge.layout_line["line-width-unit"])})),paint:Ly||(Ly=new Pr({"line-opacity":new jt(Ge.paint_line["line-opacity"]),"line-color":new jt(Ge.paint_line["line-color"]),"line-translate":new wt(Ge.paint_line["line-translate"]),"line-translate-anchor":new wt(Ge.paint_line["line-translate-anchor"]),"line-width":new jt(Ge.paint_line["line-width"]),"line-gap-width":new jt(Ge.paint_line["line-gap-width"]),"line-offset":new jt(Ge.paint_line["line-offset"]),"line-blur":new jt(Ge.paint_line["line-blur"]),"line-dasharray":new jt(Ge.paint_line["line-dasharray"]),"line-pattern":new jt(Ge.paint_line["line-pattern"]),"line-gradient":new Ki(Ge.paint_line["line-gradient"]),"line-trim-offset":new wt(Ge.paint_line["line-trim-offset"]),"line-trim-fade-range":new wt(Ge.paint_line["line-trim-fade-range"]),"line-trim-color":new wt(Ge.paint_line["line-trim-color"]),"line-emissive-strength":new wt(Ge.paint_line["line-emissive-strength"]),"line-border-width":new jt(Ge.paint_line["line-border-width"]),"line-border-color":new jt(Ge.paint_line["line-border-color"]),"line-occlusion-opacity":new wt(Ge.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},By);class dM extends jt{possiblyEvaluate(o,l){return l=new _r(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(o,l)}evaluate(o,l,u,_){return l=$o({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(o,l,u,_)}}let jg;function Qb(d,o){return o>0?o+2*d:d}const Lk=Ri([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Nk=Ri([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Hg=Ri([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ri([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Vy=Ri([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),GL=Ri([{name:"a_texb",components:2,type:"Uint16"}]),uM=Ri([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),zk=Ri([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Ri([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Vw=Ri([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),qL=Ri([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ri([{name:"triangle",components:3,type:"Uint16"}]),Ri([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ri([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),Ri([{type:"Float32",name:"offsetX"}]),Ri([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);const ad=128;function Uy(d,o,l,u,_){if("camera"===d.kind)return d.maxSize;if("composite"===d.kind){const p=o.possiblyEvaluate(new _r(d.maxZoom),l).evaluate(_,{},l),y=o.possiblyEvaluate(new _r(d.minZoom),l).evaluate(_,{},l);return Math.max(p,y)}return o.possiblyEvaluate(new _r(u)).evaluate(_,{},l)}function lh(d,o){const{expression:l}=o;if("constant"===l.kind)return{kind:"constant",layoutSize:l.evaluate(new _r(d+1))};if("source"===l.kind)return{kind:"source"};{const{zoomStops:u,interpolationType:_}=l;let p=0;for(;p<u.length&&u[p]<=d;)p++;p=Math.max(0,p-1);let y=p;for(;y<u.length&&u[y]<d+1;)y++;y=Math.min(u.length-1,y);const T=u[p],E=u[y];return"composite"===l.kind?{kind:"composite",minZoom:T,maxZoom:E,interpolationType:_}:{kind:"camera",minZoom:T,maxZoom:E,minSize:l.evaluate(new _r(T)),maxSize:l.evaluate(new _r(E)),interpolationType:_}}}function Jb(d,{uSize:o,uSizeT:l},{lowerSize:u,upperSize:_}){return"source"===d.kind?u/ad:"composite"===d.kind?Lt(u/ad,_/ad,l):o}function jy(d,o,l=1){let u=0,_=0;if("constant"===d.kind)_=d.layoutSize*l;else if("source"!==d.kind){const{interpolationType:p,minZoom:y,maxZoom:T}=d,E=p?En(Jo.interpolationFactor(p,o,y,T),0,1):0;"camera"===d.kind?_=Lt(d.minSize,d.maxSize,E)*l:u=E*l}return{uSizeT:u,uSize:_}}var Uw=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ad,evaluateSizeForFeature:Jb,evaluateSizeForZoom:jy,getRasterizedIconSize:Uy,getSizeData:lh});function WL(d,o,l){return d.sections.forEach(u=>{u.text=function(_,p,y){const T=p.layout.get("text-transform").evaluate(y,{});return"uppercase"===T?_=_.toLocaleUpperCase():"lowercase"===T&&(_=_.toLocaleLowerCase()),sr.applyArabicShaping&&(_=sr.applyArabicShaping(_)),_}(u.text,o,l)}),d}const Ef={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Hy(d){return"\ufe36"===d||"\ufe48"===d||"\ufe38"===d||"\ufe44"===d||"\ufe42"===d||"\ufe3e"===d||"\ufe3c"===d||"\ufe3a"===d||"\ufe18"===d||"\ufe40"===d||"\ufe10"===d||"\ufe13"===d||"\ufe14"===d||"\uff40"===d||"\uffe3"===d||"\ufe11"===d||"\ufe12"===d}function Bk(d){return"\ufe35"===d||"\ufe47"===d||"\ufe37"===d||"\ufe43"===d||"\ufe41"===d||"\ufe3d"===d||"\ufe3b"===d||"\ufe39"===d||"\ufe17"===d||"\ufe3f"===d}var jw,Hw,hM,$y={};function pM(){if(hM)return Hw;hM=1,Hw=o;var d=function fM(){return jw||(jw=1,$y.read=function(d,o,l,u,_){var p,y,T=8*_-u-1,E=(1<<T)-1,R=E>>1,w=-7,D=l?_-1:0,k=l?-1:1,S=d[o+D];for(D+=k,p=S&(1<<-w)-1,S>>=-w,w+=T;w>0;p=256*p+d[o+D],D+=k,w-=8);for(y=p&(1<<-w)-1,p>>=-w,w+=u;w>0;y=256*y+d[o+D],D+=k,w-=8);if(0===p)p=1-R;else{if(p===E)return y?NaN:1/0*(S?-1:1);y+=Math.pow(2,u),p-=R}return(S?-1:1)*y*Math.pow(2,p-u)},$y.write=function(d,o,l,u,_,p){var y,T,E,R=8*p-_-1,w=(1<<R)-1,D=w>>1,k=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,S=u?0:p-1,I=u?1:-1,O=o<0||0===o&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(T=isNaN(o)?1:0,y=w):(y=Math.floor(Math.log(o)/Math.LN2),o*(E=Math.pow(2,-y))<1&&(y--,E*=2),(o+=y+D>=1?k/E:k*Math.pow(2,1-D))*E>=2&&(y++,E/=2),y+D>=w?(T=0,y=w):y+D>=1?(T=(o*E-1)*Math.pow(2,_),y+=D):(T=o*Math.pow(2,D-1)*Math.pow(2,_),y=0));_>=8;d[l+S]=255&T,S+=I,T/=256,_-=8);for(y=y<<_|T,R+=_;R>0;d[l+S]=255&y,S+=I,y/=256,R-=8);d[l+S-I]|=128*O}),$y}();function o($){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView($)?$:new Uint8Array($||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var l=4294967296,u=1/l,_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function p($){return $.type===o.Bytes?$.readVarint()+$.pos:$.pos+1}function T($,Y,K){var ee=Y<=16383?1:Y<=2097151?2:Y<=268435455?3:Math.floor(Math.log(Y)/(7*Math.LN2));K.realloc(ee);for(var ue=K.pos-1;ue>=$;ue--)K.buf[ue+ee]=K.buf[ue]}function E($,Y){for(var K=0;K<$.length;K++)Y.writeVarint($[K])}function R($,Y){for(var K=0;K<$.length;K++)Y.writeSVarint($[K])}function w($,Y){for(var K=0;K<$.length;K++)Y.writeFloat($[K])}function D($,Y){for(var K=0;K<$.length;K++)Y.writeDouble($[K])}function k($,Y){for(var K=0;K<$.length;K++)Y.writeBoolean($[K])}function S($,Y){for(var K=0;K<$.length;K++)Y.writeFixed32($[K])}function I($,Y){for(var K=0;K<$.length;K++)Y.writeSFixed32($[K])}function O($,Y){for(var K=0;K<$.length;K++)Y.writeFixed64($[K])}function B($,Y){for(var K=0;K<$.length;K++)Y.writeSFixed64($[K])}function U($,Y){return($[Y]|$[Y+1]<<8|$[Y+2]<<16)+16777216*$[Y+3]}function q($,Y,K){$[K]=Y,$[K+1]=Y>>>8,$[K+2]=Y>>>16,$[K+3]=Y>>>24}function Z($,Y){return($[Y]|$[Y+1]<<8|$[Y+2]<<16)+($[Y+3]<<24)}return o.prototype={destroy:function(){this.buf=null},readFields:function($,Y,K){for(K=K||this.length;this.pos<K;){var ee=this.readVarint(),ue=ee>>3,de=this.pos;this.type=7&ee,$(ue,Y,this),this.pos===de&&this.skip(ee)}return Y},readMessage:function($,Y){return this.readFields($,Y,this.readVarint()+this.pos)},readFixed32:function(){var $=U(this.buf,this.pos);return this.pos+=4,$},readSFixed32:function(){var $=Z(this.buf,this.pos);return this.pos+=4,$},readFixed64:function(){var $=U(this.buf,this.pos)+U(this.buf,this.pos+4)*l;return this.pos+=8,$},readSFixed64:function(){var $=U(this.buf,this.pos)+Z(this.buf,this.pos+4)*l;return this.pos+=8,$},readFloat:function(){var $=d.read(this.buf,this.pos,!0,23,4);return this.pos+=4,$},readDouble:function(){var $=d.read(this.buf,this.pos,!0,52,8);return this.pos+=8,$},readVarint:function($){var Y,K,ee=this.buf;return Y=127&(K=ee[this.pos++]),K<128?Y:(Y|=(127&(K=ee[this.pos++]))<<7,K<128?Y:(Y|=(127&(K=ee[this.pos++]))<<14,K<128?Y:(Y|=(127&(K=ee[this.pos++]))<<21,K<128?Y:function(ue,de,ce){var we,fe,Te=ce.buf;if(we=(112&(fe=Te[ce.pos++]))>>4,fe<128||(we|=(127&(fe=Te[ce.pos++]))<<3,fe<128)||(we|=(127&(fe=Te[ce.pos++]))<<10,fe<128)||(we|=(127&(fe=Te[ce.pos++]))<<17,fe<128)||(we|=(127&(fe=Te[ce.pos++]))<<24,fe<128)||(we|=(1&(fe=Te[ce.pos++]))<<31,fe<128))return function y($,Y,K){return K?4294967296*Y+($>>>0):4294967296*(Y>>>0)+($>>>0)}(ue,we,de);throw new Error("Expected varint not more than 10 bytes")}(Y|=(15&(K=ee[this.pos]))<<28,$,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var $=this.readVarint();return $%2==1?($+1)/-2:$/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var $=this.readVarint()+this.pos,Y=this.pos;return this.pos=$,$-Y>=12&&_?_.decode(this.buf.subarray(Y,$)):function(K,ee,ue){for(var de="",ce=ee;ce<ue;){var we,fe,Te,ke=K[ce],De=null,Pe=ke>239?4:ke>223?3:ke>191?2:1;if(ce+Pe>ue)break;1===Pe?ke<128&&(De=ke):2===Pe?128==(192&(we=K[ce+1]))&&(De=(31&ke)<<6|63&we)<=127&&(De=null):3===Pe?(fe=K[ce+2],128==(192&(we=K[ce+1]))&&128==(192&fe)&&((De=(15&ke)<<12|(63&we)<<6|63&fe)<=2047||De>=55296&&De<=57343)&&(De=null)):4===Pe&&(fe=K[ce+2],Te=K[ce+3],128==(192&(we=K[ce+1]))&&128==(192&fe)&&128==(192&Te)&&((De=(15&ke)<<18|(63&we)<<12|(63&fe)<<6|63&Te)<=65535||De>=1114112)&&(De=null)),null===De?(De=65533,Pe=1):De>65535&&(De-=65536,de+=String.fromCharCode(De>>>10&1023|55296),De=56320|1023&De),de+=String.fromCharCode(De),ce+=Pe}return de}(this.buf,Y,$)},readBytes:function(){var $=this.readVarint()+this.pos,Y=this.buf.subarray(this.pos,$);return this.pos=$,Y},readPackedVarint:function($,Y){if(this.type!==o.Bytes)return $.push(this.readVarint(Y));var K=p(this);for($=$||[];this.pos<K;)$.push(this.readVarint(Y));return $},readPackedSVarint:function($){if(this.type!==o.Bytes)return $.push(this.readSVarint());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readSVarint());return $},readPackedBoolean:function($){if(this.type!==o.Bytes)return $.push(this.readBoolean());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readBoolean());return $},readPackedFloat:function($){if(this.type!==o.Bytes)return $.push(this.readFloat());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readFloat());return $},readPackedDouble:function($){if(this.type!==o.Bytes)return $.push(this.readDouble());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readDouble());return $},readPackedFixed32:function($){if(this.type!==o.Bytes)return $.push(this.readFixed32());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readFixed32());return $},readPackedSFixed32:function($){if(this.type!==o.Bytes)return $.push(this.readSFixed32());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readSFixed32());return $},readPackedFixed64:function($){if(this.type!==o.Bytes)return $.push(this.readFixed64());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readFixed64());return $},readPackedSFixed64:function($){if(this.type!==o.Bytes)return $.push(this.readSFixed64());var Y=p(this);for($=$||[];this.pos<Y;)$.push(this.readSFixed64());return $},skip:function($){var Y=7&$;if(Y===o.Varint)for(;this.buf[this.pos++]>127;);else if(Y===o.Bytes)this.pos=this.readVarint()+this.pos;else if(Y===o.Fixed32)this.pos+=4;else{if(Y!==o.Fixed64)throw new Error("Unimplemented type: "+Y);this.pos+=8}},writeTag:function($,Y){this.writeVarint($<<3|Y)},realloc:function($){for(var Y=this.length||16;Y<this.pos+$;)Y*=2;if(Y!==this.length){var K=new Uint8Array(Y);K.set(this.buf),this.buf=K,this.length=Y}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function($){this.realloc(4),q(this.buf,$,this.pos),this.pos+=4},writeSFixed32:function($){this.realloc(4),q(this.buf,$,this.pos),this.pos+=4},writeFixed64:function($){this.realloc(8),q(this.buf,-1&$,this.pos),q(this.buf,Math.floor($*u),this.pos+4),this.pos+=8},writeSFixed64:function($){this.realloc(8),q(this.buf,-1&$,this.pos),q(this.buf,Math.floor($*u),this.pos+4),this.pos+=8},writeVarint:function($){($=+$||0)>268435455||$<0?function(Y,K){var ee,ue,de,we;if(Y>=0?(ee=Y%4294967296|0,ue=Y/4294967296|0):(ue=~(-Y/4294967296),4294967295^(ee=~(-Y%4294967296))?ee=ee+1|0:(ee=0,ue=ue+1|0)),Y>=0x10000000000000000||Y<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");K.realloc(10),de=ee,(we=K).buf[we.pos++]=127&de|128,de>>>=7,we.buf[we.pos++]=127&de|128,de>>>=7,we.buf[we.pos++]=127&de|128,de>>>=7,we.buf[we.pos++]=127&de|128,we.buf[we.pos]=127&(de>>>=7),function(de,ce){var we=(7&de)<<4;ce.buf[ce.pos++]|=we|((de>>>=3)?128:0),de&&(ce.buf[ce.pos++]=127&de|((de>>>=7)?128:0),de&&(ce.buf[ce.pos++]=127&de|((de>>>=7)?128:0),de&&(ce.buf[ce.pos++]=127&de|((de>>>=7)?128:0),de&&(ce.buf[ce.pos++]=127&de|((de>>>=7)?128:0),de&&(ce.buf[ce.pos++]=127&de)))))}(ue,K)}($,this):(this.realloc(4),this.buf[this.pos++]=127&$|($>127?128:0),$<=127||(this.buf[this.pos++]=127&($>>>=7)|($>127?128:0),$<=127||(this.buf[this.pos++]=127&($>>>=7)|($>127?128:0),$<=127||(this.buf[this.pos++]=$>>>7&127))))},writeSVarint:function($){this.writeVarint($<0?2*-$-1:2*$)},writeBoolean:function($){this.writeVarint(!!$)},writeString:function($){$=String($),this.realloc(4*$.length),this.pos++;var Y=this.pos;this.pos=function(ee,ue,de){for(var ce,we,fe=0;fe<ue.length;fe++){if((ce=ue.charCodeAt(fe))>55295&&ce<57344){if(!we){ce>56319||fe+1===ue.length?(ee[de++]=239,ee[de++]=191,ee[de++]=189):we=ce;continue}if(ce<56320){ee[de++]=239,ee[de++]=191,ee[de++]=189,we=ce;continue}ce=we-55296<<10|ce-56320|65536,we=null}else we&&(ee[de++]=239,ee[de++]=191,ee[de++]=189,we=null);ce<128?ee[de++]=ce:(ce<2048?ee[de++]=ce>>6|192:(ce<65536?ee[de++]=ce>>12|224:(ee[de++]=ce>>18|240,ee[de++]=ce>>12&63|128),ee[de++]=ce>>6&63|128),ee[de++]=63&ce|128)}return de}(this.buf,$,this.pos);var K=this.pos-Y;K>=128&&T(Y,K,this),this.pos=Y-1,this.writeVarint(K),this.pos+=K},writeFloat:function($){this.realloc(4),d.write(this.buf,$,this.pos,!0,23,4),this.pos+=4},writeDouble:function($){this.realloc(8),d.write(this.buf,$,this.pos,!0,52,8),this.pos+=8},writeBytes:function($){var Y=$.length;this.writeVarint(Y),this.realloc(Y);for(var K=0;K<Y;K++)this.buf[this.pos++]=$[K]},writeRawMessage:function($,Y){this.pos++;var K=this.pos;$(Y,this);var ee=this.pos-K;ee>=128&&T(K,ee,this),this.pos=K-1,this.writeVarint(ee),this.pos+=ee},writeMessage:function($,Y,K){this.writeTag($,o.Bytes),this.writeRawMessage(Y,K)},writePackedVarint:function($,Y){Y.length&&this.writeMessage($,E,Y)},writePackedSVarint:function($,Y){Y.length&&this.writeMessage($,R,Y)},writePackedBoolean:function($,Y){Y.length&&this.writeMessage($,k,Y)},writePackedFloat:function($,Y){Y.length&&this.writeMessage($,w,Y)},writePackedDouble:function($,Y){Y.length&&this.writeMessage($,D,Y)},writePackedFixed32:function($,Y){Y.length&&this.writeMessage($,S,Y)},writePackedSFixed32:function($,Y){Y.length&&this.writeMessage($,I,Y)},writePackedFixed64:function($,Y){Y.length&&this.writeMessage($,O,Y)},writePackedSFixed64:function($,Y){Y.length&&this.writeMessage($,B,Y)},writeBytesField:function($,Y){this.writeTag($,o.Bytes),this.writeBytes(Y)},writeFixed32Field:function($,Y){this.writeTag($,o.Fixed32),this.writeFixed32(Y)},writeSFixed32Field:function($,Y){this.writeTag($,o.Fixed32),this.writeSFixed32(Y)},writeFixed64Field:function($,Y){this.writeTag($,o.Fixed64),this.writeFixed64(Y)},writeSFixed64Field:function($,Y){this.writeTag($,o.Fixed64),this.writeSFixed64(Y)},writeVarintField:function($,Y){this.writeTag($,o.Varint),this.writeVarint(Y)},writeSVarintField:function($,Y){this.writeTag($,o.Varint),this.writeSVarint(Y)},writeStringField:function($,Y){this.writeTag($,o.Bytes),this.writeString(Y)},writeFloatField:function($,Y){this.writeTag($,o.Fixed32),this.writeFloat(Y)},writeDoubleField:function($,Y){this.writeTag($,o.Fixed64),this.writeDouble(Y)},writeBooleanField:function($,Y){this.writeVarintField($,!!Y)}},Hw}var e0=To(pM());function mM(d,o,l){o.glyphs=[],1===d&&l.readMessage($w,o)}function $w(d,o,l){if(3===d){const{id:u,bitmap:_,width:p,height:y,left:T,top:E,advance:R}=l.readMessage(Vk,{});o.glyphs.push({id:u,bitmap:new Tf({width:p+6,height:y+6},_),metrics:{width:p,height:y,left:T,top:E,advance:R}})}else 4===d?o.ascender=l.readSVarint():5===d&&(o.descender=l.readSVarint())}function Vk(d,o,l){1===d?o.id=l.readVarint():2===d?o.bitmap=l.readBytes():3===d?o.width=l.readVarint():4===d?o.height=l.readVarint():5===d?o.left=l.readSVarint():6===d?o.top=l.readSVarint():7===d&&(o.advance=l.readVarint())}const Mc={horizontal:1,vertical:2,horizontalOnly:3};class t0{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(o,l){const u=new t0;return u.scale=o||1,u.fontStack=l,u}static forImage(o){const l=new t0;return l.image=o,l}}class Qd{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(o,l){const u=new Qd;for(let _=0;_<o.sections.length;_++){const p=o.sections[_];p.image?u.addImageSection(p):u.addTextSection(p,l)}return u}length(){return this.text.length}getSection(o){return this.sections[this.sectionIndex[o]]}getSections(){return this.sections}getSectionIndex(o){return this.sectionIndex[o]}getCodePoint(o){return this.text.codePointAt(o)}verticalizePunctuation(o){this.text=function(l,u){let _="";for(let p=0;p<l.length;p++){const y=l.charCodeAt(p+1)||null,T=l.charCodeAt(p-1)||null;_+=!u&&(y&&iy(y)&&!Ef[l[p+1]]||T&&iy(T)&&!Ef[l[p-1]])||!Ef[l[p]]?l[p]:Ef[l[p]]}return _}(this.text,o)}trim(){let o=0;for(let u=0;u<this.text.length&&em[this.text.charCodeAt(u)];u++)o++;let l=this.text.length;for(let u=this.text.length-1;u>=0&&u>=o&&em[this.text.charCodeAt(u)];u--)l--;this.text=this.text.substring(o,l),this.sectionIndex=this.sectionIndex.slice(o,l)}substring(o,l){const u=new Qd;return u.text=this.text.substring(o,l),u.sectionIndex=this.sectionIndex.slice(o,l),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((o,l)=>Math.max(o,this.sections[l].scale),0)}addTextSection(o,l){this.text+=o.text,this.sections.push(t0.forText(o.scale,o.fontStack||l));const u=this.sections.length-1;for(let _=0;_<o.text.length;++_)this.sectionIndex.push(u)}addImageSection(o){const l=o.image&&o.image.namePrimary?o.image.getPrimary():null;if(!l)return void Yn("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(t0.forImage(l)),this.sectionIndex.push(this.sections.length-1)):Yn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Gw(d,o,l,u,_,p,y,T,E,R,w,D,k,S,I){const O=Qd.fromFeature(d,_);D===Mc.vertical&&O.verticalizePunctuation(k);let B=[];const U=function(K,ee,ue,de,ce,we){if(!K)return[];const fe=[],Te=function(Ne,je,Le,it,_t,rt){let Et=0;for(let St=0;St<Ne.length();St++){const zt=Ne.getSection(St);Et+=$g(Ne.getCodePoint(St),zt,it,_t,je,rt)}return Et/Math.max(1,Math.ceil(Et/Le))}(K,ee,ue,de,ce,we),ke=K.text.indexOf("\u200b")>=0;let De=0;for(let Ne=0;Ne<K.length();Ne++){const je=K.getSection(Ne),Le=K.getCodePoint(Ne);if(em[Le]||(De+=$g(Le,je,de,ce,ee,we)),Ne<K.length()-1){const it=!((Pe=Le)<11904||!(rn_Bopomofo_Extended(Pe)||rn_Bopomofo(Pe)||rn_CJK_Compatibility_Forms(Pe)||rn_CJK_Compatibility_Ideographs(Pe)||rn_CJK_Compatibility(Pe)||rn_CJK_Radicals_Supplement(Pe)||rn_CJK_Strokes(Pe)||rn_CJK_Symbols_and_Punctuation(Pe)||rn_CJK_Unified_Ideographs_Extension_A(Pe)||rn_CJK_Unified_Ideographs(Pe)||rn_Enclosed_CJK_Letters_and_Months(Pe)||rn_Halfwidth_and_Fullwidth_Forms(Pe)||rn_Hiragana(Pe)||rn_Ideographic_Description_Characters(Pe)||rn_Kangxi_Radicals(Pe)||rn_Katakana_Phonetic_Extensions(Pe)||rn_Katakana(Pe)||rn_Vertical_Forms(Pe)||rn_Yi_Radicals(Pe)||rn_Yi_Syllables(Pe)));(qw[Le]||it||je.image)&&fe.push(Ww(Ne+1,De,Te,fe,ZL(Le,K.getCodePoint(Ne+1),it&&ke),!1))}}var Pe;return gM(Ww(K.length(),De,Te,fe,0,!0))}(O,R,p,o,u,S),{processBidirectionalText:q,processStyledBidirectionalText:Z}=sr;if(q&&1===O.sections.length){const K=q(O.toString(),U);for(const ee of K){const ue=new Qd;ue.text=ee,ue.sections=O.sections;for(let de=0;de<ee.length;de++)ue.sectionIndex.push(0);B.push(ue)}}else if(Z){const K=Z(O.text,O.sectionIndex,U);for(const ee of K){const ue=new Qd;ue.text=ee[0],ue.sectionIndex=ee[1],ue.sections=O.sections,B.push(ue)}}else B=function(K,ee){const ue=[],de=K.text;let ce=0;for(const we of ee)ue.push(K.substring(ce,we)),ce=we;return ce<de.length&&ue.push(K.substring(ce,de.length)),ue}(O,U);const $=[],Y={positionedLines:$,text:O.toString(),top:w[1],bottom:w[1],left:w[0],right:w[0],writingMode:D,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(K,ee,ue,de,ce,we,fe,Te,ke,De,Pe,Ne){let je=0,Le=0,it=0;const _t="right"===Te?1:"left"===Te?0:.5;let rt=!1;for(const It of ce){const Xt=It.getSections();for(const dn of Xt){if(dn.image)continue;const On=ee[dn.fontStack];if(On&&(rt=void 0!==On.ascender&&void 0!==On.descender,!rt))break}if(!rt)break}let Et=0;for(const It of ce){It.trim();const Xt=It.getMaxScale(),dn=24*(Xt-1),On={positionedGlyphs:[],lineOffset:0};K.positionedLines[Et]=On;const Hn=On.positionedGlyphs;let Qn=0;if(!It.length()){Le+=we,++Et;continue}let $n=0,di=0;for(let qi=0;qi<It.length();qi++){const Cn=It.getSection(qi),Qi=It.getSectionIndex(qi),Yi=It.getCodePoint(qi);let Hi=Cn.scale,qr=null,ro=null,Wr=null,Da=24,cr=0;const Tr=!(ke===Mc.horizontal||!Pe&&!ny(Yi)||Pe&&(em[Yi]||(St=Yi,rn_Arabic(St)||rn_Arabic_Supplement(St)||rn_Arabic_Extended_A(St)||rn_Arabic_Presentation_Forms_A(St)||rn_Arabic_Presentation_Forms_B(St))));if(Cn.image){const da=de[Cn.image.serialize()];if(!da)continue;Wr=Cn.image.id,K.iconsInText=K.iconsInText||!0,ro=da.paddedRect;const vo=da.displaySize;Hi=24*Hi/Ne,qr={width:vo[0],height:vo[1],left:0,top:-3,advance:Tr?vo[1]:vo[0],localGlyph:!1},cr=rt?-qr.height*Hi:24*Xt-17-vo[1]*Hi,Da=qr.advance;const qa=(Tr?vo[0]:vo[1])*Hi-24*Xt;qa>0&&qa>Qn&&(Qn=qa)}else{const da=ue[Cn.fontStack];if(!da)continue;da[Yi]&&(ro=da[Yi]);const vo=ee[Cn.fontStack];if(!vo)continue;const qa=vo.glyphs[Yi];if(!qa)continue;if(qr=qa.metrics,Da=8203!==Yi?24:0,rt){const No=void 0!==vo.ascender?Math.abs(vo.ascender):0,nu=void 0!==vo.descender?Math.abs(vo.descender):0,mh=(No+nu)*Hi;$n<mh&&($n=mh,di=(No-nu)/2*Hi),cr=-No*Hi}else cr=24*(Xt-Hi)-17}Tr?(K.verticalizable=!0,Hn.push({glyph:Yi,imageName:Wr,x:je,y:Le+cr,vertical:Tr,scale:Hi,localGlyph:qr.localGlyph,fontStack:Cn.fontStack,sectionIndex:Qi,metrics:qr,rect:ro}),je+=Da*Hi+De):(Hn.push({glyph:Yi,imageName:Wr,x:je,y:Le+cr,vertical:Tr,scale:Hi,localGlyph:qr.localGlyph,fontStack:Cn.fontStack,sectionIndex:Qi,metrics:qr,rect:ro}),je+=qr.advance*Hi+De)}0!==Hn.length&&(it=Math.max(je-De,it),rt?r0(Hn,_t,Qn,di,we*Xt/2):r0(Hn,_t,Qn,0,we/2)),je=0;const lr=we*Xt+Qn;On.lineOffset=Math.max(Qn,dn),Le+=lr,++Et}var St;const zt=Le,{horizontalAlign:lt,verticalAlign:en}=n0(fe);(function(It,Xt,dn,On,Hn,Qn){const $n=(Xt-dn)*Hn,di=-Qn*On;for(const lr of It)for(const qi of lr.positionedGlyphs)qi.x+=$n,qi.y+=di})(K.positionedLines,_t,lt,en,it,zt),K.top+=-en*zt,K.bottom=K.top+zt,K.left+=-lt*it,K.right=K.left+it,K.hasBaseline=rt}(Y,o,l,u,B,y,T,E,D,R,k,I),!function(K){for(const ee of K)if(0!==ee.positionedGlyphs.length)return!1;return!0}($)&&Y}const em={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qw={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function $g(d,o,l,u,_,p){if(o.image){const y=u[o.image.serialize()];return y?y.displaySize[0]*o.scale*24/p+_:0}{const y=l[o.fontStack],T=y&&y.glyphs[d];return T?T.metrics.advance*o.scale+_:0}}function jk(d,o,l,u){const _=Math.pow(d-o,2);return u?d<o?_/2:2*_:_+Math.abs(l)*l}function ZL(d,o,l){let u=0;return 10===d&&(u-=1e4),l&&(u+=150),40!==d&&65288!==d||(u+=50),41!==o&&65289!==o||(u+=50),u}function Ww(d,o,l,u,_,p){let y=null,T=jk(o,l,_,p);for(const E of u){const R=jk(o-E.x,l,_,p)+E.badness;R<=T&&(y=E,T=R)}return{index:d,x:o,priorBreak:y,badness:T}}function gM(d){return d?gM(d.priorBreak).concat(d.index):[]}function n0(d){let o=.5,l=.5;switch(d){case"right":case"top-right":case"bottom-right":o=1;break;case"left":case"top-left":case"bottom-left":o=0}switch(d){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:o,verticalAlign:l}}function r0(d,o,l,u,_){if(!(o||l||u||_))return;const p=d.length-1,y=d[p],T=(y.x+y.metrics.advance*y.scale)*o;for(let E=0;E<=p;E++)d[E].x-=T,d[E].y+=l+u+_}function _M(d,o,l,u){const{horizontalAlign:_,verticalAlign:p}=n0(u),y=l[0]-d.displaySize[0]*_,T=l[1]-d.displaySize[1]*p;return{imagePrimary:d,imageSecondary:o,top:T,bottom:T+d.displaySize[1],left:y,right:y+d.displaySize[0]}}function Df(d,o,l,u,_,p){const y=d.imagePrimary;let T;if(y.content){const B=y.content,U=y.pixelRatio||1;T=[B[0]/U,B[1]/U,y.displaySize[0]-B[2]/U,y.displaySize[1]-B[3]/U]}const E=o.left*p,R=o.right*p;let w,D,k,S;"width"===l||"both"===l?(S=_[0]+E-u[3],D=_[0]+R+u[1]):(S=_[0]+(E+R-y.displaySize[0])/2,D=S+y.displaySize[0]);const I=o.top*p,O=o.bottom*p;return"height"===l||"both"===l?(w=_[1]+I-u[0],k=_[1]+O+u[2]):(w=_[1]+(I+O-y.displaySize[1])/2,k=w+y.displaySize[1]),{imagePrimary:y,imageSecondary:void 0,top:w,right:D,bottom:k,left:S,collisionPadding:T}}class Jd extends Ft{constructor(o,l,u,_,p){super(o,l),this.angle=_,this.z=u,void 0!==p&&(this.segment=p)}clone(){return new Jd(this.x,this.y,this.z,this.angle,this.segment)}}function yM(d,o,l,u,_){if(void 0===o.segment)return!0;let p=o,y=o.segment+1,T=0;for(;T>-l/2;){if(y--,y<0)return!1;T-=d[y].dist(p),p=d[y]}T+=d[y].dist(d[y+1]),y++;const E=[];let R=0;for(;T<l/2;){const w=d[y],D=d[y+1];if(!D)return!1;let k=d[y-1].angleTo(w)-w.angleTo(D);for(k=Math.abs((k+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:T,angleDelta:k}),R+=k;T-E[0].distance>u;)R-=E.shift().angleDelta;if(R>_)return!1;y++,T+=w.dist(D)}return!0}function vM(d){let o=0;for(let l=0;l<d.length-1;l++)o+=d[l].dist(d[l+1]);return o}function bM(d,o,l){return d?.6*o*l:0}function xM(d,o){return Math.max(d?d.right-d.left:0,o?o.right-o.left:0)}function wM(d,o,l,u,_,p){const y=bM(l,_,p),T=xM(l,u)*p;let E=0;const R=vM(d)/2;for(let w=0;w<d.length-1;w++){const D=d[w],k=d[w+1],S=D.dist(k);if(E+S>R){const I=(R-E)/S,O=Lt(D.x,k.x,I),B=Lt(D.y,k.y,I),U=new Jd(O,B,0,k.angleTo(D),w);return!y||yM(d,U,T,y,o)?U:void 0}E+=S}}function Hk(d,o,l,u,_,p,y,T,E){const R=bM(u,p,y),w=xM(u,_),D=w*y,k=0===d[0].x||d[0].x===E||0===d[0].y||d[0].y===E;return o-D<o/4&&(o=D+o/4),CM(d,k?o/2*T%o:(w/2+2*p)*y*T%o,o,R,l,D,k,!1,E)}function CM(d,o,l,u,_,p,y,T,E){const R=p/2,w=vM(d);let D=0,k=o-l,S=[];for(let I=0;I<d.length-1;I++){const O=d[I],B=d[I+1],U=O.dist(B),q=B.angleTo(O);for(;k+l<D+U;){k+=l;const Z=(k-D)/U,$=Lt(O.x,B.x,Z),Y=Lt(O.y,B.y,Z);if($>=0&&$<E&&Y>=0&&Y<E&&k-R>=0&&k+R<=w){const K=new Jd($,Y,0,q,I);u&&!yM(d,K,p,u,_)||S.push(K)}}D+=U}return T||S.length||y||(S=CM(d,D/2,l,u,_,p,y,!0,E)),S}function TM(d,o,l,u,_){const p=[];for(let y=0;y<d.length;y++){const T=d[y];let E;for(let R=0;R<T.length-1;R++){let w=T[R],D=T[R+1];w.x<o&&D.x<o||(w.x<o?w=new Ft(o,w.y+(o-w.x)/(D.x-w.x)*(D.y-w.y))._round():D.x<o&&(D=new Ft(o,w.y+(o-w.x)/(D.x-w.x)*(D.y-w.y))._round()),w.y<l&&D.y<l||(w.y<l?w=new Ft(w.x+(l-w.y)/(D.y-w.y)*(D.x-w.x),l)._round():D.y<l&&(D=new Ft(w.x+(l-w.y)/(D.y-w.y)*(D.x-w.x),l)._round()),w.x>=u&&D.x>=u||(w.x>=u?w=new Ft(u,w.y+(u-w.x)/(D.x-w.x)*(D.y-w.y))._round():D.x>=u&&(D=new Ft(u,w.y+(u-w.x)/(D.x-w.x)*(D.y-w.y))._round()),w.y>=_&&D.y>=_||(w.y>=_?w=new Ft(w.x+(_-w.y)/(D.y-w.y)*(D.x-w.x),_)._round():D.y>=_&&(D=new Ft(w.x+(_-w.y)/(D.y-w.y)*(D.x-w.x),_)._round()),E&&w.equals(E[E.length-1])||(E=[w],p.push(E)),E.push(D)))))}}return p}function MM(d){let o=0,l=0;for(const y of d)o+=y.w*y.h,l=Math.max(l,y.w);d.sort((y,T)=>T.h-y.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(o/.95)),l),h:1/0}];let _=0,p=0;for(const y of d)for(let T=u.length-1;T>=0;T--){const E=u[T];if(!(y.w>E.w||y.h>E.h)){if(y.x=E.x,y.y=E.y,p=Math.max(p,y.y+y.h),_=Math.max(_,y.x+y.w),y.w===E.w&&y.h===E.h){const R=u.pop();T<u.length&&(u[T]=R)}else y.h===E.h?(E.x+=y.w,E.w-=y.w):y.w===E.w?(E.y+=y.h,E.h-=y.h):(u.push({x:E.x+y.w,y:E.y,w:E.w-y.w,h:y.h}),E.y+=y.h,E.h-=y.h);break}}return{w:_,h:p,fill:o/(_*p)||0}}Zt(Jd,"Anchor");class qy{constructor(o,{pixelRatio:l,version:u,stretchX:_,stretchY:p,content:y},T){this.paddedRect=o,this.pixelRatio=l,this.stretchX=_,this.stretchY=p,this.content=y,this.version=u,this.padding=T}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class SM{constructor(o,l,u){const _={},p={};this.haveRenderCallbacks=[];const y=[];this.addImages(o,_,1,y),this.addImages(l,p,2,y);const{w:T,h:E}=MM(y),R=new Nr({width:T||1,height:E||1});for(const w in o){const D=o[w],k=_[w].paddedRect;Nr.copy(D.data,R,{x:0,y:0},{x:k.x+1,y:k.y+1},D.data,u,D.sdf)}for(const w in l){const D=l[w],k=p[w].paddedRect;let S=p[w].padding;const I=k.x+S,O=k.y+S,B=D.data.width,U=D.data.height;S=S>1?S-1:S,Nr.copy(D.data,R,{x:0,y:0},{x:I,y:O},D.data,u),Nr.copy(D.data,R,{x:0,y:U-S},{x:I,y:O-S},{width:B,height:S},u),Nr.copy(D.data,R,{x:0,y:0},{x:I,y:O+U},{width:B,height:S},u),Nr.copy(D.data,R,{x:B-S,y:0},{x:I-S,y:O},{width:S,height:U},u),Nr.copy(D.data,R,{x:0,y:0},{x:I+B,y:O},{width:S,height:U},u),Nr.copy(D.data,R,{x:B-S,y:U-S},{x:I-S,y:O-S},{width:S,height:S},u),Nr.copy(D.data,R,{x:0,y:U-S},{x:I+B,y:O-S},{width:S,height:S},u),Nr.copy(D.data,R,{x:0,y:0},{x:I+B,y:O+U},{width:S,height:S},u),Nr.copy(D.data,R,{x:B-S,y:0},{x:I-S,y:O+U},{width:S,height:S},u)}this.image=R,this.iconPositions=_,this.patternPositions=p}addImages(o,l,u,_){for(const p in o){const y=o[p],T={x:0,y:0,w:y.data.width+2*u,h:y.data.height+2*u};_.push(T),l[p]=new qy(T,y,u),y.hasRenderCallback&&this.haveRenderCallbacks.push($c.deserializeId(p))}}patchUpdatedImages(o,l,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(_=>o.hasImage(_,u)),o.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const _ in o.getUpdatedImages(u)){for(const p of Object.keys(this.iconPositions))$c.deserializeId(p)===_&&this.patchUpdatedImage(this.iconPositions[p],o.getImage(_,u),l);for(const p of Object.keys(this.patternPositions))$c.deserializeId(p)===_&&this.patchUpdatedImage(this.patternPositions[p],o.getImage(_,u),l)}}patchUpdatedImage(o,l,u){if(!o||!l||o.version===l.version)return;o.version=l.version;const[_,p]=o.tl;u.update(l.data,{position:{x:_,y:p}})}}Zt(qy,"ImagePosition"),Zt(SM,"ImageAtlas");const Wy=1e20;function Sc(d,o,l,u,_,p,y,T,E){for(let R=o;R<o+u;R++)Zy(d,l*p+R,p,_,y,T,E);for(let R=l;R<l+_;R++)Zy(d,R*p+o,1,u,y,T,E)}function Zy(d,o,l,u,_,p,y){p[0]=0,y[0]=-Wy,y[1]=Wy,_[0]=d[o];for(let T=1,E=0,R=0;T<u;T++){_[T]=d[o+T*l];const w=T*T;do{const D=p[E];R=(_[T]-_[D]+w-D*D)/(T-D)/2}while(R<=y[E]&&--E>-1);E++,p[E]=T,y[E]=R,y[E+1]=Wy}for(let T=0,E=0;T<u;T++){for(;y[E+1]<T;)E++;const R=p[E],w=T-R;d[o+T*l]=_[R]+w*w}}const If={none:0,ideographs:1,all:2};class Gg{constructor(o,l,u){this.requestManager=o,this.localGlyphMode=l,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(o,l){this.urls[l]=o}getGlyphs(o,l,u){const _=[],p=this.urls[l]||ge.GLYPHS_URL;for(const y in o)for(const T of o[y])_.push({stack:y,id:T});La(_,({stack:y,id:T},E)=>{let R=this.entries[y];R||(R=this.entries[y]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let w=R.glyphs[T];if(void 0!==w)return void E(null,{stack:y,id:T,glyph:w});if(w=this._tinySDF(R,y,T),w)return R.glyphs[T]=w,void E(null,{stack:y,id:T,glyph:w});const D=Math.floor(T/256);if(256*D>65535)return Yn("glyphs > 65535 not supported"),void E(null,{stack:y,id:T,glyph:w});if(R.ranges[D])return void E(null,{stack:y,id:T,glyph:w});let k=R.requests[D];k||(k=R.requests[D]=[],Gg.loadGlyphRange(y,D,p,this.requestManager,(S,I)=>{if(I){R.ascender=I.ascender,R.descender=I.descender;for(const O in I.glyphs)this._doesCharSupportLocalGlyph(+O)||(R.glyphs[+O]=I.glyphs[+O]);R.ranges[D]=!0}for(const O of k)O(S,I);delete R.requests[D]})),k.push((S,I)=>{S?E(S):I&&E(null,{stack:y,id:T,glyph:I.glyphs[T]||null})})},(y,T)=>{if(y)u(y);else if(T){const E={};for(const{stack:R,id:w,glyph:D}of T)void 0===E[R]&&(E[R]={}),void 0===E[R].glyphs&&(E[R].glyphs={}),E[R].glyphs[w]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},E[R].ascender=this.entries[R].ascender,E[R].descender=this.entries[R].descender;u(null,E)}})}_doesCharSupportLocalGlyph(o){return this.localGlyphMode!==If.none&&(this.localGlyphMode===If.all?!!this.localFontFamily:!!this.localFontFamily&&(rn_CJK_Unified_Ideographs(o)||rn_Hangul_Syllables(o)||rn_Hiragana(o)||rn_Katakana(o)||rn_CJK_Symbols_and_Punctuation(o)||rn_CJK_Unified_Ideographs_Extension_A(o)||rn_CJK_Unified_Ideographs_Extension_B(o)||rn_Osage(o)))}_tinySDF(o,l,u){const _=this.localFontFamily;if(!_||!this._doesCharSupportLocalGlyph(u))return;let p=o.tinySDF;if(!p){let O="400";/bold/i.test(l)?O="900":/medium/i.test(l)?O="500":/light/i.test(l)&&(O="200"),p=o.tinySDF=new Gg.TinySDF({fontFamily:_,fontWeight:O,fontSize:48,buffer:6,radius:16}),p.fontWeight=O}if(this.localGlyphs[p.fontWeight][u])return this.localGlyphs[p.fontWeight][u];const y=String.fromCodePoint(u),{data:T,width:E,height:R,glyphWidth:w,glyphHeight:D,glyphLeft:k,glyphTop:S,glyphAdvance:I}=p.draw(y);return this.localGlyphs[p.fontWeight][u]={id:u,bitmap:new Tf({width:E,height:R},T),metrics:{width:w/2,height:D/2,left:k/2,top:S/2-27,advance:I/2,localGlyph:!0}}}}Gg.loadGlyphRange=function(d,o,l,u,_){const p=256*o,y=p+255,T=u.transformRequest(u.normalizeGlyphsURL(l).replace("{fontstack}",d).replace("{range}",`${p}-${y}`),ol.Glyphs);Hh(T,(E,R)=>{if(E)_(E);else if(R){const w={},D=new e0(R).readFields(mM,{});for(const k of D.glyphs)w[k.id]=k;_(null,{glyphs:w,ascender:D.ascender,descender:D.descender})}})},Gg.TinySDF=class{constructor({fontSize:d=24,buffer:o=3,radius:l=8,cutoff:u=.25,fontFamily:_="sans-serif",fontWeight:p="normal",fontStyle:y="normal"}={}){this.buffer=o,this.cutoff=u,this.radius=l;const T=this.size=d+4*o,E=this._createCanvas(T),R=this.ctx=E.getContext("2d",{willReadFrequently:!0});R.font=`${y} ${p} ${d}px ${_}`,R.textBaseline="alphabetic",R.textAlign="left",R.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(d){const o=document.createElement("canvas");return o.width=o.height=d,o}draw(d){const{width:o,actualBoundingBoxAscent:l,actualBoundingBoxDescent:u,actualBoundingBoxLeft:_,actualBoundingBoxRight:p}=this.ctx.measureText(d),y=Math.ceil(l),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(p-_))),E=Math.min(this.size-this.buffer,y+Math.ceil(u)),R=T+2*this.buffer,w=E+2*this.buffer,D=Math.max(R*w,0),k=new Uint8ClampedArray(D),S={data:k,width:R,height:w,glyphWidth:T,glyphHeight:E,glyphTop:y,glyphLeft:0,glyphAdvance:o};if(0===T||0===E)return S;const{ctx:I,buffer:O,gridInner:B,gridOuter:U}=this;I.clearRect(O,O,T,E),I.fillText(d,O,O+y);const q=I.getImageData(O,O,T,E);U.fill(Wy,0,D),B.fill(0,0,D);for(let Z=0;Z<E;Z++)for(let $=0;$<T;$++){const Y=q.data[4*(Z*T+$)+3]/255;if(0===Y)continue;const K=(Z+O)*R+$+O;if(1===Y)U[K]=0,B[K]=Wy;else{const ee=.5-Y;U[K]=ee>0?ee*ee:0,B[K]=ee<0?ee*ee:0}}Sc(U,0,0,R,w,R,this.f,this.v,this.z),Sc(B,O,O,T,E,R,this.f,this.v,this.z);for(let Z=0;Z<D;Z++){const $=Math.sqrt(U[Z])-Math.sqrt(B[Z]);k[Z]=Math.round(255-255*($/this.radius+this.cutoff))}return S}};function $k(d,o){return d+o[1]-o[0]}function Yy(d,o,l,u,_=1){const p=[],y=d.imagePrimary,T=y.pixelRatio,E=y.paddedRect.w-2,R=y.paddedRect.h-2,w=(d.right-d.left)*_,D=(d.bottom-d.top)*_,k=y.stretchX||[[0,E]],S=y.stretchY||[[0,R]],I=k.reduce($k,0),O=S.reduce($k,0),B=E-I,U=R-O;let q=0,Z=I,$=0,Y=O,K=0,ee=B,ue=0,de=U;if(y.content&&u){const we=y.content;q=qg(k,0,we[0]),$=qg(S,0,we[1]),Z=qg(k,we[0],we[2]),Y=qg(S,we[1],we[3]),K=we[0]-q,ue=we[1]-$,ee=we[2]-we[0]-Z,de=we[3]-we[1]-Y}const ce=(we,fe,Te,ke)=>{const De=Xy(we.stretch-q,Z,w,d.left*_),Pe=Ky(we.fixed-K,ee,we.stretch,I),Ne=Xy(fe.stretch-$,Y,D,d.top*_),je=Ky(fe.fixed-ue,de,fe.stretch,O),Le=Xy(Te.stretch-q,Z,w,d.left*_),it=Ky(Te.fixed-K,ee,Te.stretch,I),_t=Xy(ke.stretch-$,Y,D,d.top*_),rt=Ky(ke.fixed-ue,de,ke.stretch,O),Et=new Ft(De,Ne),St=new Ft(Le,Ne),zt=new Ft(Le,_t),lt=new Ft(De,_t),en=new Ft(Pe/T,je/T),It=new Ft(it/T,rt/T),Xt=o*Math.PI/180;if(Xt){const di=Math.sin(Xt),lr=Math.cos(Xt),qi=[lr,-di,di,lr];Et._matMult(qi),St._matMult(qi),lt._matMult(qi),zt._matMult(qi)}const dn=we.stretch+we.fixed,On=Te.stretch+Te.fixed,Hn=fe.stretch+fe.fixed,Qn=ke.stretch+ke.fixed,$n=d.imageSecondary;return{tl:Et,tr:St,bl:lt,br:zt,texPrimary:{x:y.paddedRect.x+1+dn,y:y.paddedRect.y+1+Hn,w:On-dn,h:Qn-Hn},texSecondary:$n?{x:$n.paddedRect.x+1+dn,y:$n.paddedRect.y+1+Hn,w:On-dn,h:Qn-Hn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:en,pixelOffsetBR:It,minFontScaleX:ee/T/w,minFontScaleY:de/T/D,isSDF:l}};if(u&&(y.stretchX||y.stretchY)){const we=Zw(k,B,I),fe=Zw(S,U,O);for(let Te=0;Te<we.length-1;Te++){const ke=we[Te],De=we[Te+1];for(let Pe=0;Pe<fe.length-1;Pe++)p.push(ce(ke,fe[Pe],De,fe[Pe+1]))}}else p.push(ce({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:R+1}));return p}function qg(d,o,l){let u=0;for(const _ of d)u+=Math.max(o,Math.min(l,_[1]))-Math.max(o,Math.min(l,_[0]));return u}function Zw(d,o,l){const u=[{fixed:-1,stretch:0}];for(const[_,p]of d){const y=u[u.length-1];u.push({fixed:_-y.stretch,stretch:y.stretch}),u.push({fixed:_-y.stretch,stretch:y.stretch+(p-_)})}return u.push({fixed:o+1,stretch:l}),u}function Xy(d,o,l,u){return d/o*l+u}function Ky(d,o,l,u){return d-o*l/u}function tm(d,o,l,u){const _=o+d.positionedLines[u].lineOffset;return 0===u?l+_/2:l+(_+(o+d.positionedLines[u-1].lineOffset))/2}function Gk(d,o=1,l=!1){let u=1/0,_=1/0,p=-1/0,y=-1/0;const T=d[0];for(let S=0;S<T.length;S++){const I=T[S];(!S||I.x<u)&&(u=I.x),(!S||I.y<_)&&(_=I.y),(!S||I.x>p)&&(p=I.x),(!S||I.y>y)&&(y=I.y)}const E=Math.min(p-u,y-_);let R=E/2;const w=new hc([],qk);if(0===E)return new Ft(u,_);for(let S=u;S<p;S+=E)for(let I=_;I<y;I+=E)w.push(new Wg(S+R,I+R,R,d));let D=function(S){let I=0,O=0,B=0;const U=S[0];for(let q=0,Z=U.length,$=Z-1;q<Z;$=q++){const Y=U[q],K=U[$],ee=Y.x*K.y-K.x*Y.y;O+=(Y.x+K.x)*ee,B+=(Y.y+K.y)*ee,I+=3*ee}return new Wg(O/I,B/I,0,S)}(d),k=w.length;for(;w.length;){const S=w.pop();(S.d>D.d||!D.d)&&(D=S,l&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,k)),S.max-D.d<=o||(R=S.h/2,w.push(new Wg(S.p.x-R,S.p.y-R,R,d)),w.push(new Wg(S.p.x+R,S.p.y-R,R,d)),w.push(new Wg(S.p.x-R,S.p.y+R,R,d)),w.push(new Wg(S.p.x+R,S.p.y+R,R,d)),k+=4)}return l&&(console.log(`num probes: ${k}`),console.log(`best distance: ${D.d}`)),D.p}function qk(d,o){return o.max-d.max}class Wg{constructor(o,l,u,_){this.p=new Ft(o,l),this.h=u,this.d=function(p,y){let T=!1,E=1/0;for(let R=0;R<y.length;R++){const w=y[R];for(let D=0,k=w.length,S=k-1;D<k;S=D++){const I=w[D],O=w[S];I.y>p.y!=O.y>p.y&&p.x<(O.x-I.x)*(p.y-I.y)/(O.y-I.y)+I.x&&(T=!T),E=Math.min(E,ye(p,I,O))}}return(T?1:-1)*Math.sqrt(E)}(this.p,_),this.max=this.d+this.h*Math.SQRT2}}const Yw=Number.POSITIVE_INFINITY,Wk=Math.sqrt(2);function _l(d,[o,l]){let u=0,_=0;if(l===Yw){o<0&&(o=0);const p=o/Wk;switch(d){case"top-right":case"top-left":_=p-7;break;case"bottom-right":case"bottom-left":_=7-p;break;case"bottom":_=7-o;break;case"top":_=o-7}switch(d){case"top-right":case"bottom-right":u=-p;break;case"top-left":case"bottom-left":u=p;break;case"left":u=o;break;case"right":u=-o}}else{switch(o=Math.abs(o),l=Math.abs(l),d){case"top-right":case"top-left":case"top":_=l-7;break;case"bottom-right":case"bottom-left":case"bottom":_=7-l}switch(d){case"top-right":case"bottom-right":case"right":u=-o;break;case"top-left":case"bottom-left":case"left":u=o}}return[u,_]}function Ec(d){switch(d){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Zk(d,o,l,u,_,p,y,T,E,R,w,D,k,S,I,O){let B=p.textMaxSize.evaluate(o,{},k);void 0===B?B=y*p.textScaleFactor:B*=p.textScaleFactor;const U=d.layers[0].layout,q=U.get("icon-offset").evaluate(o,{},k),Z=DM(l.horizontal)||l.vertical,$="globe"===S.name,K=y*p.textScaleFactor/24,ee=d.tilePixelRatio*B/24,ue=(Pe=d.overscaling,d.zoom>18&&Pe>2&&(Pe>>=1),Math.max(Ot/(512*Pe),1)*U.get("symbol-spacing")),de=U.get("text-padding")*d.tilePixelRatio,ce=U.get("icon-padding")*d.tilePixelRatio,we=vi(U.get("text-max-angle")),fe="map"===U.get("text-rotation-alignment")&&"point"!==U.get("symbol-placement"),Te="map"===U.get("icon-rotation-alignment")&&"point"!==U.get("symbol-placement"),ke=U.get("symbol-placement"),De=ue/2;var Pe;const Ne=U.get("icon-text-fit").evaluate(o,{},k),je=U.get("icon-text-fit-padding").evaluate(o,{},k),Le="none"!==Ne;let it;!1===d.hasAnyIconTextFit&&Le&&(d.hasAnyIconTextFit=!0),u&&Le&&(d.allowVerticalPlacement&&l.vertical&&(it=Df(u,l.vertical,Ne,je,q,K)),Z&&(u=Df(u,Z,Ne,je,q,K)));const _t=(rt,Et,St)=>{if(Et.x<0||Et.x>=Ot||Et.y<0||Et.y>=Ot)return;let zt=null;if($){const{x:lt,y:en,z:It}=S.projectTilePoint(Et.x,Et.y,St);zt={anchor:new Jd(lt,en,It,0,void 0),up:S.upVector(St,Et.x,Et.y)}}!function(lt,en,It,Xt,dn,On,Hn,Qn,$n,di,lr,qi,Cn,Qi,Yi,Hi,qr,ro,Wr,Da,cr,Tr,da,vo,qa,No,nu,mh){const Uf=lt.addToLineVertexArray(en,Xt);let dd,ud,gh,G0,CS,R1,TS,MS=0,_m=0,SS=0,P1=0,O1=-1,ym=-1;const ua={};let Ns=Qm("");const vm=It?It.anchor:en,F1="none"!==$n.layout.get("icon-text-fit").evaluate(cr,{},No);let Cv=0,iu=0;if(void 0===$n._unevaluatedLayout.getValue("text-radial-offset")?[Cv,iu]=$n.layout.get("text-offset").evaluate(cr,{},No).map(Yl=>24*Yl):(Cv=24*$n.layout.get("text-radial-offset").evaluate(cr,{},No),iu=Yw),lt.allowVerticalPlacement&&dn.vertical){const Yl=dn.vertical;if(Yi)R1=s0(Yl),Qn&&(TS=s0(Qn));else{const vl=$n.layout.get("text-rotate").evaluate(cr,{},No)+90;gh=o0(di,vm,en,lr,qi,Cn,Yl,Qi,vl,Hi),Qn&&(G0=o0(di,vm,en,lr,qi,Cn,Qn,ro,vl))}}if(On){const Yl=lt.iconSizeData,vl=vo?Uy(lt.iconSizeData,lt.layers[0]._unevaluatedLayout._values["icon-size"],No,lt.zoom,cr):1,jf=$n.layout.get("icon-rotate").evaluate(cr,{},No),L1=Yy(On,jf,da,F1,vo?1/vl:Tr.iconScaleFactor),ru=Qn?Yy(Qn,jf,da,F1,Tr.iconScaleFactor):void 0;ud=o0(di,vm,en,lr,qi,Cn,On,ro,jf,null,vo?Tr.iconScaleFactor*vl:1),MS=4*L1.length;let fd=null;"source"===Yl.kind?(fd=[ad*$n.layout.get("icon-size").evaluate(cr,{},No)*Tr.iconScaleFactor],fd[0]>Af&&Yn(`${lt.layerIds[0]}: Value for "icon-size" is >= ${Qy}. Reduce your "icon-size".`)):"composite"===Yl.kind&&(fd=[ad*Tr.compositeIconSizes[0].evaluate(cr,{},No)*Tr.iconScaleFactor,ad*Tr.compositeIconSizes[1].evaluate(cr,{},No)*Tr.iconScaleFactor],(fd[0]>Af||fd[1]>Af)&&Yn(`${lt.layerIds[0]}: Value for "icon-size" is >= ${Qy}. Reduce your "icon-size".`)),lt.addSymbols(lt.icon,L1,fd,Da,Wr,cr,!1,It,en,Uf.lineStartIndex,Uf.lineLength,-1,qa,No,nu,mh),O1=lt.icon.placedSymbolArray.length-1,ru&&(_m=4*ru.length,lt.addSymbols(lt.icon,ru,fd,Da,Wr,cr,Mc.vertical,It,en,Uf.lineStartIndex,Uf.lineLength,-1,qa,No,nu,mh),ym=lt.icon.placedSymbolArray.length-1)}for(const Yl in dn.horizontal){const vl=dn.horizontal[Yl];dd||(Ns=Qm(vl.text),Yi?CS=s0(vl):dd=o0(di,vm,en,lr,qi,Cn,vl,Qi,$n.layout.get("text-rotate").evaluate(cr,{},No),Hi));const jf=1===vl.positionedLines.length;if(SS+=EM(lt,It,en,vl,Hn,$n,Yi,cr,Hi,Uf,dn.vertical?Mc.horizontal:Mc.horizontalOnly,jf?Object.keys(dn.horizontal):[Yl],ua,O1,Tr,qa,No,nu),jf)break}dn.vertical&&(P1+=EM(lt,It,en,dn.vertical,Hn,$n,Yi,cr,Hi,Uf,Mc.vertical,["vertical"],ua,ym,Tr,qa,No,nu));let hd=-1;const q0=(Yl,vl)=>Yl?Math.max(Yl,vl):vl;hd=q0(CS,hd),hd=q0(R1,hd),hd=q0(TS,hd);const Tv=hd>-1?1:0;lt.glyphOffsetArray.length>=65535&&Yn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==cr.sortKey&&lt.addToSortKeyRanges(lt.symbolInstances.length,cr.sortKey),lt.symbolInstances.emplaceBack(en.x,en.y,vm.x,vm.y,vm.z,ua.right>=0?ua.right:-1,ua.center>=0?ua.center:-1,ua.left>=0?ua.left:-1,ua.vertical>=0?ua.vertical:-1,O1,ym,Ns,void 0!==dd?dd:lt.collisionBoxArray.length,void 0!==dd?dd+1:lt.collisionBoxArray.length,void 0!==gh?gh:lt.collisionBoxArray.length,void 0!==gh?gh+1:lt.collisionBoxArray.length,void 0!==ud?ud:lt.collisionBoxArray.length,void 0!==ud?ud+1:lt.collisionBoxArray.length,G0||lt.collisionBoxArray.length,G0?G0+1:lt.collisionBoxArray.length,lr,SS,P1,MS,_m,Tv,0,Cv,iu,hd,0,F1?1:0)}(d,Et,zt,rt,l,u,_,it,d.layers[0],d.collisionBoxArray,o.index,o.sourceLayerIndex,d.index,de,fe,E,0,ce,Te,q,o,p,R,w,D,k,I,O)};if("line"===ke)for(const rt of TM(o.geometry,0,0,Ot,Ot)){const Et=Hk(rt,ue,we,l.vertical||Z,u,24,ee,d.overscaling,Ot);for(const St of Et)Z&&Yk(d,Z.text,De,St)||_t(rt,St,k)}else if("line-center"===ke){for(const rt of o.geometry)if(rt.length>1){const Et=wM(rt,we,l.vertical||Z,u,24,ee);Et&&_t(rt,Et,k)}}else if("Polygon"===o.type)for(const rt of Bb(o.geometry,0)){const Et=Gk(rt,16);_t(rt[0],new Jd(Et.x,Et.y,0,0,void 0),k)}else if("LineString"===o.type)for(const rt of o.geometry)_t(rt,new Jd(rt[0].x,rt[0].y,0,0,void 0),k);else if("Point"===o.type)for(const rt of o.geometry)for(const Et of rt)_t([Et],new Jd(Et.x,Et.y,0,0,void 0),k)}const Qy=255,Af=Qy*ad;function EM(d,o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B,U){const q=function(Y,K,ee,ue,de,ce,we,fe){const Te=[];if(0===K.positionedLines.length)return Te;const ke=ue.layout.get("text-rotate").evaluate(ce,{})*Math.PI/180,De=function(it){const _t=it[0],rt=it[1],Et=_t*rt;return Et>0?[_t,-rt]:Et<0?[-_t,rt]:0===_t?[rt,_t]:[rt,-_t]}(ee);let Pe=Math.abs(K.top-K.bottom);for(const it of K.positionedLines)Pe-=it.lineOffset;const Ne=K.positionedLines.length,je=Pe/Ne;let Le=K.top-ee[1];for(let it=0;it<Ne;++it){const _t=K.positionedLines[it];Le=tm(K,je,Le,it);for(const rt of _t.positionedGlyphs){if(!rt.rect)continue;const Et=rt.rect||{};let St=4,zt=!0,lt=1,en=0;if(rt.imageName){const Wr=we[Ko.build(rt.imageName).getSerializedPrimary()];if(!Wr)continue;if(Wr.sdf){Yn("SDF images are not supported in formatted text and will be ignored.");continue}zt=!1,lt=Wr.pixelRatio,St=1/lt}const It=(de||fe)&&rt.vertical,Xt=rt.metrics.advance*rt.scale/2,dn=rt.metrics,On=rt.rect;if(null===On)continue;fe&&K.verticalizable&&(en=rt.imageName?Xt-rt.metrics.width*rt.scale/2:0);const Hn=de?[rt.x+Xt,rt.y]:[0,0];let Qn=[0,0],$n=[0,0],di=!1;de||(It?($n=[rt.x+Xt+De[0],rt.y+De[1]-en],di=!0):Qn=[rt.x+Xt+ee[0],rt.y+ee[1]-en]);const lr=On.w*rt.scale/(lt*(rt.localGlyph?2:1)),qi=On.h*rt.scale/(lt*(rt.localGlyph?2:1));let Cn,Qi,Yi,Hi;if(It){const Wr=rt.y-Le,Da=new Ft(-Xt,Xt-Wr),cr=-Math.PI/2,Tr=new Ft(...$n);Cn=new Ft(-Xt+Qn[0],Qn[1]),Cn._rotateAround(cr,Da)._add(Tr),Cn.x+=-Wr+Xt,Cn.y-=(dn.left-St)*rt.scale;const da=rt.imageName?dn.advance*rt.scale:24*rt.scale,vo=String.fromCodePoint(rt.glyph);Hy(vo)?Cn.x+=(1-St)*rt.scale:Bk(vo)?Cn.x+=da-dn.height*rt.scale+(-St-1)*rt.scale:Cn.x+=rt.imageName||dn.width+2*St===On.w&&dn.height+2*St===On.h?(da-qi)/2:(da-(dn.height+2*St)*rt.scale)/2,Qi=new Ft(Cn.x,Cn.y-lr),Yi=new Ft(Cn.x+qi,Cn.y),Hi=new Ft(Cn.x+qi,Cn.y-lr)}else{const Wr=(dn.left-St)*rt.scale-Xt+Qn[0],Da=(-dn.top-St)*rt.scale+Qn[1],cr=Wr+lr,Tr=Da+qi;Cn=new Ft(Wr,Da),Qi=new Ft(cr,Da),Yi=new Ft(Wr,Tr),Hi=new Ft(cr,Tr)}if(ke){let Wr;Wr=de?new Ft(0,0):di?new Ft(De[0],De[1]):new Ft(ee[0],ee[1]),Cn._rotateAround(ke,Wr),Qi._rotateAround(ke,Wr),Yi._rotateAround(ke,Wr),Hi._rotateAround(ke,Wr)}const qr=new Ft(0,0),ro=new Ft(0,0);Te.push({tl:Cn,tr:Qi,bl:Yi,br:Hi,texPrimary:Et,texSecondary:void 0,writingMode:K.writingMode,glyphOffset:Hn,sectionIndex:rt.sectionIndex,isSDF:zt,pixelOffsetTL:qr,pixelOffsetBR:ro,minFontScaleX:0,minFontScaleY:0})}}return Te}(0,u,E,p,y,T,_,d.allowVerticalPlacement),Z=d.textSizeData;let $=null;"source"===Z.kind?($=[ad*p.layout.get("text-size").evaluate(T,{},B)*I.textScaleFactor],$[0]>Af&&Yn(`${d.layerIds[0]}: Value for "text-size" is >= ${Qy}. Reduce your "text-size".`)):"composite"===Z.kind&&($=[ad*I.compositeTextSizes[0].evaluate(T,{},B)*I.textScaleFactor,ad*I.compositeTextSizes[1].evaluate(T,{},B)*I.textScaleFactor],($[0]>Af||$[1]>Af)&&Yn(`${d.layerIds[0]}: Value for "text-size" is >= ${Qy}. Reduce your "text-size".`)),d.addSymbols(d.text,q,$,E,y,T,w,o,l,R.lineStartIndex,R.lineLength,S,O,B,U,!1);for(const Y of D)k[Y]=d.text.placedSymbolArray.length-1;return 4*q.length}function DM(d){for(const o in d)return d[o];return null}function o0(d,o,l,u,_,p,y,T,E,R,w=1){let D=y.top/w,k=y.bottom/w,S=y.left/w,I=y.right/w;const O=y.collisionPadding;if(O&&(S-=O[0],D-=O[1],I+=O[2],k+=O[3]),E){const B=new Ft(S,D),U=new Ft(I,D),q=new Ft(S,k),Z=new Ft(I,k),$=vi(E);let Y=new Ft(0,0);R&&(Y=new Ft(R[0],R[1])),B._rotateAround($,Y),U._rotateAround($,Y),q._rotateAround($,Y),Z._rotateAround($,Y),S=Math.min(B.x,U.x,q.x,Z.x),I=Math.max(B.x,U.x,q.x,Z.x),D=Math.min(B.y,U.y,q.y,Z.y),k=Math.max(B.y,U.y,q.y,Z.y)}return d.emplaceBack(o.x,o.y,o.z,l.x,l.y,S,D,I,k,T,u,_,p),d.length-1}function s0(d){d.collisionPadding&&(d.top-=d.collisionPadding[1],d.bottom+=d.collisionPadding[3]);const o=d.bottom-d.top;return o>0?Math.max(10,o):null}function Yk(d,o,l,u){const _=d.compareText;if(o in _){const p=_[o];for(let y=p.length-1;y>=0;y--)if(u.dist(p[y])<l)return!0}else _[o]=[];return _[o].push(u),!1}function IM(d,o){const l=d.fovAboveCenter,u=d.elevation?d.elevation.getMinElevationBelowMSL()*o:0,_=(d._camera.position[2]*d.worldSize-u)/Math.cos(d._pitch),p=Math.sin(l)*_/Math.sin(Math.max(Math.PI/2-d._pitch-l,.01));let y=Math.sin(d._pitch)*p+_;const T=_*(1/d._horizonShift);return d.elevation&&0!==d.elevation.exaggeration()||(y*=1+Math.max(d.zoom-17,0)),Math.min(1.01*y,T)}function Jy(d,o){if(!o.isReprojectedInTileSpace)return{scale:1<<d.z,x:d.x,y:d.y,x2:d.x+1,y2:d.y+1,projection:o};const l=Math.pow(2,-d.z),u=d.x*l,_=(d.x+1)*l,p=d.y*l,y=(d.y+1)*l,T=aa(u),E=aa(_),R=Zo(p),w=Zo(y),D=o.project(T,R),k=o.project(E,R),S=o.project(E,w),I=o.project(T,w);let O=Math.min(D.x,k.x,S.x,I.x),B=Math.min(D.y,k.y,S.y,I.y),U=Math.max(D.x,k.x,S.x,I.x),q=Math.max(D.y,k.y,S.y,I.y);const Z=l/16;function $(K,ee,ue,de,ce,we){const fe=(ue+ce)/2,Te=(de+we)/2,ke=o.project(aa(fe),Zo(Te)),De=Math.max(0,O-ke.x,B-ke.y,ke.x-U,ke.y-q);O=Math.min(O,ke.x),U=Math.max(U,ke.x),B=Math.min(B,ke.y),q=Math.max(q,ke.y),De>Z&&($(K,ke,ue,de,fe,Te),$(ke,ee,fe,Te,ce,we))}$(D,k,u,p,_,p),$(k,S,_,p,_,y),$(S,I,_,y,u,y),$(I,D,u,y,u,p),O-=Z,B-=Z,U+=Z,q+=Z;const Y=1/Math.max(U-O,q-B);return{scale:Y,x:O*Y,y:B*Y,x2:U*Y,y2:q*Y,projection:o}}function kM(d,{x:o,y:l},u=0){return new Ft(((o-u)*d.scale-d.x)*Ot,(l*d.scale-d.y)*Ot)}const a0=Oe.mat4.identity(new Float32Array(16));class Ea{constructor(o){this.spec=o,this.name=o.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(o,l){return{x:0,y:0,z:0}}unproject(o,l){return new ii(0,0)}projectTilePoint(o,l,u){return{x:o,y:l,z:0}}locationPoint(o,l,u=!0){return o._coordinatePoint(o.locationCoordinate(l),u)}pixelsPerMeter(o,l){return Os(1,o)*l}pixelSpaceConversion(o,l,u){return 1}farthestPixelDistance(o){return IM(o,o.pixelsPerMeter)}pointCoordinate(o,l,u,_){const p=o.horizonLineFromTop(!1),y=new Ft(l,Math.max(p,u));return o.rayIntersectionCoordinate(o.pointRayIntersection(y,_))}pointCoordinate3D(o,l,u){const _=new Ft(l,u);if(o.elevation)return o.elevation.pointCoordinate(_);{const p=this.pointCoordinate(o,_.x,_.y,0);return[p.x,p.y,p.z]}}isPointAboveHorizon(o,l){if(o.elevation&&o.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(o,l.x,l.y);const u=o.horizonLineFromTop();return l.y<u}createInversionMatrix(o,l){return a0}createTileMatrix(o,l,u){let _,p,y;const T=u.canonical,E=Oe.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const R=Jy(T,this);_=1,p=R.x+u.wrap*R.scale,y=R.y,Oe.mat4.scale(E,E,[_/R.scale,_/R.scale,o.pixelsPerMeter/l])}else _=l/o.zoomScale(T.z),p=(T.x+Math.pow(2,T.z)*u.wrap)*_,y=T.y*_;return Oe.mat4.translate(E,E,[p,y,0]),Oe.mat4.scale(E,E,[_/Ot,_/Ot,1]),E}upVector(o,l,u){return[0,0,1]}upVectorScale(o,l,u){return{metersToTile:1}}}class ev extends Ea{constructor(o){super(o),this.range=[4,7],this.center=o.center||[-96,37.5];const[l,u]=this.parallels=o.parallels||[29.5,45.5],_=Math.sin(vi(l));this.n=(_+Math.sin(vi(u)))/2,this.c=1+_*(2*this.n-_),this.r0=Math.sqrt(this.c)/this.n}project(o,l){const{n:u,c:_,r0:p}=this,y=vi(o-this.center[0]),T=vi(l),E=Math.sqrt(_-2*u*Math.sin(T))/u;return{x:E*Math.sin(y*u),y:E*Math.cos(y*u)-p,z:0}}unproject(o,l){const{n:u,c:_,r0:p}=this,y=p+l;let T=Math.atan2(o,Math.abs(y))*Math.sign(y);y*u<0&&(T-=Math.PI*Math.sign(o)*Math.sign(y));const E=vi(this.center[0])*u;T=cc(T,-Math.PI-E,Math.PI-E);const R=En(pi(T/u)+this.center[0],-180,180),w=Math.asin(En((_-(o*o+y*y)*u*u)/(2*u),-1,1)),D=En(pi(w),-eo,eo);return new ii(R,D)}}const Zg=1.340264,Yg=-.081106,Xg=893e-6,l0=.003796,Xw=Math.sqrt(3)/2;class YL extends Ea{project(o,l){l=l/180*Math.PI,o=o/180*Math.PI;const u=Math.asin(Xw*Math.sin(l)),_=u*u,p=_*_*_;return{x:.5*(o*Math.cos(u)/(Xw*(Zg+3*Yg*_+p*(7*Xg+9*l0*_)))/Math.PI+.5),y:1-.5*(u*(Zg+Yg*_+p*(Xg+l0*_))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let u=l=(2*(1-l)-1)*Math.PI,_=u*u,p=_*_*_;for(let w,D,k,S=0;S<12&&(D=u*(Zg+Yg*_+p*(Xg+l0*_))-l,k=Zg+3*Yg*_+p*(7*Xg+9*l0*_),w=D/k,u=En(u-w,-Math.PI/3,Math.PI/3),_=u*u,p=_*_*_,!(Math.abs(w)<1e-12));++S);const y=Xw*o*(Zg+3*Yg*_+p*(7*Xg+9*l0*_))/Math.cos(u),T=Math.asin(Math.sin(u)/Xw),E=En(180*y/Math.PI,-180,180),R=En(180*T/Math.PI,-eo,eo);return new ii(E,R)}}class Kw extends Ea{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){return{x:.5+o/360,y:.5-l/360,z:0}}unproject(o,l){const u=360*(o-.5),_=En(360*(.5-l),-eo,eo);return new ii(u,_)}}const Rf=Math.PI/2;function Qw(d){return Math.tan((Rf+d)/2)}class XL extends Ea{constructor(o){super(o),this.center=o.center||[0,30];const[l,u]=this.parallels=o.parallels||[30,30];let _=vi(l),p=vi(u);this.southernCenter=_+p<0,this.southernCenter&&(_=-_,p=-p);const y=Math.cos(_),T=Qw(_);this.n=_===p?Math.sin(_):Math.log(y/Math.cos(p))/Math.log(Qw(p)/T),this.f=y*Math.pow(Qw(_),this.n)/this.n}project(o,l){l=vi(l),this.southernCenter&&(l=-l),o=vi(o-this.center[0]);const u=1e-6,{n:_,f:p}=this;p>0?l<-Rf+u&&(l=-Rf+u):l>Rf-u&&(l=Rf-u);const y=p/Math.pow(Qw(l),_);let T=y*Math.sin(_*o),E=p-y*Math.cos(_*o);return T=.5*(T/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:T,y:this.southernCenter?E:1-E,z:0}}unproject(o,l){o=(2*o-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:u,f:_}=this,p=_-l,y=Math.sign(p),T=Math.sign(u)*Math.sqrt(o*o+p*p);let E=Math.atan2(o,Math.abs(p))*y;p*u<0&&(E-=Math.PI*Math.sign(o)*y);const R=En(pi(E/u)+this.center[0],-180,180),w=En(pi(2*Math.atan(Math.pow(_/T,1/u))-Rf),-eo,eo);return new ii(R,this.southernCenter?-w:w)}}class Jw extends Ea{constructor(o){super(o),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(o,l){return{x:Hl(o),y:$l(l),z:0}}unproject(o,l){const u=aa(o),_=Zo(l);return new ii(u,_)}}const AM=vi(eo);class Xk extends Ea{project(o,l){const u=(l=vi(l))*l,_=u*u;return{x:.5*((o=vi(o))*(.8707-.131979*u+_*(_*(.003971*u-.001529*_)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+u*(.015085+_*(.028874*u-.044475-.005916*_)))/Math.PI+1),z:0}}unproject(o,l){o=(2*o-.5)*Math.PI;let u=l=(2*(1-l)-1)*Math.PI,_=25,p=0,y=u*u;do{y=u*u;const R=y*y;p=(u*(1.007226+y*(.015085+R*(.028874*y-.044475-.005916*R)))-l)/(1.007226+y*(.045255+R*(.259866*y-.311325-.005916*11*R))),u=En(u-p,-AM,AM)}while(Math.abs(p)>1e-6&&--_>0);y=u*u;const T=En(pi(o/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),E=pi(u);return new ii(T,E)}}const RM=vi(eo);class Kk extends Ea{project(o,l){l=vi(l),o=vi(o);const u=Math.cos(l),_=2/Math.PI,p=Math.acos(u*Math.cos(o/2)),y=Math.sin(p)/p,T=.5*(o*_+2*u*Math.sin(o/2)/y)||0,E=.5*(l+Math.sin(l)/y)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(o,l){let u=o=(2*o-.5)*Math.PI,_=l=(2*(1-l)-1)*Math.PI,p=25;const y=1e-6;let T=0,E=0;do{const R=Math.cos(_),w=Math.sin(_),D=2*w*R,k=w*w,S=R*R,I=Math.cos(u/2),O=Math.sin(u/2),B=2*I*O,U=O*O,q=1-S*I*I,Z=q?1/q:0,$=q?Math.acos(R*I)*Math.sqrt(1/q):0,Y=.5*(2*$*R*O+2*u/Math.PI)-o,K=.5*($*w+_)-l,ee=.5*Z*(S*U+$*R*I*k)+1/Math.PI,ue=Z*(B*D/4-$*w*O),de=.125*Z*(D*O-$*w*S*B),ce=.5*Z*(k*I+$*U*R)+.5,we=ue*de-ce*ee;T=(K*ue-Y*ce)/we,E=(Y*de-K*ee)/we,u=En(u-T,-Math.PI,Math.PI),_=En(_-E,-RM,RM)}while((Math.abs(T)>y||Math.abs(E)>y)&&--p>0);return new ii(pi(u),pi(_))}}class PM extends Ea{constructor(o){super(o),this.center=o.center||[0,0],this.parallels=o.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(vi(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(o,l){const{scale:u,cosPhi:_}=this;return{x:vi(o)*_*u+.5,y:-Math.sin(vi(l))/_*u+.5,z:0}}unproject(o,l){const{scale:u,cosPhi:_}=this,p=-(l-.5)/u,y=En(pi((o-.5)/u)/_,-180,180),T=Math.asin(En(p*_,-1,1)),E=En(pi(T),-eo,eo);return new ii(y,E)}}class OM extends Jw{constructor(o){super(o),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(o,l,u){const _=Zi(o,l,u),p=Ms(ko(u));return Oe.vec3.transformMat4(_,_,p),{x:_[0],y:_[1],z:_[2]}}locationPoint(o,l){const u=qd(l.lat,l.lng),_=Oe.vec3.normalize([],u),p=o.elevation?o.elevation.getAtPointOrZero(o.locationCoordinate(l),o._centerAltitude):o._centerAltitude,y=Os(1,0)*Ot*p;Oe.vec3.scaleAndAdd(u,u,_,y);const T=Oe.mat4.identity(new Float64Array(16));return Oe.mat4.multiply(T,o.pixelMatrix,o.globeMatrix),Oe.vec3.transformMat4(u,u,T),new Ft(u[0],u[1])}pixelsPerMeter(o,l){return Os(1,0)*l}pixelSpaceConversion(o,l,u){const _=Os(1,o)*l,p=Lt(Os(1,45)*l,_,u);return this.pixelsPerMeter(o,l)/p}createTileMatrix(o,l,u){const _=ml(ko(u.canonical));return Oe.mat4.multiply(new Float64Array(16),o.globeMatrix,_)}createInversionMatrix(o,l){const{center:u}=o,_=Ms(ko(l));return Oe.mat4.rotateY(_,_,vi(u.lng)),Oe.mat4.rotateX(_,_,vi(u.lat)),Oe.mat4.scale(_,_,[o._pixelsPerMercatorPixel,o._pixelsPerMercatorPixel,1]),Float32Array.from(_)}pointCoordinate(o,l,u,_){return Yo(o,l,u,!0)||new b(0,0)}pointCoordinate3D(o,l,u){const _=this.pointCoordinate(o,l,u,0);return[_.x,_.y,_.z]}isPointAboveHorizon(o,l){return!Yo(o,l.x,l.y,!1)}farthestPixelDistance(o){const l=function(_,p){const y=_.cameraToCenterDistance,T=_._centerAltitude*p,E=_._camera,R=_._camera.forward(),w=Oe.vec3.add([],Oe.vec3.scale([],R,-y),[0,0,T]),D=_.worldSize/(2*Math.PI),k=[0,0,-D],S=_.width/_.height,I=Math.tan(_.fovAboveCenter),O=Oe.vec3.scale([],E.up(),I),B=Oe.vec3.scale([],E.right(),I*S),U=Oe.vec3.normalize([],Oe.vec3.add([],Oe.vec3.add([],R,O),B)),q=[];let Z;if(new jn(w,U).closestPointOnSphere(k,D,q)){const $=Oe.vec3.add([],q,k),Y=Oe.vec3.sub([],$,w);Z=Math.cos(_.fovAboveCenter)*Oe.vec3.length(Y)}else{const $=Oe.vec3.sub([],w,k),Y=Oe.vec3.sub([],k,w);Oe.vec3.normalize(Y,Y);const K=Oe.vec3.length($)-D;Z=Math.sqrt(K*(K+2*D));const ee=Math.acos(Z/(D+K))-Math.acos(Oe.vec3.dot(R,Y));Z*=Math.cos(ee)}return 1.01*Z}(o,this.pixelsPerMeter(o.center.lat,o.worldSize)),u=Ss(o.zoom);if(u>0){const _=IM(o,Os(1,o.center.lat)*o.worldSize),p=o.worldSize/(2*Math.PI),y=Math.max(o.width,o.height)/o.worldSize*Math.PI;return Lt(l,_+p*(1-Math.cos(y)),Math.pow(u,10))}return l}upVector(o,l,u){return Zi(l,u,o,1)}upVectorScale(o){return{metersToTile:Si(Fo(ko(o)))}}}function e1(d){const o=d.parallels,l=!!o&&Math.abs(o[0]+o[1])<.01;switch(d.name){case"mercator":return new Jw(d);case"equirectangular":return new Kw(d);case"naturalEarth":return new Xk(d);case"equalEarth":return new YL(d);case"winkelTripel":return new Kk(d);case"albers":return l?new PM(d):new ev(d);case"lambertConformalConic":return l?new PM(d):new XL(d);case"globe":return new OM(d)}throw new Error(`Invalid projection name: ${d.name}`)}const Qk=Yd.VectorTileFeature.types,Jk=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tv(d,o,l,u,_,p,y,T,E,R,w,D,k){const S=T?Math.min(Af,Math.round(T[0])):0,I=T?Math.min(Af,Math.round(T[1])):0;d.emplaceBack(o,l,Math.round(32*u),Math.round(32*_),p,y,(S<<1)+(E?1:0),I,16*R,16*w,256*D,256*k)}function nm(d,o,l){d.emplaceBack(o,l)}function nv(d,o,l,u,_,p,y){d.emplaceBack(o,l,u,_,p,y)}function Kg(d,o,l,u,_){d.emplaceBack(o,l,u,_),d.emplaceBack(o,l,u,_),d.emplaceBack(o,l,u,_),d.emplaceBack(o,l,u,_)}function eA(d){for(const o of d.sections)if(RT(o.text))return!0;return!1}class ps{constructor(o){this.layoutVertexArray=new Di,this.indexArray=new es,this.programConfigurations=o,this.segments=new ni,this.dynamicLayoutVertexArray=new ed,this.opacityVertexArray=new Bi,this.placedSymbolArray=new kp,this.iconTransitioningVertexArray=new td,this.globeExtVertexArray=new Ii,this.zOffsetVertexArray=new Ha}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length&&0===this.iconTransitioningVertexArray.length}upload(o,l,u,_,p){this.isEmpty()||(u&&(this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,Lk.members),this.indexBuffer=o.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=o.createVertexBuffer(this.dynamicLayoutVertexArray,Hg.members,!0),this.opacityVertexBuffer=o.createVertexBuffer(this.opacityVertexArray,Jk,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=o.createVertexBuffer(this.iconTransitioningVertexArray,GL.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=o.createVertexBuffer(this.globeExtVertexArray,Nk.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||p)&&(this.zOffsetVertexBuffer=o.createVertexBuffer(this.zOffsetVertexArray,Vy.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||_)&&this.programConfigurations.upload(o))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Zt(ps,"SymbolBuffers");class iv{constructor(o,l,u){this.layoutVertexArray=new o,this.layoutAttributes=l,this.indexArray=new u,this.segments=new ni,this.collisionVertexArray=new Dp,this.collisionVertexArrayExt=new ed}upload(o){this.layoutVertexBuffer=o.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=o.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=o.createVertexBuffer(this.collisionVertexArray,uM.members,!0),this.collisionVertexBufferExt=o.createVertexBuffer(this.collisionVertexArrayExt,zk.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Zt(iv,"CollisionBuffers");class c0{constructor(o){this.collisionBoxArray=o.collisionBoxArray,this.zoom=o.zoom,this.lut=o.lut,this.overscaling=o.overscaling,this.layers=o.layers,this.layerIds=this.layers.map(y=>y.fqid),this.index=o.index,this.pixelRatio=o.pixelRatio,this.sourceLayerIndex=o.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Oe.mat4.identity([]),this.placementViewportMatrix=Oe.mat4.identity([]);const l=this.layers[0]._unevaluatedLayout._values;this.textSizeData=lh(this.zoom,l["text-size"]),this.iconSizeData=lh(this.zoom,l["icon-size"]);const u=this.layers[0].layout,_=u.get("symbol-sort-key"),p=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==p&&void 0!==_.constantOr(1),this.sortFeaturesByY=("viewport-y"===p||"auto"===p&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(y=>Mc[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=o.sourceID,this.projection=o.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new ps(new xc(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("text")||o.startsWith("symbol"))),this.icon=new ps(new xc(this.layers,{zoom:this.zoom,lut:this.lut},o=>o.startsWith("icon")||o.startsWith("symbol"))),this.glyphOffsetArray=new Zu,this.lineVertexArray=new oa,this.symbolInstances=new gf}calculateGlyphDependencies(o,l,u,_,p){for(const y of o){const T=y.codePointAt(0);if(void 0===T)break;if(l[T]=!0,_&&p&&T<=65535){const E=Ef[y];E&&(l[E.charCodeAt(0)]=!0)}}}updateFootprints(o,l){}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const u=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);return!YT(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(o,l,u,_){const p=this.layers[0],y=p.layout,T="globe"===this.projection.name,E=y.get("text-font"),R=y.get("text-field"),w=y.get("icon-image"),[D,k]=y.get("icon-size-scale-range"),S=En(l.scaleFactor||1,D,k),I=("constant"!==R.value.kind||R.value.value instanceof Xo&&!R.value.value.isEmpty()||R.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),O="constant"!==w.value.kind||!!w.value.value||Object.keys(w.parameters).length>0,B=y.get("symbol-sort-key");if(this.features=[],!I&&!O)return;const U=l.iconDependencies,q=l.glyphDependencies,Z=l.availableImages,$=new _r(this.zoom);for(const{feature:Y,id:K,index:ee,sourceLayerIndex:ue}of o){const de=p._featureFilter.needGeometry,ce=G(Y,de);if(!p._featureFilter.filter($,ce,u))continue;if(de||(ce.geometry=j(Y,u,_)),T&&1!==Y.type&&u.z<=5){const De=ce.geometry,Pe=.98078528056,Ne=(je,Le)=>{const it=Zi(je.x,je.y,u,1),_t=Zi(Le.x,Le.y,u,1);return Oe.vec3.dot(it,_t)<Pe};for(let je=0;je<De.length;je++)De[je]=F(De[je],Ne)}let we,fe;if(I){const De=p.getValueAndResolveTokens("text-field",ce,u,Z),Pe=Xo.factory(De);eA(Pe)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ay()||this.hasRTLText&&sr.isParsed())&&(we=WL(Pe,p,ce))}if(O){const De=p.getValueAndResolveTokens("icon-image",ce,u,Z);fe=De instanceof Ko?De:Ko.build(De)}if(!we&&!fe)continue;const Te=this.sortFeaturesByKey?B.evaluate(ce,{},u):void 0,ke={id:K,text:we,icon:fe,index:ee,sourceLayerIndex:ue,geometry:ce.geometry,properties:Y.properties,type:Qk[Y.type],sortKey:Te};if(this.features.push(ke),fe){const De=Uy(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],u,this.zoom,ke)*S*this.pixelRatio,Pe=fe.getPrimary().scaleSelf(De);if(U[Pe.id]=U[Pe.id]||[],U[Pe.id].push(Pe),fe.nameSecondary){const Ne=fe.getSecondary().scaleSelf(De);U[Ne.id]=U[Ne.id]||[],U[Ne.id].push(Ne)}}if(we){const De=E.evaluate(ce,{},u).join(","),Pe="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Mc.vertical)>=0;for(const Ne of we.sections)if(Ne.image){const je=Ne.image.getPrimary().scaleSelf(this.pixelRatio);U[je.id]=U[je.id]||[],U[je.id].push(je)}else{const je=ty(we.toString()),Le=Ne.fontStack||De,it=q[Le]=q[Le]||{};this.calculateGlyphDependencies(Ne.text,it,Pe,this.allowVerticalPlacement,je)}}}"line"===y.get("symbol-placement")&&(this.features=function(Y){const K={},ee={},ue=[];let de=0;function ce(ke){ue.push(Y[ke]),de++}function we(ke,De,Pe){const Ne=ee[ke];return delete ee[ke],ee[De]=Ne,ue[Ne].geometry[0].pop(),ue[Ne].geometry[0]=ue[Ne].geometry[0].concat(Pe[0]),Ne}function fe(ke,De,Pe){const Ne=K[De];return delete K[De],K[ke]=Ne,ue[Ne].geometry[0].shift(),ue[Ne].geometry[0]=Pe[0].concat(ue[Ne].geometry[0]),Ne}function Te(ke,De,Pe){const Ne=Pe?De[0][De[0].length-1]:De[0][0];return`${ke}:${Ne.x}:${Ne.y}`}for(let ke=0;ke<Y.length;ke++){const De=Y[ke],Pe=De.geometry,Ne=De.text?De.text.toString():null;if(!Ne){ce(ke);continue}const je=Te(Ne,Pe),Le=Te(Ne,Pe,!0);if(je in ee&&Le in K&&ee[je]!==K[Le]){const it=fe(je,Le,Pe),_t=we(je,Le,ue[it].geometry);delete K[je],delete ee[Le],ee[Te(Ne,ue[_t].geometry,!0)]=_t,ue[it].geometry=null}else je in ee?we(je,Le,Pe):Le in K?fe(je,Le,Pe):(ce(ke),K[je]=de-1,ee[Le]=de-1)}return ue.filter(ke=>ke.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Y,K)=>Y.sortKey-K.sortKey)}update(o,l,u,_,p,y,T){this.text.programConfigurations.updatePaintArrays(o,l,p,u,_,y,T),this.icon.programConfigurations.updatePaintArrays(o,l,p,u,_,y,T)}updateZOffset(){const o=(p,y,T)=>{u+=y,u>p.length&&p.resize(u);for(let E=-y;E<0;E++)p.emplace(E+u,T)},l=(p,y,T)=>{_+=y,_>p.length&&p.resize(_);for(let E=-y;E<0;E++)p.emplace(E+_,T)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,_=0;for(let p=0;p<this.symbolInstances.length;p++){const y=this.symbolInstances.get(p),{numHorizontalGlyphVertices:T,numVerticalGlyphVertices:E,numIconVertices:R}=y,w=y.zOffset,D=R>0;if((T>0||E>0)&&(o(this.text.zOffsetVertexArray,T,w),o(this.text.zOffsetVertexArray,E,w)),D){const{placedIconSymbolIndex:k,verticalPlacedIconSymbolIndex:S}=y;k>=0&&l(this.icon.zOffsetVertexArray,R,w),S>=0&&l(this.icon.zOffsetVertexArray,y.numVerticalIconVertices,w)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(o){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(o),this.iconCollisionBox.upload(o)),this.text.upload(o,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(o,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=e1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(o,l){const u=this.lineVertexArray.length;if(void 0!==o.segment)for(const{x:_,y:p}of l)this.lineVertexArray.emplaceBack(_,p);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(o,l,u,_,p,y,T,E,R,w,D,k,S,I,O,B){const U=o.indexArray,q=o.layoutVertexArray,Z=o.globeExtVertexArray,$=o.segments.prepareSegment(4*l.length,q,U,this.canOverlap?y.sortKey:void 0),Y=this.glyphOffsetArray.length,K=$.vertexLength,ee=this.allowVerticalPlacement&&T===Mc.vertical?Math.PI/2:0,ue=y.text&&y.text.sections;for(let ce=0;ce<l.length;ce++){const{tl:we,tr:fe,bl:Te,br:ke,texPrimary:De,texSecondary:Pe,pixelOffsetTL:Ne,pixelOffsetBR:je,minFontScaleX:Le,minFontScaleY:it,glyphOffset:_t,isSDF:rt,sectionIndex:Et}=l[ce],St=$.vertexLength,zt=_t[1];if(tv(q,R.x,R.y,we.x,zt+we.y,De.x,De.y,u,rt,Ne.x,Ne.y,Le,it),tv(q,R.x,R.y,fe.x,zt+fe.y,De.x+De.w,De.y,u,rt,je.x,Ne.y,Le,it),tv(q,R.x,R.y,Te.x,zt+Te.y,De.x,De.y+De.h,u,rt,Ne.x,je.y,Le,it),tv(q,R.x,R.y,ke.x,zt+ke.y,De.x+De.w,De.y+De.h,u,rt,je.x,je.y,Le,it),E){const{x:lt,y:en,z:It}=E.anchor,[Xt,dn,On]=E.up;nv(Z,lt,en,It,Xt,dn,On),nv(Z,lt,en,It,Xt,dn,On),nv(Z,lt,en,It,Xt,dn,On),nv(Z,lt,en,It,Xt,dn,On),Kg(o.dynamicLayoutVertexArray,lt,en,It,ee)}else Kg(o.dynamicLayoutVertexArray,R.x,R.y,R.z,ee);if(B){const lt=Pe||De;nm(o.iconTransitioningVertexArray,lt.x,lt.y),nm(o.iconTransitioningVertexArray,lt.x+lt.w,lt.y),nm(o.iconTransitioningVertexArray,lt.x,lt.y+lt.h),nm(o.iconTransitioningVertexArray,lt.x+lt.w,lt.y+lt.h)}U.emplaceBack(St,St+1,St+2),U.emplaceBack(St+1,St+2,St+3),$.vertexLength+=4,$.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_t[0]),ce!==l.length-1&&Et===l[ce+1].sectionIndex||o.programConfigurations.populatePaintArrays(q.length,y,y.index,{},S,I,O,ue&&ue[Et])}const de=E?E.anchor:R;o.placedSymbolArray.emplaceBack(de.x,de.y,de.z,R.x,R.y,Y,this.glyphOffsetArray.length-Y,K,w,D,R.segment,u?u[0]:0,u?u[1]:0,_[0],_[1],T,0,!1,0,k,0)}_commitLayoutVertex(o,l,u,_,p,y,T){o.emplaceBack(l,u,_,p,y,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(o,l,u,_,p,y,T){const E=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),R=E.vertexLength,w=T.tileAnchorX,D=T.tileAnchorY;for(let S=0;S<4;S++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,l,o.padding,T.zOffset),this._commitLayoutVertex(u.layoutVertexArray,_,p,y,w,D,new Ft(o.x1,o.y1)),this._commitLayoutVertex(u.layoutVertexArray,_,p,y,w,D,new Ft(o.x2,o.y1)),this._commitLayoutVertex(u.layoutVertexArray,_,p,y,w,D,new Ft(o.x2,o.y2)),this._commitLayoutVertex(u.layoutVertexArray,_,p,y,w,D,new Ft(o.x1,o.y2)),E.vertexLength+=4;const k=u.indexArray;k.emplaceBack(R,R+1),k.emplaceBack(R+1,R+2),k.emplaceBack(R+2,R+3),k.emplaceBack(R+3,R),E.primitiveLength+=4}_addTextDebugCollisionBoxes(o,l,u,_,p,y){for(let T=_;T<p;T++){const E=u.get(T),R=this.getSymbolInstanceTextSize(o,y,l,T);this._addCollisionDebugVertices(E,R,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(o,l,u,_,p,y){for(let T=_;T<p;T++){const E=u.get(T),R=this.getSymbolInstanceIconSize(o,l,y.placedIconSymbolIndex);this._addCollisionDebugVertices(E,R,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}generateCollisionDebugBuffers(o,l,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new iv(ia,Vw.members,td),this.iconCollisionBox=new iv(ia,Vw.members,td);const _=jy(this.iconSizeData,o),p=jy(this.textSizeData,o,u);for(let y=0;y<this.symbolInstances.length;y++){const T=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(p,o,l,T.textBoxStartIndex,T.textBoxEndIndex,T),this._addTextDebugCollisionBoxes(p,o,l,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T),this._addIconDebugCollisionBoxes(_,o,l,T.iconBoxStartIndex,T.iconBoxEndIndex,T),this._addIconDebugCollisionBoxes(_,o,l,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T)}}getSymbolInstanceTextSize(o,l,u,_){const p=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:_),y=Jb(this.textSizeData,o,p)/24;return this.tilePixelRatio*y}getSymbolInstanceIconSize(o,l,u){const _=this.icon.placedSymbolArray.get(u),p=Jb(this.iconSizeData,o,_);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(o,l,u,_){o.emplaceBack(l,-u,-u,_),o.emplaceBack(l,u,-u,_),o.emplaceBack(l,u,u,_),o.emplaceBack(l,-u,u,_)}_updateTextDebugCollisionBoxes(o,l,u,_,p,y,T){for(let E=_;E<p;E++){const R=u.get(E),w=this.getSymbolInstanceTextSize(o,y,l,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,w,R.padding,y.zOffset)}}_updateIconDebugCollisionBoxes(o,l,u,_,p,y,T){for(let E=_;E<p;E++){const R=u.get(E),w=this.getSymbolInstanceIconSize(o,l,y.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,w,R.padding,y.zOffset)}}updateCollisionDebugBuffers(o,l,u,_){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=jy(this.iconSizeData,o,_),y=jy(this.textSizeData,o,u);for(let T=0;T<this.symbolInstances.length;T++){const E=this.symbolInstances.get(T);this._updateTextDebugCollisionBoxes(y,o,l,E.textBoxStartIndex,E.textBoxEndIndex,E,u),this._updateTextDebugCollisionBoxes(y,o,l,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E,u),this._updateIconDebugCollisionBoxes(p,o,l,E.iconBoxStartIndex,E.iconBoxEndIndex,E,_),this._updateIconDebugCollisionBoxes(p,o,l,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E,_)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(o,l,u,_,p,y,T,E,R){const w={};if(l<u){const{x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$,featureIndex:Y}=o.get(l);w.textBox={x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$},w.textFeatureIndex=Y}if(_<p){const{x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$,featureIndex:Y}=o.get(_);w.verticalTextBox={x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$},w.verticalTextFeatureIndex=Y}if(y<T){const{x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$,featureIndex:Y}=o.get(y);w.iconBox={x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$},w.iconFeatureIndex=Y}if(E<R){const{x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$,featureIndex:Y}=o.get(E);w.verticalIconBox={x1:D,y1:k,x2:S,y2:I,padding:O,projectedAnchorX:B,projectedAnchorY:U,projectedAnchorZ:q,tileAnchorX:Z,tileAnchorY:$},w.verticalIconFeatureIndex=Y}return w}deserializeCollisionBoxes(o){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const u=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(o,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(o,l){const u=o.placedSymbolArray.get(l),_=u.vertexStartIndex+4*u.numGlyphs;for(let p=u.vertexStartIndex;p<_;p+=4)o.indexArray.emplaceBack(p,p+1,p+2),o.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(o){if(this.sortedAngle===o&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const l=Math.sin(o),u=Math.cos(o),_=[],p=[],y=[];for(let T=0;T<this.symbolInstances.length;++T){y.push(T);const E=this.symbolInstances.get(T);_.push(0|Math.round(l*E.tileAnchorX+u*E.tileAnchorY)),p.push(E.featureIndex)}return y.sort((T,E)=>_[T]-_[E]||p[E]-p[T]),y}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let o=0;o<this.symbolInstances.length;++o)this.symbolInstanceIndexesSortedZOffset.push(o)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((o,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(o).zOffset)}addToSortKeyRanges(o,l){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===l?u.symbolInstanceEnd=o+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:o,symbolInstanceEnd:o+1})}sortFeatures(o){if(this.sortFeaturesByY&&this.sortedAngle!==o&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(o),this.sortedAngle=o,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const u=this.symbolInstances.get(l);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:_,centerJustifiedTextSymbolIndex:p,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:R}=u;_>=0&&this.addIndicesForPlacedSymbol(this.text,_),p>=0&&p!==_&&this.addIndicesForPlacedSymbol(this.text,p),y>=0&&y!==p&&y!==_&&this.addIndicesForPlacedSymbol(this.text,y),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let eu,t1,n1;Zt(c0,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),c0.addDynamicAttributes=Kg;class FM{constructor(o){this.type=o.property.overrides?o.property.overrides.runtimeType:Nt,this.defaultValue=o}evaluate(o){if(o.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(o.formattedSection))return l.getOverride(o.formattedSection)}return o.feature&&o.featureState?this.defaultValue.evaluate(o.feature,o.featureState):this.defaultValue.property.specification.default}eachChild(o){this.defaultValue.isConstant()||o(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Zt(FM,"FormatSectionOverride",{omit:["defaultValue"]});const d0=()=>n1||(n1={layout:eu||(eu=new Pr({"symbol-placement":new wt(Ge.layout_symbol["symbol-placement"]),"symbol-spacing":new wt(Ge.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new wt(Ge.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new jt(Ge.layout_symbol["symbol-sort-key"]),"symbol-z-order":new wt(Ge.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new wt(Ge.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new wt(Ge.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new wt(Ge.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new wt(Ge.layout_symbol["icon-ignore-placement"]),"icon-optional":new wt(Ge.layout_symbol["icon-optional"]),"icon-rotation-alignment":new wt(Ge.layout_symbol["icon-rotation-alignment"]),"icon-size":new jt(Ge.layout_symbol["icon-size"]),"icon-size-scale-range":new wt(Ge.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new jt(Ge.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new jt(Ge.layout_symbol["icon-text-fit-padding"]),"icon-image":new jt(Ge.layout_symbol["icon-image"]),"icon-rotate":new jt(Ge.layout_symbol["icon-rotate"]),"icon-padding":new wt(Ge.layout_symbol["icon-padding"]),"icon-keep-upright":new wt(Ge.layout_symbol["icon-keep-upright"]),"icon-offset":new jt(Ge.layout_symbol["icon-offset"]),"icon-anchor":new jt(Ge.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new wt(Ge.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new wt(Ge.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new wt(Ge.layout_symbol["text-rotation-alignment"]),"text-field":new jt(Ge.layout_symbol["text-field"]),"text-font":new jt(Ge.layout_symbol["text-font"]),"text-size":new jt(Ge.layout_symbol["text-size"]),"text-size-scale-range":new wt(Ge.layout_symbol["text-size-scale-range"]),"text-max-width":new jt(Ge.layout_symbol["text-max-width"]),"text-line-height":new jt(Ge.layout_symbol["text-line-height"]),"text-letter-spacing":new jt(Ge.layout_symbol["text-letter-spacing"]),"text-justify":new jt(Ge.layout_symbol["text-justify"]),"text-radial-offset":new jt(Ge.layout_symbol["text-radial-offset"]),"text-variable-anchor":new wt(Ge.layout_symbol["text-variable-anchor"]),"text-anchor":new jt(Ge.layout_symbol["text-anchor"]),"text-max-angle":new wt(Ge.layout_symbol["text-max-angle"]),"text-writing-mode":new wt(Ge.layout_symbol["text-writing-mode"]),"text-rotate":new jt(Ge.layout_symbol["text-rotate"]),"text-padding":new wt(Ge.layout_symbol["text-padding"]),"text-keep-upright":new wt(Ge.layout_symbol["text-keep-upright"]),"text-transform":new jt(Ge.layout_symbol["text-transform"]),"text-offset":new jt(Ge.layout_symbol["text-offset"]),"text-allow-overlap":new wt(Ge.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new wt(Ge.layout_symbol["text-ignore-placement"]),"text-optional":new wt(Ge.layout_symbol["text-optional"]),visibility:new wt(Ge.layout_symbol.visibility)})),paint:t1||(t1=new Pr({"icon-opacity":new jt(Ge.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new jt(Ge.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new jt(Ge.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new jt(Ge.paint_symbol["text-emissive-strength"]),"icon-color":new jt(Ge.paint_symbol["icon-color"]),"icon-halo-color":new jt(Ge.paint_symbol["icon-halo-color"]),"icon-halo-width":new jt(Ge.paint_symbol["icon-halo-width"]),"icon-halo-blur":new jt(Ge.paint_symbol["icon-halo-blur"]),"icon-translate":new wt(Ge.paint_symbol["icon-translate"]),"icon-translate-anchor":new wt(Ge.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new jt(Ge.paint_symbol["icon-image-cross-fade"]),"text-opacity":new jt(Ge.paint_symbol["text-opacity"]),"text-occlusion-opacity":new jt(Ge.paint_symbol["text-occlusion-opacity"]),"text-color":new jt(Ge.paint_symbol["text-color"],{runtimeType:ya,getOverride:d=>d.textColor,hasOverride:d=>!!d.textColor}),"text-halo-color":new jt(Ge.paint_symbol["text-halo-color"]),"text-halo-width":new jt(Ge.paint_symbol["text-halo-width"]),"text-halo-blur":new jt(Ge.paint_symbol["text-halo-blur"]),"text-translate":new wt(Ge.paint_symbol["text-translate"]),"text-translate-anchor":new wt(Ge.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new wt(Ge.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new wt(Ge.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new wt(Ge.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new wt(Ge.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new jt(Ge.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},n1);class u0 extends ds{constructor(o,l,u,_){super(o,d0(),l,u,_),this._colorAdjustmentMatrix=Oe.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=void 0!==o.paint&&("icon-occlusion-opacity"in o.paint||"text-occlusion-opacity"in o.paint)}recalculate(o,l){super.recalculate(o,l),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const _=[];for(const p of u)_.indexOf(p)<0&&_.push(p);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(o,l,u,_){return this._saturation===o&&this._contrast===l&&this._brightnessMin===u&&this._brightnessMax===_||(this._colorAdjustmentMatrix=function(p,y,T,E){p=ae(p),y=ie(y);const R=Oe.mat4.create(),w=p/3,D=1-2*w,k=[D,w,w,0,w,D,w,0,w,w,D,0,0,0,0,1],S=.5-.5*y,I=E-T;return Oe.mat4.multiply(R,[I,0,0,0,0,I,0,0,0,0,I,0,T,T,T,1],[y,0,0,0,0,y,0,0,0,0,y,0,S,S,S,1]),Oe.mat4.multiply(R,R,k),R}(o,l,u,_),this._saturation=o,this._contrast=l,this._brightnessMin=u,this._brightnessMax=_),this._colorAdjustmentMatrix}getValueAndResolveTokens(o,l,u,_){const p=this.layout.get(o).evaluate(l,{},u,_),y=this._unevaluatedLayout._values[o];return y.isDataDriven()||cf(y.value)||!p?p:(T=l.properties,p.replace(/{([^{}]+)}/g,(R,w)=>w in T?String(T[w]):""));var T}createBucket(o){return new c0(o)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const o of d0().paint.overridableProperties){if(!u0.hasPaintOverride(this.layout,o))continue;const l=this.paint.get(o),u=new FM(l),_=new ja(u,l.property.specification,this.scope,this.options);let p=null;p="constant"===l.value.kind||"source"===l.value.kind?new io("source",_):new Kc("composite",_,l.value.zoomStops,l.value._interpolationType),this.paint._values[o]=new ff(l.property,p,l.parameters)}}_handleOverridablePaintPropertyUpdate(o,l,u){return!(!this.layout||l.isDataDriven()||u.isDataDriven())&&u0.hasPaintOverride(this.layout,o)}static hasPaintOverride(o,l){const u=o.get("text-field"),_=d0().paint.properties[l];let p=!1;const y=T=>{for(const E of T)if(_.overrides&&_.overrides.hasOverride(E))return void(p=!0)};if("constant"===u.value.kind&&u.value.value instanceof Xo)y(u.value.value.sections);else if("source"===u.value.kind){const T=R=>{p||(R instanceof va&&gr(R.value)===al?y(R.value.sections):R instanceof Na?y(R.sections):R.eachChild(T))},E=u.value;E._styleExpression&&T(E._styleExpression.expression)}return p}getProgramIds(){return["symbol"]}getDefaultProgramParams(o,l,u){return{config:new xf(this,{zoom:l,lut:u}),overrideFog:!1}}}let i1,tA,nA,Qg;var r1=Ri([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function o1(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function s1(d){switch(d){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class h0{constructor(o,l,u,_){this.context=o,this.format=u,this.useMipmap=_&&_.useMipmap,this.texture=o.gl.createTexture(),this.update(l,{premultiply:_&&_.premultiply})}update(o,l){const u=o&&o instanceof HTMLVideoElement&&0===o.width?o.videoWidth:o.width,_=o&&o instanceof HTMLVideoElement&&0===o.height?o.videoHeight:o.height,{context:p}=this,{gl:y}=p,{x:T,y:E}=l&&l.position?l.position:{x:0,y:0},R=Math.max(T+u,this.size?this.size[0]:0),w=Math.max(E+_,this.size?this.size[1]:0);!this.size||this.size[0]===R&&this.size[1]===w||(y.bindTexture(y.TEXTURE_2D,null),y.deleteTexture(this.texture),this.texture=y.createTexture(),this.size=null),y.bindTexture(y.TEXTURE_2D,this.texture),p.pixelStoreUnpackFlipY.set(!1),p.pixelStoreUnpack.set(1),p.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA8&&(!l||!1!==l.premultiply));const D=o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement||o instanceof ImageData||ImageBitmap&&o instanceof ImageBitmap;if(!this.size&&R>0&&w>0){const k=this.useMipmap?Math.floor(Math.log2(Math.max(R,w)))+1:1;y.texStorage2D(y.TEXTURE_2D,k,this.format,R,w),this.size=[R,w]}if(this.size)if(D)y.texSubImage2D(y.TEXTURE_2D,0,T,E,o1(this.format),s1(this.format),o);else{const k=o.data;k&&y.texSubImage2D(y.TEXTURE_2D,0,T,E,u,_,o1(this.format),s1(this.format),k)}this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(o,l,u=!1){const{context:_}=this,{gl:p}=_;p.bindTexture(p.TEXTURE_2D,this.texture),o!==this.minFilter&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MAG_FILTER,o),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_MIN_FILTER,this.useMipmap&&!u?o===p.NEAREST?p.NEAREST_MIPMAP_NEAREST:p.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),l!==this.wrapS&&(p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_S,l),p.texParameteri(p.TEXTURE_2D,p.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(o,l,u,_){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),l!==this.magFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,l),this.magFilter=l),o!==this.minFilter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,this.useMipmap?o===y.NEAREST?y.NEAREST_MIPMAP_NEAREST:y.LINEAR_MIPMAP_LINEAR:o),this.minFilter=o),u!==this.wrapS&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,u),this.wrapS=u),_!==this.wrapT&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,_),this.wrapT=_)}destroy(){const{gl:o}=this.context;o.deleteTexture(this.texture),this.texture=null}}class f0{constructor(o,l){this.context=o,this.texture=l}bind(o,l){const{context:u}=this,{gl:_}=u;_.bindTexture(_.TEXTURE_2D,this.texture),o!==this.minFilter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,o),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,o),this.minFilter=o),l!==this.wrapS&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,l),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,l),this.wrapS=l)}}function p0(d,o,l,u,_,p,y,T){const E=[d,o,1,l,u,1,_,p,1],R=[y,T,1],w=Oe.mat3.adjoint([],E),[D,k,S]=Oe.vec3.transformMat3(R,R,w);return Oe.mat3.multiply(E,E,[D,0,0,0,k,0,0,0,S])}function LM(d,o,l,u,_,p,y,T){const E=function(R,w,D,k,S,I,O,B){const U=p0(0,0,1,0,1,1,0,1),q=p0(R,w,D,k,S,I,O,B),Z=Oe.mat3.adjoint([],U);return Oe.mat3.multiply(q,q,Z)}(d,o,l,u,_,p,y,T);return[E[2]/E[8]/Ot,E[5]/E[8]/Ot]}function m0(d){return[d[0],Math.min(Math.max(d[1],-eo),eo)]}class NM extends up{constructor(o,l,u,_){super(),this.id=o,this.dispatcher=u,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(_),this.options=l,this._dirty=!1}load(o,l){if(this._loaded=l||!1,this.fire(new Ks("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return o&&(this.coordinates=o),this._loaded=!0,void this._finishLoading();this._imageRequest=V_(this.map._requestManager.transformRequest(this.url,ol.Image),(u,_)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new Mu(u)):_&&(this.image=_ instanceof HTMLImageElement?Tt.getImageData(_):_,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading())})}loaded(){return this._loaded}updateImage(o){return o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}setTexture(o){if(!(o.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new f0(this.map.painter.context,o.handle),this.width=o.dimensions[0],this.height=o.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ks("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(o){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof f0||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(o){if(this.coordinates=o,this._boundsArray=void 0,this._unsupportedCoords=!1,!o.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=o[0][1],u=o[0][1];for(const p of o)p[1]>u&&(u=p[1]),p[1]<l&&(l=p[1]);const _=(u+l)/2;if(_>eo?this.onNorthPole=!0:_<-eo&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const p=o.map(b.fromLngLat);this.tileID=function(y){let T=1/0,E=1/0,R=-1/0,w=-1/0;for(const O of y)T=Math.min(T,O.x),E=Math.min(E,O.y),R=Math.max(R,O.x),w=Math.max(w,O.y);const D=Math.max(R-T,w-E),k=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),S=Math.pow(2,k);let I=Math.floor((T+R)/2*S);return I>1&&(I-=1),new Pt(k,I,Math.floor((E+w)/2*S))}(p),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Ks("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(o){for(const U in this.tiles){const q=this.tiles[U];"loaded"!==q.state&&(q.state="loaded",q.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=Jy(new Pt(0,0,0),this.map.transform.projection),u=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(U){const q=U[1].x-U[0].x,Z=U[1].y-U[0].y,$=U[2].x-U[1].x,Y=U[2].y-U[1].y,K=U[3].x-U[2].x,ee=U[3].y-U[2].y,ue=U[0].x-U[3].x,de=U[0].y-U[3].y,ce=q*Y-$*Z,we=$*ee-K*Y,fe=K*de-ue*ee,Te=ue*Z-q*de;return ce>0&&we>0&&fe>0&&Te>0||ce<0&&we<0&&fe<0&&Te<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const _=Jy(this.tileID,this.map.transform.projection),[p,y,T,E]=this.coordinates.map(U=>{const q=_.projection.project(U[0],U[1]);return kM(_,q)._round()});this.perspectiveTransform=LM(p.x,p.y,y.x,y.y,T.x,T.y,E.x,E.y);const R=this._boundsArray=new fl;R.emplaceBack(p.x,p.y,0,0),R.emplaceBack(y.x,y.y,Ot,0),R.emplaceBack(E.x,E.y,0,Ot),R.emplaceBack(T.x,T.y,Ot,Ot),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=o.createVertexBuffer(R,r1.members),this.boundsSegments=ni.simpleSegment(0,0,4,2);const w=[],D=[m0((k=this.coordinates)[0]),m0(k[1]),m0(k[2]),m0(k[3])];var k;const[S,I,O,B]=function(U){let q=U[0][0],Z=q,$=U[0][1],Y=$;for(let K=1;K<U.length;K++)U[K][0]<q?q=U[K][0]:U[K][0]>Z&&(Z=U[K][0]),U[K][1]<$?$=U[K][1]:U[K][1]>Y&&(Y=U[K][1]);return[q,$,Z-q,Y-$]}(D);{const U=new fl,[q,Z,$,Y]=function(Ne){let je=Ne[0].x,Le=je,it=Ne[0].y,_t=it;for(let rt=1;rt<Ne.length;rt++)Ne[rt].x<je?je=Ne[rt].x:Ne[rt].x>Le&&(Le=Ne[rt].x),Ne[rt].y<it?it=Ne[rt].y:Ne[rt].y>_t&&(_t=Ne[rt].y);return[je,it,Le-je,_t-it]}(u),K=Ne=>[(Ne.x-q)/$,(Ne.y-Z)/Y],[ee,ue,de,ce]=u.map(K),we=function(Ne,je,Le,it,_t,rt,Et,St){const zt=p0(0,0,1,0,1,1,0,1),lt=p0(Ne,je,Le,it,_t,rt,Et,St),en=Oe.mat3.adjoint([],lt);return Oe.mat3.multiply(zt,zt,en)}(ee[0],ee[1],ue[0],ue[1],de[0],de[1],ce[0],ce[1]);this.elevatedGlobePerspectiveTransform=LM(ee[0],ee[1],ue[0],ue[1],de[0],de[1],ce[0],ce[1]);const fe=(Ne,je)=>{w.push(Ne.lng);const Le=Math.round((Ne.lng-S)/O*Ot),it=Math.round((Ne.lat-I)/B*Ot),_t=K(je),rt=Oe.vec3.transformMat3([],[_t[0],_t[1],1],we),Et=Math.round(rt[0]/rt[2]*Ot),St=Math.round(rt[1]/rt[2]*Ot);U.emplaceBack(Le,it,Et,St)},Te=u[3].x-u[0].x,ke=u[3].y-u[0].y,De=u[2].x-u[1].x,Pe=u[2].y-u[1].y;for(let Ne=0;Ne<65;Ne++){const je=Ne/64,Le=[u[0].x+je*Te,u[0].y+je*ke],it=[u[1].x+je*De,u[1].y+je*Pe],_t=it[0]-Le[0],rt=it[1]-Le[1];for(let Et=0;Et<65;Et++){const St=Et/64,zt={x:Le[0]+_t*St,y:Le[1]+rt*St,z:0};fe(l.projection.unproject(zt.x,zt.y),zt)}}this.elevatedGlobeVertexBuffer=o.createVertexBuffer(U,r1.members)}{this.maxLongitudeTriangleSize=0;let U=[],q=new es;const Z=($,Y,K)=>{q.emplaceBack($,Y,K);const ee=w[$],ue=w[Y],de=w[K],ce=Math.min(Math.min(ee,ue),de),we=Math.max(Math.max(ee,ue),de)-ce;we>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=we),U.push(ce+we/2)};for(let $=0;$<64;$++)for(let Y=0;Y<64;Y++){const K=65*$+Y,ee=K+1,ue=K+65,de=ue+1;Z(K,ue,ee),Z(ee,ue,de)}[U,q]=function($,Y){const K=Array.from({length:$.length},(de,ce)=>ce);K.sort((de,ce)=>$[de]-$[ce]);const ee=[],ue=new es;for(let de=0;de<K.length;de++){const ce=K[de];ee.push($[ce]);const we=3*ce,fe=we+1;ue.emplaceBack(Y.uint16[we],Y.uint16[fe],Y.uint16[fe+1])}return[ee,ue]}(U,q),this.elevatedGlobeTrianglesCenterLongitudes=U,this.elevatedGlobeIndexBuffer=o.createIndexBuffer(q)}this.elevatedGlobeSegments=ni.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,O/Ot,0,B/Ot,0,0,I,S,0])}prepare(){const o=0!==Object.keys(this.tiles).length;if(this.tileID&&!o)return;const l=this.map.painter.context,u=l.gl;!this._dirty||this.texture instanceof f0||(this.texture?this.texture.update(this.image):(this.texture=new h0(l,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),o&&this._prepareData(l)}loadTile(o,l){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},l(null)):(o.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(o){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let _=(p=o+180)+360*Math.round((u[0]-p)/360);var p;const y=new ni,T=(D,k)=>{y.segments.push({vertexOffset:0,primitiveOffset:D,vertexLength:l.segments[0].vertexLength,primitiveLength:k,sortKey:void 0,vaos:{}})},E=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-_)<=E){const D=tt(u,0,u.length,_+E);return D===u.length||T(D,dp(u,D+1,u.length,_+360-E)-D),y}_<u[0]&&(_+=360);const R=dp(u,0,u.length,_-E);if(R===u.length)return T(0,u.length),y;T(0,R-0);const w=tt(u,R+1,u.length,_+E);return w!==u.length&&T(w,u.length-w),y}}const iA=(Math.pow(256,2)-1)/16907520;class g0 extends ds{constructor(o,l,u,_){super(o,{layout:nA||(nA=new Pr({visibility:new wt(Ge.layout_raster.visibility)})),paint:Qg||(Qg=new Pr({"raster-opacity":new wt(Ge.paint_raster["raster-opacity"]),"raster-color":new Ki(Ge.paint_raster["raster-color"]),"raster-color-mix":new wt(Ge.paint_raster["raster-color-mix"]),"raster-color-range":new wt(Ge.paint_raster["raster-color-range"]),"raster-hue-rotate":new wt(Ge.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new wt(Ge.paint_raster["raster-brightness-min"]),"raster-brightness-max":new wt(Ge.paint_raster["raster-brightness-max"]),"raster-saturation":new wt(Ge.paint_raster["raster-saturation"]),"raster-contrast":new wt(Ge.paint_raster["raster-contrast"]),"raster-resampling":new wt(Ge.paint_raster["raster-resampling"]),"raster-fade-duration":new wt(Ge.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new wt(Ge.paint_raster["raster-emissive-strength"]),"raster-array-band":new wt(Ge.paint_raster["raster-array-band"]),"raster-elevation":new wt(Ge.paint_raster["raster-elevation"]),"raster-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},l,u,_),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(o){return!(o&&o._source instanceof NM&&(o._source.onNorthPole||o._source.onSouthPole))&&0===this.paint.get("raster-elevation")}_handleSpecialPaintPropertyUpdate(o){"raster-color"!==o&&"raster-color-range"!==o||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(o){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[u,_]=o||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(_)||u===this._curRampRange[0]&&_===this._curRampRange[1]||(this.colorRamp=kg({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:_}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,_])}}let rA,oA,_0,sA,aA;class lA extends ds{constructor(o,l,u,_){super(o,{layout:rA||(rA=new Pr({visibility:new wt(Ge["layout_raster-particle"].visibility)})),paint:oA||(oA=new Pr({"raster-particle-array-band":new wt(Ge["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new wt(Ge["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Ki(Ge["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new wt(Ge["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new wt(Ge["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new wt(Ge["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new wt(Ge["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new wt(Ge["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},l,u,_),this._updateColorRamp(),this.lastInvalidatedAt=Tt.now()}onRemove(o){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return"none"!==this.visibility}isDraped(o){return!1}_handleSpecialPaintPropertyUpdate(o){"raster-particle-color"!==o&&"raster-particle-max-speed"!==o||(this._updateColorRamp(),this._invalidateAnimationState()),"raster-particle-count"===o&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const o=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=kg({expression:o,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Tt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class KL extends ds{constructor(o,l){super(o,{},l,null),this.implementation=o,o.slot&&(this.slot=o.slot)}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isDraped(o){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(o){this.implementation.onAdd&&this.implementation.onAdd(o,o.painter.context.gl)}onRemove(o){this.implementation.onRemove&&this.implementation.onRemove(o,o.painter.context.gl)}}function zM(d,o,l){const u=[0,0,1],_=Oe.quat.identity([]);return Oe.quat.rotateY(_,_,l?-vi(d)+Math.PI:vi(d)),Oe.quat.rotateX(_,_,-vi(o)),Oe.vec3.transformQuat(u,u,_),Oe.vec3.normalize(u,u)}function BM(d,o){const l=im(d.projection,d.zoom,d.width,d.height),u=function(p,y,T,E,R){const w=new ii(T.lng-180*ch,T.lat),D=new ii(T.lng+180*ch,T.lat),k=p.project(w.lng,w.lat),S=p.project(D.lng,D.lat),I=-Math.atan2(S.y-k.y,S.x-k.x),O=b.fromLngLat(T);O.y=En(O.y,-1+ch,1-ch);const B=O.toLngLat(),U=p.project(B.lng,B.lat),q=b.fromLngLat(B);q.x+=ch;const Z=q.toLngLat(),$=p.project(Z.lng,Z.lat),Y=a1($.x-U.x,$.y-U.y,I),K=b.fromLngLat(B);K.y+=ch;const ee=K.toLngLat(),ue=p.project(ee.lng,ee.lat),de=a1(ue.x-U.x,ue.y-U.y,I),ce=Math.abs(Y.x)/Math.abs(de.y),we=Oe.mat4.identity([]);Oe.mat4.rotateZ(we,we,-I*(1-(R?0:E)));const fe=Oe.mat4.identity([]);return Oe.mat4.scale(fe,fe,[1,1-(1-ce)*E,1]),fe[4]=-de.x/de.y*E,Oe.mat4.rotateZ(fe,fe,I),Oe.mat4.multiply(fe,we,fe),fe}(d.projection,0,d.center,l,o),_=rv(d);return Oe.mat4.scale(u,u,[_,_,1]),u}function rv(d){const o=d.projection,l=im(d.projection,d.zoom,d.width,d.height),u=y0(o,d.center),_=y0(o,ii.convert(o.center));return Math.pow(2,u*l+(1-l)*_)}function im(d,o,l,u,_=1/0){const p=d.range;if(!p)return 0;const y=Math.min(_,Math.max(l,u)),T=Math.log(y/1024)/Math.LN2;return wu(p[0]+T,p[1]+T,o)}const ch=1/4e4;function y0(d,o){const l=En(o.lat,-eo,eo),u=new ii(o.lng-180*ch,l),_=new ii(o.lng+180*ch,l),p=d.project(u.lng,l),y=d.project(_.lng,l),T=b.fromLngLat(u),E=b.fromLngLat(_),R=y.x-p.x,w=y.y-p.y,D=E.x-T.x,k=E.y-T.y,S=Math.sqrt((D*D+k*k)/(R*R+w*w));return Math.log(S)/Math.LN2}function a1(d,o,l){const u=Math.cos(l),_=Math.sin(l);return{x:d*u-o*_,y:d*_+o*u}}function v0(d,o,l){Oe.mat4.identity(d),Oe.mat4.rotateZ(d,d,vi(o[2])),Oe.mat4.rotateX(d,d,vi(o[0])),Oe.mat4.rotateY(d,d,vi(o[1])),Oe.mat4.scale(d,d,l),Oe.mat4.multiply(d,d,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function b0(d,o,l,u,_,p,y,T){const E=[l[0]-o[0],l[1]-o[1],0],R=[u[0]-o[0],u[1]-o[1],0];if(Oe.vec3.length(E)<1e-12||Oe.vec3.length(R)<1e-12)return Oe.quat.identity(d);const w=Oe.vec3.cross([],E,R);Oe.vec3.normalize(w,w),Oe.vec3.subtract(R,u,o),E[2]=(p-_)*T,R[2]=(y-_)*T;const D=E;return Oe.vec3.cross(D,E,R),Oe.vec3.normalize(D,D),Oe.quat.rotationTo(d,w,D)}function x0(d,o,l=!1){const u=Ss(o.zoom),_=function(p,y,T){const E=y.worldSize,R=[p[12],p[13],p[14]],w=Zo(R[1]/E),D=aa(R[0]/E),k=Oe.mat4.identity([]),S=Os(1,w)*E,I=Os(1,0)*E*s(w,y.zoom),O=1/Ls(E);let B=I*O;if(T){const $=im(y.projection,y.zoom,y.width,y.height,1024);B=O*y.projection.pixelSpaceConversion(y.center.lat,E,$)}const U=qd(w,D);Oe.vec3.add(U,U,Oe.vec3.scale([],Oe.vec3.normalize([],U),S*B*R[2]));const q=function($){const Y=[$[0],$[1],$[2]];let K=[0,1,0];const ee=Oe.vec3.cross([],K,Y);return Oe.vec3.cross(K,Y,ee),0===Oe.vec3.squaredLength(K)&&(K=[0,1,0],Oe.vec3.cross(ee,Y,K)),Oe.vec3.normalize(ee,ee),Oe.vec3.normalize(K,K),Oe.vec3.normalize(Y,Y),[ee[0],ee[1],ee[2],0,K[0],K[1],K[2],0,Y[0],Y[1],Y[2],0,$[0],$[1],$[2],1]}(U);Oe.mat4.scale(k,k,[B,B,B*S]),Oe.mat4.translate(k,k,[-R[0],-R[1],-R[2]]);const Z=Oe.mat4.multiply([],y.globeMatrix,q);return Oe.mat4.multiply(Z,Z,k),Oe.mat4.multiply(Z,Z,p),Z}(d,o,l);return u>0?function(y,T,E){const R=(I,O,B)=>{const U=Oe.vec3.length(I),q=Oe.vec3.length(O),Z=to(I,O,B);return Oe.vec3.scale(Z,Z,1/Oe.vec3.length(Z)*Lt(U,q,B))},w=R([y[0],y[1],y[2]],[T[0],T[1],T[2]],E),D=R([y[4],y[5],y[6]],[T[4],T[5],T[6]],E),k=R([y[8],y[9],y[10]],[T[8],T[9],T[10]],E),S=to([y[12],y[13],y[14]],[T[12],T[13],T[14]],E);return[w[0],w[1],w[2],0,D[0],D[1],D[2],0,k[0],k[1],k[2],0,S[0],S[1],S[2],1]}(_,function(y,T){const E=T.worldSize,R=Os(1,0)*E*s(T.center.lat,T.zoom)/Ls(E),w=Os(1,T.center.lat)*E,D=Oe.mat4.identity([]);return Oe.mat4.rotateY(D,D,vi(T.center.lng)),Oe.mat4.rotateX(D,D,vi(T.center.lat)),Oe.mat4.translate(D,D,[0,0,_o]),Oe.mat4.scale(D,D,[R,R,R*w]),Oe.mat4.translate(D,D,[T.point.x-.5*E,T.point.y-.5*E,0]),Oe.mat4.multiply(D,D,y),Oe.mat4.multiply(D,T.globeMatrix,D)}(d,o),u):_}function rm(d,o,l,u){const _=gn.projectAabbCorners(u,l);let p=Number.MAX_VALUE,y=-1;for(let R=0;R<_.length;++R){const w=_[R];w[0]=(.5*w[0]+.5)*o.width,w[1]=(.5-.5*w[1])*o.height,w[2]<p&&(y=R,p=w[2])}const T=R=>new Ft(_[R][0],_[R][1]);let E;switch(y){case 0:case 6:E=[T(1),T(5),T(4),T(7),T(3),T(2),T(1)];break;case 1:case 7:E=[T(0),T(4),T(5),T(6),T(2),T(3),T(0)];break;case 3:case 5:E=[T(1),T(0),T(4),T(7),T(6),T(2),T(1)];break;default:E=[T(1),T(5),T(6),T(7),T(3),T(0),T(1)]}if(ne(d,E))return p}const Wl=Ri([{name:"a_pos_3f",components:3,type:"Float32"}]),VM=Ri([{name:"a_color_3f",components:3,type:"Float32"}]),QL=Ri([{name:"a_color_4f",components:4,type:"Float32"}]),cA=Ri([{name:"a_uv_2f",components:2,type:"Float32"}]),JL=Ri([{name:"a_normal_3f",components:3,type:"Float32"}]),eN=Ri([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),UM=Ri([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),l1={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class c1{constructor(o,l,u,_){this.message=(o?`${o}: `:"")+u,_&&(this.identifier=_),null!=l&&l.__line__&&(this.line=l.__line__)}}function dh(d,o){const l=-1===d.indexOf("://");try{return new URL(d,l&&o?"http://example.com":void 0),!0}catch{return!1}}class uh{constructor(o,l){this.feature=o,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class w0{constructor(){this.instancedDataArray=new yg,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class ov{constructor(o){this.zoom=o.zoom,this.canonical=o.canonical,this.layers=o.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=o.projection,this.index=o.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(o,l){}populate(o,l,u,_){this.tileToMeter=g(u);const p=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:y,id:T,index:E,sourceLayerIndex:R}of o){const w=T??(y.properties&&y.properties.hasOwnProperty("id")?y.properties.id:void 0),D=G(y,p);if(!this.layers[0]._featureFilter.filter(new _r(this.zoom),D,u))continue;const k={id:w,sourceLayerIndex:R,index:E,geometry:p?D.geometry:j(y,u,_),properties:y.properties,type:y.type,patterns:{}},S=this.addFeature(k,k.geometry,D);S&&l.featureIndex.insert(y,k.geometry,E,R,this.index,this.instancesPerModel[S].instancedDataArray.length,256)}this.lookup=null}update(o,l,u,_){for(const p in this.instancesPerModel){const y=this.instancesPerModel[p];for(const T in o)y.idToFeaturesIndex.hasOwnProperty(T)&&(this.evaluate(y.features[y.idToFeaturesIndex[T]],o[T],y,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let o=!1;for(const l in this.instancesPerModel){const u=this.instancesPerModel[l];for(const _ of u.features){const p=this.layers[0],y=_.feature,T=this.canonical,E=p.paint.get("model-rotation").evaluate(y,{},T),R=p.paint.get("model-scale").evaluate(y,{},T),w=p.paint.get("model-translation").evaluate(y,{},T);Oe.vec3.exactEquals(_.rotation,E)&&Oe.vec3.exactEquals(_.scale,R)&&Oe.vec3.exactEquals(_.translation,w)||(this.evaluate(_,_.featureStates,u,!0),o=!0)}}return o}updateReplacement(o,l,u,_){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(o.toUnwrapped(),!0);if(YT(this.activeReplacements,p))return!1;this.activeReplacements=p;let y=!1;for(const T in this.instancesPerModel){const E=this.instancesPerModel[T],R=E.instancedDataArray;for(const w of E.features){const D=w.instancedDataOffset,k=w.instancedDataCount;for(let S=0;S<k;S++){const I=16*(S+D);let O=R.float32[I+0];const B=O>Ot;O=B?O-Ot:O;const U=Math.floor(O),q=R.float32[I+1];let Z=!1;for(const $ of this.activeReplacements)if(!Hb($,u,l1.Model,_)&&!($.min.x>U||U>$.max.x||$.min.y>q||q>$.max.y)&&(Z=Lw($b(U,q,o.canonical,$.footprintTileId.canonical),$.footprint),Z))break;R.float32[I]=Z?O+Ot:O,y=y||Z!==B}}}return y}isEmpty(){for(const o in this.instancesPerModel)if(0!==this.instancesPerModel[o].instancedDataArray.length)return!1;return!0}uploadPending(){return!this.uploaded}upload(o){if(!this.uploaded)for(const l in this.instancesPerModel){const u=this.instancesPerModel[l];u.instancedDataArray.length<0||0===u.instancedDataArray.length||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=o.createVertexBuffer(u.instancedDataArray,eN.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const u=this.instancesPerModel[l];0!==u.instancedDataArray.length&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const o=this.layers[0].modelManager;if(o&&this.modelUris)for(const l of this.modelUris)o.removeModel(l,"")}addFeature(o,l,u){const _=this.layers[0],p=_.layout.get("model-id").evaluate(u,{},this.canonical);if(!p)return Yn(`modelId is not evaluated for layer ${_.id} and it is not going to get rendered.`),p;dh(p,!1)&&(this.modelUris.includes(p)||this.modelUris.push(p)),this.instancesPerModel[p]||(this.instancesPerModel[p]=new w0);const y=this.instancesPerModel[p],T=y.instancedDataArray,E=new uh(u,T.length);for(const R of l)for(const w of R){if(w.x<0||w.x>=Ot||w.y<0||w.y>=Ot)continue;const D=(this.lookupDim-1)/Ot,k=this.lookupDim*(w.y*D|0)+w.x*D|0;if(this.lookup){if(0!==this.lookup[k])continue;this.lookup[k]=1}this.instanceCount++;const S=T.length;T.resize(S+1),y.instancesEvaluatedElevation.push(0),T.float32[16*S]=w.x,T.float32[16*S+1]=w.y}return E.instancedDataCount=y.instancedDataArray.length-E.instancedDataOffset,E.instancedDataCount>0&&(o.id&&(y.idToFeaturesIndex[o.id]=y.features.length),y.features.push(E),this.evaluate(E,{},y,!1)),p}getModelUris(){return this.modelUris}evaluate(o,l,u,_){const p=this.layers[0],y=o.feature,T=this.canonical,E=o.rotation=p.paint.get("model-rotation").evaluate(y,l,T),R=o.scale=p.paint.get("model-scale").evaluate(y,l,T),w=o.translation=p.paint.get("model-translation").evaluate(y,l,T),D=p.paint.get("model-color").evaluate(y,l,T);D.a=p.paint.get("model-color-mix-intensity").evaluate(y,l,T);const k=[];this.maxVerticalOffset<w[2]&&(this.maxVerticalOffset=w[2]),this.maxScale=Math.max(Math.max(this.maxScale,R[0]),Math.max(R[1],R[2])),v0(k,E,R);const S=Math.round(100*D.a)+D.b/1.05;for(let I=0;I<o.instancedDataCount;++I){const O=o.instancedDataOffset+I,B=16*O,U=u.instancedDataArray.float32;let q=0;_&&(q=U[B+6]-u.instancesEvaluatedElevation[O]);const Z=0|U[B+1];U[B]=(0|U[B])+D.r/1.05,U[B+1]=Z+D.g/1.05,U[B+2]=S,U[B+3]=1/(T.z>10?this.tileToMeter:g(T,Z)),U[B+4]=w[0],U[B+5]=w[1],U[B+6]=w[2]+q,U[B+7]=k[0],U[B+8]=k[1],U[B+9]=k[2],U[B+10]=k[4],U[B+11]=k[5],U[B+12]=k[6],U[B+13]=k[8],U[B+14]=k[9],U[B+15]=k[10],u.instancesEvaluatedElevation[O]=w[2]}}}let jM,om;Zt(ov,"ModelBucket",{omit:["layers"]}),Zt(w0,"PerModelAttributes"),Zt(uh,"ModelFeature");const sm={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function C0(d,o,l,u,_,p,y,T,E,R=!1){const w=l.zoom,D=l.project(u),k=s(u.lat,w),S=1/k;Oe.mat4.identity(d),Oe.mat4.translate(d,d,[D.x+y[0]*S,D.y+y[1]*S,y[2]]);let I=1,O=1;const B=l.worldSize;if(R){if("mercator"===l.projection.name){let $=0;l.elevation&&($=l.elevation.getAtPointOrZero(new b(D.x/B,D.y/B),0));const Y=Oe.vec4.transformMat4([],[D.x,D.y,$,1],l.projMatrix)[3]/l.cameraToCenterDistance;I=Y,O=Y*s(l.center.lat,w)}else if("globe"===l.projection.name){const $=x0(d,l),Y=Oe.mat4.multiply([],l.projMatrix,$),K=[0,0,0,1];Oe.vec4.transformMat4(K,K,Y);const ee=K[3]/l.cameraToCenterDistance,ue=Ss(w),de=l.projection.pixelsPerMeter(u.lat,B)*s(u.lat,w),ce=l.projection.pixelsPerMeter(l.center.lat,B)*s(l.center.lat,w);I=ee/Lt(de,m(l.center.lat),ue),O=ee*k/de,I*=ce,O*=ce}}else I=S;Oe.mat4.scale(d,d,[I,I,O]);const U=[...d],q=o.orientation,Z=[];if(v0(Z,[q[0]+_[0],q[1]+_[1],q[2]+_[2]],p),Oe.mat4.multiply(d,U,Z),T&&l.elevation){let $=0;const Y=[];if(E&&l.elevation){$=function(ue,de,ce,we,fe){const Te=de.elevation;if(!Te)return 0;const ke=gn.projectAabbCorners(ce,we),De=Os(1,fe.lat)*de.worldSize,Pe=function(en,It){const Xt=[0,0,1],dn=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const On of dn){const Hn=en[On.corners[0]],Qn=en[On.corners[1]],$n=en[On.corners[2]],di=[Qn[0]-Hn[0],Qn[1]-Hn[1],It*(Qn[2]-Hn[2])],lr=Oe.vec3.cross(di,di,[$n[0]-Hn[0],$n[1]-Hn[1],It*($n[2]-Hn[2])]);Oe.vec3.normalize(lr,lr),On.dotProductWithUp=Oe.vec3.dot(lr,Xt)}return dn.sort((On,Hn)=>On.dotProductWithUp-Hn.dotProductWithUp),dn[0].corners}(ke,De),Ne=ke[Pe[0]],je=ke[Pe[1]],Le=ke[Pe[2]],it=ke[Pe[3]],_t=Te.getAtPointOrZero(new b(Ne[0]/de.worldSize,Ne[1]/de.worldSize),0),rt=Te.getAtPointOrZero(new b(je[0]/de.worldSize,je[1]/de.worldSize),0),Et=Te.getAtPointOrZero(new b(Le[0]/de.worldSize,Le[1]/de.worldSize),0),St=Te.getAtPointOrZero(new b(it[0]/de.worldSize,it[1]/de.worldSize),0),zt=(_t+St)/2,lt=(rt+Et)/2;return zt>lt?rt<Et?b0(ue,je,it,Ne,rt,St,_t,De):b0(ue,Le,Ne,it,Et,_t,St,De):_t<St?b0(ue,Ne,je,Le,_t,rt,Et,De):b0(ue,it,Le,je,St,Et,rt,De),Math.max(zt,lt)}(Y,l,o.aabb,d,u);const K=Oe.mat4.fromQuat([],Y),ee=Oe.mat4.multiply([],K,Z);Oe.mat4.multiply(d,U,ee)}else $=l.elevation.getAtPointOrZero(new b(D.x/B,D.y/B),0);0!==$&&(d[14]+=$)}}function Pf(d,o,l=!1){d.uploaded||(d.gfxTexture=new h0(o,d.image,l?o.gl.R8:o.gl.RGBA8,{useMipmap:d.sampler.minFilter>=o.gl.NEAREST_MIPMAP_NEAREST}),d.uploaded=!0,d.image=null)}function HM(d,o,l){d.indexBuffer=o.createIndexBuffer(d.indexArray,!1,!0),d.vertexBuffer=o.createVertexBuffer(d.vertexArray,Wl.members,!1,!0),d.normalArray&&(d.normalBuffer=o.createVertexBuffer(d.normalArray,JL.members,!1,!0)),d.texcoordArray&&(d.texcoordBuffer=o.createVertexBuffer(d.texcoordArray,cA.members,!1,!0)),d.colorArray&&(d.colorBuffer=o.createVertexBuffer(d.colorArray,(12===d.colorArray.bytesPerElement?VM:QL).members,!1,!0)),d.featureArray&&(d.pbrBuffer=o.createVertexBuffer(d.featureArray,UM.members,!0)),d.segments=ni.simpleSegment(0,0,d.vertexArray.length,d.indexArray.length);const u=d.material;u.pbrMetallicRoughness.baseColorTexture&&Pf(u.pbrMetallicRoughness.baseColorTexture,o),u.pbrMetallicRoughness.metallicRoughnessTexture&&Pf(u.pbrMetallicRoughness.metallicRoughnessTexture,o),u.normalTexture&&Pf(u.normalTexture,o),u.occlusionTexture&&Pf(u.occlusionTexture,o,l),u.emissionTexture&&Pf(u.emissionTexture,o)}function d1(d,o,l){if(d.meshes)for(const u of d.meshes)HM(u,o,l);if(d.children)for(const u of d.children)d1(u,o,l)}function sv(d){if(d.meshes)for(const o of d.meshes)o.indexArray.destroy(),o.vertexArray.destroy(),o.colorArray&&o.colorArray.destroy(),o.normalArray&&o.normalArray.destroy(),o.texcoordArray&&o.texcoordArray.destroy(),o.featureArray&&o.featureArray.destroy();if(d.children)for(const o of d.children)sv(o)}function u1(d){if(d.meshes)for(const l of d.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((o=l.material).pbrMetallicRoughness.baseColorTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture&&o.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),o.pbrMetallicRoughness.metallicRoughnessTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&o.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),o.normalTexture&&o.normalTexture.gfxTexture&&o.normalTexture.gfxTexture.destroy(),o.emissionTexture&&o.emissionTexture.gfxTexture&&o.emissionTexture.gfxTexture.destroy(),o.occlusionTexture&&o.occlusionTexture.gfxTexture&&o.occlusionTexture.gfxTexture.destroy()));var o;if(d.children)for(const l of d.children)u1(l)}class Jg{constructor(o,l,u){this._demTile=o,this._dem=this._demTile.dem,this._scale=l,this._offset=u}static create(o,l,u){const _=u||o.findDEMTileFor(l);if(!_||!_.dem)return;const p=_.dem,y=_.tileID,T=1<<l.canonical.z-y.canonical.z;return new Jg(_,p.dim/Ot/T,[(l.canonical.x/T-y.canonical.x)*p.dim,(l.canonical.y/T-y.canonical.y)*p.dim])}tileCoordToPixel(o,l){const u=l*this._scale+this._offset[1],_=Math.floor(o*this._scale+this._offset[0]),p=Math.floor(u);return new Ft(_,p)}getElevationAt(o,l,u,_){const p=o*this._scale+this._offset[0],y=l*this._scale+this._offset[1],T=Math.floor(p),E=Math.floor(y),R=this._dem;return _=!!_,u?Lt(Lt(R.get(T,E,_),R.get(T,E+1,_),y-E),Lt(R.get(T+1,E,_),R.get(T+1,E+1,_),y-E),p-T):R.get(T,E,_)}getElevationAtPixel(o,l,u){return this._dem.get(o,l,!!u)}getMeterToDEM(o){return(1<<this._demTile.tileID.canonical.z)*Os(1,o)*this._dem.stride}}const T0=new Float32Array(262144),fh=new Uint8Array(262144);function e_(d){let o=0;if(d.meshes)for(const l of d.meshes)o=Math.max(o,l.aabb.max[2]);if(d.children)for(const l of d.children)o=Math.max(o,e_(l));return o}function t_(d,o,l){if(d.meshes)for(const u of d.meshes){if(u.aabb.min[0]===1/0)continue;const _=gn.applyTransform(u.aabb,d.matrix);l.insert(o,_.min[0],_.min[1],_.max[0],_.max[1])}if(d.children)for(const u of d.children)t_(u,o,l)}const M0=["","wall","door","roof","window","lamp","logo"];class $M{constructor(o){this.node=o,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:o.id,geometry:[],properties:{height:e_(o)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let o=0;const l=new gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==o&&(u.transformedAabb=gn.applyTransformFast(u.aabb,this.node.matrix),l.encapsulate(u.transformedAabb)),o++;this.aabb=l}return this.aabb}}class S0{constructor(o,l,u,_,p,y,T){this.id=u,this.layers=o,this.layerIds=this.layers.map(E=>E.fqid),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.modelTraits|=sm.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,_&&(this.modelTraits|=sm.HasMapboxMeshFeatures),p&&(this.modelTraits|=sm.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=y,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const E of l)this.nodesInfo.push(new $M(E)),t_(E,T.featureIndexArray.length,T.grid),T.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,T.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(o,l){for(const u of this.getNodesInfo()){const _=u.node;_.footprint&&l.push({footprint:_.footprint,id:o})}}update(o){const l=0!==Object.keys(o).length;if(l&&!this.stateDependentLayers.length)return;const u=l?this.stateDependentLayers:this.layers;if(!zc(o,this.states))for(const _ of u)this.evaluate(_,o);this.states=structuredClone(o)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(o){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const u of l){const _=u.node;this.uploaded?this.updatePbrBuffer(_):d1(_,o,!0)}for(const u of l)sv(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(o){let l=!1;if(!o.meshes)return l;for(const u of o.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),l=!0);return l}needsReEvaluation(o,l,u){const _=o.transform.projectionOptions,p=o.style.getBrightness(),y=this.brightness!==p;if(!this.uploaded||this.dirty||_.name!==this.projection.name||am(u.paint.get("model-color").value,y)||am(u.paint.get("model-color-mix-intensity").value,y)||am(u.paint.get("model-roughness").value,y)||am(u.paint.get("model-emissive-strength").value,y)||am(u.paint.get("model-height-based-emissive-strength-multiplier").value,y)){this.projection=_,this.brightness=p;const T=this.getNodesInfo();for(const E of T)E.state=null;return!0}return!1}evaluateScale(o,l){if(o.transform.zoom===this.zoom)return;this.zoom=o.transform.zoom;const u=this.getNodesInfo(),_=this.id.canonical;for(const p of u){const y=p.feature;p.evaluatedScale=l.paint.get("model-scale").evaluate(y,{},_)}}evaluate(o,l){const u=this.getNodesInfo();for(const _ of u){if(!_.node.meshes)continue;const p=_.feature,y=l&&l[p.id];if(zc(y,_.state))continue;_.state=structuredClone(y);const T=_.node.meshes&&_.node.meshes[0].featureData,E=_.evaluatedColor[2],R=_.evaluatedRMEA[2],w=this.id.canonical;if(_.hasTranslucentParts=!1,T){for(let D=0;D<M0.length;D++){const k=M0[D];k.length&&(p.properties.part=k);const S=o.paint.get("model-color").evaluate(p,y,w).toRenderColor(null),I=o.paint.get("model-color-mix-intensity").evaluate(p,y,w);_.evaluatedColor[D]=[S.r,S.g,S.b,I],_.evaluatedRMEA[D][0]=o.paint.get("model-roughness").evaluate(p,y,w),_.evaluatedRMEA[D][2]=o.paint.get("model-emissive-strength").evaluate(p,y,w),_.evaluatedRMEA[D][3]=S.a,_.emissionHeightBasedParams[D]=o.paint.get("model-height-based-emissive-strength-multiplier").evaluate(p,y,w),!_.hasTranslucentParts&&S.a<1&&(_.hasTranslucentParts=!0)}delete p.properties.part,lm(_,E!==_.evaluatedColor[2]||R!==_.evaluatedRMEA[2],this.modelTraits)}else _.evaluatedRMEA[0][2]=o.paint.get("model-emissive-strength").evaluate(p,y,w);_.evaluatedScale=o.paint.get("model-scale").evaluate(p,y,w),this.updatePbrBuffer(_.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(o,l,u,_){const p=o.findDEMTileFor(u);if(p&&(p.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(p.dem&&p.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=p.tileID.overscaledZ;const y=Jg.create(o,u,p);if(!y)return;this.modelTraits&sm.HasMapboxMeshFeatures&&this.updateDEM(o,y,u,_);for(const T of this.getNodesInfo()){const E=T.node;if(!E.footprint||!E.footprint.vertices||!E.footprint.vertices.length)continue;const R=E.footprint.vertices;let w=y.getElevationAt(R[0].x,R[0].y,!0,!0);for(let D=1;D<R.length;D++)w=Math.min(w,y.getElevationAt(R[D].x,R[D].y,!0,!0));E.elevation=w}}this.terrainTile=p.tileID.canonical,this.terrainExaggeration=l}}updateDEM(o,l,u,_){let p=l._dem._modifiedForSources[_];if(void 0===p&&(l._dem._modifiedForSources[_]=[],p=l._dem._modifiedForSources[_]),p.includes(u.canonical))return;const y=l._dem.dim;p.push(u.canonical);let T=!1;for(const E of this.getNodesInfo()){const R=E.node;if(!R.footprint||!R.footprint.grid)continue;const w=R.footprint.grid,D=l.tileCoordToPixel(w.min.x,w.min.y),k=l.tileCoordToPixel(w.max.x,w.max.y),S=Math.min(Math.min(y-k.y,D.x),Math.min(D.y,y-k.x));if(S<0)continue;const I=En(S,2,5);let O=Math.max(0,D.x-I),B=Math.max(0,D.y-I),U=Math.min(k.x+I,y-1),q=Math.min(k.y+I,y-1);for(let K=B;K<=q;++K)for(let ee=O;ee<=U;++ee)fh[K*y+ee]=255;let Z=0,$=0;for(let K=0;K<w.cellsY;++K)for(let ee=0;ee<w.cellsX;++ee){if(!w.cells[K*w.cellsX+ee])continue;const ue=l.tileCoordToPixel(w.min.x+ee/w.xScale,w.min.y+K/w.yScale),de=l.tileCoordToPixel(w.min.x+(ee+1)/w.xScale,w.min.y+(K+1)/w.yScale);for(let ce=ue.y;ce<=Math.min(de.y+1,y-1);++ce)for(let we=ue.x;we<=Math.min(de.x+1,y-1);++we)255===fh[ce*y+we]&&(fh[ce*y+we]=0,Z+=l.getElevationAtPixel(we,ce),$++)}const Y=Z/$;O=Math.max(1,D.x-I),B=Math.max(1,D.y-I),U=Math.min(k.x+I,y-2),q=Math.min(k.y+I,y-2),T=!0;for(let K=B;K<=q;++K)for(let ee=O;ee<=U;++ee)0===fh[K*y+ee]&&(T0[K*y+ee]=l._dem.set(ee,K,Y));for(let K=1;K<I;++K){O=Math.max(1,D.x-K),B=Math.max(1,D.y-K),U=Math.min(k.x+K,y-2),q=Math.min(k.y+K,y-2);for(let ee=B;ee<=q;++ee)for(let ue=O;ue<=U;++ue){const de=ee*y+ue;if(255===fh[de]){let ce=0,we=0,fe=-1,Te=-1;for(let ke=-1;ke<=1;++ke)for(let De=-1;De<=1;++De){const Pe=(ee+ke)*y+ue+De;if(fh[Pe]>=K)continue;const Ne=T0[Pe],je=Math.abs(Ne);je>we&&(ce=Ne,we=je,fe=De,Te=ke)}if(we>.1){const ke=1-(K+.5*Math.abs(fe*Te))/I;let De=l._dem.get(ue,ee)+ce*ke;const Pe=l._dem.get(ue+fe,ee+Te),Ne=l._dem.get(ue-fe,ee-Te,!0);(De-Pe)*(De-Ne)>0&&(De=(Pe+Ne)/2),T0[de]=l._dem.set(ue,ee,De),fh[de]=K}}}}}T&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=Tt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const o=this.getNodesInfo();for(const l of o)sv(l.node),u1(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(o,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const u=l.getReplacementRegionsForTile(o.toUnwrapped()),_=this.getNodesInfo();for(let p=0;p<this.nodesInfo.length;p++){const y=_[p].node;_[p].hiddenByReplacement=!!y.footprint&&!u.find(T=>T.footprint===y.footprint)}}getHeightAtTileCoord(o,l){const u=this.getNodesInfo(),_=[],p=[0,0,0],y=Oe.mat4.identity([]);for(let T=0;T<this.nodesInfo.length;T++){const E=u[T],R=E.node.meshes[0],w=R.transformedAabb;if(o<w.min[0]||l<w.min[1]||o>w.max[0]||l>w.max[1])continue;if(!0===E.node.hidden)return{height:1/0,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};Oe.mat4.invert(y,E.node.matrix),p[0]=o,p[1]=l,Oe.vec3.transformMat4(p,p,y);const D=(p[0]-R.aabb.min[0])/(R.aabb.max[0]-R.aabb.min[0])*64|0,k=64*Math.min(63,(p[1]-R.aabb.min[1])/(R.aabb.max[1]-R.aabb.min[1])*64|0)+Math.min(63,D),S=R.heightmap[k];if(!(S<0&&E.node.footprint))return E.hiddenByReplacement?void 0:{height:S,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};if(E.node.footprint.grid.query(new Ft(o,l),new Ft(o,l),_),_.length>0)return{height:void 0,maxHeight:E.feature.properties.height,hidden:E.hiddenByReplacement,verticalScale:E.evaluatedScale[2]}}}}function am(d,o){return!d.isLightConstant&&o}function GM(d,o,l,u,_,p,y,T){let E=(61440&o|(61440&o)>>4)>>8,R=(3840&o|(3840&o)>>4)>>4,w=240&o|(240&o)>>4;l[3]>0&&(E=Lt(E,255*l[0],l[3]),R=Lt(R,255*l[1],l[3]),w=Lt(w,255*l[2],l[3]));const D=E<<8|R,k=w<<8|Math.floor(255*u[3]),S=function(K){const ee=En(K,0,2);return Math.min(Math.round(.5*ee*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],I=En(_[0],0,1),O=En(_[1],0,1),B=En(_[2],0,1),U=En(_[3],0,1);let q,Z,$,Y;if(I!==O&&y!==p&&O!==I){const K=y-p;Z=1/(K*(O-I)),$=-(p+K*I)/(K*(O-I));const ee=En(_[4],-1,1);Y=Math.pow(10,ee),q=255*B<<8|255*U}else q=65535,Z=0,$=1,Y=1;if(d.emplaceBack(D,k,S,q,Z,$,Y),T){const K=T.length;T.clear();for(let ee=0;ee<K;ee++)T.emplaceBack(D,k,S,q,Z,$,Y)}}function lm(d,o,l){const u=d.node;let _=0;const p=l&sm.HasMeshoptCompression;for(const y of u.meshes){if(u.lights&&u.lightMeshIndex===_||!y.featureData)continue;y.featureArray=new Ip,y.featureArray.reserve(y.featureData.length);let T=o;for(const E of y.featureData){const R=p?65535&E:E>>16&65535,w=p?E>>16&65535:65535&E,D=(15&w)<8?15&w:0,k=d.evaluatedRMEA[D],S=d.evaluatedColor[D],I=d.emissionHeightBasedParams[D];let O;if(T&&2===D&&u.lights&&(O=new Ip,O.resize(10*u.lights.length)),GM(y.featureArray,R,S,k,I,y.aabb.min[2],y.aabb.max[2],O),O&&T){T=!1;const B=u.meshes[u.lightMeshIndex];B.featureArray=O,B.featureArray._trim()}}y.featureArray._trim(),_++}}function h1(d,o,l,u){const _=1<<d.z;o.lat=Zo((u/Ot+d.y)/_),o.lng=aa((l/Ot+d.x)/_)}Zt(S0,"Tiled3dModelBucket",{omit:["layers"]}),Zt($M,"Tiled3dModelFeature");const qM={circle:class extends ds{constructor(d,o,l,u){super(d,{layout:dt||(dt=new Pr({"circle-sort-key":new jt(Ge.layout_circle["circle-sort-key"]),visibility:new wt(Ge.layout_circle.visibility)})),paint:Ke||(Ke=new Pr({"circle-radius":new jt(Ge.paint_circle["circle-radius"]),"circle-color":new jt(Ge.paint_circle["circle-color"]),"circle-blur":new jt(Ge.paint_circle["circle-blur"]),"circle-opacity":new jt(Ge.paint_circle["circle-opacity"]),"circle-translate":new wt(Ge.paint_circle["circle-translate"]),"circle-translate-anchor":new wt(Ge.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new wt(Ge.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new wt(Ge.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new jt(Ge.paint_circle["circle-stroke-width"]),"circle-stroke-color":new jt(Ge.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new jt(Ge.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new wt(Ge.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}createBucket(d){return new te(d)}queryRadius(d){const o=d;return Ye("circle-radius",this,o)+Ye("circle-stroke-width",this,o)+pt(this.paint.get("circle-translate"))}queryIntersectsFeature(d,o,l,u,_,p,y,T){const E=He(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),R=this.paint.get("circle-radius").evaluate(o,l)+this.paint.get("circle-stroke-width").evaluate(o,l);return Ob(d,u,p,y,T,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,R)}getProgramIds(){return["circle"]}getDefaultProgramParams(d,o,l){const u=Dg(this);return{config:new xf(this,{zoom:o,lut:l}),defines:u,overrideFog:!1}}},heatmap:class extends ds{createBucket(d){return new by(d)}constructor(d,o,l,u){super(d,{layout:xy||(xy=new Pr({visibility:new wt(Ge.layout_heatmap.visibility)})),paint:FT||(FT=new Pr({"heatmap-radius":new jt(Ge.paint_heatmap["heatmap-radius"]),"heatmap-weight":new jt(Ge.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new wt(Ge.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ki(Ge.paint_heatmap["heatmap-color"]),"heatmap-opacity":new wt(Ge.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){"heatmap-color"===d&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(d){return Ye("heatmap-radius",this,d)}queryIntersectsFeature(d,o,l,u,_,p,y,T){const E=this.paint.get("heatmap-radius").evaluate(o,l);return Ob(d,u,p,y,T,!0,!0,new Ft(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(d,o,l){return"heatmap"===d?{config:new xf(this,{zoom:o,lut:l}),overrideFog:!1}:{}}},hillshade:class extends ds{constructor(d,o,l,u){super(d,{layout:LT||(LT=new Pr({visibility:new wt(Ge.layout_hillshade.visibility)})),paint:NT||(NT=new Pr({"hillshade-illumination-direction":new wt(Ge.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new wt(Ge.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new wt(Ge.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new wt(Ge.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new wt(Ge.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new wt(Ge.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new wt(Ge.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}shouldRedrape(){return this.hasOffscreenPass()&&"viewport"===this.paint.get("hillshade-illumination-anchor")}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(d,o,l){return{overrideFog:!1}}},fill:class extends ds{constructor(d,o,l,u){super(d,{layout:HT||(HT=new Pr({"fill-sort-key":new jt(Ge.layout_fill["fill-sort-key"]),visibility:new wt(Ge.layout_fill.visibility),"fill-elevation-reference":new wt(Ge.layout_fill["fill-elevation-reference"])})),paint:Ik||(Ik=new Pr({"fill-antialias":new wt(Ge.paint_fill["fill-antialias"]),"fill-opacity":new jt(Ge.paint_fill["fill-opacity"]),"fill-color":new jt(Ge.paint_fill["fill-color"]),"fill-outline-color":new jt(Ge.paint_fill["fill-outline-color"]),"fill-translate":new wt(Ge.paint_fill["fill-translate"]),"fill-translate-anchor":new wt(Ge.paint_fill["fill-translate-anchor"]),"fill-pattern":new jt(Ge.paint_fill["fill-pattern"]),"fill-emissive-strength":new wt(Ge.paint_fill["fill-emissive-strength"]),"fill-z-offset":new jt(Ge.paint_fill["fill-z-offset"]),"fill-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}getProgramIds(){const d=this.paint.get("fill-pattern"),o=d&&d.constantOr(1),l=[o?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(o&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(d,o,l){return{config:new xf(this,{zoom:o,lut:l}),overrideFog:!1}}recalculate(d,o){super.recalculate(d,o);const l=this.paint._values["fill-outline-color"];"constant"===l.value.kind&&void 0===l.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(d){return new Dw(d)}queryRadius(){return pt(this.paint.get("fill-translate"))}queryIntersectsFeature(d,o,l,u,_,p){return!d.queryGeometry.isAboveHorizon&&me(Ct(d.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return 0!==this.paint.get("fill-z-offset").constantOr(1)}},"fill-extrusion":class extends ds{constructor(d,o,l,u){super(d,{layout:rM||(rM=new Pr({visibility:new wt(Ge["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new wt(Ge["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:zw||(zw=new Pr({"fill-extrusion-opacity":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new jt(Ge["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new wt(Ge["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new lo(d)}queryRadius(){return pt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(d,o,l,u,_,p,y,T,E){const R=He(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),w=this.paint.get("fill-extrusion-height").evaluate(o,l),D=this.paint.get("fill-extrusion-base").evaluate(o,l),k=[0,0],S=T&&p.elevation,I=p.elevation?p.elevation.exaggeration():1,O=d.tile.getBucket(this);if(S&&O instanceof lo){const $=O.centroidVertexArray,Y=E+1;Y<$.length&&(k[0]=$.geta_centroid_pos0(Y),k[1]=$.geta_centroid_pos1(Y))}if(0===k[0]&&1===k[1])return!1;"globe"===p.projection.name&&(u=iM([u],[new Ft(0,0),new Ft(Ot,Ot)],d.tileID.canonical).map($=>$.polygon).flat());const B=S?T:null,[U,q]=(Y=u,K=D,ee=w,ue=R,de=y,ce=B,we=k,fe=I,Te=p.center.lat,"globe"===($=p).projection.name?function(De,Pe,Ne,je,Le,it,_t,rt,Et,St,zt){const lt=[],en=[],It=De.projection.upVectorScale(zt,De.center.lat,De.worldSize).metersToTile,Xt=[0,0,0,1],dn=[0,0,0,1],On=(Qn,$n,di,lr)=>{Qn[0]=$n,Qn[1]=di,Qn[2]=lr,Qn[3]=1},Hn=Py();Ne>0&&(Ne+=Hn),je+=Hn;for(const Qn of Pe){const $n=[],di=[];for(const lr of Qn){const qi=lr.x+Le.x,Cn=lr.y+Le.y,Qi=De.projection.projectTilePoint(qi,Cn,zt),Yi=De.projection.upVector(zt,lr.x,lr.y);let Hi=Ne,qr=je;if(_t){const ro=Bw(qi,Cn,Ne,je,_t,rt,Et,St);Hi+=ro.base,qr+=ro.top}0!==Ne?On(Xt,Qi.x+Yi[0]*It*Hi,Qi.y+Yi[1]*It*Hi,Qi.z+Yi[2]*It*Hi):On(Xt,Qi.x,Qi.y,Qi.z),On(dn,Qi.x+Yi[0]*It*qr,Qi.y+Yi[1]*It*qr,Qi.z+Yi[2]*It*qr),Oe.vec3.transformMat4(Xt,Xt,it),Oe.vec3.transformMat4(dn,dn,it),$n.push(new Xd(Xt[0],Xt[1],Xt[2])),di.push(new Xd(dn[0],dn[1],dn[2]))}lt.push($n),en.push(di)}return[lt,en]}($,Y,K,ee,ue,de,ce,we,fe,Te,d.tileID.canonical):ce?function(De,Pe,Ne,je,Le,it,_t,rt,Et){const St=[],zt=[],lt=[0,0,0,1];for(const en of De){const It=[],Xt=[];for(const dn of en){const On=dn.x+je.x,Hn=dn.y+je.y,Qn=Bw(On,Hn,Pe,Ne,it,_t,rt,Et);lt[0]=On,lt[1]=Hn,lt[2]=Qn.base,lt[3]=1,Oe.vec4.transformMat4(lt,lt,Le),lt[3]=Math.max(lt[3],1e-5);const $n=new Xd(lt[0]/lt[3],lt[1]/lt[3],lt[2]/lt[3]);lt[0]=On,lt[1]=Hn,lt[2]=Qn.top,lt[3]=1,Oe.vec4.transformMat4(lt,lt,Le),lt[3]=Math.max(lt[3],1e-5);const di=new Xd(lt[0]/lt[3],lt[1]/lt[3],lt[2]/lt[3]);It.push($n),Xt.push(di)}St.push(It),zt.push(Xt)}return[St,zt]}(Y,K,ee,ue,de,ce,we,fe,Te):function(De,Pe,Ne,je,Le){const it=[],_t=[],rt=Le[8]*Pe,Et=Le[9]*Pe,St=Le[10]*Pe,zt=Le[11]*Pe,lt=Le[8]*Ne,en=Le[9]*Ne,It=Le[10]*Ne,Xt=Le[11]*Ne;for(const dn of De){const On=[],Hn=[];for(const Qn of dn){const $n=Qn.x+je.x,di=Qn.y+je.y,lr=Le[0]*$n+Le[4]*di+Le[12],qi=Le[1]*$n+Le[5]*di+Le[13],Cn=Le[2]*$n+Le[6]*di+Le[14],Qi=Le[3]*$n+Le[7]*di+Le[15],Yi=lr+rt,Hi=qi+Et,qr=Cn+St,ro=Math.max(Qi+zt,1e-5),Wr=lr+lt,Da=qi+en,cr=Cn+It,Tr=Math.max(Qi+Xt,1e-5);On.push(new Xd(Yi/ro,Hi/ro,qr/ro)),Hn.push(new Xd(Wr/Tr,Da/Tr,cr/Tr))}it.push(On),_t.push(Hn)}return[it,_t]}(Y,K,ee,ue,de)),Z=d.queryGeometry;var $,Y,K,ee,ue,de,ce,we,fe,Te;return function($,Y,K){let ee=1/0;me(K,Y)&&(ee=Oy(K,Y[0]));for(let ue=0;ue<Y.length;ue++){const de=Y[ue],ce=$[ue];for(let we=0;we<de.length-1;we++){const fe=de[we],Te=[fe,de[we+1],ce[we+1],ce[we],fe];ne(K,Te)&&(ee=Math.min(ee,Oy(K,Te)))}}return ee!==1/0&&ee}(U,q,Z.isPointQuery()?Z.screenBounds:Z.screenGeometry)}},line:class extends ds{constructor(d,o,l,u){const _=Kb();super(d,_,o,l,u),_.layout&&(this.layout=new ta(_.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(d){if("line-gradient"===d){const o=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=o._styleExpression&&o._styleExpression.expression instanceof Rd,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(d,o){super.recalculate(d,o),this.paint._values["line-floorwidth"]=(()=>{if(jg)return jg;const l=Kb();return jg=new dM(l.paint.properties["line-width"].specification),jg.useIntegerZoom=!0,jg})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,d)}createBucket(d){return new lM(d)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(d,o,l){const u=zy(this);return{config:new xf(this,{zoom:o,lut:l}),defines:u,overrideFog:!1}}queryRadius(d){const o=d,l=Qb(Ye("line-width",this,o),Ye("line-gap-width",this,o)),u=Ye("line-offset",this,o);return l/2+Math.abs(u)+pt(this.paint.get("line-translate"))}queryIntersectsFeature(d,o,l,u,_,p){if(d.queryGeometry.isAboveHorizon)return!1;const y=Ct(d.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,d.pixelToTileUnitsFactor),T=d.pixelToTileUnitsFactor/2*Qb(this.paint.get("line-width").evaluate(o,l),this.paint.get("line-gap-width").evaluate(o,l)),E=this.paint.get("line-offset").evaluate(o,l);return E&&(u=function(R,w){const D=[],k=new Ft(0,0);for(let S=0;S<R.length;S++){const I=R[S],O=[];for(let B=0;B<I.length;B++){const U=I[B],q=I[B+1],Z=0===B?k:U.sub(I[B-1])._unit()._perp(),$=B===I.length-1?k:q.sub(U)._unit()._perp(),Y=Z._add($)._unit();Y._mult(1/(Y.x*$.x+Y.y*$.y)),O.push(Y._mult(w)._add(U))}D.push(O)}return D}(u,E*d.pixelToTileUnitsFactor)),function(R,w,D){for(let k=0;k<w.length;k++){const S=w[k];if(R.length>=3)for(let I=0;I<S.length;I++)if(Re(R,S[I]))return!0;if(pe(R,S,D))return!0}return!1}(y,u,T)}isTileClipped(){return!0}isDraped(d){const o=this.layout.get("line-z-offset"),l=o.isConstant()&&!o.constantOr(0),u=this.layout.get("line-elevation-reference");return!("sea"===u||"ground"===u)&&(l||"none"!==u)}},symbol:u0,background:class extends ds{constructor(d,o,l,u){super(d,{layout:i1||(i1=new Pr({visibility:new wt(Ge.layout_background.visibility)})),paint:tA||(tA=new Pr({"background-pitch-alignment":new wt(Ge.paint_background["background-pitch-alignment"]),"background-color":new wt(Ge.paint_background["background-color"]),"background-pattern":new wt(Ge.paint_background["background-pattern"]),"background-opacity":new wt(Ge.paint_background["background-opacity"]),"background-emissive-strength":new wt(Ge.paint_background["background-emissive-strength"]),"background-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(d,o,l){return{overrideFog:!1}}is3D(){return"viewport"===this.paint.get("background-pitch-alignment")}},raster:g0,"raster-particle":lA,sky:class extends ds{constructor(d,o,l,u){super(d,{layout:_0||(_0=new Pr({visibility:new wt(Ge.layout_sky.visibility)})),paint:sA||(sA=new Pr({"sky-type":new wt(Ge.paint_sky["sky-type"]),"sky-atmosphere-sun":new wt(Ge.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new wt(Ge.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new wt(Ge.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new wt(Ge.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ki(Ge.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new wt(Ge.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new wt(Ge.paint_sky["sky-atmosphere-color"]),"sky-opacity":new wt(Ge.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(d){"sky-gradient"===d?this._updateColorRamp():"sky-atmosphere-sun"!==d&&"sky-atmosphere-halo-color"!==d&&"sky-atmosphere-color"!==d&&"sky-atmosphere-sun-intensity"!==d||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=kg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(d){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const o=d.style.light.properties.get("position");return this._lightPosition.azimuthal!==o.azimuthal||this._lightPosition.polar!==o.polar}return!1}getCenter(d,o){if("atmosphere"===this.paint.get("sky-type")){const u=this.paint.get("sky-atmosphere-sun"),_=!u,p=d.style.light,y=p.properties.get("position");return _&&"viewport"===p.properties.get("anchor")&&Yn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),_?zM(y.azimuthal,90-y.polar,o):zM(u[0],90-u[1],o)}const l=this.paint.get("sky-gradient-center");return zM(l[0],90-l[1],o)}isSky(){return!0}markSkyboxValid(d){this._skyboxInvalidated=!1,this._lightPosition=d.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const d=this.paint.get("sky-type");return"atmosphere"===d?["skyboxCapture","skybox"]:"gradient"===d?["skyboxGradient"]:null}},slot:class extends ds{constructor(d,o,l,u){super(d,{paint:aA||(aA=new Pr({}))},o,null)}},model:class extends ds{constructor(d,o,l,u){super(d,{layout:jM||(jM=new Pr({visibility:new wt(Ge.layout_model.visibility),"model-id":new jt(Ge.layout_model["model-id"])})),paint:om||(om=new Pr({"model-opacity":new jt(Ge.paint_model["model-opacity"]),"model-rotation":new jt(Ge.paint_model["model-rotation"]),"model-scale":new jt(Ge.paint_model["model-scale"]),"model-translation":new jt(Ge.paint_model["model-translation"]),"model-color":new jt(Ge.paint_model["model-color"]),"model-color-mix-intensity":new jt(Ge.paint_model["model-color-mix-intensity"]),"model-type":new wt(Ge.paint_model["model-type"]),"model-cast-shadows":new wt(Ge.paint_model["model-cast-shadows"]),"model-receive-shadows":new wt(Ge.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new wt(Ge.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new jt(Ge.paint_model["model-emissive-strength"]),"model-roughness":new jt(Ge.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new jt(Ge.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new wt(Ge.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new wt(Ge.paint_model["model-front-cutoff"]),"model-color-use-theme":new jt({type:"string",default:"default","property-type":"data-driven"})}))},o,l,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(d){return new ov(d)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(d){return d instanceof S0?8191:0}queryIntersectsFeature(d,o,l,u,_,p){if(!this.modelManager)return!1;const y=this.modelManager,T=d.tile.getBucket(this);if(!(T&&T instanceof ov))return!1;for(const E in T.instancesPerModel){const R=T.instancesPerModel[E],w=void 0!==o.id?o.id:o.properties&&o.properties.hasOwnProperty("id")?o.properties.id:void 0;if(R.idToFeaturesIndex.hasOwnProperty(w)){const D=R.features[R.idToFeaturesIndex[w]],k=y.getModel(E,this.scope);if(!k)return!1;let S=Oe.mat4.create();const I=new ii(0,0),O=T.canonical;let B=Number.MAX_VALUE;for(let U=0;U<D.instancedDataCount;++U){const q=16*(D.instancedDataOffset+U),Z=R.instancedDataArray.float32,$=[Z[q+4],Z[q+5],Z[q+6]];h1(O,I,Z[q],0|Z[q+1]),C0(S,k,p,I,D.rotation,D.scale,$,!1,!1,!1),"globe"===p.projection.name&&(S=x0(S,p));const Y=Oe.mat4.multiply([],p.projMatrix,S),K=d.queryGeometry,ee=rm(K.isPointQuery()?K.screenBounds:K.screenGeometry,p,Y,k.aabb);null!=ee&&(B=Math.min(ee,B))}return B!==Number.MAX_VALUE&&B}}return!1}_handleOverridablePaintPropertyUpdate(d,o,l){return!(!this.layout||o.isDataDriven()||l.isDataDriven()||"model-color"!==d&&"model-color-mix-intensity"!==d&&"model-rotation"!==d&&"model-scale"!==d&&"model-translation"!==d&&"model-emissive-strength"!==d)}_isPropertyZoomDependent(d){const o=this._transitionablePaint._values[d];return null!=o&&null!=o.value&&null!=o.value.expression&&o.value.expression instanceof Kc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends ds{constructor(d,o,l,u){super(d,{layout:$T||($T=new Pr({"clip-layer-types":new wt(Ge.layout_clip["clip-layer-types"]),"clip-layer-scope":new wt(Ge.layout_clip["clip-layer-scope"])})),paint:Iw||(Iw=new Pr({}))},o,l,u)}recalculate(d,o){super.recalculate(d,o)}createBucket(d){return new sd(d)}isTileClipped(){return!0}is3D(){return!0}}};class f1{constructor(o){this._callback=o,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class dA{constructor(){this.tasks={},this.taskQueue=[],Vh(["process"],this),this.invoker=new f1(this.process),this.nextId=0}add(o,l){const u=this.nextId++,_=function({type:p,isSymbolTile:y,zoom:T}){return T=T||0,"message"===p?0:"maybePrepare"!==p||y?"parseTile"!==p||y?"parseTile"===p&&y?300-T:"maybePrepare"===p&&y?400-T:500:200-T:100-T}(l);if(0===_){try{o()}finally{}return null}return this.tasks[u]={fn:o,metadata:l,priority:_,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const o=this.pick();if(null===o)return;const l=this.tasks[o];if(delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let o=null,l=1/0;for(let _=0;_<this.taskQueue.length;_++){const p=this.tasks[this.taskQueue[_]];p.priority<l&&(l=p.priority,o=_)}if(null===o)return null;const u=this.taskQueue[o];return this.taskQueue.splice(o,1),u}remove(){this.invoker.remove()}}class p1{constructor(o,l,u){this.target=o,this.parent=l,this.mapId=u,this.callbacks={},this.cancelCallbacks={},Vh(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new dA}send(o,l,u,_,p=!1,y){const T=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=y,this.callbacks[T]=u);const E=new Set;return this.target.postMessage({id:T,type:o,hasCallback:!!u,targetMapId:_,mustQueue:p,sourceMapId:this.mapId,data:ju(l,E)},E),{cancel:()=>{u&&delete this.callbacks[T],this.target.postMessage({id:T,type:"<cancel>",targetMapId:_,sourceMapId:this.mapId})}}}receive(o){const l=o.data,u=l.id;if(u&&(!l.targetMapId||this.mapId===l.targetMapId))if("<cancel>"===l.type){const _=this.cancelCallbacks[u];delete this.cancelCallbacks[u],_&&_.cancel()}else if(l.mustQueue||kl()){const _=this.callbacks[u],p=this.scheduler.add(()=>this.processTask(u,l),_&&_.metadata||{type:"message"});p&&(this.cancelCallbacks[u]=p)}else this.processTask(u,l)}processTask(o,l){if(delete this.cancelCallbacks[o],"<response>"===l.type){const u=this.callbacks[o];delete this.callbacks[o],u&&(l.error?u(Qc(l.error)):u(null,Qc(l.data)))}else{const u=new Set,_=l.hasCallback?(y,T)=>{this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:y?ju(y):null,data:ju(T,u)},u)}:()=>{},p=Qc(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,p,_);else if(this.parent.getWorkerSource){const y=l.type.split(".");this.parent.getWorkerSource(l.sourceMapId,y[0],p.source,p.scope)[y[1]](p,_)}else _(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var n_={workerUrl:"",workerClass:null,workerParams:void 0};const E0="mapboxgl_preloaded_worker_pool";let Of,ph,i_=(()=>{class d{constructor(){this.active={}}acquire(l,u=d.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<u;)this.workers.push(null!=n_.workerClass?new n_.workerClass:new self.Worker(n_.workerUrl,n_.workerParams));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.workers&&0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[E0]}numActive(){return Object.keys(this.active).length}}return d.workerCount=2,d})();class cm{constructor(o,l,u="Worker",_=i_.workerCount){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=Cu();const p=this.workerPool.acquire(this.id,_);for(let y=0;y<p.length;y++){const T=new cm.Actor(p[y],l,this.id);T.name=`${u} ${y}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,l,u){La(this.actors,(_,p)=>{_.send(o,l,p)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function av(){return Of||(Of=new i_),Of}cm.Actor=p1;const lv=new ki(0,0,0);var d,Ff=((d=Ff||{})[d.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",d[d.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",d[d.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",d),cv=(d=>(d[d.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",d[d.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",d[d.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",d[d.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",d))(cv||{}),dm=(d=>(d[d.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",d[d.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",d[d.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",d[d.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",d[d.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",d))(dm||{}),dv=(d=>(d[d.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",d[d.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",d[d.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",d))(dv||{}),r_=(d=>(d[d.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",d[d.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",d[d.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",d[d.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",d[d.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",d[d.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",d))(r_||{}),m1=(d=>(d[d.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",d[d.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",d[d.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",d))(m1||{});function uA(d,o,l){var u,_;1===d&&o.icons.push((u=l,_=l.readVarint()+l.pos,function(p){if(p.usvg_tree.height||(p.usvg_tree.height=p.usvg_tree.width),!p.metadata)return p;const{metadata:y}=p;if(y.content_area){const{content_area:T}=y;null==T.top&&(T.top=T.left),null==T.width&&(T.width=p.usvg_tree.width),null==T.height&&(T.height=T.width)}return y.stretch_x&&y.stretch_x.length&&WM(y,"x"),y.stretch_y&&y.stretch_y.length&&WM(y,"y"),p}(u.readFields(hA,{name:void 0},_))))}function WM(d,o){const l=[],u=d[`stretch_${o}`];let _=null;for(let p=0;p<u.length;p++)null===_?_=0===l.length?u[0]:l[l.length-1][1]+u[p]:(l.push([_,_+u[p]]),_=null);d[`stretch_${o}_areas`]=l}function hA(d,o,l){var u,_;1===d?o.name=l.readString():2===d?o.metadata=(u=l,_=l.readVarint()+l.pos,u.readFields(ZM,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},_)):3===d&&(o.usvg_tree=function(u,_){return u.readFields(XM,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},_)}(l,l.readVarint()+l.pos),o.data="usvg_tree")}function ZM(d,o,l){var u,_;1===d?o.stretch_x=l.readPackedVarint():2===d?o.stretch_y=l.readPackedVarint():3===d?o.content_area=(u=l,_=l.readVarint()+l.pos,u.readFields(YM,{left:0},_)):4===d&&o.variables.push(function(u,_){return u.readFields(fA,{name:void 0},_)}(l,l.readVarint()+l.pos))}function YM(d,o,l){1===d?o.left=l.readVarint():2===d?o.width=l.readVarint():3===d?o.top=l.readVarint():4===d&&(o.height=l.readVarint())}function fA(d,o,l){1===d?o.name=l.readString():2===d&&(o.rgb_color=k0(l.readVarint()),o.value="rgb_color")}function XM(d,o,l){var u,_;1===d?o.width=o.height=l.readVarint():2===d?o.height=l.readVarint():3===d?o.children.push(D0(l,l.readVarint()+l.pos)):4===d?o.linear_gradients.push((u=l,_=l.readVarint()+l.pos,u.readFields(_A,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},_))):5===d?o.radial_gradients.push(function(u,_){return u.readFields(yA,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},_)}(l,l.readVarint()+l.pos)):7===d?o.clip_paths.push(function(u,_){return u.readFields(vA,{children:[]},_)}(l,l.readVarint()+l.pos)):8===d&&o.masks.push(function(u,_){const p=u.readFields(bA,{left:0,width:20,mask_type:1,children:[]},_);return null==p.height&&(p.height=p.width),null==p.top&&(p.top=p.left),p}(l,l.readVarint()+l.pos))}function D0(d,o){return d.readFields(g1,{},o)}function g1(d,o,l){var u,_;1===d?(o.group=(u=l,_=l.readVarint()+l.pos,u.readFields(pA,{opacity:255,children:[]},_)),o.node="group"):2===d&&(o.path=function(u,_){return u.readFields(mA,{paint_order:1,commands:[],step:1,diffs:[],rule:1},_)}(l,l.readVarint()+l.pos),o.node="path")}function pA(d,o,l){1===d?o.transform=I0(l,l.readVarint()+l.pos):2===d?o.opacity=l.readVarint():5===d?o.clip_path_idx=l.readVarint():6===d?o.mask_idx=l.readVarint():7===d&&o.children.push(D0(l,l.readVarint()+l.pos))}function I0(d,o){return d.readFields(ld,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},o)}function ld(d,o,l){1===d?o.sx=l.readFloat():2===d?o.ky=l.readFloat():3===d?o.kx=l.readFloat():4===d?o.sy=l.readFloat():5===d?o.tx=l.readFloat():6===d&&(o.ty=l.readFloat())}function mA(d,o,l){var u,_;1===d?o.fill=(u=l,_=l.readVarint()+l.pos,u.readFields(KM,{rgb_color:lv,paint:"rgb_color",opacity:255},_)):2===d?o.stroke=function(u,_){return u.readFields(gA,{rgb_color:lv,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},_)}(l,l.readVarint()+l.pos):3===d?o.paint_order=l.readVarint():5===d?l.readPackedVarint(o.commands):6===d?o.step=l.readFloat():7===d?l.readPackedSVarint(o.diffs):8===d&&(o.rule=l.readVarint())}function KM(d,o,l){1===d?(o.rgb_color=k0(l.readVarint()),o.paint="rgb_color"):2===d?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):3===d?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):5===d&&(o.opacity=l.readVarint())}function k0(d){return new ki((d>>16&255)/255,(d>>8&255)/255,(255&d)/255,1)}function gA(d,o,l){1===d?(o.rgb_color=k0(l.readVarint()),o.paint="rgb_color"):2===d?(o.linear_gradient_idx=l.readVarint(),o.paint="linear_gradient_idx"):3===d?(o.radial_gradient_idx=l.readVarint(),o.paint="radial_gradient_idx"):5===d?l.readPackedFloat(o.dasharray):6===d?o.dashoffset=l.readFloat():7===d?o.miterlimit=l.readFloat():8===d?o.opacity=l.readVarint():9===d?o.width=l.readFloat():10===d?o.linecap=l.readVarint():11===d&&(o.linejoin=l.readVarint())}function _A(d,o,l){1===d?o.transform=I0(l,l.readVarint()+l.pos):2===d?o.spread_method=l.readVarint():3===d?o.stops.push(QM(l,l.readVarint()+l.pos)):4===d?o.x1=l.readFloat():5===d?o.y1=l.readFloat():6===d?o.x2=l.readFloat():7===d&&(o.y2=l.readFloat())}function QM(d,o){return d.readFields(JM,{offset:0,opacity:255,rgb_color:lv},o)}function JM(d,o,l){1===d?o.offset=l.readFloat():2===d?o.opacity=l.readVarint():3===d&&(o.rgb_color=k0(l.readVarint()))}function yA(d,o,l){1===d?o.transform=I0(l,l.readVarint()+l.pos):2===d?o.spread_method=l.readVarint():3===d?o.stops.push(QM(l,l.readVarint()+l.pos)):4===d?o.cx=l.readFloat():5===d?o.cy=l.readFloat():6===d?o.r=l.readFloat():7===d?o.fx=l.readFloat():8===d?o.fy=l.readFloat():9===d&&(o.fr=l.readFloat())}function vA(d,o,l){1===d?o.transform=I0(l,l.readVarint()+l.pos):2===d?o.clip_path_idx=l.readVarint():3===d&&o.children.push(D0(l,l.readVarint()+l.pos))}function bA(d,o,l){1===d?o.left=o.top=l.readFloat():2===d?o.width=o.height=l.readFloat():3===d?o.top=l.readFloat():4===d?o.height=l.readFloat():5===d?o.mask_type=l.readVarint():6===d?o.mask_idx=l.readVarint():7===d&&o.children.push(D0(l,l.readVarint()+l.pos))}class Vi{static calculate(o,l){const u=new Map,_=new Map;if(0===Object.keys(o).length)return u;l.forEach(p=>{_.set(p.name,p.rgb_color||new ki(0,0,0))});for(const[p,y]of Object.entries(o))_.has(p)?u.set(_.get(p).toStringPremultipliedAlpha(),y):console.warn(`Ignoring unknown image variable "${p}"`);return u}}function Ze(d,o=255,l){const u=o/255,_=d.toStringPremultipliedAlpha(),p=l.has(_)?l.get(_).clone():d.clone();return p.a=u,p.toString()}function A0(d,o){if(!xt()){const l=document.createElement("canvas");return l.width=d,l.height=o,l}return new OffscreenCanvas(d,o)}function Rt(d,o){const l=Vi.calculate(o.params,d.metadata?d.metadata.variables:[]),u=d.usvg_tree,_=u.width,p=u.height,y=o.transform?o.transform:new DOMMatrix,T=Math.max(1,Math.round(_*y.a)),E=Math.max(1,Math.round(p*y.d)),R=new DOMMatrix([T/_,0,0,E/p,0,0]),w=A0(T,E).getContext("2d");return R0(w,R,u,u,l),w.getImageData(0,0,T,E)}function R0(d,o,l,u,_){for(const p of u.children)_1(d,o,l,p,_)}function _1(d,o,l,u,_){u.group?(d.save(),function(p,y,T,E,R){const w=null!=E.mask_idx?T.masks[E.mask_idx]:null,D=null!=E.clip_path_idx?T.clip_paths[E.clip_path_idx]:null;if(E.transform&&(y=um(E.transform).preMultiplySelf(y)),255===E.opacity&&!(null!=D)&&!(null!=w))return void R0(p,y,T,E,R);const k=A0(p.canvas.width,p.canvas.height),S=k.getContext("2d");D&&s_(S,y,T,D),R0(S,y,T,E,R),w&&y1(S,y,T,w,R),p.globalAlpha=E.opacity/255,p.drawImage(k,0,0)}(d,o,l,u.group,_),d.restore()):u.path&&(d.save(),function(p,y,T,E,R){const w=O0(E);p.setTransform(y),E.paint_order===dv.PAINT_ORDER_FILL_AND_STROKE?(eS(p,T,E,w,R),o_(p,T,E,w,R)):(o_(p,T,E,w,R),eS(p,T,E,w,R))}(d,o,l,u.path,_),d.restore())}function eS(d,o,l,u,_){const p=l.fill;if(!p)return;const y=p.opacity/255;switch(p.paint){case"rgb_color":d.fillStyle=Ze(p.rgb_color,p.opacity,_);break;case"linear_gradient_idx":d.fillStyle=Lf(d,o.linear_gradients[p.linear_gradient_idx],y,_);break;case"radial_gradient_idx":d.fillStyle=P0(d,o.radial_gradients[p.radial_gradient_idx],y,_)}let T;switch(l.rule){case Ff.PATH_RULE_NON_ZERO:T="nonzero";break;case Ff.PATH_RULE_EVEN_ODD:T="evenodd"}d.fill(u,T)}function o_(d,o,l,u,_){const p=l.stroke;if(!p)return;d.lineWidth=p.width,d.miterLimit=p.miterlimit,d.setLineDash(p.dasharray),d.lineDashOffset=p.dashoffset;const y=p.opacity/255;switch(p.paint){case"rgb_color":d.strokeStyle=Ze(p.rgb_color,p.opacity,_);break;case"linear_gradient_idx":d.strokeStyle=Lf(d,o.linear_gradients[p.linear_gradient_idx],y,_);break;case"radial_gradient_idx":d.strokeStyle=P0(d,o.radial_gradients[p.radial_gradient_idx],y,_)}switch(p.linejoin){case dm.LINE_JOIN_MITER_CLIP:case dm.LINE_JOIN_MITER:d.lineJoin="miter";break;case dm.LINE_JOIN_ROUND:d.lineJoin="round";break;case dm.LINE_JOIN_BEVEL:d.lineJoin="bevel"}switch(p.linecap){case cv.LINE_CAP_BUTT:d.lineCap="butt";break;case cv.LINE_CAP_ROUND:d.lineCap="round";break;case cv.LINE_CAP_SQUARE:d.lineCap="square"}d.stroke(u)}function Lf(d,o,l,u){if(1===o.stops.length){const k=o.stops[0];return Ze(k.rgb_color,k.opacity*l,u)}const _=um(o.transform),{x1:p,y1:y,x2:T,y2:E}=o,R=_.transformPoint(new DOMPoint(p,y)),w=_.transformPoint(new DOMPoint(T,E)),D=d.createLinearGradient(R.x,R.y,w.x,w.y);for(const k of o.stops)D.addColorStop(k.offset,Ze(k.rgb_color,k.opacity*l,u));return D}function P0(d,o,l,u){if(1===o.stops.length){const k=o.stops[0];return Ze(k.rgb_color,k.opacity*l,u)}const _=um(o.transform),{fx:p,fy:y,cx:T,cy:E}=o,R=_.transformPoint(new DOMPoint(p,y)),w=_.transformPoint(new DOMPoint(T,E)),D=d.createRadialGradient(R.x,R.y,0,w.x,w.y,o.r*((_.a+_.d)/2));for(const k of o.stops)D.addColorStop(k.offset,Ze(k.rgb_color,k.opacity*l,u));return D}function s_(d,o,l,u){const _=um(u.transform).preMultiplySelf(o),p=null!=u.clip_path_idx?l.clip_paths[u.clip_path_idx]:null;p&&s_(d,_,l,p);const y=new Path2D;let T;function E(R,w){if(R.path){const D=R.path;y.addPath(O0(D),w),D.rule===Ff.PATH_RULE_EVEN_ODD&&(T="evenodd")}else if(R.group){const D=R.group.transform?um(R.group.transform).preMultiplySelf(w):w;for(const k of R.group.children)E(k,D)}}for(const R of u.children)E(R,_);d.clip(y,T)}function y1(d,o,l,u,_){if(0===u.children.length)return;const p=null!=u.mask_idx?l.masks[u.mask_idx]:null;p&&y1(d,o,l,p,_);const y=d.canvas.width,T=d.canvas.height,E=A0(y,T),R=E.getContext("2d"),w=u.width,D=u.height,k=u.left,S=u.top,I=new Path2D,O=new Path2D;O.rect(k,S,w,D),I.addPath(O,o),R.clip(I);for(const q of u.children)_1(R,o,l,q,_);const B=R.getImageData(0,0,y,T),U=B.data;if(u.mask_type===m1.MASK_TYPE_LUMINANCE)for(let q=0;q<U.length;q+=4)U[q+3]=U[q+3]/255*(.2126*U[q]+.7152*U[q+1]+.0722*U[q+2]);R.putImageData(B,0,0),d.globalCompositeOperation="destination-in",d.drawImage(E,0,0)}function um(d){return d?new DOMMatrix([d.sx,d.ky,d.kx,d.sy,d.tx,d.ty]):new DOMMatrix}function O0(d){const o=new Path2D,l=d.step;let u=d.diffs[0]*l,_=d.diffs[1]*l;o.moveTo(u,_);for(let p=0,y=2;p<d.commands.length;p++)switch(d.commands[p]){case r_.PATH_COMMAND_MOVE:u+=d.diffs[y++]*l,_+=d.diffs[y++]*l,o.moveTo(u,_);break;case r_.PATH_COMMAND_LINE:u+=d.diffs[y++]*l,_+=d.diffs[y++]*l,o.lineTo(u,_);break;case r_.PATH_COMMAND_QUAD:{const T=u+d.diffs[y++]*l,E=_+d.diffs[y++]*l;u=T+d.diffs[y++]*l,_=E+d.diffs[y++]*l,o.quadraticCurveTo(T,E,u,_);break}case r_.PATH_COMMAND_CUBIC:{const T=u+d.diffs[y++]*l,E=_+d.diffs[y++]*l,R=T+d.diffs[y++]*l,w=E+d.diffs[y++]*l;u=R+d.diffs[y++]*l,_=w+d.diffs[y++]*l,o.bezierCurveTo(T,E,R,w,u,_);break}case r_.PATH_COMMAND_CLOSE:o.closePath()}return o}class uv{constructor(o){this.capacity=o,this.cache=new Map}get(o){if(!this.cache.has(o))return;const l=this.cache.get(o);return this.cache.delete(o),this.cache.set(o,l),l}put(o,l){this.cache.has(o)?this.cache.delete(o):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(o,l)}delete(o){this.cache.delete(o)}}class hv{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(o){return new Nr(o,o.data)}getFromCache(o,l,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new uv(150)),this.cacheMap.get(u).get(Cs(o.serialize(),l))}setInCache(o,l,u,_){this.cacheDependenciesMap.has(_)||this.cacheDependenciesMap.set(_,new Map),this.cacheMap.has(_)||this.cacheMap.set(_,new uv(150));const p=this.cacheDependenciesMap.get(_);p.get(Cs(o.id,u))||p.set(Cs(o.id,u),new Set);const y=this.cacheMap.get(_),T=o.serialize();p.get(Cs(o.id,u)).add(T),y.put(Cs(o.serialize(),u),l)}removeImagesFromCacheByIds(o,l,u=""){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const _=this.cacheMap.get(u),p=this.cacheDependenciesMap.get(u);for(const y of o)if(p.has(Cs(y,l))){for(const T of p.get(Cs(y,l)))_.delete(T);p.delete(Cs(y,l))}}rasterize(o,l,u,_,p=Rt){const y=this.getFromCache(o,u,_);if(y)return y.clone();const T=p(l.icon,o.options),E=hv._getImage(T);return this.setInCache(o,E,u,_),E.clone()}}class F0{constructor(o){this.size=o,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(o,l){const u=this.toIdx(o,l);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(o,l){return this.leaves[this.toIdx(o,l)]}toIdx(o,l){return l*this.size+o}}function tS(d,o,l,u){let _=0,p=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(u[y])<1e-15){if(l[y]<d[y]||l[y]>o[y])return null}else{const T=1/u[y];let E=(d[y]-l[y])*T,R=(o[y]-l[y])*T;if(E>R){const w=E;E=R,R=w}if(E>_&&(_=E),R<p&&(p=R),_>p)return null}return _}function nS(d,o,l,u,_,p,y,T,E,R,w){const D=u-d,k=_-o,S=p-l,I=y-d,O=T-o,B=E-l,U=w[1]*B-w[2]*O,q=w[2]*I-w[0]*B,Z=w[0]*O-w[1]*I,$=D*U+k*q+S*Z;if(Math.abs($)<1e-15)return null;const Y=1/$,K=R[0]-d,ee=R[1]-o,ue=R[2]-l,de=(K*U+ee*q+ue*Z)*Y;if(de<0||de>1)return null;const ce=ee*S-ue*k,we=ue*D-K*S,fe=K*k-ee*D,Te=(w[0]*ce+w[1]*we+w[2]*fe)*Y;return Te<0||de+Te>1?null:(I*ce+O*we+B*fe)*Y}function iS(d,o,l){return(d-o)/(l-o)}function v1(d,o,l,u,_,p,y,T,E){const R=1<<l,w=p-u,D=y-_,k=(d+1)/R*w+u,S=(o+0)/R*D+_,I=(o+1)/R*D+_;T[0]=(d+0)/R*w+u,T[1]=S,E[0]=k,E[1]=I}class rS{constructor(o){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=o,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(p){const y=Math.ceil(Math.log2(p.dim/8)),T=[];let E=Math.ceil(Math.pow(2,y));const R=1/E,w=(S,I,O,B,U)=>{const q=B?1:0,Z=(S+1)*O-q,$=I*O,Y=(I+1)*O-q;U[0]=S*O,U[1]=$,U[2]=Z,U[3]=Y};let D=new F0(E);const k=[];for(let S=0;S<E*E;S++){w(S%E,Math.floor(S/E),R,!1,k);const I=Nf(k[0],k[1],p),O=Nf(k[2],k[1],p),B=Nf(k[2],k[3],p),U=Nf(k[0],k[3],p);D.minimums.push(Math.min(I,O,B,U)),D.maximums.push(Math.max(I,O,B,U)),D.leaves.push(1)}for(T.push(D),E/=2;E>=1;E/=2){const S=T[T.length-1];D=new F0(E);for(let I=0;I<E*E;I++){w(I%E,Math.floor(I/E),2,!0,k);const O=S.getElevation(k[0],k[1]),B=S.getElevation(k[2],k[1]),U=S.getElevation(k[2],k[3]),q=S.getElevation(k[0],k[3]),Z=S.isLeaf(k[0],k[1]),$=S.isLeaf(k[2],k[1]),Y=S.isLeaf(k[2],k[3]),K=S.isLeaf(k[0],k[3]),ee=Math.min(O.min,B.min,U.min,q.min),ue=Math.max(O.max,B.max,U.max,q.max),de=Z&&$&&Y&&K;D.maximums.push(ue),D.minimums.push(ee),D.leaves.push(ue-ee<=5&&de?1:0)}T.push(D)}return T}(this.dem),u=l.length-1,_=l[u];this._addNode(_.minimums[0],_.maximums[0],_.leaves[0]),this._construct(l,0,0,u,0)}raycastRoot(o,l,u,_,p,y,T=1){return tS([o,l,-100],[u,_,this.maximums[0]*T],p,y)}raycast(o,l,u,_,p,y,T=1){if(!this.nodeCount)return null;const E=this.raycastRoot(o,l,u,_,p,y,T);if(null==E)return null;const R=[],w=[],D=[],k=[],S=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;S.length>0;){const{idx:I,t:O,nodex:B,nodey:U,depth:q}=S.pop();if(this.leaves[I]){v1(B,U,q,o,l,u,_,D,k);const $=1<<q,Y=(B+0)/$,K=(B+1)/$,ee=(U+0)/$,ue=(U+1)/$,de=Nf(Y,ee,this.dem)*T,ce=Nf(K,ee,this.dem)*T,we=Nf(K,ue,this.dem)*T,fe=Nf(Y,ue,this.dem)*T,Te=nS(D[0],D[1],de,k[0],D[1],ce,k[0],k[1],we,p,y),ke=nS(k[0],k[1],we,D[0],k[1],fe,D[0],D[1],de,p,y),De=Math.min(null!==Te?Te:Number.MAX_VALUE,null!==ke?ke:Number.MAX_VALUE);if(De!==Number.MAX_VALUE)return De;{const Pe=Oe.vec3.scaleAndAdd([],p,y,O);if(oS(de,ce,fe,we,iS(Pe[0],D[0],k[0]),iS(Pe[1],D[1],k[1]))>=Pe[2])return O}continue}let Z=0;for(let $=0;$<this._siblingOffset.length;$++){v1((B<<1)+this._siblingOffset[$][0],(U<<1)+this._siblingOffset[$][1],q+1,o,l,u,_,D,k),D[2]=-100,k[2]=this.maximums[this.childOffsets[I]+$]*T;const Y=tS(D,k,p,y);if(null!=Y){const K=Y;R[$]=K;let ee=!1;for(let ue=0;ue<Z&&!ee;ue++)K>=R[w[ue]]&&(w.splice(ue,0,$),ee=!0);ee||(w[Z]=$),Z++}}for(let $=0;$<Z;$++){const Y=w[$];S.push({idx:this.childOffsets[I]+Y,t:R[Y],nodex:(B<<1)+this._siblingOffset[Y][0],nodey:(U<<1)+this._siblingOffset[Y][1],depth:q+1})}}return null}_addNode(o,l,u){return this.minimums.push(o),this.maximums.push(l),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(o,l,u,_,p){if(1===o[_].isLeaf(l,u))return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const y=_-1,T=o[y];let E=0,R=0;for(let w=0;w<this._siblingOffset.length;w++){const D=2*l+this._siblingOffset[w][0],k=2*u+this._siblingOffset[w][1],S=T.getElevation(D,k),I=T.isLeaf(D,k),O=this._addNode(S.min,S.max,I);I&&(E|=1<<w),R||(R=O)}for(let w=0;w<this._siblingOffset.length;w++)E&1<<w||this._construct(o,2*l+this._siblingOffset[w][0],2*u+this._siblingOffset[w][1],y,R+w)}}function oS(d,o,l,u,_,p){return Lt(Lt(d,l,p),Lt(o,u,p),_)}function Nf(d,o,l){const u=l.dim,_=En(d*u-.5,0,u-1),p=En(o*u-.5,0,u-1),y=Math.floor(_),T=Math.floor(p),E=Math.min(y+1,u-1),R=Math.min(T+1,u-1);return oS(l.get(y,T),l.get(E,T),l.get(y,R),l.get(E,R),_-y,p-T)}const xA={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function sS(d,o,l){return(256*d*256+256*o+l)/10-1e4}function aS(d,o,l){return 256*d+o+l/256-32768}class L0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(o,l,u,_=!1){if(this.uid=o,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(u&&"mapbox"!==u&&"terrarium"!==u)return void Yn(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const p=this.dim=l.height-2,y=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=_,this._modifiedForSources={},!_){for(let E=0;E<p;E++)y[this._idx(-1,E)]=y[this._idx(0,E)],y[this._idx(p,E)]=y[this._idx(p-1,E)],y[this._idx(E,-1)]=y[this._idx(E,0)],y[this._idx(E,p)]=y[this._idx(E,p-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(p,-1)]=y[this._idx(p-1,0)],y[this._idx(-1,p)]=y[this._idx(0,p-1)],y[this._idx(p,p)]=y[this._idx(p-1,p-1)]}const T="terrarium"===u?aS:sS;for(let E=0;E<y.length;++E){const R=4*E;this.floatView[E]=T(this.pixels[R],this.pixels[R+1],this.pixels[R+2])}this._timestamp=Tt.now()}_buildQuadTree(){this._tree=new rS(this)}get(o,l,u=!1){u&&(o=En(o,-1,this.dim),l=En(l,-1,this.dim));const _=this._idx(o,l);return this.floatView[_]}set(o,l,u){const _=this._idx(o,l),p=this.floatView[_];return this.floatView[_]=u,u-p}static getUnpackVector(o){return xA[o]}_idx(o,l){if(o<-1||o>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(o+1)}static pack(o,l){const u=[0,0,0,0],_=L0.getUnpackVector(l);let p=Math.floor((o+_[3])/_[2]);return u[2]=p%256,p=Math.floor(p/256),u[1]=p%256,p=Math.floor(p/256),u[0]=p,u}getPixels(){return new Lb({width:this.stride,height:this.stride},this.pixels)}backfillBorder(o,l,u){if(this.dim!==o.dim)throw new Error("dem dimension mismatch");let _=l*this.dim,p=l*this.dim+this.dim,y=u*this.dim,T=u*this.dim+this.dim;switch(l){case-1:_=p-1;break;case 1:p=_+1}switch(u){case-1:y=T-1;break;case 1:T=y+1}const E=-l*this.dim,R=-u*this.dim;for(let w=y;w<T;w++)for(let D=_;D<p;D++){const k=4*this._idx(D,w),S=4*this._idx(D+E,w+R);this.pixels[k+0]=o.pixels[S+0],this.pixels[k+1]=o.pixels[S+1],this.pixels[k+2]=o.pixels[S+2],this.pixels[k+3]=o.pixels[S+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function wA(d,o,l){var u,_;1===d?o.headerLength=l.readFixed32():2===d?o.x=l.readVarint():3===d?o.y=l.readVarint():4===d?o.z=l.readVarint():5===d&&o.layers.push((u=l,_=l.readVarint()+l.pos,u.readFields(b1,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},_)))}function yl(d,o,l){var u,_;1===d?(o.delta_filter=(u=l,_=l.readVarint()+l.pos,u.readFields(CA,{blockSize:0},_)),o.filter="delta_filter"):2===d?(l.readVarint(),o.filter="zigzag_filter"):3===d?(l.readVarint(),o.filter="bitshuffle_filter"):4===d&&(l.readVarint(),o.filter="byteshuffle_filter")}function CA(d,o,l){1===d&&(o.blockSize=l.readVarint())}function TA(d,o,l){1===d?(l.readVarint(),o.codec="gzip_data"):2===d?(l.readVarint(),o.codec="jpeg_image"):3===d?(l.readVarint(),o.codec="webp_image"):4===d&&(l.readVarint(),o.codec="png_image")}function tN(d,o,l){let u=0,_=0;var p,y;1===d?o.firstByte=l.readFixed64():2===d?o.lastByte=l.readFixed64():3===d?o.filters.push((p=l,y=l.readVarint()+l.pos,p.readFields(yl,{},y))):4===d?o.codec=function(p,y){return p.readFields(TA,{},y)}(l,l.readVarint()+l.pos):5===d?_=l.readFloat():6===d?u=l.readFloat():7===d?o.bands.push(l.readString()):8===d?o.offset=l.readDouble():9===d&&(o.scale=l.readDouble()),0===o.offset&&(o.offset=_),0===o.scale&&(o.scale=u)}function b1(d,o,l){var u,_;1===d?o.version=l.readVarint():2===d?o.name=l.readString():3===d?o.units=l.readString():4===d?o.tileSize=l.readVarint():5===d?o.buffer=l.readVarint():6===d?o.pixelFormat=l.readVarint():7===d&&o.dataIndex.push((u=l,_=l.readVarint()+l.pos,u.readFields(tN,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},_)))}function lS(d,o,l){if(2===d)u=l,_=l.readVarint()+l.pos,u.readFields(MA,o,_);else if(3===d)throw new Error("Not implemented");var u,_}function MA(d,o,l){if(1===d){let u=0;const _=l.readVarint()+l.pos;for(;l.pos<_;)o[u++]=l.readVarint()}}function SA(d,o){if(4!==o.length)throw new Error(`Expected data of dimension 4 but got ${o.length}.`);let l=o[3];for(let u=2;u>=1;u--){const _=1===u?1:0,p=2===u?1:0;for(let y=0;y<o[0];y++){const T=o[1]*y;for(let E=_;E<o[1];E++){const R=o[2]*(E+T);for(let w=p;w<o[2];w++){const D=o[3]*(w+R);for(let k=0;k<o[3];k++){const S=D+k;d[S]+=d[S-l]}}}}l*=o[u]}return d}function EA(d){for(let o=0,l=d.length;o<l;o++)d[o]=d[o]>>>1^-(1&d[o]);return d}function cS(d,o){switch(o){case"uint32":return d;case"uint16":for(let l=0;l<d.length;l+=2){const u=d[l],_=d[l+1];d[l]=(240&u)>>4|(61440&u)>>8|(240&_)<<4|61440&_,d[l+1]=15&u|(3840&u)>>4|(15&_)<<8|(3840&_)<<4}return d;case"uint8":for(let l=0;l<d.length;l+=4){const u=d[l],_=d[l+1],p=d[l+2],y=d[l+3];d[l+0]=(192&u)>>6|(192&_)>>4|(192&p)>>2|192&y,d[l+1]=(48&u)>>4|(48&_)>>2|48&p|(48&y)<<2,d[l+2]=(12&u)>>2|12&_|(12&p)<<2|(12&y)<<4,d[l+3]=3&u|(3&_)<<2|(3&p)<<4|(3&y)<<6}return d;default:throw new Error(`Invalid pixel format, "${o}"`)}}Zt(L0,"DEMData"),Zt(rS,"DemMinMaxQuadTree",{omit:["dem"]});var Zl=Uint8Array,fv=Uint16Array,x1=Int32Array,dS=new Zl([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),uS=new Zl([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),DA=new Zl([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),hS=function(d,o){for(var l=new fv(31),u=0;u<31;++u)l[u]=o+=1<<d[u-1];var _=new x1(l[30]);for(u=1;u<30;++u)for(var p=l[u];p<l[u+1];++p)_[p]=p-l[u]<<5|u;return{b:l,r:_}},N0=hS(dS,2),fS=N0.b,tu=N0.r;fS[28]=258,tu[258]=28;for(var w1=hS(uS,0).b,pS=new fv(32768),yo=0;yo<32768;++yo){var hm=(43690&yo)>>1|(21845&yo)<<1;pS[yo]=((65280&(hm=(61680&(hm=(52428&hm)>>2|(13107&hm)<<2))>>4|(3855&hm)<<4))>>8|(255&hm)<<8)>>1}var a_=function(d,o,l){for(var u=d.length,_=0,p=new fv(o);_<u;++_)d[_]&&++p[d[_]-1];var y,T=new fv(o);for(_=1;_<o;++_)T[_]=T[_-1]+p[_-1]<<1;y=new fv(1<<o);var E=15-o;for(_=0;_<u;++_)if(d[_])for(var R=_<<4|d[_],w=o-d[_],D=T[d[_]-1]++<<w,k=D|(1<<w)-1;D<=k;++D)y[pS[D]>>E]=R;return y},zf=new Zl(288);for(yo=0;yo<144;++yo)zf[yo]=8;for(yo=144;yo<256;++yo)zf[yo]=9;for(yo=256;yo<280;++yo)zf[yo]=7;for(yo=280;yo<288;++yo)zf[yo]=8;var z0=new Zl(32);for(yo=0;yo<32;++yo)z0[yo]=5;var nN=a_(zf,9),mS=a_(z0,5),B0=function(d){for(var o=d[0],l=1;l<d.length;++l)d[l]>o&&(o=d[l]);return o},Dc=function(d,o,l){var u=o/8|0;return(d[u]|d[u+1]<<8)>>(7&o)&l},l_=function(d,o){var l=o/8|0;return(d[l]|d[l+1]<<8|d[l+2]<<16)>>(7&o)},C1=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ds=function(d,o,l){var u=new Error(o||C1[d]);if(u.code=d,Error.captureStackTrace&&Error.captureStackTrace(u,Ds),!l)throw u;return u},IA=new Zl(0),kA=typeof TextDecoder<"u"&&new TextDecoder;try{kA.decode(IA,{stream:!0})}catch{}const V0={gzip_data:"gzip"};class Ic extends Error{constructor(o){super(o),this.name="MRTError"}}const c_={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},T1={uint32:1,uint16:2,uint8:4},fm={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let Bf;class pv{constructor(o=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=o}getLayer(o){const l=this.layers[o];if(!l)throw new Ic(`Layer '${o}' not found`);return l}getHeaderLength(o){const l=new Uint8Array(o),u=new DataView(o);if(13!==l[0])throw new Ic("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(o){const l=new Uint8Array(o),u=this.getHeaderLength(o);if(l.length<u)throw new Ic(`Expected header with length >= ${u} but got buffer of length ${l.length}`);const _=new Bf(l.subarray(0,u)).readFields(wA,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==_.x||this.y!==_.y||this.z!==_.z))throw new Ic(`Invalid attempt to parse header ${_.z}/${_.x}/${_.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=_.x,this.y=_.y,this.z=_.z;for(const p of _.layers)this.layers[p.name]=new mv(p,{cacheSize:this._cacheSize});return this}createDecodingTask(o){const l=[],u=this.getLayer(o.layerName);for(let _ of o.blockIndices){const p=u.dataIndex[_],y=p.firstByte-o.firstByte,T=p.lastByte-o.firstByte;if(u._blocksInProgress.has(_))continue;const E={layerName:u.name,firstByte:y,lastByte:T,pixelFormat:u.pixelFormat,blockIndex:_,blockShape:[p.bands.length].concat(u.bandShape),buffer:u.buffer,codec:p.codec.codec,filters:p.filters.map(R=>R.filter)};u._blocksInProgress.add(_),l.push(E)}return new U0(l,()=>{l.forEach(_=>u._blocksInProgress.delete(_.blockIndex))},(_,p)=>{if(l.forEach(y=>u._blocksInProgress.delete(y.blockIndex)),_)throw _;p.forEach(y=>{this.getLayer(y.layerName).processDecodedData(y)})})}}class mv{constructor({version:o,name:l,units:u,tileSize:_,pixelFormat:p,buffer:y,dataIndex:T},E){if(this.version=o,1!==this.version)throw new Ic(`Cannot parse raster layer encoded with MRT version ${o}`);this.name=l,this.units=u,this.tileSize=_,this.buffer=y,this.pixelFormat=c_[p],this.dataIndex=T,this.bandShape=[_+2*y,_+2*y,T1[this.pixelFormat]],this._decodedBlocks=new uv(E?E.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return T1[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:o})=>o).flat()}processDecodedData(o){const l=o.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,o.data)}getBlockForBand(o){let l=0;switch(typeof o){case"string":for(const[u,_]of this.dataIndex.entries()){for(const[p,y]of _.bands.entries())if(y===o)return{bandIndex:l+p,blockIndex:u,blockBandIndex:p};l+=_.bands.length}break;case"number":for(const[u,_]of this.dataIndex.entries()){if(o>=l&&o<l+_.bands.length)return{bandIndex:o,blockIndex:u,blockBandIndex:o-l};l+=_.bands.length}break;default:throw new Ic(`Invalid band \`${JSON.stringify(o)}\`. Expected string or integer.`)}throw new Ic(`Band not found: ${JSON.stringify(o)}`)}getDataRange(o){let l=1/0,u=-1/0;const _=[],p=new Set;for(const y of o){const{blockIndex:T}=this.getBlockForBand(y);if(T<0)throw new Ic(`Invalid band: ${JSON.stringify(y)}`);const E=this.dataIndex[T];_.includes(T)||_.push(T),p.add(T),l=Math.min(l,E.firstByte),u=Math.max(u,E.lastByte)}if(p.size>this.cacheSize)throw new Ic(`Number of blocks to decode (${p.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:u,blockIndices:_}}hasBand(o){const{blockIndex:l}=this.getBlockForBand(o);return l>=0}hasDataForBand(o){const{blockIndex:l}=this.getBlockForBand(o);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(o){const{blockIndex:l,blockBandIndex:u}=this.getBlockForBand(o),_=this._decodedBlocks.get(l.toString());if(!_)throw new Ic(`Data for band ${JSON.stringify(o)} of layer "${this.name}" not decoded.`);const p=this.dataIndex[l],y=this.bandShape.reduce((R,w)=>R*w,1),T=u*y,E=_.subarray(T,T+y);return{data:E,bytes:new Uint8Array(E.buffer).subarray(E.byteOffset,E.byteOffset+E.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:p.offset,scale:p.scale}}}pv.setPbf=function(d){Bf=d};class U0{constructor(o,l,u){this.tasks=o,this._onCancel=l,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(o,l){this._finalized||(this._onComplete(o,l),this._finalized=!0)}}pv.performDecoding=function(d,o){const l=new Uint8Array(d);return Promise.all(o.tasks.map(u=>{const{layerName:_,firstByte:p,lastByte:y,pixelFormat:T,blockShape:E,blockIndex:R,filters:w,codec:D}=u,k=l.subarray(p,y+1),S=new Uint32Array(E[0]*E[1]*E[2]);let I;if("gzip_data"!==D)throw new Ic(`Unhandled codec: ${D}`);return I=function(O,B){if(!globalThis.DecompressionStream&&"gzip_data"===B)return Promise.resolve((($=function(ee){31==ee[0]&&139==ee[1]&&8==ee[2]||Ds(6,"invalid gzip data");var ue=ee[3],de=10;4&ue&&(de+=2+(ee[10]|ee[11]<<8));for(var ce=(ue>>3&1)+(ue>>4&1);ce>0;ce-=!ee[de++]);return de+(2&ue)}(Z=O))+8>Z.length&&Ds(6,"invalid gzip data"),function(ee,ue,de){var we=ee.length;if(!we||ue.f&&!ue.l)return de||new Zl(0);var fe=!de,Te=fe||2!=ue.i,ke=ue.i;fe&&(de=new Zl(3*we));var De,Pe,Ne=function(dd){var ud=de.length;if(dd>ud){var gh=new Zl(Math.max(2*ud,dd));gh.set(de),de=gh}},je=ue.f||0,Le=ue.p||0,it=ue.b||0,_t=ue.l,rt=ue.d,Et=ue.m,St=ue.n,zt=8*we;do{if(!_t){je=Dc(ee,Le,1);var lt=Dc(ee,Le+1,3);if(Le+=3,!lt){var en=ee[(Cn=4+((Le+7)/8|0))-4]|ee[Cn-3]<<8,It=Cn+en;if(It>we){ke&&Ds(0);break}Te&&Ne(it+en),de.set(ee.subarray(Cn,It),it),ue.b=it+=en,ue.p=Le=8*It,ue.f=je;continue}if(1==lt)_t=nN,rt=mS,Et=9,St=5;else if(2==lt){var Xt=Dc(ee,Le,31)+257,dn=Dc(ee,Le+10,15)+4,On=Xt+Dc(ee,Le+5,31)+1;Le+=14;for(var Hn=new Zl(On),Qn=new Zl(19),$n=0;$n<dn;++$n)Qn[DA[$n]]=Dc(ee,Le+3*$n,7);Le+=3*dn;var di=B0(Qn),lr=(1<<di)-1,qi=a_(Qn,di);for($n=0;$n<On;){var Cn,Qi=qi[Dc(ee,Le,lr)];if(Le+=15&Qi,(Cn=Qi>>4)<16)Hn[$n++]=Cn;else{var Yi=0,Hi=0;for(16==Cn?(Hi=3+Dc(ee,Le,3),Le+=2,Yi=Hn[$n-1]):17==Cn?(Hi=3+Dc(ee,Le,7),Le+=3):18==Cn&&(Hi=11+Dc(ee,Le,127),Le+=7);Hi--;)Hn[$n++]=Yi}}var qr=Hn.subarray(0,Xt),ro=Hn.subarray(Xt);Et=B0(qr),St=B0(ro),_t=a_(qr,Et),rt=a_(ro,St)}else Ds(1);if(Le>zt){ke&&Ds(0);break}}Te&&Ne(it+131072);for(var Wr=(1<<Et)-1,Da=(1<<St)-1,cr=Le;;cr=Le){var Tr=(Yi=_t[l_(ee,Le)&Wr])>>4;if((Le+=15&Yi)>zt){ke&&Ds(0);break}if(Yi||Ds(2),Tr<256)de[it++]=Tr;else{if(256==Tr){cr=Le,_t=null;break}var da=Tr-254;Tr>264&&(da=Dc(ee,Le,(1<<(No=dS[$n=Tr-257]))-1)+fS[$n],Le+=No);var vo=rt[l_(ee,Le)&Da],qa=vo>>4;if(vo||Ds(3),Le+=15&vo,ro=w1[qa],qa>3){var No=uS[qa];ro+=l_(ee,Le)&(1<<No)-1,Le+=No}if(Le>zt){ke&&Ds(0);break}Te&&Ne(it+131072);var nu=it+da;if(it<ro){var mh=0-ro,Uf=Math.min(ro,nu);for(mh+it<0&&Ds(3);it<Uf;++it)de[it]=(void 0)[mh+it]}for(;it<nu;++it)de[it]=de[it-ro]}}ue.l=_t,ue.p=cr,ue.b=it,ue.f=je,_t&&(je=1,ue.m=Et,ue.d=rt,ue.n=St)}while(!je);return it!=de.length&&fe?(De=de,(null==(Pe=it)||Pe>De.length)&&(Pe=De.length),new Zl(De.subarray(0,Pe))):de.subarray(0,it)}(Z.subarray($,-8),{i:2},new Zl(((U=Z)[(q=U.length)-4]|U[q-3]<<8|U[q-2]<<16|U[q-1]<<24)>>>0))));var U,q,Z,$;const Y=V0[B];if(!Y)throw new Error(`Unhandled codec: ${B}`);const K=new globalThis.DecompressionStream(Y);return new Response(new Blob([O]).stream().pipeThrough(K)).arrayBuffer().then(ee=>new Uint8Array(ee))}(k,D).then(O=>(new Bf(O).readFields(lS,S),new fm[T](S.buffer))),I.then(O=>{for(let B=w.length-1;B>=0;B--)switch(w[B]){case"delta_filter":SA(O,E);break;case"zigzag_filter":EA(O);break;case"bitshuffle_filter":cS(O,T);break;default:throw new Ic(`Unhandled filter "${w[B]}"`)}return{layerName:_,blockIndex:R,data:O}}).catch(O=>{throw O})}))},Zt(U0,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let d_,M1,cd,u_,S1,h_=null;function gS(){return kl()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:M1||ge.DRACO_URL}function E1(){if(kl()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(u_)return u_;const d=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if("object"!=typeof WebAssembly)throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return u_=WebAssembly.validate(d)?ge.MESHOPT_SIMD_URL:ge.MESHOPT_URL,u_}const gv={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},AA={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Vf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function _S(d,o,l){const u=l.json.bufferViews.length,_=l.buffers.length;o.bufferView=u,l.json.bufferViews[u]={buffer:_,byteLength:d.byteLength},l.buffers[_]=d}const j0="KHR_draco_mesh_compression";function yS(d,o){const l=d.extensions&&d.extensions[j0];if(!l)return;const u=new cd.Decoder,_=f_(o,l.bufferView),p=new cd.Mesh;if(!u.DecodeArrayToMesh(_,_.byteLength,p))throw new Error("Failed to decode Draco mesh");const y=o.json.accessors[d.indices],T=gv[y.componentType],E=y.count*T.BYTES_PER_ELEMENT,R=cd._malloc(E);T===Uint16Array?u.GetTrianglesUInt16Array(p,E,R):u.GetTrianglesUInt32Array(p,E,R),_S(cd.memory.buffer.slice(R,R+E),y,o),cd._free(R);for(const w of Object.keys(l.attributes)){const D=u.GetAttributeByUniqueId(p,l.attributes[w]),k=o.json.accessors[d.attributes[w]],S=AA[k.componentType],I=k.count*Vf[k.type]*gv[k.componentType].BYTES_PER_ELEMENT,O=cd._malloc(I);u.GetAttributeDataArrayForAllPoints(p,D,cd[S],I,O),_S(cd.memory.buffer.slice(O,O+I),k,o),cd._free(O)}u.destroy(),p.destroy(),delete d.extensions[j0]}const _v="EXT_meshopt_compression";function RA(d,o){if(!d.extensions||!d.extensions[_v])return;const l=d.extensions[_v],u=new Uint8Array(o.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),_=new Uint8Array(l.count*l.byteStride);S1.decodeGltfBuffer(_,l.count,l.byteStride,u,l.mode,l.filter),d.buffer=o.buffers.length,d.byteOffset=0,o.buffers[d.buffer]=_.buffer,delete d.extensions[_v]}const vS=1179937895,D1=new TextDecoder("utf8");function H0(d,o){return new URL(d,o).href}function bS(d,o,l,u){return fetch(H0(d.uri,u)).then(_=>_.arrayBuffer()).then(_=>{o.buffers[l]=_})}function f_(d,o){const l=d.json.bufferViews[o];return new Uint8Array(d.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function yv(d,o,l,u){if(d.uri){const _=H0(d.uri,u);return fetch(_).then(p=>p.blob()).then(p=>createImageBitmap(p)).then(p=>{o.images[l]=p})}if(void 0!==d.bufferView){const _=f_(o,d.bufferView),p=new Blob([_],{type:d.mimeType});return createImageBitmap(p).then(y=>{o.images[l]=y})}}function Lo(d,o=0,l){const u={json:null,images:[],buffers:[]};if(new Uint32Array(d,o,1)[0]===vS){const w=new Uint32Array(d,o);let D=2;const k=(w[D++]>>2)-3,S=w[D++]>>2;if(D++,u.json=JSON.parse(D1.decode(w.subarray(D,D+S))),D+=S,D<k){const I=w[D++];D++;const O=o+(D<<2);u.buffers[0]=d.slice(O,O+I)}}else u.json=JSON.parse(D1.decode(new Uint8Array(d,o)));const{buffers:_,images:p,meshes:y,extensionsUsed:T,bufferViews:E}=u.json;let R=Promise.resolve();if(_){const w=[];for(let D=0;D<_.length;D++){const k=_[D];k.uri?w.push(bS(k,u,D,l)):u.buffers[D]||(u.buffers[D]=null)}R=Promise.all(w)}return R.then(()=>{const w=[],D=T&&T.includes(j0),k=T&&T.includes(_v);if(D&&w.push(function(){if(!cd)return d_??(d_=function(S){let I,O=null;function B(){I=new Uint8Array(O.buffer)}function U(){throw new Error("Unexpected Draco error.")}const q={a:{a:U,d:function(Z,$,Y){return I.copyWithin(Z,$,$+Y)},c:function(Z){const $=I.length,Y=Math.max(Z>>>0,Math.ceil(1.2*$)),K=Math.ceil((Y-$)/65536);try{return O.grow(K),B(),!0}catch{return!1}},b:U}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(S,q):S.then(Z=>Z.arrayBuffer()).then(Z=>WebAssembly.instantiate(Z,q))).then(Z=>{const{Rb:$,Qb:Y,P:K,T:ee,X:ue,Ja:de,La:ce,Qa:we,Va:fe,Wa:Te,eb:ke,jb:De,f:Pe,e:Ne,yb:je,zb:Le,Ab:it,Bb:_t,Db:rt,Gb:Et}=Z.instance.exports;O=Ne;const St=(()=>{let zt=0,lt=0,en=0,It=0;return Xt=>{en&&($(It),$(zt),lt+=en,en=zt=0),zt||(lt+=128,zt=Y(lt));const dn=Xt.length+7&-8;let On=zt;dn>=lt&&(en=dn,On=It=Y(dn));for(let Hn=0;Hn<Xt.length;Hn++)I[On+Hn]=Xt[Hn];return On}})();return B(),Pe(),{memory:Ne,_free:$,_malloc:Y,Mesh:class{constructor(){this.ptr=K()}destroy(){ee(this.ptr)}},Decoder:class{constructor(){this.ptr=de()}destroy(){De(this.ptr)}DecodeArrayToMesh(zt,lt,en){const It=St(zt),Xt=ce(this.ptr,It,lt,en.ptr);return!!ue(Xt)}GetAttributeByUniqueId(zt,lt){return{ptr:we(this.ptr,zt.ptr,lt)}}GetTrianglesUInt16Array(zt,lt,en){fe(this.ptr,zt.ptr,lt,en)}GetTrianglesUInt32Array(zt,lt,en){Te(this.ptr,zt.ptr,lt,en)}GetAttributeDataArrayForAllPoints(zt,lt,en,It,Xt){ke(this.ptr,zt.ptr,lt.ptr,en,It,Xt)}},DT_INT8:je(),DT_UINT8:Le(),DT_INT16:it(),DT_UINT16:_t(),DT_UINT32:rt(),DT_FLOAT32:Et()}})}(fetch(gS())),d_.then(S=>{cd=S,d_=void 0}))}()),k&&w.push(function(){if(S1)return;const S=function(I){let O;const B=WebAssembly.instantiateStreaming(I,{}).then(Z=>{O=Z.instance,O.exports.__wasm_call_ctors()}),U={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},q={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:B,supported:!0,decodeGltfBuffer(Z,$,Y,K,ee,ue){!function(de,ce,we,fe,Te,ke,De){const Pe=de.exports.sbrk,Ne=fe+3&-4,je=Pe(Ne*Te),Le=Pe(ke.length),it=new Uint8Array(de.exports.memory.buffer);it.set(ke,Le);const _t=ce(je,fe,Te,Le,ke.length);if(0===_t&&De&&De(je,Ne,Te),we.set(it.subarray(je,je+fe*Te)),Pe(je-Pe(0)),0!==_t)throw new Error(`Malformed buffer data: ${_t}`)}(O,O.exports[q[ee]],Z,$,Y,K,O.exports[U[ue]])}}}(fetch(E1()));return S.ready.then(()=>{S1=S})}()),p)for(let S=0;S<p.length;S++)w.push(yv(p[S],u,S,l));return(w.length?Promise.all(w):Promise.resolve()).then(()=>{if(D&&y)for(const{primitives:S}of y)for(const I of S)yS(I,u);if(k&&y&&E)for(const S of E)RA(S,u);return u})})}function pm(d,o){const l=d.json.bufferViews[o.bufferView],u=gv[o.componentType];return new u(d.buffers[l.buffer],(o.byteOffset||0)+(l.byteOffset||0),o.count*(l.byteStride&&l.byteStride!==Vf[o.type]*u.BYTES_PER_ELEMENT?l.byteStride/u.BYTES_PER_ELEMENT:Vf[o.type]))}function I1(d,o,l,u){const _=gv[o.componentType],p=function(w){switch(w){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(_),y=d.json.bufferViews[o.bufferView],T=y.byteStride?y.byteStride/_.BYTES_PER_ELEMENT:Vf[o.type],E=l.float32,R=E.length/l.capacity;for(let w=0,D=0;w<o.count*T;w+=T,D+=R)for(let k=0;k<R;k++)E[D+k]=u[w+k]*p;l._trim()}function PA(d,o,l){const u=d.indices,_=d.attributes,p={};p.indexArray=new es;const y=o.json.accessors[u],T=y.count/3;p.indexArray.reserve(T);const E=pm(o,y);for(let k=0;k<T;k++)p.indexArray.emplaceBack(E[3*k],E[3*k+1],E[3*k+2]);p.indexArray._trim(),p.vertexArray=new jd;const R=o.json.accessors[_.POSITION];p.vertexArray.reserve(R.count);const w=pm(o,R);for(let k=0;k<R.count;k++)p.vertexArray.emplaceBack(w[3*k],w[3*k+1],w[3*k+2]);if(p.vertexArray._trim(),p.aabb=new gn(R.min,R.max),p.centroid=function(k,S){const I=[0,0,0],O=k.length;if(O>0){for(let B=0;B<O;B++){const U=3*k[B];I[0]+=S[U],I[1]+=S[U+1],I[2]+=S[U+2]}I[0]/=O,I[1]/=O,I[2]/=O}return I}(E,w),void 0!==_.COLOR_0){const k=o.json.accessors[_.COLOR_0],S=Vf[k.type],I=pm(o,k);p.colorArray=3===S?new jd:new ed,p.colorArray.resize(k.count),I1(o,k,p.colorArray,I)}if(void 0!==_.NORMAL){p.normalArray=new jd;const k=o.json.accessors[_.NORMAL];p.normalArray.resize(k.count);const S=pm(o,k);I1(o,k,p.normalArray,S)}if(void 0!==_.TEXCOORD_0&&l.length>0){p.texcoordArray=new bc;const k=o.json.accessors[_.TEXCOORD_0];p.texcoordArray.resize(k.count);const S=pm(o,k);I1(o,k,p.texcoordArray,S)}if(void 0!==_._FEATURE_ID_RGBA4444){const k=o.json.accessors[_._FEATURE_ID_RGBA4444];o.json.extensionsUsed&&o.json.extensionsUsed.includes("EXT_meshopt_compression")&&(p.featureData=pm(o,k))}void 0!==_._FEATURE_RGBA4444&&(p.featureData=new Uint32Array(pm(o,o.json.accessors[_._FEATURE_RGBA4444]).buffer));const D=d.material;return p.material=function(k,S){const{emissiveFactor:I=[0,0,0],alphaMode:O="OPAQUE",alphaCutoff:B=.5,normalTexture:U,occlusionTexture:q,emissiveTexture:Z,doubleSided:$}=k,{baseColorFactor:Y=[1,1,1,1],metallicFactor:K=1,roughnessFactor:ee=1,baseColorTexture:ue,metallicRoughnessTexture:de}=k.pbrMetallicRoughness||{},ce=q?S[q.index]:void 0;if(q&&q.extensions&&q.extensions.KHR_texture_transform&&ce){const we=q.extensions.KHR_texture_transform;ce.offsetScale=[we.offset[0],we.offset[1],we.scale[0],we.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new ki(...Y),metallicFactor:K,roughnessFactor:ee,baseColorTexture:ue?S[ue.index]:void 0,metallicRoughnessTexture:de?S[de.index]:void 0},doubleSided:$,emissiveFactor:I,alphaMode:O,alphaCutoff:B,normalTexture:U?S[U.index]:void 0,occlusionTexture:ce,emissionTexture:Z?S[Z.index]:void 0,defined:void 0===k.defined}}(void 0!==D?o.json.materials[D]:{defined:!1},l),p}function vv(d,o,l){const{matrix:u,rotation:_,translation:p,scale:y,mesh:T,extras:E,children:R}=d,w={};if(w.matrix=u||Oe.mat4.fromRotationTranslationScale([],_||[0,0,0,1],p||[0,0,0],y||[1,1,1]),void 0!==T){w.meshes=l[T];const D=w.anchor=[0,0];for(const k of w.meshes){const{min:S,max:I}=k.aabb;D[0]+=S[0]+I[0],D[1]+=S[1]+I[1]}D[0]=Math.floor(D[0]/w.meshes.length/2),D[1]=Math.floor(D[1]/w.meshes.length/2)}if(E&&(E.id&&(w.id=E.id),E.lights&&(w.lights=function(D){if(!D.length)return[];const k=function(U){const q=atob(U),Z=new Uint8Array(q.length);for(let $=0;$<q.length;$++)Z[$]=q.codePointAt($);return Z}(D),S=[],I=k.length/24,O=new Uint16Array(k.buffer),B=new Float32Array(k.buffer);for(let U=0;U<I;U++){const q=O[2*U*6]/30,Z=O[2*U*6+1]/30,$=O[2*U*6+10]/100,Y=B[6*U+1],K=B[6*U+2],ee=B[6*U+3],ue=B[6*U+4],de=ee-Y,ce=ue-K,we=Math.hypot(de,ce);S.push({pos:[Y+.5*de,K+.5*ce,Z],normal:[ce/we,-de/we,0],width:we,height:q,depth:$,points:[Y,K,ee,ue]})}return S}(E.lights))),R){const D=[];for(const k of R)D.push(vv(o.json.nodes[k],o,l));w.children=D}return w}function k1(d){if(0===d.vertices.length||0===d.indices.length)return null;const o=new My(d.vertices,d.indices,8,256),[l,u]=[o.min.clone(),o.max.clone()];return{vertices:d.vertices,indices:d.indices,grid:o,min:l,max:u}}function OA(d){if(!d.extras||!d.extras.ground)return null;const o=d.extras.ground;if(!o||!Array.isArray(o)||0===o.length)return null;const l=o[0];if(!l||!Array.isArray(l)||0===l.length)return null;const u=[];for(const y of l){if(!Array.isArray(y)||2!==y.length)continue;const T=y[0],E=y[1];"number"==typeof T&&"number"==typeof E&&u.push(new Ft(T,E))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let _=0;for(let y=0;y<u.length;y++){const T=u[y],E=u[(y+1)%u.length],R=u[(y+2)%u.length];_+=(T.x-E.x)*(R.y-E.y)-(R.x-E.x)*(T.y-E.y)}_>0&&u.reverse();const p=zb(u.flatMap(y=>[y.x,y.y]),[]);return 0===p.length?null:{vertices:u,indices:p}}function iN(d,o){const l=[],u=[];let _=0;const p=[];for(const y of d){_=l.length;const T=y.vertexArray.float32,E=y.indexArray.uint16;for(let R=0;R<y.vertexArray.length;R++)p[0]=T[3*R+0],p[1]=T[3*R+1],p[2]=T[3*R+2],Oe.vec3.transformMat4(p,p,o),l.push(new Ft(p[0],p[1]));for(let R=0;R<3*y.indexArray.length;R++)u.push(E[R]+_)}if(u.length%3!=0)return null;for(let y=0;y<u.length;y+=3){const T=l[u[y+0]],E=l[u[y+1]],R=l[u[y+2]];(T.x-E.x)*(R.y-E.y)-(R.x-E.x)*(T.y-E.y)>0&&([u[y+1],u[y+2]]=[u[y+2],u[y+1]])}return{vertices:l,indices:u}}function FA(d){const l=function(E,R){const w=[];for(const D of E.json.meshes){const k=[];for(const S of D.primitives)k.push(PA(S,E,R));w.push(k)}return w}(d,function(E,R){const w=[],D=WebGL2RenderingContext;if(E.json.textures)for(const k of E.json.textures){const S={magFilter:D.LINEAR,minFilter:D.NEAREST,wrapS:D.REPEAT,wrapT:D.REPEAT};void 0!==k.sampler&&Object.assign(S,E.json.samplers[k.sampler]),w.push({image:R[k.source],sampler:S,uploaded:!1})}return w}(d,d.images)),{scenes:u,scene:_,nodes:p}=d.json,y=u?u[_||0].nodes:p,T=[];for(const E of y)T.push(vv(p[E],d,l));return function(E,R,w){const D={},k=new Set;for(let S=0;S<E.length;S++){const I=w[R[S]];if(!I.extras)continue;const O=I.extras["mapbox:footprint:version"],B=I.extras["mapbox:footprint:id"];(O||B)&&k.add(S),"1.0.0"===O&&B&&(D[B]=S)}for(let S=0;S<E.length;S++){if(k.has(S))continue;const I=E[S],O=w[R[S]];if(!O.extras)continue;let B=null;I.id in D&&(B=iN(E[D[I.id]].meshes,I.matrix)),B||(B=OA(O)),B&&(I.footprint=k1(B))}if(k.size>0){const S=Array.from(k.values()).sort((I,O)=>I-O);for(let I=S.length-1;I>=0;I--)E.splice(S[I],1)}}(T,y,d.json.nodes),T}function LA(d){d.heightmap=new Float32Array(4096),d.heightmap.fill(-1);const o=d.vertexArray.float32,l=d.aabb.min[0]-1,u=d.aabb.min[1]-1,_=64/(d.aabb.max[0]-l+2),p=64/(d.aabb.max[1]-u+2);for(let y=0;y<o.length;y+=3){const T=o[y+2],E=(o[y+0]-l)*_|0,R=(o[y+1]-u)*p|0;T>d.heightmap[64*R+E]&&(d.heightmap[64*R+E]=T)}}function NA(d,o){const l={};l.indexArray=new es,l.indexArray.reserve(4*d.length),l.vertexArray=new jd,l.vertexArray.reserve(10*d.length),l.colorArray=new ed,l.vertexArray.reserve(10*d.length);let u=0;for(const y of d){const T=Math.min(10,Math.max(4,1.3*y.height))*o,E=[-y.normal[1],y.normal[0],0],R=Math.min(.29,.1*y.width/y.depth),w=y.width-2*y.depth*o*(R+.01),D=Oe.vec3.scaleAndAdd([],y.pos,E,w/2),k=Oe.vec3.scaleAndAdd([],y.pos,E,-w/2),S=[D[0],D[1],D[2]+y.height],I=[k[0],k[1],k[2]+y.height],O=Oe.vec3.scaleAndAdd([],y.normal,E,R);Oe.vec3.scale(O,O,T);const B=Oe.vec3.scaleAndAdd([],y.normal,E,-R);Oe.vec3.scale(B,B,T),Oe.vec3.add(O,D,O),Oe.vec3.add(B,k,B),D[2]+=.1,k[2]+=.1,l.vertexArray.emplaceBack(O[0],O[1],O[2]),l.vertexArray.emplaceBack(B[0],B[1],B[2]),l.vertexArray.emplaceBack(D[0],D[1],D[2]),l.vertexArray.emplaceBack(k[0],k[1],k[2]),l.vertexArray.emplaceBack(S[0],S[1],S[2]),l.vertexArray.emplaceBack(I[0],I[1],I[2]),l.vertexArray.emplaceBack(D[0],D[1],D[2]),l.vertexArray.emplaceBack(k[0],k[1],k[2]),l.vertexArray.emplaceBack(O[0],O[1],O[2]),l.vertexArray.emplaceBack(B[0],B[1],B[2]);const U=w/T/2;l.colorArray.emplaceBack(-U-R,-1,U,.8),l.colorArray.emplaceBack(U+R,-1,U,.8),l.colorArray.emplaceBack(-U,0,U,1.3),l.colorArray.emplaceBack(U,0,U,1.3),l.colorArray.emplaceBack(U+R,-.8,U,.7),l.colorArray.emplaceBack(U+R,-.8,U,.7),l.colorArray.emplaceBack(0,0,U,1.3),l.colorArray.emplaceBack(0,0,U,1.3),l.colorArray.emplaceBack(U+R,-1.2,U,.8),l.colorArray.emplaceBack(U+R,-1.2,U,.8),l.indexArray.emplaceBack(6+u,4+u,8+u),l.indexArray.emplaceBack(7+u,9+u,5+u),l.indexArray.emplaceBack(0+u,1+u,2+u),l.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const _={defined:!0,emissiveFactor:[0,0,0]},p={};return p.baseColorFactor=ki.white,_.pbrMetallicRoughness=p,l.material=_,l.aabb=new gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}class zA{constructor(o){this._stringToNumber={},this._numberToString=[];for(let l=0;l<o.length;l++){const u=o[l];this._stringToNumber[u]=l,this._numberToString[l]=u}}encode(o){return this._stringToNumber[o]}decode(o){return this._numberToString[o]}}const BA=["id","tile","layer","source","sourceLayer","state"];class bv{constructor(o,l,u,_,p){this.type="Feature",this._vectorTileFeature=o,this._z=l,this._x=u,this._y=_,this.properties=o.properties,this.id=p}clone(){const o=new bv(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(o.state={...this.state}),this.layer&&(o.layer={...this.layer}),this.source&&(o.source=this.source),this.sourceLayer&&(o.sourceLayer=this.sourceLayer),o}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(o){this._geometry=o}toJSON(){const o={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of BA)void 0!==this[l]&&(o[l]=this[l]);return o}}class xS{constructor(o,l){this.tileID=o,this.x=o.canonical.x,this.y=o.canonical.y,this.z=o.canonical.z,this.grid=new zl(Ot,16,0),this.featureIndexArray=new my,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(o,l,u,_,p,y=0,T=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,_,p,y);const R=this.grid;for(let w=0;w<l.length;w++){const D=l[w],k=[1/0,1/0,-1/0,-1/0];for(let S=0;S<D.length;S++){const I=D[S];k[0]=Math.min(k[0],I.x),k[1]=Math.min(k[1],I.y),k[2]=Math.max(k[2],I.x),k[3]=Math.max(k[3],I.y)}0!==T&&(k[0]-=T,k[1]-=T,k[2]+=T,k[3]+=T),k[0]<Ot&&k[1]<Ot&&k[2]>=0&&k[3]>=0&&R.insert(E,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Yd.VectorTile(new e0(this.rawTileData)).layers,this.sourceLayerCoder=new zA(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const o in this.vtLayers)this.vtFeatures[o]=[]}return this.vtLayers}query(o,l){const{tilespaceGeometry:u,transform:_,tileTransform:p,pixelPosMatrix:y,availableImages:T}=l;this.loadVTLayers(),this.serializedLayersCache.clear();const E=u.bufferedTilespaceBounds,R=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(S,I,O,B)=>Xe(u.bufferedTilespaceGeometry,S,I,O,B));R.sort(VA);let w=null;_.elevation&&R.length>0&&(w=Jg.create(_.elevation,this.tileID));const D={};let k;for(let S=0;S<R.length;S++){const I=R[S];if(I===k)continue;k=I;const O=this.featureIndexArray.get(I);let B=null;this.is3DTile?this.loadMatchingModelFeature(D,O,o,u,_):this.loadMatchingFeature(D,O,o,T,(U,q,Z,$=0)=>(B||(B=j(U,this.tileID.canonical,p)),q.queryIntersectsFeature(u,U,Z,B,this.z,_,y,w,$)))}return D}loadMatchingFeature(o,l,u,_,p){const{featureIndex:y,bucketIndex:T,sourceLayerIndex:E,layoutVertexArrayOffset:R}=l,w=this.bucketLayerIDs[T],D=u.layers,k=Object.keys(D);if(k.length&&!function(U,q){for(let Z=0;Z<U.length;Z++)if(q.indexOf(U[Z])>=0)return!0;return!1}(k,w))return;const S=u.sourceCache,I=this.sourceLayerCoder.decode(E),O=this.vtLayers[I].feature(y),B=this.getId(O,I);for(let U=0;U<w.length;U++){const q=w[U];if(!D[q])continue;const{styleLayer:Z,targets:$}=D[q];let Y={};void 0!==B&&(Y=S.getFeatureState(Z.sourceLayer,B));const K=!p||p(O,Z,Y,R);if(!K)continue;const ee=new bv(O,this.z,this.x,this.y,B);ee.tile=this.tileID.canonical,ee.state=Y;let ue=this.serializedLayersCache.get(q);ue||(ue=Z.serialize(),ue.id=q,this.serializedLayersCache.set(q,ue)),ee.source=ue.source,ee.sourceLayer=ue["source-layer"],ee.layer=$o({},ue),ee.layer.paint=wS(ue.paint,Z.paint,O,Y,_),ee.layer.layout=wS(ue.layout,Z.layout,O,Y,_);let de=!1;for(const ce of $){this.updateFeatureProperties(ee,ce);const{filter:we}=ce;if(we)if(O.properties=ee.properties,we.needGeometry){const fe=G(O,!0);if(!we.filter(new _r(this.tileID.overscaledZ),fe,this.tileID.canonical))continue}else if(!we.filter(new _r(this.tileID.overscaledZ),O))continue;de=!0,ce.targetId&&this.addFeatureVariant(ee,ce)}de&&this.appendToResult(o,q,y,ee,K)}}loadMatchingModelFeature(o,l,u,_,p){const y=this.bucketLayerIDs[0][0],T=u.layers;if(!T[y])return;const{styleLayer:E,targets:R}=T[y];if("model"!==E.type)return;const w=_.tile,D=l.featureIndex,k=w.getBucket(E);if(!(k&&k instanceof S0))return;const S=function(ue,de,ce,we){const fe=ue.getNodesInfo()[de];if(fe.hiddenByReplacement||!fe.node.meshes)return;let Te=Number.MAX_VALUE;const ke=fe.node,De=ce.tile,Pe=we.calculatePosMatrix(De.tileID.toUnwrapped(),we.worldSize),Ne=fe.evaluatedScale;let je=0;we.elevation&&ke.elevation&&(je=ke.elevation*we.elevation.exaggeration()),Oe.mat4.translate(Pe,Pe,[(ke.anchor?ke.anchor[0]:0)*(Ne[0]-1),(ke.anchor?ke.anchor[1]:0)*(Ne[1]-1),je]),Oe.mat4.scale(Pe,Pe,Ne);const Le=ce.queryGeometry,it=Le.isPointQuery()?Le.screenBounds:Le.screenGeometry,_t=function(Et){const St=Oe.mat4.multiply([],Pe,Et.matrix);Oe.mat4.multiply(St,we.expandedFarZProjMatrix,St);for(let zt=0;zt<Et.meshes.length;++zt){const lt=Et.meshes[zt];if(zt===Et.lightMeshIndex)continue;const en=rm(it,we,St,lt.aabb);null!=en&&(Te=Math.min(en,Te))}if(Et.children)for(const zt of Et.children)_t(zt)};if(_t(ke),Te===Number.MAX_VALUE)return;const rt=new ii(0,0);return h1(De.tileID.canonical,rt,fe.node.anchor[0],fe.node.anchor[1]),{intersectionZ:Te,position:rt,feature:fe.feature}}(k,D,_,p);if(!S)return;const{z:I,x:O,y:B}=w.tileID.canonical,{feature:U,intersectionZ:q,position:Z}=S;let $={};void 0!==U.id&&($=u.sourceCache.getFeatureState(E.sourceLayer,U.id));const Y=new bv({},I,O,B,U.id);Y.tile=this.tileID.canonical,Y.state=$,Y.properties=U.properties,Y.geometry={type:"Point",coordinates:[Z.lng,Z.lat]};let K=this.serializedLayersCache.get(y);K||(K=E.serialize(),K.id=y,this.serializedLayersCache.set(y,K)),Y.source=K.source,Y.sourceLayer=K["source-layer"],Y.layer=$o({},K);let ee=!1;for(const ue of R){this.updateFeatureProperties(Y,ue);const{filter:de}=ue;if(de)if(U.properties=Y.properties,de.needGeometry){if(!de.filter(new _r(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!de.filter(new _r(this.tileID.overscaledZ),U))continue;ee=!0,ue.targetId&&this.addFeatureVariant(Y,ue)}ee&&this.appendToResult(o,y,D,Y,q)}updateFeatureProperties(o,l,u){if(l.properties){const _={};for(const p in l.properties){const y=l.properties[p].evaluate({zoom:this.z},o._vectorTileFeature,o.state,o.tile,u);null!=y&&(_[p]=y)}o.properties=_}}addFeatureVariant(o,l,u){const _={target:l.target,namespace:l.namespace};l.properties&&(_.properties=o.properties),o.variants=o.variants||{},o.variants[l.targetId]=o.variants[l.targetId]||[],o.variants[l.targetId].push(_)}appendToResult(o,l,u,_,p){let y=o[l];void 0===y&&(y=o[l]=[]),y.push({featureIndex:u,feature:_,intersectionZ:p})}lookupSymbolFeatures(o,l,u,_,p){const y={};this.loadVTLayers();for(const T of o)this.loadMatchingFeature(y,{bucketIndex:l,sourceLayerIndex:u,featureIndex:T,layoutVertexArrayOffset:0},_,p);return y}loadFeature(o){const{featureIndex:l,sourceLayerIndex:u}=o;this.loadVTLayers();const _=this.sourceLayerCoder.decode(u),p=this.vtFeatures[_];if(p[l])return p[l];const y=this.vtLayers[_].feature(l);return p[l]=y,y}hasLayer(o){for(const l of this.bucketLayerIDs)for(const u of l)if(o===u)return!0;return!1}getId(o,l){let u=o.id;if(this.promoteId){const _="string"==typeof this.promoteId?this.promoteId:this.promoteId[l];null!=_&&(u=o.properties[_]),"boolean"==typeof u&&(u=Number(u))}return u}}function wS(d,o,l,u,_){return jc(d,(p,y)=>{const T=o instanceof ta?o.get(y):null;return T&&T.evaluate?T.evaluate(l,u,_):T})}function VA(d,o){return o-d}Zt(xS,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const $0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class mm{static from(o){if(!(o instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,u]=new Uint8Array(o,0,2);if(219!==l)throw new Error("Data does not appear to be in a KDBush format.");const _=u>>4;if(1!==_)throw new Error(`Got v${_} data when expected v1.`);const p=$0[15&u];if(!p)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(o,2,1),[T]=new Uint32Array(o,4,1);return new mm(T,y,p,o)}constructor(o,l=64,u=Float64Array,_){if(isNaN(o)||o<0)throw new Error(`Unpexpected numItems value: ${o}.`);this.numItems=+o,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=u,this.IndexArrayType=o<65536?Uint16Array:Uint32Array;const p=$0.indexOf(this.ArrayType),y=2*o*this.ArrayType.BYTES_PER_ELEMENT,T=o*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-T%8)%8;if(p<0)throw new Error(`Unexpected typed array class: ${u}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+E,2*o),this._pos=2*o,this._finished=!0):(this.data=new ArrayBuffer(8+y+T+E),this.ids=new this.IndexArrayType(this.data,8,o),this.coords=new this.ArrayType(this.data,8+T+E,2*o),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+p]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=o)}add(o,l){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=o,this.coords[this._pos++]=l,u}finish(){const o=this._pos>>1;if(o!==this.numItems)throw new Error(`Added ${o} items when expected ${this.numItems}.`);return xv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(o,l,u,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:p,coords:y,nodeSize:T}=this,E=[0,p.length-1,0],R=[];for(;E.length;){const w=E.pop()||0,D=E.pop()||0,k=E.pop()||0;if(D-k<=T){for(let B=k;B<=D;B++){const U=y[2*B],q=y[2*B+1];U>=o&&U<=u&&q>=l&&q<=_&&R.push(p[B])}continue}const S=k+D>>1,I=y[2*S],O=y[2*S+1];I>=o&&I<=u&&O>=l&&O<=_&&R.push(p[S]),(0===w?o<=I:l<=O)&&(E.push(k),E.push(S-1),E.push(1-w)),(0===w?u>=I:_>=O)&&(E.push(S+1),E.push(D),E.push(1-w))}return R}within(o,l,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:p,nodeSize:y}=this,T=[0,_.length-1,0],E=[],R=u*u;for(;T.length;){const w=T.pop()||0,D=T.pop()||0,k=T.pop()||0;if(D-k<=y){for(let B=k;B<=D;B++)A1(p[2*B],p[2*B+1],o,l)<=R&&E.push(_[B]);continue}const S=k+D>>1,I=p[2*S],O=p[2*S+1];A1(I,O,o,l)<=R&&E.push(_[S]),(0===w?o-u<=I:l-u<=O)&&(T.push(k),T.push(S-1),T.push(1-w)),(0===w?o+u>=I:l+u>=O)&&(T.push(S+1),T.push(D),T.push(1-w))}return E}}function xv(d,o,l,u,_,p){if(_-u<=l)return;const y=u+_>>1;wv(d,o,y,u,_,p),xv(d,o,l,u,y-1,1-p),xv(d,o,l,y+1,_,1-p)}function wv(d,o,l,u,_,p){for(;_>u;){if(_-u>600){const R=_-u+1,w=l-u+1,D=Math.log(R),k=.5*Math.exp(2*D/3),S=.5*Math.sqrt(D*k*(R-k)/R)*(w-R/2<0?-1:1);wv(d,o,l,Math.max(u,Math.floor(l-w*k/R+S)),Math.min(_,Math.floor(l+(R-w)*k/R+S)),p)}const y=o[2*l+p];let T=u,E=_;for(p_(d,o,u,l),o[2*_+p]>y&&p_(d,o,u,_);T<E;){for(p_(d,o,T,E),T++,E--;o[2*T+p]<y;)T++;for(;o[2*E+p]>y;)E--}o[2*u+p]===y?p_(d,o,u,E):(E++,p_(d,o,E,_)),E<=l&&(u=E+1),l<=E&&(_=E-1)}}function p_(d,o,l,u){gm(d,l,u),gm(o,2*l,2*u),gm(o,2*l+1,2*u+1)}function gm(d,o,l){const u=d[o];d[o]=d[l],d[l]=u}function A1(d,o,l,u){const _=d-l,p=o-u;return _*_+p*p}f.$=zd,f.A=Ko,f.B=2,f.C=MM,f.D=cm,f.E=up,f.F=qy,f.G=class extends c1{},f.H=hi,f.I=hv,f.J=$_,f.K=Ps,f.L=Yc,f.M=hl,f.N=gc,f.O=cf,f.P=Ft,f.Q=mg,f.R=ol,f.S=go,f.T=h0,f.U=_c,f.V=c1,f.W=Wc,f.X=Pl,f.Y=_p,f.Z=za,f._=Jm,f.a=function(d){return ge.API_CDN_URL_REGEX.test(d)},f.a$=bv,f.a0=vp,f.a1=Vu,f.a2=function(d){const o=d.value;let l=[];if(!o)return l;const u=hi(o);return"string"!==u?(l=l.concat([new c1(d.key,o,`string expected, "${u}" found`)]),l):(dh(o,!0)||(l=l.concat([new c1(d.key,o,`invalid url "${o}"`)])),l)},f.a3=Ge,f.a4=Nd,f.a5=Pr,f.a6=wt,f.a7=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return Zs(d.expression.evaluate(o))}interpolate(d,o,l){return{x:Lt(d.x,o.x,l),y:Lt(d.y,o.y,l),z:Lt(d.z,o.z,l),azimuthal:Lt(d.azimuthal,o.azimuthal,l),polar:Lt(d.polar,o.polar,l)}}},f.a8=_r,f.a9=Kc,f.aA=$l,f.aB=class{constructor(d){this.entries={},this.scheduler=d}request(d,o,l,u){const _=this.entries[d]=this.entries[d]||{callbacks:[]};if(_.result){const[p,y]=_.result;return this.scheduler?this.scheduler.add(()=>{u(p,y)},o):u(p,y),()=>{}}return _.callbacks.push(u),_.cancel||(_.cancel=l((p,y)=>{_.result=[p,y];for(const T of _.callbacks)this.scheduler?this.scheduler.add(()=>{T(p,y)},o):T(p,y);setTimeout(()=>delete this.entries[d],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(p=>p!==u),_.callbacks.length||(_.cancel(),delete this.entries[d]))}}},f.aC=Cs,f.aD=function(d,o,l){const u=JSON.stringify(d.request);return d.data&&(this.deduped.entries[u]={result:[null,d.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:d.isSymbolTile,zoom:d.tileZoom},_=>{const p=Hh(d.request,(y,T,E,R)=>{y?_(y):T&&_(null,{vectorTile:l?void 0:new Yd.VectorTile(new e0(T)),rawData:T,cacheControl:E,expires:R})});return()=>{p.cancel(),_()}},o)},f.aE=function(d){Mo++,Mo>wn&&(d.getActor().send("enforceCacheSizeLimit",Dn),Mo=0)},f.aF=function(d){return d<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))},f.aG=kt,f.aH=g0,f.aI=lA,f.aJ=NM,f.aK=function(d,o){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){o(null,l)};for(let u=0;u<d.length;u++){const _=document.createElement("source");xr(d[u])||(l.crossOrigin="Anonymous"),_.src=d[u],l.appendChild(_)}return{cancel:()=>{}}},f.aL=f0,f.aM=function(d){return fetch(d).then(o=>o.arrayBuffer()).then(o=>Lo(o,0,d))},f.aN=FA,f.aO=class{constructor(d,o,l,u){this.id=d,this.position=null!=o?new ii(o[0],o[1]):new ii(0,0),this.orientation=l??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new gn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(d,o){if(Oe.mat4.multiply(d.matrix,o,d.matrix),d.meshes)for(const l of d.meshes){const u=gn.applyTransformFast(l.aabb,d.matrix);this.aabb.encapsulate(u)}if(d.children)for(const l of d.children)this._applyTransformations(l,d.matrix)}computeBoundsAndApplyParent(){const d=Oe.mat4.identity([]);for(const o of this.nodes)this._applyTransformations(o,d)}computeModelMatrix(d,o,l,u,_,p,y=!1){C0(this.matrix,this,d.transform,this.position,o,l,u,_,p,y)}upload(d){if(!this.uploaded){for(const o of this.nodes)d1(o,d);for(const o of this.nodes)sv(o);this.uploaded=!0}}destroy(){for(const d of this.nodes)u1(d)}},f.aP=Vh,f.aQ=Jy,f.aR=aa,f.aS=Zo,f.aT=fl,f.aU=es,f.aV=Cu,f.aW=xg,f.aX=c0,f.aY=function(){sr.isLoading()||sr.isLoaded()||"deferred"!==ay()||ly()},f.aZ=Bd,f.a_=G,f.aa=b,f.ab=Oe,f.ac=wu,f.ad=ta,f.ae=Ss,f.af=Lt,f.ag=Ot,f.ah=pb,f.ai=vi,f.aj=ki,f.ak=class{constructor(d){this.specification=d}possiblyEvaluate(d,o){return function([l,u]){const _=Zs([1,l,u]);return{x:_.x,y:_.y,z:_.z}}(d.expression.evaluate(o))}interpolate(d,o,l){return{x:Lt(d.x,o.x,l),y:Lt(d.y,o.y,l),z:Lt(d.z,o.z,l)}}},f.al=function(d,o,l=0,u=!0){const _=new Ft(l,l),p=d.sub(_),y=o.add(_),T=[p,new Ft(y.x,p.y),y,new Ft(p.x,y.y)];return u&&T.push(p.clone()),T},f.am=function(d,o){const l=[];for(let u=0;u<d.length;u++){const _=cc(u-1,-1,d.length-1),p=cc(u+1,-1,d.length-1),y=d[u],T=d[p],E=d[_].sub(y).unit(),R=T.sub(y).unit(),w=R.angleWithSep(E.x,E.y),D=E.add(R).unit().mult(-1*o/Math.sin(w/2));l.push(y.add(D))}return l},f.an=kM,f.ao=Xe,f.ap=function(d,o,l=0){return Oe.vec3.fromValues(((o.x-l)*d.scale-d.x)*Ot,(o.y*d.scale-d.y)*Ot,Eg(o.z,o.y))},f.aq=jn,f.ar=Yb,f.as=function(d){let o=1/0,l=1/0,u=-1/0,_=-1/0;for(const p of d)o=Math.min(o,p.x),l=Math.min(l,p.y),u=Math.max(u,p.x),_=Math.max(_,p.y);return{min:new Ft(o,l),max:new Ft(u,_)}},f.at=Hl,f.au=Re,f.av=M,f.aw=En,f.ax=_o,f.ay=function(d,o){const l={};for(let u=0;u<o.length;u++){const _=o[u];_ in d&&(l[_]=d[_])}return l},f.az=Wd,f.b=function(d){return ge.API_FONTS_REGEX.test(d)},f.b$=im,f.b0=Td,f.b1=lM,f.b2=Dw,f.b3=j,f.b4=Jc,f.b5=Vl,f.b6=si,f.b7=ni,f.b8=zb,f.b9=r1,f.bA=Lw,f.bB=Ec,f.bC=_l,f.bD=n0,f.bE=mm,f.bF=cc,f.bG=Md,f.bH=Os,f.bI=function(d,o,l){d[4*o+0]=l[0],d[4*o+1]=l[1],d[4*o+2]=l[2],d[4*o+3]=l[3]},f.bJ=Op,f.bK=$a,f.bL=Qu,f.bM=Fr,f.bN=Ku,f.bO=ii,f.bP=e1,f.bQ=Vt,f.bR=Ht,f.bS=rv,f.bT=Pt,f.bU=pr,f.bV=function(d,o,l,u,_,p,y,T,E){if("globe"===E.name)return pr(d,o,new Pt(l,u,_),!1);const R=Jy({z:l,x:u,y:_},E);return new gn([(p+R.x/R.scale)*o,o*(R.y/R.scale),y],[(p+R.x2/R.scale)*o,o*(R.y2/R.scale),T])},f.bW=function(d,o,l){let u=0;for(let _=0;_<2;++_)d[_]>0&&(u+=(d[_]-0)*(d[_]-0)),o[_]<0&&(u+=(0-o[_])*(0-o[_]));return u},f.bX=eo,f.bY=6,f.bZ=function(d){const o=Oe.mat4.identity(new Float64Array(16));Oe.mat4.multiply(o,d.pixelMatrix,d.globeMatrix);const l=[0,Sa,0],u=[0,sa,0];return Oe.vec3.transformMat4(l,l,o),Oe.vec3.transformMat4(u,u,o),[l[0]>0&&l[0]<=d.width&&l[1]>0&&l[1]<=d.height&&!In(d,new ii(d.center.lat,90)),u[0]>0&&u[0]<=d.width&&u[1]>0&&u[1]<=d.height&&!In(d,new ii(d.center.lat,-90))]},f.b_=function(d,o){const{scale:l}=d.tileTransform,u=l*Ot/(d.tileSize*Math.pow(2,o.zoom-d.tileID.overscaledZ+d.tileID.canonical.z));return Oe.mat2.scale(new Float32Array(4),o.inverseAdjustmentMatrix,[u,u])},f.ba=function(d,o){const l=Ss(o.zoom);if(0===l)return ko(d);const u=nr(d),_=Ci(u),p=Hl(u.getWest())*o.worldSize,y=Hl(u.getEast())*o.worldSize,T=$l(u.getNorth())*o.worldSize,E=$l(u.getSouth())*o.worldSize,R=[p,T,0],w=[y,T,0],D=[p,E,0],k=[y,E,0],S=Oe.mat4.invert([],o.globeMatrix);return Oe.vec3.transformMat4(R,R,S),Oe.vec3.transformMat4(w,w,S),Oe.vec3.transformMat4(D,D,S),Oe.vec3.transformMat4(k,k,S),_[0]=to(_[0],D,l),_[1]=to(_[1],k,l),_[2]=to(_[2],w,l),_[3]=to(_[3],R,l),gn.fromPoints(_)},f.bb=Ms,f.bc=Zi,f.bd=to,f.be=qu,f.bf=Dt,f.bg=pv,f.bh=e0,f.bi=Hh,f.bj=function(d){const o=[];for(const l in d)o.push(d[l]);return o},f.bk=function(d,o){const l=[];for(const u in d)u in o||l.push(u);return l},f.bl=La,f.bm=["type","source","source-layer","minzoom","maxzoom","filter","layout"],f.bn=zc,f.bo=function(d,o){const{x:l,y:u}=d.point,_=wc(l,u,d.worldSize/d._pixelsPerMercatorPixel,0,0);return Oe.mat4.multiply(_,_,ml(ko(o)))},f.bp=jy,f.bq=Mc,f.br=Jb,f.bs=function(d,o,l,u,_){const p=5*o+2;d.float32[p+0]=l,d.float32[p+1]=u,d.float32[p+2]=_},f.bt=Kg,f.bu=TM,f.bv=ne,f.bw=24,f.bx=Hb,f.by=l1,f.bz=$b,f.c=Me,f.c$=(d,o,l,u,_,p,y,T)=>{const E=d.transform,R=E.pitch<15?Xb(.07,.7,En((14-E.zoom)/5,0,1)):.07,w="none"===l.paint.get("line-trim-color-use-theme").constantOr("default");return{u_matrix:Ny(d,o,l,u),u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:_,u_width_scale:p,u_floor_width_scale:y,u_image:0,u_tile_units_to_pixels:Kp(o,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(w?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:R,u_tile_to_meter:g(o.tileID.canonical,0)}},f.c0=BM,f.c1=function(d){const o=BM(d,!0);return Oe.mat2.invert([],[o[0],o[1],o[4],o[5]])},f.c2=hr,f.c3=function(d){const{x:o,y:l}=d.point,{lng:u,lat:_}=d._center;return wc(o,l,d.worldSize,u,_)},f.c4=pi,f.c5=Gt,f.c6=5,f.c7=function(d){const o=Math.round((d+45+360)%360/90)%4;return Fa[o]},f.c8=45,f.c9=Cf,f.cA=class extends Wo{constructor(d){super(d),this.current=vf}set(d,o,l){if(this.fetchUniformLocation(d,o))for(let u=0;u<9;u++)if(l[u]!==this.current[u]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}},f.cB=Vc,f.cC=function(d,o,l){const u=Ss(l.zoom),_=d.style.map._antialias,p=o.options.extStandardDerivativesForceOff||d.terrain&&d.terrain.exaggeration()>0;return 0===u&&!_&&!p},f.cD=function(d){const o=d.pixelsPerMeter,l=o/Os(1,d.center.lat),u=Oe.mat4.identity(new Float64Array(16));return Oe.mat4.translate(u,u,[d.point.x,d.point.y,0]),Oe.mat4.scale(u,u,[l,l,o]),Float32Array.from(u)},f.cE=nr,f.cF=function(d){const o=eo-5;d=En(d,-o,o)/o*90;const l=Math.pow(Math.abs(Math.sin(vi(d))),3);return Math.round(l*(_y.length-1))},f.cG=function(d,o,l,u){const _=o.getNorth(),p=o.getSouth(),y=o.getWest(),T=o.getEast(),E=1<<d.z,R=T-y,w=_-p,D=R/64,k=-w/_y[l],S=[0,D,0,k,0,0,_,y,0];if(d.z>0){const I=180/u;Oe.mat3.multiply(S,S,[I/R+1,0,0,0,I/w+1,0,-.5*I/D,.5*I/k,1])}return S[2]=E,S[5]=d.x,S[8]=d.y,S},f.cH=ko,f.cI=function(d,o,l){const u=Oe.mat4.identity(new Float64Array(16)),_=(o/(1<<d)-.5)*Math.PI*2;return Oe.mat4.rotateY(u,l.globeMatrix,_),Float32Array.from(u)},f.cJ=class{isDataAvailableAtPoint(d){const o=this._source();if(this.isUsingMockSource()||!o||d.y<0||d.y>1)return!1;const l=o.getSource().maxzoom,u=1<<l,_=Math.floor(d.x),p=Math.floor((d.x-_)*u),y=Math.floor(d.y*u),T=this.findDEMTileFor(new kt(l,_,l,p,y));return!(!T||!T.dem)}getAtPointOrZero(d,o=0){return this.getAtPoint(d,o)||0}getAtPoint(d,o,l=!0){if(this.isUsingMockSource())return null;null==o&&(o=null);const u=this._source();if(!u||d.y<0||d.y>1)return o;const _=u.getSource().maxzoom,p=1<<_,y=Math.floor(d.x),T=d.x-y,E=new kt(_,y,_,Math.floor(T*p),Math.floor(d.y*p)),R=this.findDEMTileFor(E);if(!R||!R.dem)return o;const w=R.dem,D=1<<R.tileID.canonical.z,k=(T*D-R.tileID.canonical.x)*w.dim,S=(d.y*D-R.tileID.canonical.y)*w.dim,I=Math.floor(k),O=Math.floor(S);return(l?this.exaggeration():1)*Lt(Lt(w.get(I,O),w.get(I,O+1),S-O),Lt(w.get(I+1,O),w.get(I+1,O+1),S-O),k-I)}getAtTileOffset(d,o,l){const u=1<<d.canonical.z;return this.getAtPointOrZero(new b(d.wrap+(d.canonical.x+o/Ot)/u,(d.canonical.y+l/Ot)/u))}getAtTileOffsetFunc(d,o,l,u){return _=>{const p=this.getAtTileOffset(d,_.x,_.y),y=u.upVector(d.canonical,_.x,_.y),T=u.upVectorScale(d.canonical,o,l).metersToTile;return Oe.vec3.scale(y,y,p*T),y}}getForTilePoints(d,o,l,u){if(this.isUsingMockSource())return!1;const _=Jg.create(this,d,u);return!!_&&(o.forEach(p=>{p[2]=this.exaggeration()*_.getElevationAt(p[0],p[1],l)}),!0)}getMinMaxForTile(d){if(this.isUsingMockSource())return null;const o=this.findDEMTileFor(d);if(!o||!o.dem)return null;const l=o.dem.tree,u=o.tileID,_=1<<d.canonical.z-u.canonical.z;let p=d.canonical.x/_-u.canonical.x,y=d.canonical.y/_-u.canonical.y,T=0;for(let E=0;E<d.canonical.z-u.canonical.z&&!l.leaves[T];E++){p*=2,y*=2;const R=2*Math.floor(y)+Math.floor(p);T=l.childOffsets[T]+R,p%=1,y%=1}return{min:this.exaggeration()*l.minimums[T],max:this.exaggeration()*l.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(d,o,l){throw new Error("Pure virtual method called.")}pointCoordinate(d){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(d){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const d=this.visibleDemTiles;if(0===d.length)return null;let o=!1,l=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const _ of d){const p=this.getMinMaxForTile(_.tileID);p&&(l=Math.min(l,p.min),u=Math.max(u,p.max),o=!0)}return o?{min:l,max:u}:null}},f.cK=Lb,f.cL=Si,f.cM=function(d,o){return[Math.pow(d[0],2.2)*o,Math.pow(d[1],2.2)*o,Math.pow(d[2],2.2)*o]},f.cN=rd,f.cO=ae,f.cP=ie,f.cQ=256,f.cR=function(d,o){const l=[0,0,0],u=Ms(ko(o.canonical));return Oe.vec3.transformMat4(l,l,u),Oe.vec3.transformMat4(l,l,d),l},f.cS=d=>({u_camera_to_center_distance:new Fr(d),u_extrude_scale:new Mg(d),u_device_pixel_ratio:new Fr(d),u_matrix:new Op(d),u_inv_rot_matrix:new Op(d),u_merc_center:new $a(d),u_tile_id:new Qu(d),u_zoom_transition:new Fr(d),u_up_dir:new Qu(d),u_emissive_strength:new Fr(d)}),f.cT=d=>({u_matrix:new Op(d),u_pixels_to_tile_units:new Mg(d),u_device_pixel_ratio:new Fr(d),u_width_scale:new Fr(d),u_floor_width_scale:new Fr(d),u_units_to_pixels:new $a(d),u_dash_image:new Ku(d),u_gradient_image:new Ku(d),u_image_height:new Fr(d),u_texsize:new $a(d),u_tile_units_to_pixels:new Fr(d),u_alpha_discard_threshold:new Fr(d),u_trim_offset:new $a(d),u_trim_fade_range:new $a(d),u_trim_color:new yf(d),u_emissive_strength:new Fr(d),u_zbias_factor:new Fr(d),u_tile_to_meter:new Fr(d)}),f.cU=d=>({u_matrix:new Op(d),u_texsize:new $a(d),u_pixels_to_tile_units:new Mg(d),u_device_pixel_ratio:new Fr(d),u_width_scale:new Fr(d),u_floor_width_scale:new Fr(d),u_image:new Ku(d),u_units_to_pixels:new $a(d),u_tile_units_to_pixels:new Fr(d),u_alpha_discard_threshold:new Fr(d),u_trim_offset:new $a(d),u_trim_fade_range:new $a(d),u_trim_color:new yf(d),u_emissive_strength:new Fr(d),u_zbias_factor:new Fr(d),u_tile_to_meter:new Fr(d)}),f.cV=Ep,f.cW=qL,f.cX=Uw,f.cY=Dg,f.cZ=(d,o,l,u,_,p)=>{const y=d.transform,T="globe"===y.projection.name;let E;if("map"===p.paint.get("circle-pitch-alignment"))if(T){const w=rd(y.zoom,o.canonical)*y._pixelsPerMercatorPixel;E=Float32Array.from([w,0,0,w])}else E=y.calculatePixelsToTileUnitsMatrix(l);else E=new Float32Array([y.pixelsToGLUnits[0],0,0,y.pixelsToGLUnits[1]]);const R={u_camera_to_center_distance:d.transform.getCameraToCenterDistance(y.projection),u_matrix:d.translatePosMatrix(o.projMatrix,l,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Tt.devicePixelRatio,u_extrude_scale:E,u_inv_rot_matrix:ih,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:p.paint.get("circle-emissive-strength")};if(T){R.u_inv_rot_matrix=u,R.u_merc_center=_,R.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],R.u_zoom_transition=Ss(y.zoom);const w=_[0]*Ot,D=_[1]*Ot;R.u_up_dir=y.projection.upVector(new Pt(0,0,0),w,D)}return R},f.c_=zy,f.ca=yf,f.cb=function(d,o,l){const u=Math.sqrt(d*d+o*o+l*l),_=u>0?Math.acos(l/u)*Bc:0;let p=0!==d||0!==o?Math.atan2(-o,-d)*Bc+90:0;return p<0&&(p+=360),[u,p,_]},f.cc=g,f.cd=gn,f.ce=Zs,f.cf=function(d){return[Math.pow(d[0],1/2.2),Math.pow(d[1],1/2.2),Math.pow(d[2],1/2.2)]},f.cg=function(d,o){return d.readFields(uA,{icons:[]},o)},f.ch=function(d){return d({pluginStatus:ea,pluginURL:yc}),sy.on("pluginStateChange",d),d},f.ci=av,f.cj=Gg,f.ck=If,f.cl=Rr,f.cm=Sb,f.cn=yn,f.co=Qm,f.cp=Ws,f.cq=function(d){const o=d.indexOf("\x1f");return o>=0?d.slice(0,o):d},f.cr=function(d){return d.indexOf("\x1f")>=0},f.cs=function(d){const o=d.indexOf("\x1f");return o>=0?d.slice(o+1):""},f.ct=function(d){const o=[],l=d.id;return void 0===l&&o.push({message:`layers.${l}: missing required property "id"`}),void 0===d.render&&o.push({message:`layers.${l}: missing required method "render"`}),d.renderingMode&&"2d"!==d.renderingMode&&"3d"!==d.renderingMode&&o.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),o},f.cu=function(d,o,l,u){return"custom"===d.type?new KL(d,o):new qM[d.type](d,o,l,u)},f.cv=il,f.cw=class extends bv{constructor(d,o){super(d._vectorTileFeature,d._z,d._x,d._y,d.id),d.state&&(this.state={...d.state}),this.target=o.target,this.namespace=o.namespace,o.properties&&(this.properties=o.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=d.source,this.sourceLayer=d.sourceLayer,this.layer=d.layer)}toJSON(){const d=super.toJSON();return d.target=this.target,d.namespace=this.namespace,d}},f.cx=sy,f.cy=Sd,f.cz=Pp,f.d=function(d){return ge.API_TILEJSON_REGEX.test(d)},f.d$=jc,f.d0=(d,o,l,u,_,p,y,T,E)=>{const R=d.transform,w=R.calculatePixelsToTileUnitsMatrix(o),D="none"===l.paint.get("line-trim-color-use-theme").constantOr("default"),k=R.pitch<15?Xb(.07,.7,En((14-R.zoom)/5,0,1)):.07;return{u_matrix:Ny(d,o,l,u),u_pixels_to_tile_units:w,u_device_pixel_ratio:p,u_width_scale:y,u_floor_width_scale:T,u_units_to_pixels:[1/R.pixelsToGLUnits[0],1/R.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:_,u_texsize:Qp(l)&&o.lineAtlasTexture?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Kp(o,d.transform),u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toRenderColor(D?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:k,u_tile_to_meter:g(o.tileID.canonical,0)}},f.d1=ap,f.d2=kg,f.d3=Py,f.d4=hn,f.d5=lo,f.d6=Kd,f.d7=450,f.d8=7,f.d9=iA,f.dA=Ni,f.dB=c,f.dC=qd,f.dD=function([d,o,l]){const u=Math.hypot(d,o,l),_=Math.atan2(d,l),p=.5*Math.PI-Math.acos(-o/u);return new ii(pi(_),pi(p))},f.dE=y0,f.dF=function(d){const o=d.navigator?d.navigator.userAgent:null;return!!function(l){if(null==cp){const u=l.navigator?l.navigator.userAgent:null;cp=!!l.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return cp}(d)&&o&&(o.match("Version/15.4")||o.match("Version/15.5")||o.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},f.dG=function(d,o){Dn=d,wn=o},f.dH=In,f.dI=hs,f.dJ=function(d){const o=[0,0,0],l=Oe.mat4.identity(new Float64Array(16));return Oe.mat4.multiply(l,d.pixelMatrix,d.globeMatrix),Oe.vec3.transformMat4(o,o,l),new Ft(o[0],o[1])},f.dK=function(d,o,l=!1){if(ea===oy||ea===Tb||ea===Mb)throw new Error("setRTLTextPlugin cannot be called multiple times.");yc=Tt.resolveURL(d),ea=oy,wp=o,Cp(),l||ly()},f.dL=ay,f.dM=function(){av().acquire(E0)},f.dN=function(){const d=Of;d&&(d.isPreloaded()&&1===d.numActive()?(d.release(E0),Of=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},f.dO=i_,f.dP=function(d){const o=Gi();if(!o)return;const l=o.delete($t);d&&l.catch(d).then(()=>d())},f.dQ=n_,f.dR=gS,f.dS=function(d){M1=Tt.resolveURL(d),h_||(h_=new cm(av(),new up)),h_.broadcast("setDracoUrl",M1)},f.dT=E1,f.dU=function(d){u_=Tt.resolveURL(d),h_||(h_=new cm(av(),new up)),h_.broadcast("setMeshoptUrl",u_)},f.dV=Zt,f.dW=Tf,f.dX=2,f.dY=zA,f.dZ=xS,f.d_=Wb,f.da=Ri,f.db=vg,f.dc=256,f.dd=ml,f.de=jd,f.df=nd,f.dg=pf,f.dh=function(d,o,l,u,_){return En((d-o)/(l-o)*(_-u)+u,u,_)},f.di=Rs,f.dj=s,f.dk=class{constructor(d,o,l,u){this.context=d,this.format=u,this.size=l,this.texture=d.gl.createTexture();const[_,p,y]=this.size,{gl:T}=d;T.bindTexture(T.TEXTURE_3D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(!1),T.texImage3D(T.TEXTURE_3D,0,this.format,_,p,y,0,o1(this.format),s1(this.format),o.data)}bind(d,o){const{context:l}=this,{gl:u}=l;u.bindTexture(u.TEXTURE_3D,this.texture),d!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,d),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,d),this.minFilter=d),o!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,o),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,o),this.wrapS=o)}destroy(){const{gl:d}=this.context;d.deleteTexture(this.texture),this.texture=null}},f.dl=x0,f.dm=[1,1,1],f.dn=Jg,f.dp=sm,f.dq=td,f.dr=bc,f.ds=th,f.dt=Bl,f.du=Ts,f.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Ft(1/0,1/0),max:new Ft(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(d,o=!1){const l=Wp(new Ft(0,0),new Ft(Ot,Ot),d),u=[];if(o&&!Dy(l,this._globalClipBounds))return u;for(const _ of this._activeRegions){if(_.hiddenByOverlap||!Dy(l,_))continue;const p=XT(_.min,_.max,d);u.push({min:p.min,max:p.max,sourceId:this._sourceIds[_.priority],footprint:_.footprint,footprintTileId:_.tileId,order:_.order,clipMask:_.clipMask,clipScope:_.clipScope})}return u}setSources(d){this._setSources(d.map(o=>({getSourceId:()=>o.cache.id,getFootprints:()=>{const l=[];for(const u of o.cache.getVisibleCoordinates()){const _=o.cache.getTile(u).buckets[o.layer];_&&_.updateFootprints(u.toUnwrapped(),l)}return l},getOrder:()=>o.order,getClipMask:()=>o.clipMask,getClipScope:()=>o.clipScope})))}_addSource(d){const o=d.getFootprints();if(0===o.length)return;const l=d.getOrder(),u=d.getClipMask(),_=d.getClipScope();for(const p of o){if(!p.footprint)continue;const y=Wp(p.footprint.min,p.footprint.max,p.id);this._activeRegions.push({min:y.min,max:y.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:p.id,footprint:p.footprint,order:l,clipMask:u,clipScope:_})}this._sourceIds.push(d.getSourceId())}_computeReplacement(){this._activeRegions.sort((o,l)=>o.priority-l.priority||qp(o.min,l.min)||qp(o.max,l.max)||o.order-l.order||o.clipMask-l.clipMask||function(u,_){const p=(y,T)=>y+T;return u.length-_.length||u.reduce(p,"").localeCompare(_.reduce(p,""))}(o.clipScope,l.clipScope));let d=this._activeRegions.length!==this._prevRegions.length;if(!d){let o=0;for(;!d&&o!==this._activeRegions.length;){const l=this._activeRegions[o],u=this._prevRegions[o];d=l.priority!==u.priority||!Pw(l,u)||l.order!==u.order||l.clipMask!==u.clipMask||!zc(l.clipScope,u.clipScope),++o}}if(d){++this._updateTime;for(const l of this._activeRegions)l.order!==Lg&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const o=l=>{const u=this._activeRegions;if(l>=u.length)return l;const _=u[l].priority;for(;l<u.length&&u[l].priority===_;)++l;return l};if(this._sourceIds.length>1){let l=0,u=o(l);for(;l!==u;){let _=l;const p=l;for(;_!==u;){const y=this._activeRegions[_];y.hiddenByOverlap=!1;for(let T=0;T<p;T++){const E=this._activeRegions[T];if(!E.hiddenByOverlap&&y.order===Lg&&Dy(y,E)&&(y.hiddenByOverlap=Fw(y.footprint,y.tileId,E.footprint,E.tileId),y.hiddenByOverlap))break}++_}l=u,u=o(l)}}}}_setSources(d){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let o=d.length-1;o>=0;o--)this._addSource(d[o]);this._computeReplacement()}},f.dw=class{constructor(d){this._createGrid(d),this._createPoles(d)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const d of this._poleSegments)d.destroy();for(const d of this._gridSegments)d.withSkirts.destroy(),d.withoutSkirts.destroy()}_fillGridMeshWithLods(d,o){const l=new Jc,u=new es,_=[],p=d+1+2,y=o[0]+1,T=o[0]+1+(1+o.length),E=(R,w,D)=>{let k=R===p-1?R-2:0===R?R:R-1;return k+=D?24575:0,[k,w]};for(let R=0;R<p;++R)l.emplaceBack(...E(R,0,!0));for(let R=0;R<y;++R)for(let w=0;w<p;++w)l.emplaceBack(...E(w,R,(0===w||w===p-1)&&!0));for(let R=0;R<o.length;++R){const w=o[R];for(let D=0;D<p;++D)l.emplaceBack(...E(D,w,!0))}for(let R=0;R<o.length;++R){const w=u.length,D=o[R]+1+2,k=new es;for(let O=0;O<D-1;O++){const B=O===D-2,U=B?p*(T-o.length+R-O):p;for(let q=0;q<p-1;q++){const Z=O*p+q;0===O||B||0===q||q===p-2?(k.emplaceBack(Z+1,Z,Z+U),k.emplaceBack(Z+U,Z+U+1,Z+1)):(u.emplaceBack(Z+1,Z,Z+U),u.emplaceBack(Z+U,Z+U+1,Z+1))}}const S=ni.simpleSegment(0,w,l.length,u.length-w);for(let O=0;O<k.uint16.length;O+=3)u.emplaceBack(k.uint16[O],k.uint16[O+1],k.uint16[O+2]);const I=ni.simpleSegment(0,w,l.length,u.length-w);_.push({withoutSkirts:S,withSkirts:I})}return{vertices:l,indices:u,segments:_}}_createGrid(d){const o=this._fillGridMeshWithLods(64,_y);this._gridSegments=o.segments,this._gridBuffer=d.createVertexBuffer(o.vertices,si.members),this._gridIndexBuffer=d.createIndexBuffer(o.indices,!0)}_createPoles(d){const o=new es;for(let y=0;y<=64;y++)o.emplaceBack(0,y+1,y+2);this._poleIndexBuffer=d.createIndexBuffer(o,!0);const l=new nd,u=new nd,_=new nd,p=new nd;this._poleSegments=[];for(let y=0,T=0;y<5;y++){const E=360/(1<<y);l.emplaceBack(0,-_o,0,.5,0),u.emplaceBack(0,-_o,0,.5,1),_.emplaceBack(0,-_o,0,.5,.5),p.emplaceBack(0,-_o,0,.5,.5);for(let R=0;R<=64;R++){let w=R/64,D=0;const k=Lt(0,E,w),[S,I,O]=wf(nh,od,k,_o);l.emplaceBack(S,I,O,w,D),u.emplaceBack(S,I,O,w,1-D);const B=vi(k);w=.5+.5*Math.sin(B),D=.5+.5*Math.cos(B),_.emplaceBack(S,I,O,w,D),p.emplaceBack(S,I,O,w,1-D)}this._poleSegments.push(ni.simpleSegment(T,0,66,64)),T+=66}this._poleNorthVertexBuffer=d.createVertexBuffer(l,sn,!1),this._poleSouthVertexBuffer=d.createVertexBuffer(u,sn,!1),this._texturedPoleNorthVertexBuffer=d.createVertexBuffer(_,sn,!1),this._texturedPoleSouthVertexBuffer=d.createVertexBuffer(p,sn,!1)}getGridBuffers(d,o){return[this._gridBuffer,this._gridIndexBuffer,o?this._gridSegments[d].withSkirts:this._gridSegments[d].withoutSkirts]}getPoleBuffers(d,o){return[o?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,o?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[d]]}},f.dx=Lg,f.dy=Il,f.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},f.e=ge,f.e0=$c,f.e1=SM,f.e2=function(d,o,l,u,_,p,y,T,E,R,w=1,D,k){d.createArrays(),d.tilePixelRatio=Ot/(512*d.overscaling),d.compareText={},d.iconsNeedLinear=!1;const S=d.layers[0].layout,I=d.layers[0]._unevaluatedLayout._values,O={};O.scaleFactor=w,O.textSizeScaleRange=S.get("text-size-scale-range"),O.iconSizeScaleRange=S.get("icon-size-scale-range");const[B,U]=O.textSizeScaleRange,[q,Z]=O.iconSizeScaleRange;if(O.textScaleFactor=En(O.scaleFactor,B,U),O.iconScaleFactor=En(O.scaleFactor,q,Z),"composite"===d.textSizeData.kind){const{minZoom:ee,maxZoom:ue}=d.textSizeData;O.compositeTextSizes=[I["text-size"].possiblyEvaluate(new _r(ee),T),I["text-size"].possiblyEvaluate(new _r(ue),T)]}if("composite"===d.iconSizeData.kind){const{minZoom:ee,maxZoom:ue}=d.iconSizeData;O.compositeIconSizes=[I["icon-size"].possiblyEvaluate(new _r(ee),T),I["icon-size"].possiblyEvaluate(new _r(ue),T)]}O.layoutTextSize=I["text-size"].possiblyEvaluate(new _r(E+1),T),O.layoutIconSize=I["icon-size"].possiblyEvaluate(new _r(E+1),T),O.textMaxSize=I["text-size"].possiblyEvaluate(new _r(18),T);const $="map"===S.get("text-rotation-alignment")&&"point"!==S.get("symbol-placement"),Y=S.get("text-size");let K=!1;for(const ee of d.features)if(ee.icon&&ee.icon.nameSecondary){K=!0;break}for(const ee of d.features){const ue=S.get("text-font").evaluate(ee,{},T).join(","),de=Y.evaluate(ee,{},T)*O.textScaleFactor,ce=O.layoutTextSize.evaluate(ee,{},T)*O.textScaleFactor,we=(O.layoutIconSize.evaluate(ee,{},T),{horizontal:{},vertical:void 0}),fe=ee.text;let Te,ke=[0,0];if(fe){const je=fe.toString(),Le=24*S.get("text-letter-spacing").evaluate(ee,{},T),it=24*S.get("text-line-height").evaluate(ee,{},T),_t=mw(je)?Le:0,rt=S.get("text-anchor").evaluate(ee,{},T),Et=S.get("text-variable-anchor");if(!Et){const It=S.get("text-radial-offset").evaluate(ee,{},T);ke=It?_l(rt,[24*It,Yw]):S.get("text-offset").evaluate(ee,{},T).map(Xt=>24*Xt)}let St=$?"center":S.get("text-justify").evaluate(ee,{},T);const zt="point"===S.get("symbol-placement"),lt=zt?24*S.get("text-max-width").evaluate(ee,{},T):1/0,en=It=>{d.allowVerticalPlacement&&ty(je)&&(we.vertical=Gw(fe,o,l,_,ue,lt,it,rt,It,_t,ke,Mc.vertical,!0,ce,de))};if(!$&&Et){const It="auto"===St?Et.map(dn=>Ec(dn)):[St];let Xt=!1;for(let dn=0;dn<It.length;dn++){const On=It[dn];if(!we.horizontal[On])if(Xt)we.horizontal[On]=we.horizontal[0];else{const Hn=Gw(fe,o,l,_,ue,lt,it,"center",On,_t,ke,Mc.horizontal,!1,ce,de);Hn&&(we.horizontal[On]=Hn,Xt=1===Hn.positionedLines.length)}}en("left")}else{if("auto"===St&&(St=Ec(rt)),zt||S.get("text-writing-mode").indexOf("horizontal")>=0||!ty(je)){const It=Gw(fe,o,l,_,ue,lt,it,rt,St,_t,ke,Mc.horizontal,!1,ce,de);It&&(we.horizontal[St]=It)}en(zt?"left":St)}}let De=!1,Pe=!1;if(ee.icon&&ee.icon.namePrimary){const je=Uy(d.iconSizeData,I["icon-size"],T,d.zoom,ee)*O.iconScaleFactor*D,Le=ee.icon.getPrimary().scaleSelf(je).serialize(),it=u[Le];it&&(Te=_M(_[Le],ee.icon.nameSecondary?_[ee.icon.getSecondary().scaleSelf(je).serialize()]:void 0,S.get("icon-offset").evaluate(ee,{},T),S.get("icon-anchor").evaluate(ee,{},T)),De=it.sdf,Pe=it.usvg,void 0===d.sdfIcons?d.sdfIcons=it.sdf:d.sdfIcons!==it.sdf&&Yn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(it.pixelRatio!==d.pixelRatio||0!==S.get("icon-rotate").constantOr(1))&&(d.iconsNeedLinear=!0))}const Ne=DM(we.horizontal)||we.vertical;d.iconsInText||(d.iconsInText=!!Ne&&Ne.iconsInText),(Ne||Te)&&Zk(d,ee,we,Te,u,O,ce,0,ke,De,Pe,y,T,R,k,K)}p&&d.generateCollisionDebugBuffers(E,d.collisionBoxArray,O.textScaleFactor)},f.e3=Yd,f.e4=L0,f.e5=xu,f.e6=jb,f.e7=pM,f.e8=To,f.e9=function(d){let o=0;if(new Uint32Array(d,0,1)[0]!==vS){const l=new Uint32Array(d,0,7),[,,u,_,p,y]=l;o=l.byteLength+_+p+y+p,(u!==d.byteLength||o>=d.byteLength)&&Yn("Invalid b3dm header information.")}return Lo(d,o)},f.ea=function(d,o){const l=FA(d);for(const u of l){for(const _ of u.meshes)LA(_);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(NA(u.lights,o)))}return l},f.eb=S0,f.ec=p1,f.ed=sr,f.ee=function(d){er(),mi?.then(o=>{o.keys().then(l=>{for(let u=0;u<l.length-d;u++)o.delete(l[u])})})},f.f=function(d){return 0===d.indexOf("mapbox:")},f.g=function(d,o){return Sd($o(d,{method:"GET"}),o)},f.h=Ce,f.i=function(d){return ge.API_STYLE_REGEX.test(d)&&!Me(d)},f.j=function(d){return decodeURIComponent(atob(d).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join(""))},f.k=function(d){return btoa(encodeURIComponent(d).replace(/%([0-9A-F]{2})/g,(o,l)=>String.fromCharCode(+("0x"+l))))},f.l=$o,f.m=xs,f.n=function(d,o){return Sd($o(d,{type:"json"}),o)},f.o=V_,f.p=function(d,o){return Sd($o(d,{method:"POST"}),o)},f.q=Tt,f.r=Nr,f.s=function(d){try{const o=self[d];return o.setItem("_mapbox_test_",1),o.removeItem("_mapbox_test_"),!0}catch{return!1}},f.t=xt,f.u=function(){return function d(o){return o?(o^Math.random()*(16>>o/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,d)}()},f.v=function(d){return!!d&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(d)},f.w=Yn,f.x=function(){return ph||(ph=new i_),ph},f.y=Mu,f.z=Ks}),Ph(0,function(f){function To(tt){const ie=tt?tt.url.toString():void 0;return ie?performance.getEntriesByName(ie):[]}function Gs(tt){if("number"==typeof tt||"boolean"==typeof tt||"string"==typeof tt||null==tt)return JSON.stringify(tt);if(Array.isArray(tt)){let ae="[";for(const ge of tt)ae+=`${Gs(ge)},`;return`${ae}]`}let ie="{";for(const ae of Object.keys(tt).sort())ie+=`${ae}:${Gs(tt[ae])},`;return`${ie}}`}function xi(tt){let ie="";for(const ae of f.bm)ie+=`/${Gs(tt[ae])}`;return ie}class Xn{constructor(ie){this.keyCache={},this._layers={},this._layerConfigs={},ie&&this.replace(ie)}replace(ie,ae){this._layerConfigs={},this._layers={},this.update(ie,[],ae)}update(ie,ae,ge){this._options=ge;for(const Me of ie)this._layerConfigs[Me.id]=Me,(this._layers[Me.id]=f.cu(Me,this.scope,null,this._options)).compileFilter(ge),this.keyCache[Me.id]&&delete this.keyCache[Me.id];for(const Me of ae)delete this.keyCache[Me],delete this._layerConfigs[Me],delete this._layers[Me];this.familiesBySource={};const Ce=function(Me,ze){const We={};for(let Ie=0;Ie<Me.length;Ie++){const nt=Me[Ie];let Je=ze&&ze[nt.id];!Je&&(Je=xi(nt),"line"===nt.type&&nt.paint)&&function Tt(Mt){return"string"==typeof Mt&&"line-progress"===Mt||(Array.isArray(Mt)?Mt.some(Tt):!(!Mt||"object"!=typeof Mt)&&Object.values(Mt).some(Tt))}(nt.paint["line-width"])&&(Je+=`/${Gs(nt.paint["line-width"])}`),ze&&(ze[nt.id]=Je);let xt=We[Je];xt||(xt=We[Je]=[]),xt.push(nt)}const Ve=[];for(const Ie in We)Ve.push(We[Ie]);return Ve}(f.bj(this._layerConfigs),this.keyCache);for(const Me of Ce){const ze=Me.map(xt=>this._layers[xt.id]),We=ze[0];if("none"===We.visibility)continue;const Ve=We.source||"";let Ie=this.familiesBySource[Ve];Ie||(Ie=this.familiesBySource[Ve]={});const nt=We.sourceLayer||"_geojsonTileLayer";let Je=Ie[nt];Je||(Je=Ie[nt]=[]),Je.push(ze)}}}const ks=1*f.dX;class xd{constructor(ie){const ae={},ge=[];for(const We in ie){const Ve=ie[We],Ie=ae[We]={};for(const nt in Ve.glyphs){const Je=Ve.glyphs[+nt];if(!Je||0===Je.bitmap.width||0===Je.bitmap.height)continue;const xt=Je.metrics.localGlyph?ks:1,Tt={x:0,y:0,w:Je.bitmap.width+2*xt,h:Je.bitmap.height+2*xt};ge.push(Tt),Ie[nt]=Tt}}const{w:Ce,h:Me}=f.C(ge),ze=new f.dW({width:Ce||1,height:Me||1});for(const We in ie){const Ve=ie[We];for(const Ie in Ve.glyphs){const nt=Ve.glyphs[+Ie];if(!nt||0===nt.bitmap.width||0===nt.bitmap.height)continue;const Je=ae[We][Ie],xt=nt.metrics.localGlyph?ks:1;f.dW.copy(nt.bitmap,ze,{x:0,y:0},{x:Je.x+xt,y:Je.y+xt},nt.bitmap)}}this.image=ze,this.positions=ae}}f.dV(xd,"GlyphAtlas");class mr{constructor(ie){this.tileID=new f.aG(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.lut=ie.lut,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.scope=ie.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=ie.showCollisionBoxes,this.collectResourceTiming=!!ie.request&&ie.request.collectResourceTiming,this.promoteId=ie.promoteId,this.isSymbolTile=ie.isSymbolTile,this.tileTransform=f.aQ(ie.tileID.canonical,ie.projection),this.projection=ie.projection,this.worldview=ie.worldview,this.localizableLayerIds=ie.localizableLayerIds,this.brightness=ie.brightness,this.extraShadowCaster=!!ie.extraShadowCaster,this.tessellationStep=ie.tessellationStep,this.scaleFactor=ie.scaleFactor}parse(ie,ae,ge,Ce,Me){this.status="parsing",this.data=ie,this.collisionBoxArray=new f.aW;const ze=new f.dY(Object.keys(ie.layers).sort()),We=new f.dZ(this.tileID,this.promoteId);We.bucketLayerIDs=[];const Ve={},Ie=new f.d_(256,256),nt={featureIndex:We,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:Ie,availableImages:ge,brightness:this.brightness,scaleFactor:this.scaleFactor},Je=ae.familiesBySource[this.source];for(const wn in Je){const ot=ie.layers[wn];if(!ot)continue;let mi=!1,Kn=!1,Gi=!1;for(const xs of Je[wn])"symbol"===xs[0].type?mi=!0:Kn=!0,xs[0].is3D()&&"model"!==xs[0].type&&(Gi=!0);if(this.extraShadowCaster&&!Gi||!0===this.isSymbolTile&&!mi||!1===this.isSymbolTile&&!Kn)continue;1===ot.version&&f.w(`Vector tile source "${this.source}" layer "${wn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const er=ze.encode(wn),Mo=[];for(let xs=0,Br=0;xs<ot.length;xs++){const so=ot.feature(xs),rl=We.getId(so,wn);if(this.localizableLayerIds&&this.localizableLayerIds.has(wn)){const Ys=so.properties?so.properties.worldview:null;if(this.worldview&&"string"==typeof Ys)if("all"===Ys)so.properties.$localized=!0;else{if(!Ys.split(",").includes(this.worldview))continue;so.properties.$localized=!0,so.properties.worldview=this.worldview}}Mo.push({feature:so,id:rl,index:Br,sourceLayerIndex:er}),Br++}for(const xs of Je[wn]){const Br=xs[0];(!this.extraShadowCaster||Br.is3D()&&"model"!==Br.type)&&(void 0!==this.isSymbolTile&&"symbol"===Br.type!==this.isSymbolTile||Br.minzoom&&this.zoom<Math.floor(Br.minzoom)||Br.maxzoom&&this.zoom>=Br.maxzoom||"none"!==Br.visibility&&(Oi(xs,this.zoom,nt.brightness,ge),(Ve[Br.id]=Br.createBucket({index:We.bucketLayerIDs.length,layers:xs,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:er,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(Mo,nt,this.tileID.canonical,this.tileTransform),We.bucketLayerIDs.push(xs.map(so=>f.aC(so.id,so.scope)))))}}let xt,Tt,Mt,yn;Ie.trim();const $t={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Dn=()=>{if(xt)return this.status="done",Me(xt);if(this.extraShadowCaster)this.status="done",Me(null,{buckets:f.bj(Ve).filter(wn=>!wn.isEmpty()),featureIndex:We,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:nt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Tt&&Mt&&yn){const wn=new xd(Tt),ot=new f.e1(Mt,yn,this.lut);for(const mi in Ve){const Kn=Ve[mi];Kn instanceof f.aX?(Oi(Kn.layers,this.zoom,nt.brightness,ge),f.e2(Kn,Tt,wn.positions,Mt,ot.iconPositions,this.showCollisionBoxes,ge,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):Kn.hasPattern&&(Kn instanceof f.b1||Kn instanceof f.b2||Kn instanceof f.d5)&&(Oi(Kn.layers,this.zoom,nt.brightness,ge),Kn.addFeatures(nt,this.tileID.canonical,ot.patternPositions,ge,this.tileTransform,this.brightness))}this.status="done",Me(null,{buckets:f.bj(Ve).filter(mi=>!mi.isEmpty()),featureIndex:We,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:wn.image,lineAtlas:Ie,imageAtlas:ot,brightness:nt.brightness})}};if(!this.extraShadowCaster){const wn=f.d$(nt.glyphDependencies,Kn=>Object.keys(Kn).map(Number));Object.keys(wn).length?Ce.send("getGlyphs",{uid:this.uid,stacks:wn,scope:this.scope},(Kn,Gi)=>{xt||(xt=Kn,Tt=Gi,Dn())},void 0,!1,$t):Tt={};const ot=Object.keys(nt.iconDependencies);ot.length?Ce.send("getImages",{icons:ot,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Kn,Gi)=>{if(xt)return;xt=Kn;const er={};Object.values(Gi).some(Mo=>Mo.usvg)?this.rasterize(Ce,er,Gi,nt.iconDependencies,()=>{Mt=er,Dn()}):(this.fillImageMap(er,nt.iconDependencies,Gi),Mt=er,Dn())},void 0,!1,$t):Mt={};const mi=Object.keys(nt.patternDependencies);mi.length?Ce.send("getImages",{icons:mi,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Kn,Gi)=>{if(!xt){xt=Kn;const er={};Object.values(Gi).some(Mo=>Mo.usvg)?this.rasterize(Ce,er,Gi,nt.patternDependencies,()=>{yn=er,Dn()}):(this.fillImageMap(er,nt.patternDependencies,Gi),yn=er,Dn())}},void 0,!1,$t):yn={}}Dn()}fillImageMap(ie,ae,ge){for(const Ce in ge){const Me=ae[Ce]||[];for(const ze of Me)ge[ze.id].usvg||(ie[ze.serialize()]=ge[ze.id])}}getImageTaskQueue(ie,ae,ge){const Ce={};for(const Me in ae){const ze=ge[Me]||[];for(const We of ze){const Ve=We.serialize();ae[We.id].usvg?Ce[Ve]||(Ce[Ve]=We):ie[Ve]=ae[We.id]}}return Ce}rasterize(ie,ae,ge,Ce,Me){const ze=this.getImageTaskQueue(ae,ge,Ce);this.rasterizeTask=ie.send("rasterizeImages",{scope:this.scope,imageTasks:ze},(We,Ve)=>{if(!We)for(const Ie in Ve){const{id:nt}=f.e0.deserializeFromString(Ie);ae[Ie]=Object.assign({},ge[nt],{data:Ve[Ie]})}Me()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function Oi(tt,ie,ae,ge){const Ce=new f.a8(ie,{brightness:ae});for(const Me of tt)Me.recalculate(Ce,ge)}class ss extends f.E{constructor(ie,ae,ge,Ce,Me,ze){super(),this.actor=ie,this.layerIndex=ae,this.availableImages=ge,this.loadVectorData=Me||f.aD,this.loading={},this.loaded={},this.deduped=new f.aB(ie.scheduler),this.isSpriteLoaded=Ce,this.scheduler=ie.scheduler,this.brightness=ze}loadTile(ie,ae){const ge=ie.uid,Ce=ie&&ie.request,Me=Ce&&Ce.collectResourceTiming,ze=this.loading[ge]=new mr(ie);ze.abort=this.loadVectorData(ie,(We,Ve)=>{const Ie=!this.loading[ge];if(delete this.loading[ge],ze.cancelRasterize(),Ie||We||!Ve)return ze.status="done",Ie||(this.loaded[ge]=ze),ae(We);const nt=Ve.rawData,Je={};Ve.expires&&(Je.expires=Ve.expires),Ve.cacheControl&&(Je.cacheControl=Ve.cacheControl),ze.vectorTile=Ve.vectorTile||new f.e3.VectorTile(new f.bh(nt));const xt=()=>{ze.parse(ze.vectorTile,this.layerIndex,this.availableImages,this.actor,(Tt,Mt)=>{if(Tt||!Mt)return ae(Tt);const yn={};if(Me){const $t=To(Ce);$t.length>0&&(yn.resourceTiming=JSON.parse(JSON.stringify($t)))}ae(null,f.l({rawTileData:nt.slice(0)},Mt,Je,yn))})};this.isSpriteLoaded?xt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(xt,{type:"parseTile",isSymbolTile:ie.isSymbolTile,zoom:ie.tileZoom}):xt()}),this.loaded=this.loaded||{},this.loaded[ge]=ze})}reloadTile(ie,ae){const ge=this.loaded,Ce=ie.uid;if(ge&&ge[Ce]){const Me=ge[Ce];Me.scaleFactor=ie.scaleFactor,Me.showCollisionBoxes=ie.showCollisionBoxes,Me.projection=ie.projection,Me.brightness=ie.brightness,Me.tileTransform=f.aQ(ie.tileID.canonical,ie.projection),Me.extraShadowCaster=ie.extraShadowCaster,Me.lut=ie.lut;const ze=(We,Ve)=>{const Ie=Me.reloadCallback;Ie&&(delete Me.reloadCallback,Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,Ie)),ae(We,Ve)};"parsing"===Me.status?Me.reloadCallback=ze:"done"===Me.status&&(Me.vectorTile?Me.parse(Me.vectorTile,this.layerIndex,this.availableImages,this.actor,ze):ze())}else ae(null,void 0)}abortTile(ie,ae){const ge=ie.uid,Ce=this.loading[ge];Ce&&(Ce.abort&&Ce.abort(),delete this.loading[ge]),ae()}removeTile(ie,ae){const ge=this.loaded,Ce=ie.uid;ge&&ge[Ce]&&delete ge[Ce],ae()}}class Ji{loadTile(ie,ae){const{uid:ge,encoding:Ce,rawImageData:Me,padding:ze}=ie,We=ImageBitmap&&Me instanceof ImageBitmap?this.getImageData(Me,ze):Me;ae(null,new f.e4(ge,We,Ce,ze<1))}getImageData(ie,ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);const ge=this.offscreenCanvasContext.getImageData(-ae,-ae,ie.width+2*ae,ie.height+2*ae);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ge}}f.bg.setPbf(f.bh);class wd{decodeRasterArray({task:ie,buffer:ae},ge){f.bg.performDecoding(ae,ie).then(Ce=>{ge(null,Ce)},Ce=>{ge(Ce)})}}const Oh=f.e3.VectorTileFeature.prototype.toGeoJSON;class $i{constructor(ie){this._feature=ie,this.extent=f.ag,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(1===this._feature.type){const ie=[];for(const ae of this._feature.geometry)ie.push([new f.P(ae[0],ae[1])]);return ie}{const ie=[];for(const ae of this._feature.geometry){const ge=[];for(const Ce of ae)ge.push(new f.P(Ce[0],Ce[1]));ie.push(ge)}return ie}}toGeoJSON(ie,ae,ge){return Oh.call(this,ie,ae,ge)}}class Fh{constructor(ie){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.ag,this.length=ie.length,this._features=ie}feature(ie){return new $i(this._features[ie])}}const sc=64/4096;class el{constructor(){this.features=new Map}clear(){this.features.clear()}load(ie=[],ae){for(const ge of ie){const Ce=ge.id;if(null==Ce)continue;let Me=this.features.get(Ce);Me&&this.updateCache(Me,ae),ge.geometry?(Me=xn(ge),this.updateCache(Me,ae),this.features.set(Ce,Me)):this.features.delete(Ce),this.updateCache(Me,ae)}}updateCache(ie,ae){for(const{canonical:ge,uid:Ce}of Object.values(ae)){const{z:Me,x:ze,y:We}=ge;tl(ie,Math.pow(2,Me),ze,We)&&delete ae[Ce]}}getTile(ie,ae,ge){const Ce=Math.pow(2,ie),Me=[];for(const ze of this.features.values())tl(ze,Ce,ae,ge)&&Me.push(vu(ze,Ce,ae,ge));return{features:Me}}getFeatures(){return[...this.features.values()]}}function tl({minX:tt,minY:ie,maxX:ae,maxY:ge},Ce,Me,ze){return tt<(Me+1+sc)/Ce&&ie<(ze+1+sc)/Ce&&ae>(Me-sc)/Ce&&ge>(ze-sc)/Ce}function xn(tt){const{id:ie,geometry:ae,properties:ge}=tt;if(!ae)return;if("GeometryCollection"===ae.type)throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Ce,coordinates:Me}=ae,ze={id:ie,type:1,geometry:[],tags:ge,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},We=ze.geometry;if("Point"===Ce)Sn(Me,We,ze);else if("MultiPoint"===Ce)for(const Ve of Me)Sn(Ve,We,ze);else if("LineString"===Ce)ze.type=2,ac(Me,We,ze);else if("MultiLineString"===Ce)ze.type=2,nl(Me,We,ze);else if("Polygon"===Ce)ze.type=3,nl(Me,We,ze,!0);else{if("MultiPolygon"!==Ce)throw new Error("Input data is not a valid GeoJSON object.");ze.type=3;for(const Ve of Me)nl(Ve,We,ze,!0)}return ze}function Sn([tt,ie],ae,ge){const Ce=f.at(tt);let Me=f.aA(ie);Me=Me<0?0:Me>1?1:Me,ae.push(Ce,Me),ge.minX=Math.min(ge.minX,Ce),ge.minY=Math.min(ge.minY,Me),ge.maxX=Math.max(ge.maxX,Ce),ge.maxY=Math.max(ge.maxY,Me)}function ac(tt,ie,ae,ge=!1,Ce=!1){const Me=[];for(const ze of tt)Sn(ze,Me,ae);ie.push(Me),ge&&function(ze,We){let Ve=0;for(let Ie=0,nt=ze.length,Je=nt-2;Ie<nt;Je=Ie,Ie+=2)Ve+=(ze[Ie]-ze[Je])*(ze[Ie+1]+ze[Je+1]);if(Ve>0===We)for(let Ie=0,nt=ze.length;Ie<nt/2;Ie+=2){const Je=ze[Ie],xt=ze[Ie+1];ze[Ie]=ze[nt-2-Ie],ze[Ie+1]=ze[nt-1-Ie],ze[nt-2-Ie]=Je,ze[nt-1-Ie]=xt}}(Me,Ce)}function nl(tt,ie,ae,ge=!1){for(let Ce=0;Ce<tt.length;Ce++)ac(tt[Ce],ie,ae,ge,0===Ce)}function vu(tt,ie,ae,ge){const{id:Ce,type:Me,geometry:ze,tags:We}=tt,Ve=[];if(1===Me)!function(Ie,nt,Je,xt,Tt){for(let Mt=0;Mt<Ie.length;Mt+=2){const yn=Math.round(f.ag*(Ie[Mt+0]*nt-Je)),$t=Math.round(f.ag*(Ie[Mt+1]*nt-xt));Tt.push([yn,$t])}}(ze,ie,ae,ge,Ve);else for(const Ie of ze)ei(Ie,ie,ae,ge,Ve);return{id:Ce,type:Me,geometry:Ve,tags:We}}function ei(tt,ie,ae,ge,Ce){const Me=-128,ze=f.ag+128;let We;for(let Ve=0;Ve<tt.length-2;Ve+=2){let Ie=Math.round(f.ag*(tt[Ve+0]*ie-ae)),nt=Math.round(f.ag*(tt[Ve+1]*ie-ge)),Je=Math.round(f.ag*(tt[Ve+2]*ie-ae)),xt=Math.round(f.ag*(tt[Ve+3]*ie-ge));const Tt=Je-Ie,Mt=xt-nt;Ie<Me&&Je<Me||(Ie<Me?(nt+=Math.round(Mt*((Me-Ie)/Tt)),Ie=Me):Je<Me&&(xt=nt+Math.round(Mt*((Me-Ie)/Tt)),Je=Me),nt<Me&&xt<Me||(nt<Me?(Ie+=Math.round(Tt*((Me-nt)/Mt)),nt=Me):xt<Me&&(Je=Ie+Math.round(Tt*((Me-nt)/Mt)),xt=Me),Ie>=ze&&Je>=ze||(Ie>=ze?(nt+=Math.round(Mt*((ze-Ie)/Tt)),Ie=ze):Je>=ze&&(xt=nt+Math.round(Mt*((ze-Ie)/Tt)),Je=ze),nt>=ze&&xt>=ze||(nt>=ze?(Ie+=Math.round(Tt*((ze-nt)/Mt)),nt=ze):xt>=ze&&(Je=Ie+Math.round(Tt*((ze-nt)/Mt)),xt=ze),We&&Ie===We[We.length-1][0]&&nt===We[We.length-1][1]||(We=[[Ie,nt]],Ce.push(We)),We.push([Je,xt])))))}}var bs,El,Cd,Un={exports:{}},lc=function(){if(Cd)return Un.exports;Cd=1;var tt=f.e7(),ie=function(){if(El)return bs;El=1;var nt=f.e5(),Je=f.e6().VectorTileFeature;function xt(Mt,yn){this.options=yn||{},this.features=Mt,this.length=Mt.length}function Tt(Mt,yn){this.id="number"==typeof Mt.id?Mt.id:void 0,this.type=Mt.type,this.rawGeometry=1===Mt.type?[Mt.geometry]:Mt.geometry,this.properties=Mt.tags,this.extent=yn||4096}return bs=xt,xt.prototype.feature=function(Mt){return new Tt(this.features[Mt],this.options.extent)},Tt.prototype.loadGeometry=function(){var Mt=this.rawGeometry;this.geometry=[];for(var yn=0;yn<Mt.length;yn++){for(var $t=Mt[yn],Dn=[],wn=0;wn<$t.length;wn++)Dn.push(new nt($t[wn][0],$t[wn][1]));this.geometry.push(Dn)}return this.geometry},Tt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Mt=this.geometry,yn=1/0,$t=-1/0,Dn=1/0,wn=-1/0,ot=0;ot<Mt.length;ot++)for(var mi=Mt[ot],Kn=0;Kn<mi.length;Kn++){var Gi=mi[Kn];yn=Math.min(yn,Gi.x),$t=Math.max($t,Gi.x),Dn=Math.min(Dn,Gi.y),wn=Math.max(wn,Gi.y)}return[yn,Dn,$t,wn]},Tt.prototype.toGeoJSON=Je.prototype.toGeoJSON,bs}();function ae(nt){var Je=new tt;return function(xt,Tt){for(var Mt in xt.layers)Tt.writeMessage(3,ge,xt.layers[Mt])}(nt,Je),Je.finish()}function ge(nt,Je){var xt;Je.writeVarintField(15,nt.version||1),Je.writeStringField(1,nt.name||""),Je.writeVarintField(5,nt.extent||4096);var Tt={keys:[],values:[],keycache:{},valuecache:{}};for(xt=0;xt<nt.length;xt++)Tt.feature=nt.feature(xt),Je.writeMessage(2,Ce,Tt);var Mt=Tt.keys;for(xt=0;xt<Mt.length;xt++)Je.writeStringField(3,Mt[xt]);var yn=Tt.values;for(xt=0;xt<yn.length;xt++)Je.writeMessage(4,Ie,yn[xt])}function Ce(nt,Je){var xt=nt.feature;void 0!==xt.id&&Je.writeVarintField(1,xt.id),Je.writeMessage(2,Me,nt),Je.writeVarintField(3,xt.type),Je.writeMessage(4,Ve,xt)}function Me(nt,Je){var xt=nt.feature,Tt=nt.keys,Mt=nt.values,yn=nt.keycache,$t=nt.valuecache;for(var Dn in xt.properties){var wn=xt.properties[Dn],ot=yn[Dn];if(null!==wn){void 0===ot&&(Tt.push(Dn),yn[Dn]=ot=Tt.length-1),Je.writeVarint(ot);var mi=typeof wn;"string"!==mi&&"boolean"!==mi&&"number"!==mi&&(wn=JSON.stringify(wn));var Kn=mi+":"+wn,Gi=$t[Kn];void 0===Gi&&(Mt.push(wn),$t[Kn]=Gi=Mt.length-1),Je.writeVarint(Gi)}}}function ze(nt,Je){return(Je<<3)+(7&nt)}function We(nt){return nt<<1^nt>>31}function Ve(nt,Je){for(var xt=nt.loadGeometry(),Tt=nt.type,Mt=0,yn=0,$t=xt.length,Dn=0;Dn<$t;Dn++){var wn=xt[Dn],ot=1;1===Tt&&(ot=wn.length),Je.writeVarint(ze(1,ot));for(var mi=3===Tt?wn.length-1:wn.length,Kn=0;Kn<mi;Kn++){1===Kn&&1!==Tt&&Je.writeVarint(ze(2,mi-1));var Gi=wn[Kn].x-Mt,er=wn[Kn].y-yn;Je.writeVarint(We(Gi)),Je.writeVarint(We(er)),Mt+=Gi,yn+=er}3===Tt&&Je.writeVarint(ze(7,1))}}function Ie(nt,Je){var xt=typeof nt;"string"===xt?Je.writeStringField(1,nt):"boolean"===xt?Je.writeBooleanField(7,nt):"number"===xt&&(nt%1!=0?Je.writeDoubleField(3,nt):nt<0?Je.writeSVarintField(6,nt):Je.writeVarintField(5,nt))}return Un.exports=ae,Un.exports.fromVectorTileJs=ae,Un.exports.fromGeojsonVt=function(nt,Je){Je=Je||{};var xt={};for(var Tt in nt)xt[Tt]=new ie(nt[Tt].features,Je),xt[Tt].name=Tt,xt[Tt].version=Je.version,xt[Tt].extent=Je.extent;return ae({layers:xt})},Un.exports.GeoJSONWrapper=ie,Un.exports}(),sp=f.e8(lc);const Lh={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:tt=>tt},Fn=Math.fround||(Nh=new Float32Array(1),tt=>(Nh[0]=+tt,Nh[0]));var Nh;class Ym{constructor(ie){this.options=Object.assign(Object.create(Lh),ie),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ie){const{log:ae,minZoom:ge,maxZoom:Ce}=this.options;ae&&console.time("total time");const Me=`prepare ${ie.length} points`;ae&&console.time(Me),this.points=ie;const ze=[];for(let Ve=0;Ve<ie.length;Ve++){const Ie=ie[Ve];if(!Ie.geometry)continue;const[nt,Je]=Ie.geometry.coordinates,xt=Fn(Nc(nt)),Tt=Fn(bu(Je));ze.push(xt,Tt,1/0,Ve,-1,1),this.options.reduce&&ze.push(0)}let We=this.trees[Ce+1]=this._createTree(ze);ae&&console.timeEnd(Me);for(let Ve=Ce;Ve>=ge;Ve--){const Ie=+Date.now();We=this.trees[Ve]=this._createTree(this._cluster(We,Ve)),ae&&console.log("z%d: %d clusters in %dms",Ve,We.numItems,+Date.now()-Ie)}return ae&&console.timeEnd("total time"),this}getClusters(ie,ae){let ge=((ie[0]+180)%360+360)%360-180;const Ce=Math.max(-90,Math.min(90,ie[1]));let Me=180===ie[2]?180:((ie[2]+180)%360+360)%360-180;const ze=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)ge=-180,Me=180;else if(ge>Me){const Je=this.getClusters([ge,Ce,180,ze],ae),xt=this.getClusters([-180,Ce,Me,ze],ae);return Je.concat(xt)}const We=this.trees[this._limitZoom(ae)],Ve=We.range(Nc(ge),bu(ze),Nc(Me),bu(Ce)),Ie=We.data,nt=[];for(const Je of Ve){const xt=this.stride*Je;nt.push(Ie[xt+5]>1?Bh(Ie,xt,this.clusterProps):this.points[Ie[xt+3]])}return nt}getChildren(ie){const ae=this._getOriginId(ie),ge=this._getOriginZoom(ie),Ce="No cluster with the specified id.",Me=this.trees[ge];if(!Me)throw new Error(Ce);const ze=Me.data;if(ae*this.stride>=ze.length)throw new Error(Ce);const We=this.options.radius/(this.options.extent*Math.pow(2,ge-1)),Ve=Me.within(ze[ae*this.stride],ze[ae*this.stride+1],We),Ie=[];for(const nt of Ve){const Je=nt*this.stride;ze[Je+4]===ie&&Ie.push(ze[Je+5]>1?Bh(ze,Je,this.clusterProps):this.points[ze[Je+3]])}if(0===Ie.length)throw new Error(Ce);return Ie}getLeaves(ie,ae,ge){const Ce=[];return this._appendLeaves(Ce,ie,ae=ae||10,ge=ge||0,0),Ce}getTile(ie,ae,ge){const Ce=this.trees[this._limitZoom(ie)],Me=Math.pow(2,ie),{extent:ze,radius:We}=this.options,Ve=We/ze,Ie=(ge-Ve)/Me,nt=(ge+1+Ve)/Me,Je={features:[]};return this._addTileFeatures(Ce.range((ae-Ve)/Me,Ie,(ae+1+Ve)/Me,nt),Ce.data,ae,ge,Me,Je),0===ae&&this._addTileFeatures(Ce.range(1-Ve/Me,Ie,1,nt),Ce.data,Me,ge,Me,Je),ae===Me-1&&this._addTileFeatures(Ce.range(0,Ie,Ve/Me,nt),Ce.data,-1,ge,Me,Je),Je.features.length?Je:null}getClusterExpansionZoom(ie){let ae=this._getOriginZoom(ie)-1;for(;ae<=this.options.maxZoom;){const ge=this.getChildren(ie);if(ae++,1!==ge.length)break;ie=ge[0].properties.cluster_id}return ae}_appendLeaves(ie,ae,ge,Ce,Me){const ze=this.getChildren(ae);for(const We of ze){const Ve=We.properties;if(Ve&&Ve.cluster?Me+Ve.point_count<=Ce?Me+=Ve.point_count:Me=this._appendLeaves(ie,Ve.cluster_id,ge,Ce,Me):Me<Ce?Me++:ie.push(We),ie.length===ge)break}return Me}_createTree(ie){const ae=new f.bE(ie.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ge=0;ge<ie.length;ge+=this.stride)ae.add(ie[ge],ie[ge+1]);return ae.finish(),ae.data=ie,ae}_addTileFeatures(ie,ae,ge,Ce,Me,ze){for(const We of ie){const Ve=We*this.stride,Ie=ae[Ve+5]>1;let nt,Je,xt;if(Ie)nt=Oe(ae,Ve,this.clusterProps),Je=ae[Ve],xt=ae[Ve+1];else{const yn=this.points[ae[Ve+3]];nt=yn.properties;const[$t,Dn]=yn.geometry.coordinates;Je=Nc($t),xt=bu(Dn)}const Tt={type:1,geometry:[[Math.round(this.options.extent*(Je*Me-ge)),Math.round(this.options.extent*(xt*Me-Ce))]],tags:nt};let Mt;Mt=Ie||this.options.generateId?ae[Ve+3]:this.points[ae[Ve+3]].id,void 0!==Mt&&(Tt.id=Mt),ze.features.push(Tt)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(Math.floor(+ie),this.options.maxZoom+1))}_cluster(ie,ae){const{radius:ge,extent:Ce,reduce:Me,minPoints:ze}=this.options,We=ge/(Ce*Math.pow(2,ae)),Ve=ie.data,Ie=[],nt=this.stride;for(let Je=0;Je<Ve.length;Je+=nt){if(Ve[Je+2]<=ae)continue;Ve[Je+2]=ae;const xt=Ve[Je],Tt=Ve[Je+1],Mt=ie.within(Ve[Je],Ve[Je+1],We),yn=Ve[Je+5];let $t=yn;for(const Dn of Mt){const wn=Dn*nt;Ve[wn+2]>ae&&($t+=Ve[wn+5])}if($t>yn&&$t>=ze){let Dn,wn=xt*yn,ot=Tt*yn,mi=-1;const Kn=(Je/nt<<5)+(ae+1)+this.points.length;for(const Gi of Mt){const er=Gi*nt;if(Ve[er+2]<=ae)continue;Ve[er+2]=ae;const Mo=Ve[er+5];wn+=Ve[er]*Mo,ot+=Ve[er+1]*Mo,Ve[er+4]=Kn,Me&&(Dn||(Dn=this._map(Ve,Je,!0),mi=this.clusterProps.length,this.clusterProps.push(Dn)),Me(Dn,this._map(Ve,er)))}Ve[Je+4]=Kn,Ie.push(wn/$t,ot/$t,1/0,Kn,-1,$t),Me&&Ie.push(mi)}else{for(let Dn=0;Dn<nt;Dn++)Ie.push(Ve[Je+Dn]);if($t>1)for(const Dn of Mt){const wn=Dn*nt;if(!(Ve[wn+2]<=ae)){Ve[wn+2]=ae;for(let ot=0;ot<nt;ot++)Ie.push(Ve[wn+ot])}}}}return Ie}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,ae,ge){if(ie[ae+5]>1){const ze=this.clusterProps[ie[ae+6]];return ge?Object.assign({},ze):ze}const Ce=this.points[ie[ae+3]].properties,Me=this.options.map(Ce);return ge&&Me===Ce?Object.assign({},Me):Me}}function Bh(tt,ie,ae){return{type:"Feature",id:tt[ie+3],properties:Oe(tt,ie,ae),geometry:{type:"Point",coordinates:[(ge=tt[ie],360*(ge-.5)),xu(tt[ie+1])]}};var ge}function Oe(tt,ie,ae){const ge=tt[ie+5],Ce=ge>=1e4?`${Math.round(ge/1e3)}k`:ge>=1e3?Math.round(ge/100)/10+"k":ge,Me=tt[ie+6],ze=-1===Me?{}:Object.assign({},ae[Me]);return Object.assign(ze,{cluster:!0,cluster_id:tt[ie+3],point_count:ge,point_count_abbreviated:Ce})}function Nc(tt){return tt/360+.5}function bu(tt){const ie=Math.sin(tt*Math.PI/180),ae=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return ae<0?0:ae>1?1:ae}function xu(tt){const ie=(180-360*tt)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function Ft(tt,ie,ae,ge){let Ce=ge;const Me=ie+(ae-ie>>1);let ze,We=ae-ie;const Ve=tt[ie],Ie=tt[ie+1],nt=tt[ae],Je=tt[ae+1];for(let xt=ie+3;xt<ae;xt+=3){const Tt=zc(tt[xt],tt[xt+1],Ve,Ie,nt,Je);if(Tt>Ce)ze=xt,Ce=Tt;else if(Tt===Ce){const Mt=Math.abs(xt-Me);Mt<We&&(ze=xt,We=Mt)}}Ce>ge&&(ze-ie>3&&Ft(tt,ie,ze,ge),tt[ze+2]=Ce,ae-ze>3&&Ft(tt,ze,ae,ge))}function zc(tt,ie,ae,ge,Ce,Me){let ze=Ce-ae,We=Me-ge;if(0!==ze||0!==We){const Ve=((tt-ae)*ze+(ie-ge)*We)/(ze*ze+We*We);Ve>1?(ae=Ce,ge=Me):Ve>0&&(ae+=ze*Ve,ge+=We*Ve)}return ze=tt-ae,We=ie-ge,ze*ze+We*We}function Ho(tt,ie,ae,ge){const Ce={id:tt??null,type:ie,geometry:ae,tags:ge,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===ie||"MultiPoint"===ie||"LineString"===ie)Bc(Ce,ae);else if("Polygon"===ie)Bc(Ce,ae[0]);else if("MultiLineString"===ie)for(const Me of ae)Bc(Ce,Me);else if("MultiPolygon"===ie)for(const Me of ae)Bc(Ce,Me[0]);return Ce}function Bc(tt,ie){for(let ae=0;ae<ie.length;ae+=3)tt.minX=Math.min(tt.minX,ie[ae]),tt.minY=Math.min(tt.minY,ie[ae+1]),tt.maxX=Math.max(tt.maxX,ie[ae]),tt.maxY=Math.max(tt.maxY,ie[ae+1])}function vi(tt,ie,ae,ge){if(!ie.geometry)return;const Ce=ie.geometry.coordinates;if(Ce&&0===Ce.length)return;const Me=ie.geometry.type,ze=Math.pow(ae.tolerance/((1<<ae.maxZoom)*ae.extent),2);let We=[],Ve=ie.id;if(ae.promoteId?Ve=ie.properties[ae.promoteId]:ae.generateId&&(Ve=ge||0),"Point"===Me)pi(Ce,We);else if("MultiPoint"===Me)for(const Ie of Ce)pi(Ie,We);else if("LineString"===Me)Fa(Ce,We,ze,!1);else if("MultiLineString"===Me){if(ae.lineMetrics){for(const Ie of Ce)We=[],Fa(Ie,We,ze,!1),tt.push(Ho(Ve,"LineString",We,ie.properties));return}Vc(Ce,We,ze,!1)}else if("Polygon"===Me)Vc(Ce,We,ze,!0);else{if("MultiPolygon"!==Me){if("GeometryCollection"===Me){for(const Ie of ie.geometry.geometries)vi(tt,{id:Ve,geometry:Ie,properties:ie.properties},ae,ge);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ie of Ce){const nt=[];Vc(Ie,nt,ze,!0),We.push(nt)}}tt.push(Ho(Ve,Me,We,ie.properties))}function pi(tt,ie){ie.push(Il(tt[0]),Ni(tt[1]),0)}function Fa(tt,ie,ae,ge){let Ce,Me,ze=0;for(let Ve=0;Ve<tt.length;Ve++){const Ie=Il(tt[Ve][0]),nt=Ni(tt[Ve][1]);ie.push(Ie,nt,0),Ve>0&&(ze+=ge?(Ce*nt-Ie*Me)/2:Math.sqrt(Math.pow(Ie-Ce,2)+Math.pow(nt-Me,2))),Ce=Ie,Me=nt}const We=ie.length-3;ie[2]=1,Ft(ie,0,We,ae),ie[We+2]=1,ie.size=Math.abs(ze),ie.start=0,ie.end=ie.size}function Vc(tt,ie,ae,ge){for(let Ce=0;Ce<tt.length;Ce++){const Me=[];Fa(tt[Ce],Me,ae,ge),ie.push(Me)}}function Il(tt){return tt/360+.5}function Ni(tt){const ie=Math.sin(tt*Math.PI/180),ae=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return ae<0?0:ae>1?1:ae}function En(tt,ie,ae,ge,Ce,Me,ze,We){if(ge/=ie,Me>=(ae/=ie)&&ze<ge)return tt;if(ze<ae||Me>=ge)return null;const Ve=[];for(const Ie of tt){const nt=Ie.geometry;let Je=Ie.type;const xt=0===Ce?Ie.minX:Ie.minY,Tt=0===Ce?Ie.maxX:Ie.maxY;if(xt>=ae&&Tt<ge){Ve.push(Ie);continue}if(Tt<ae||xt>=ge)continue;let Mt=[];if("Point"===Je||"MultiPoint"===Je)wu(nt,Mt,ae,ge,Ce);else if("LineString"===Je)cc(nt,Mt,ae,ge,Ce,!1,We.lineMetrics);else if("MultiLineString"===Je)$o(nt,Mt,ae,ge,Ce,!1);else if("Polygon"===Je)$o(nt,Mt,ae,ge,Ce,!0);else if("MultiPolygon"===Je)for(const yn of nt){const $t=[];$o(yn,$t,ae,ge,Ce,!0),$t.length&&Mt.push($t)}if(Mt.length){if(We.lineMetrics&&"LineString"===Je){for(const yn of Mt)Ve.push(Ho(Ie.id,Je,yn,Ie.tags));continue}"LineString"!==Je&&"MultiLineString"!==Je||(1===Mt.length?(Je="LineString",Mt=Mt[0]):Je="MultiLineString"),"Point"!==Je&&"MultiPoint"!==Je||(Je=3===Mt.length?"Point":"MultiPoint"),Ve.push(Ho(Ie.id,Je,Mt,Ie.tags))}}return Ve.length?Ve:null}function wu(tt,ie,ae,ge,Ce){for(let Me=0;Me<tt.length;Me+=3){const ze=tt[Me+Ce];ze>=ae&&ze<=ge&&ga(ie,tt[Me],tt[Me+1],tt[Me+2])}}function cc(tt,ie,ae,ge,Ce,Me,ze){let We=La(tt);const Ve=0===Ce?Cu:ap;let Ie,nt,Je=tt.start;for(let $t=0;$t<tt.length-3;$t+=3){const Dn=tt[$t],wn=tt[$t+1],ot=tt[$t+2],mi=tt[$t+3],Kn=tt[$t+4],Gi=0===Ce?Dn:wn,er=0===Ce?mi:Kn;let Mo=!1;ze&&(Ie=Math.sqrt(Math.pow(Dn-mi,2)+Math.pow(wn-Kn,2))),Gi<ae?er>ae&&(nt=Ve(We,Dn,wn,mi,Kn,ae),ze&&(We.start=Je+Ie*nt)):Gi>ge?er<ge&&(nt=Ve(We,Dn,wn,mi,Kn,ge),ze&&(We.start=Je+Ie*nt)):ga(We,Dn,wn,ot),er<ae&&Gi>=ae&&(nt=Ve(We,Dn,wn,mi,Kn,ae),Mo=!0),er>ge&&Gi<=ge&&(nt=Ve(We,Dn,wn,mi,Kn,ge),Mo=!0),!Me&&Mo&&(ze&&(We.end=Je+Ie*nt),ie.push(We),We=La(tt)),ze&&(Je+=Ie)}let xt=tt.length-3;const Tt=tt[xt],Mt=tt[xt+1],yn=0===Ce?Tt:Mt;yn>=ae&&yn<=ge&&ga(We,Tt,Mt,tt[xt+2]),xt=We.length-3,Me&&xt>=3&&(We[xt]!==We[0]||We[xt+1]!==We[1])&&ga(We,We[0],We[1],We[2]),We.length&&ie.push(We)}function La(tt){const ie=[];return ie.size=tt.size,ie.start=tt.start,ie.end=tt.end,ie}function $o(tt,ie,ae,ge,Ce,Me){for(const ze of tt)cc(ze,ie,ae,ge,Ce,Me,!1)}function ga(tt,ie,ae,ge){tt.push(ie,ae,ge)}function Cu(tt,ie,ae,ge,Ce,Me){const ze=(Me-ie)/(ge-ie);return ga(tt,Me,ae+(Ce-ae)*ze,1),ze}function ap(tt,ie,ae,ge,Ce,Me){const ze=(Me-ae)/(Ce-ae);return ga(tt,ie+(ge-ie)*ze,Me,1),ze}function Vh(tt,ie){const ae=[];for(let ge=0;ge<tt.length;ge++){const Ce=tt[ge],Me=Ce.type;let ze;if("Point"===Me||"MultiPoint"===Me||"LineString"===Me)ze=Uc(Ce.geometry,ie);else if("MultiLineString"===Me||"Polygon"===Me){ze=[];for(const We of Ce.geometry)ze.push(Uc(We,ie))}else if("MultiPolygon"===Me){ze=[];for(const We of Ce.geometry){const Ve=[];for(const Ie of We)Ve.push(Uc(Ie,ie));ze.push(Ve)}}ae.push(Ho(Ce.id,Me,ze,Ce.tags))}return ae}function Uc(tt,ie){const ae=[];ae.size=tt.size,void 0!==tt.start&&(ae.start=tt.start,ae.end=tt.end);for(let ge=0;ge<tt.length;ge+=3)ae.push(tt[ge]+ie,tt[ge+1],tt[ge+2]);return ae}function jc(tt,ie){if(tt.transformed)return tt;const ae=1<<tt.z,ge=tt.x,Ce=tt.y;for(const Me of tt.features){const ze=Me.geometry,We=Me.type;if(Me.geometry=[],1===We)for(let Ve=0;Ve<ze.length;Ve+=2)Me.geometry.push(il(ze[Ve],ze[Ve+1],ie,ae,ge,Ce));else for(let Ve=0;Ve<ze.length;Ve++){const Ie=[];for(let nt=0;nt<ze[Ve].length;nt+=2)Ie.push(il(ze[Ve][nt],ze[Ve][nt+1],ie,ae,ge,Ce));Me.geometry.push(Ie)}}return tt.transformed=!0,tt}function il(tt,ie,ae,ge,Ce,Me){return[Math.round(ae*(tt*ge-Ce)),Math.round(ae*(ie*ge-Me))]}function Ws(tt,ie,ae,ge,Ce){const Me=ie===Ce.maxZoom?0:Ce.tolerance/((1<<ie)*Ce.extent),ze={features:[],numPoints:0,numSimplified:0,numFeatures:tt.length,source:null,x:ae,y:ge,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const We of tt)lp(ze,We,Me,Ce);return ze}function lp(tt,ie,ae,ge){const Ce=ie.geometry,Me=ie.type,ze=[];if(tt.minX=Math.min(tt.minX,ie.minX),tt.minY=Math.min(tt.minY,ie.minY),tt.maxX=Math.max(tt.maxX,ie.maxX),tt.maxY=Math.max(tt.maxY,ie.maxY),"Point"===Me||"MultiPoint"===Me)for(let We=0;We<Ce.length;We+=3)ze.push(Ce[We],Ce[We+1]),tt.numPoints++,tt.numSimplified++;else if("LineString"===Me)Yn(ze,Ce,tt,ae,!1,!1);else if("MultiLineString"===Me||"Polygon"===Me)for(let We=0;We<Ce.length;We++)Yn(ze,Ce[We],tt,ae,"Polygon"===Me,0===We);else if("MultiPolygon"===Me)for(let We=0;We<Ce.length;We++){const Ve=Ce[We];for(let Ie=0;Ie<Ve.length;Ie++)Yn(ze,Ve[Ie],tt,ae,!0,0===Ie)}if(ze.length){let We=ie.tags||null;if("LineString"===Me&&ge.lineMetrics){We={};for(const Ie in ie.tags)We[Ie]=ie.tags[Ie];We.mapbox_clip_start=Ce.start/Ce.size,We.mapbox_clip_end=Ce.end/Ce.size}const Ve={geometry:ze,type:"Polygon"===Me||"MultiPolygon"===Me?3:"LineString"===Me||"MultiLineString"===Me?2:1,tags:We};null!==ie.id&&(Ve.id=ie.id),tt.features.push(Ve)}}function Yn(tt,ie,ae,ge,Ce,Me){const ze=ge*ge;if(ge>0&&ie.size<(Ce?ze:ge))return void(ae.numPoints+=ie.length/3);const We=[];for(let Ve=0;Ve<ie.length;Ve+=3)(0===ge||ie[Ve+2]>ze)&&(ae.numSimplified++,We.push(ie[Ve],ie[Ve+1])),ae.numPoints++;Ce&&function(Ve,Ie){let nt=0;for(let Je=0,xt=Ve.length,Tt=xt-2;Je<xt;Tt=Je,Je+=2)nt+=(Ve[Je]-Ve[Tt])*(Ve[Je+1]+Ve[Tt+1]);if(nt>0===Ie)for(let Je=0,xt=Ve.length;Je<xt/2;Je+=2){const Tt=Ve[Je],Mt=Ve[Je+1];Ve[Je]=Ve[xt-2-Je],Ve[Je+1]=Ve[xt-1-Je],Ve[xt-2-Je]=Tt,Ve[xt-1-Je]=Mt}}(We,Me),tt.push(We)}const dc={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Uh{constructor(ie,ae){const ge=(ae=this.options=function(Me,ze){for(const We in ze)Me[We]=ze[We];return Me}(Object.create(dc),ae)).debug;if(ge&&console.time("preprocess data"),ae.maxZoom<0||ae.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ae.promoteId&&ae.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ce=function(Me,ze){const We=[];if("FeatureCollection"===Me.type)for(let Ve=0;Ve<Me.features.length;Ve++)vi(We,Me.features[Ve],ze,Ve);else vi(We,"Feature"===Me.type?Me:{geometry:Me},ze);return We}(ie,ae);this.tiles={},this.tileCoords=[],ge&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ae.indexMaxZoom,ae.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ce=function(Me,ze){const We=ze.buffer/ze.extent;let Ve=Me;const Ie=En(Me,1,-1-We,We,0,-1,2,ze),nt=En(Me,1,1-We,2+We,0,-1,2,ze);return(Ie||nt)&&(Ve=En(Me,1,-We,1+We,0,-1,2,ze)||[],Ie&&(Ve=Vh(Ie,1).concat(Ve)),nt&&(Ve=Ve.concat(Vh(nt,-1)))),Ve}(Ce,ae),Ce.length&&this.splitTile(Ce,0,0,0),ge&&(Ce.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(ie,ae,ge,Ce,Me,ze,We){const Ve=[ie,ae,ge,Ce],Ie=this.options,nt=Ie.debug;for(;Ve.length;){Ce=Ve.pop(),ge=Ve.pop(),ae=Ve.pop(),ie=Ve.pop();const Je=1<<ae,xt=Zs(ae,ge,Ce);let Tt=this.tiles[xt];if(!Tt&&(nt>1&&console.time("creation"),Tt=this.tiles[xt]=Ws(ie,ae,ge,Ce,Ie),this.tileCoords.push({z:ae,x:ge,y:Ce}),nt)){nt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ae,ge,Ce,Tt.numFeatures,Tt.numPoints,Tt.numSimplified),console.timeEnd("creation"));const Mo=`z${ae}`;this.stats[Mo]=(this.stats[Mo]||0)+1,this.total++}if(Tt.source=ie,null==Me){if(ae===Ie.indexMaxZoom||Tt.numPoints<=Ie.indexMaxPoints)continue}else{if(ae===Ie.maxZoom||ae===Me)continue;if(null!=Me){const Mo=Me-ae;if(ge!==ze>>Mo||Ce!==We>>Mo)continue}}if(Tt.source=null,0===ie.length)continue;nt>1&&console.time("clipping");const Mt=.5*Ie.buffer/Ie.extent,yn=.5-Mt,$t=.5+Mt,Dn=1+Mt;let wn=null,ot=null,mi=null,Kn=null,Gi=En(ie,Je,ge-Mt,ge+$t,0,Tt.minX,Tt.maxX,Ie),er=En(ie,Je,ge+yn,ge+Dn,0,Tt.minX,Tt.maxX,Ie);ie=null,Gi&&(wn=En(Gi,Je,Ce-Mt,Ce+$t,1,Tt.minY,Tt.maxY,Ie),ot=En(Gi,Je,Ce+yn,Ce+Dn,1,Tt.minY,Tt.maxY,Ie),Gi=null),er&&(mi=En(er,Je,Ce-Mt,Ce+$t,1,Tt.minY,Tt.maxY,Ie),Kn=En(er,Je,Ce+yn,Ce+Dn,1,Tt.minY,Tt.maxY,Ie),er=null),nt>1&&console.timeEnd("clipping"),Ve.push(wn||[],ae+1,2*ge,2*Ce),Ve.push(ot||[],ae+1,2*ge,2*Ce+1),Ve.push(mi||[],ae+1,2*ge+1,2*Ce),Ve.push(Kn||[],ae+1,2*ge+1,2*Ce+1)}}getTile(ie,ae,ge){ie=+ie,ae=+ae,ge=+ge;const Ce=this.options,{extent:Me,debug:ze}=Ce;if(ie<0||ie>24)return null;const We=1<<ie,Ve=Zs(ie,ae=ae+We&We-1,ge);if(this.tiles[Ve])return jc(this.tiles[Ve],Me);ze>1&&console.log("drilling down to z%d-%d-%d",ie,ae,ge);let Ie,nt=ie,Je=ae,xt=ge;for(;!Ie&&nt>0;)nt--,Je>>=1,xt>>=1,Ie=this.tiles[Zs(nt,Je,xt)];return Ie&&Ie.source?(ze>1&&(console.log("found parent tile z%d-%d-%d",nt,Je,xt),console.time("drilling down")),this.splitTile(Ie.source,nt,Je,xt,ie,ae,ge),ze>1&&console.timeEnd("drilling down"),this.tiles[Ve]?jc(this.tiles[Ve],Me):null):null}}function Zs(tt,ie,ae){return 32*((1<<tt)*ae+ie)+tt}function kl(tt,ie){const ae=tt.tileID.canonical;if(!this._geoJSONIndex)return void ie(null,null);const ge=this._geoJSONIndex.getTile(ae.z,ae.x,ae.y);if(!ge)return void ie(null,null);const Ce=new Fh(ge.features);let Me=sp(Ce);0===Me.byteOffset&&Me.byteLength===Me.buffer.byteLength||(Me=new Uint8Array(Me)),ie(null,{vectorTile:Ce,rawData:Me.buffer})}class Td extends ss{constructor(ie,ae,ge,Ce,Me,ze){super(ie,ae,ge,Ce,kl,ze),Me&&(this.loadGeoJSON=Me),this._dynamicIndex=new el}loadData(ie,ae){const ge=ie&&ie.request,Ce=ge&&ge.collectResourceTiming;this.loadGeoJSON(ie,(Me,ze)=>{if(Me||!ze)return ae(Me);if("object"!=typeof ze)return ae(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{try{if(ie.filter){const Ve=f.U(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===Ve.result)throw new Error(Ve.value.map(Ie=>`${Ie.key}: ${Ie.message}`).join(", "));ze.features=ze.features.filter(Ie=>Ve.value.evaluate({zoom:0},Ie))}ie.dynamic?("Feature"===ze.type&&(ze={type:"FeatureCollection",features:[ze]}),ie.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(ze.features,this.loaded),ie.cluster&&(ze.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=ie.cluster?new Ym(function({superclusterOptions:Ve,clusterProperties:Ie}){if(!Ie||!Ve)return Ve;const nt={},Je={},xt={accumulated:null,zoom:0},Tt={properties:null},Mt=Object.keys(Ie);for(const yn of Mt){const[$t,Dn]=Ie[yn],wn=f.U(Dn),ot=f.U("string"==typeof $t?[$t,["accumulated"],["get",yn]]:$t);nt[yn]=wn.value,Je[yn]=ot.value}return Ve.map=yn=>{Tt.properties=yn;const $t={};for(const Dn of Mt)$t[Dn]=nt[Dn].evaluate(xt,Tt);return $t},Ve.reduce=(yn,$t)=>{Tt.properties=$t;for(const Dn of Mt)xt.accumulated=yn[Dn],yn[Dn]=Je[Dn].evaluate(xt,Tt)},Ve}(ie)).load(ze.features):ie.dynamic?this._dynamicIndex:new Uh(Ve=ze,ie.geojsonVtOptions)}catch(Ve){return ae(Ve)}const We={};if(Ce){const Ve=To(ge);Ve&&(We.resourceTiming={},We.resourceTiming[ie.source]=JSON.parse(JSON.stringify(Ve)))}ae(null,We)}var Ve})}reloadTile(ie,ae){const ge=this.loaded;return ge&&ge[ie.uid]?ie.partial?ae(null,void 0):super.reloadTile(ie,ae):this.loadTile(ie,ae)}loadGeoJSON(ie,ae){if(ie.request)f.n(ie.request,ae);else{if("string"!=typeof ie.data)return ae(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));try{return ae(null,JSON.parse(ie.data))}catch{return ae(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ie,ae){try{ae(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(ge){ae(ge)}}getClusterChildren(ie,ae){try{ae(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(ge){ae(ge)}}getClusterLeaves(ie,ae){try{ae(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(ge){ae(ge)}}}class cp{constructor(ie,ae){this.tileID=new f.aG(ie.tileID.overscaledZ,ie.tileID.wrap,ie.tileID.canonical.z,ie.tileID.canonical.x,ie.tileID.canonical.y),this.tileZoom=ie.tileZoom,this.uid=ie.uid,this.zoom=ie.zoom,this.canonical=ie.tileID.canonical,this.pixelRatio=ie.pixelRatio,this.tileSize=ie.tileSize,this.source=ie.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=ie.projection,this.brightness=ae}parse(ie,ae,ge,Ce){this.status="parsing";const Me=new f.aG(ge.tileID.overscaledZ,ge.tileID.wrap,ge.tileID.canonical.z,ge.tileID.canonical.x,ge.tileID.canonical.y),ze=[],We=ae.familiesBySource[ge.source],Ve=new f.dZ(Me,ge.promoteId);return Ve.bucketLayerIDs=[],Ve.is3DTile=!0,f.e9(ie).then(Ie=>{if(!Ie)return Ce(new Error("Could not parse tile"));const nt=f.ea(Ie,1/f.cc(ge.tileID.canonical)),Je=Ie.json.extensionsUsed&&Ie.json.extensionsUsed.includes("MAPBOX_mesh_features")||Ie.json.asset.extras&&Ie.json.asset.extras.MAPBOX_mesh_features,xt=Ie.json.extensionsUsed&&Ie.json.extensionsUsed.includes("EXT_meshopt_compression"),Tt=new f.a8(this.zoom,{brightness:this.brightness});for(const Mt in We)for(const yn of We[Mt]){const $t=yn[0];Ve.bucketLayerIDs.push(yn.map(wn=>f.aC(wn.id,wn.scope))),$t.recalculate(Tt,[]);const Dn=new f.eb(yn,nt,Me,Je,xt,this.brightness,Ve);Je||(Dn.needsUpload=!0),ze.push(Dn),Dn.evaluate($t)}this.status="done",Ce(null,{buckets:ze,featureIndex:Ve,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(Ie=>Ce(new Error(Ie.message)))}}class Md{constructor(ie,ae,ge,Ce,Me,ze){this.actor=ie,this.layerIndex=ae,this.availableImages=ge,this.brightness=ze,this.loading={},this.loaded={}}loadTile(ie,ae){const ge=ie.uid,Ce=this.loading[ge]=new cp(ie,this.brightness);f.bi(ie.request,(Me,ze)=>{const We=!this.loading[ge];return delete this.loading[ge],We||Me?(Ce.status="done",We||(this.loaded[ge]=Ce),ae(Me)):ze&&0!==ze.byteLength?void Ce.parse(ze,this.layerIndex,ie,(Ve,Ie)=>{Ce.status="done",this.loaded=this.loaded||{},this.loaded[ge]=Ce,Ve||!Ie?ae(Ve):ae(null,Ie)}):(Ce.status="done",this.loaded[ge]=Ce,ae())})}reloadTile(ie,ae){const ge=this.loaded,Ce=ie.uid;if(ge&&ge[Ce]){const Me=ge[Ce];Me.projection=ie.projection,Me.brightness=ie.brightness;const ze=(We,Ve)=>{Me.reloadCallback&&(delete Me.reloadCallback,this.loadTile(ie,ae)),ae(We,Ve)};"parsing"===Me.status?Me.reloadCallback=ze:"done"===Me.status&&this.loadTile(ie,ae)}}abortTile(ie,ae){const ge=ie.uid;this.loading[ge]&&delete this.loading[ge],ae()}removeTile(ie,ae){const ge=this.loaded,Ce=ie.uid;ge&&ge[Ce]&&delete ge[Ce],ae()}}class dp{constructor(ie){this.self=ie,this.actor=new f.ec(ie,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new f.I,this.projections={},this.defaultProjection=f.bP({name:"mercator"}),this.workerSourceTypes={vector:ss,geojson:Td,"batched-model":Md},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ae,ge)=>{if(this.workerSourceTypes[ae])throw new Error(`Worker source with name "${ae}" already registered.`);this.workerSourceTypes[ae]=ge},this.self.registerRTLTextPlugin=ae=>{if(f.ed.isParsed())throw new Error("RTL text plugin already registered.");f.ed.applyArabicShaping=ae.applyArabicShaping,f.ed.processBidirectionalText=ae.processBidirectionalText,f.ed.processStyledBidirectionalText=ae.processStyledBidirectionalText}}clearCaches(ie,ae,ge){delete this.layerIndexes[ie],delete this.availableImages[ie],delete this.workerSources[ie],delete this.demWorkerSources[ie],delete this.rasterArrayWorkerSource,ge()}checkIfReady(ie,ae,ge){ge()}setReferrer(ie,ae){this.referrer=ae}spriteLoaded(ie,{scope:ae,isLoaded:ge}){if(this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={}),this.isSpriteLoaded[ie][ae]=ge,this.workerSources[ie]&&this.workerSources[ie][ae])for(const Ce in this.workerSources[ie][ae]){const Me=this.workerSources[ie][ae][Ce];for(const ze in Me){const We=Me[ze];We instanceof ss&&(We.isSpriteLoaded=ge,We.fire(new f.z("isSpriteLoaded")))}}}setImages(ie,{scope:ae,images:ge},Ce){if(this.availableImages[ie]||(this.availableImages[ie]={}),this.availableImages[ie][ae]=ge,this.workerSources[ie]&&this.workerSources[ie][ae]){for(const Me in this.workerSources[ie][ae]){const ze=this.workerSources[ie][ae][Me];for(const We in ze)ze[We].availableImages=ge}Ce()}else Ce()}setProjection(ie,ae){this.projections[ie]=f.bP(ae)}setBrightness(ie,ae,ge){this.brightness=ae,ge()}setLayers(ie,ae,ge){this.getLayerIndex(ie,ae.scope).replace(ae.layers,ae.options),ge()}updateLayers(ie,ae,ge){this.getLayerIndex(ie,ae.scope).update(ae.layers,ae.removedIds,ae.options),ge()}loadTile(ie,ae,ge){ae.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,ae.type,ae.source,ae.scope).loadTile(ae,ge)}loadDEMTile(ie,ae,ge){this.getDEMWorkerSource(ie,ae.source,ae.scope).loadTile(ae,ge)}decodeRasterArray(ie,ae,ge){this.getRasterArrayWorkerSource().decodeRasterArray(ae,ge)}reloadTile(ie,ae,ge){ae.projection=this.projections[ie]||this.defaultProjection,this.getWorkerSource(ie,ae.type,ae.source,ae.scope).reloadTile(ae,ge)}abortTile(ie,ae,ge){this.getWorkerSource(ie,ae.type,ae.source,ae.scope).abortTile(ae,ge)}removeTile(ie,ae,ge){this.getWorkerSource(ie,ae.type,ae.source,ae.scope).removeTile(ae,ge)}removeSource(ie,ae,ge){if(!(this.workerSources[ie]&&this.workerSources[ie][ae.scope]&&this.workerSources[ie][ae.scope][ae.type]&&this.workerSources[ie][ae.scope][ae.type][ae.source]))return;const Ce=this.workerSources[ie][ae.scope][ae.type][ae.source];delete this.workerSources[ie][ae.scope][ae.type][ae.source],void 0!==Ce.removeSource?Ce.removeSource(ae,ge):ge()}loadWorkerSource(ie,ae,ge){try{this.self.importScripts(ae.url),ge()}catch(Ce){ge(Ce.toString())}}syncRTLPluginState(ie,ae,ge){try{f.ed.setState(ae);const Ce=f.ed.getPluginURL();if(f.ed.isLoaded()&&!f.ed.isParsed()&&null!=Ce){this.self.importScripts(Ce);const Me=f.ed.isParsed();ge(Me?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ce}`),Me)}}catch(Ce){ge(Ce.toString())}}setDracoUrl(ie,ae){this.dracoUrl=ae}getAvailableImages(ie,ae){this.availableImages[ie]||(this.availableImages[ie]={});let ge=this.availableImages[ie][ae];return ge||(ge=[]),ge}getLayerIndex(ie,ae){this.layerIndexes[ie]||(this.layerIndexes[ie]={});let ge=this.layerIndexes[ie][ae];return ge||(ge=this.layerIndexes[ie][ae]=new Xn,ge.scope=ae),ge}getWorkerSource(ie,ae,ge,Ce){return this.workerSources[ie]||(this.workerSources[ie]={}),this.workerSources[ie][Ce]||(this.workerSources[ie][Ce]={}),this.workerSources[ie][Ce][ae]||(this.workerSources[ie][Ce][ae]={}),this.isSpriteLoaded[ie]||(this.isSpriteLoaded[ie]={}),this.workerSources[ie][Ce][ae][ge]||(this.workerSources[ie][Ce][ae][ge]=new this.workerSourceTypes[ae]({send:(Me,ze,We,Ve,Ie,nt)=>{this.actor.send(Me,ze,We,ie,Ie,nt)},scheduler:this.actor.scheduler},this.getLayerIndex(ie,Ce),this.getAvailableImages(ie,Ce),this.isSpriteLoaded[ie][Ce],void 0,this.brightness)),this.workerSources[ie][Ce][ae][ge]}rasterizeImages(ie,ae,ge){const{imageTasks:Ce,scope:Me}=ae,ze={};for(const We in Ce){const{image:Ve,imageIdWithOptions:Ie}=Ce[We];ze[We]=this.imageRasterizer.rasterize(Ie,Ve,Me,ie)}ge(void 0,ze)}removeRasterizedImages(ie,ae,ge){const{imageIds:Ce,scope:Me}=ae;this.imageRasterizer.removeImagesFromCacheByIds(Ce,Me,ie),ge()}getDEMWorkerSource(ie,ae,ge){return this.demWorkerSources[ie]||(this.demWorkerSources[ie]={}),this.demWorkerSources[ie][ge]||(this.demWorkerSources[ie][ge]={}),this.demWorkerSources[ie][ge][ae]||(this.demWorkerSources[ie][ge][ae]=new Ji),this.demWorkerSources[ie][ge][ae]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new wd),this.rasterArrayWorkerSource}enforceCacheSizeLimit(ie,ae){f.ee(ae)}getWorkerPerformanceMetrics(ie,ae,ge){ge(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new dp(self)),dp}),Ph(0,function(f){var To="3.9.2";const Gs={create:"create",load:"load",fullLoad:"fullLoad"},xi={mark(m){performance.mark(m)},measure(m,s,c){performance.measure(m,s,c)}};function Xn(m){const s=m.name.split("?")[0];return f.a(s)&&s.includes("mapbox-gl.js")?"javascript":f.a(s)&&s.includes("mapbox-gl.css")?"css":f.b(s)?"fontRange":f.c(s)?"sprite":f.i(s)?"style":f.d(s)?"tilejson":"other"}var ks,xd={},mr=function(){if(ks)return xd;function m(g){return!s(g)}function s(g){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,M,A=new Blob([""],{type:"text/javascript"}),F=URL.createObjectURL(A);try{M=new Worker(F),x=!0}catch{x=!1}return M&&M.terminate(),URL.revokeObjectURL(F),x}()?function(){var x=document.createElement("canvas");x.width=x.height=1;var M=x.getContext("2d");if(!M)return!1;var A=M.getImageData(0,0,1,1);return A&&A.width===x.width}()?(void 0===c[b=g&&g.failIfMajorPerformanceCaveat]&&(c[b]=function(x){var M,F,N,z,A=(F=x,N=document.createElement("canvas"),(z=Object.create(m.webGLContextAttributes)).failIfMajorPerformanceCaveat=F,N.getContext("webgl2",z));if(!A)return!1;try{M=A.createShader(A.VERTEX_SHADER)}catch{return!1}return!(!M||A.isContextLost())&&(A.shaderSource(M,"void main() {}"),A.compileShader(M),!0===A.getShaderParameter(M,A.COMPILE_STATUS))}(b)),c[b]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var b}ks=1,xd.supported=m,xd.notSupportedReason=s;var c={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},xd}();function Oi(m,s,c){const g=document.createElement(m);return null!=s&&(g.className=s),c&&c.appendChild(g),g}function ss(m,s,c){const g=document.createElementNS("http://www.w3.org/2000/svg",m);for(const b of Object.keys(s))g.setAttributeNS(null,b,String(s[b]));return c&&c.appendChild(g),g}const Ji=typeof document<"u"?document.documentElement&&document.documentElement.style:null,wd=Ji&&void 0!==Ji.userSelect?"userSelect":"WebkitUserSelect";let Oh;function $i(){Ji&&wd&&(Oh=Ji[wd],Ji[wd]="none")}function Fh(){Ji&&wd&&(Ji[wd]=Oh)}function sc(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",sc,!0)}function bn(){window.addEventListener("click",sc,!0),window.setTimeout(()=>{window.removeEventListener("click",sc,!0)},0)}function el(m,s){const c=m.getBoundingClientRect();return Sn(m,c,s)}function tl(m,s){const c=m.getBoundingClientRect(),g=[];for(let b=0;b<s.length;b++)g.push(Sn(m,c,s[b]));return g}function xn(m){return void 0!==window.InstallTrigger&&2===m.button&&m.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function Sn(m,s,c){const g=m.offsetWidth===s.width?1:m.offsetWidth/s.width;return new f.P((c.clientX-s.left)*g,(c.clientY-s.top)*g)}const ac="01",nl="NO_ACCESS_TOKEN";class vu{constructor(s,c,g){this._transformRequestFn=s,this._customAccessToken=c,this._silenceAuthErrors=!!g,this._createSkuToken()}_createSkuToken(){const s=function(){let c="";for(let g=0;g<10;g++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ac,c].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=s.token,this._skuTokenExpiresAt=s.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(s,c){return this._transformRequestFn&&this._transformRequestFn(s,c)||{url:s}}normalizeStyleURL(s,c){if(!f.f(s))return s;const g=bs(s);return g.params.push(`sdk=js-${To}`),g.path=`/styles/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||c)}normalizeGlyphsURL(s,c){if(!f.f(s))return s;const g=bs(s);return g.path=`/fonts/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||c)}normalizeModelURL(s,c){if(!f.f(s))return s;const g=bs(s);return g.path=`/models/v1${g.path}`,this._makeAPIURL(g,this._customAccessToken||c)}normalizeSourceURL(s,c,g,b){if(!f.f(s))return s;const x=bs(s);return x.path=`/v4/${x.authority}.json`,x.params.push("secure"),g&&x.params.push(`language=${g}`),b&&x.params.push(`worldview=${b}`),this._makeAPIURL(x,this._customAccessToken||c)}normalizeIconsetURL(s,c){const g=bs(s);return f.f(s)?(g.path=`/styles/v1${g.path}/iconset.pbf`,this._makeAPIURL(g,this._customAccessToken||c)):El(g)}normalizeSpriteURL(s,c,g,b){const x=bs(s);return f.f(s)?(x.path=`/styles/v1${x.path}/sprite${c}${g}`,this._makeAPIURL(x,this._customAccessToken||b)):(x.path+=`${c}${g}`,El(x))}normalizeTileURL(s,c,g){if(this._isSkuTokenExpired()&&this._createSkuToken(),s&&!f.f(s))return s;const b=bs(s);b.path=b.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${c||g&&"raster"!==b.authority&&512===g?"@2x":""}${f.m.supported?".webp":"$1"}`),"raster"===b.authority?b.path=`/${f.e.RASTER_URL_PREFIX}${b.path}`:"rasterarrays"===b.authority?b.path=`/${f.e.RASTERARRAYS_URL_PREFIX}${b.path}`:"3dtiles"===b.authority?b.path=`/${f.e.TILES3D_URL_PREFIX}${b.path}`:(b.path=b.path.replace(/^.+\/v4\//,"/"),b.path=`/${f.e.TILE_URL_VERSION}${b.path}`);const x=this._customAccessToken||function(M){for(const A of M){const F=A.match(/^access_token=(.*)$/);if(F)return F[1]}return null}(b.params)||f.e.ACCESS_TOKEN;return f.e.REQUIRE_ACCESS_TOKEN&&x&&this._skuToken&&b.params.push(`sku=${this._skuToken}`),this._makeAPIURL(b,x)}canonicalizeTileURL(s,c){const g=bs(s);if(!g.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!g.path.match(/\.[\w]+$/))return s;let b="mapbox://";g.path.match(/^\/raster\/v1\//)?b+=`raster/${g.path.replace(`/${f.e.RASTER_URL_PREFIX}/`,"")}`:g.path.match(/^\/rasterarrays\/v1\//)?b+=`rasterarrays/${g.path.replace(`/${f.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:b+=`tiles/${g.path.replace(`/${f.e.TILE_URL_VERSION}/`,"")}`;let x=g.params;return c&&(x=x.filter(M=>!M.match(/^access_token=/))),x.length&&(b+=`?${x.join("&")}`),b}canonicalizeTileset(s,c){const g=!!c&&f.f(c),b=[];for(const x of s.tiles||[])f.h(x)?b.push(this.canonicalizeTileURL(x,g)):b.push(x);return b}_makeAPIURL(s,c){const g="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",b=bs(f.e.API_URL);if(s.protocol=b.protocol,s.authority=b.authority,"http"===s.protocol){const x=s.params.indexOf("secure");x>=0&&s.params.splice(x,1)}if("/"!==b.path&&(s.path=`${b.path}${s.path}`),!f.e.REQUIRE_ACCESS_TOKEN)return El(s);if(c=c||f.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!c)throw new Error(`An API access token is required to use Mapbox GL. ${g}`);if("s"===c[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${g}`)}return s.params=s.params.filter(x=>-1===x.indexOf("access_token")),s.params.push(`access_token=${c||""}`),El(s)}}const ei=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function bs(m){const s=m.match(ei);if(!s)throw new Error("Unable to parse URL object");return{protocol:s[1],authority:s[2],path:s[3]||"/",params:s[4]?s[4].split("&"):[]}}function El(m){const s=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${s}`}const Cd="mapbox.eventData";function Un(m){if(!m)return null;const s=m.split(".");if(!s||3!==s.length)return null;try{return JSON.parse(f.j(s[1]))}catch{return null}}class lc{constructor(s){this.type=s,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(s){const c=Un(f.e.ACCESS_TOKEN);let g="";return g=c&&c.u?f.k(c.u):f.e.ACCESS_TOKEN||"",s?`${Cd}.${s}:${g}`:`${Cd}:${g}`}fetchEventData(){const s=f.s("localStorage"),c=this.getStorageKey(),g=this.getStorageKey("uuid");if(s)try{const b=localStorage.getItem(c);b&&(this.eventData=JSON.parse(b));const x=localStorage.getItem(g);x&&(this.anonId=x)}catch{f.w("Unable to read from LocalStorage")}}saveEventData(){const s=f.s("localStorage"),c=this.getStorageKey(),g=this.getStorageKey("uuid"),b=this.anonId;if(s&&b)try{localStorage.setItem(g,b),Object.keys(this.eventData).length>=1&&localStorage.setItem(c,JSON.stringify(this.eventData))}catch{f.w("Unable to write to LocalStorage")}}processRequests(s){}postEvent(s,c,g,b){if(!f.e.EVENTS_URL)return;const x=bs(f.e.EVENTS_URL);x.params.push(`access_token=${b||f.e.ACCESS_TOKEN||""}`);const M={event:this.type,created:new Date(s).toISOString()},A=c?f.l(M,c):M,F={url:El(x),headers:{"Content-Type":"text/plain"},body:JSON.stringify([A])};this.pendingRequest=f.p(F,N=>{this.pendingRequest=null,g(N),this.saveEventData(),this.processRequests(b)})}queueRequest(s,c){this.queue.push(s),this.processRequests(c)}}const sp=new class extends lc{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,s){f.e.EVENTS_URL&&f.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some(c=>f.f(c)||f.h(c))&&this.queueRequest(Date.now(),s)}processRequests(m){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const s=Un(f.e.ACCESS_TOKEN),c=s?s.u:f.e.ACCESS_TOKEN;let g=c!==this.eventData.tokenU;f.v(this.anonId)||(this.anonId=f.u(),g=!0);const b=this.queue.shift();if(this.eventData.lastSuccess){const x=new Date(this.eventData.lastSuccess),M=new Date(b),A=(b-this.eventData.lastSuccess)/864e5;g=g||A>=1||A<-1||x.getDate()!==M.getDate()}else g=!0;g?this.postEvent(b,{sdkIdentifier:"mapbox-gl-js",sdkVersion:To,skuId:ac,"enabled.telemetry":!1,userId:this.anonId},x=>{x||(this.eventData.lastSuccess=b,this.eventData.tokenU=c)},m):this.processRequests()}},Lh=sp.postTurnstileEvent.bind(sp),Fn=new class extends lc{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,s,c,g){this.skuToken=s,this.errorCb=g,f.e.EVENTS_URL&&(c||f.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(nl)))}processRequests(m){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||(this.anonId||this.fetchEventData(),f.v(this.anonId)||(this.anonId=f.u()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:To,skuId:ac,skuToken:this.skuToken,userId:this.anonId},g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},m))}remove(){this.errorCb=null}},Nh=Fn.postMapLoadEvent.bind(Fn),Dl=new class extends lc{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let s=this.mapInstanceIdMap.get(m);return s||(s=f.u(),this.mapInstanceIdMap.set(m,s)),s}getEventId(m){const s=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,s+1),s}postStyleLoadEvent(m,s){const{map:c,style:g,importedStyles:b}=s;if(!f.e.EVENTS_URL||!m&&!f.e.ACCESS_TOKEN)return;const x=this.getMapInstanceId(c),M={mapInstanceId:x,eventId:this.getEventId(x),style:g};b.length&&(M.importedStyles=b),this.queueRequest({timestamp:Date.now(),payload:M},m)}processRequests(m){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:s,payload:c}=this.queue.shift();this.postEvent(s,c,()=>{},m)}},qs=Dl.postStyleLoadEvent.bind(Dl),zh=new class extends lc{constructor(){super("gljs.performance")}postPerformanceEvent(m,s){f.e.EVENTS_URL&&(m||f.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:s},m)}processRequests(m){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:s,performanceData:c}=this.queue.shift(),g=function(b){const x=performance.getEntriesByType("resource"),M=performance.getEntriesByType("mark"),A=function(G){const J={};if(G)for(const Q in G)if("other"!==Q)for(const te of G[Q]){const ne=`${Q}ResolveRangeMin`,le=`${Q}ResolveRangeMax`,me=`${Q}RequestCount`,pe=`${Q}RequestCachedCount`;J[ne]=Math.min(J[ne]||1/0,te.startTime),J[le]=Math.max(J[le]||-1/0,te.responseEnd);const xe=ve=>{void 0===J[ve]&&(J[ve]=0),++J[ve]};void 0!==te.transferSize&&0===te.transferSize&&xe(pe),xe(me)}return J}(function(G,J){const Q={};if(G)for(const te of G){const ne=J(te);void 0===Q[ne]&&(Q[ne]=[]),Q[ne].push(te)}return Q}(x,Xn)),F=window.devicePixelRatio,N=navigator.connection||navigator.mozConnection||navigator.webkitConnection,z=N?N.effectiveType:void 0,H={counters:[],metadata:[],attributes:[]},j=(G,J,Q)=>{null!=Q&&G.push({name:J,value:Q.toString()})};for(const G in A)j(H.counters,G,A[G]);if(b.interactionRange[0]!==1/0&&b.interactionRange[1]!==-1/0&&(j(H.counters,"interactionRangeMin",b.interactionRange[0]),j(H.counters,"interactionRangeMax",b.interactionRange[1])),M)for(const G of Object.keys(Gs)){const J=Gs[G],Q=M.find(te=>te.name===J);Q&&j(H.counters,J,Q.startTime)}return j(H.counters,"visibilityHidden",b.visibilityHidden),j(H.attributes,"style",function(G){if(G)for(const J of G){const Q=J.name.split("?")[0];if(f.i(Q)){const te=Q.split("/").slice(-2);if(2===te.length)return`mapbox://styles/${te[0]}/${te[1]}`}}}(x)),j(H.attributes,"terrainEnabled",b.terrainEnabled?"true":"false"),j(H.attributes,"fogEnabled",b.fogEnabled?"true":"false"),j(H.attributes,"projection",b.projection),j(H.attributes,"zoom",b.zoom),j(H.metadata,"devicePixelRatio",F),j(H.metadata,"connectionEffectiveType",z),j(H.metadata,"navigatorUserAgent",navigator.userAgent),j(H.metadata,"screenWidth",window.screen.width),j(H.metadata,"screenHeight",window.screen.height),j(H.metadata,"windowWidth",window.innerWidth),j(H.metadata,"windowHeight",window.innerHeight),j(H.metadata,"mapWidth",b.width/F),j(H.metadata,"mapHeight",b.height/F),j(H.metadata,"webglRenderer",b.renderer),j(H.metadata,"webglVendor",b.vendor),j(H.metadata,"sdkVersion",To),j(H.metadata,"sdkIdentifier","mapbox-gl-js"),H}(c);for(const b of g.metadata);for(const b of g.counters);for(const b of g.attributes);this.postEvent(s,g,()=>{},m)}},Ym=zh.postPerformanceEvent.bind(zh),Bh=new class extends lc{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,s,c,g){if(!f.e.API_URL||!f.e.SESSION_PATH)return;const b=bs(f.e.API_URL+f.e.SESSION_PATH);b.params.push(`sku=${s||""}`),b.params.push(`access_token=${g||f.e.ACCESS_TOKEN||""}`);const x={url:El(b),headers:{"Content-Type":"text/plain"}};this.pendingRequest=f.g(x,M=>{this.pendingRequest=null,c(M),this.saveEventData(),this.processRequests(g)})}getSessionAPI(m,s,c,g){this.skuToken=s,this.errorCb=g,f.e.SESSION_PATH&&f.e.API_URL&&(c||f.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(nl)))}processRequests(m){if(this.pendingRequest||0===this.queue.length)return;const{id:s,timestamp:c}=this.queue.shift();s&&this.success[s]||this.getSession(c,this.skuToken,g=>{g?this.errorCb(g):s&&(this.success[s]=!0)},m)}remove(){this.errorCb=null}},Oe=Bh.getSessionAPI.bind(Bh),Nc=new Set;function bu(m,s){s?Nc.add(m):Nc.delete(m)}class xu{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(s,c){this._updatedSourceCaches[s]=c,this.setDirty()}discardSourceCacheUpdate(s){delete this._updatedSourceCaches[s]}updateLayer(s){const c=s.scope;this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._updatedLayers[c].add(s.id),this.setDirty()}removeLayer(s){const c=s.scope;this._removedLayers[c]=this._removedLayers[c]||{},this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._removedLayers[c][s.id]=s,this._updatedLayers[c].delete(s.id),this._updatedPaintProps.delete(s.fqid),this.setDirty()}getRemovedLayer(s){return this._removedLayers[s.scope]?this._removedLayers[s.scope][s.id]:null}discardLayerRemoval(s){this._removedLayers[s.scope]&&delete this._removedLayers[s.scope][s.id]}getLayerUpdatesByScope(){const s={};for(const c in this._updatedLayers)s[c]=s[c]||{},s[c].updatedIds=Array.from(this._updatedLayers[c].values());for(const c in this._removedLayers)s[c]=s[c]||{},s[c].removedIds=Object.keys(this._removedLayers[c]);return s}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(s){this._updatedPaintProps.add(s.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(s){this._updatedImages.add(s),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function Ft(m){const{userImage:s}=m;return!!(s&&s.render&&s.render())&&(m.data.replace(new Uint8Array(s.data.buffer)),!0)}class zc extends f.E{constructor(s){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=s,"raster"!==s&&f.t()&&(this.imageRasterizerDispatcher=new f.D(f.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new f.I),this._imageRasterizer}createScope(s){this.images[s]={},this.loaded[s]=!1,this.updatedImages[s]={},this.patterns[s]={},this.callbackDispatchedThisFrame[s]={},this.atlasImage[s]=new f.r({width:1,height:1})}isLoaded(){for(const s in this.loaded)if(!this.loaded[s])return!1;return!0}setLoaded(s,c){if(this.loaded[c]!==s&&(this.loaded[c]=s,s)){for(const{ids:g,callback:b}of this.requestors)this._notify(g,c,b);this.requestors=[]}}hasImage(s,c){return!!this.getImage(s,c)}getImage(s,c){return this.images[c][s]}addImage(s,c,g){this._validate(s,g)&&(this.images[c][s]=g)}_validate(s,c){let g=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new f.y(new Error(`Image "${s}" has invalid "stretchX" value`))),g=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new f.y(new Error(`Image "${s}" has invalid "stretchY" value`))),g=!1),this._validateContent(c.content,c)||(this.fire(new f.y(new Error(`Image "${s}" has invalid "content" value`))),g=!1),g}_validateStretch(s,c){if(!s)return!0;let g=0;for(const b of s){if(b[0]<g||b[1]<b[0]||c<b[1])return!1;g=b[1]}return!0}_validateContent(s,c){return!s||!(4!==s.length||!c.usvg&&(s[0]<0||c.data.width<s[0]||s[1]<0||c.data.height<s[1]||s[2]<0||c.data.width<s[2]||s[3]<0||c.data.height<s[3]))&&!(s[2]<s[0]||s[3]<s[1])}updateImage(s,c,g){g.version=this.images[c][s].version+1,this.images[c][s]=g,this.updatedImages[c][s]=!0,this.removeFromImageRasterizerCache(s,c)}removeFromImageRasterizerCache(s,c){"raster"!==this.spriteFormat&&(f.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[s],scope:c}):this.imageRasterizer.removeImagesFromCacheByIds([s],c))}removeImage(s,c){const g=this.images[c][s];delete this.images[c][s],delete this.patterns[c][s],this.removeFromImageRasterizerCache(s,c),g.userImage&&g.userImage.onRemove&&g.userImage.onRemove()}listImages(s){return Object.keys(this.images[s])}getImages(s,c,g){let b=!0;const x=!!this.loaded[c];if(!x)for(const M of s)this.images[c][M]||(b=!1);x||b?this._notify(s,c,g):this.requestors.push({ids:s,scope:c,callback:g})}rasterizeImages({scope:s,imageTasks:c},g){const b={};for(const x in c){const M=c[x],A=this.getImage(M.id,s);A&&(b[x]={image:A,imageIdWithOptions:M})}f.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:b,scope:s},g):this.rasterizeImagesInMainThread({imageTasks:b,scope:s},g)}rasterizeImagesInMainThread(s,c){const{imageTasks:g,scope:b}=s,x={};for(const M in g){const{image:A,imageIdWithOptions:F}=g[M];x[M]=this.imageRasterizer.rasterize(F,A,b,"")}c(void 0,x)}getUpdatedImages(s){return this.updatedImages[s]}_notify(s,c,g){const b={};for(const x of s){this.images[c][x]||this.fire(new f.z("styleimagemissing",{id:x}));const M=this.images[c][x];M?b[x]={data:M.usvg?null:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,usvg:M.usvg,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:!(!M.userImage||!M.userImage.render)}:f.w(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}g(null,b)}getPixelSize(s){const{width:c,height:g}=this.atlasImage[s];return{width:c,height:g}}getPattern(s,c,g){const b=this.patterns[c][s],x=this.getImage(s,c);if(!x)return null;if(b&&b.position.version===x.version)return b.position;if(b)b.position.version=x.version;else{x.usvg&&!x.data&&(x.data=this.imageRasterizer.rasterize(f.A.from(s).getPrimary(),x,c,""));const M={w:x.data.width+2*f.B,h:x.data.height+2*f.B,x:0,y:0},A=new f.F(M,x,f.B);this.patterns[c][s]={bin:M,position:A}}return this._updatePatternAtlas(c,g),this.patterns[c][s].position}bind(s,c){const g=s.gl;let b=this.atlasTexture[c];b?this.dirty&&(b.update(this.atlasImage[c]),this.dirty=!1):(b=new f.T(s,this.atlasImage[c],g.RGBA8),this.atlasTexture[c]=b),b.bind(g.LINEAR,g.CLAMP_TO_EDGE)}_updatePatternAtlas(s,c){const g=[];for(const A in this.patterns[s])g.push(this.patterns[s][A].bin);const{w:b,h:x}=f.C(g),M=this.atlasImage[s];M.resize({width:b||1,height:x||1});for(const A in this.patterns[s]){const{bin:F,position:N}=this.patterns[s][A];let z=N.padding;const H=F.x+z,j=F.y+z,G=this.images[s][A].data,J=G.width,Q=G.height;z=z>1?z-1:z,f.r.copy(G,M,{x:0,y:0},{x:H,y:j},{width:J,height:Q},c),f.r.copy(G,M,{x:0,y:Q-z},{x:H,y:j-z},{width:J,height:z},c),f.r.copy(G,M,{x:0,y:0},{x:H,y:j+Q},{width:J,height:z},c),f.r.copy(G,M,{x:J-z,y:0},{x:H-z,y:j},{width:z,height:Q},c),f.r.copy(G,M,{x:0,y:0},{x:H+J,y:j},{width:z,height:Q},c),f.r.copy(G,M,{x:J-z,y:Q-z},{x:H-z,y:j-z},{width:z,height:z},c),f.r.copy(G,M,{x:0,y:Q-z},{x:H+J,y:j-z},{width:z,height:z},c),f.r.copy(G,M,{x:0,y:0},{x:H+J,y:j+Q},{width:z,height:z},c),f.r.copy(G,M,{x:J-z,y:0},{x:H-z,y:j+Q},{width:z,height:z},c)}this.dirty=!0}beginFrame(){for(const s in this.images)this.callbackDispatchedThisFrame[s]={}}dispatchRenderCallbacks(s,c){for(const g of s){if(this.callbackDispatchedThisFrame[c][g])continue;this.callbackDispatchedThisFrame[c][g]=!0;const b=this.images[c][g];Ft(b)&&this.updateImage(g,c,b)}}}function Ho(m){const s=m.key,c=m.value,g=m.valueSpec||{},b=m.objectElementValidators||{},x=m.style,M=m.styleSpec;let A=[];const F=f.H(c);if("object"!==F)return[new f.V(s,c,`object expected, ${F} found`)];for(const N in c){const z=N.split(".")[0];let H;b[z]?H=b[z]:g[z]?H=Yn:b["*"]?H=b["*"]:g["*"]&&(H=Yn),H?A=A.concat(H({key:(s&&`${s}.`)+N,value:c[N],valueSpec:g[z]||g["*"],style:x,styleSpec:M,object:c,objectKey:N},c)):A.push(new f.G(s,c[N],`unknown property "${N}"`))}for(const N in g)b[N]||g[N].required&&void 0===g[N].default&&void 0===c[N]&&A.push(new f.V(s,c,`missing required property "${N}"`));return A}function Bc(m){const s=m.value,c=m.valueSpec,g=m.style,b=m.styleSpec,x=m.key,M=m.arrayElementValidator||Yn;if("array"!==f.H(s))return[new f.V(x,s,`array expected, ${f.H(s)} found`)];if(c.length&&s.length!==c.length)return[new f.V(x,s,`array length ${c.length} expected, length ${s.length} found`)];if(c["min-length"]&&s.length<c["min-length"])return[new f.V(x,s,`array length at least ${c["min-length"]} expected, length ${s.length} found`)];let A={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};b.$version<7&&(A.function=c.function),"object"===f.H(c.value)&&(A=c.value);let F=[];for(let N=0;N<s.length;N++)F=F.concat(M({array:s,arrayIndex:N,value:s[N],valueSpec:A,style:g,styleSpec:b,key:`${x}[${N}]`},!0));return F}function vi(m){const s=m.key,c=m.value,g=m.valueSpec;let b=f.H(c);if("number"===b&&c!=c&&(b="NaN"),"number"!==b)return[new f.V(s,c,`number expected, ${b} found`)];if("minimum"in g){let x=g.minimum;if("array"===f.H(g.minimum)&&(x=g.minimum[m.arrayIndex]),c<x)return[new f.V(s,c,`${c} is less than the minimum value ${x}`)]}if("maximum"in g){let x=g.maximum;if("array"===f.H(g.maximum)&&(x=g.maximum[m.arrayIndex]),c>x)return[new f.V(s,c,`${c} is greater than the maximum value ${x}`)]}return[]}function pi(m){const s=m.valueSpec,c=f.K(m.value.type);let g,b,x,M={};const A="categorical"!==c&&void 0===m.value.property,F=!A,N="array"===f.H(m.value.stops)&&"array"===f.H(m.value.stops[0])&&"object"===f.H(m.value.stops[0][0]),z=Ho({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(G){if("identity"===c)return[new f.V(G.key,G.value,'identity function may not have a "stops" property')];let J=[];const Q=G.value;return J=J.concat(Bc({key:G.key,value:Q,valueSpec:G.valueSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:H})),"array"===f.H(Q)&&0===Q.length&&J.push(new f.V(G.key,Q,"array must have at least one stop")),J},default:function(G){return Yn({key:G.key,value:G.value,valueSpec:s,style:G.style,styleSpec:G.styleSpec})}}});return"identity"===c&&A&&z.push(new f.V(m.key,m.value,'missing required property "property"')),"identity"===c||m.value.stops||z.push(new f.V(m.key,m.value,'missing required property "stops"')),"exponential"===c&&m.valueSpec.expression&&!f.L(m.valueSpec)&&z.push(new f.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(F&&!f.M(m.valueSpec)?z.push(new f.V(m.key,m.value,"property functions not supported")):A&&!f.N(m.valueSpec)&&z.push(new f.V(m.key,m.value,"zoom functions not supported"))),"categorical"!==c&&!N||void 0!==m.value.property||z.push(new f.V(m.key,m.value,'"property" property is required')),z;function H(G){let J=[];const Q=G.value,te=G.key;if("array"!==f.H(Q))return[new f.V(te,Q,`array expected, ${f.H(Q)} found`)];if(2!==Q.length)return[new f.V(te,Q,`array length 2 expected, length ${Q.length} found`)];if(N){if("object"!==f.H(Q[0]))return[new f.V(te,Q,`object expected, ${f.H(Q[0])} found`)];if(void 0===Q[0].zoom)return[new f.V(te,Q,"object stop key must have zoom")];if(void 0===Q[0].value)return[new f.V(te,Q,"object stop key must have value")];const ne=f.K(Q[0].zoom);if("number"!=typeof ne)return[new f.V(te,Q[0].zoom,"stop zoom values must be numbers")];if(x&&x>ne)return[new f.V(te,Q[0].zoom,"stop zoom values must appear in ascending order")];ne!==x&&(x=ne,b=void 0,M={}),J=J.concat(Ho({key:`${te}[0]`,value:Q[0],valueSpec:{zoom:{}},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:vi,value:j}}))}else J=J.concat(j({key:`${te}[0]`,value:Q[0],valueSpec:{},style:G.style,styleSpec:G.styleSpec},Q));return f.O(f.Q(Q[1]))?J.concat([new f.V(`${te}[1]`,Q[1],"expressions are not allowed in function stops.")]):J.concat(Yn({key:`${te}[1]`,value:Q[1],valueSpec:s,style:G.style,styleSpec:G.styleSpec}))}function j(G,J){const Q=f.H(G.value),te=f.K(G.value),ne=null!==G.value?G.value:J;if(g){if(Q!==g)return[new f.V(G.key,ne,`${Q} stop domain type must match previous stop domain type ${g}`)]}else g=Q;if("number"!==Q&&"string"!==Q&&"boolean"!==Q&&"number"!=typeof te&&"string"!=typeof te&&"boolean"!=typeof te)return[new f.V(G.key,ne,"stop domain value must be a number, string, or boolean")];if("number"!==Q&&"categorical"!==c){let le=`number expected, ${Q} found`;return f.M(s)&&void 0===c&&(le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new f.V(G.key,ne,le)]}return"categorical"!==c||"number"!==Q||"number"==typeof te&&isFinite(te)&&Math.floor(te)===te?"categorical"!==c&&"number"===Q&&"number"==typeof te&&"number"==typeof b&&void 0!==b&&te<b?[new f.V(G.key,ne,"stop domain values must appear in ascending order")]:(b=te,"categorical"===c&&te in M?[new f.V(G.key,ne,"stop domain values must be unique")]:(M[te]=!0,[])):[new f.V(G.key,ne,`integer expected, found ${String(te)}`)]}}function Fa(m){const s=("property"===m.expressionContext?f.S:f.U)(f.Q(m.value),m.valueSpec);if("error"===s.result)return s.value.map(g=>new f.V(`${m.key}${g.key}`,m.value,g.message));const c=s.value.expression||s.value._styleExpression.expression;if("property"===m.expressionContext&&"text-font"===m.propertyKey&&!c.outputDefined())return[new f.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===m.expressionContext&&"layout"===m.propertyType&&!f.W(c))return[new f.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===m.expressionContext)return Vc(c,m);if(m.expressionContext&&0===m.expressionContext.indexOf("cluster")){if(!f.X(c,["zoom","feature-state"]))return[new f.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===m.expressionContext&&!f.Y(c))return[new f.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vc(m,s){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(s.valueSpec&&s.valueSpec.expression)for(const b of s.valueSpec.expression.parameters)c.delete(b);if(0===c.size)return[];const g=[];return m instanceof f.Z&&c.has(m.name)?[new f.V(s.key,s.value,`["${m.name}"] expression is not supported in a filter for a ${s.object.type} layer with id: ${s.object.id}`)]:(m.eachChild(b=>{g.push(...Vc(b,s))}),g)}function Il(m){const s=m.key,c=m.value,g=m.valueSpec,b=[];return Array.isArray(g.values)?-1===g.values.indexOf(f.K(c))&&b.push(new f.V(s,c,`expected one of [${g.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(g.values).indexOf(f.K(c))&&b.push(new f.V(s,c,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(c)} found`)),b}function Ni(m){return f.$(f.Q(m.value))?Fa(f.J({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):En(m)}function En(m){const s=m.value,c=m.key;if("array"!==f.H(s))return[new f.V(c,s,`array expected, ${f.H(s)} found`)];const g=m.styleSpec;let b,x=[];if(s.length<1)return[new f.V(c,s,"filter array must have at least 1 element")];switch(x=x.concat(Il({key:`${c}[0]`,value:s[0],valueSpec:g.filter_operator,style:m.style,styleSpec:m.styleSpec})),f.K(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&"$type"===f.K(s[1])&&x.push(new f.V(c,s,`"$type" cannot be use with operator "${s[0]}"`));case"==":case"!=":3!==s.length&&x.push(new f.V(c,s,`filter array for operator "${s[0]}" must have 3 elements`));case"in":case"!in":s.length>=2&&(b=f.H(s[1]),"string"!==b&&x.push(new f.V(`${c}[1]`,s[1],`string expected, ${b} found`)));for(let M=2;M<s.length;M++)b=f.H(s[M]),"$type"===f.K(s[1])?x=x.concat(Il({key:`${c}[${M}]`,value:s[M],valueSpec:g.geometry_type,style:m.style,styleSpec:m.styleSpec})):"string"!==b&&"number"!==b&&"boolean"!==b&&x.push(new f.V(`${c}[${M}]`,s[M],`string, number, or boolean expected, ${b} found`));break;case"any":case"all":case"none":for(let M=1;M<s.length;M++)x=x.concat(En({key:`${c}[${M}]`,value:s[M],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":b=f.H(s[1]),2!==s.length?x.push(new f.V(c,s,`filter array for "${s[0]}" operator must have 2 elements`)):"string"!==b&&x.push(new f.V(`${c}[1]`,s[1],`string expected, ${b} found`))}return x}function wu(m,s){const c=m.key,g=m.style,b=m.layer,x=m.styleSpec,M=m.value,A=m.objectKey,F=x[`${s}_${m.layerType}`];if(!F)return[];const N=A.match(/^(.*)-use-theme$/);if("paint"===s&&N&&F[N[1]])return Yn({key:c,value:M,valueSpec:{type:"string"},style:g,styleSpec:x});const z=A.match(/^(.*)-transition$/);if("paint"===s&&z&&F[z[1]]&&F[z[1]].transition)return Yn({key:c,value:M,valueSpec:x.transition,style:g,styleSpec:x});const H=m.valueSpec||F[A];if(!H)return[new f.G(c,M,`unknown property "${A}"`)];let j;if("string"===f.H(M)&&f.M(H)&&!H.tokens&&(j=/^{([^}]+)}$/.exec(M))){const J=`\`{ "type": "identity", "property": ${j?JSON.stringify(j[1]):'"_"'} }\``;return[new f.V(c,M,`"${A}" does not support interpolation syntax\nUse an identity property function instead: ${J}.`)]}const G=[];if("symbol"===m.layerType)"text-field"!==A||!g||g.glyphs||g.imports||G.push(new f.V(c,M,'use of "text-field" requires a style "glyphs" property')),"text-font"===A&&f.a0(f.Q(M))&&"identity"===f.K(M.type)&&G.push(new f.V(c,M,'"text-font" does not support identity functions'));else if("model"===m.layerType&&"paint"===s&&b&&b.layout&&b.layout.hasOwnProperty("model-id")&&f.M(H)&&(f.a1(H)||f.N(H))){const J=f.S(f.Q(M),H),Q=J.value.expression||J.value._styleExpression.expression;Q&&!f.X(Q,["measure-light"])&&("model-emissive-strength"===A&&f.Y(Q)&&f.W(Q)||G.push(new f.V(c,M,`${A} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return G.concat(Yn({key:m.key,value:M,valueSpec:H,style:g,styleSpec:x,expressionContext:"property",propertyType:s,propertyKey:A}))}function cc(m){return wu(m,"paint")}function La(m){return wu(m,"layout")}function $o(m){let s=[];const c=m.value,g=m.key,b=m.style,x=m.styleSpec;c.type||c.ref||s.push(new f.V(g,c,'either "type" or "ref" is required'));let M=f.K(c.type);const A=f.K(c.ref);if(c.id){const F=f.K(c.id);for(let N=0;N<m.arrayIndex;N++){const z=b.layers[N];f.K(z.id)===F&&s.push(new f.V(g,c.id,`duplicate layer id "${c.id}", previously used at line ${z.id.__line__}`))}}if("ref"in c){let F;["type","source","source-layer","filter","layout"].forEach(N=>{N in c&&s.push(new f.V(g,c[N],`"${N}" is prohibited for ref layers`))}),b.layers.forEach(N=>{f.K(N.id)===A&&(F=N)}),F?F.ref?s.push(new f.V(g,c.ref,"ref cannot reference another ref layer")):M=f.K(F.type):"string"==typeof A&&s.push(new f.V(g,c.ref,`ref layer "${A}" not found`))}else if("background"!==M&&"sky"!==M&&"slot"!==M)if(c.source){const F=b.sources&&b.sources[c.source],N=F&&f.K(F.type);F?"vector"===N&&"raster"===M?s.push(new f.V(g,c.source,`layer "${c.id}" requires a raster source`)):"raster"===N&&"raster"!==M?s.push(new f.V(g,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==N||c["source-layer"]?"raster-dem"===N&&"hillshade"!==M?s.push(new f.V(g,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"raster-array"!==N||["raster","raster-particle"].includes(M)?"line"!==M||!c.paint||!c.paint["line-gradient"]&&!c.paint["line-trim-offset"]||"geojson"===N&&F.lineMetrics?"raster-particle"===M&&"raster-array"!==N&&s.push(new f.V(g,c.source,`layer "${c.id}" requires a 'raster-array' source.`)):s.push(new f.V(g,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):s.push(new f.V(g,c.source,"raster-array source can only be used with layer type 'raster'.")):s.push(new f.V(g,c,`layer "${c.id}" must specify a "source-layer"`)):s.push(new f.V(g,c.source,`source "${c.source}" not found`))}else s.push(new f.V(g,c,'missing required property "source"'));return s=s.concat(Ho({key:g,value:c,valueSpec:x.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Yn({key:`${g}.type`,value:c.type,valueSpec:x.layer.type,style:m.style,styleSpec:m.styleSpec,object:c,objectKey:"type"}),filter:F=>Ni(f.J({layerType:M},F)),layout:F=>Ho({layer:c,key:F.key,value:F.value,valueSpec:{},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":N=>La(f.J({layerType:M},N))}}),paint:F=>Ho({layer:c,key:F.key,value:F.value,valueSpec:{},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{"*":N=>cc(f.J({layerType:M,layer:c},N))}})}})),s}function ga(m){const s=m.value,c=m.key,g=f.H(s);return"string"!==g?[new f.V(c,s,`string expected, ${g} found`)]:[]}const Cu={promoteId:function({key:m,value:s}){if("string"===f.H(s))return ga({key:m,value:s});{const c=[];for(const g in s)c.push(...ga({key:`${m}.${g}`,value:s[g]}));return c}}};function ap(m){const s=m.value,c=m.key,g=m.styleSpec,b=m.style;if(!s.type)return[new f.V(c,s,'"type" is required')];const x=f.K(s.type);let M=[];switch(["vector","raster","raster-dem","raster-array"].includes(x)&&(s.url||s.tiles||M.push(new f.G(c,s,'Either "url" or "tiles" is required.'))),x){case"vector":case"raster":case"raster-dem":case"raster-array":return M=M.concat(Ho({key:c,value:s,valueSpec:g[`source_${x.replace("-","_")}`],style:m.style,styleSpec:g,objectElementValidators:Cu})),M;case"geojson":if(M=Ho({key:c,value:s,valueSpec:g.source_geojson,style:b,styleSpec:g,objectElementValidators:Cu}),s.cluster)for(const A in s.clusterProperties){const[F,N]=s.clusterProperties[A],z="string"==typeof F?[F,["accumulated"],["get",A]]:F;M.push(...Fa({key:`${c}.${A}.map`,value:N,expressionContext:"cluster-map"})),M.push(...Fa({key:`${c}.${A}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return M;case"video":return Ho({key:c,value:s,valueSpec:g.source_video,style:b,styleSpec:g});case"image":return Ho({key:c,value:s,valueSpec:g.source_image,style:b,styleSpec:g});case"canvas":return[new f.V(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Il({key:`${c}.type`,value:s.type,valueSpec:{values:Vh(g)},style:b,styleSpec:g})}}function Vh(m){return m.source.reduce((s,c)=>{const g=m[c];return"enum"===g.type.type&&(s=s.concat(Object.keys(g.type.values))),s},[])}function Uc(m){const s=m.value,c=m.styleSpec,g=c.light,b=m.style;let x=[];const M=f.H(s);if(void 0===s)return x;if("object"!==M)return x=x.concat([new f.V("light",s,`object expected, ${M} found`)]),x;for(const A in s){const F=A.match(/^(.*)-transition$/),N=A.match(/^(.*)-use-theme$/);x=x.concat(N&&g[N[1]]?Yn({key:A,value:s[A],valueSpec:{type:"string"},style:b,styleSpec:c}):F&&g[F[1]]&&g[F[1]].transition?Yn({key:A,value:s[A],valueSpec:c.transition,style:b,styleSpec:c}):g[A]?Yn({key:A,value:s[A],valueSpec:g[A],style:b,styleSpec:c}):[new f.V(A,s[A],`unknown property "${A}"`)])}return x}function jc(m){const s=m.value;let c=[];if(!s)return c;const g=f.H(s);if("object"!==g)return c=c.concat([new f.V("light-3d",s,`object expected, ${g} found`)]),c;const b=m.styleSpec,x=b["light-3d"],M=m.key,A=m.style,F=m.style.lights;for(const H of["type","id"])if(!(H in s))return c=c.concat([new f.V("light-3d",s,`missing property ${H} on light`)]),c;if(s.type&&F)for(let H=0;H<m.arrayIndex;H++){const j=f.K(s.type),G=F[H];f.K(G.type)===j&&c.push(new f.V(M,s.id,`duplicate light type "${s.type}", previously defined at line ${G.id.__line__}`))}const N=`properties_light_${s.type}`;if(!(N in b))return c=c.concat([new f.V("light-3d",s,`Invalid light type ${s.type}`)]),c;const z=b[N];for(const H in s)if("properties"===H){const j=s[H],G=f.H(j);if("object"!==G)return c=c.concat([new f.V("properties",j,`object expected, ${G} found`)]),c;for(const J in j)c=c.concat(z[J]?Yn({key:J,value:j[J],valueSpec:z[J],style:A,styleSpec:b}):[new f.G(m.key,j[J],`unknown property "${J}"`)])}else{const j=H.match(/^(.*)-transition$/),G=H.match(/^(.*)-use-theme$/);c=c.concat(G&&x[G[1]]?Yn({key:H,value:s[H],valueSpec:{type:"string"},style:A,styleSpec:b}):j&&x[j[1]]&&x[j[1]].transition?Yn({key:H,value:s[H],valueSpec:b.transition,style:A,styleSpec:b}):x[H]?Yn({key:H,value:s[H],valueSpec:x[H],style:A,styleSpec:b}):[new f.G(H,s[H],`unknown property "${H}"`)])}return c}function il(m){const s=m.value,c=m.key,g=m.style,b=m.styleSpec,x=b.terrain;let M=[];const A=f.H(s);if(void 0===s||"null"===A)return M;if("object"!==A)return M=M.concat([new f.V("terrain",s,`object expected, ${A} found`)]),M;for(const F in s){const N=F.match(/^(.*)-transition$/),z=F.match(/^(.*)-use-theme$/);M=M.concat(z&&x[z[1]]?Yn({key:F,value:s[F],valueSpec:{type:"string"},style:g,styleSpec:b}):N&&x[N[1]]&&x[N[1]].transition?Yn({key:F,value:s[F],valueSpec:b.transition,style:g,styleSpec:b}):x[F]?Yn({key:F,value:s[F],valueSpec:x[F],style:g,styleSpec:b}):[new f.G(F,s[F],`unknown property "${F}"`)])}if(s.source){const F=g.sources&&g.sources[s.source],N=F&&f.K(F.type);F?"raster-dem"!==N&&M.push(new f.V(c,s.source,`terrain cannot be used with a source of type ${String(N)}, it only be used with a "raster-dem" source type`)):M.push(new f.V(c,s.source,`source "${s.source}" not found`))}else M.push(new f.V(c,s,'terrain is missing required property "source"'));return M}function Ws(m){const s=m.value,c=m.style,g=m.styleSpec,b=g.fog;let x=[];const M=f.H(s);if(void 0===s)return x;if("object"!==M)return x=x.concat([new f.V("fog",s,`object expected, ${M} found`)]),x;for(const A in s){const F=A.match(/^(.*)-transition$/),N=A.match(/^(.*)-use-theme$/);x=x.concat(N&&b[N[1]]?Yn({key:A,value:s[A],valueSpec:{type:"string"},style:c,styleSpec:g}):F&&b[F[1]]&&b[F[1]].transition?Yn({key:A,value:s[A],valueSpec:g.transition,style:c,styleSpec:g}):b[A]?Yn({key:A,value:s[A],valueSpec:b[A],style:c,styleSpec:g}):[new f.G(A,s[A],`unknown property "${A}"`)])}return x}const lp={"*":()=>[],array:Bc,boolean:function(m){const s=m.value,c=m.key,g=f.H(s);return"boolean"!==g?[new f.V(c,s,`boolean expected, ${g} found`)]:[]},number:vi,color:function(m){const s=m.key,c=m.value,g=f.H(c);return"string"!==g?[new f.V(s,c,`color expected, ${g} found`)]:null===f._.parseCSSColor(c)?[new f.V(s,c,`color expected, "${c}" found`)]:[]},enum:Il,filter:Ni,function:pi,layer:$o,object:Ho,source:ap,model:f.a2,light:Uc,"light-3d":jc,terrain:il,fog:Ws,string:ga,formatted:function(m){return 0===ga(m).length?[]:Fa(m)},resolvedImage:function(m){return 0===ga(m).length?[]:Fa(m)},projection:function(m){const s=m.value,c=m.styleSpec,g=c.projection,b=m.style;let x=[];const M=f.H(s);if("object"===M)for(const A in s)x=x.concat(Yn({key:A,value:s[A],valueSpec:g[A],style:b,styleSpec:c}));else"string"!==M&&(x=x.concat([new f.V("projection",s,`object or string expected, ${M} found`)]));return x},import:function(m){const{value:s,styleSpec:c}=m,{data:g,...b}=s;Object.defineProperty(b,"__line__",{value:s.__line__,enumerable:!1});let x=Ho(f.J({},m,{value:b,valueSpec:c.import}));return""===f.K(b.id)&&x.push(new f.V(`${m.key}.id`,b,"import id can't be an empty string")),g&&(x=x.concat(Uh(g,c,{key:`${m.key}.data`}))),x}};function Yn(m,s=!1){const c=m.value,g=m.valueSpec,b=m.styleSpec;if(g.expression&&f.a0(f.K(c)))return pi(m);if(g.expression&&f.O(f.Q(c)))return Fa(m);if(g.type&&lp[g.type]){const x=lp[g.type](m);return!0===s&&x.length>0&&"array"===f.H(m.value)?Fa(m):x}return Ho(f.J({},m,{valueSpec:g.type?b[g.type]:g}))}function dc(m){const s=m.value,c=m.key,g=ga(m);return g.length||(-1===s.indexOf("{fontstack}")&&g.push(new f.V(c,s,'"glyphs" url must include a "{fontstack}" token')),-1===s.indexOf("{range}")&&g.push(new f.V(c,s,'"glyphs" url must include a "{range}" token'))),g}function Uh(m,s=f.a3,c={}){return Yn({key:c.key||"",value:m,valueSpec:s.$root,styleSpec:s,style:m,objectElementValidators:{glyphs:dc,"*":()=>[]}})}function Zs(m,s=f.a3){return We(Uh(m,s))}const kl=m=>We(ap(m)),Td=m=>We(Uc(m)),cp=m=>We(jc(m)),Md=m=>We(il(m)),dp=m=>We(Ws(m)),tt=m=>We(function(s){const c=s.value,g=s.style,b=s.styleSpec,x=b.snow;let M=[];const A=f.H(c);if(void 0===c)return M;if("object"!==A)return M=M.concat([new f.V("snow",c,`object expected, ${A} found`)]),M;for(const F in c){const N=F.match(/^(.*)-transition$/);M=M.concat(N&&x[N[1]]&&x[N[1]].transition?Yn({key:F,value:c[F],valueSpec:b.transition,style:g,styleSpec:b}):x[F]?Yn({key:F,value:c[F],valueSpec:x[F],style:g,styleSpec:b}):[new f.G(F,c[F],`unknown property "${F}"`)])}return M}(m)),ie=m=>We(function(s){const c=s.value,g=s.style,b=s.styleSpec,x=b.rain;let M=[];const A=f.H(c);if(void 0===c)return M;if("object"!==A)return M=M.concat([new f.V("rain",c,`object expected, ${A} found`)]),M;for(const F in c){const N=F.match(/^(.*)-transition$/);M=M.concat(N&&x[N[1]]&&x[N[1]].transition?Yn({key:F,value:c[F],valueSpec:b.transition,style:g,styleSpec:b}):x[F]?Yn({key:F,value:c[F],valueSpec:x[F],style:g,styleSpec:b}):[new f.G(F,c[F],`unknown property "${F}"`)])}return M}(m)),ae=m=>We($o(m)),ge=m=>We(Ni(m)),Ce=m=>We(cc(m)),Me=m=>We(La(m)),ze=m=>We(f.a2(m));function We(m){return m.slice().sort((s,c)=>s.line&&c.line?s.line-c.line:0)}function Ve(m,s){let c=!1;if(s&&s.length)for(const g of s)g instanceof f.G?f.w(g.message):(m.fire(new f.y(new Error(g.message))),c=!0);return c}let Ie;class nt extends f.E{constructor(s,c="flat"){super(),this._transitionable=new f.a4(Ie||(Ie=new f.a5({anchor:new f.a6(f.a3.light.anchor),position:new f.a7(f.a3.light.position),color:new f.a6(f.a3.light.color),intensity:new f.a6(f.a3.light.intensity)}))),this.setLight(s,c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(s,c,g={}){this._validate(Td,s,g)||(this._transitionable.setTransitionOrValue(s),this.id=c)}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,c,g){return(!g||!1!==g.validate)&&Ve(this,s.call(Zs,f.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:f.a3})))}}let Je=class extends f.E{constructor(m,s,c,g){super(),this.scope=c,this._transitionable=new f.a4(new f.a5({source:new f.a6(f.a3.terrain.source),exaggeration:new f.a6(f.a3.terrain.exaggeration)}),c,g),this._transitionable.setTransitionOrValue(m,g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=s}get(){return this._transitionable.serialize()}set(m,s){this._transitionable.setTransitionOrValue(m,s)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new f.a8(m)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const m=this._transitionable._values.exaggeration;if(!m)return null;const s=m.value.expression;if(!s)return null;let c=-1,g=-1,b=1;for(const x of s.zoomStops)b=s.evaluate(new f.a8(x)),b>.01?(c=x,g=-1):g=x;return b<.01&&c>0&&g>c?[c,g]:null}isZoomDependent(){const m=this._transitionable._values.exaggeration;return null!=m&&null!=m.value&&null!=m.value.expression&&m.value.expression instanceof f.a9}};const Mt=.05;function yn(m,s,c,g){const b=f.ac(45,65,c),[x,M]=$t(m,g);let A=1-Math.min(1,Math.exp((s-x)/(M-x)*-6));return A*=A*A,A=Math.min(1,1.00747*A),A*b*m.alpha}function $t(m,s){const c=.5/Math.tan(.5*s);return[m.range[0]+c,m.range[1]+c]}function Dn(m,s,c,g,b){const x=f.ab.vec3.transformMat4([],[s,c,g],b.mercatorFogMatrix);return yn(m,f.ab.vec3.length(x),b.pitch,b._fov)}function wn(m,s,c,g,b,x,M){const A=[[c,g,0],[b,g,0],[b,x,0],[c,x,0]];let F=Number.MAX_VALUE,N=-Number.MAX_VALUE;for(const z of A){const H=f.ab.vec3.transformMat4([],z,s),j=f.ab.vec3.length(H);F=Math.min(F,j),N=Math.max(N,j)}return[yn(m,F,M.pitch,M._fov),yn(m,N,M.pitch,M._fov)]}class ot extends f.E{constructor(s,c,g,b){super();const x=new f.a5({range:new f.a6(f.a3.fog.range),color:new f.a6(f.a3.fog.color),"color-use-theme":new f.a6({type:"string","property-type":"data-constant",default:"default"}),"high-color":new f.a6(f.a3.fog["high-color"]),"high-color-use-theme":new f.a6({type:"string","property-type":"data-constant",default:"default"}),"space-color":new f.a6(f.a3.fog["space-color"]),"space-color-use-theme":new f.a6({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new f.a6(f.a3.fog["horizon-blend"]),"star-intensity":new f.a6(f.a3.fog["star-intensity"]),"vertical-range":new f.a6(f.a3.fog["vertical-range"])});this._transitionable=new f.a4(x,g,new Map(b)),this.set(s,b),this._transitioning=this._transitionable.untransitioned(),this._transform=c,this.properties=new f.ad(x),this.scope=g}get state(){const s=this._transform,c="globe"===s.projection.name,g=f.ae(s.zoom),b=this.properties.get("range"),x=[.5,3];return{range:c?[f.af(x[0],b[0],g),f.af(x[1],b[1],g)]:b,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(s,c,g={}){if(this._validate(dp,s,g))return;const b=f.l({},s);for(const x of Object.keys(f.a3.fog))void 0===b[x]&&(b[x]=f.a3.fog[x].default);this._options=b,this._transitionable.setTransitionOrValue(this._options,c)}getOpacity(s){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:f.ac(45,65,s))*c.a}getOpacityAtLatLng(s,c){return this._transform.projection.supportsFog?function(g,b,x){const M=f.aa.fromLngLat(b),A=x.elevation?x.elevation.getAtPointOrZero(M):0;return Dn(g,M.x,M.y,A,x)}(this.state,s,c):0}getOpacityForTile(s){if(!this._transform.projection.supportsFog)return[1,1];const c=this._transform.calculateFogTileMatrix(s.toUnwrapped());return wn(this.state,c,0,0,f.ag,f.ag,this._transform)}getOpacityForBounds(s,c,g,b,x){return this._transform.projection.supportsFog?wn(this.state,s,c,g,b,x,this._transform):[1,1]}getFovAdjustedRange(s){return this._transform.projection.supportsFog?$t(this.state,s):[0,1]}isVisibleOnFrustum(s){if(!this._transform.projection.supportsFog)return!1;const c=[4,5,6,7];for(const g of c){const b=s.points[g];let x;if(b[2]>=0)x=b;else{const M=s.points[g-4];x=f.ah(M,b,M[2]/(M[2]-b[2]))}if(Dn(this.state,x[0],x[1],0,this._transform)>=Mt)return!0}return!1}updateConfig(s){this._transitionable.setTransitionOrValue(this._options,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}_validate(s,c,g){return(!g||!1!==g.validate)&&Ve(this,s.call(Zs,f.l({value:c,style:{glyphs:!0,sprite:!0},styleSpec:f.a3})))}}let mi,Kn,Gi,er,Mo=class extends f.E{constructor(m,s,c,g){super();const b=mi||(mi=new f.a5({density:new f.a6(f.a3.snow.density),intensity:new f.a6(f.a3.snow.intensity),color:new f.a6(f.a3.snow.color),opacity:new f.a6(f.a3.snow.opacity),vignette:new f.a6(f.a3.snow.vignette),"vignette-color":new f.a6(f.a3.snow["vignette-color"]),"center-thinning":new f.a6(f.a3.snow["center-thinning"]),direction:new f.a6(f.a3.snow.direction),"flake-size":new f.a6(f.a3.snow["flake-size"])}));this._transitionable=new f.a4(b,c,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new f.ad(b),this.scope=c}get state(){const m=this.properties.get("opacity"),s=this.properties.get("color"),c=this.properties.get("direction"),g=f.ai(c[0]),b=-Math.max(f.ai(c[1]),.01),x=[Math.cos(g)*Math.cos(b),Math.sin(g)*Math.cos(b),Math.sin(b)],M=this.properties.get("vignette"),A=this.properties.get("vignette-color");return A.a=M,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new f.aj(s.r,s.g,s.b,s.a*m),direction:x,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:A}}get(){return this._transitionable.serialize()}set(m,s,c={}){if(this._validate(tt,m,c))return;const g=f.l({},m);for(const b of Object.keys(f.a3.snow))void 0===g[b]&&(g[b]=f.a3.snow[b].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,c){return(!c||!1!==c.validate)&&Ve(this,m.call(Zs,f.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:f.a3})))}},xs=class extends f.E{constructor(m,s,c,g){super();const b=Kn||(Kn=new f.a5({density:new f.a6(f.a3.rain.density),intensity:new f.a6(f.a3.rain.intensity),color:new f.a6(f.a3.rain.color),opacity:new f.a6(f.a3.rain.opacity),vignette:new f.a6(f.a3.rain.vignette),"vignette-color":new f.a6(f.a3.rain["vignette-color"]),"center-thinning":new f.a6(f.a3.rain["center-thinning"]),direction:new f.a6(f.a3.rain.direction),"droplet-size":new f.a6(f.a3.rain["droplet-size"]),"distortion-strength":new f.a6(f.a3.rain["distortion-strength"])}));this._transitionable=new f.a4(b,c,new Map(g)),this.set(m,g),this._transitioning=this._transitionable.untransitioned(),this.properties=new f.ad(b),this.scope=c}get state(){const m=this.properties.get("opacity"),s=this.properties.get("color"),c=this.properties.get("direction"),g=f.ai(c[0]),b=-Math.max(f.ai(c[1]),.01),x=[Math.cos(g)*Math.cos(b),Math.sin(g)*Math.cos(b),Math.sin(b)],M=this.properties.get("vignette-color");return M.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new f.aj(s.r,s.g,s.b,s.a*m),direction:x,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:M}}get(){return this._transitionable.serialize()}set(m,s,c={}){if(this._validate(ie,m,c))return;const g=f.l({},m);for(const b of Object.keys(f.a3.rain))void 0===g[b]&&(g[b]=f.a3.rain[b].default);this._options=g,this._transitionable.setTransitionOrValue(this._options,s)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,s,c){return(!c||!1!==c.validate)&&Ve(this,m.call(Zs,f.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:f.a3})))}};class Br extends f.E{constructor(s,c,g,b){super(),this.scope=g,this._options=s,this.properties=new f.ad(c),this._transitionable=new f.a4(c,g,new Map(b)),this._transitionable.setTransitionOrValue(s.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(s){this._transitionable.setTransitionOrValue(this._options.properties,new Map(s))}updateTransitions(s){this._transitioning=this._transitionable.transitioned(s,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(s){this.properties=this._transitioning.possiblyEvaluate(s)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(s,c){this._options=s,this._transitionable.setTransitionOrValue(s.properties,c)}shadowsEnabled(){return!!this.properties&&!0===this.properties.get("cast-shadows")}}class so{constructor(s,c,g,b){this.screenBounds=s,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=g,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,b)}static createFromScreenPoints(s,c){let g,b;if(s instanceof f.P||"number"==typeof s[0]){const x=f.P.convert(s);g=[x],b=c.isPointAboveHorizon(x)}else{const x=f.P.convert(s[0]),M=f.P.convert(s[1]);g=[x,M],b=f.al(x,M).every(A=>c.isPointAboveHorizon(A))}return new so(g,c.getCameraPoint(),b,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(s){return f.al(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],s)}bufferedCameraGeometry(s){const c=this.screenBounds[0],g=1===this.screenBounds.length?this.screenBounds[0].add(new f.P(1,1)):this.screenBounds[1],b=f.al(c,g,0,!1);return this.cameraPoint.y>g.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<g.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=g.x?b[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(b[3]=this.cameraPoint)),f.am(b,s)}bufferedCameraGeometryGlobe(s){const c=this.screenBounds[0],g=1===this.screenBounds.length?this.screenBounds[0].add(new f.P(1,1)):this.screenBounds[1],b=f.al(c,g,s),x=this.cameraPoint.clone();switch(3*((x.y>c.y)+(x.y>g.y))+((x.x>c.x)+(x.x>g.x))){case 0:b[0]=x,b[4]=x.clone();break;case 1:b.splice(1,0,x);break;case 2:b[1]=x;break;case 3:b.splice(4,0,x);break;case 5:b.splice(2,0,x);break;case 6:b[3]=x;break;case 7:b.splice(3,0,x);break;case 8:b[2]=x}return b}containsTile(s,c,g,b=0){const x=s.queryPadding/c._pixelsPerMercatorPixel+1,M=g?this._bufferedCameraMercator(x,c):this._bufferedScreenMercator(x,c);let A=s.tileID.wrap+(M.unwrapped?b:0);const F=M.polygon.map(te=>f.an(s.tileTransform,te,A));if(!f.ao(F,0,0,f.ag,f.ag))return;A=s.tileID.wrap+(this.screenGeometryMercator.unwrapped?b:0);const N=this.screenGeometryMercator.polygon.map(te=>f.ap(s.tileTransform,te,A)),z=N.map(te=>new f.P(te[0],te[1])),H=c.getFreeCameraOptions().position||new f.aa(0,0,0),j=f.ap(s.tileTransform,H,A),G=N.map(te=>{const ne=f.ab.vec3.sub(te,te,j);return f.ab.vec3.normalize(ne,ne),new f.aq(j,ne)}),J=f.ar(s,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:z,tilespaceRays:G,bufferedTilespaceGeometry:F,bufferedTilespaceBounds:(Q=f.as(F),Q.min.x=f.aw(Q.min.x,0,f.ag),Q.min.y=f.aw(Q.min.y,0,f.ag),Q.max.x=f.aw(Q.max.x,0,f.ag),Q.max.y=f.aw(Q.max.y,0,f.ag),Q),tile:s,tileID:s.tileID,pixelToTileUnitsFactor:J};var Q}_bufferedScreenMercator(s,c){const g=Xm(s);if(this._screenRaycastCache[g])return this._screenRaycastCache[g];{let b;return b="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(s),c):{polygon:this.bufferedScreenGeometry(s).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[g]=b,b}}_bufferedCameraMercator(s,c){const g=Xm(s);if(this._cameraRaycastCache[g])return this._cameraRaycastCache[g];{let b;return b="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(s),c):{polygon:this.bufferedCameraGeometry(s).map(x=>c.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[g]=b,b}}_projectAndResample(s,c){const g=function(x,M){const A=f.ab.mat4.multiply([],M.pixelMatrix,M.globeMatrix),F=[0,-f.ax,0,1],N=[0,f.ax,0,1],z=[0,0,0,1];f.ab.vec4.transformMat4(F,F,A),f.ab.vec4.transformMat4(N,N,A),f.ab.vec4.transformMat4(z,z,A);const H=new f.P(F[0]/F[3],F[1]/F[3]),j=new f.P(N[0]/N[3],N[1]/N[3]),G=f.au(x,H)&&F[3]<z[3],J=f.au(x,j)&&N[3]<z[3];if(!G&&!J)return null;const Q=function(be,ye,Ee){for(let Re=1;Re<be.length;Re++){const Xe=Ys(ye.pointCoordinate3D(be[Re-1]).x),qe=Ys(ye.pointCoordinate3D(be[Re]).x);if(Ee<0){if(Xe<qe)return{idx:Re,t:-Xe/(qe-1-Xe)}}else if(qe<Xe)return{idx:Re,t:(1-Xe)/(qe+1-Xe)}}return null}(x,M,G?-1:1);if(!Q)return null;const{idx:te,t:ne}=Q;let le=te>1?rl(x.slice(0,te),M):[],me=te<x.length?rl(x.slice(te),M):[];le=le.map(be=>new f.P(Ys(be.x),be.y)),me=me.map(be=>new f.P(Ys(be.x),be.y));const pe=[...le];0===pe.length&&pe.push(me[me.length-1]);const xe=f.af(pe[pe.length-1].y,(0===me.length?le[0]:me[0]).y,ne);let ve;return ve=G?[new f.P(0,xe),new f.P(0,0),new f.P(1,0),new f.P(1,xe)]:[new f.P(1,xe),new f.P(1,1),new f.P(0,1),new f.P(0,xe)],pe.push(...ve),0===me.length?pe.push(le[0]):pe.push(...me),{polygon:pe.map(be=>new f.aa(be.x,be.y)),unwrapped:!1}}(s,c);if(g)return g;const b=function(x,M){let A=!1,F=-1/0,N=0;for(let H=0;H<x.length-1;H++)x[H].x>F&&(F=x[H].x,N=H);for(let H=0;H<x.length-1;H++){const j=(N+H)%(x.length-1),G=x[j],J=x[j+1];Math.abs(G.x-J.x)>.5&&(G.x<J.x?(G.x+=1,0===j&&(x[x.length-1].x+=1)):(J.x+=1,j+1===x.length-1&&(x[0].x+=1)),A=!0)}const z=f.at(M.center.lng);return A&&z<Math.abs(z-1)&&x.forEach(H=>{H.x-=1}),{polygon:x,unwrapped:A}}(rl(s,c).map(x=>new f.P(Ys(x.x),x.y)),c);return{polygon:b.polygon.map(x=>new f.aa(x.x,x.y)),unwrapped:b.unwrapped}}}function rl(m,s){return f.av(m,c=>{const g=s.pointCoordinate3D(c);c.x=g.x,c.y=g.y},1/256)}function Ys(m){return m<0?1+m%1:m%1}function Xm(m){return 100*m|0}function jh(m,s,c,g,b){const x=function(A,F){if(A)return b(A);if(F){if(m.url&&F.tiles&&m.tiles&&delete m.tiles,F.variants){if(!Array.isArray(F.variants))return b(new Error("variants must be an array"));for(const z of F.variants){if(null==z||"object"!=typeof z||z.constructor!==Object)return b(new Error("variant must be an object"));if(!Array.isArray(z.capabilities))return b(new Error("capabilities must be an array"));if(1===z.capabilities.length&&"meshopt"===z.capabilities[0]){F=f.l(F,z);break}}}const N=f.ay(f.l({},F,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);N.tiles=s.canonicalizeTileset(N,m.url),b(null,N)}},M=function(A,F,N){if(!A)return null;if(!F&&!N)return A;N=N||A.worldview_default;const z=Object.values(A.language||{});if(0===z.length)return null;const H=Object.values(A.worldview||{});if(0===H.length)return null;const j=z.every(J=>J===F),G=H.every(J=>J===N);return j&&G?A:F in(A.language_options||{})||N in(A.worldview_options||{})?null:A.language_options&&A.worldview_options?A:null}(m.data,c,g);return M?f.q.frame(()=>x(null,M)):m.url?f.n(s.transformRequest(s.normalizeSourceURL(m.url,null,c,g),f.R.Source),x):f.q.frame(()=>{const{data:A,...F}=m;x(null,F)})}class ol{constructor(s,c,g){this.bounds=f.az.convert(this.validateBounds(s)),this.minzoom=c||0,this.maxzoom=g||24}validateBounds(s){return Array.isArray(s)&&4===s.length?[Math.max(-180,s[0]),Math.max(-90,s[1]),Math.min(180,s[2]),Math.min(90,s[3])]:[-180,-90,180,90]}contains(s){const c=Math.pow(2,s.z),g=Math.floor(f.at(this.bounds.getWest())*c),b=Math.floor(f.aA(this.bounds.getNorth())*c),x=Math.ceil(f.at(this.bounds.getEast())*c),M=Math.ceil(f.aA(this.bounds.getSouth())*c);return s.x>=g&&s.x<x&&s.y>=b&&s.y<M}}class B_ extends f.E{constructor(s,c,g,b){if(super(),this.id=s,this.dispatcher=g,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.l(this,f.ay(c,["url","scheme","tileSize","promoteId"])),this._options=f.l({type:"vector"},c),this._collectResourceTiming=!!c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(b),this._tileWorkers={},this._deduped=new f.aB}load(s){this._loaded=!1,this.fire(new f.z("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,g=this.map.getWorldview();this._tileJSONRequest=jh(this._options,this.map._requestManager,c,g,(b,x)=>{if(this._tileJSONRequest=null,this._loaded=!0,b)c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),g&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${g}`),this.fire(new f.y(b));else if(x){if(f.l(this,x),this.hasWorldviews=!!x.worldview_options,x.worldview_default&&(this.worldviewDefault=x.worldview_default),x.vector_layers){this.vectorLayers=x.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const M of x.vector_layers)this.vectorLayerIds.push(M.id),x.worldview&&x.worldview[M.source]&&this.localizableLayerIds.add(M.id)}x.bounds&&(this.tileBounds=new ol(x.bounds,this.minzoom,this.maxzoom)),Lh(x.tiles,this.map._requestManager._customAccessToken),this.fire(new f.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.z("data",{dataType:"source",sourceDataType:"content"}))}s&&s(b)})}loaded(){return this._loaded}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=f.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return f.l({},this._options)}loadTile(s,c){const g=s.tileID.canonical.url(this.tiles,this.scheme),b=this.map._requestManager.normalizeTileURL(g),x=this.map._requestManager.transformRequest(b,f.R.Tile),M=this.map.style?this.map.style.getLut(this.scope):null,A=M?{image:M.image.clone()}:null,F={request:x,data:void 0,uid:s.uid,tileID:s.tileID,tileZoom:s.tileZoom,zoom:s.tileID.overscaledZ,maxZoom:this.maxzoom,lut:A,tileSize:this.tileSize*s.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:f.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:s.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:s.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&f.f(g)&&(F.worldview=this.map.getWorldview()||this.worldviewDefault,F.localizableLayerIds=this.localizableLayerIds),F.request.collectResourceTiming=this._collectResourceTiming,s.actor&&"expired"!==s.state)"loading"===s.state?s.reloadCallback=c:s.request=s.actor.send("reloadTile",F,N.bind(this));else if(s.actor=this._tileWorkers[b]=this._tileWorkers[b]||this.dispatcher.getActor(),this.dispatcher.ready)s.request=s.actor.send("loadTile",F,N.bind(this),void 0,!0);else{const z=f.aD.call({deduped:this._deduped},F,(H,j)=>{H||!j?N.call(this,H):(F.data={cacheControl:j.cacheControl,expires:j.expires,rawData:j.rawData.slice(0)},s.actor&&s.actor.send("loadTile",F,N.bind(this),void 0,!0))},!0);s.request={cancel:z}}function N(z,H){return delete s.request,s.aborted?c(null):z&&404!==z.status?c(z):(H&&H.resourceTiming&&(s.resourceTiming=H.resourceTiming),this.map._refreshExpiredTiles&&H&&s.setExpiryData(H),s.loadVectorData(H,this.map.painter),f.aE(this.dispatcher),c(null),void(s.reloadCallback&&(this.loadTile(s,s.reloadCallback),s.reloadCallback=null)))}}abortTile(s){s.request&&(s.request.cancel(),delete s.request),s.actor&&s.actor.send("abortTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(s,c){s.actor&&s.actor.send("removeTile",{uid:s.uid,type:this.type,source:this.id,scope:this.scope}),s.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Rr extends f.E{constructor(s,c,g,b){super(),this.id=s,this.dispatcher=g,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.l({type:"raster"},c),f.l(this,f.ay(c,["url","scheme","tileSize"]))}load(s){this._loaded=!1,this.fire(new f.z("dataloading",{dataType:"source"})),this._tileJSONRequest=jh(this._options,this.map._requestManager,null,null,(c,g)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new f.y(c)):g&&(f.l(this,g),g.raster_layers&&(this.rasterLayers=g.raster_layers,this.rasterLayerIds=this.rasterLayers.map(b=>b.id)),g.bounds&&(this.tileBounds=new ol(g.bounds,this.minzoom,this.maxzoom)),Lh(g.tiles),this.fire(new f.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.z("data",{dataType:"source",sourceDataType:"content"}))),s&&s(c)})}loaded(){return this._loaded}onAdd(s){this.map=s,this.load()}reload(){this.cancelTileJSONRequest();const s=f.aC(this.id,this.scope);this.load(()=>this.map.style.clearSource(s))}setTiles(s){return this._options.tiles=s,this.reload(),this}setUrl(s){return this.url=s,this._options.url=s,this.reload(),this}onRemove(s){this.cancelTileJSONRequest()}serialize(){return f.l({},this._options)}hasTile(s){return!this.tileBounds||this.tileBounds.contains(s.canonical)}loadTile(s,c){const g=f.q.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),g,this.tileSize);s.request=f.o(this.map._requestManager.transformRequest(b,f.R.Tile),(x,M,A,F)=>(delete s.request,s.aborted?(s.state="unloaded",c(null)):x?(s.state="errored",c(x)):M?(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:A,expires:F}),s.setTexture(M,this.map.painter),s.state="loaded",f.aE(this.dispatcher),void c(null)):c(null)))}abortTile(s,c){s.request&&(s.request.cancel(),delete s.request),c&&c()}unloadTile(s,c){s.texture&&s.texture instanceof f.T?(s.destroy(!0),s.texture&&s.texture instanceof f.T&&this.map.painter.saveTileTexture(s.texture)):s.destroy(),c&&c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Sd extends Rr{constructor(s,c,g,b){super(s,c,g,b),this.type="raster-array",this.maxzoom=22,this._options=f.l({type:"raster-array"},c)}triggerRepaint(s){const c=this.map.painter._terrain,g=this.map.style.getSourceCache(this.id);c&&c.enabled&&g&&c._clearRenderCacheForTile(g.id,s.tileID),this.map.triggerRepaint()}loadTile(s,c){const g=this.map._requestManager.normalizeTileURL(s.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),b=this.map._requestManager.transformRequest(g,f.R.Tile);s.requestParams=b,s.actor||(s.actor=this.dispatcher.getActor()),s.request=s.fetchHeader(void 0,(x,M,A,F)=>(delete s.request,s.aborted?(s.state="unloaded",c(null)):x?20===x.code?void 0:(s.state="errored",c(x)):(this.map._refreshExpiredTiles&&s.setExpiryData({cacheControl:A,expires:F}),s.state="empty",void c(null))))}unloadTile(s,c){const g=s.texture;g&&g instanceof f.T?(s.destroy(!0),this.map.painter.saveTileTexture(g)):(s.destroy(),s.flushQueues(),s._isHeaderLoaded=!1,delete s._mrt,delete s.textureDescriptor),s.fbo&&(s.fbo.destroy(),delete s.fbo),delete s.request,delete s.requestParams,delete s.neighboringTiles,s.state="unloaded"}prepareTile(s,c,g){s._isHeaderLoaded&&("empty"!==s.state&&(s.state="reloading"),s.fetchBand(c,g,(b,x)=>{if(b)return s.state="errored",this.fire(new f.y(b)),void this.triggerRepaint(s);x&&(s.setTexture(x,this.map.painter),s.state="loaded",this.triggerRepaint(s))}))}getInitialBand(s){if(!this.rasterLayers)return 0;const c=this.rasterLayers.find(({id:x})=>x===s),g=c&&c.fields,b=g&&g.bands&&g.bands;return b?b[0]:0}getTextureDescriptor(s,c,g){if(!s)return;const b=c.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!b)return;let x=null;c instanceof f.aH?x=c.paint.get("raster-array-band"):c instanceof f.aI&&(x=c.paint.get("raster-particle-array-band"));const M=x||this.getInitialBand(b);if(null!=M)if(s.textureDescriptor){if(!s.updateNeeded(b,M)||g)return Object.assign({},s.textureDescriptor,{texture:s.texture})}else this.prepareTile(s,b,M)}}const Hh={vector:B_,raster:Rr,"raster-dem":class extends Rr{constructor(m,s,c,g){super(m,s,c,g),this.type="raster-dem",this.maxzoom=22,this._options=f.l({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}loadTile(m,s){const c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function g(b,x){b&&(m.state="errored",s(b)),x&&(m.dem=x,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",s(null))}m.request=f.o(this.map._requestManager.transformRequest(c,f.R.Tile),function(b,x,M,A){if(delete m.request,m.aborted)m.state="unloaded",s(null);else if(b)m.state="errored",s(b);else if(x){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:M,expires:A});const F=ImageBitmap&&x instanceof ImageBitmap&&f.t(),N=1-(x.width-f.aF(x.width))/2;N<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const z=F?x:f.q.getImageData(x,N),H={uid:m.uid,coord:m.tileID,source:this.id,scope:this.scope,rawImageData:z,encoding:this.encoding,padding:N};m.actor&&"expired"!==m.state||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",H,g.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const s=m.canonical,c=Math.pow(2,s.z),g=(s.x-1+c)%c,b=0===s.x?m.wrap-1:m.wrap,x=(s.x+1+c)%c,M=s.x+1===c?m.wrap+1:m.wrap,A={};return A[new f.aG(m.overscaledZ,b,s.z,g,s.y).key]={backfilled:!1},A[new f.aG(m.overscaledZ,M,s.z,x,s.y).key]={backfilled:!1},s.y>0&&(A[new f.aG(m.overscaledZ,b,s.z,g,s.y-1).key]={backfilled:!1},A[new f.aG(m.overscaledZ,m.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},A[new f.aG(m.overscaledZ,M,s.z,x,s.y-1).key]={backfilled:!1}),s.y+1<c&&(A[new f.aG(m.overscaledZ,b,s.z,g,s.y+1).key]={backfilled:!1},A[new f.aG(m.overscaledZ,m.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},A[new f.aG(m.overscaledZ,M,s.z,x,s.y+1).key]={backfilled:!1}),A}},"raster-array":Sd,geojson:class extends f.E{constructor(m,s,c,g){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(g),this._data=s.data,this._options=f.l({},s),this._collectResourceTiming=s.collectResourceTiming,void 0!==s.maxzoom&&(this.maxzoom=s.maxzoom),void 0!==s.minzoom&&(this.minzoom=s.minzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const b=f.ag/this.tileSize;this.workerOptions=f.l({source:this.id,scope:this.scope,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(void 0!==s.buffer?s.buffer:128)*b,tolerance:(void 0!==s.tolerance?s.tolerance:.375)*b,extent:f.ag,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:void 0!==s.clusterMaxZoom?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:f.ag,radius:(void 0!==s.clusterRadius?s.clusterRadius:50)*b,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter,dynamic:s.dynamic},s.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new f.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if("string"!=typeof m&&("Feature"===m.type&&(m={type:"FeatureCollection",features:[m]}),"FeatureCollection"!==m.type))return this.fire(new f.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&"string"!=typeof m&&"string"!=typeof this._data&&"FeatureCollection"===this._data.type){const s=new Map;for(const c of this._data.features)s.set(c.id,c);for(const c of m.features)s.set(c.id,c);this._data.features=[...s.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterChildren(m,s){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},s),this}getClusterLeaves(m,s,c,g){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:s,offset:c},g),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new f.z("dataloading",{dataType:"source"})),this._loaded=!1;const s=f.l({append:m},this.workerOptions);s.scope=this.scope;const c=this._data;"string"==typeof c?(s.request=this.map._requestManager.transformRequest(f.q.resolveURL(c),f.R.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,s,(g,b)=>{if(this._loaded=!0,this._pendingLoad=null,g)this.fire(new f.y(g));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&b&&b.resourceTiming&&b.resourceTiming[this.id]&&(x.resourceTiming=b.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new f.z("data",x)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,s){const c=m.actor?"reloadTile":"loadTile";m.actor=this.actor;const g=this.map.style?this.map.style.getLut(this.scope):null,b=g?{image:g.image.clone()}:null,x=this._partialReload,M={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:b,scope:this.scope,pixelRatio:f.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:x};m.request=this.actor.send(c,M,(A,F)=>x&&!F?(m.state="loaded",s(null)):(delete m.request,m.destroy(),m.aborted?s(null):A?s(A):(m.loadVectorData(F,this.map.painter,"reloadTile"===c),s(null))),void 0,"loadTile"===c)}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,s){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return f.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends f.aJ{constructor(m,s,c,g){super(m,s,c,g),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const s of m.urls)this.urls.push(this.map._requestManager.transformRequest(s,f.R.Source).url);f.aK(this.urls,(s,c)=>{this._loaded=!0,s?this.fire(new f.y(s)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const s=this.video.seekable;m<s.start(0)||m>s.end(0)?this.fire(new f.y(new f.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const m=this.map.painter.context,s=m.gl;this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new f.T(m,this.video,s.RGBA8),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:f.aJ,model:class extends f.E{constructor(m,s,c,g){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=s}load(){const m=[];for(const s in this._options.models){const c=this._options.models[s],g=f.aM(this.map._requestManager.transformRequest(c.uri,f.R.Model).url).then(b=>{if(!b)return;const x=f.aN(b),M=new f.aO(s,c.position,c.orientation,x);M.computeBoundsAndApplyParent(),this.models.push(M)}).catch(b=>{this.fire(new f.y(new Error(`Could not load model ${s} from ${c.uri}: ${b.message}`)))});m.push(g)}return Promise.allSettled(m).then(()=>{this._loaded=!0,this.fire(new f.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(s=>{this.fire(new f.y(new Error(`Could not load models: ${s.message}`)))})}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,s){}serialize(){return{type:"model"}}},"batched-model":class extends f.E{constructor(m,s,c,g){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=s,this.tiles=this._options.tiles,this.maxzoom=s.maxzoom||19,this.minzoom=s.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=c,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(g)}onAdd(m){this.map=m,this.load()}load(m){this._loaded=!1,this.fire(new f.z("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map.getWorldview();this._tileJSONRequest=jh(this._options,this.map._requestManager,s,c,(g,b)=>{this._tileJSONRequest=null,this._loaded=!0,g?(s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),c&&2!==c.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new f.y(g))):b&&(f.l(this,b),b.bounds&&(this.tileBounds=new ol(b.bounds,this.minzoom,this.maxzoom)),Lh(b.tiles,this.map._requestManager._customAccessToken),this.fire(new f.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.z("data",{dataType:"source",sourceDataType:"content"}))),m&&m(g)})}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,s){const c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),g={request:this.map._requestManager.transformRequest(c,f.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(m.actor&&"expired"!==m.state)if("loading"===m.state)m.reloadCallback=s;else{if(m.buckets){const x=Object.values(m.buckets);for(const M of x)M.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",g,b.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",g,b.bind(this),void 0,!0);function b(x,M){return m.aborted?s(null):x&&404!==x.status?s(x):(this.map._refreshExpiredTiles&&M&&m.setExpiryData(M),m.loadModelData(M,this.map.painter),m.state="loaded",void s(null))}}serialize(){return f.l({},this._options)}},canvas:class extends f.aJ{constructor(m,s,c,g){super(m,s,c,g),s.coordinates?Array.isArray(s.coordinates)&&4===s.coordinates.length&&!s.coordinates.some(b=>!Array.isArray(b)||2!==b.length||b.some(x=>"number"!=typeof x))||this.fire(new f.y(new f.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.y(new f.V(`sources.${m}`,null,'missing required property "coordinates"'))),s.animate&&"boolean"!=typeof s.animate&&this.fire(new f.y(new f.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),s.canvas?"string"==typeof s.canvas||s.canvas instanceof HTMLCanvasElement||this.fire(new f.y(new f.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.y(new f.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=s,this.animate=void 0===s.animate||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const s=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof f.aL||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new f.T(s,this.canvas,s.gl.RGBA8,{premultiply:!0}),this._prepareData(s)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends f.E{constructor(m,s,c,g){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=s,this.setEventedParent(g),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new f.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new f.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ol(this._implementation.bounds,this.minzoom,this.maxzoom)),s.update=this._update.bind(this),s.clearTiles=this._clearTiles.bind(this),s.coveringTiles=this._coveringTiles.bind(this),f.l(this,f.ay(s,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return f.ay(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new f.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new f.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:s,y:c,z:g}=m.canonical;return this._implementation.hasTile({x:s,y:c,z:g})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,s){const{x:c,y:g,z:b}=m.tileID.canonical,x=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:c,y:g,z:b},{signal:x.signal})).then(function(M){return delete m.request,m.aborted?(m.state="unloaded",s(null)):void 0===M?(m.state="errored",s(null)):null===M?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",s(null)):(A=M)instanceof ImageData||A instanceof HTMLCanvasElement||A instanceof ImageBitmap||A instanceof HTMLImageElement?(this.loadTileData(m,M),m.state="loaded",void s(null)):(m.state="errored",s(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var A}.bind(this)).catch(M=>{20!==M.code&&(m.state="errored",s(M))}),m.request.cancel=()=>x.abort()}loadTileData(m,s){m.setTexture(s,this.map.painter)}unloadTile(m,s){if(m.texture&&m.texture instanceof f.T?(m.destroy(!0),m.texture&&m.texture instanceof f.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){const{x:c,y:g,z:b}=m.tileID.canonical;this._implementation.unloadTile({x:c,y:g,z:b})}s&&s()}abortTile(m,s){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),s&&s()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){const m=f.aC(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new f.z("data",{dataType:"source",sourceDataType:"content"}))}}},xr=function(m,s,c,g){const b=new Hh[s.type](m,s,c,g);if(b.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${b.id}`);return f.aP(["load","abort","unload","serialize","prepare"],b),b};function hb(m,s,c,g,b=!1){const x=s.sourceCache.transform,M=s.sourceCache.tilesIn(m,s.has3DLayers,b);M.sort(V_);const A=[];for(const F of M){const N=F.tile.queryRenderedFeatures(s,F,c,g,x,b);Object.keys(N).length&&A.push({wrappedTileID:F.tile.tileID.wrapped().key,queryResults:N})}return 0===A.length?{}:function(F){const N={},z={};for(const H of F){const j=H.queryResults,G=H.wrappedTileID,J=z[G]=z[G]||{};for(const Q in j){const te=j[Q],ne=J[Q]=J[Q]||{},le=N[Q]=N[Q]||[];for(const me of te)ne[me.featureIndex]||(ne[me.featureIndex]=!0,le.push(me))}}return N}(A)}function So(m,s,c,g,b){const x={},M=g.queryRenderedSymbols(m),A=[];for(const F of Object.keys(M).map(Number))A.push(b[F]);A.sort(V_);for(const F of A){const N=F.featureIndex.lookupSymbolFeatures(M[F.bucketInstanceId],F.bucketIndex,F.sourceLayerIndex,s,c);for(const z in N){const H=x[z]=x[z]||[],j=N[z];j.sort((G,J)=>{const Q=F.featureSortOrder;if(Q){const te=Q.indexOf(G.featureIndex);return Q.indexOf(J.featureIndex)-te}return J.featureIndex-G.featureIndex});for(const G of j)H.push(G)}}return x}function Tu(m,s){const c=m.getRenderableIds().map(x=>m.getTileByID(x)),g=[],b={};for(let x=0;x<c.length;x++){const M=c[x],A=M.tileID.canonical.key;b[A]||(b[A]=!0,M.querySourceFeatures(g,s))}return g}function V_(m,s){const c=m.tileID,g=s.tileID;return c.overscaledZ-g.overscaledZ||c.canonical.y-g.canonical.y||c.wrap-g.wrap||c.canonical.x-g.canonical.x}function U_(m,s){const c={};if(!s)return c;for(const g of m){const b=g.layerIds.map(x=>s.getLayer(x)).filter(Boolean);if(0!==b.length){g.layers=b,g.stateDependentLayerIds&&(g.stateDependentLayers=g.stateDependentLayerIds.map(x=>b.filter(M=>M.id===x)[0]));for(const x of b)c[x.fqid]=g}}return c}const Xs=new Uint16Array(8184);for(let m=0;m<2046;m++){let s=m+2,c=0,g=0,b=0,x=0,M=0,A=0;for(1&s?b=x=M=32:c=g=A=32;(s>>=1)>1;){const N=c+b>>1,z=g+x>>1;1&s?(b=c,x=g,c=M,g=A):(c=b,g=x,b=M,x=A),M=N,A=z}const F=4*m;Xs[F+0]=c,Xs[F+1]=g,Xs[F+2]=b,Xs[F+3]=x}const po=new Uint16Array(2178),Ed=new Uint8Array(1089),Km=new Uint16Array(1089);function Qm(m){return 0===m?-.03125:32===m?.03125:0}const Ks={type:2,extent:f.ag,loadGeometry:()=>[[new f.P(0,0),new f.P(f.ag+1,0),new f.P(f.ag+1,f.ag+1),new f.P(0,f.ag+1),new f.P(0,0)]]};class Mu{constructor(s,c,g,b,x){this.tileID=s,this.uid=f.aV(),this.uses=0,this.tileSize=c,this.tileZoom=g,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=x,b&&b.style&&(this._lastUpdatedBrightness=b.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",b&&b.transform&&(this.projection=b.transform.projection)}registerFadeDuration(s){const c=s+this.timeAdded;c<f.q.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=f.aQ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(s,c,g){if(this.unloadVectorData(),this.state="loaded",s){s.featureIndex&&(this.latestFeatureIndex=s.featureIndex,s.rawTileData?(this.latestRawTileData=s.rawTileData,this.latestFeatureIndex.rawTileData=s.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=s.collisionBoxArray,this.buckets=U_(s.buckets,c.style),this.hasSymbolBuckets=!1;for(const b in this.buckets){const x=this.buckets[b];if(x instanceof f.aX){if(this.hasSymbolBuckets=!0,!g)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const b in this.buckets){const x=this.buckets[b];if(x instanceof f.aX&&x.hasRTLText){this.hasRTLText=!0,f.aY();break}}this.queryPadding=0;for(const b in this.buckets){const x=this.buckets[b],M=c.style.getOwnLayer(b);if(!M)continue;const A=M.queryRadius(x);this.queryPadding=Math.max(this.queryPadding,A)}s.imageAtlas&&(this.imageAtlas=s.imageAtlas),s.glyphAtlasImage&&(this.glyphAtlasImage=s.glyphAtlasImage),s.lineAtlas&&(this.lineAtlas=s.lineAtlas),this._lastUpdatedBrightness=s.brightness}else this.collisionBoxArray=new f.aW}unloadVectorData(){if(this.hasData()){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(s,c,g){s&&(s.resourceTiming&&(this.resourceTiming=s.resourceTiming),this.buckets={...this.buckets,...U_(s.buckets,c.style)},s.featureIndex&&(this.latestFeatureIndex=s.featureIndex))}getBucket(s){return this.buckets[s.fqid]}upload(s){for(const b in this.buckets){const x=this.buckets[b];x.uploadPending()&&x.upload(s)}const c=s.gl,g=this.imageAtlas;if(g&&!g.uploaded){const b=!!Object.keys(g.patternPositions).length;this.imageAtlasTexture=new f.T(s,g.image,c.RGBA8,{useMipmap:b}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new f.T(s,this.glyphAtlasImage,c.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new f.T(s,this.lineAtlas.image,c.R8),this.lineAtlas.uploaded=!0)}prepare(s,c,g){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(s,this.imageAtlasTexture,g),!c||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const b=c.style.getBrightness();(this._lastUpdatedBrightness||b)&&(this._lastUpdatedBrightness&&b&&Math.abs(this._lastUpdatedBrightness-b)<.001||(this.updateBuckets(c,this._lastUpdatedBrightness!==b),this._lastUpdatedBrightness=b))}queryRenderedFeatures(s,c,g,b,x,M){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const A=function(F,N){const z=f.ab.mat4.fromScaling([],[.5*F.width,.5*-F.height,1]);return f.ab.mat4.translate(z,z,[1,-1,0]),f.ab.mat4.multiply(z,z,F.calculateProjMatrix(N.toUnwrapped())),Float32Array.from(z)}(x,this.tileID);return this.latestFeatureIndex.query(s,{tilespaceGeometry:c,pixelPosMatrix:A,transform:b,availableImages:g,tileTransform:this.tileTransform})}querySourceFeatures(s,c){const g=this.latestFeatureIndex;if(!g||!g.rawTileData)return;const b=g.loadVTLayers(),x=c?c.sourceLayer:"",M=b._geojsonTileLayer||b[x];if(!M)return;const A=f.aZ(c&&c.filter),{z:F,x:N,y:z}=this.tileID.canonical,H={z:F,x:N,y:z};for(let j=0;j<M.length;j++){const G=M.feature(j);if(A.needGeometry){const te=f.a_(G,!0);if(!A.filter(new f.a8(this.tileID.overscaledZ),te,this.tileID.canonical))continue}else if(!A.filter(new f.a8(this.tileID.overscaledZ),G))continue;const J=g.getId(G,x),Q=new f.a$(G,F,N,z,J);Q.tile=H,s.push(Q)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(s){const c=this.expirationTime;if(s.cacheControl){const g=f.b0(s.cacheControl);g["max-age"]&&(this.expirationTime=Date.now()+1e3*g["max-age"])}else s.expires&&(this.expirationTime=new Date(s.expires).getTime());if(this.expirationTime){const g=Date.now();let b=!1;if(this.expirationTime>g)b=!1;else if(c)if(this.expirationTime<c)b=!0;else{const x=this.expirationTime-c;x?this.expirationTime=g+Math.max(x,3e4):b=!0}else b=!0;b?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}refreshFeatureState(s){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&s&&this.updateBuckets(s)}updateBuckets(s,c){if(!this.latestFeatureIndex||!s.style)return;const g=this.latestFeatureIndex.loadVTLayers(),b=s.style.listImages(),x=s.style.getBrightness();for(const M in this.buckets){if(!s.style.hasLayer(M))continue;const A=this.buckets[M],F=A.layers[0],N=F.sourceLayer||"_geojsonTileLayer",z=g[N],H=s.style.getSourceCache(F.source,F.scope);let j={};H&&(j=H._state.getState(N,void 0));const G=this.imageAtlas&&this.imageAtlas.patternPositions||{},J=Object.keys(j).length>0&&!c;(J&&0!==A.stateDependentLayers.length||c)&&A.update(j,z,b,G,J?A.stateDependentLayers:A.layers,c,x),(A instanceof f.b1||A instanceof f.b2)&&s._terrain&&s._terrain.enabled&&H&&A.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(H.id,this.tileID);const Q=s&&s.style&&s.style.getOwnLayer(M);Q&&(this.queryPadding=Math.max(this.queryPadding,Q.queryRadius(A)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<f.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(s){this.symbolFadeHoldUntil=f.q.now()+s}setTexture(s,c){const g=c.context,b=g.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture&&this.texture instanceof f.T?this.texture.update(s):(this.texture=new f.T(g,s,b.RGBA8,{useMipmap:!0}),this.texture.bind(b.LINEAR,b.CLAMP_TO_EDGE))}setDependencies(s,c){const g={};for(const b of c)g[b]=!0;this.dependencies[s]=g}hasDependency(s,c){for(const g of s){const b=this.dependencies[g];if(b)for(const x of c)if(b[x])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(s,c){if(!c||"mercator"===c.name||this._tileDebugBuffer)return;const g=f.b3(Ks,this.tileID.canonical,this.tileTransform)[0],b=new f.b4,x=new f.b5;for(let M=0;M<g.length;M++){const{x:A,y:F}=g[M];b.emplaceBack(A,F),x.emplaceBack(M)}x.emplaceBack(0),this._tileDebugIndexBuffer=s.createIndexBuffer(x),this._tileDebugBuffer=s.createVertexBuffer(b,f.b6.members),this._tileDebugSegments=f.b7.simpleSegment(0,0,b.length,x.length)}_makeTileBoundsBuffers(s,c){if(this._tileBoundsBuffer||!c||"mercator"===c.name)return;const g=f.b3(Ks,this.tileID.canonical,this.tileTransform)[0];let b,x;if(this.isRaster){const M=function(A,F){const N=f.aQ(A,F),z=Math.pow(2,A.z);for(let te=0;te<33;te++)for(let ne=0;ne<33;ne++){const le=f.aR((A.x+(ne+Qm(ne))/32)/z),me=f.aS((A.y+(te+Qm(te))/32)/z),pe=F.project(le,me),xe=33*te+ne;po[2*xe+0]=Math.round((pe.x*N.scale-N.x)*f.ag),po[2*xe+1]=Math.round((pe.y*N.scale-N.y)*f.ag)}Ed.fill(0),Km.fill(0);for(let te=2045;te>=0;te--){const ne=4*te,le=Xs[ne+0],me=Xs[ne+1],pe=Xs[ne+2],xe=Xs[ne+3],ve=le+pe>>1,be=me+xe>>1,ye=ve+be-me,Ee=be+le-ve,Re=33*me+le,Xe=33*xe+pe,qe=33*be+ve,Ae=Math.hypot((po[2*Re+0]+po[2*Xe+0])/2-po[2*qe+0],(po[2*Re+1]+po[2*Xe+1])/2-po[2*qe+1])>=16;Ed[qe]=Ed[qe]||(Ae?1:0),te<1022&&(Ed[qe]=Ed[qe]||Ed[33*(me+Ee>>1)+(le+ye>>1)]||Ed[33*(xe+Ee>>1)+(pe+ye>>1)])}const H=new f.aT,j=new f.aU;let G=0;function J(te,ne){const le=33*ne+te;return 0===Km[le]&&(H.emplaceBack(po[2*le+0],po[2*le+1],te*f.ag/32,ne*f.ag/32),Km[le]=++G),Km[le]-1}function Q(te,ne,le,me,pe,xe){const ve=te+le>>1,be=ne+me>>1;if(Math.abs(te-pe)+Math.abs(ne-xe)>1&&Ed[33*be+ve])Q(pe,xe,te,ne,ve,be),Q(le,me,pe,xe,ve,be);else{const ye=J(te,ne),Ee=J(le,me),Re=J(pe,xe);j.emplaceBack(ye,Ee,Re)}}return Q(0,0,32,32,32,0),Q(32,32,0,0,0,32),{vertices:H,indices:j}}(this.tileID.canonical,c);b=M.vertices,x=M.indices}else{b=new f.aT,x=new f.aU;for(const{x:A,y:F}of g)b.emplaceBack(A,F,0,0);const M=f.b8(b.int16,void 0,4);for(let A=0;A<M.length;A+=3)x.emplaceBack(M[A],M[A+1],M[A+2])}this._tileBoundsBuffer=s.createVertexBuffer(b,f.b9.members),this._tileBoundsIndexBuffer=s.createIndexBuffer(x),this._tileBoundsSegments=f.b7.simpleSegment(0,0,b.length,x.length)}_makeGlobeTileDebugBuffers(s,c){const g=c.projection;if(!g||"globe"!==g.name||c.freezeTileCoverage)return;const b=this.tileID.canonical,x=f.ba(b,c),M=f.bb(x),A=f.ae(c.zoom);let F;A>0&&(F=f.ab.mat4.invert(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(s,b,c,M,F,A),this._makeGlobeTileDebugTextBuffer(s,b,c,M,F,A)}_globePoint(s,c,g,b,x,M,A){let F=f.bc(s,c,g);if(M){const N=1<<g.z,z=f.at(b.center.lng),H=f.aA(b.center.lat),j=(g.x+.5)/N-z;let G=0;j>.5?G=-1:j<-.5&&(G=1);let J=(s/f.ag+g.x)/N+G,Q=(c/f.ag+g.y)/N;J=(J-z)*b._pixelsPerMercatorPixel+z,Q=(Q-H)*b._pixelsPerMercatorPixel+H;const te=[J*b.worldSize,Q*b.worldSize,0];f.ab.vec3.transformMat4(te,te,M),F=f.bd(F,te,A)}return f.ab.vec3.transformMat4(F,F,x)}_makeGlobeTileDebugBorderBuffer(s,c,g,b,x,M){const A=new f.b4,F=new f.b5,N=new f.be,z=(j,G,J,Q,te)=>{const ne=(J-j)/(te-1),le=(Q-G)/(te-1),me=A.length;for(let pe=0;pe<te;pe++){const xe=j+pe*ne,ve=G+pe*le;A.emplaceBack(xe,ve);const be=this._globePoint(xe,ve,c,g,b,x,M);N.emplaceBack(be[0],be[1],be[2]),F.emplaceBack(me+pe)}},H=f.ag;z(0,0,H,0,16),z(H,0,H,H,16),z(H,H,0,H,16),z(0,H,0,0,16),this._tileDebugIndexBuffer=s.createIndexBuffer(F),this._tileDebugBuffer=s.createVertexBuffer(A,f.b6.members),this._globeTileDebugBorderBuffer=s.createVertexBuffer(N,f.bf.members),this._tileDebugSegments=f.b7.simpleSegment(0,0,A.length,F.length)}_makeGlobeTileDebugTextBuffer(s,c,g,b,x,M){const A=f.ag/4,F=new f.b4,N=new f.aU,z=new f.be,H=25;N.reserve(32),F.reserve(H),z.reserve(H);const j=(G,J)=>H*G+J;for(let G=0;G<H;G++){const J=G*A;for(let Q=0;Q<H;Q++){const te=Q*A;F.emplaceBack(te,J);const ne=this._globePoint(te,J,c,g,b,x,M);z.emplaceBack(ne[0],ne[1],ne[2])}}for(let G=0;G<4;G++)for(let J=0;J<4;J++){const Q=j(G,J),te=j(G,J+1),ne=j(G+1,J),le=j(G+1,J+1);N.emplaceBack(Q,te,ne),N.emplaceBack(ne,te,le)}this._tileDebugTextIndexBuffer=s.createIndexBuffer(N),this._tileDebugTextBuffer=s.createVertexBuffer(F,f.b6.members),this._globeTileDebugTextBuffer=s.createVertexBuffer(z,f.bf.members),this._tileDebugTextSegments=f.b7.simpleSegment(0,0,H,32)}destroy(s=!1){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!s&&this.texture&&this.texture instanceof f.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}f.bg.setPbf(f.bh);class j_ extends Mu{constructor(s,c,g,b,x){super(s,c,g,b,x),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(s,c){const g=c.context,b=g.gl;this.texture=this.texture||c.getTileTexture(s.width),this.texture&&this.texture instanceof f.T?this.texture.update(s,{premultiply:!1}):this.texture=new f.T(g,s,b.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(s=16384,c){const g=this._mrt=new f.bg(30),b=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(s-1)}});return this.entireBuffer=null,this.request=f.bi(b,(x,M,A,F)=>{if(x)c(x);else try{const N=g.getHeaderLength(M);if(N>s)return void(this.request=this.fetchHeader(N,c));g.parseHeader(M),this._isHeaderLoaded=!0;let z=0;for(const H of Object.values(g.layers))z=Math.max(z,H.dataIndex[H.dataIndex.length-1].last_byte);M.byteLength>=z&&(this.entireBuffer=M),c(null,this.entireBuffer||M,A,F)}catch(N){c(N)}}),this.request}fetchBand(s,c,g){const b=this._mrt;if(!this._isHeaderLoaded||!b)return void g(new Error("Tile header is not ready"));const x=this.actor;if(!x)return void g(new Error("Can't fetch tile band without an actor"));let M;const A=(H,j)=>{M.complete(H,j),H?g(H):(this.updateTextureDescriptor(s,c),g(null,this.textureDescriptor&&this.textureDescriptor.img))},F=(H,j)=>{if(H)return g(H);const G=x.send("decodeRasterArray",{buffer:j,task:M},A,void 0,!0);this._workQueue.push(()=>{G&&G.cancel(),M.cancel()})},N=b.getLayer(s);if(!N)return void g(new Error(`Unknown sourceLayer "${s}"`));if(N.hasDataForBand(c))return this.updateTextureDescriptor(s,c),void g(null,this.textureDescriptor?this.textureDescriptor.img:null);const z=N.getDataRange([c]);if(M=b.createDecodingTask(z),!M||M.tasks.length)if(this.flushQueues(),this.entireBuffer)F(null,this.entireBuffer.slice(z.firstByte,z.lastByte+1));else{const H=Object.assign({},this.requestParams,{headers:{Range:`bytes=${z.firstByte}-${z.lastByte}`}}),j=f.bi(H,F);this._fetchQueue.push(()=>{j.cancel(),M.cancel()})}else g(null)}updateNeeded(s,c){return(!this.textureDescriptor||this.textureDescriptor.band!==c||this.textureDescriptor.layer!==s)&&"errored"!==this.state}updateTextureDescriptor(s,c){if(!this._mrt)return;const g=this._mrt.getLayer(s);if(!g||!g.hasBand(c)||!g.hasDataForBand(c))return;const{bytes:b,tileSize:x,buffer:M,offset:A,scale:F}=g.getBandView(c),N=x+2*M,z={data:b,width:N,height:N},H=this.texture;H&&H instanceof f.T&&H.update(z,{premultiply:!1}),this.textureDescriptor={layer:s,band:c,img:z,buffer:M,offset:A,tileSize:x,format:g.pixelFormat,mix:[F,256*F,65536*F,16777216*F]}}}class fb{constructor(s,c){this.max=s,this.onRemove=c,this.reset()}reset(){for(const s in this.data)for(const c of this.data[s])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(s,c,g){const b=s.wrapped().key;void 0===this.data[b]&&(this.data[b]=[]);const x={value:c,timeout:void 0};if(void 0!==g&&(x.timeout=setTimeout(()=>{this.remove(s,x)},g)),this.data[b].push(x),this.order.push(b),this.order.length>this.max){const M=this._getAndRemoveByKey(this.order[0]);M&&this.onRemove(M)}return this}has(s){return s.wrapped().key in this.data}getAndRemove(s){return this.has(s)?this._getAndRemoveByKey(s.wrapped().key):null}_getAndRemoveByKey(s){const c=this.data[s].shift();return c.timeout&&clearTimeout(c.timeout),0===this.data[s].length&&delete this.data[s],this.order.splice(this.order.indexOf(s),1),c.value}getByKey(s){const c=this.data[s];return c?c[0].value:null}get(s){return this.has(s)?this.data[s.wrapped().key][0].value:null}remove(s,c){if(!this.has(s))return this;const g=s.wrapped().key,b=void 0===c?0:this.data[g].indexOf(c),x=this.data[g][b];return this.data[g].splice(b,1),x.timeout&&clearTimeout(x.timeout),0===this.data[g].length&&delete this.data[g],this.onRemove(x.value),this.order.splice(this.order.indexOf(g),1),this}setMaxSize(s){for(this.max=s;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(s){const c=[];for(const g in this.data)for(const b of this.data[g])s(b.value)||c.push(b);for(const g of c)this.remove(g.value.tileID,g)}}class up{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(s,c,g){const b=String(c);if(this.stateChanges[s]=this.stateChanges[s]||{},this.stateChanges[s][b]=this.stateChanges[s][b]||{},f.l(this.stateChanges[s][b],g),null===this.deletedStates[s]){this.deletedStates[s]={};for(const x in this.state[s])x!==b&&(this.deletedStates[s][x]=null)}else if(this.deletedStates[s]&&null===this.deletedStates[s][b]){this.deletedStates[s][b]={};for(const x in this.state[s][b])g[x]||(this.deletedStates[s][b][x]=null)}else for(const x in g)this.deletedStates[s]&&this.deletedStates[s][b]&&null===this.deletedStates[s][b][x]&&delete this.deletedStates[s][b][x]}removeFeatureState(s,c,g){if(null===this.deletedStates[s])return;const b=String(c);if(this.deletedStates[s]=this.deletedStates[s]||{},g&&void 0!==c)null!==this.deletedStates[s][b]&&(this.deletedStates[s][b]=this.deletedStates[s][b]||{},this.deletedStates[s][b][g]=null);else if(void 0!==c)if(this.stateChanges[s]&&this.stateChanges[s][b])for(g in this.deletedStates[s][b]={},this.stateChanges[s][b])this.deletedStates[s][b][g]=null;else this.deletedStates[s][b]=null;else this.deletedStates[s]=null}getState(s,c){const g=this.state[s]||{},b=this.stateChanges[s]||{},x=this.deletedStates[s];if(null===x)return{};if(void 0!==c){const A=String(c),F=f.l({},g[A],b[A]);if(x){const N=x[c];if(null===N)return{};for(const z in N)delete F[z]}return F}const M=f.l({},g,b);if(x)for(const A in x)delete M[A];return M}initializeTileState(s,c){s.refreshFeatureState(c)}coalesceChanges(s,c){const g={};for(const b in this.stateChanges){this.state[b]=this.state[b]||{};const x={};for(const M in this.stateChanges[b])this.state[b][M]||(this.state[b][M]={}),f.l(this.state[b][M],this.stateChanges[b][M]),x[M]=this.state[b][M];g[b]=x}for(const b in this.deletedStates){this.state[b]=this.state[b]||{};const x={};if(null===this.deletedStates[b])for(const M in this.state[b])x[M]={},this.state[b][M]={};else for(const M in this.deletedStates[b]){if(null===this.deletedStates[b][M])this.state[b][M]={};else if(this.state[b][M])for(const A of Object.keys(this.deletedStates[b][M]))delete this.state[b][M][A];x[M]=this.state[b][M]}g[b]=g[b]||{},f.l(g[b],x)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(g).length)for(const b in s)s[b].refreshFeatureState(c)}}class sl extends f.E{constructor(s,c,g){super(),this.id=s,this._onlySymbols=g,c.on("data",b=>{"source"===b.dataType&&"metadata"===b.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===b.dataType&&"content"===b.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),c.on("error",()=>{this._sourceErrored=!0}),this._source=c,this._tiles={},this._cache=new fb(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new up,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"raster-array"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(s){this.map=s,this._minTileCacheSize=void 0===this._minTileCacheSize&&s?s._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&s?s._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const s in this._tiles){const c=this._tiles[s];if("loaded"!==c.state&&"errored"!==c.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const s=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,s&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(s,c){return s.isSymbolTile=this._onlySymbols,s.isExtraShadowCaster=this._shadowCasterTiles[s.tileID.key],this._source.loadTile(s,c)}_unloadTile(s){if(this._source.unloadTile)return this._source.unloadTile(s)}_abortTile(s){if(this._source.abortTile)return this._source.abortTile(s)}serialize(){return this._source.serialize()}prepare(s){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const g=this._tiles[c];g.upload(s),g.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return f.bj(this._tiles).map(s=>s.tileID).sort(H_).map(s=>s.key)}getRenderableIds(s,c){const g=[];for(const b in this._tiles)this._isIdRenderable(+b,s,c)&&g.push(this._tiles[b]);return s?g.sort((b,x)=>{const M=b.tileID,A=x.tileID,F=new f.P(M.canonical.x,M.canonical.y)._rotate(this.transform.angle),N=new f.P(A.canonical.x,A.canonical.y)._rotate(this.transform.angle);return M.overscaledZ-A.overscaledZ||N.y-F.y||N.x-F.x}).map(b=>b.tileID.key):g.map(b=>b.tileID).sort(H_).map(b=>b.key)}hasRenderableParent(s){const c=this.findLoadedParent(s,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(s,c,g){return this._tiles[s]&&this._tiles[s].hasData()&&!this._coveredTiles[s]&&(c||!this._tiles[s].holdingForFade())&&(g||!this._shadowCasterTiles[s])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const s in this._tiles)"errored"!==this._tiles[s].state&&this._reloadTile(+s,"reloading")}}_reloadTile(s,c){const g=this._tiles[s];g&&("loading"!==g.state&&(g.state=c),this._loadTile(g,this._tileLoaded.bind(this,g,s,c)))}_tileLoaded(s,c,g,b){if(b)if(s.state="errored",404!==b.status)this._source.fire(new f.y(b,{tile:s}));else{if(this._source.fire(new f.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:s})),!(s.tileID.key in this._loadedParentTiles))return;if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const x=this.map.painter.terrain;this.update(this.transform,x.getScaledDemTileSize(),!0),x.resetTileLookupCache(this.id)}else this.update(this.transform)}else s.timeAdded=f.q.now(),"expired"===g&&(s.refreshedUponExpiration=!0),this._setTileReloadTimer(c,s),"raster-dem"===this._source.type&&s.dem&&this._backfillDEM(s),this._state.initializeTileState(s,this.map?this.map.painter:null),this._source.fire(new f.z("data",{dataType:"source",tile:s,coord:s.tileID,sourceCacheId:this.id}))}_backfillDEM(s){const c=this.getRenderableIds();for(let b=0;b<c.length;b++){const x=c[b];if(s.neighboringTiles&&s.neighboringTiles[x]){const M=this.getTileByID(x);g(s,M),g(M,s)}}function g(b,x){if(!b.dem||b.dem.borderReady)return;b.needsHillshadePrepare=!0,b.needsDEMTextureUpload=!0;let M=x.tileID.canonical.x-b.tileID.canonical.x;const A=x.tileID.canonical.y-b.tileID.canonical.y,F=Math.pow(2,b.tileID.canonical.z),N=x.tileID.key;0===M&&0===A||Math.abs(A)>1||(Math.abs(M)>1&&(1===Math.abs(M+F)?M+=F:1===Math.abs(M-F)&&(M-=F)),x.dem&&b.dem&&(b.dem.backfillBorder(x.dem,M,A),b.neighboringTiles&&b.neighboringTiles[N]&&(b.neighboringTiles[N].backfilled=!0)))}}getTile(s){return this.getTileByID(s.key)}getTileByID(s){return this._tiles[s]}_retainLoadedChildren(s,c,g,b){for(const x in this._tiles){let M=this._tiles[x];if(b[x]||!M.hasData()||M.tileID.overscaledZ<=c||M.tileID.overscaledZ>g)continue;let A=M.tileID;for(;M&&M.tileID.overscaledZ>c+1;){const N=M.tileID.scaledTo(M.tileID.overscaledZ-1);M=this._tiles[N.key],M&&M.hasData()&&(A=N)}let F=A;for(;F.overscaledZ>c;)if(F=F.scaledTo(F.overscaledZ-1),s[F.key]){b[A.key]=A;break}}}findLoadedParent(s,c){if(s.key in this._loadedParentTiles){const g=this._loadedParentTiles[s.key];return g&&g.tileID.overscaledZ>=c?g:null}for(let g=s.overscaledZ-1;g>=c;g--){const b=s.scaledTo(g),x=this._getLoadedTile(b);if(x)return x}}_getLoadedTile(s){const c=this._tiles[s.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?s.wrapped().key:s.canonical.key)}updateCacheSize(s,c){c=c||this._source.tileSize;const g=Math.ceil(s.width/c)+1,b=Math.ceil(s.height/c)+1,x=Math.floor(g*b*5),M="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,x):x,A="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(A)}handleWrapJump(s){const c=Math.round((s-(void 0===this._prevLng?s:this._prevLng))/360);if(this._prevLng=s,c){const g={};for(const b in this._tiles){const x=this._tiles[b];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+c),g[x.tileID.key]=x}this._tiles=g;for(const b in this._timers)clearTimeout(this._timers[b]),delete this._timers[b];for(const b in this._tiles)this._setTileReloadTimer(+b,this._tiles[b])}}update(s,c,g,b){if(this.transform=s,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!g)return;this.updateCacheSize(s,c),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const x="batched-model"===this._source.type;let M,A=this._source.maxzoom;const F=this.map&&this.map.painter?this.map.painter._terrain:null;if(F&&F.sourceCache===this&&F.attenuationRange()){const H=F.attenuationRange()[0],j=Math.floor(H)-Math.log2(F.getDemUpscale());A>j&&(A=j)}if(this.used||this.usedForTerrain){if(this._source.tileID)M=s.getVisibleUnwrappedCoordinates(this._source.tileID).map(H=>new f.aG(H.canonical.z,H.wrap,H.canonical.z,H.canonical.x,H.canonical.y));else if(0!==this.tileCoverLift){const H=s.clone();H.tileCoverLift=this.tileCoverLift,M=H.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:A,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:x}),this._source.minzoom<=1&&"globe"===s.projection.name&&(M.push(new f.aG(1,0,1,0,0)),M.push(new f.aG(1,0,1,1,0)),M.push(new f.aG(1,0,1,0,1)),M.push(new f.aG(1,0,1,1,1)))}else if(M=s.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:A,roundZoom:this._source.roundZoom&&!g,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:x}),this._source.hasTile){const H=this._source.hasTile.bind(this._source);M=M.filter(j=>H(j))}}else M=[];if(M.length>0&&this.castsShadows&&b&&"globe"!==this.transform.projection.name&&!this.usedForTerrain&&!Jm(this._source.type)){const H=s.coveringZoomLevel({tileSize:c||this._source.tileSize,roundZoom:this._source.roundZoom&&!g}),j=Math.min(H,this._source.maxzoom);if(x){const G=s.extendTileCover(M,j);for(const J of G)M.push(J)}else{const G=s.extendTileCover(M,j,b);for(const J of G)this._shadowCasterTiles[J.key]=!0,M.push(J)}}const N=this._updateRetainedTiles(M);if(Jm(this._source.type)&&0!==M.length){const H={},j={},G=Object.keys(N);for(const Q of G){const te=N[Q],ne=this._tiles[Q];if(!ne||ne.fadeEndTime&&ne.fadeEndTime<=f.q.now())continue;const le=this.findLoadedParent(te,Math.max(te.overscaledZ-sl.maxOverzooming,this._source.minzoom));le&&(this._addTile(le.tileID),H[le.tileID.key]=le.tileID),j[Q]=te}const J=M[M.length-1].overscaledZ;for(const Q in this._tiles){const te=this._tiles[Q];if(N[Q]||!te.hasData())continue;let ne=te.tileID;for(;ne.overscaledZ>J;){ne=ne.scaledTo(ne.overscaledZ-1);const le=this._tiles[ne.key];if(le&&le.hasData()&&j[ne.key]){N[Q]=te.tileID;break}}}for(const Q in H)N[Q]||(this._coveredTiles[Q]=!0,N[Q]=H[Q])}for(const H in N)this._tiles[H].clearFadeHold();const z=f.bk(this._tiles,N);for(const H of z){const j=this._tiles[H];j.hasSymbolBuckets&&!j.holdingForFade()?j.setHoldDuration(this.map._fadeDuration):j.hasSymbolBuckets&&!j.symbolFadeFinished()||this._removeTile(+H)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const s in this._tiles)this._tiles[s].holdingForFade()&&this._removeTile(+s)}_updateRetainedTiles(s){const c={};if(0===s.length)return c;const g={},b=s.reduce((N,z)=>Math.min(N,z.overscaledZ),1/0),x=s[0].overscaledZ,M=Math.max(x-sl.maxOverzooming,this._source.minzoom),A=Math.max(x+sl.maxUnderzooming,this._source.minzoom),F={};for(const N of s){const z=this._addTile(N);c[N.key]=N,z.hasData()||b<this._source.maxzoom&&(F[N.key]=N)}this._retainLoadedChildren(F,b,A,c);for(const N of s){let z=this._tiles[N.key];if(z.hasData())continue;if(N.canonical.z>=this._source.maxzoom){const j=N.children(this._source.maxzoom)[0],G=this.getTile(j);if(G&&G.hasData()){c[j.key]=j;continue}}else{const j=N.children(this._source.maxzoom);if(c[j[0].key]&&c[j[1].key]&&c[j[2].key]&&c[j[3].key])continue}let H=z.wasRequested();for(let j=N.overscaledZ-1;j>=M;--j){const G=N.scaledTo(j);if(g[G.key]||(g[G.key]=!0,z=this.getTile(G),!z&&H&&(z=this._addTile(G)),z&&(c[G.key]=G,H=z.wasRequested(),z.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const s in this._tiles){const c=[];let g,b=this._tiles[s].tileID;for(;b.overscaledZ>0;){if(b.key in this._loadedParentTiles){g=this._loadedParentTiles[b.key];break}c.push(b.key);const x=b.scaledTo(b.overscaledZ-1);if(g=this._getLoadedTile(x),g)break;b=x}for(const x of c)this._loadedParentTiles[x]=g}}_addTile(s){let c=this._tiles[s.key];if(c)return!0!==c.isExtraShadowCaster||this._shadowCasterTiles[s.key]||this._reloadTile(s.key,"reloading"),c;c=this._cache.getAndRemove(s),c&&(this._setTileReloadTimer(s.key,c),c.tileID=s,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[s.key]&&(clearTimeout(this._cacheTimers[s.key]),delete this._cacheTimers[s.key],this._setTileReloadTimer(s.key,c)));const g=!!c;if(!g){const b=this.map?this.map.painter:null,x=this._source.tileSize*s.overscaleFactor();c="raster-array"===this._source.type?new j_(s,x,this.transform.tileZoom,b,this._isRaster):new Mu(s,x,this.transform.tileZoom,b,this._isRaster),this._loadTile(c,this._tileLoaded.bind(this,c,s.key,c.state))}return c?(c.uses++,this._tiles[s.key]=c,g||this._source.fire(new f.z("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c):null}_setTileReloadTimer(s,c){s in this._timers&&(clearTimeout(this._timers[s]),delete this._timers[s]);const g=c.getExpiryTimeout();g&&(this._timers[s]=setTimeout(()=>{this._reloadTile(s,"expired"),delete this._timers[s]},g))}_removeTile(s){const c=this._tiles[s];c&&(c.uses--,delete this._tiles[s],this._timers[s]&&(clearTimeout(this._timers[s]),delete this._timers[s]),c.uses>0||(c.hasData()&&"reloading"!==c.state||"empty"===c.state?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const s in this._tiles)this._removeTile(+s);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(s,c,g){const b=[],x=this.transform;if(!x)return b;const M="globe"===x.projection.name,A=f.at(x.center.lng);for(const F in this._tiles){const N=this._tiles[F];if(g&&N.clearQueryDebugViz(),N.holdingForFade())continue;let z;if(M){const H=N.tileID.canonical;if(0===H.z){const j=[Math.abs(f.aw(A,...ki(H,-1))-A),Math.abs(f.aw(A,...ki(H,1))-A)];z=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(f.aw(A,...ki(H,-1))-A),Math.abs(f.aw(A,...ki(H,0))-A),Math.abs(f.aw(A,...ki(H,1))-A)];z=[j.indexOf(Math.min(...j))-1]}}else z=[0];for(const H of z){const j=s.containsTile(N,x,c,H);j&&b.push(j)}}return b}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(s){return this._getRenderableCoordinates(s)}_getRenderableCoordinates(s,c){const g=this.getRenderableIds(s,c).map(x=>this._tiles[x].tileID),b="globe"===this.transform.projection.name;for(const x of g)x.projMatrix=this.transform.calculateProjMatrix(x.toUnwrapped()),x.expandedProjMatrix=b?this.transform.calculateProjMatrix(x.toUnwrapped(),!1,!0):x.projMatrix;return g}sortCoordinatesByDistance(s){const c=s.slice(),g=this.transform._camera.position,b=this.transform._camera.forward(),x={};for(const M of c){const A=1/(1<<M.canonical.z);x[M.key]=((M.canonical.x+.5)*A+M.wrap-g[0])*b[0]+((M.canonical.y+.5)*A-g[1])*b[1]-g[2]*b[2]}return c.sort((M,A)=>x[M.key]-x[A.key]),c}hasTransition(){if(this._source.hasTransition())return!0;if(Jm(this._source.type))for(const s in this._tiles){const c=this._tiles[s];if(void 0!==c.fadeEndTime&&c.fadeEndTime>=f.q.now())return!0}return!1}setFeatureState(s,c,g){this._state.updateState(s=s||"_geojsonTileLayer",c,g)}removeFeatureState(s,c,g){this._state.removeFeatureState(s=s||"_geojsonTileLayer",c,g)}getFeatureState(s,c){return this._state.getState(s=s||"_geojsonTileLayer",c)}setDependencies(s,c,g){const b=this._tiles[s];b&&b.setDependencies(c,g)}reloadTilesForDependencies(s,c){for(const g in this._tiles)this._tiles[g].hasDependency(s,c)&&this._reloadTile(+g,"reloading");this._cache.filter(g=>!g.hasDependency(s,c))}_preloadTiles(s,c){if(!this._sourceLoaded){const F=()=>{this._sourceLoaded&&(this._source.off("data",F),this._preloadTiles(s,c))};return void this._source.on("data",F)}const g=new Map,b=Array.isArray(s)?s:[s],x=this.map.painter.terrain,M=this.usedForTerrain&&x?x.getScaledDemTileSize():this._source.tileSize;for(const F of b){const N=F.coveringTiles({tileSize:M,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const z of N)g.set(z.key,z);this.usedForTerrain&&F.updateElevation(!1)}const A=Array.from(g.values());f.bl(A,(F,N)=>{const z=new Mu(F,this._source.tileSize*F.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(z,H=>{"raster-dem"===this._source.type&&z.dem&&this._backfillDEM(z),N(H,z)})},c)}}function H_(m,s){const c=Math.abs(2*m.wrap)-+(m.wrap<0),g=Math.abs(2*s.wrap)-+(s.wrap<0);return m.overscaledZ-s.overscaledZ||g-c||s.canonical.y-m.canonical.y||s.canonical.x-m.canonical.x}function Jm(m){return"raster"===m||"image"===m||"video"===m||"custom"===m}function ki(m,s){const c=1<<m.z;return[m.x/c+s,(m.x+1)/c+s]}sl.maxOverzooming=10,sl.maxUnderzooming=3;class _a{constructor(s){this.style=s,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const s=!1,c=!1;for(const g in this.style._mergedLayers){const b=this.style._mergedLayers[g];if("fill-extrusion"===b.type)this.layers.push({layer:b,visible:s,visibilityChanged:c});else if("model"===b.type){const x=this.style.getLayerSource(b);x&&"batched-model"===x.type&&this.layers.push({layer:b,visible:s,visibilityChanged:c})}}}onNewFrame(s){this.layersGotHidden=!1;for(const c of this.layers){const g=c.layer;let b=!1;"fill-extrusion"===g.type?b=!g.isHidden(s)&&g.paint.get("fill-extrusion-opacity")>0:"model"===g.type&&(b=!g.isHidden(s)&&g.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!b&&c.visible,c.visible=b}}updateZOffset(s,c){this.currentBuildingBuckets=[];for(const b of this.layers){const x=b.layer,M=this.style.getLayerSourceCache(x);let A=1;"fill-extrusion"===x.type&&(A=b.visible?x.paint.get("fill-extrusion-vertical-scale"):0);let F=M?M.getTile(c):null;if(!F&&M&&c.canonical.z>M.getSource().minzoom){let N=c.scaledTo(Math.min(M.getSource().maxzoom,c.overscaledZ-1));for(;N.overscaledZ>=M.getSource().minzoom&&(F=M.getTile(N),!F&&0!==N.overscaledZ);)N=N.scaledTo(N.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:F?F.getBucket(x):null,tileID:F?F.tileID:c,verticalScale:A})}s.hasAnyZOffset=!1;let g=!1;for(let b=0;b<s.symbolInstances.length;b++){const x=s.symbolInstances.get(b),M=x.zOffset,A=this._getHeightAtTileOffset(c,x.tileAnchorX,x.tileAnchorY);x.zOffset=A!==Number.NEGATIVE_INFINITY?A:M,g||M===x.zOffset||(g=!0),s.hasAnyZOffset||0===x.zOffset||(s.hasAnyZOffset=!0)}g&&(s.zOffsetBuffersNeedUpload=!0,s.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(s,c,g,b){let x=c,M=g;if(s.canonical.z!==b.canonical.z){const A=b.canonical,F=1/(1<<s.canonical.z-A.z);x=(c+s.canonical.x*f.ag)*F-A.x*f.ag|0,M=(g+s.canonical.y*f.ag)*F-A.y*f.ag|0}return{tileX:x,tileY:M}}_getHeightAtTileOffset(s,c,g){let b,x;for(let M=0;M<this.layers.length;++M){if("fill-extrusion"!==this.layers[M].layer.type)continue;const{bucket:A,tileID:F,verticalScale:N}=this.currentBuildingBuckets[M];if(!A)continue;const{tileX:z,tileY:H}=this._mapCoordToOverlappingTile(s,c,g,F),j=A.getHeightAtTileCoord(z,H);j&&void 0!==j.height&&(j.hidden?b=j.height:x=Math.max(j.height*N,x||0))}if(void 0!==x)return x;for(let M=0;M<this.layers.length;++M){const A=this.layers[M];if("model"!==A.layer.type||!A.visible)continue;const{bucket:F,tileID:N}=this.currentBuildingBuckets[M];if(!F)continue;const{tileX:z,tileY:H}=this._mapCoordToOverlappingTile(s,c,g,N),j=F.getHeightAtTileCoord(z,H);if(j&&!j.hidden)return void 0===j.height&&void 0!==b?Math.min(j.maxHeight,b)*j.verticalScale:j.height?j.height*j.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Lt(m,s){const c={};for(const g in m)"ref"!==g&&(c[g]=m[g]);return f.bm.forEach(g=>{g in s&&(c[g]=s[g])}),c}function pb(m){m=m.slice();const s=Object.create(null);for(let c=0;c<m.length;c++)s[m[c].id]=m[c];for(let c=0;c<m.length;c++)"ref"in m[c]&&(m[c]=Lt(m[c],s[m[c].ref]));return m}const Ei={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function $_(m,s,c){c.push({command:Ei.addSource,args:[m,s[m]]})}function Al(m,s,c){s.push({command:Ei.removeSource,args:[m]}),c[m]=!0}function mb(m,s,c,g){Al(m,c,g),$_(m,s,c)}function Nt(m,s,c){let g;for(g in m[c])if(m[c].hasOwnProperty(g)&&"data"!==g&&!f.bn(m[c][g],s[c][g]))return!1;for(g in s[c])if(s[c].hasOwnProperty(g)&&"data"!==g&&!f.bn(m[c][g],s[c][g]))return!1;return!0}function Yt(m,s,c,g,b,x){let M;for(M in s=s||{},m=m||{})m.hasOwnProperty(M)&&(f.bn(m[M],s[M])||c.push({command:x,args:[g,M,s[M],b]}));for(M in s)s.hasOwnProperty(M)&&!m.hasOwnProperty(M)&&(f.bn(m[M],s[M])||c.push({command:x,args:[g,M,s[M],b]}))}function Qt(m){return m.id}function gi(m,s){return m[s.id]=s,m}class ya{constructor(s,c){this.reset(s,c)}reset(s,c){this.points=s||[],this._distances=[0];for(let g=1;g<this.points.length;g++)this._distances[g]=this._distances[g-1]+this.points[g].dist(this.points[g-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(s){if(1===this.points.length)return this.points[0];s=f.aw(s,0,1);let c=1,g=this._distances[c];const b=s*this.paddedLength+this.padding;for(;g<b&&c<this._distances.length;)g=this._distances[++c];const x=c-1,M=this._distances[x],A=g-M,F=A>0?(b-M)/A:0;return this.points[x].mult(1-F).add(this.points[c].mult(F))}}class Dd{constructor(s,c,g){const b=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(s/g),this.yCellCount=Math.ceil(c/g);for(let M=0;M<this.xCellCount*this.yCellCount;M++)b.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=s,this.height=c,this.xScale=this.xCellCount/s,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(s,c,g,b,x){this._forEachCell(c,g,b,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(s),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(x)}insertCircle(s,c,g,b){this._forEachCell(c-b,g-b,c+b,g+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(s),this.circles.push(c),this.circles.push(g),this.circles.push(b)}_insertBoxCell(s,c,g,b,x,M){this.boxCells[x].push(M)}_insertCircleCell(s,c,g,b,x,M){this.circleCells[x].push(M)}_query(s,c,g,b,x,M){if(g<0||s>this.width||b<0||c>this.height)return!x&&[];const A=[];if(s<=0&&c<=0&&this.width<=g&&this.height<=b){if(x)return!0;for(let F=0;F<this.boxKeys.length;F++)A.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const N=this.circles[3*F],z=this.circles[3*F+1],H=this.circles[3*F+2];A.push({key:this.circleKeys[F],x1:N-H,y1:z-H,x2:N+H,y2:z+H})}return M?A.filter(M):A}return this._forEachCell(s,c,g,b,this._queryCell,A,{hitTest:x,seenUids:{box:{},circle:{}}},M),x?A.length>0:A}_queryCircle(s,c,g,b,x){const M=s-g,A=s+g,F=c-g,N=c+g;if(A<0||M>this.width||N<0||F>this.height)return!b&&[];const z=[];return this._forEachCell(M,F,A,N,this._queryCellCircle,z,{hitTest:b,circle:{x:s,y:c,radius:g},seenUids:{box:{},circle:{}}},x),b?z.length>0:z}query(s,c,g,b,x){return this._query(s,c,g,b,!1,x)}hitTest(s,c,g,b,x){return this._query(s,c,g,b,!0,x)}hitTestCircle(s,c,g,b){return this._queryCircle(s,c,g,!0,b)}_queryCell(s,c,g,b,x,M,A,F){const N=A.seenUids,z=this.boxCells[x];if(null!==z){const j=this.bboxes;for(const G of z)if(!N.box[G]){N.box[G]=!0;const J=4*G;if(s<=j[J+2]&&c<=j[J+3]&&g>=j[J+0]&&b>=j[J+1]&&(!F||F(this.boxKeys[G]))){if(A.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[G],x1:j[J],y1:j[J+1],x2:j[J+2],y2:j[J+3]})}}}const H=this.circleCells[x];if(null!==H){const j=this.circles;for(const G of H)if(!N.circle[G]){N.circle[G]=!0;const J=3*G;if(this._circleAndRectCollide(j[J],j[J+1],j[J+2],s,c,g,b)&&(!F||F(this.circleKeys[G]))){if(A.hitTest)return M.push(!0),!0;{const Q=j[J],te=j[J+1],ne=j[J+2];M.push({key:this.circleKeys[G],x1:Q-ne,y1:te-ne,x2:Q+ne,y2:te+ne})}}}}}_queryCellCircle(s,c,g,b,x,M,A,F){const N=A.circle,z=A.seenUids,H=this.boxCells[x];if(null!==H){const G=this.bboxes;for(const J of H)if(!z.box[J]){z.box[J]=!0;const Q=4*J;if(this._circleAndRectCollide(N.x,N.y,N.radius,G[Q+0],G[Q+1],G[Q+2],G[Q+3])&&(!F||F(this.boxKeys[J])))return M.push(!0),!0}}const j=this.circleCells[x];if(null!==j){const G=this.circles;for(const J of j)if(!z.circle[J]){z.circle[J]=!0;const Q=3*J;if(this._circlesCollide(G[Q],G[Q+1],G[Q+2],N.x,N.y,N.radius)&&(!F||F(this.circleKeys[J])))return M.push(!0),!0}}}_forEachCell(s,c,g,b,x,M,A,F){const N=this._convertToXCellCoord(s),z=this._convertToYCellCoord(c),H=this._convertToXCellCoord(g),j=this._convertToYCellCoord(b);for(let G=N;G<=H;G++)for(let J=z;J<=j;J++)if(x.call(this,s,c,g,b,this.xCellCount*J+G,M,A,F))return}_convertToXCellCoord(s){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(s*this.xScale)))}_convertToYCellCoord(s){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(s*this.yScale)))}_circlesCollide(s,c,g,b,x,M){const A=b-s,F=x-c,N=g+M;return N*N>A*A+F*F}_circleAndRectCollide(s,c,g,b,x,M,A){const F=(M-b)/2,N=Math.abs(s-(b+F));if(N>F+g)return!1;const z=(A-x)/2,H=Math.abs(c-(x+z));if(H>z+g)return!1;if(N<=F||H<=z)return!0;const j=N-F,G=H-z;return j*j+G*G<=g*g}}const _i_unknown=0,_i_flipRequired=1,_i_flipNotRequired=2,Su=Math.tan(85*Math.PI/180);function al(m,s,c,g,b,x,M){const A=f.ab.mat4.create();if(c)if("globe"===x.name){const F=f.bo(b,s);f.ab.mat4.multiply(A,A,F)}else{const F=f.ab.mat2.invert([],M);A[0]=F[0],A[1]=F[1],A[4]=F[2],A[5]=F[3],g||f.ab.mat4.rotateZ(A,A,b.angle)}else f.ab.mat4.multiply(A,b.labelPlaneMatrix,m);return A}function Hc(m,s,c,g,b,x,M){const A=al(m,s,c,g,b,x,M);return"globe"===x.name&&c||(A[2]=A[6]=A[10]=A[14]=0),A}function as(m,s,c,g,b,x,M){if(c){if("globe"===x.name){const A=al(m,s,c,g,b,x,M);return f.ab.mat4.invert(A,A),f.ab.mat4.multiply(A,m,A),A}{const A=f.ab.mat4.clone(m),F=f.ab.mat4.identity([]);return F[0]=M[0],F[1]=M[1],F[4]=M[2],F[5]=M[3],f.ab.mat4.multiply(A,A,F),g||f.ab.mat4.rotateZ(A,A,-b.angle),A}}return b.glCoordMatrix}function ur(m,s,c,g){const b=[m,s,c,1];c?f.ab.vec4.transformMat4(b,b,g):Wh(b,b,g);const x=b[3];return b[0]/=x,b[1]/=x,b[2]/=x,b}function ct(m,s){return Math.min(.5+m/s*.5,1.5)}function Eu(m,s){const c=m[0]/m[3],g=m[1]/m[3];return c>=-s[0]&&c<=s[0]&&g>=-s[1]&&g<=s[1]}function $h(m,s,c,g,b,x,M,A,F,N){const z=c.transform,H=g?m.textSizeData:m.iconSizeData,j=f.bp(H,c.transform.zoom),G="globe"===z.projection.name,J=[256/c.width*2+1,256/c.height*2+1],Q=g?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;Q.clear();let te=null;G&&(te=g?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const ne=m.lineVertexArray,le=g?m.text.placedSymbolArray:m.icon.placedSymbolArray,me=c.transform.width/c.transform.height;let pe,xe=!1;for(let ve=0;ve<le.length;ve++){const be=le.get(ve),{numGlyphs:ye,writingMode:Ee}=be;if(Ee!==f.bq.vertical||xe||pe===f.bq.horizontal||(xe=!0),pe=Ee,(be.hidden||Ee===f.bq.vertical)&&!xe){qh(ye,Q);continue}xe=!1;const Re=new f.P(be.tileAnchorX,be.tileAnchorY);let{x:Xe,y:qe,z:Ae}=z.projection.projectTilePoint(Re.x,Re.y,N.canonical);if(F){const[st,Pt,Vt]=F(Re);Xe+=st,qe+=Pt,Ae+=Vt}const Be=[Xe,qe,Ae,1];if(f.ab.vec4.transformMat4(Be,Be,s),!Eu(Be,J)){qh(ye,Q);continue}const Ye=Be[3],pt=ct(c.transform.getCameraToCenterDistance(z.projection),Ye),Ct=f.br(H,j,be),He=M?Ct/pt:Ct*pt,dt=ur(Xe,qe,Ae,b);if(dt[3]<=0){qh(ye,Q);continue}let Ke={};const bt=M?null:F,ht=hp(be,He,!1,A,s,b,x,m.glyphOffsetArray,ne,Q,te,dt,Re,Ke,me,bt,z.projection,N,M);xe=ht.useVertical,bt&&ht.needsFlipping&&(Ke={}),(ht.notEnoughRoom||xe||ht.needsFlipping&&hp(be,He,!0,A,s,b,x,m.glyphOffsetArray,ne,Q,te,dt,Re,Ke,me,bt,z.projection,N,M).notEnoughRoom)&&qh(ye,Q)}g?(m.text.dynamicLayoutVertexBuffer.updateData(Q),te&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(te)):(m.icon.dynamicLayoutVertexBuffer.updateData(Q),te&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(te))}function Du(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q){const{lineStartIndex:te,glyphStartIndex:ne,segment:le}=A,me=ne+A.numGlyphs,pe=te+A.lineLength,xe=s.getoffsetX(ne),ve=s.getoffsetX(me-1),be=Ko(m*xe,c,g,b,x,M,le,te,pe,F,N,z,H,j,!0,G,J,Q);if(!be)return null;const ye=Ko(m*ve,c,g,b,x,M,le,te,pe,F,N,z,H,j,!0,G,J,Q);return ye?{first:be,last:ye}:null}function Gh(m,s,c,g){return m===f.bq.horizontal&&Math.abs(g)>Math.abs(c)?{useVertical:!0}:m===f.bq.vertical?g>0?{needsFlipping:!0}:null:s!==_i_unknown&&(0===(b=c)||Math.abs(g/b)>Su)?s===_i_flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var b}function hp(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te,ne,le){const me=s/24,pe=m.lineOffsetX*me,xe=m.lineOffsetY*me,{lineStartIndex:ve,glyphStartIndex:be,numGlyphs:ye,segment:Ee,writingMode:Re,flipState:Xe}=m,qe=ve+m.lineLength,Ae=Be=>{if(z){const[He,dt,Ke]=Be.up,bt=N.length;f.bs(z,bt+0,He,dt,Ke),f.bs(z,bt+1,He,dt,Ke),f.bs(z,bt+2,He,dt,Ke),f.bs(z,bt+3,He,dt,Ke)}const[Ye,pt,Ct]=Be.point;f.bt(N,Ye,pt,Ct,Be.angle)};if(ye>1){const Be=Du(me,A,pe,xe,c,H,j,m,F,x,G,Q,!1,te,ne,le);if(!Be)return{notEnoughRoom:!0};if(g&&!c){let[Ye,pt,Ct]=Be.first.point,[He,dt,Ke]=Be.last.point;[Ye,pt]=ur(Ye,pt,Ct,M),[He,dt]=ur(He,dt,Ke,M);const bt=Gh(Re,Xe,(He-Ye)*J,dt-pt);if(m.flipState=bt&&bt.needsFlipping?_i_flipRequired:_i_flipNotRequired,bt)return bt}Ae(Be.first);for(let Ye=be+1;Ye<be+ye-1;Ye++){const pt=Ko(me*A.getoffsetX(Ye),pe,xe,c,H,j,Ee,ve,qe,F,x,G,Q,!1,!1,te,ne,le);if(!pt)return N.length-=4*(Ye-be),{notEnoughRoom:!0};Ae(pt)}Ae(Be.last)}else{if(g&&!c){const Ye=ur(j.x,j.y,0,b),pt=ve+Ee+1,Ct=new f.P(F.getx(pt),F.gety(pt)),He=ur(Ct.x,Ct.y,0,b),dt=He[3]>0?He:$c(j,Ct,Ye,1,b,void 0,te,ne.canonical),Ke=Gh(Re,Xe,(dt[0]-Ye[0])*J,dt[1]-Ye[1]);if(m.flipState=Ke&&Ke.needsFlipping?_i_flipRequired:_i_flipNotRequired,Ke)return Ke}const Be=Ko(me*A.getoffsetX(be),pe,xe,c,H,j,Ee,ve,qe,F,x,G,Q,!1,!1,te,ne,le);if(!Be)return{notEnoughRoom:!0};Ae(Be)}return{}}function Xo(m,s,c,g,b){const{x,y:M,z:A}=g.projectTilePoint(m.x,m.y,s);if(!b)return ur(x,M,A,c);const[F,N,z]=b(m);return ur(x+F,M+N,A+z,c)}function $c(m,s,c,g,b,x,M,A){const F=Xo(m.sub(s)._unit()._add(m),A,b,M,x);return f.ab.vec3.sub(F,c,F),f.ab.vec3.normalize(F,F),f.ab.vec3.scaleAndAdd(F,c,F,g)}function Ko(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te,ne){const le=g?m-s:m+s;let me=le>0?1:-1,pe=0;g&&(me*=-1,pe=Math.PI),me<0&&(pe+=Math.PI);let xe=A+M+(me>0?0:1)|0,ve=b,be=b,ye=0,Ee=0;const Re=Math.abs(le),Xe=[],qe=[];let Ae=x,Be=Ae;const Ye=()=>$c(Be,Ae,be,Re-ye+1,z,j,Q,te.canonical);for(;ye+Ee<=Re;){if(xe+=me,xe<A||xe>=F)return null;if(be=ve,Be=Ae,Xe.push(be),G&&qe.push(Be),Ae=new f.P(N.getx(xe),N.gety(xe)),ve=H[xe],!ve){const Pt=Xo(Ae,te.canonical,z,Q,j);ve=Pt[3]>0?H[xe]=Pt:Ye()}ye+=Ee,Ee=f.ab.vec3.distance(be,ve)}J&&j&&(H[xe]&&(ve=Ye(),Ee=f.ab.vec3.distance(be,ve)),H[xe]=ve);const pt=(Re-ye)/Ee,Ct=Ae.sub(Be)._mult(pt)._add(Be),He=f.ab.vec3.sub([],ve,be),dt=f.ab.vec3.scaleAndAdd([],be,He,pt);let Ke=[0,0,1],bt=He[0],ht=He[1];if(ne&&(Ke=Q.upVector(te.canonical,Ct.x,Ct.y),0!==Ke[0]||0!==Ke[1]||1!==Ke[2])){const Pt=[Ke[2],0,-Ke[0]],Vt=f.ab.vec3.cross([],Ke,Pt);f.ab.vec3.normalize(Pt,Pt),f.ab.vec3.normalize(Vt,Vt),bt=f.ab.vec3.dot(He,Pt),ht=f.ab.vec3.dot(He,Vt)}if(c){const Pt=f.ab.vec3.cross([],Ke,He);f.ab.vec3.normalize(Pt,Pt),f.ab.vec3.scaleAndAdd(dt,dt,Pt,c*me)}const st=pe+Math.atan2(ht,bt);return Xe.push(dt),G&&qe.push(Ct),{point:dt,angle:st,path:Xe,tilePath:qe,up:Ke}}function qh(m,s){const c=s.length,g=c+4*m;s.resize(g),s.float32.fill(-1/0,4*c,4*g)}function Wh(m,s,c){const g=s[0],b=s[1];return m[0]=c[0]*g+c[4]*b+c[12],m[1]=c[1]*g+c[5]*b+c[13],m[3]=c[3]*g+c[7]*b+c[15],m}const gr=100;class Qs{constructor(s,c,g=new Dd(s.width+200,s.height+200,25),b=new Dd(s.width+200,s.height+200,25)){this.transform=s,this.grid=g,this.ignoredGrid=b,this.pitchfactor=Math.cos(s._pitch)*s.cameraToCenterDistance,this.screenRightBoundary=s.width+gr,this.screenBottomBoundary=s.height+gr,this.gridRightBoundary=s.width+200,this.gridBottomBoundary=s.height+200,this.fogState=c}placeCollisionBox(s,c,g,b,x,M,A,F){let N=g.projectedAnchorX,z=g.projectedAnchorY,H=g.projectedAnchorZ;const j=g.elevation,G=g.tileID,J=s.getProjection();if(j&&G){const[ve,be,ye]=J.upVector(G.canonical,g.tileAnchorX,g.tileAnchorY),Ee=J.upVectorScale(G.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;N+=ve*j*Ee,z+=be*j*Ee,H+=ye*j*Ee}const Q=this.projectAndGetPerspectiveRatio(A,N,z,H,g.tileID,"globe"===J.name||!!j||this.transform.pitch>0,J),te=M*Q.perspectiveRatio,ne=(g.x1*c+b.x-g.padding)*te+Q.point.x,le=(g.y1*c+b.y-g.padding)*te+Q.point.y,me=(g.x2*c+b.x+g.padding)*te+Q.point.x,pe=(g.y2*c+b.y+g.padding)*te+Q.point.y,xe=Q.perspectiveRatio<=.55||Q.occluded;return!this.isInsideGrid(ne,le,me,pe)||!x&&this.grid.hitTest(ne,le,me,pe,F)||xe?{box:[],offscreen:!1,occluded:Q.occluded}:{box:[ne,le,me,pe],offscreen:this.isOffscreen(ne,le,me,pe),occluded:!1}}placeCollisionCircles(s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q){const te=[],ne=this.transform.elevation,le=s.getProjection(),me=ne?ne.getAtTileOffsetFunc(Q,this.transform.center.lat,this.transform.worldSize,le):null,pe=new f.P(g.tileAnchorX,g.tileAnchorY);let{x:xe,y:ve,z:be}=le.projectTilePoint(pe.x,pe.y,Q.canonical);if(me){const[Ct,He,dt]=me(pe);xe+=Ct,ve+=He,be+=dt}const ye="globe"===le.name,Ee=this.projectAndGetPerspectiveRatio(A,xe,ve,be,Q,ye||!!ne||this.transform.pitch>0,le),{perspectiveRatio:Re}=Ee,Xe=(H?M/Re:M*Re)/f.bw,qe=ur(xe,ve,be,F),Ae=Ee.signedDistanceFromCamera>0?Du(Xe,x,g.lineOffsetX*Xe,g.lineOffsetY*Xe,!1,qe,pe,g,b,F,{},ne&&!H?me:null,H&&!!ne,le,Q,H):null;let Be=!1,Ye=!1,pt=!0;if(Ae&&!Ee.occluded){const Ct=.5*G*Re+J,He=new f.P(-100,-100),dt=new f.P(this.screenRightBoundary,this.screenBottomBoundary),Ke=new ya,{first:bt,last:ht}=Ae,st=bt.path.length;let Pt=[];for(let Gt=st-1;Gt>=1;Gt--)Pt.push(bt.path[Gt]);for(let Gt=1;Gt<ht.path.length;Gt++)Pt.push(ht.path[Gt]);const Vt=2.5*Ct;N&&(Pt=Pt.map(([Gt,hn,ln],sn)=>(me&&!ye&&(ln=me(sn<st-1?bt.tilePath[st-1-sn]:ht.tilePath[sn-st+2])[2]),ur(Gt,hn,ln,N))),Pt.some(Gt=>Gt[3]<=0)&&(Pt=[]));let kt=[];if(Pt.length>0){let Gt=1/0,hn=-1/0,ln=1/0,sn=-1/0;for(const Dt of Pt)Gt=Math.min(Gt,Dt[0]),ln=Math.min(ln,Dt[1]),hn=Math.max(hn,Dt[0]),sn=Math.max(sn,Dt[1]);hn>=He.x&&Gt<=dt.x&&sn>=He.y&&ln<=dt.y&&(kt=[Pt.map(Dt=>new f.P(Dt[0],Dt[1]))],(Gt<He.x||hn>dt.x||ln<He.y||sn>dt.y)&&(kt=f.bu(kt,He.x,He.y,dt.x,dt.y)))}for(const Gt of kt){Ke.reset(Gt,.25*Ct);let hn=0;hn=Ke.length<=.5*Ct?1:Math.ceil(Ke.paddedLength/Vt)+1;for(let ln=0;ln<hn;ln++){const sn=ln/Math.max(hn-1,1),Dt=Ke.lerp(sn),si=Dt.x+gr,jn=Dt.y+gr;te.push(si,jn,Ct,0);const hr=si-Ct,fr=jn-Ct,Fi=si+Ct,ji=jn+Ct;if(pt=pt&&this.isOffscreen(hr,fr,Fi,ji),Ye=Ye||this.isInsideGrid(hr,fr,Fi,ji),!c&&this.grid.hitTestCircle(si,jn,Ct,j)&&(Be=!0,!z))return{circles:[],offscreen:!1,collisionDetected:Be,occluded:!1}}}}return{circles:!z&&Be||!Ye?[]:te,offscreen:pt,collisionDetected:Be,occluded:Ee.occluded}}queryRenderedSymbols(s){if(0===s.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let g=1/0,b=1/0,x=-1/0,M=-1/0;for(const z of s){const H=new f.P(z.x+gr,z.y+gr);g=Math.min(g,H.x),b=Math.min(b,H.y),x=Math.max(x,H.x),M=Math.max(M,H.y),c.push(H)}const A=this.grid.query(g,b,x,M).concat(this.ignoredGrid.query(g,b,x,M)),F={},N={};for(const z of A){const H=z.key;if(void 0===F[H.bucketInstanceId]&&(F[H.bucketInstanceId]={}),F[H.bucketInstanceId][H.featureIndex])continue;const j=[new f.P(z.x1,z.y1),new f.P(z.x2,z.y1),new f.P(z.x2,z.y2),new f.P(z.x1,z.y2)];f.bv(c,j)&&(F[H.bucketInstanceId][H.featureIndex]=!0,void 0===N[H.bucketInstanceId]&&(N[H.bucketInstanceId]=[]),N[H.bucketInstanceId].push(H.featureIndex))}return N}insertCollisionBox(s,c,g,b,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:g,featureIndex:b,collisionGroupID:x},s[0],s[1],s[2],s[3])}insertCollisionCircles(s,c,g,b,x){const M=c?this.ignoredGrid:this.grid,A={bucketInstanceId:g,featureIndex:b,collisionGroupID:x};for(let F=0;F<s.length;F+=4)M.insertCircle(A,s[F],s[F+1],s[F+2])}projectAndGetPerspectiveRatio(s,c,g,b,x,M,A){const F=[c,g,b,1];let N=!1;b||this.transform.pitch>0?(f.ab.vec4.transformMat4(F,F,s),this.fogState&&x&&"globe"!==A.name&&(N=function(j,G,J,Q,te,ne){const le=ne.calculateFogTileMatrix(te),me=[G,J,Q];return f.ab.vec3.transformMat4(me,me,le),yn(j,f.ab.vec3.length(me),ne.pitch,ne._fov)}(this.fogState,c,g,b,x.toUnwrapped(),this.transform)>.9)):Wh(F,F,s);const z=F[3];return{point:new f.P((F[0]/z+1)/2*this.transform.width+gr,(-F[1]/z+1)/2*this.transform.height+gr),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(A)/z*.5,1.5),signedDistanceFromCamera:z,occluded:M&&F[2]>z||N}}isOffscreen(s,c,g,b){return g<gr||s>=this.screenRightBoundary||b<gr||c>this.screenBottomBoundary}isInsideGrid(s,c,g,b){return g>=0&&s<this.gridRightBoundary&&b>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const s=f.ab.mat4.identity([]);return f.ab.mat4.translate(s,s,[-100,-100,0]),s}}function va(m,s,c){const g=s.createTileMatrix(m,m.worldSize,c.toUnwrapped());return f.ab.mat4.multiply(new Float32Array(16),m.projMatrix,g)}function Xr(m,s,c){if(s.projection.name===c.projection.name)return m.projMatrix;const g=c.clone();return g.setProjection(s.projection),va(g,s.getProjection(),m)}function Zh(m,s,c){return s.name===c.projection.name?m.projMatrix:va(c,s,m)}class Go{constructor(s,c,g,b){this.opacity=s?Math.max(0,Math.min(1,s.opacity+(s.placed?c:-c))):b&&g?1:0,this.placed=g}isHidden(){return 0===this.opacity&&!this.placed}}class Na{constructor(s,c,g,b,x,M=!1){this.text=new Go(s?s.text:null,c,g,x),this.icon=new Go(s?s.icon:null,c,b,x),this.clipped=M}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Iu{constructor(s,c,g,b=!1){this.text=s,this.icon=c,this.skipFade=g,this.clipped=b}}class hi{constructor(){this.invProjMatrix=f.ab.mat4.create(),this.viewportMatrix=f.ab.mat4.create(),this.circles=[]}}class wr{constructor(s,c,g,b,x){this.bucketInstanceId=s,this.featureIndex=c,this.sourceLayerIndex=g,this.bucketIndex=b,this.tileID=x}}class Id{constructor(s){this.crossSourceCollisions=s,this.maxGroupID=0,this.collisionGroups={}}get(s){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[s]){const c=++this.maxGroupID;this.collisionGroups[s]={ID:c,predicate:g=>g.collisionGroupID===c}}return this.collisionGroups[s]}}function gb(m,s,c,g,b){const{horizontalAlign:x,verticalAlign:M}=f.bD(m),A=-(x-.5)*s,F=-(M-.5)*c,N=f.bC(m,g);return new f.P(A+N[0]*b,F+N[1]*b)}function eg(m,s,c,g,b){const x=new f.P(m,s);return c&&x._rotate(g?b:-b),x}class za{constructor(s,c,g,b,x,M){this.transform=s.clone(),this.projection=s.projection.name,this.collisionIndex=new Qs(this.transform,x),this.buildingIndex=M,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Id(g),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(s,c,g,b,x=1){const M=g.getBucket(c),A=g.latestFeatureIndex;if(!M||!A||c.fqid!==M.layerIds[0])return;const F=M.layers[0].layout,N=M.layers[0].paint,z=g.collisionBoxArray,H=Math.pow(2,this.transform.zoom-g.tileID.overscaledZ),j=g.tileSize/f.ag,G=g.tileID.toUnwrapped();this.transform.setProjection(M.projection);const J=(Q=g.tileID,te=M.getProjection(),ne=this.transform,te.name===this.projection?ne.calculateProjMatrix(Q.toUnwrapped()):va(ne,te,Q));var Q,te,ne;const le="map"===F.get("text-pitch-alignment"),me="map"===F.get("text-rotation-alignment");c.compileFilter(c.options);const pe=c.dynamicFilter(),xe=c.dynamicFilterNeedsFeature(),ve=this.transform.calculatePixelsToTileUnitsMatrix(g),be=Hc(J,g.tileID.canonical,le,me,this.transform,M.getProjection(),ve);let ye=null;if(le){const Ct=as(J,g.tileID.canonical,le,me,this.transform,M.getProjection(),ve);ye=f.ab.mat4.multiply([],this.transform.labelPlaneMatrix,Ct)}let Ee=null;pe&&g.latestFeatureIndex&&(Ee={unwrappedTileID:G,dynamicFilter:pe,dynamicFilterNeedsFeature:xe}),this.retainedQueryData[M.bucketInstanceId]=new wr(M.bucketInstanceId,A,M.sourceLayerIndex,M.index,g.tileID);const[Re,Xe]=M.layers[0].layout.get("text-size-scale-range"),qe=f.aw(x,Re,Xe),[Ae,Be]=F.get("icon-size-scale-range"),Ye=f.aw(x,Ae,Be),pt={bucket:M,layout:F,paint:N,posMatrix:J,textLabelPlaneMatrix:be,labelToScreenMatrix:ye,clippingData:Ee,scale:H,textPixelRatio:j,holdingForFade:g.holdingForFade(),collisionBoxArray:z,partiallyEvaluatedTextSize:f.bp(M.textSizeData,this.transform.zoom,qe),partiallyEvaluatedIconSize:f.bp(M.iconSizeData,this.transform.zoom,Ye),collisionGroup:this.collisionGroups.get(M.sourceID),latestFeatureIndex:g.latestFeatureIndex};if(b)for(const Ct of M.sortKeyRanges){const{sortKey:He,symbolInstanceStart:dt,symbolInstanceEnd:Ke}=Ct;s.push({sortKey:He,symbolInstanceStart:dt,symbolInstanceEnd:Ke,parameters:pt})}else s.push({symbolInstanceStart:0,symbolInstanceEnd:M.symbolInstances.length,parameters:pt})}attemptAnchorPlacement(s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te,ne,le){const{textOffset0:me,textOffset1:pe,crossTileID:xe}=j,ve=[me,pe],be=gb(s,g,b,ve,x),ye=this.collisionIndex.placeCollisionBox(J,x,c,eg(be.x,be.y,M,A,this.transform.angle),H,F,N,z.predicate);if(te){const Ee=J.getSymbolInstanceIconSize(le,this.transform.zoom,j.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(J,Ee,te,eg(be.x,be.y,M,A,this.transform.angle),H,F,N,z.predicate).box.length)return}if(ye.box.length>0){let Ee;return this.prevPlacement&&this.prevPlacement.variableOffsets[xe]&&this.prevPlacement.placements[xe]&&this.prevPlacement.placements[xe].text&&(Ee=this.prevPlacement.variableOffsets[xe].anchor),this.variableOffsets[xe]={textOffset:ve,width:g,height:b,anchor:s,textScale:x,prevAnchor:Ee},this.markUsedJustification(J,s,j,Q),J.allowVerticalPlacement&&(this.markUsedOrientation(J,Q,j),this.placedOrientations[xe]=Q),{shift:be,placedGlyphBoxes:ye}}}placeLayerBucketPart(s,c,g,b,x=1){const{bucket:M,layout:A,paint:F,posMatrix:N,textLabelPlaneMatrix:z,labelToScreenMatrix:H,clippingData:j,textPixelRatio:G,holdingForFade:J,collisionBoxArray:Q,partiallyEvaluatedTextSize:te,partiallyEvaluatedIconSize:ne,collisionGroup:le,latestFeatureIndex:me}=s.parameters,pe=A.get("text-optional"),xe=A.get("icon-optional"),ve=A.get("text-allow-overlap"),be=A.get("icon-allow-overlap"),ye="map"===A.get("text-rotation-alignment"),Ee="map"===A.get("text-pitch-alignment"),Re=A.get("symbol-z-elevate"),Xe=F.get("symbol-z-offset"),qe="sea"===A.get("symbol-elevation-reference"),[Ae,Be]=A.get("text-size-scale-range"),[Ye,pt]=A.get("icon-size-scale-range"),Ct=f.aw(x,Ae,Be),He=f.aw(x,Ye,pt);this.transform.setProjection(M.projection);let dt=ve&&(be||!M.hasIconData()||xe),Ke=be&&(ve||!M.hasTextData()||pe);const bt=!Xe.isConstant();!M.collisionArrays&&Q&&M.deserializeCollisionBoxes(Q),g&&b&&M.updateCollisionDebugBuffers(this.transform.zoom,Q,Ct,He);const ht=(st,Pt,Vt)=>{const{crossTileID:kt,numVerticalGlyphVertices:Gt}=st;let hn=null;if(j&&j.dynamicFilterNeedsFeature||bt){const pr=this.retainedQueryData[M.bucketInstanceId];hn=me.loadFeature({featureIndex:st.featureIndex,bucketIndex:pr.bucketIndex,sourceLayerIndex:pr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(j&&!(0,j.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},hn,this.retainedQueryData[M.bucketInstanceId].tileID.canonical,new f.P(st.tileAnchorX,st.tileAnchorY),this.transform.calculateDistanceTileData(j.unwrappedTileID)))return this.placements[kt]=new Iu(!1,!1,!1,!0),void c.add(kt);const ln=Xe.evaluate(hn,{});if(c.has(kt))return;if(J)return void(this.placements[kt]=new Iu(!1,!1,!1));let sn=!1,Dt=!1,si=!0,jn=!1,hr=!1,fr=null,Fi={box:null,offscreen:null,occluded:null},ji={box:null,offscreen:null,occluded:null},Zn=null,Ht=null,gn=null,Si=0,Lr=0,Yo=0;Vt.textFeatureIndex?Si=Vt.textFeatureIndex:st.useRuntimeCollisionCircles&&(Si=st.featureIndex),Vt.verticalTextFeatureIndex&&(Lr=Vt.verticalTextFeatureIndex);const Fs=pr=>{pr.tileID=this.retainedQueryData[M.bucketInstanceId].tileID;const nr=this.transform.elevation;pr.elevation=qe?ln:ln+(nr?nr.getAtTileOffset(pr.tileID,pr.tileAnchorX,pr.tileAnchorY):0),pr.elevation+=st.zOffset},us=Vt.textBox;if(us){Fs(us);const pr=Ci=>{let Zi=f.bq.horizontal;if(M.allowVerticalPlacement&&!Ci&&this.prevPlacement){const Fo=this.prevPlacement.placedOrientations[kt];Fo&&(this.placedOrientations[kt]=Fo,Zi=Fo,this.markUsedOrientation(M,Zi,st))}return Zi},nr=(Ci,Zi)=>{if(M.allowVerticalPlacement&&Gt>0&&Vt.verticalTextBox){for(const Fo of M.writingModes)if(Fo===f.bq.vertical?(Fi=Zi(),ji=Fi):Fi=Ci(),Fi&&Fi.box&&Fi.box.length)break}else Fi=Ci()};if(A.get("text-variable-anchor")){let Ci=A.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[kt]){const ar=this.prevPlacement.variableOffsets[kt];Ci.indexOf(ar.anchor)>0&&(Ci=Ci.filter(Ms=>Ms!==ar.anchor),Ci.unshift(ar.anchor))}const Zi=(ar,Ms,ml)=>{const Ls=M.getSymbolInstanceTextSize(te,st,this.transform.zoom,Pt),rd=(ar.x2-ar.x1)*Ls+2*ar.padding,wc=(ar.y2-ar.y1)*Ls+2*ar.padding,Ss=st.hasIconTextFit&&!be?Ms:null;Ss&&Fs(Ss);let hs={box:[],offscreen:!1,occluded:!1};const In=ve?2*Ci.length:Ci.length;for(let gl=0;gl<In;++gl){const nh=this.attemptAnchorPlacement(Ci[gl%Ci.length],ar,rd,wc,Ls,ye,Ee,G,N,le,gl>=Ci.length,st,Pt,M,ml,Ss,te,ne);if(nh&&(hs=nh.placedGlyphBoxes,hs&&hs.box&&hs.box.length)){sn=!0,fr=nh.shift;break}}return hs};nr(()=>Zi(us,Vt.iconBox,f.bq.horizontal),()=>{const ar=Vt.verticalTextBox;return ar&&Fs(ar),M.allowVerticalPlacement&&!(Fi&&Fi.box&&Fi.box.length)&&Gt>0&&ar?Zi(ar,Vt.verticalIconBox,f.bq.vertical):{box:null,offscreen:null,occluded:null}}),Fi&&(sn=Fi.box,si=Fi.offscreen,jn=Fi.occluded);const Fo=pr(!(!Fi||!Fi.box));if(!sn&&this.prevPlacement){const ar=this.prevPlacement.variableOffsets[kt];ar&&(this.variableOffsets[kt]=ar,this.markUsedJustification(M,ar.anchor,st,Fo))}}else{const Ci=(Zi,Fo)=>{const ar=M.getSymbolInstanceTextSize(te,st,this.transform.zoom,Pt,x),Ms=this.collisionIndex.placeCollisionBox(M,ar,Zi,new f.P(0,0),ve,G,N,le.predicate);return Ms&&Ms.box&&Ms.box.length&&(this.markUsedOrientation(M,Fo,st),this.placedOrientations[kt]=Fo),Ms};nr(()=>Ci(us,f.bq.horizontal),()=>{const Zi=Vt.verticalTextBox;return M.allowVerticalPlacement&&Gt>0&&Zi?(Fs(Zi),Ci(Zi,f.bq.vertical)):{box:null,offscreen:null,occluded:null}}),pr(!!(Fi&&Fi.box&&Fi.box.length))}}if(Zn=Fi,sn=Zn&&Zn.box&&Zn.box.length>0,si=Zn&&Zn.offscreen,jn=Zn&&Zn.occluded,st.useRuntimeCollisionCircles){const pr=M.text.placedSymbolArray.get(st.centerJustifiedTextSymbolIndex>=0?st.centerJustifiedTextSymbolIndex:st.verticalPlacedTextSymbolIndex),nr=f.br(M.textSizeData,te,pr),Ci=A.get("text-padding");Ht=this.collisionIndex.placeCollisionCircles(M,ve,pr,M.lineVertexArray,M.glyphOffsetArray,nr,N,z,H,g,Ee,le.predicate,st.collisionCircleDiameter*nr/f.bw,Ci,this.retainedQueryData[M.bucketInstanceId].tileID),sn=ve||Ht.circles.length>0&&!Ht.collisionDetected,si=si&&Ht.offscreen,jn=Ht.occluded}if(Vt.iconFeatureIndex&&(Yo=Vt.iconFeatureIndex),Vt.iconBox){const pr=nr=>{Fs(nr);const Ci=st.hasIconTextFit&&fr?eg(fr.x,fr.y,ye,Ee,this.transform.angle):new f.P(0,0),Zi=M.getSymbolInstanceIconSize(ne,this.transform.zoom,st.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(M,Zi,nr,Ci,be,G,N,le.predicate)};ji&&ji.box&&ji.box.length&&Vt.verticalIconBox?(gn=pr(Vt.verticalIconBox),Dt=gn.box.length>0):(gn=pr(Vt.iconBox),Dt=gn.box.length>0),si=si&&gn.offscreen,hr=gn.occluded}const ko=pe||0===st.numHorizontalGlyphVertices&&0===Gt,to=xe||0===st.numIconVertices;if(ko||to?to?ko||(Dt=Dt&&sn):sn=Dt&&sn:Dt=sn=Dt&&sn,sn&&Zn&&Zn.box&&this.collisionIndex.insertCollisionBox(Zn.box,A.get("text-ignore-placement"),M.bucketInstanceId,ji&&ji.box&&Lr?Lr:Si,le.ID),Dt&&gn&&this.collisionIndex.insertCollisionBox(gn.box,A.get("icon-ignore-placement"),M.bucketInstanceId,Yo,le.ID),Ht&&(sn&&this.collisionIndex.insertCollisionCircles(Ht.circles,A.get("text-ignore-placement"),M.bucketInstanceId,Si,le.ID),g)){const pr=M.bucketInstanceId;let nr=this.collisionCircleArrays[pr];void 0===nr&&(nr=this.collisionCircleArrays[pr]=new hi);for(let Ci=0;Ci<Ht.circles.length;Ci+=4)nr.circles.push(Ht.circles[Ci+0]),nr.circles.push(Ht.circles[Ci+1]),nr.circles.push(Ht.circles[Ci+2]),nr.circles.push(Ht.collisionDetected?1:0)}const Gr="globe"!==M.projection.name;dt=dt&&(Gr||!jn),Ke=Ke&&(Gr||!hr),this.placements[kt]=new Iu(sn||dt,Dt||Ke,si||M.justReloaded),c.add(kt)};if(Re&&this.buildingIndex&&(this.buildingIndex.updateZOffset(M,this.retainedQueryData[M.bucketInstanceId].tileID),M.updateZOffset()),M.sortFeaturesByY){const st=M.getSortedSymbolIndexes(this.transform.angle);for(let Pt=st.length-1;Pt>=0;--Pt){const Vt=st[Pt];ht(M.symbolInstances.get(Vt),Vt,M.collisionArrays[Vt])}M.hasAnyZOffset&&f.w(`${M.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(M.hasAnyZOffset){const st=M.getSortedIndexesByZOffset();for(let Pt=0;Pt<st.length;++Pt){const Vt=st[Pt];ht(M.symbolInstances.get(Vt),Vt,M.collisionArrays[Vt])}}else for(let st=s.symbolInstanceStart;st<s.symbolInstanceEnd;st++)ht(M.symbolInstances.get(st),st,M.collisionArrays[st]);if(g&&M.bucketInstanceId in this.collisionCircleArrays){const st=this.collisionCircleArrays[M.bucketInstanceId];f.ab.mat4.invert(st.invProjMatrix,N),st.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1}markUsedJustification(s,c,g,b){const{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:A,verticalPlacedTextSymbolIndex:F,crossTileID:N}=g,z=f.bB(c),H=b===f.bq.vertical?F:"left"===z?x:"center"===z?M:"right"===z?A:-1;x>=0&&(s.text.placedSymbolArray.get(x).crossTileID=H>=0&&x!==H?0:N),M>=0&&(s.text.placedSymbolArray.get(M).crossTileID=H>=0&&M!==H?0:N),A>=0&&(s.text.placedSymbolArray.get(A).crossTileID=H>=0&&A!==H?0:N),F>=0&&(s.text.placedSymbolArray.get(F).crossTileID=H>=0&&F!==H?0:N)}markUsedOrientation(s,c,g){const b=c===f.bq.horizontal||c===f.bq.horizontalOnly?c:0,x=c===f.bq.vertical?c:0,{leftJustifiedTextSymbolIndex:M,centerJustifiedTextSymbolIndex:A,rightJustifiedTextSymbolIndex:F,verticalPlacedTextSymbolIndex:N}=g,z=s.text.placedSymbolArray;M>=0&&(z.get(M).placedOrientation=b),A>=0&&(z.get(A).placedOrientation=b),F>=0&&(z.get(F).placedOrientation=b),N>=0&&(z.get(N).placedOrientation=x)}commit(s){this.commitTime=s,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let g=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const b=c?c.symbolFadeChange(s):1,x=c?c.opacities:{},M=c?c.variableOffsets:{},A=c?c.placedOrientations:{};for(const F in this.placements){const N=this.placements[F],z=x[F];z?(this.opacities[F]=new Na(z,b,N.text,N.icon,null,N.clipped),g=g||N.text!==z.text.placed||N.icon!==z.icon.placed):(this.opacities[F]=new Na(null,b,N.text,N.icon,N.skipFade,N.clipped),g=g||N.text||N.icon)}for(const F in x){const N=x[F];if(!this.opacities[F]){const z=new Na(N,b,!1,!1);z.isHidden()||(this.opacities[F]=z,g=g||N.text.placed||N.icon.placed)}}for(const F in M)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=M[F]);for(const F in A)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=A[F]);g?this.lastPlacementChangeTime=s:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:s)}updateLayerOpacities(s,c,g,b){const x=new Set;for(const M of c){const A=M.getBucket(s);A&&M.latestFeatureIndex&&s.fqid===A.layerIds[0]&&(this.updateBucketOpacities(A,x,M,M.collisionBoxArray,g,b,M.tileID,s.scope),A.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(A,M.tileID),A.updateZOffset()))}}updateBucketOpacities(s,c,g,b,x,M,A,F){s.hasTextData()&&s.text.opacityVertexArray.clear(),s.hasIconData()&&s.icon.opacityVertexArray.clear(),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexArray.clear(),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexArray.clear();const N=s.layers[0].layout,z=s.layers[0].paint,H=!!s.layers[0].dynamicFilter(),j=new Na(null,0,!1,!1,!0),G=N.get("text-allow-overlap"),J=N.get("icon-allow-overlap"),Q=N.get("text-variable-anchor"),te="map"===N.get("text-rotation-alignment"),ne="map"===N.get("text-pitch-alignment"),le=z.get("symbol-z-offset"),me="sea"===N.get("symbol-elevation-reference"),pe=!le.isConstant(),xe=new Na(null,0,G&&(J||!s.hasIconData()||N.get("icon-optional")),J&&(G||!s.hasTextData()||N.get("text-optional")),!0);!s.collisionArrays&&b&&(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData())&&s.deserializeCollisionBoxes(b);const ve=(ye,Ee,Re)=>{for(let Xe=0;Xe<Ee/4;Xe++)ye.opacityVertexArray.emplaceBack(Re)};let be=0;M&&s.updateReplacement(A,M);for(let ye=0;ye<s.symbolInstances.length;ye++){const Ee=s.symbolInstances.get(ye),{numHorizontalGlyphVertices:Re,numVerticalGlyphVertices:Xe,crossTileID:qe,numIconVertices:Ae,tileAnchorX:Be,tileAnchorY:Ye}=Ee;let pt=null;const Ct=this.retainedQueryData[s.bucketInstanceId];pe&&Ee&&Ct&&(pt=g.latestFeatureIndex.loadFeature({featureIndex:Ee.featureIndex,bucketIndex:Ct.bucketIndex,sourceLayerIndex:Ct.sourceLayerIndex,layoutVertexArrayOffset:0}));const He=le.evaluate(pt,{}),dt=c.has(qe);let Ke=this.opacities[qe];dt?Ke=j:Ke||(Ke=xe,this.opacities[qe]=Ke),c.add(qe);const bt=Re>0||Xe>0,ht=Ae>0,st=this.placedOrientations[qe],Pt=st===f.bq.vertical,Vt=st===f.bq.horizontal||st===f.bq.horizontalOnly;!bt&&!ht||Ke.isHidden()||be++;let kt=!1;if((bt||ht)&&M)for(const Gt of s.activeReplacements){if(f.bx(Gt,x,f.by.Symbol,F)||Gt.min.x>Be||Be>Gt.max.x||Gt.min.y>Ye||Ye>Gt.max.y)continue;const hn=f.bz(Be,Ye,A.canonical,Gt.footprintTileId.canonical);if(kt=f.bA(hn,Gt.footprint),kt)break}if(bt){const Gt=kt?Js:cw(Ke.text);ve(s.text,Re,Pt?Js:Gt),ve(s.text,Xe,Vt?Js:Gt);const hn=Ke.text.isHidden(),{leftJustifiedTextSymbolIndex:ln,centerJustifiedTextSymbolIndex:sn,rightJustifiedTextSymbolIndex:Dt,verticalPlacedTextSymbolIndex:si}=Ee,jn=s.text.placedSymbolArray,hr=hn||Pt?1:0;ln>=0&&(jn.get(ln).hidden=hr),sn>=0&&(jn.get(sn).hidden=hr),Dt>=0&&(jn.get(Dt).hidden=hr),si>=0&&(jn.get(si).hidden=hn||Vt?1:0);const fr=this.variableOffsets[qe];fr&&this.markUsedJustification(s,fr.anchor,Ee,st);const Fi=this.placedOrientations[qe];Fi&&(this.markUsedJustification(s,"left",Ee,Fi),this.markUsedOrientation(s,Fi,Ee))}if(ht){const Gt=kt?Js:cw(Ke.icon),{placedIconSymbolIndex:hn,verticalPlacedIconSymbolIndex:ln}=Ee,sn=s.icon.placedSymbolArray,Dt=Ke.icon.isHidden()?1:0;hn>=0&&(ve(s.icon,Ae,Pt?Js:Gt),sn.get(hn).hidden=Dt),ln>=0&&(ve(s.icon,Ee.numVerticalIconVertices,Vt?Js:Gt),sn.get(ln).hidden=Dt)}if(s.hasIconCollisionBoxData()||s.hasTextCollisionBoxData()){const Gt=s.collisionArrays[ye];if(Gt){let hn=new f.P(0,0),ln=!0;if(Gt.textBox||Gt.verticalTextBox){if(Q){const Dt=this.variableOffsets[qe];Dt?(hn=gb(Dt.anchor,Dt.width,Dt.height,Dt.textOffset,Dt.textScale),te&&hn._rotate(ne?this.transform.angle:-this.transform.angle)):ln=!1}H&&(ln=!Ke.clipped),Gt.textBox&&tg(s.textCollisionBox.collisionVertexArray,Ke.text.placed,!ln||Pt,He,me,hn.x,hn.y),Gt.verticalTextBox&&tg(s.textCollisionBox.collisionVertexArray,Ke.text.placed,!ln||Vt,He,me,hn.x,hn.y)}const sn=ln&&!(Vt||!Gt.verticalIconBox);Gt.iconBox&&tg(s.iconCollisionBox.collisionVertexArray,Ke.icon.placed,sn,He,me,Ee.hasIconTextFit?hn.x:0,Ee.hasIconTextFit?hn.y:0),Gt.verticalIconBox&&tg(s.iconCollisionBox.collisionVertexArray,Ke.icon.placed,!sn,He,me,Ee.hasIconTextFit?hn.x:0,Ee.hasIconTextFit?hn.y:0)}}}if(s.fullyClipped=0===be,s.sortFeatures(this.transform.angle),this.retainedQueryData[s.bucketInstanceId]&&(this.retainedQueryData[s.bucketInstanceId].featureSortOrder=s.featureSortOrder),s.hasTextData()&&s.text.opacityVertexBuffer&&s.text.opacityVertexBuffer.updateData(s.text.opacityVertexArray),s.hasIconData()&&s.icon.opacityVertexBuffer&&s.icon.opacityVertexBuffer.updateData(s.icon.opacityVertexArray),s.hasIconCollisionBoxData()&&s.iconCollisionBox.collisionVertexBuffer&&s.iconCollisionBox.collisionVertexBuffer.updateData(s.iconCollisionBox.collisionVertexArray),s.hasTextCollisionBoxData()&&s.textCollisionBox.collisionVertexBuffer&&s.textCollisionBox.collisionVertexBuffer.updateData(s.textCollisionBox.collisionVertexArray),s.bucketInstanceId in this.collisionCircleArrays){const ye=this.collisionCircleArrays[s.bucketInstanceId];s.placementInvProjMatrix=ye.invProjMatrix,s.placementViewportMatrix=ye.viewportMatrix,s.collisionCircleArray=ye.circles,delete this.collisionCircleArrays[s.bucketInstanceId]}}symbolFadeChange(s){return 0===this.fadeDuration?1:(s-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(s){return Math.max(0,(this.transform.zoom-s)/1.5)}hasTransitions(s){return this.stale||s-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(s,c){const g=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*g>s}setStale(){this.stale=!0}}function tg(m,s,c,g,b,x,M){m.emplaceBack(s?1:0,c?1:0,x||0,M||0,g,b?1:0),m.emplaceBack(s?1:0,c?1:0,x||0,M||0,g,b?1:0),m.emplaceBack(s?1:0,c?1:0,x||0,M||0,g,b?1:0),m.emplaceBack(s?1:0,c?1:0,x||0,M||0,g,b?1:0)}const Yh=Math.pow(2,25),Xi=Math.pow(2,24),ku=Math.pow(2,17),_b=Math.pow(2,16),ba=Math.pow(2,9),Xh=Math.pow(2,8),ng=Math.pow(2,1);function cw(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const s=m.placed?1:0,c=Math.floor(127*m.opacity);return c*Yh+s*Xi+c*ku+s*_b+c*ba+s*Xh+c*ng+s}const Js=0;class ig{constructor(s){this._sortAcrossTiles="viewport-y"!==s.layout.get("symbol-z-order")&&void 0!==s.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(s,c,g,b,x,M){const A=this._bucketParts;for(;this._currentTileIndex<s.length;)if(c.getBucketParts(A,b,s[this._currentTileIndex],this._sortAcrossTiles,M),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,A.sort((F,N)=>F.sortKey-N.sortKey));this._currentPartIndex<A.length;){const F=A[this._currentPartIndex];if(c.placeLayerBucketPart(F,this._seenCrossTileIDs,g,0===F.symbolInstanceStart,M),this._currentPartIndex++,x())return!0}return!1}}class Au{constructor(s,c,g,b,x,M,A,F,N){this.placement=new za(s,x,M,A,F,N),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=g,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(s,c,g,b,x){const M=f.q.now(),A=()=>{const F=f.q.now()-M;return!this._forceFullPlacement&&F>2};for(;this._currentPlacementIndex>=0;){const F=c[s[this._currentPlacementIndex]],N=this.placement.collisionIndex.transform.zoom;if("symbol"===F.type&&(!F.minzoom||F.minzoom<=N)&&(!F.maxzoom||F.maxzoom>N)){const z=F,H=z.layout.get("symbol-z-elevate"),j=void 0!==z.layout.get("symbol-sort-key").constantOr(1),G=z.layout.get("symbol-z-order"),J="viewport-y"===G||"auto"===G&&!("viewport-y"!==G&&j),Q=z.layout.get("text-allow-overlap")||z.layout.get("icon-allow-overlap")||z.layout.get("text-ignore-placement")||z.layout.get("icon-ignore-placement"),te=J&&Q,ne=this._inProgressLayer=this._inProgressLayer||new ig(z),le=f.aC(F.source,F.scope);if(ne.continuePlacement(H||te?b[le]:g[le],this.placement,this._showCollisionBoxes,F,A,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(s){return this.placement.commit(s),this.placement}}const uc=512/f.ag/2;class dw{constructor(s,c,g){this.tileID=s,this.bucketInstanceId=g,this.index=new f.bE(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const b=s.canonical.x*f.ag,x=s.canonical.y*f.ag;for(let M=0;M<c.length;M++){const{key:A,crossTileID:F,tileAnchorX:N,tileAnchorY:z}=c.get(M),H=Math.floor((b+N)*uc),j=Math.floor((x+z)*uc);this.index.add(H,j),this.keys.push(A),this.crossTileIDs.push(F)}this.index.finish()}findMatches(s,c,g){const b=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),x=uc/Math.pow(2,c.canonical.z-this.tileID.canonical.z),M=c.canonical.x*f.ag,A=c.canonical.y*f.ag;for(let F=0;F<s.length;F++){const N=s.get(F);if(N.crossTileID)continue;const{key:z,tileAnchorX:H,tileAnchorY:j}=N,G=Math.floor((M+H)*x),J=Math.floor((A+j)*x),Q=this.index.range(G-b,J-b,G+b,J+b);for(const te of Q){const ne=this.crossTileIDs[te];if(this.keys[te]===z&&!g.has(ne)){g.add(ne),N.crossTileID=ne;break}}}}}class uw{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class yb{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(s){const c=Math.round((s-this.lng)/360);if(0!==c)for(const g in this.indexes){const b=this.indexes[g],x={};for(const M in b){const A=b[M];A.tileID=A.tileID.unwrapTo(A.tileID.wrap+c),x[A.tileID.key]=A}this.indexes[g]=x}this.lng=s}addBucket(s,c,g){if(this.indexes[s.overscaledZ]&&this.indexes[s.overscaledZ][s.key]){if(this.indexes[s.overscaledZ][s.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(s.overscaledZ,this.indexes[s.overscaledZ][s.key])}for(let x=0;x<c.symbolInstances.length;x++)c.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[s.overscaledZ]||(this.usedCrossTileIDs[s.overscaledZ]=new Set);const b=this.usedCrossTileIDs[s.overscaledZ];for(const x in this.indexes){const M=this.indexes[x];if(Number(x)>s.overscaledZ)for(const A in M){const F=M[A];F.tileID.isChildOf(s)&&F.findMatches(c.symbolInstances,s,b)}else{const A=M[s.scaledTo(Number(x)).key];A&&A.findMatches(c.symbolInstances,s,b)}}for(let x=0;x<c.symbolInstances.length;x++){const M=c.symbolInstances.get(x);M.crossTileID||(M.crossTileID=g.generate(),b.add(M.crossTileID))}return void 0===this.indexes[s.overscaledZ]&&(this.indexes[s.overscaledZ]={}),this.indexes[s.overscaledZ][s.key]=new dw(s,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(s,c){for(const g of c.crossTileIDs)this.usedCrossTileIDs[s].delete(g)}removeStaleBuckets(s){let c=!1;for(const g in this.indexes){const b=this.indexes[g];for(const x in b)s[b[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(g,b[x]),delete b[x],c=!0)}return c}}class Ru{constructor(){this.layerIndexes={},this.crossTileIDs=new uw,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(s,c,g,b){let x=this.layerIndexes[s.fqid];void 0===x&&(x=this.layerIndexes[s.fqid]=new yb);let M=!1;const A={};"globe"!==b.name&&x.handleWrapJump(g);for(const F of c){const N=F.getBucket(s);N&&s.fqid===N.layerIds[0]&&(N.bucketInstanceId||(N.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(F.tileID,N,this.crossTileIDs)&&(M=!0),A[N.bucketInstanceId]=!0)}return x.removeStaleBuckets(A)&&(M=!0),M}pruneUnusedLayers(s){const c={};s.forEach(g=>{c[g]=!0});for(const g in this.layerIndexes)c[g]||delete this.layerIndexes[g]}}class An{constructor(s,c,g,b){this.blendFunction=s,this.blendColor=c,this.mask=g,this.blendEquation=b}}An.Replace=[1,0,1,0],An.disabled=new An(An.Replace,f.aj.transparent,[!1,!1,!1,!1]),An.unblended=new An(An.Replace,f.aj.transparent,[!0,!0,!0,!0]),An.alphaBlended=new An([1,771,1,771],f.aj.transparent,[!0,!0,!0,!0]),An.alphaBlendedNonPremultiplied=new An([770,771,770,771],f.aj.transparent,[!0,!0,!0,!0]),An.multiply=new An([774,0,774,0],f.aj.transparent,[!0,!0,!0,!0]);class on{constructor(s,c,g){this.func=s,this.mask=c,this.range=g}}on.ReadOnly=!1,on.ReadWrite=!0,on.disabled=new on(519,on.ReadOnly,[0,1]);class Tn{constructor(s,c,g,b,x,M){this.test=s,this.ref=c,this.mask=g,this.fail=b,this.depthFail=x,this.pass=M}}Tn.disabled=new Tn({func:519,mask:0},0,0,7680,7680,7680);class mn{constructor(s,c,g){this.enable=s,this.mode=c,this.frontFace=g}}function Pu(m,s){const c=f.bG(m,3);f.ab.mat4.fromQuat(m,s),f.bI(m,3,c)}function rg(m,s){const c=f.ab.quat.identity([]);return f.ab.quat.rotateZ(c,c,-s),f.ab.quat.rotateX(c,c,-m),c}function Qh(m,s){const c=[m[0],m[1],0],g=[s[0],s[1],0];if(f.ab.vec3.length(c)>=1e-15){const M=f.ab.vec3.normalize([],c);f.ab.vec3.scale(g,M,f.ab.vec3.dot(g,M)),s[0]=g[0],s[1]=g[1]}const b=f.ab.vec3.cross([],s,m);if(f.ab.vec3.len(b)<1e-15)return null;const x=Math.atan2(-b[1],b[0]);return rg(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),x)}mn.disabled=new mn(!1,1029,2305),mn.backCCW=new mn(!0,1029,2305),mn.backCW=new mn(!0,1029,2304),mn.frontCW=new mn(!0,1028,2304),mn.frontCCW=new mn(!0,1028,2305);class Jh{constructor(s,c){this.position=s,this.orientation=c}get position(){return this._position}set position(s){if(s){const c=s instanceof f.aa?s:new f.aa(s[0],s[1],s[2]);this._renderWorldCopies&&(c.x=f.bF(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(s,c){if(this.orientation=null,!this.position)return;const g=this.position,b=this._elevation?this._elevation.getAtPointOrZero(f.aa.fromLngLat(s)):0,x=f.aa.fromLngLat(s,b),M=[x.x-g.x,x.y-g.y,x.z-g.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Qh(M,c)}setPitchBearing(s,c){this.orientation=rg(f.ai(s),f.ai(-c))}}class fp{constructor(s,c){this._transform=f.ab.mat4.identity([]),this.orientation=c,this.position=s}get mercatorPosition(){const s=this.position;return new f.aa(s[0],s[1],s[2])}get position(){const s=f.bG(this._transform,3);return[s[0],s[1],s[2]]}set position(s){var c;s&&f.bI(this._transform,3,[(c=s)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(s){this._orientation=s||f.ab.quat.identity([]),s&&Pu(this._transform,this._orientation)}getPitchBearing(){const s=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(s[0]*s[0]+s[1]*s[1]),-s[2])}}setPitchBearing(s,c){this._orientation=rg(s,c),Pu(this._transform,this._orientation)}forward(){const s=f.bG(this._transform,2);return[-s[0],-s[1],-s[2]]}up(){const s=f.bG(this._transform,1);return[-s[0],-s[1],-s[2]]}right(){const s=f.bG(this._transform,0);return[s[0],s[1],s[2]]}getCameraToWorld(s,c){const g=new Float64Array(16);return f.ab.mat4.invert(g,this.getWorldToCamera(s,c)),g}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(s,c,g){const b=this.position;f.ab.vec3.scale(b,b,-s);const x=new Float64Array(16);return f.ab.mat4.fromScaling(x,[g,g,g]),f.ab.mat4.translate(x,x,b),x[10]*=c,x}getWorldToCamera(s,c){const g=new Float64Array(16),b=new Float64Array(4),x=this.position;return f.ab.quat.conjugate(b,this._orientation),f.ab.vec3.scale(x,x,-s),f.ab.mat4.fromQuat(g,b),f.ab.mat4.translate(g,g,x),g[1]*=-1,g[5]*=-1,g[9]*=-1,g[13]*=-1,g[8]*=c,g[9]*=c,g[10]*=c,g[11]*=c,g}getCameraToClipPerspective(s,c,g,b){const x=new Float64Array(16);return f.ab.mat4.perspective(x,s,c,g,b),x}getCameraToClipOrthographic(s,c,g,b,x,M){const A=new Float64Array(16);return f.ab.mat4.ortho(A,s,c,g,b,x,M),A}getDistanceToElevation(s,c=!1){const g=0===s?0:f.bH(s,c?f.aS(this.position[1]):this.position[1]),b=this.forward();return(g-this.position[2])/b[2]}clone(){return new fp([...this.position],[...this.orientation])}}const Kr_BaseColor=5,Kr_MetallicRoughness=6,Kr_Normal=7,Kr_Occlusion=8,Kr_Emission=9,Kr_LUT=10,Kr_ShadowMap0=11;class xa{constructor(s=0,c=0,g=0,b=0){if(isNaN(s)||s<0||isNaN(c)||c<0||isNaN(g)||g<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=s,this.bottom=c,this.left=g,this.right=b}interpolate(s,c,g){return null!=c.top&&null!=s.top&&(this.top=f.af(s.top,c.top,g)),null!=c.bottom&&null!=s.bottom&&(this.bottom=f.af(s.bottom,c.bottom,g)),null!=c.left&&null!=s.left&&(this.left=f.af(s.left,c.left,g)),null!=c.right&&null!=s.right&&(this.right=f.af(s.right,c.right,g)),this}getCenter(s,c){const g=f.aw((this.left+s-this.right)/2,0,s),b=f.aw((this.top+c-this.bottom)/2,0,c);return new f.P(g,b)}equals(s){return this.top===s.top&&this.bottom===s.bottom&&this.left===s.left&&this.right===s.right}clone(){return new xa(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const hc=(m,s,c)=>(1-c)*m+c*s,Ot=m=>m*m*m*m*m;class fc{constructor(s,c,g,b,x,M,A){this.tileSize=512,this._renderWorldCopies=void 0===x||x,this._minZoom=s||0,this._maxZoom=c||22,this._minPitch=g??0,this._maxPitch=b??60,this.setProjection(M),this.setMaxBounds(A),this.width=0,this.height=0,this._center=new f.bO(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new xa,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new fp,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const s=new fc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return s._elevation=this._elevation,s._centerAltitude=this._centerAltitude,s._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,s.tileSize=this.tileSize,s.mercatorFromTransition=this.mercatorFromTransition,s.width=this.width,s.height=this.height,s.cameraElevationReference=this.cameraElevationReference,s._center=this._center,s._setZoom(this.zoom),s._seaLevelZoom=this._seaLevelZoom,s.angle=this.angle,s._fov=this._fov,s._pitch=this._pitch,s._nearZ=this._nearZ,s._farZ=this._farZ,s._averageElevation=this._averageElevation,s._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,s._unmodified=this._unmodified,s._edgeInsets=this._edgeInsets.clone(),s._camera=this._camera.clone(),s._calcMatrices(),s.freezeTileCoverage=this.freezeTileCoverage,s.frustumCorners=this.frustumCorners,s}get isOrthographic(){return"globe"!==this.projection.name&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(s){this._elevation!==s&&(this._elevation=s,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return"globe"!==this.projection.name&&!this.isOrthographic}updateElevation(s,c=!1){const g=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||g)&&this._updateCameraOnTerrain(),(s||g)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return f.ay(this.projection,["name","center","parallels"])}setProjection(s){this.projectionOptions=s||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=f.bP(this.projectionOptions);const g=this.getProjection(),b=!f.bn(c,g);return b&&this._calcMatrices(),this.mercatorFromTransition=!1,b}setOrthographicProjectionAtLowPitch(s){return this._orthographicProjectionAtLowPitch!==s&&(this._orthographicProjectionAtLowPitch=s,this._calcMatrices(),!0)}setMercatorFromTransition(){const s=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=f.bP({name:"mercator"});const c=s!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(s){this._minZoom!==s&&(this._minZoom=s,this.zoom=Math.max(this.zoom,s))}get maxZoom(){return this._maxZoom}set maxZoom(s){this._maxZoom!==s&&(this._maxZoom=s,this.zoom=Math.min(this.zoom,s))}get minPitch(){return this._minPitch}set minPitch(s){this._minPitch!==s&&(this._minPitch=s,this.pitch=Math.max(this.pitch,s))}get maxPitch(){return this._maxPitch}set maxPitch(s){this._maxPitch!==s&&(this._maxPitch=s,this.pitch=Math.min(this.pitch,s))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(s){void 0===s?s=!0:null===s&&(s=!1),this._renderWorldCopies=s}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get cameraWorldSize(){const s=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(s))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return f.bH(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new f.P(this.width,this.height)}get bearing(){return f.bF(this.rotation,-180,180)}set bearing(s){this.rotation=s}get rotation(){return-this.angle/Math.PI*180}set rotation(s){const c=-s*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=f.ab.mat2.create(),f.ab.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(s){const c=f.aw(s,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const s=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/s)}set fov(s){s=Math.max(.01,Math.min(60,s)),this._fov!==s&&(this._unmodified=!1,this._fov=f.ai(s),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(s){this._averageElevation=s,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(s){const c=Math.min(Math.max(s,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(s){this._zoom=s,this.scale=this.zoomScale(s),this.tileZoom=Math.floor(s),this.zoomFraction=s-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(s){this._tileCoverLift!==s&&(this._tileCoverLift=s)}_updateCameraOnTerrain(){const s=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,c=this.elevation&&s===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||s===Number.NEGATIVE_INFINITY&&(!c||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const g=this._elevation;c||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&g.exaggeration()&&this._centerAltitudeValidForExaggeration!==g.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*g.exaggeration(),this._centerAltitudeValidForExaggeration=g.exaggeration()):(this._centerAltitude=s||0,this._centerAltitudeValidForExaggeration=g.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const s=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],g=this.horizonLineFromTop();let b=0,x=0;for(let M=0;M<c.length;M++){const A=new f.P(c[M][0]*this.width,g+c[M][1]*(this.height-g)),F=s.pointCoordinate(A);if(!F)continue;const N=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);b+=F[3]*N,x+=N}return 0===x?NaN:b/x}get center(){return this._center}set center(s){s.lat===this._center.lat&&s.lng===this._center.lng||(this._unmodified=!1,this._center=s,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const s=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),g=this.pixelsPerMeter/this.worldSize*c,b=this._mercatorZfromZoom(s),x=this._mercatorZfromZoom(this._maxZoom),M=Math.max(b-g,x);this._setZoom(this._zoomFromMercatorZ(M))}get padding(){return this._edgeInsets.toJSON()}set padding(s){this._edgeInsets.equals(s)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,s,1),this._calcMatrices())}computeZoomRelativeTo(s){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,s.toAltitude()));let g;g=s.z<this._camera.position[2]?[c.x,c.y,c.z]:[s.x,s.y,s.z];const b=f.ab.vec3.length(f.ab.vec3.sub([],this._camera.position,g));return f.aw(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(s){if(!this.height||!s.position&&!s.orientation)return;this._updateCameraState();let c=!1;if(s.orientation&&!f.ab.quat.exactEquals(s.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(s.orientation)),s.position){const g=[s.position.x,s.position.y,s.position.z];f.ab.vec3.exactEquals(g,this._camera.position)||(this._setCameraPosition(g),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const s=this._camera.position,c=new Jh;return c.position=new f.aa(s[0],s[1],s[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(s){if(!f.ab.quat.length(s))return!1;f.ab.quat.normalize(s,s);const c=f.ab.vec3.transformQuat([],[0,0,-1],s),g=f.ab.vec3.transformQuat([],[0,-1,0],s);if(g[2]<0)return!1;const b=Qh(c,g);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(s){const c=this.zoomScale(this.minZoom)*this.tileSize,g=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;s[2]=f.aw(s[2],b/g,b/c),this._camera.position=s}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(s){return this._edgeInsets.equals(s)}interpolatePadding(s,c,g){this._unmodified=!1,this._edgeInsets.interpolate(s,c,g),this._constrain(),this._calcMatrices()}coveringZoomLevel(s){const c=(s.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/s.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(s){const c=[new f.bQ(0,s)];if(this.renderWorldCopies){const g=this.pointCoordinate(new f.P(0,0)),b=this.pointCoordinate(new f.P(this.width,0)),x=this.pointCoordinate(new f.P(this.width,this.height)),M=this.pointCoordinate(new f.P(0,this.height)),A=Math.floor(Math.min(g.x,b.x,x.x,M.x)),F=Math.floor(Math.max(g.x,b.x,x.x,M.x)),N=1;for(let z=A-N;z<=F+N;z++)0!==z&&c.push(new f.bQ(z,s))}return c}isLODDisabled(s){return(!s||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(s,c,g){let b=[];const x=void 0!==g,M=!x;if(M&&this.zoom<c||x&&0===g[0]&&0===g[1])return b;const A=new Set,F=(z,H,j,G,J)=>{const Q=f.c5(H,z,j,G,J);A.has(Q)||(b.push(new f.aG(z,H,j,G,J)),A.add(Q))};for(let z=0;z<s.length;z++){const H=s[z];if(M&&H.canonical.z!==c)continue;const j=H.canonical,G=H.overscaledZ,J=H.wrap,Q=1<<j.z,te=j.x+1<Q,ne=j.x>0,le=j.y+1<Q,me=j.y>0,pe=H.wrap-(ne?0:1),xe=H.wrap+(te?0:1),ve=ne?j.x-1:Q-1,be=te?j.x+1:0;if(x)g[0]<0?(F(G,xe,j.z,be,j.y),g[1]<0&&le&&(F(G,J,j.z,j.x,j.y+1),F(G,xe,j.z,be,j.y+1)),g[1]>0&&me&&(F(G,J,j.z,j.x,j.y-1),F(G,xe,j.z,be,j.y-1))):g[0]>0?(F(G,pe,j.z,ve,j.y),g[1]<0&&le&&(F(G,J,j.z,j.x,j.y+1),F(G,pe,j.z,ve,j.y+1)),g[1]>0&&me&&(F(G,J,j.z,j.x,j.y-1),F(G,pe,j.z,ve,j.y-1))):g[1]<0&&le?F(G,J,j.z,j.x,j.y+1):me&&F(G,J,j.z,j.x,j.y-1);else{const ye=H.visibleQuadrants;1&ye&&(F(G,pe,j.z,ve,j.y),me&&(F(G,J,j.z,j.x,j.y-1),F(G,pe,j.z,ve,j.y-1))),2&ye&&(F(G,xe,j.z,be,j.y),me&&(F(G,J,j.z,j.x,j.y-1),F(G,xe,j.z,be,j.y-1))),4&ye&&(F(G,pe,j.z,ve,j.y),le&&(F(G,J,j.z,j.x,j.y+1),F(G,pe,j.z,ve,j.y+1))),8&ye&&(F(G,xe,j.z,be,j.y),le&&(F(G,J,j.z,j.x,j.y+1),F(G,xe,j.z,be,j.y+1)))}}const N=[];for(const z of b)b.some(H=>z.isChildOf(H))||N.push(z);if(b=N.filter(z=>!s.some(H=>!!(z.overscaledZ<c&&H.isChildOf(z))||z.equals(H)||z.isChildOf(H))),M){const z=1<<c,H="globe"===this.projection.name?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),j=[z*H.x,z*H.y],G=4,J=G*G;b=b.filter(Q=>{const te=Q.canonical.x+.5-j[0],ne=Q.canonical.y+.5-j[1];return te*te+ne*ne<J})}return b}coveringTiles(s){let c=this.coveringZoomLevel(s);const g=c,b=this.elevation&&this.elevation.exaggeration(),x=b&&!s.isTerrainDEM,M="mercator"===this.projection.name;if(void 0!==s.minzoom&&c<s.minzoom)return[];void 0!==s.maxzoom&&c>s.maxzoom&&(c=s.maxzoom);const A=this.locationCoordinate(this.center),F=this.center.lat,N=1<<c,z=[N*A.x,N*A.y,0],H="globe"===this.projection.name,j=!H,G=f.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,j),J=H?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Q=N*f.bH(1,this.center.lat),te=this._camera.position[2]/f.bH(1,this.center.lat),ne=[N*J.x,N*J.y,te*(j?1:Q)],le=H||b,me=this.cameraToCenterDistance/s.tileSize*(s.roundZoom?1:.502),pe=this.isLODDisabled(!0)?c:0;let xe;if(this._elevation&&s.isTerrainDEM)xe=1e4*this._elevation.exaggeration();else if(this._elevation){const He=this._elevation.getMinMaxForVisibleTiles();xe=He?He.max:this._centerAltitude}else xe=this._centerAltitude;const ve=s.isTerrainDEM?-xe:this._elevation?this._elevation.getMinElevationBelowMSL():0,be=this.projection.isReprojectedInTileSpace?f.bS(this):1,ye=He=>{const Ke=new f.aa(He.x+25e-6,He.y,He.z),bt=new f.aa(He.x,He.y+25e-6,He.z),ht=He.toLngLat(),st=Ke.toLngLat(),Pt=bt.toLngLat(),Vt=this.locationCoordinate(ht),kt=this.locationCoordinate(st),Gt=this.locationCoordinate(Pt),hn=Math.hypot(kt.x-Vt.x,kt.y-Vt.y),ln=Math.hypot(Gt.x-Vt.x,Gt.y-Vt.y);return Math.sqrt(hn*ln)*be/25e-6},Ee=He=>{const dt=xe,Ke=ve;return{aabb:f.bV(this,N,0,0,0,He,Ke,dt,this.projection),zoom:0,x:0,y:0,minZ:Ke,maxZ:dt,wrap:He,fullyVisible:!1}},Re=[];let Xe=[];const qe=c,Ae=s.reparseOverscaled?g:c,Be=(te-this._centerAltitude)*Q,Ye=He=>{if(!this._elevation||!He.tileID||!M)return;const dt=this._elevation.getMinMaxForTile(He.tileID),Ke=He.aabb;dt?(Ke.min[2]=dt.min,Ke.max[2]=dt.max,Ke.center[2]=(Ke.min[2]+Ke.max[2])/2):(He.shouldSplit=Ct(He),He.shouldSplit||(Ke.min[2]=Ke.max[2]=Ke.center[2]=this._centerAltitude))},pt=(He,dt)=>{if(.707*dt<He)return 1;const Ke=dt/He;return Ke/(1.4144271570014144+(Math.pow(1.1,Ke-1.4144271570014144+1)-1)/(1.1-1)-1)},Ct=He=>{if(He.zoom<pe)return!0;if(He.zoom===qe)return!1;if(null!=He.shouldSplit)return He.shouldSplit;const dt=He.aabb.distanceX(ne),Ke=He.aabb.distanceY(ne);let bt=Be,ht=1;if(H){bt=He.aabb.distanceZ(ne);const ln=Math.pow(2,He.zoom),sn=f.aS((He.y+1)/ln),Dt=f.aS(He.y/ln),si=Math.min(Math.max(F,sn),Dt),jn=f.c9(si)/f.c9(F);if(ht=si===F?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,jn/this._mercatorScaleRatio),this.zoom<=f.c6&&He.zoom===qe-1&&jn>=.9)return!0}else if(x&&(bt=He.aabb.distanceZ(ne)*Q),this.projection.isReprojectedInTileSpace&&g<=5){const ln=Math.pow(2,He.zoom),sn=ye(new f.aa((He.x+.5)/ln,(He.y+.5)/ln));ht=sn>.85?1:sn}if(!M){const ln=Math.sqrt(dt*dt+Ke*Ke+bt*bt);let sn=(1<<qe-He.zoom)*me*ht;return sn*=pt(Math.max(bt,Be),ln),ln<sn}let st=Number.MAX_VALUE,Pt=0;const Vt=He.aabb.getCorners(),kt=[];for(const ln of Vt){f.ab.vec3.sub(kt,ln,ne),H||(x?kt[2]*=Q:kt[2]=Be);const sn=f.ab.vec3.dot(kt,this._camera.forward());sn<st&&(st=sn,Pt=Math.abs(kt[2]))}let Gt=(1<<qe-He.zoom)*me*ht;if(Gt*=pt(Math.max(Pt,Be),st),st<Gt)return!0;const hn=He.aabb.closestPoint(z);return hn[0]===z[0]&&hn[1]===z[1]};if(this.renderWorldCopies)for(let He=1;He<=3;He++)Re.push(Ee(-He)),Re.push(Ee(He));for(Re.push(Ee(0));Re.length>0;){const He=Re.pop(),dt=He.x,Ke=He.y;let bt=He.fullyVisible;const ht=()=>"globe"===this.projection.name&&(0===He.y||He.y===(1<<He.zoom)-1);if(!bt){let st=le?He.aabb.intersects(G):He.aabb.intersectsFlat(G);if(0===st&&ht()){const Pt=new f.bT(He.zoom,dt,Ke);st=f.bU(this,N,Pt,!0).intersects(G)}if(0===st)continue;bt=2===st}if(He.zoom!==qe&&Ct(He))for(let st=0;st<4;st++){const Pt=(dt<<1)+st%2,Vt=(Ke<<1)+(st>>1),kt={aabb:M?He.aabb.quadrant(st):f.bV(this,N,He.zoom+1,Pt,Vt,He.wrap,He.minZ,He.maxZ,this.projection),zoom:He.zoom+1,x:Pt,y:Vt,wrap:He.wrap,fullyVisible:bt,tileID:void 0,shouldSplit:void 0,minZ:He.minZ,maxZ:He.maxZ};x&&!H&&(kt.tileID=new f.aG(He.zoom+1===qe?Ae:He.zoom+1,He.wrap,He.zoom+1,Pt,Vt),Ye(kt)),Re.push(kt)}else{const st=He.zoom===qe?Ae:He.zoom;if(s.minzoom&&s.minzoom>st)continue;let Pt=0;if(!bt){let hn=le?He.aabb.intersectsPrecise(G):He.aabb.intersectsPreciseFlat(G);if(0===hn&&ht()){const ln=new f.bT(He.zoom,dt,Ke);hn=f.bU(this,N,ln,!0).intersectsPrecise(G)}if(0===hn)continue;if(s.calculateQuadrantVisibility)if(G.containsPoint(He.aabb.center))Pt=15;else for(let ln=0;ln<4;ln++)0!==He.aabb.quadrant(ln).intersects(G)&&(Pt|=1<<ln)}const Vt=z[0]-(.5+dt+(He.wrap<<He.zoom))*(1<<c-He.zoom),kt=z[1]-.5-Ke,Gt=He.tileID?He.tileID:new f.aG(st,He.wrap,He.zoom,dt,Ke);s.calculateQuadrantVisibility&&(Gt.visibleQuadrants=Pt),Xe.push({tileID:Gt,distanceSq:Vt*Vt+kt*kt})}}if(this.fogCullDistSq){const He=this.fogCullDistSq,dt=this.horizonLineFromTop();Xe=Xe.filter(Ke=>{const bt=[0,0,0,1],ht=[f.ag,f.ag,0,1],st=this.calculateFogTileMatrix(Ke.tileID.toUnwrapped());f.ab.vec4.transformMat4(bt,bt,st),f.ab.vec4.transformMat4(ht,ht,st);const Pt=f.ab.vec4.min([],bt,ht),Vt=f.ab.vec4.max([],bt,ht),kt=f.bW(Pt,Vt);if(0===kt)return!0;let Gt=!1;const hn=this._elevation;if(hn&&kt>He&&0!==dt){const ln=this.calculateProjMatrix(Ke.tileID.toUnwrapped());let sn;s.isTerrainDEM||(sn=hn.getMinMaxForTile(Ke.tileID)),sn||(sn={min:ve,max:xe});const Dt=f.c7(this.rotation),si=[Dt[0]*f.ag,Dt[1]*f.ag,sn.max];f.ab.vec3.transformMat4(si,si,ln),Gt=(1-si[1])*this.height*.5<dt}return kt<He||Gt})}return Xe.sort((He,dt)=>He.distanceSq-dt.distanceSq).map(He=>He.tileID)}resize(s,c){this.width=s,this.height=c,this.pixelsToGLUnits=[2/s,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(s){return Math.pow(2,s)}scaleZoom(s){return Math.log(s)/Math.LN2}project(s){const c=f.aw(s.lat,-f.bX,f.bX),g=this.projection.project(s.lng,c);return new f.P(g.x*this.worldSize,g.y*this.worldSize)}unproject(s){return this.projection.unproject(s.x/this.worldSize,s.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/f.bH(1,this.center.lat)/this.worldSize}setLocationAtPoint(s,c){let g,b;const x=this.centerPoint;if("globe"===this.projection.name){const A=this.worldSize;g=(c.x-x.x)/A,b=(c.y-x.y)/A}else{const A=this.pointCoordinate(c),F=this.pointCoordinate(x);g=A.x-F.x,b=A.y-F.y}const M=this.locationCoordinate(s);this.setLocation(new f.aa(M.x-g,M.y-b))}setLocation(s){this.center=this.coordinateLocation(s),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(s){return this.projection.locationPoint(this,s)}locationPoint3D(s){return this.projection.locationPoint(this,s,!0)}pointLocation(s){return this.coordinateLocation(this.pointCoordinate(s))}pointLocation3D(s){return this.coordinateLocation(this.pointCoordinate3D(s))}locationCoordinate(s,c){const g=c?f.bH(c,s.lat):void 0,b=this.projection.project(s.lng,s.lat);return new f.aa(b.x,b.y,g)}coordinateLocation(s){return this.projection.unproject(s.x,s.y)}pointRayIntersection(s,c){const g=c??this._centerAltitude,b=[s.x,s.y,0,1],x=[s.x,s.y,1,1];f.ab.vec4.transformMat4(b,b,this.pixelMatrixInverse),f.ab.vec4.transformMat4(x,x,this.pixelMatrixInverse);const M=x[3];f.ab.vec4.scale(b,b,1/b[3]),f.ab.vec4.scale(x,x,1/M);const A=b[2],F=x[2];return{p0:b,p1:x,t:A===F?0:(g-A)/(F-A)}}screenPointToMercatorRay(s){const c=[s.x,s.y,0,1],g=[s.x,s.y,1,1];return f.ab.vec4.transformMat4(c,c,this.pixelMatrixInverse),f.ab.vec4.transformMat4(g,g,this.pixelMatrixInverse),f.ab.vec4.scale(c,c,1/c[3]),f.ab.vec4.scale(g,g,1/g[3]),c[2]=f.bH(c[2],this._center.lat)*this.worldSize,g[2]=f.bH(g[2],this._center.lat)*this.worldSize,f.ab.vec4.scale(c,c,1/this.worldSize),f.ab.vec4.scale(g,g,1/this.worldSize),new f.aq([c[0],c[1],c[2]],f.ab.vec3.normalize([],f.ab.vec3.sub([],g,c)))}rayIntersectionCoordinate(s){const{p0:c,p1:g,t:b}=s,x=f.bH(c[2],this._center.lat),M=f.bH(g[2],this._center.lat);return new f.aa(f.af(c[0],g[0],b)/this.worldSize,f.af(c[1],g[1],b)/this.worldSize,f.af(x,M,b))}pointCoordinate(s,c=this._centerAltitude){return this.projection.pointCoordinate(this,s.x,s.y,c)}pointCoordinate3D(s){if(!this.elevation)return this.pointCoordinate(s);let c=this.projection.pointCoordinate3D(this,s.x,s.y);if(c)return new f.aa(c[0],c[1],c[2]);let g=0,b=this.horizonLineFromTop();if(s.y>b)return this.pointCoordinate(s);const x=.02*b,M=s.clone();for(let A=0;A<10&&b-g>x;A++){M.y=f.af(g,b,.66);const F=this.projection.pointCoordinate3D(this,M.x,M.y);F?(b=M.y,c=F):g=M.y}return c?new f.aa(c[0],c[1],c[2]):this.pointCoordinate(s)}isPointAboveHorizon(s){return this.projection.isPointAboveHorizon(this,s)}isPointOnSurface(s){if(s.y<0||s.y>this.height||s.x<0||s.x>this.width)return!1;if(this.elevation||this.zoom>=f.bY)return!this.isPointAboveHorizon(s);const c=this.pointCoordinate(s);return c.y>=0&&c.y<=1}_coordinatePoint(s,c){const g=c&&this.elevation?this.elevation.getAtPointOrZero(s,this._centerAltitude):this._centerAltitude,b=[s.x*this.worldSize,s.y*this.worldSize,g+s.toAltitude(),1];return f.ab.vec4.transformMat4(b,b,this.pixelMatrix),b[3]>0?new f.P(b[0]/b[3],b[1]/b[3]):new f.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:s,left:c}=this._edgeInsets,g=this.height-this._edgeInsets.bottom,b=this.width-this._edgeInsets.right,x=this.pointLocation3D(new f.P(c,s)),M=this.pointLocation3D(new f.P(b,s)),A=this.pointLocation3D(new f.P(b,g)),F=this.pointLocation3D(new f.P(c,g));let N=Math.min(x.lng,M.lng,A.lng,F.lng),z=Math.max(x.lng,M.lng,A.lng,F.lng),H=Math.min(x.lat,M.lat,A.lat,F.lat),j=Math.max(x.lat,M.lat,A.lat,F.lat);const G=Math.pow(2,-this.zoom)/16*270,J="globe"===this.projection.name?1:4,Q=(te,ne,le,me,pe)=>{const xe=(te+le)/2,ve=(ne+me)/2,be=new f.P(xe,ve),{lng:ye,lat:Ee}=this.pointLocation3D(be),Re=Math.max(0,N-ye,H-Ee,ye-z,Ee-j);N=Math.min(N,ye),z=Math.max(z,ye),H=Math.min(H,Ee),j=Math.max(j,Ee),(pe<J||Re>G)&&(Q(te,ne,xe,ve,pe+1),Q(xe,ve,le,me,pe+1))};if(Q(c,s,b,s,1),Q(b,s,b,g,1),Q(b,g,c,g,1),Q(c,g,c,s,1),"globe"===this.projection.name){const[te,ne]=f.bZ(this);te?(j=90,z=180,N=-180):ne&&(H=-90,z=180,N=-180)}return new f.az(new f.bO(N,H),new f.bO(z,j))}_getBoundsRectangular(s,c){const{top:g,left:b}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,M=this.width-this._edgeInsets.right,A=new f.P(b,g),F=new f.P(M,g),N=new f.P(M,x),z=new f.P(b,x);let H=this.pointCoordinate(A,s),j=this.pointCoordinate(F,s);const G=this.pointCoordinate(N,c),J=this.pointCoordinate(z,c),Q=(te,ne)=>(ne.y-te.y)/(ne.x-te.x);return H.y>1&&j.y>=0?H=new f.aa((1-J.y)/Q(J,H)+J.x,1):H.y<0&&j.y<=1&&(H=new f.aa(-J.y/Q(J,H)+J.x,0)),j.y>1&&H.y>=0?j=new f.aa((1-G.y)/Q(G,j)+G.x,1):j.y<0&&H.y<=1&&(j=new f.aa(-G.y/Q(G,j)+G.x,0)),(new f.az).extend(this.coordinateLocation(H)).extend(this.coordinateLocation(j)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(G))}_getBoundsRectangularTerrain(){const s=this.elevation;if(!s.visibleDemTiles.length||s.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=s.visibleDemTiles.reduce((g,b)=>{if(b.dem){const x=b.dem.tree;g.min=Math.min(g.min,x.minimums[0]),g.max=Math.max(g.max,x.maximums[0])}return g},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*s.exaggeration(),c.max*s.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(s=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,g=this.height/2-c*(1-this._horizonShift);return s?Math.max(0,g):g}getMaxBounds(){return this.maxBounds}setMaxBounds(s){this.maxBounds=s,this.minLat=-f.bX,this.maxLat=f.bX,this.minLng=-180,this.maxLng=180,s&&(this.minLat=s.getSouth(),this.maxLat=s.getNorth(),this.minLng=s.getWest(),this.maxLng=s.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=f.at(this.minLng)*this.tileSize,this.worldMaxX=f.at(this.maxLng)*this.tileSize,this.worldMinY=f.aA(this.maxLat)*this.tileSize,this.worldMaxY=f.aA(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(s,c){return this.projection.createTileMatrix(this,c,s)}calculateDistanceTileData(s){const c=s.key,g=this._distanceTileDataCache;if(g[c])return g[c];const b=s.canonical,x=1/this.height,M=this.cameraWorldSize,A=M/this.zoomScale(b.z),F=(b.x+Math.pow(2,b.z)*s.wrap)*A,N=b.y*A,z=this.point;z.x*=M/this.worldSize,z.y*=M/this.worldSize;const H=this.angle,j=Math.sin(-H),G=-Math.cos(-H);return g[c]={bearing:[j,G],center:[(z.x-F)*x,(z.y-N)*x],scale:A/f.ag*x},g[c]}calculateFogTileMatrix(s){const c=s.key,g=this._fogTileMatrixCache;if(g[c])return g[c];const b=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,s);return f.ab.mat4.multiply(b,this.worldToFogMatrix,b),g[c]=new Float32Array(b),g[c]}calculateProjMatrix(s,c=!1,g=!1){const b=s.key;let x;if(x=g?this._expandedProjMatrixCache:c?this._alignedProjMatrixCache:this._projMatrixCache,x[b])return x[b];const M=this.calculatePosMatrix(s,this.worldSize);let A;return A=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:g?this.expandedFarZProjMatrix:c?this.alignedProjMatrix:this.projMatrix,f.ab.mat4.multiply(M,A,M),x[b]=new Float32Array(M),x[b]}calculatePixelsToTileUnitsMatrix(s){const c=s.tileID.key,g=this._pixelsToTileUnitsCache;if(g[c])return g[c];const b=f.b_(s,this);return g[c]=b,g[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const s=1/this.worldSize,c=f.ab.mat4.fromScaling([],[s,s,s]);return f.ab.mat4.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const s=this._elevation;this._updateCameraState();const c=f.bH(1,this._center.lat)*this.worldSize,g=this._computeCameraPosition(c),b=this._camera.forward(),x=f.bH(1,this._center.lat);g[2]/=x,b[2]/=x,f.ab.vec3.normalize(b,b);const M=s.raycast(g,b,s.exaggeration());if(M){const A=f.ab.vec3.scaleAndAdd([],g,b,M),F=new f.aa(A[0],A[1],f.bH(A[2],f.aS(A[1]))),N=(F.z+f.ab.vec3.length([F.x-g[0],F.y-g[1],F.z-g[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(N),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(s=!1){if(!this._elevation)return;const c=this._elevation,g=f.bH(1,this._center.lat)*this.worldSize,b=this._computeCameraPosition(g),x=c.getAtPointOrZero(new f.aa(...b)),M=this.pixelsPerMeter/this.worldSize*x,A=this._minimumHeightOverTerrain(),F=b[2]-M;if(F<=A)if(F<0||s){const N=this.locationCoordinate(this._center,this._centerAltitude),z=[b[0],b[1],N.z-b[2]],H=f.ab.vec3.length(z);z[2]-=(A-F)/this._pixelsPerMercatorPixel;const j=f.ab.vec3.length(z);if(0===j)return;f.ab.vec3.scale(z,z,H/j*this._pixelsPerMercatorPixel),this._camera.position=[b[0],b[1],N.z*this._pixelsPerMercatorPixel-z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const s="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||s){const j=this.center;return j.lat=f.aw(j.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!s)&&(j.lng=f.aw(j.lng,this.minLng,this.maxLng)),this.center=j,void(this._constraining=!1)}const c=this._unmodified,{x:g,y:b}=this.point;let x=0,M=g,A=b;const F=this.width/2,N=this.height/2,z=this.worldMinY*this.scale,H=this.worldMaxY*this.scale;if(b-N<z&&(A=z+N),b+N>H&&(A=H-N),H-z<this.height&&(x=Math.max(x,this.height/(H-z)),A=(H+z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const j=this.worldMinX*this.scale,G=this.worldMaxX*this.scale,J=this.worldSize/2-(j+G)/2;M=(g+J+this.worldSize)%this.worldSize-J,M-F<j&&(M=j+F),M+F>G&&(M=G-F),G-j<this.width&&(x=Math.max(x,this.width/(G-j)),M=(G+j)/2)}M===g&&A===b||(this.center=this.unproject(new f.P(M,A))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let s=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(s=Math.max(s,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),s}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const s=this.centerOffset,c="globe"===this.projection.name,g=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=f.bH(1,this.center.lat)/f.bH(1,f.c8));const b=f.b$(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,b),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x="meters"===this.projection.zAxisUnit?g:1,M=this._camera.getWorldToCamera(this.worldSize,x);let A;const F=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(F[8]=2*-s.x/this.width,F[9]=2*s.y/this.height,this.isOrthographic){let Ee=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Re=Ee*this.aspect,Xe=-Re,qe=-Ee;Re-=s.x,Xe-=s.x,Ee+=s.y,qe+=s.y,A=this._camera.getCameraToClipOrthographic(Xe,Re,qe,Ee,this._nearZ,this._farZ),((Ae,Be,Ye,pt)=>{for(let Ct=0;Ct<16;Ct++)Ae[Ct]=hc(Be[Ct],Ye[Ct],pt)})(A,A,F,Ot(this.pitch>=15?1:this.pitch/15))}else A=F;const N=f.ab.mat4.mul([],F,M);let z=f.ab.mat4.mul([],A,M);if(this.projection.isReprojectedInTileSpace){const Ee=this.locationCoordinate(this.center),Re=f.ab.mat4.identity([]);f.ab.mat4.translate(Re,Re,[Ee.x*this.worldSize,Ee.y*this.worldSize,0]),f.ab.mat4.multiply(Re,Re,f.c0(this)),f.ab.mat4.translate(Re,Re,[-Ee.x*this.worldSize,-Ee.y*this.worldSize,0]),f.ab.mat4.multiply(z,z,Re),f.ab.mat4.multiply(N,N,Re),this.inverseAdjustmentMatrix=f.c1(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=f.ab.mat4.scale([],z,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=z,this.invProjMatrix=f.ab.mat4.invert(new Float64Array(16),this.projMatrix),c){const Ee=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);Ee[8]=2*-s.x/this.width,Ee[9]=2*s.y/this.height,this.expandedFarZProjMatrix=f.ab.mat4.mul([],Ee,M)}else this.expandedFarZProjMatrix=this.projMatrix;const H=f.ab.mat4.invert([],A);this.frustumCorners=f.c2.fromInvProjectionMatrix(H,this.horizonLineFromTop(),this.height),this.cameraFrustum=f.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!c);const j=new Float32Array(16);f.ab.mat4.identity(j),f.ab.mat4.scale(j,j,[1,-1,1]),f.ab.mat4.rotateX(j,j,this._pitch),f.ab.mat4.rotateZ(j,j,this.angle);const G=f.ab.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=f.ab.mat4.clone(G);const J=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;G[8]=2*-s.x/this.width,G[9]=2*(s.y+J)/this.height,this.skyboxMatrix=f.ab.mat4.multiply(j,G,j);const Q=this.point,te=Q.x,ne=Q.y,le=this.width%2/2,me=this.height%2/2,pe=Math.cos(this.angle),xe=Math.sin(this.angle),ve=te-Math.round(te)+pe*le+xe*me,be=ne-Math.round(ne)+pe*me+xe*le,ye=new Float64Array(z);if(f.ab.mat4.translate(ye,ye,[ve>.5?ve-1:ve,be>.5?be-1:be,0]),this.alignedProjMatrix=ye,z=f.ab.mat4.create(),f.ab.mat4.scale(z,z,[this.width/2,-this.height/2,1]),f.ab.mat4.translate(z,z,[1,-1,0]),this.labelPlaneMatrix=z,z=f.ab.mat4.create(),f.ab.mat4.scale(z,z,[1,-1,1]),f.ab.mat4.translate(z,z,[-1,-1,0]),f.ab.mat4.scale(z,z,[2/this.width,2/this.height,1]),this.glCoordMatrix=z,this.pixelMatrix=f.ab.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,N),this._calcFogMatrices(),this._distanceTileDataCache={},z=f.ab.mat4.invert(new Float64Array(16),this.pixelMatrix),!z)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=z,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=f.c3(this);const Ee=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=f.ab.vec3.transformMat4(Ee,Ee,M),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=z;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const s=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,g=this._camera.position,b=1/this.height/this._pixelsPerMercatorPixel,x=[s,s,c];f.ab.vec3.scale(x,x,b),f.ab.vec3.scale(g,g,-1),f.ab.vec3.multiply(g,g,x);const M=f.ab.mat4.create();f.ab.mat4.translate(M,M,g),f.ab.mat4.scale(M,M,x),this.mercatorFogMatrix=M,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(s,c,b)}_computeCameraPosition(s){const c=(s=s||this.pixelsPerMeter)/this.pixelsPerMeter,g=this._camera.forward(),b=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-s/this.worldSize*this._centerAltitude;return[b.x/this.worldSize-g[0]*x,b.y/this.worldSize-g[1]*x,s/this.worldSize*this._centerAltitude-g[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(s){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),g=this._camera.position[2],b=s[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),b>0&&(x=Math.min((c-g)/b,1)),this._camera.position=f.ab.vec3.scaleAndAdd([],this._camera.position,s,x),this._updateStateFromCamera()}_updateStateFromCamera(){const s=this._camera.position,c=this._camera.forward(),{pitch:g,bearing:b}=this._camera.getPitchBearing(),x=f.bH(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,M=this._mercatorZfromZoom(this._maxZoom)*Math.cos(f.ai(this._maxPitch)),A=Math.max((s[2]-x)/Math.cos(g),M),F=this._zoomFromMercatorZ(A);f.ab.vec3.scaleAndAdd(s,s,c,A),this._pitch=f.aw(g,f.ai(this.minPitch),f.ai(this.maxPitch)),this.angle=f.bF(b,-Math.PI,Math.PI),this._setZoom(f.aw(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new f.aa(s[0],s[1],s[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(s){return Math.pow(2,s)*this.tileSize}_mercatorZfromZoom(s){return this.cameraToCenterDistance/this._worldSizeFromZoom(s)}_minimumHeightOverTerrain(){const s=Math.min(null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(s)}_zoomFromMercatorZ(s){return this.scaleZoom(this.cameraToCenterDistance/(s*this.tileSize))}zoomFromMercatorZAdjusted(s){let c=0,g=f.bY,b=0,x=1/0;for(;g-c>1e-6&&g>c;){const M=c+.5*(g-c),A=this.tileSize*Math.pow(2,M),F=this.getCameraToCenterDistance(this.projection,M,A),N=this.scaleZoom(F/(s*this.tileSize)),z=Math.abs(M-N);z<x&&(x=z,b=M),M<N?c=M:g=M}return b}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(f.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(s,c){const g=Math.min(s.x,c.x),b=Math.max(s.x,c.x),x=Math.min(s.y,c.y),M=Math.max(s.y,c.y);if(x<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const A=[new f.P(g,x),new f.P(b,M),new f.P(g,M),new f.P(b,x)],F=this.renderWorldCopies?-3:0,N=this.renderWorldCopies?4:1;for(const z of A){const H=this.pointRayIntersection(z);if(H.t<0)return!0;const j=this.rayIntersectionCoordinate(H);if(j.x<F||j.y<0||j.x>N||j.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+f.c4(this.fovAboveCenter)>88||this.anyCornerOffEdge(new f.P(0,0),new f.P(this.width,this.height))}zoomDeltaToMovement(s,c){const g=f.ab.vec3.length(f.ab.vec3.sub([],this._camera.position,s)),b=this._zoomFromMercatorZ(g)+c;return g-this._mercatorZfromZoom(b)}getCameraPoint(){if("globe"===this.projection.name){const s=function([c,g,b],x){const M=[c,g,b,1];f.ab.vec4.transformMat4(M,M,x);const A=M[3]=Math.max(M[3],1e-6);return M[0]/=A,M[1]/=A,M[2]/=A,M}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new f.P(s[0],s[1])}{const s=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.P(0,s))}}getCameraToCenterDistance(s,c=this.zoom,g=this.worldSize){const b=f.b$(s,c,this.width,this.height,1024),x=s.pixelSpaceConversion(this.center.lat,g,b);let M=.5/Math.tan(.5*this._fov)*this.height*x;return this.isOrthographic&&(M=hc(1,M,Ot(this.pitch>=15?1:this.pitch/15))),M}getWorldToCameraMatrix(){const s=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&f.ab.mat4.multiply(s,s,this.globeMatrix),s}getFrustum(s){return f.bR.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,"meters"===this.projection.zAxisUnit)}}const Gc=(m,s)=>{if(s>0&&m.terrain&&f.w("Cutoff is currently disabled on terrain"),s<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const c=m.transform,g=Math.max(Math.abs(c._zoom-(m.minCutoffZoom-1)),1),b=c.isLODDisabled(!1)?f.ac(60,45,c.pitch):f.ac(30,15,c.pitch),x=c._farZ-c._nearZ,M=s*c.height,A=((1-(F=b))*c.cameraToCenterDistance+F*(c._farZ+M))*g;var F;return{shouldRenderCutoff:b<1,uniformValues:{u_cutoff_params:[c._nearZ,c._farZ,(A-c._nearZ)/x,(A-M-c._nearZ)/x]}}},Cr={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class Ou{constructor(s,c){this.aabb=s,this.lastCascade=c}}class pp{add(s,c){const g=this.receivers[s.key];void 0!==g?(g.aabb.min[0]=Math.min(g.aabb.min[0],c.min[0]),g.aabb.min[1]=Math.min(g.aabb.min[1],c.min[1]),g.aabb.min[2]=Math.min(g.aabb.min[2],c.min[2]),g.aabb.max[0]=Math.max(g.aabb.max[0],c.max[0]),g.aabb.max[1]=Math.max(g.aabb.max[1],c.max[1]),g.aabb.max[2]=Math.max(g.aabb.max[2],c.max[2])):this.receivers[s.key]=new Ou(c,null)}clear(){this.receivers={}}get(s){return this.receivers[s.key]}computeRequiredCascades(s,c,g){const b=f.cd.fromPoints(s.points);let x=0;for(const M in this.receivers){const A=this.receivers[M];if(!A||!b.intersectsAabb(A.aabb))continue;A.aabb.min=b.closestPoint(A.aabb.min),A.aabb.max=b.closestPoint(A.aabb.max);const F=A.aabb.getCorners();for(let N=0;N<g.length;N++){let z=!0;for(const H of F){const j=[H[0]*c,H[1]*c,H[2]];if(f.ab.vec3.transformMat4(j,j,g[N].matrix),j[0]<-1||j[0]>1||j[1]<-1||j[1]>1){z=!1;break}}if(A.lastCascade=N,x=Math.max(x,N),z)break}}return x+1}}class cl{constructor(s){this.painter=s,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new pp,this._depthMode=new on(s.context.gl.LEQUAL,on.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,s.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),s.tp.registerParameter(Cr,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),s.tp.registerParameter(Cr,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),s.tp.registerParameter(Cr,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),s.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const s of this._cascades)s.texture.destroy(),s.framebuffer.destroy();this._cascades=[]}updateShadowParameters(s,c){const g=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!c||!c.properties)return;const b=c.properties.get("shadow-intensity");if(!c.shadowsEnabled()||b<=0||(this._shadowLayerCount=g.style.order.reduce((J,Q)=>{const te=g.style._mergedLayers[Q];return J+(te.hasShadowPass()&&!te.isHidden(s.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const x=g.context,M=Cr.shadowMapResolution,A=Cr.shadowMapResolution;if(0===this._cascades.length||Cr.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let J=0;J<Cr.cascadeCount;++J){const Q=g._shadowMapDebug,te=x.gl,ne=x.createFramebuffer(M,A,Q,"texture"),le=new f.T(x,{width:M,height:A,data:null},te.DEPTH_COMPONENT16);if(ne.depthAttachment.set(le.texture),Q){const me=new f.T(x,{width:M,height:A,data:null},te.RGBA8);ne.colorAttachment.set(me.texture)}this._cascades.push({framebuffer:ne,texture:le,matrix:[],far:0,boundingSphereRadius:0,frustum:new f.bR,scale:0})}}this.shadowDirection=pc(c);let F=0;if(s.elevation){const J=s.elevation,Q=[1e4,-1e4];J.visibleDemTiles.filter(te=>te.dem).forEach(te=>{const ne=te.dem.tree;Q[0]=Math.min(Q[0],ne.minimums[0]),Q[1]=Math.max(Q[1],ne.maximums[0])}),1e4!==Q[0]&&(F=(Q[1]-Q[0])*J.exaggeration())}const N=1.5*s.cameraToCenterDistance,z=3*N,H=new Float64Array(16);for(let J=0;J<this._cascades.length;++J){const Q=this._cascades[J];let te=s.height/50,ne=1;1===Cr.cascadeCount?ne=z:0===J?ne=N:(te=N,ne=z);const[le,me]=Fu(s,this.shadowDirection,te,ne,Cr.shadowMapResolution,F);Q.scale=s.scale,Q.matrix=le,Q.boundingSphereRadius=me,f.ab.mat4.invert(H,Q.matrix),Q.frustum=f.bR.fromInvProjectionMatrix(H,1,0,!0),Q.far=ne}const j=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[j].far,this._cascades[j].far],this._uniformValues.u_shadow_intensity=b,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Cr.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Cr.shadowMapResolution,this._uniformValues.u_shadowmap_0=Kr_ShadowMap0,this._uniformValues.u_shadowmap_1=Kr_ShadowMap0+1,this._groundShadowTiles=g.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const G=g.transform.elevation;for(const J of this._groundShadowTiles){let Q={min:0,max:0};if(G){const te=G.getMinMaxForTile(J);te&&(Q=te)}this.addShadowReceiver(J.toUnwrapped(),Q.min,Q.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(s){this._enabled=s}drawShadowPass(s,c){if(!this.enabled)return;const g=this.painter,b=g.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(g.transform.getFrustum(0),g.transform.worldSize,this._cascades),b.viewport.set([0,0,Cr.shadowMapResolution,Cr.shadowMapResolution]);for(let x=0;x<this._numCascadesToRender;++x){g.currentShadowCascade=x,b.bindFramebuffer.set(this._cascades[x].framebuffer.framebuffer),b.clear({color:f.aj.white,depth:1});for(const M of s.order){const A=s._mergedLayers[M];if(!A.hasShadowPass()||A.isHidden(g.transform.zoom))continue;const F=s.getLayerSourceCache(A),N=F?c[F.id]:void 0;("model"===A.type||N&&N.length)&&g.renderLayer(g,F,A,N)}}g.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const s=this.painter,c=s.style,g=s.context,b=c.directionalLight,x=c.ambientLight;if(!b||!x)return;const M=[],A=Gc(s,s.longestCutoffRange);A.shouldRenderCutoff&&M.push("RENDER_CUTOFF"),M.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&M.push("NORMAL_OFFSET");const F=mp(c,b,x),N=new on(g.gl.LEQUAL,on.ReadOnly,s.depthRangeFor3D);for(const z of this._groundShadowTiles){const H=z.toUnwrapped(),j=s.isTileAffectedByFog(z),G=s.getOrCreateProgram("groundShadow",{defines:M,overrideFog:j});this.setupShadows(H,G),s.uploadCommonUniforms(g,G,H,null,A);const J={u_matrix:s.transform.calculateProjMatrix(H),u_ground_shadow_factor:F};G.draw(s,g.gl.TRIANGLES,N,Tn.disabled,An.multiply,mn.disabled,J,"ground_shadow",s.tileExtentBuffer,s.quadTriangleIndexBuffer,s.tileExtentSegments,{},s.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?An.unblended:An.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(s){const c=this.painter.transform,g=c.calculatePosMatrix(s,c.worldSize);return f.ab.mat4.multiply(g,this._cascades[this.painter.currentShadowCascade].matrix,g),Float32Array.from(g)}calculateShadowPassMatrixFromMatrix(s){return f.ab.mat4.multiply(s,this._cascades[this.painter.currentShadowCascade].matrix,s),Float32Array.from(s)}setupShadows(s,c,g,b=0){if(!this.enabled)return;const x=this.painter.transform,M=this.painter.context,A=M.gl,F=this._uniformValues,N=new Float64Array(16),z=x.calculatePosMatrix(s,x.worldSize);for(let H=0;H<this._cascades.length;H++)f.ab.mat4.multiply(N,this._cascades[H].matrix,z),F[0===H?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(N),M.activeTexture.set(A.TEXTURE0+Kr_ShadowMap0+H),this._cascades[H].texture.bind(A.NEAREST,A.CLAMP_TO_EDGE);if(this.useNormalOffset=!!g,this.useNormalOffset){const H=f.cc(s.canonical),j=2/x.tileSize*f.ag/Cr.shadowMapResolution,G=j*this._cascades[0].boundingSphereRadius,J=j*this._cascades[this._cascades.length-1].boundingSphereRadius,Q=("vector-tile"===g?1:3)/Math.pow(2,b-s.canonical.z-(1-x.zoom+Math.floor(x.zoom)));F.u_shadow_normal_offset=[H,G*Q,J*Q],F.u_shadow_bias=[6e-5,.0012,.012]}else F.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(M,F)}setupShadowsFromMatrix(s,c,g=!1){if(!this.enabled)return;const b=this.painter.context,x=b.gl,M=this._uniformValues,A=new Float64Array(16);for(let F=0;F<Cr.cascadeCount;F++)f.ab.mat4.multiply(A,this._cascades[F].matrix,s),M[0===F?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(A),b.activeTexture.set(x.TEXTURE0+Kr_ShadowMap0+F),this._cascades[F].texture.bind(x.NEAREST,x.CLAMP_TO_EDGE);if(this.useNormalOffset=g,g){const F=Cr.normalOffset;M.u_shadow_normal_offset=[1,F,F],M.u_shadow_bias=[6e-5,.0012,.012]}else M.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(b,M)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(s,c,g,b){if(b[2]>=0)return{};const x=function(F,N,z){const H=z/(1<<F.canonical.z);return new f.cd([F.canonical.x*H+F.wrap*z,F.canonical.y*H+F.wrap*z,0],[(F.canonical.x+1)*H+F.wrap*z,(F.canonical.y+1)*H+F.wrap*z,N])}(s,c,g).getCorners(),M=c/-b[2];b[0]<0?(f.ab.vec3.add(x[0],x[0],[b[0]*M,0,0]),f.ab.vec3.add(x[3],x[3],[b[0]*M,0,0])):b[0]>0&&(f.ab.vec3.add(x[1],x[1],[b[0]*M,0,0]),f.ab.vec3.add(x[2],x[2],[b[0]*M,0,0])),b[1]<0?(f.ab.vec3.add(x[0],x[0],[0,b[1]*M,0]),f.ab.vec3.add(x[1],x[1],[0,b[1]*M,0])):b[1]>0&&(f.ab.vec3.add(x[2],x[2],[0,b[1]*M,0]),f.ab.vec3.add(x[3],x[3],[0,b[1]*M,0]));const A={};return A.vertices=x,A.planes=[qc(x[1],x[0],x[4]),qc(x[2],x[1],x[5]),qc(x[3],x[2],x[6]),qc(x[0],x[3],x[7])],A}addShadowReceiver(s,c,g){this._receivers.add(s,f.cd.fromTileIdAndHeight(s,c,g))}getMaxCascadeForTile(s){const c=this._receivers.get(s);return c&&c.lastCascade?c.lastCascade:0}}function qc(m,s,c){const g=f.ab.vec3.sub([],c,s),b=f.ab.vec3.sub([],m,s),x=f.ab.vec3.cross([],g,b),M=f.ab.vec3.length(x);return 0===M?[0,0,1,0]:(f.ab.vec3.scale(x,x,1/M),[x[0],x[1],x[2],-f.ab.vec3.dot(x,s)])}function pc(m){const s=m.properties.get("direction"),c=f.cb(s.x,s.y,s.z);c[2]=f.aw(c[2],0,75);const g=f.ce([c[0],c[1],c[2]]);return f.ab.vec3.fromValues(g.x,g.y,g.z)}function mp(m,s,c){const g="none"===s.properties.get("color-use-theme"),b=s.properties.get("color"),x=s.properties.get("intensity"),M=s.properties.get("direction"),A=[M.x,M.y,M.z],F="none"===c.properties.get("color-use-theme"),N=c.properties.get("color"),z=c.properties.get("intensity"),H=Math.max(f.ab.vec3.dot([0,0,1],A),0),j=[0,0,0];f.ab.vec3.scale(j,N.toRenderColor(F?null:m.getLut(s.scope)).toArray01Linear().slice(0,3),z);const G=[0,0,0];return f.ab.vec3.scale(G,b.toRenderColor(g?null:m.getLut(c.scope)).toArray01Linear().slice(0,3),H*x),f.cf([j[0]>0?j[0]/(j[0]+G[0]):0,j[1]>0?j[1]/(j[1]+G[1]):0,j[2]>0?j[2]/(j[2]+G[2]):0])}function Fu(m,s,c,g,b,x){const M=m.zoom,A=m.scale,F=m.worldSize,N=1/F,z=m.aspect,H=Math.sqrt(1+z*z)*Math.tan(.5*m.fovX),j=H*H,G=g-c,J=g+c;let Q,te;j>G/J?(Q=g,te=g*H):(Q=.5*J*(1+j),te=.5*Math.sqrt(G*G+2*(g*g+c*c)*j+J*J*j*j));const ne=m.projection.pixelsPerMeter(m.center.lat,F),le=m._camera.getCameraToWorldMercator(),me=[0,0,-Q*N];f.ab.vec3.transformMat4(me,me,le);let pe=te*N;const xe=m._edgeInsets;if(!(0===xe.left&&0===xe.top&&0===xe.right&&0===xe.bottom||xe.left===xe.right&&xe.top===xe.bottom)){const bt=m._camera.getWorldToCamera(m.worldSize,"meters"===m.projection.zAxisUnit?ne:1),ht=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,c,g);ht[8]=2*-m.centerOffset.x/m.width,ht[9]=2*m.centerOffset.y/m.height;const st=new Float64Array(16);f.ab.mat4.mul(st,ht,bt);const Pt=new Float64Array(16);f.ab.mat4.invert(Pt,st);const Vt=f.bR.fromInvProjectionMatrix(Pt,F,M,!0);for(const kt of Vt.points){const Gt=((ve=kt)[0]/=A,ve[1]/=A,ve[2]=f.bH(ve[2],m._center.lat),ve);pe=Math.max(pe,f.ab.vec3.len(f.ab.vec3.subtract([],me,Gt)))}}var ve;pe*=b/(b-1);const be=Math.acos(s[2]),ye=Math.atan2(-s[0],-s[1]),Ee=new fp;Ee.position=me,Ee.setPitchBearing(be,ye);const Re=Ee.getWorldToCamera(F,ne),Xe=pe*F,qe=Math.min(m._mercatorZfromZoom(17)*F*-2,-2*Xe),Ae=Ee.getCameraToClipOrthographic(-Xe,Xe,-Xe,Xe,qe,(Xe+x*ne)/s[2]),Be=new Float64Array(16);f.ab.mat4.multiply(Be,Ae,Re);const Ye=f.ab.vec3.fromValues(Math.floor(1e6*me[0])/1e6*F,Math.floor(1e6*me[1])/1e6*F,0),pt=.5*b,Ct=[0,0,0];f.ab.vec3.transformMat4(Ct,Ye,Be),f.ab.vec3.scale(Ct,Ct,pt);const He=[Math.floor(Ct[0]),Math.floor(Ct[1]),Math.floor(Ct[2])],dt=[0,0,0];f.ab.vec3.sub(dt,Ct,He),f.ab.vec3.scale(dt,dt,-1/pt);const Ke=new Float64Array(16);return f.ab.mat4.identity(Ke),f.ab.mat4.translate(Ke,Ke,dt),f.ab.mat4.multiply(Be,Ke,Be),[Be,Xe]}class AT extends f.E{constructor(s){super(),this.requestManager=s,this.models={"":{}},this.numModelsLoading={}}loadModel(s,c){return f.aM(this.requestManager.transformRequest(c,f.R.Model).url).then(g=>{if(!g)return;const b=f.aN(g),x=new f.aO(s,void 0,void 0,b);return x.computeBoundsAndApplyParent(),x}).catch(g=>{if(g&&404===g.status)return null;this.fire(new f.y(new Error(`Could not load model ${s} from ${c}: ${g.message}`)))})}load(s,c){this.models[c]||(this.models[c]={});const g=Object.keys(s);this.numModelsLoading[c]=(this.numModelsLoading[c]||0)+g.length;const b=[];for(const x of g)b.push(this.loadModel(x,s[x]));Promise.allSettled(b).then(x=>{for(let M=0;M<x.length;M++){const{status:A,value:F}=x[M];"fulfilled"===A&&F&&(this.models[c][g[M]]={model:F,numReferences:1})}this.numModelsLoading[c]-=g.length,this.fire(new f.z("data",{dataType:"style"}))}).catch(x=>{this.fire(new f.y(new Error(`Could not load models: ${x.message}`)))})}isLoaded(){for(const s in this.numModelsLoading)if(this.numModelsLoading[s]>0)return!1;return!0}hasModel(s,c){return!!this.getModel(s,c)}getModel(s,c){return this.models[c]||(this.models[c]={}),this.models[c][s]?this.models[c][s].model:void 0}addModel(s,c,g){this.models[g]||(this.models[g]={}),this.hasModel(s,g)&&this.models[g][s].numReferences++,this.load({[s]:this.requestManager.normalizeModelURL(c)},g)}addModels(s,c){this.models[c]||(this.models[c]={});const g={};for(const b in s)this.models[c][b]={},g[b]=this.requestManager.normalizeModelURL(s[b]);this.load(g,c)}addModelsFromBucket(s,c){this.models[c]||(this.models[c]={});const g={};for(const b of s)this.hasModel(b,c)?this.models[c][b].numReferences++:g[b]=this.requestManager.normalizeModelURL(b);this.load(g,c)}removeModel(s,c){if(this.models[c]&&this.models[c][s]&&(this.models[c][s].numReferences--,0===this.models[c][s].numReferences)){const g=this.models[c][s].model;delete this.models[c][s],g.destroy()}}listModels(s){return this.models[s]||(this.models[s]={}),Object.keys(this.models[s])}upload(s,c){this.models[c]||(this.models[c]={});for(const g in this.models[c])this.models[c][g].model&&this.models[c][g].model.upload(s.context)}}const Ba=new f.a5({data:new f.a6(f.a3.colorTheme.data)}),gp={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Lu(m){return m=m||{},Object.assign(m,gp)}class hw extends f.E{constructor(s){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},f.aP(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=s,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(s=>{s.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new f.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=s.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=s.stylesheet.indoor.buildingFeaturesetId,this._scope=s.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:s=>(s.feature&&s.feature.properties.floorplan&&this.selectFloorplan(s.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(s){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(M,A){const[F,N]=M,{center:z,radius:H}=A,[j,G]=z,J=Math.abs(F-j);return Math.sqrt((J>180?360-J:J)**2+(N-G)**2)<=H}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new f.z("floorplangone")));const c={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=new f.P(this._map.transform.width/2,this._map.transform.height/2),b=[new f.P(0,0),new f.P(this._map.transform.width,this._map.transform.height)],x=this._map.queryRenderedFeatures(s?b:g,c);x.length>0&&(this._selectedFloorplan&&x[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=x[0],this._floorplanSelected(!1)))}_floorplanSelected(s){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(x){const[[M,A],[F,N]]=x,z=(F-M+360)%360,H=z>180?360-z:z;return{center:[(M+H/2+360)%360,(A+N)/2],radius:Math.sqrt(H**2+(N-A)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const c=this._floorplanStates[this._indoorData.id].selectedBuilding,g=this._floorplanStates[this._indoorData.id].selectedLevel;let b;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const x of this._indoorData.levels)x.id===this._selectedLevel.id&&(b=x.id);if(this.fire(new f.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:b})),c){const x=this._indoorData.buildings.find(M=>M.id===c);this._buildingSelected(x,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(g){const x=this._indoorData.levels.find(M=>M.id===g);this._updateLevels(x,s)}else s&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(s,c){c&&s&&s.extent&&this._map.fitBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=s?s.id:void 0;const g=this._indoorData.levels.filter(b=>s.levels.includes(b.id));this.fire(new f.z("buildingselected",{buildingId:s.id,levels:g}))}_levelSelected(s){if("overview"===s)this._updateLevels(void 0,!0);else{const c=this._indoorData.levels.find(g=>g.id===s);this._updateLevels(c,!0)}this.fire(new f.z("levelselected",{levelId:"overview"===s?void 0:s}))}_updateLevels(s,c){if(!s)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(c&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function g(N){const z=N.indexOf("/floor/");if(-1===z)return N;const H=z+7,j=N.indexOf("/",H);return-1===j?N.slice(H):N.slice(H,j)}this._selectedLevel=s,this._floorplanStates[this._indoorData.id].selectedLevel=s?s.id:void 0;const b=[],x={},M={},A={},F={};for(const N of this._indoorData.levels)if(b.push(N.id),x[N.id]=N.height,M[N.id]=N.base,s){if(this.mergeFloors){const z=g(s.id),H=g(N.id);A[N.id]=H===z?"true":"false"}else A[N.id]=N.id===s.id?"true":"false";F[N.id]=N.base<s.base?"true":"false"}else F[N.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",b]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",x]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",M]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",A]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",F]),s&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!s.isUnderground),c&&s.extent)){const N=this._map.cameraForBounds(s.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),z=this._map.getZoom(),H=N.zoom?Math.abs(z-N.zoom):0;this._map.fitBounds(s.extent,H>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:z})}}selectFloorplan(s){const c={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},g=[new f.P(0,0),new f.P(this._map.transform.width,this._map.transform.height)],b=this._map.queryRenderedFeatures(g,c);if(b.length>0)for(const x of b)if(JSON.parse(x.properties["indoor-data"]).floorplanIDs.includes(s)){this._selectedFloorplan=x,this._floorplanSelected(!0);break}}selectBuilding(s){const c=this._indoorData.buildings.find(g=>g.id===s);this._buildingSelected(c,!0)}selectLevel(s){this._levelSelected(s)}}function G_(m){if(!m.metadata||!m.metadata.content_area)return;const{left:s,top:c,width:g,height:b}=m.metadata.content_area;return[s,c,s+g,c+b]}const ls=(m,s)=>Ve(m,s&&s.filter(c=>"source.canvas"!==c.identifier)),vr=f.ay(Ei,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),dl=f.ay(Ei,["setCenter","setZoom","setBearing","setPitch"]),og=new Set(["background","sky","slot","custom"]),sg={version:8,layers:[],sources:{}},ef={duration:300,delay:0};class Qr extends f.E{constructor(s,c={}){super(),this.map=s,this.scope=c.scope||"",this.globalId=null,this.fragments=[],this.importDepth=c.importDepth||0,this.importsCache=c.importsCache||new Map,this.resolvedImports=c.resolvedImports||new Set,this.transition=f.l({},ef),this._buildingIndex=new _a(this),this.crossTileSymbolIndex=new Ru,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=c.styleChanges||new xu,this.dispatcher=c.dispatcher?c.dispatcher:new f.D(f.ci(),this),c.imageManager?this.imageManager=c.imageManager:(this.imageManager=new zc(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=c.glyphManager?c.glyphManager:new f.cj(s._requestManager,c.localFontFamily?f.ck.all:c.localIdeographFontFamily?f.ck.ideographs:f.ck.none,c.localFontFamily||c.localIdeographFontFamily),c.modelManager?this.modelManager=c.modelManager:(this.modelManager=new AT(s._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=c.configOptions?c.configOptions:new Map,this._configDependentLayers=c.configDependentLayers?c.configDependentLayers:new Set,this._config=c.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:c.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=c.initialConfig,this.dispatcher.broadcast("setReferrer",f.cl());const g=this;this._rtlTextPluginCallback=Qr.registerForPluginStateChange(b=>{g.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(x,M)=>{if(f.cm(x),M&&M.every(A=>A))for(const A in g._sourceCaches){const F=g._sourceCaches[A],N=F.getSource().type;"vector"!==N&&"geojson"!==N||F.reload()}})}),this.on("data",b=>{if("source"!==b.dataType||"metadata"!==b.sourceDataType)return;const x=this.getOwnSource(b.sourceId);if(x&&x.vectorLayerIds)for(const M in this._layers){const A=this._layers[M];A.source===x.id&&this._validateLayer(A)}})}load(s){return s?("string"==typeof s?this.loadURL(s):this.loadJSON(s),this):this}_getGlobalId(s){if(!s)return null;if("string"==typeof s){if(f.f(s))return s;const c=f.cn(s);if(!c.startsWith("http"))try{return new URL(c,location.href).toString()}catch{return c}return c}return`json://${f.co(JSON.stringify(s))}`}_diffStyle(s,c,g){this.globalId=this._getGlobalId(s);const b=(x,M)=>{try{M(null,this.setState(x,g))}catch(A){M(A,!1)}};if("string"==typeof s){const x=this.map._requestManager.normalizeStyleURL(s),M=this.map._requestManager.transformRequest(x,f.R.Style);f.n(M,(A,F)=>{A?this.fire(new f.y(A)):F&&b(F,c)})}else"object"==typeof s&&b(s,c)}loadURL(s,c={}){this.fire(new f.z("dataloading",{dataType:"style"}));const g="boolean"==typeof c.validate?c.validate:!f.f(s);this.globalId=this._getGlobalId(s),s=this.map._requestManager.normalizeStyleURL(s,c.accessToken),this.resolvedImports.add(s);const b=this.importsCache.get(s);if(b)return this._load(b,g);const x=this.map._requestManager.transformRequest(s,f.R.Style);this._request=f.n(x,(M,A)=>{if(this._request=null,M)this.fire(new f.y(M));else if(A)return this.importsCache.set(s,A),this._load(A,g)})}loadJSON(s,c={}){this.fire(new f.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(s),this._request=f.q.frame(()=>{this._request=null,this._load(s,!1!==c.validate)})}loadEmpty(){this.fire(new f.z("dataloading",{dataType:"style"})),this._load(sg,!1)}_loadImports(s,c,g){if(this.importDepth>=4)return f.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const b=[];for(const x of s){const M=this._createFragmentStyle(x),A=new Promise(z=>{M.once("style.import.load",z),M.once("error",z)}).then(()=>this.mergeAll());if(b.push(A),this.resolvedImports.has(x.url)){M.loadEmpty();continue}const F=x.data||this.importsCache.get(x.url);F?(M.loadJSON(F,{validate:c}),this._isInternalStyle(F)&&(M.globalId=null)):x.url?M.loadURL(x.url,{validate:c}):M.loadEmpty();const N={style:M,id:x.id,config:x.config};if(g){const z=this.fragments.findIndex(({id:H})=>H===g);this.fragments=this.fragments.slice(0,z).concat(N).concat(this.fragments.slice(z))}else this.fragments.push(N)}return Promise.allSettled(b)}getImportGlobalIds(s=this,c=new Set){for(const g of s.fragments)g.style.globalId&&c.add(g.style.globalId),this.getImportGlobalIds(g.style,c);return[...c.values()]}_createFragmentStyle(s){const c=this.scope?f.aC(s.id,this.scope):s.id;let g;const b=this._initialConfig&&this._initialConfig[c];(s.config||b)&&(g=f.l({},s.config,b));const x=new Qr(this.map,{scope:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:g,configOptions:this.options,colorThemeOverride:s["color-theme"],configDependentLayers:this._configDependentLayers});return x.setEventedParent(this.map,{style:x}),x}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(s){return this.isRootStyle()&&(s.fragment||!!s.schema&&!1!==s.fragment)}_load(s,c){const g=s.indoor?Lu(s.schema):s.schema;if(this._isInternalStyle(s)){const M=f.l({},sg,{imports:[{id:"basemap",data:s,url:""}]});return void this._load(M,c)}if(this.updateConfig(this._config,g),c&&ls(this,Zs(s)))return;this._loaded=!0,this.stylesheet=f.cp(s);const b=()=>{for(const N in s.sources)this.addSource(N,s.sources[N],{validate:!1,isInitialLoad:!0});s.sprite?this._loadIconset(s.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(s.glyphs,this.scope);const M=pb(this.stylesheet.layers);if(this._order=M.map(N=>N.id),this.stylesheet.light&&f.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(1===this.stylesheet.lights.length&&"flat"===this.stylesheet.lights[0].type){const N=this.stylesheet.lights[0];this.light=new nt(N.properties,N.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new nt(this.stylesheet.light)),this._layers={};for(const N of M){const z=f.cu(N,this.scope,this._styleColorTheme.lut,this.options);0!==z.configDependencies.size&&this._configDependentLayers.add(z.fqid),z.setEventedParent(this,{layer:{id:z.id}}),this._layers[z.id]=z;const H=this.getOwnLayerSourceCache(z),j=!!this.directionalLight&&this.directionalLight.shadowsEnabled();H&&z.canCastShadows()&&j&&(H.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const A=this.stylesheet.terrain;A&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(A,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new f.z("data",{dataType:"style"}));const F=this.isRootStyle();s.imports?this._loadImports(s.imports,c).then(()=>{this._reloadImports(),this.fire(new f.z(F?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new f.z(F?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const x=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(x){const M=this._evaluateColorThemeData(x);this._loadColorTheme(M).then(()=>{b()}).catch(A=>{f.w(`Couldn't load color theme from the stylesheet: ${A}`),b()})}else this._styleColorTheme.lut=null,b()}isRootStyle(){return 0===this.importDepth}mergeAll(){let s,c,g,b,x,M,A,F,N,z;const H={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(j=>{if(j.stylesheet){if(null!=j.light&&(s=j.light),j.stylesheet.lights)for(const G of j.stylesheet.lights)"ambient"===G.type&&null!=j.ambientLight&&(c=j.ambientLight),"directional"===G.type&&null!=j.directionalLight&&(g=j.directionalLight);b=this._prioritizeTerrain(b,j.terrain,j.stylesheet.terrain),j.stylesheet.fog&&null!=j.fog&&(x=j.fog),j.stylesheet.snow&&null!=j.snow&&(M=j.snow),j.stylesheet.rain&&null!=j.rain&&(A=j.rain),null!=j.stylesheet.camera&&(z=j.stylesheet.camera),null!=j.stylesheet.projection&&(F=j.stylesheet.projection),null!=j.stylesheet.transition&&(N=j.stylesheet.transition),H[j.scope]=j._styleColorTheme}}),this.light=s,this.ambientLight=c,this.directionalLight=g,this.fog=x,this.snow=M,this.rain=A,this._styleColorThemeForScope=H,null===b?delete this.terrain:this.terrain=b,this.camera=z||{"camera-projection":"perspective"},this.projection=F||{name:"mercator"},this.transition=f.l({},ef,N),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(s){const c=g=>{for(const b of g.fragments)c(b.style);s(g)};c(this)}_prioritizeTerrain(s,c,g){const b=s&&0===s.drapeRenderMode;return null===g?c&&0===c.drapeRenderMode?c:b?s:null:null!=c&&(!s||b||c&&1===c.drapeRenderMode)?c:s}mergeTerrain(){let s;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(c=>{s=this._prioritizeTerrain(s,c.terrain,c.stylesheet.terrain)}),null===s?delete this.terrain:this.terrain=s}mergeProjection(){let s;this.forEachFragmentStyle(c=>{null!=c.stylesheet.projection&&(s=c.stylesheet.projection)}),this.projection=s||{name:"mercator"}}mergeSources(){const s={},c={},g={};this.forEachFragmentStyle(b=>{for(const x in b._sourceCaches){const M=f.aC(x,b.scope);s[M]=b._sourceCaches[x]}for(const x in b._otherSourceCaches){const M=f.aC(x,b.scope);c[M]=b._otherSourceCaches[x]}for(const x in b._symbolSourceCaches){const M=f.aC(x,b.scope);g[M]=b._symbolSourceCaches[x]}}),this._mergedSourceCaches=s,this._mergedOtherSourceCaches=c,this._mergedSymbolSourceCaches=g}mergeLayers(){const s={},c=[],g={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(x=>{for(const M of x._order){const A=x._layers[M];if("slot"===A.type){const F=f.cq(M);if(s[F])continue;s[F]=[]}A.slot&&s[A.slot]?s[A.slot].push(A):c.push(A)}}),this._mergedOrder=[];const b=(x=[])=>{for(const M of x)if("slot"===M.type){const A=f.cq(M.id);s[A]&&b(s[A]),this._mergedSlots.push(A)}else{const A=f.aC(M.id,M.scope);this._mergedOrder.push(A),g[A]=M,M.is3D()&&(this._has3DLayers=!0),"circle"===M.type&&(this._hasCircleLayers=!0),"symbol"===M.type&&(this._hasSymbolLayers=!0),"clip"===M.type&&(this._clipLayerPresent=!0)}};b(c),this._mergedOrder.sort((x,M)=>{const A=g[x],F=g[M];return A.hasInitialOcclusionOpacityProperties?F.is3D()?1:0:A.is3D()&&F.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=g,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}getCamera(){return this.stylesheet.camera}setCamera(s){return this.stylesheet.camera=f.l({},this.stylesheet.camera,s),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(s){return s.data?function(c,g,b){const x=f.l({},g);for(const A of Object.keys(f.a3.colorTheme))void 0===x[A]&&(x[A]=f.a3.colorTheme[A].default);const M=new f.a4(Ba,c,new Map(b));return M.setTransitionOrValue(x,b),M.untransitioned().possiblyEvaluate(new f.a8(0))}(this.scope,s,this.options).get("data"):null}_loadColorTheme(s){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const c=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((g,b)=>{const x="data:image/png;base64,";if(!s||0===s.length)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void g();let M=s;M.startsWith(x)||(M=x+M);const A="mapbox-reserved-lut",F=new Image;F.src=M,F.onerror=()=>{this._styleColorTheme.lutLoading=!1,b(new Error("Failed to load image data"))},F.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==c)return void g();this._styleColorTheme.lutLoading=!1;const{width:N,height:z,data:H}=f.q.getImageData(F);if(z>32)return void b(new Error("The height of the image must be less than or equal to 32 pixels."));if(N!==z*z)return void b(new Error("The width of the image must be equal to the height squared."));this.getImage(A)&&this.removeImage(A),this.addImage(A,{data:new f.r({width:N,height:z},H),pixelRatio:1,sdf:!1,usvg:!1,version:0});const j=this.imageManager.getImage(A,this.scope);j?(this._styleColorTheme.lut={image:j.data,data:s},g()):b(new Error("Missing LUT image."))}})}getLut(s){const c=this._styleColorThemeForScope[s];return c?c.lut:null}setProjection(s){s?this.stylesheet.projection=s:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(s){this._spriteRequest=function(c,g,b){let x,M,A;const F=f.q.devicePixelRatio>1?"@2x":"";let N=f.n(g.transformRequest(g.normalizeSpriteURL(c,F,".json"),f.R.SpriteJSON),(j,G)=>{N=null,A||(A=j,x=G,H())}),z=f.o(g.transformRequest(g.normalizeSpriteURL(c,F,".png"),f.R.SpriteImage),(j,G)=>{z=null,A||(A=j,M=G,H())});function H(){if(A)b(A);else if(x&&M){const j=f.q.getImageData(M),G={};for(const J in x){const{width:Q,height:te,x:ne,y:le,sdf:me,pixelRatio:pe,stretchX:xe,stretchY:ve,content:be}=x[J],ye=new f.r({width:Q,height:te});f.r.copy(j,ye,{x:ne,y:le},{x:0,y:0},{width:Q,height:te},null),G[J]={data:ye,pixelRatio:pe,sdf:me,stretchX:xe,stretchY:ve,content:be,usvg:!1}}b(null,G)}}return{cancel(){N&&(N.cancel(),N=null),z&&(z.cancel(),z=null)}}}(s,this.map._requestManager,(c,g)=>{if(this._spriteRequest=null,c)this.fire(new f.y(c));else if(g)for(const b in g)this.imageManager.addImage(b,this.scope,g[b]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new f.z("data",{dataType:"style"}))})}_loadIconset(s){if(!f.f(s)&&"icon_set"!==this.map._spriteFormat||"raster"===this.map._spriteFormat)return void this._loadSprite(s);const c="auto"===this.map._spriteFormat;var g,b;this._spriteRequest=(b=(x,M)=>{if(this._spriteRequest=null,x)c?this._loadSprite(s):this.fire(new f.y(x));else if(M)for(const A in M)this.imageManager.addImage(A,this.scope,M[A]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new f.z("data",{dataType:"style"}))},f.bi((g=this.map._requestManager).transformRequest(g.normalizeIconsetURL(s),f.R.Iconset),(x,M)=>{if(x)return void b(x);const A={},F=f.cg(new f.bh(M));for(const N of F.icons){const z={version:1,pixelRatio:f.q.devicePixelRatio,content:G_(N),stretchX:N.metadata?N.metadata.stretch_x_areas:void 0,stretchY:N.metadata?N.metadata.stretch_y_areas:void 0,sdf:!1,usvg:!0,icon:N};A[N.name]=z}b(null,A)}))}_validateLayer(s){const c=this.getOwnSource(s.source);if(!c)return;const g=s.sourceLayer;g&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(g))&&this.fire(new f.y(new Error(`Source layer "${g}" does not exist on source "${c.id}" as specified by style layer "${s.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const s in this._sourceCaches)if(!this._sourceCaches[s].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:s}of this.fragments)if(!s.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((s,c)=>{const g=this.fragments[c];return g&&g.style&&(s.data=g.style.serialize()),s})}_serializeSources(){const s={};for(const c in this._sourceCaches){const g=this._sourceCaches[c].getSource();s[g.id]||(s[g.id]=g.serialize())}return s}_serializeLayers(s){const c=[];for(const g of s){const b=this._layers[g];b&&"custom"!==b.type&&c.push(b.serialize())}return c}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const s in this._sourceCaches)if(this._sourceCaches[s].hasTransition())return!0;for(const s in this._layers)if(this._layers[s].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(s){return s?this.order:this._mergedOrder}isLayerDraped(s){return!!this.terrain&&s.isDraped(this.getLayerSourceCache(s))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(s){const c=this.getOwnLayer(s);if(c)return c;this.fire(new f.y(new Error(`The layer '${s}' does not exist in the map's style.`)))}_checkSource(s){const c=this.getOwnSource(s);if(c)return c;this.fire(new f.y(new Error(`The source '${s}' does not exist in the map's style.`)))}precompilePrograms(s,c){const g=this.map.painter;if(g)for(let b=s.minzoom||0;b<(s.maxzoom||25.5);b++){const x=s.getProgramIds();if(x)for(const M of x){const A=s.getDefaultProgramParams(M,c.zoom,this._styleColorTheme.lut);A&&(g.style=this,this.fog&&(g._fogVisible=!0,A.overrideFog=!0,g.getOrCreateProgram(M,A)),g._fogVisible=!1,A.overrideFog=!1,g.getOrCreateProgram(M,A),(this.stylesheet.terrain||this.stylesheet.projection&&"globe"===this.stylesheet.projection.name)&&(A.overrideRtt=!0,g.getOrCreateProgram(M,A)))}}}update(s){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(s),this.directionalLight&&this.directionalLight.recalculate(s);const c=this.calculateLightsBrightness();s.brightness=c||0,c!==this._brightness&&(this._brightness=c,this.dispatcher.broadcast("setBrightness",c));const g=this._changes.isDirty();let b=!1;if(this._changes.isDirty()){const M=this._changes.getLayerUpdatesByScope();for(const A in M){const{updatedIds:F,removedIds:N}=M[A];(F||N)&&(this._updateWorkerLayers(A,F,N),b=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(s),this.light&&this.light.updateTransitions(s),this.ambientLight&&this.ambientLight.updateTransitions(s),this.directionalLight&&this.directionalLight.updateTransitions(s),this.fog&&this.fog.updateTransitions(s),this.snow&&this.snow.updateTransitions(s),this.rain&&this.rain.updateTransitions(s),this._changes.reset()}const x={};for(const M in this._mergedSourceCaches){const A=this._mergedSourceCaches[M];x[M]=A.used,A.used=!1,A.tileCoverLift=0}for(const M of this._mergedOrder){const A=this._mergedLayers[M];if(A.recalculate(s,this._availableImages),!A.isHidden(s.zoom)){const F=this.getLayerSourceCache(A);F&&(F.used=!0,F.tileCoverLift=Math.max(F.tileCoverLift,A.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(A,s)}):this.precompilePrograms(A,s))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&b&&this.mergeLayers();for(const M in x){const A=this._mergedSourceCaches[M];x[M]!==A.used&&A.getSource().fire(new f.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:A.getSource().id}))}this.light&&this.light.recalculate(s),this.terrain&&this.terrain.recalculate(s),this.fog&&this.fog.recalculate(s),this.snow&&this.snow.recalculate(s),this.rain&&this.rain.recalculate(s),this.z=s.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),g&&this.fire(new f.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const s=this._changes.getUpdatedImages();if(s.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],s);this._changes.resetUpdatedImages()}}_updateWorkerLayers(s,c,g){const b=this.getFragmentStyle(s);b&&this.dispatcher.broadcast("updateLayers",{layers:c?b._serializeLayers(c):[],scope:s,removedIds:g||[],options:b.options})}setState(s,c){if(this._checkLoaded(),ls(this,Zs(s)))return!1;(s=f.cp(s)).layers=pb(s.layers);const g=function(M,A){if(!M)return[{command:Ei.setStyle,args:[A]}];let F=[];try{if(!f.bn(M.version,A.version))return[{command:Ei.setStyle,args:[A]}];if(f.bn(M.center,A.center)||F.push({command:Ei.setCenter,args:[A.center]}),f.bn(M.zoom,A.zoom)||F.push({command:Ei.setZoom,args:[A.zoom]}),f.bn(M.bearing,A.bearing)||F.push({command:Ei.setBearing,args:[A.bearing]}),f.bn(M.pitch,A.pitch)||F.push({command:Ei.setPitch,args:[A.pitch]}),f.bn(M.sprite,A.sprite)||F.push({command:Ei.setSprite,args:[A.sprite]}),f.bn(M.glyphs,A.glyphs)||F.push({command:Ei.setGlyphs,args:[A.glyphs]}),f.bn(M.imports,A.imports)||function(G=[],J=[],Q){J=J||[];const te=(G=G||[]).map(Qt),ne=J.map(Qt),le=G.reduce(gi,{}),me=J.reduce(gi,{}),pe=te.slice();let xe,ve,be,ye;for(xe=0,ve=0;xe<te.length;xe++)be=te[xe],me.hasOwnProperty(be)?ve++:(Q.push({command:Ei.removeImport,args:[be]}),pe.splice(pe.indexOf(be,ve),1));for(xe=0,ve=0;xe<ne.length;xe++)be=ne[ne.length-1-xe],pe[pe.length-1-xe]!==be&&(le.hasOwnProperty(be)?(Q.push({command:Ei.removeImport,args:[be]}),pe.splice(pe.lastIndexOf(be,pe.length-ve),1)):ve++,ye=pe[pe.length-xe],Q.push({command:Ei.addImport,args:[me[be],ye]}),pe.splice(pe.length-xe,0,be));for(const Ee of J){const Re=le[Ee.id];Re&&!f.bn(Re,Ee)&&Q.push({command:Ei.updateImport,args:[Ee.id,Ee]})}}(M.imports,A.imports,F),f.bn(M.transition,A.transition)||F.push({command:Ei.setTransition,args:[A.transition]}),f.bn(M.light,A.light)||F.push({command:Ei.setLight,args:[A.light]}),f.bn(M.fog,A.fog)||F.push({command:Ei.setFog,args:[A.fog]}),f.bn(M.snow,A.snow)||F.push({command:Ei.setSnow,args:[A.snow]}),f.bn(M.rain,A.rain)||F.push({command:Ei.setRain,args:[A.rain]}),f.bn(M.projection,A.projection)||F.push({command:Ei.setProjection,args:[A.projection]}),f.bn(M.lights,A.lights)||F.push({command:Ei.setLights,args:[A.lights]}),f.bn(M.camera,A.camera)||F.push({command:Ei.setCamera,args:[A.camera]}),!f.bn(M["color-theme"],A["color-theme"]))return[{command:Ei.setStyle,args:[A]}];const N={},z=[];!function(G,J,Q,te){let ne;for(ne in J=J||{},G=G||{})G.hasOwnProperty(ne)&&(J.hasOwnProperty(ne)||Al(ne,Q,te));for(ne in J){if(!J.hasOwnProperty(ne))continue;const le=J[ne];G.hasOwnProperty(ne)?f.bn(G[ne],le)||("geojson"===G[ne].type&&"geojson"===le.type&&Nt(G,J,ne)?Q.push({command:Ei.setGeoJSONSourceData,args:[ne,le.data]}):mb(ne,J,Q,te)):$_(ne,J,Q)}}(M.sources,A.sources,z,N);const H=[];M.layers&&M.layers.forEach(G=>{G.source&&N[G.source]?F.push({command:Ei.removeLayer,args:[G.id]}):H.push(G)});let j=M.terrain;j&&N[j.source]&&(F.push({command:Ei.setTerrain,args:[void 0]}),j=void 0),F=F.concat(z),f.bn(j,A.terrain)||F.push({command:Ei.setTerrain,args:[A.terrain]}),function(G,J,Q){J=J||[];const te=(G=G||[]).map(Qt),ne=J.map(Qt),le=G.reduce(gi,{}),me=J.reduce(gi,{}),pe=te.slice(),xe=Object.create(null);let ve,be,ye,Ee,Re,Xe,qe;for(ve=0,be=0;ve<te.length;ve++)ye=te[ve],me.hasOwnProperty(ye)?be++:(Q.push({command:Ei.removeLayer,args:[ye]}),pe.splice(pe.indexOf(ye,be),1));for(ve=0,be=0;ve<ne.length;ve++)ye=ne[ne.length-1-ve],pe[pe.length-1-ve]!==ye&&(le.hasOwnProperty(ye)?(Q.push({command:Ei.removeLayer,args:[ye]}),pe.splice(pe.lastIndexOf(ye,pe.length-be),1)):be++,Xe=pe[pe.length-ve],Q.push({command:Ei.addLayer,args:[me[ye],Xe]}),pe.splice(pe.length-ve,0,ye),xe[ye]=!0);for(ve=0;ve<ne.length;ve++)if(ye=ne[ve],Ee=le[ye],Re=me[ye],!xe[ye]&&!f.bn(Ee,Re))if(f.bn(Ee.source,Re.source)&&f.bn(Ee["source-layer"],Re["source-layer"])&&f.bn(Ee.type,Re.type)){for(qe in Yt(Ee.layout,Re.layout,Q,ye,null,Ei.setLayoutProperty),Yt(Ee.paint,Re.paint,Q,ye,null,Ei.setPaintProperty),f.bn(Ee.slot,Re.slot)||Q.push({command:Ei.setSlot,args:[ye,Re.slot]}),f.bn(Ee.filter,Re.filter)||Q.push({command:Ei.setFilter,args:[ye,Re.filter]}),f.bn(Ee.minzoom,Re.minzoom)&&f.bn(Ee.maxzoom,Re.maxzoom)||Q.push({command:Ei.setLayerZoomRange,args:[ye,Re.minzoom,Re.maxzoom]}),Ee)Ee.hasOwnProperty(qe)&&"layout"!==qe&&"paint"!==qe&&"filter"!==qe&&"metadata"!==qe&&"minzoom"!==qe&&"maxzoom"!==qe&&"slot"!==qe&&(0===qe.indexOf("paint.")?Yt(Ee[qe],Re[qe],Q,ye,qe.slice(6),Ei.setPaintProperty):f.bn(Ee[qe],Re[qe])||Q.push({command:Ei.setLayerProperty,args:[ye,qe,Re[qe]]}));for(qe in Re)Re.hasOwnProperty(qe)&&!Ee.hasOwnProperty(qe)&&"layout"!==qe&&"paint"!==qe&&"filter"!==qe&&"metadata"!==qe&&"minzoom"!==qe&&"maxzoom"!==qe&&"slot"!==qe&&(0===qe.indexOf("paint.")?Yt(Ee[qe],Re[qe],Q,ye,qe.slice(6),Ei.setPaintProperty):f.bn(Ee[qe],Re[qe])||Q.push({command:Ei.setLayerProperty,args:[ye,qe,Re[qe]]}))}else Q.push({command:Ei.removeLayer,args:[ye]}),Xe=pe[pe.lastIndexOf(ye)+1],Q.push({command:Ei.addLayer,args:[Re,Xe]})}(H,A.layers,F)}catch(N){console.warn("Unable to compute style diff:",N),F=[{command:Ei.setStyle,args:[A]}]}return F}(this.serialize(),s).filter(M=>!(M.command in dl));if(0===g.length)return!1;const b=g.filter(M=>!(M.command in vr));if(b.length>0)throw new Error(`Unimplemented: ${b.map(M=>M.command).join(", ")}.`);const x=[];return g.forEach(M=>{x.push(this[M.command].apply(this,M.args))}),c&&Promise.all(x).then(c),this.stylesheet=s,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(s,c){return this.getImage(s)?this.fire(new f.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(s,this.scope,c),this._afterImageUpdated(s),this)}updateImage(s,c,g=!1){this.imageManager.updateImage(s,this.scope,c),g&&this._afterImageUpdated(s)}getImage(s){return this.imageManager.getImage(s,this.scope)}removeImage(s){return this.getImage(s)?(this.imageManager.removeImage(s,this.scope),this._afterImageUpdated(s),this):this.fire(new f.y(new Error("No image with this name exists.")))}_afterImageUpdated(s){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(s),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new f.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(s,c,g={}){return this._checkLoaded(),this._validate(ze,`models.${s}`,c,null,g)||(this.modelManager.addModel(s,c,this.scope),this._changes.setDirty()),this}hasModel(s){return this.modelManager.hasModel(s,this.scope)}removeModel(s){return this.hasModel(s)?(this.modelManager.removeModel(s,this.scope),this):this.fire(new f.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(s,c,g={}){if(this._checkLoaded(),void 0!==this.getOwnSource(s))throw new Error(`There is already a source with ID "${s}".`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(kl,`sources.${s}`,c,null,g))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const b=xr(s,c,this.dispatcher,this);b.scope=this.scope,b.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(b.id),source:b.serialize(),sourceId:b.id}));const x=M=>{const A=(M?"symbol:":"other:")+b.id,F=f.aC(A,this.scope),N=this._sourceCaches[A]=new sl(F,b,M);(M?this._symbolSourceCaches:this._otherSourceCaches)[b.id]=N,N.onAdd(this.map)};x(!1),"vector"!==c.type&&"geojson"!==c.type||x(!0),b.onAdd&&b.onAdd(this.map),g.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(s){this._checkLoaded();const c=this.getOwnSource(s);if(!c)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===s)return this.fire(new f.y(new Error(`Source "${s}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===s)return this.fire(new f.y(new Error(`Source "${s}" cannot be removed while terrain is using it.`)));const g=this.getOwnSourceCaches(s);for(const b of g){const x=f.cq(b.id);delete this._sourceCaches[x],this._changes.discardSourceCacheUpdate(b.id),b.fire(new f.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles()}return delete this._otherSourceCaches[s],delete this._symbolSourceCaches[s],this.mergeSources(),c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(s,c){this._checkLoaded(),this.getOwnSource(s).setData(c),this._changes.setDirty()}getOwnSource(s){const c=this.getOwnSourceCache(s);return c&&c.getSource()}getOwnSources(){const s=[];for(const c in this._otherSourceCaches){const g=this.getOwnSourceCache(c);g&&s.push(g.getSource())}return s}areTilesLoaded(){const s=this._mergedSourceCaches;for(const c in s){const g=s[c]._tiles;for(const b in g){const x=g[b];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}setLights(s){if(this._checkLoaded(),!s)return delete this.ambientLight,void delete this.directionalLight;const c=this._getTransitionParameters();for(const b of s){if(this._validate(cp,"lights",b))return;switch(b.type){case"ambient":if(this.ambientLight){const x=this.ambientLight;x.set(b),x.updateTransitions(c)}else this.ambientLight=new Br(b,Gi||(Gi=new f.a5({color:new f.a6(f.a3.properties_light_ambient.color),"color-use-theme":new f.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new f.a6(f.a3.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const x=this.directionalLight;x.set(b),x.updateTransitions(c)}else this.directionalLight=new Br(b,er||(er=new f.a5({direction:new f.ak(f.a3.properties_light_directional.direction),color:new f.a6(f.a3.properties_light_directional.color),"color-use-theme":new f.a6({type:"string",default:"default","property-type":"data-constant"}),intensity:new f.a6(f.a3.properties_light_directional.intensity),"cast-shadows":new f.a6(f.a3.properties_light_directional["cast-shadows"]),"shadow-quality":new f.a6(f.a3.properties_light_directional["shadow-quality"]),"shadow-intensity":new f.a6(f.a3.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const g=new f.a8(this.z||0,c);this.ambientLight&&this.ambientLight.recalculate(g),this.directionalLight&&this.directionalLight.recalculate(g),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const s=this.directionalLight,c=this.ambientLight;if(!s||!c)return;const g=j=>.2126*(j[0]<=.03928?j[0]/12.92:Math.pow((j[0]+.055)/1.055,2.4))+.7152*(j[1]<=.03928?j[1]/12.92:Math.pow((j[1]+.055)/1.055,2.4))+.0722*(j[2]<=.03928?j[2]/12.92:Math.pow((j[2]+.055)/1.055,2.4)),b=s.properties.get("color").toRenderColor(null).toArray01(),x=s.properties.get("intensity"),M=s.properties.get("direction"),A=1-f.cb(M.x,M.y,M.z)[2]/90,F=g(b)*x*A,N=c.properties.get("color").toRenderColor(null).toArray01(),z=c.properties.get("intensity"),H=g(N)*z;return Number(((F+H)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const s=[];return this.directionalLight&&s.push(this.directionalLight.get()),this.ambientLight&&s.push(this.ambientLight.get()),s}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(s){if(!s)return this;if(f.cr(s)){const c=f.cs(s),g=this.fragments.find(({id:x})=>x===c);if(!g)throw new Error(`Style import '${s}' not found`);const b=f.cq(s);return g.style.getFragmentStyle(b)}{const c=this.fragments.find(({id:g})=>g===s);if(!c)throw new Error(`Style import '${s}' not found`);return c.style}}setFeaturesetSelectors(s){if(!s)return;const c={},g=(b,x="")=>`${b}::${x}`;this.featuresetSelectors={};for(const b in s){const x=this.featuresetSelectors[b]=[];for(const M of s[b].selectors){if(M.featureNamespace){const F=this.getOwnLayer(M.layer);if(!F){f.w(`Layer is undefined for selector: ${M.layer}`);continue}const N=g(F.source,F.sourceLayer);if(N in c&&c[N]!==M.featureNamespace){f.w(`"featureNamespace ${M.featureNamespace} of featureset ${b}'s selector is not associated to the same source, skip this selector`);continue}c[N]=M.featureNamespace}let A;if(M.properties)for(const F in M.properties){const N=f.U(M.properties[F]);"success"===N.result&&(A=A||{},A[F]=N.value)}x.push({layerId:M.layer,namespace:M.featureNamespace,properties:A})}}}getFeaturesetDescriptors(s){const c=this.getFragmentStyle(s);if(!c||!c.stylesheet.featuresets)return[];const g=[];for(const b in c.stylesheet.featuresets)g.push({featuresetId:b,importId:c.scope?c.scope:void 0});return g}getFeaturesetLayers(s,c){const g=this.getFragmentStyle(c),b=g.stylesheet.featuresets;if(!b||!b[s])return this.fire(new f.y(new Error(`The featureset '${s}' does not exist in the map's style and cannot be queried.`))),[];const x=[];for(const M of b[s].selectors){const A=g.getOwnLayer(M.layer);A&&x.push(A)}return x}getConfigProperty(s,c){const g=this.getFragmentStyle(s);if(!g)return null;const b=f.aC(c,g.scope),x=g.options.get(b),M=x?x.value||x.default:null;return M?M.serialize():null}setConfigProperty(s,c,g){const b=this.getFragmentStyle(s);if(!b)return;const x=b.stylesheet.indoor?Lu(b.stylesheet.schema):b.stylesheet.schema;if(!x||!x[c])return;const M=f.U(g);if("success"!==M.result)return void ls(this,M.value);const A=M.value.expression,F=f.aC(c,b.scope),N=b.options.get(F);if(!N)return;let z;const{minValue:H,maxValue:j,stepValue:G,type:J,values:Q}=x[c],te=f.U(x[c].default);"success"===te.result&&(z=te.value.expression),z?(this.options.set(F,{...N,value:A,default:z,minValue:H,maxValue:j,stepValue:G,type:J,values:Q}),this.updateConfigDependencies(c)):this.fire(new f.y(new Error(`No schema defined for the config option "${c}" in the "${s}" fragment.`)))}getConfig(s){const c=this.getFragmentStyle(s);if(!c)return null;const g=c.stylesheet.schema;if(!g)return null;const b={};for(const x in g){const M=f.aC(x,c.scope),A=c.options.get(M),F=A?A.value||A.default:null;b[x]=F?F.serialize():null}return b}setConfig(s,c){const g=this.getFragmentStyle(s);g&&(g.updateConfig(c,g.stylesheet.schema),this.updateConfigDependencies())}getSchema(s){const c=this.getFragmentStyle(s);return c?c.stylesheet.schema:null}setSchema(s,c){const g=this.getFragmentStyle(s);g&&(g.stylesheet.schema=c,g.updateConfig(g._config,c),this.updateConfigDependencies())}updateConfig(s,c){if(this._config=s,s||c)if(c)for(const g in c){let b,x;const M=f.U(c[g].default);if("success"===M.result&&(b=M.value.expression),s&&void 0!==s[g]){const j=f.U(s[g]);"success"===j.result&&(x=j.value.expression)}const{minValue:A,maxValue:F,stepValue:N,type:z,values:H}=c[g];if(b){const j=f.aC(g,this.scope);this.options.set(j,{default:b,value:x,minValue:A,maxValue:F,stepValue:N,type:z,values:H})}else this.fire(new f.y(new Error(`No schema defined for config option "${g}".`)))}else this.fire(new f.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(s){for(const c of this._configDependentLayers){const g=this.getLayer(c);if(g){if(s&&!g.configDependencies.has(s))continue;g.possiblyEvaluateVisibility(),this._updateLayer(g)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(c=>{const g=c._styleColorTheme.colorThemeOverride?c._styleColorTheme.colorThemeOverride:c._styleColorTheme.colorTheme;if(g){const b=c._evaluateColorThemeData(g);(!c._styleColorTheme.lut&&""!==b||c._styleColorTheme.lut&&b!==c._styleColorTheme.lut.data)&&c.setColorTheme(g)}}),this._changes.setDirty()}addLayer(s,c,g={}){this._checkLoaded();const b=s.id;if(this._layers[b])return void this.fire(new f.y(new Error(`Layer with id "${b}" already exists on this map`)));let x;if("custom"===s.type){if(ls(this,f.ct(s)))return;x=f.cu(s,this.scope,this._styleColorTheme.lut,this.options)}else{if("object"==typeof s.source&&(this.addSource(b,s.source),s=f.cp(s),s=f.l(s,{source:b})),this._validate(ae,`layers.${b}`,s,{arrayIndex:-1},g))return;x=f.cu(s,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(x),x.setEventedParent(this,{layer:{id:b}})}0!==x.configDependencies.size&&this._configDependentLayers.add(x.fqid);let M=this._order.length;if(c){const z=this._order.indexOf(c);if(-1===z)return void this.fire(new f.y(new Error(`Layer with id "${c}" does not exist on this map.`)));x.slot===this._layers[c].slot?M=z:f.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(M,0,b),this._layerOrderChanged=!0,this._layers[b]=x;const A=this.getOwnLayerSourceCache(x),F=!!this.directionalLight&&this.directionalLight.shadowsEnabled();A&&x.canCastShadows()&&F&&(A.castsShadows=!0);const N=this._changes.getRemovedLayer(x);if(N&&x.source&&A&&"custom"!==x.type){this._changes.discardLayerRemoval(x);const z=f.aC(x.source,x.scope);N.type!==x.type?this._changes.updateSourceCache(z,"clear"):(this._changes.updateSourceCache(z,"reload"),A.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),x.scope=this.scope,this.mergeLayers()}moveLayer(s,c){this._checkLoaded();const g=this._checkLayer(s);if(!g||s===c)return;const b=this._order.indexOf(s);this._order.splice(b,1);let x=this._order.length;if(c){const M=this._order.indexOf(c);if(-1===M)return void this.fire(new f.y(new Error(`Layer with id "${c}" does not exist on this map.`)));g.slot===this._layers[c].slot?x=M:f.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(x,0,s),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(s){this._checkLoaded();const c=this._checkLayer(s);if(!c)return;c.setEventedParent(null);const g=this._order.indexOf(s);this._order.splice(g,1),delete this._layers[s],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(c.fqid),this._changes.removeLayer(c);const b=this.getOwnLayerSourceCache(c);if(b&&b.castsShadows){let x=!1;for(const M in this._layers)if(this._layers[M].source===c.source&&this._layers[M].canCastShadows()){x=!0;break}b.castsShadows=x}c.onRemove&&c.onRemove(this.map),this.mergeLayers()}getOwnLayer(s){return this._layers[s]}hasLayer(s){return s in this._mergedLayers}hasLayerType(s){for(const c in this._layers)if(this._layers[c].type===s)return!0;return!1}setLayerZoomRange(s,c,g){this._checkLoaded();const b=this._checkLayer(s);b&&(b.minzoom===c&&b.maxzoom===g||(null!=c&&(b.minzoom=c),null!=g&&(b.maxzoom=g),this._updateLayer(b)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(s,c){this._checkLoaded();const g=this._checkLayer(s);g&&g.slot!==c&&(g.slot=c,this._updateLayer(g))}setFilter(s,c,g={}){this._checkLoaded();const b=this._checkLayer(s);if(b&&!f.bn(b.filter,c))return null==c?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(ge,`layers.${b.id}.filter`,c,{layerType:b.type},g)||(b.filter=f.cp(c),this._updateLayer(b)))}getFilter(s){const c=this._checkLayer(s);if(c)return f.cp(c.filter)}setLayoutProperty(s,c,g,b={}){this._checkLoaded();const x=this._checkLayer(s);if(x&&!f.bn(x.getLayoutProperty(c),g)){if(null!=g&&(!b||!1!==b.validate)&&ls(x,Me.call(Zs,{key:`layers.${s}.layout.${c}`,layerType:x.type,objectKey:c,value:g,styleSpec:f.a3,style:{glyphs:!0,sprite:!0}})))return;x.setLayoutProperty(c,g),0!==x.configDependencies.size&&this._configDependentLayers.add(x.fqid),this._updateLayer(x)}}getLayoutProperty(s,c){const g=this._checkLayer(s);if(g)return g.getLayoutProperty(c)}setPaintProperty(s,c,g,b={}){this._checkLoaded();const x=this._checkLayer(s);if(!x||f.bn(x.getPaintProperty(c),g)||null!=g&&(!b||!1!==b.validate)&&ls(x,Ce.call(Zs,{key:`layers.${s}.paint.${c}`,layerType:x.type,objectKey:c,value:g,styleSpec:f.a3})))return;const M=x.setPaintProperty(c,g);0!==x.configDependencies.size&&this._configDependentLayers.add(x.fqid),M&&this._updateLayer(x),this._changes.updatePaintProperties(x)}getPaintProperty(s,c){const g=this._checkLayer(s);if(g)return g.getPaintProperty(c)}setFeatureState(s,c){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:F,importId:N}=s.target,z=this.getFragmentStyle(N),H=z.getFeaturesetLayers(F);for(const{source:j,sourceLayer:G}of H)z.setFeatureState({id:s.id,source:j,sourceLayer:G},c)}else if("layerId"in s.target){const{layerId:F}=s.target,N=this.getLayer(F);this.setFeatureState({id:s.id,source:N.source,sourceLayer:N.sourceLayer},c)}return}const g=s.source,b=s.sourceLayer,x=this._checkSource(g);if(!x)return;const M=x.type;if("geojson"===M&&b)return void this.fire(new f.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===M&&!b)return void this.fire(new f.y(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===s.id&&this.fire(new f.y(new Error("The feature id parameter must be provided.")));const A=this.getOwnSourceCaches(g);for(const F of A)F.setFeatureState(b,s.id,c)}removeFeatureState(s,c){if(this._checkLoaded(),"target"in s){if("featuresetId"in s.target){const{featuresetId:F,importId:N}=s.target,z=this.getFragmentStyle(N),H=z.getFeaturesetLayers(F);for(const{source:j,sourceLayer:G}of H)z.removeFeatureState({id:s.id,source:j,sourceLayer:G},c)}else if("layerId"in s.target){const{layerId:F}=s.target,N=this.getLayer(F);this.removeFeatureState({id:s.id,source:N.source,sourceLayer:N.sourceLayer},c)}return}const g=s.source,b=this._checkSource(g);if(!b)return;const x=b.type,M="vector"===x?s.sourceLayer:void 0;if("vector"===x&&!M)return void this.fire(new f.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof s.id&&"number"!=typeof s.id)return void this.fire(new f.y(new Error("A feature id is required to remove its specific state property.")));const A=this.getOwnSourceCaches(g);for(const F of A)F.removeFeatureState(M,s.id,c)}getFeatureState(s){if(this._checkLoaded(),"target"in s){let x;if("featuresetId"in s.target){const{featuresetId:M,importId:A}=s.target,F=this.getFragmentStyle(A),N=F.getFeaturesetLayers(M);for(const{source:z,sourceLayer:H}of N){const j=F.getFeatureState({id:s.id,source:z,sourceLayer:H});if(j&&!x)x=j;else if(!f.bn(x,j))return void this.fire(new f.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in s.target){const{layerId:M}=s.target,A=this.getLayer(M);x=this.getFeatureState({id:s.id,source:A.source,sourceLayer:A.sourceLayer})}return x}const c=s.source,g=s.sourceLayer,b=this._checkSource(c);if(b){if("vector"!==b.type||g)return void 0===s.id&&this.fire(new f.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(c)[0].getFeatureState(g,s.id);this.fire(new f.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(s){return this.stylesheet.transition=f.l({},this.stylesheet.transition,s),this.transition=this.stylesheet.transition,this}getTransition(){return f.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const s=this.getTerrain(),c=s&&this.terrain&&this.terrain.scope===this.scope?s:this.stylesheet.terrain;return f.cv({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:c,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},g=>void 0!==g)}_updateFilteredLayers(s){for(const c of Object.values(this._mergedLayers))s(c)&&this._updateLayer(c)}_updateLayer(s){this._changes.updateLayer(s);const c=this.getLayerSourceCache(s),g=f.aC(s.source,s.scope),b=this._changes.getUpdatedSourceCaches();s.source&&!b[g]&&c&&"raster"!==c.getSource().type&&(this._changes.updateSourceCache(g,"reload"),c.pause()),s.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(s){const c=A=>this._mergedLayers[A].is3D(),g=this.order,b={},x=[];for(let A=g.length-1;A>=0;A--){const F=g[A];if(c(F)){b[F]=A;for(const N of s){const z=N[F];if(z)for(const H of z)x.push(H)}}}x.sort((A,F)=>F.intersectionZ-A.intersectionZ);const M=[];for(let A=g.length-1;A>=0;A--){const F=g[A];if(c(F))for(let N=x.length-1;N>=0;N--){const z=x[N].feature;if(z.layer&&b[z.layer.id]<A)break;M.push(z),x.pop()}else for(const N of s){const z=N[F];if(z)for(const H of z)M.push(H.feature)}}return M}queryRenderedFeatures(s,c,g){let b;c&&!Array.isArray(c)&&c.filter&&(this._validate(ge,"queryRenderedFeatures.filter",c.filter,null,c),b=f.aZ(c.filter));const x={},M=z=>{if(og.has(z.type))return;const H=this.getOwnLayerSourceCache(z),j=x[H.id]=x[H.id]||{sourceCache:H,layers:{},has3DLayers:!1};z.is3D()&&(j.has3DLayers=!0),j.layers[z.fqid]=j.layers[z.fqid]||{styleLayer:z,targets:[]},j.layers[z.fqid].targets.push({filter:b})};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new f.y(new Error("parameters.layers must be an Array."))),[];for(const z of c.layers){const H=this._layers[z];if(!H)return this.fire(new f.y(new Error(`The layer '${z}' does not exist in the map's style and cannot be queried for features.`))),[];M(H)}}else for(const z in this._layers)M(this._layers[z]);const A=this._queryRenderedFeatures(s,x,g),F=this._flattenAndSortRenderedFeatures(A),N=[];for(const z of F)f.cs(z.layer.id)===this.scope&&N.push(z);return N}queryRenderedFeatureset(s,c,g){let b;c&&!Array.isArray(c)&&c.filter&&(this._validate(ge,"queryRenderedFeatures.filter",c.filter,null,c),b=f.aZ(c.filter));const x="mock",M=[];if(c&&c.target)M.push({...c,targetId:x,filter:b});else{const N=this.getFeaturesetDescriptors();for(const z of N)M.push({targetId:x,filter:b,target:z});for(const{style:z}of this.fragments){const H=z.getFeaturesetDescriptors();for(const j of H)M.push({targetId:x,filter:b,target:j})}}const A=this.queryRenderedTargets(s,M,g),F=[];for(const N of A)for(const z of N.variants[x])F.push(new f.cw(N,z));return F}queryRenderedTargets(s,c,g){const b={},x=(A,F,N,z)=>{const H=b[F.id]=b[F.id]||{sourceCache:F,layers:{},has3DLayers:!1};H.layers[A.fqid]=H.layers[A.fqid]||{styleLayer:A,targets:[]},A.is3D()&&(H.has3DLayers=!0),H.layers[A.fqid].targets.push(z?{...N,namespace:z.namespace,properties:z.properties}:N)};for(const A of c)if("featuresetId"in A.target){const{featuresetId:F,importId:N}=A.target,z=this.getFragmentStyle(N),H=z.featuresetSelectors[F];if(!H){this.fire(new f.y(new Error(`The featureset '${F}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const j of H){const G=z.getOwnLayer(j.layerId);G&&!og.has(G.type)&&x(G,z.getOwnLayerSourceCache(G),A,j)}}else if("layerId"in A.target){const{layerId:F}=A.target,N=this.getLayer(F);if(!N||og.has(N.type))continue;x(N,this.getLayerSourceCache(N),A)}const M=this._queryRenderedFeatures(s,b,g);return this._flattenAndSortRenderedFeatures(M)}_queryRenderedFeatures(s,c,g){const b=[],x=!!this.map._showQueryGeometry,M=so.createFromScreenPoints(s,g);for(const A in c){const F=hb(M,c[A],this._availableImages,g,x);Object.keys(F).length&&b.push(F)}if(this.placement)for(const A in c){if(!c[A].sourceCache._onlySymbols)continue;const F=So(M.screenGeometry,c[A],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(F).length&&b.push(F)}return b}querySourceFeatures(s,c){const g=c&&c.filter;g&&this._validate(ge,"querySourceFeatures.filter",g,null,c);let b=[];const x=this.getOwnSourceCaches(s);for(const M of x)b=b.concat(Tu(M,c));return b}addSourceType(s,c,g){return Qr.getSourceType(s)?g(new Error(`A source type called "${s}" already exists.`)):(Qr.setSourceType(s,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:s,url:c.workerSourceURL},g):g(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(s,c,g={}){this._checkLoaded();const b=this.light.getLight();let x=!1;for(const A in s)if(!f.bn(s[A],b[A])){x=!0;break}if(!x)return;const M=this._getTransitionParameters();this.light.setLight(s,c,g),this.light.updateTransitions(M)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){void 0===this.disableElevatedTerrain&&(this.disableElevatedTerrain=f.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&f.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(s,c=1){if(this._checkLoaded(),!s)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),0===c&&delete this.terrain,null===s?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let g=s;const b=null==s.source;if(1===c){if(this.disableElevatedTerrain)return;if("object"==typeof g.source){const A="terrain-dem-src";this.addSource(A,g.source),g=f.cp(g),g=f.l(g,{source:A})}const x=f.l({},g),M={};if(this.terrain&&b){x.source=this.terrain.get().source;const A=this.terrain?this.getFragmentStyle(this.terrain.scope):null;A&&(M.style=A.serialize())}if(this._validate(Md,"terrain",x,M))return}if(!this.terrain||this.terrain.scope!==this.scope&&!b||this.terrain&&c!==this.terrain.drapeRenderMode){if(!g)return;this._createTerrain(g,c),this.fire(new f.z("data",{dataType:"style"}))}else{const x=this.terrain,M=x.get();for(const A of Object.keys(f.a3.terrain))!g.hasOwnProperty(A)&&f.a3.terrain[A].default&&(g[A]=f.a3.terrain[A].default);for(const A in s)if(!f.bn(s[A],M[A])){x.set(s,this.options),this.stylesheet.terrain=s;const F=this._getTransitionParameters({duration:0});x.updateTransitions(F),this.fire(new f.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(s){const c=this.fog=new ot(s,this.map.transform,this.scope,this.options);this.stylesheet.fog=c.get();const g=this._getTransitionParameters({duration:0});c.updateTransitions(g)}_createSnow(s){const c=this.snow=new Mo(s,this.map.transform,this.scope,this.options);this.stylesheet.snow=c.get();const g=this._getTransitionParameters({duration:0});c.updateTransitions(g)}_createRain(s){const c=this.rain=new xs(s,this.map.transform,this.scope,this.options);this.stylesheet.rain=c.get();const g=this._getTransitionParameters({duration:0});c.updateTransitions(g)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const s of this.map._markers)s._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(s){if(this._checkLoaded(),!s)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog;if(!f.bn(c.get(),s)){c.set(s,this.options),this.stylesheet.fog=c.get();const g=this._getTransitionParameters({duration:0});c.updateTransitions(g)}}else this._createFog(s);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(s){if(this._checkLoaded(),!s)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const c=this.snow;if(!f.bn(c.get(),s)){c.set(s,this.options),this.stylesheet.snow=c.get();const g=this._getTransitionParameters({duration:0});c.updateTransitions(g)}}else this._createSnow(s);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(s){if(this._checkLoaded(),!s)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const c=this.rain;if(!f.bn(c.get(),s)){c.set(s,this.options),this.stylesheet.rain=c.get();const g=this._getTransitionParameters({duration:0});c.updateTransitions(g)}}else this._createRain(s);this._markersNeedUpdate=!0}_reloadColorTheme(){const s=()=>{for(const b in this._layers)this._layers[b].lut=this._styleColorTheme.lut;for(const b in this._sourceCaches)this._sourceCaches[b].clearTiles()},c=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!c)return this._styleColorTheme.lut=null,void s();const g=this._evaluateColorThemeData(c);this._loadColorTheme(g).then(()=>{this.fire(new f.z("colorthemeset")),s()}).catch(b=>{f.w(`Couldn't set color theme: ${b}`)})}setColorTheme(s){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&f.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=s,this._reloadColorTheme()}setImportColorTheme(s,c){const g=this.getFragmentStyle(s);g&&(g._styleColorTheme.colorThemeOverride=c,g._reloadColorTheme())}_getTransitionParameters(s){return{now:f.q.now(),transition:f.l(this.transition,s)}}updateDrapeFirstLayers(){if(!this.terrain)return;const s=[],c=[];for(const g of this._mergedOrder)this.isLayerDraped(this._mergedLayers[g])?s.push(g):c.push(g);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...s),this._drapedFirstOrder.push(...c)}_createTerrain(s,c){const g=this.terrain=new Je(s,c,this.scope,this.options);1===c&&(this.stylesheet.terrain=s),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const b=this._getTransitionParameters({duration:0});g.updateTransitions(b)}_force3DLayerUpdate(){for(const s in this._layers){const c=this._layers[s];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const s in this._layers){const c=this._layers[s];"symbol"===c.type&&this._updateLayer(c)}}_validate(s,c,g,b,x={}){if(x&&!1===x.validate)return!1;const M=f.l({},this.serialize());return ls(this,s.call(Zs,f.l({key:c,style:M,value:g,styleSpec:f.a3},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.cx.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._mergedLayers)this._mergedLayers[s].setEventedParent(null);for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles(),this._mergedSourceCaches[s].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(s){const c=this.getSourceCaches(s);for(const g of c)g.clearTiles()}clearSources(){for(const s in this._mergedSourceCaches)this._mergedSourceCaches[s].clearTiles()}reloadSource(s){const c=this.getSourceCaches(s);for(const g of c)g.resume(),g.reload()}reloadSources(){for(const s of this.getSources())s.reload&&s.reload()}updateSources(s){let c;this.directionalLight&&(c=pc(this.directionalLight));for(const g in this._mergedSourceCaches)this._mergedSourceCaches[g].update(s,void 0,void 0,c)}_generateCollisionBoxes(){for(const s in this._sourceCaches){const c=this._sourceCaches[s];c.resume(),c.reload()}}_updatePlacement(s,c,g,b,x,M,A=!1){let F=!1,N=!1;const z={},H={};for(const j of this._mergedOrder){const G=this._mergedLayers[j];if("symbol"!==G.type)continue;const J=f.aC(G.source,G.scope);let Q=z[J];if(!Q){const ne=this.getLayerSourceCache(G);if(!ne)continue;const le=ne.getRenderableIds(!0).map(me=>ne.getTileByID(me));H[J]=le.slice(),Q=z[J]=le.sort((me,pe)=>pe.tileID.overscaledZ-me.tileID.overscaledZ||(me.tileID.isLessThan(pe.tileID)?-1:1))}const te=this.crossTileSymbolIndex.addLayer(G,Q,c.center.lng,c.projection);F=F||te}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),A=A||this._layerOrderChanged||0===b,this._layerOrderChanged&&this.fire(new f.z("neworder")),(A||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.q.now(),c.zoom))&&(this.pauseablePlacement=new Au(c,this._mergedOrder,A,g,b,x,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,z,H,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.q.now()),N=!0),F&&this.pauseablePlacement.placement.setStale()),N||F){this._buildingIndex.onNewFrame(c.zoom);for(let j=0;j<this._mergedOrder.length;j++){const G=this._mergedLayers[this._mergedOrder[j]];if("symbol"!==G.type)continue;const J=this.isLayerClipped(G);this.placement.updateLayerOpacities(G,z[f.aC(G.source,G.scope)],j,J?M:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.q.now())}}_releaseSymbolFadeTiles(){for(const s in this._sourceCaches)this._sourceCaches[s].releaseSymbolFadeTiles()}addImport(s,c){this._checkLoaded();const g=this.stylesheet.imports=this.stylesheet.imports||[];if(-1!==g.findIndex(({id:x})=>x===s.id))return void this.fire(new f.y(new Error(`Import with id '${s.id}' already exists in the map's style.`)));if(!c)return g.push(s),this._loadImports([s],!0);const b=g.findIndex(({id:x})=>x===c);return-1===b&&this.fire(new f.y(new Error(`Import with id "${c}" does not exist on this map.`))),this.stylesheet.imports=g.slice(0,b).concat(s).concat(g.slice(b)),this._loadImports([s],!0,c)}updateImport(s,c){this._checkLoaded();const g=this.stylesheet.imports||[],b=this.getImportIndex(s);return-1===b?this:"string"==typeof c?(this.setImportUrl(s,c),this):(c.url&&c.url!==g[b].url&&this.setImportUrl(s,c.url),f.bn(c.config,g[b].config)||this.setImportConfig(s,c.config),f.bn(c.data,g[b].data)||this.setImportData(s,c.data),this)}moveImport(s,c){this._checkLoaded();let g=this.stylesheet.imports||[];const b=this.getImportIndex(s);if(-1===b)return this;const x=this.getImportIndex(c);if(-1===x)return this;const M=g[b],A=this.fragments[b];return g=g.filter(({id:F})=>F!==s),this.fragments=this.fragments.filter(({id:F})=>F!==s),this.stylesheet.imports=g.slice(0,x).concat(M).concat(g.slice(x)),this.fragments=this.fragments.slice(0,x).concat(A).concat(this.fragments.slice(x)),this.mergeLayers(),this}setImportUrl(s,c){this._checkLoaded();const g=this.stylesheet.imports||[],b=this.getImportIndex(s);if(-1===b)return this;g[b].url=c;const x=this.fragments[b];return x.style=this._createFragmentStyle(g[b]),x.style.on("style.import.load",()=>this.mergeAll()),x.style.loadURL(c),this}setImportData(s,c){this._checkLoaded();const g=this.getImportIndex(s),b=this.stylesheet.imports||[];return-1===g?this:c?(this.fragments[g].style.setState(c),this._reloadImports(),this):(delete b[g].data,this.setImportUrl(s,b[g].url))}setImportConfig(s,c){this._checkLoaded();const g=this.getImportIndex(s),b=this.stylesheet.imports||[];if(-1===g)return this;c?b[g].config=c:delete b[g].config;const x=this.fragments[g],M=x.style.stylesheet&&x.style.stylesheet.schema;return x.config=c,x.style.updateConfig(c,M),this.updateConfigDependencies(),this}removeImport(s){this._checkLoaded();const c=this.stylesheet.imports||[],g=this.getImportIndex(s);-1!==g&&(c.splice(g,1),this.fragments[g].style._remove(),this.fragments.splice(g,1),this._reloadImports())}getImportIndex(s){const c=(this.stylesheet.imports||[]).findIndex(g=>g.id===s);return-1===c&&this.fire(new f.y(new Error(`Import '${s}' does not exist in the map's style and cannot be updated.`))),c}getLayer(s){return this._mergedLayers[s]}getSources(){const s=[];for(const c in this._mergedOtherSourceCaches){const g=this._mergedOtherSourceCaches[c];g&&s.push(g.getSource())}return s}getSource(s,c){const g=this.getSourceCache(s,c);return g&&g.getSource()}getLayerSource(s){const c=this.getLayerSourceCache(s);return c&&c.getSource()}getSourceCache(s,c){const g=f.aC(s,c);return this._mergedOtherSourceCaches[g]}getLayerSourceCache(s){const c=f.aC(s.source,s.scope);return"symbol"===s.type?this._mergedSymbolSourceCaches[c]:this._mergedOtherSourceCaches[c]}getSourceCaches(s){if(null==s)return Object.values(this._mergedSourceCaches);const c=[];return this._mergedOtherSourceCaches[s]&&c.push(this._mergedOtherSourceCaches[s]),this._mergedSymbolSourceCaches[s]&&c.push(this._mergedSymbolSourceCaches[s]),c}updateSourceCaches(){const s=this._changes.getUpdatedSourceCaches();for(const c in s){const g=s[c];"reload"===g?this.reloadSource(c):"clear"===g&&this.clearSource(c)}}updateLayers(s){const c=this._changes.getUpdatedPaintProperties();for(const g of c){const b=this.getLayer(g);b&&b.updateTransitions(s)}}getImages(s,c,g){this.imageManager.getImages(c.icons,c.scope,g),this._updateTilesForChangedImages();const b=x=>{x&&x.setDependencies(c.tileID.key,c.type,c.icons)};b(this._otherSourceCaches[c.source]),b(this._symbolSourceCaches[c.source])}rasterizeImages(s,c,g){this.imageManager.rasterizeImages(c,g)}getGlyphs(s,c,g){this.glyphManager.getGlyphs(c.stacks,c.scope,g)}getResource(s,c,g){return f.cy(c,g)}getOwnSourceCache(s){return this._otherSourceCaches[s]}getOwnLayerSourceCache(s){return"symbol"===s.type?this._symbolSourceCaches[s.source]:this._otherSourceCaches[s.source]}getOwnSourceCaches(s){const c=[];return this._otherSourceCaches[s]&&c.push(this._otherSourceCaches[s]),this._symbolSourceCaches[s]&&c.push(this._symbolSourceCaches[s]),c}_isSourceCacheLoaded(s){const c=this.getOwnSourceCaches(s);return 0===c.length?(this.fire(new f.y(new Error(`There is no source with ID '${s}'`))),!1):c.every(g=>g.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(s,c){if(!this._clipLayerPresent&&"fill-extrusion"!==s.type)return!1;const g="fill-extrusion"===s.type&&"building"===s.sourceLayer;if(s.is3D()){if(g||c&&"batched-model"===c.type||"model"===s.type)return!0}else if("symbol"===s.type)return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(s=>{s.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Qr.getSourceType=function(m){return Hh[m]},Qr.setSourceType=function(m,s){Hh[m]=s},Qr.registerForPluginStateChange=f.ch;var Ai="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef RENDER_CUTOFF\nfloat cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}\n#endif",qo="\nout vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#ifdef INDICATOR_CUTOUT\nuniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;\n#endif\nvec4 applyCutout(vec4 color,float height) {\n#ifdef INDICATOR_CUTOUT\nfloat verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);\n#else\nreturn color;\n#endif\n}\n#ifdef DEBUG_WIREFRAME\n#define HANDLE_WIREFRAME_DEBUG \\\nglFragColor=vec4(0.7,0.0,0.0,0.7); \\\ngl_FragDepth=gl_FragCoord.z-0.0001;\n#else\n#define HANDLE_WIREFRAME_DEBUG\n#endif\n#ifdef RENDER_CUTOFF\nuniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;\n#endif\nvec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}",Qo="\n#define EXTENT 8192.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}\n#ifdef RENDER_CUTOFF\nuniform vec4 u_cutoff_params;out float v_cutoff_opacity;\n#endif\nconst vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}",Rl="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Va="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nvec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }\n#endif\n#ifdef DEPTH_OCCLUSION\nuniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;\n#ifdef DEPTH_D24\nfloat unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}\n#else\nhighp float unpack_depth_rgba(vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;\n#ifdef DEPTH_D24\nfloat depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);\n#else\nfloat depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));\n#endif\nreturn coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;\n#ifdef DEPTH_D24\nhighp vec4 depth=vec4(\ntexture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r\n);depth=unpack_depth4(depth);\n#else\nhighp vec4 depth=vec4(\nunpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))\n);\n#endif\nreturn depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));\n#endif\nres+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}\n#else\nbool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }\n#endif//DEPTH_OCCLUSION",q_="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",kd="highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {\n#ifdef FOG_DITHERING\nvec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);\n#else\nreturn color;\n#endif\n}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif",tf="#ifdef RASTER_ARRAY\nuniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)\n);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)\n);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}\n#endif",ag="#ifdef RASTER_ARRAY\nuniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}\n#endif\nuniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}",mc="#ifdef RENDER_SHADOWS\nuniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}\n#endif//RENDER_SHADOWS",_p="#ifdef RENDER_SHADOWS\n#ifdef DEPTH_TEXTURE\nuniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;\n#else\nuniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;\n#endif\nuniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_1,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;\n#ifdef DEPTH_TEXTURE\nshadow_depth=texture(u_shadowmap_0,uv).r;\n#else\nshadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;\n#endif\nreturn step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;\n#ifdef TEXTURE_GATHER\nhighp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));\n#else\nhighp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(\nshadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)\n);\n#endif\nvec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {\n#ifdef SHADOWS_SINGLE_CASCADE\nlight_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);\n#else\nlight_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));\n#endif\n}highp float calculate_shadow_bias(float NDotL) {\n#ifdef NORMAL_OFFSET\nreturn 0.5*u_shadow_bias.x;\n#else\nreturn 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));\n#endif\n}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)\n{highp vec2 biasUV=vec2(\npos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}\n#endif";const Wc=[];Ad(Ai,Wc),Ad(Qo,Wc),Ad(qo,Wc);const Nu={"_prelude_fog.vertex.glsl":q_,"_prelude_terrain.vertex.glsl":Va,"_prelude_shadow.vertex.glsl":mc,"_prelude_fog.fragment.glsl":kd,"_prelude_shadow.fragment.glsl":_p,"_prelude_lighting.glsl":"\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}\n#endif//LIGHTING_3D_MODE","_prelude_raster_array.glsl":tf,"_prelude_raster_particle.glsl":ag},Pl={};li("",Va),li(kd,q_),li(_p,mc),li(tf,""),li(ag,"");const nf=li(qo,Qo),yp=Ai;var Zc={background:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nin vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_lighting.glsl"\nin vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),backgroundPattern:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),circle:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nuniform float u_emissive_strength;void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\nglFragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}'),clippingMask:li("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:li('#include "_prelude_fog.fragment.glsl"\nuniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nout vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),heatmapTexture:li("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(0.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}","in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:li("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",'#include "_prelude_terrain.vertex.glsl"\nin vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}'),collisionCircle:li("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}","in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:li("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",'#include "_prelude_terrain.vertex.glsl"\nin vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;\n#endif\nout vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}'),fill:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nuniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=opacity;\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color,v_z_offset);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\nuniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=z_offset;\n#endif\n}'),fillOutline:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nin highp vec2 v_pos;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nuniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp float z_offset\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillOutlinePattern:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nin highp vec2 v_pos;in highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nout highp vec2 v_pos;out highp vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillPattern:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nglFragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;\n#ifdef ELEVATED_ROADS\nin float a_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\nout highp vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define highp float z_offset\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize highp float z_offset\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;\n#ifdef ELEVATED_ROADS\nz_offset+=a_road_z_offset;\n#endif\nfloat hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),fillExtrusion:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nin vec4 v_color;in vec4 v_flat;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;\n#endif\nuniform lowp float u_opacity;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec2 v_ao;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nin vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nin highp vec3 v_normal;\n#endif\nuniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nin float v_flood_radius;in float v_has_floodlight;\n#endif\nin float v_height;\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float emissive_strength\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nvec3 normal=normalize(v_normal);\n#endif\nfloat z;vec4 color=v_color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);\n#ifdef LIGHTING_3D_MODE\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#else\ncolor=mix(v_color,v_roof_color,z);\n#endif\n#endif\nfloat h=max(0.0,v_height);float ao_shade=1.0;\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\ncolor.rgb*=mix(ao_shade,1.0,v_has_floodlight);\n#else\ncolor.rgb*=ao_shade;\n#endif\n#else\ncolor.rgb*=ao_shade;\n#endif\n#endif\n#ifdef LIGHTING_3D_MODE\nfloat flood_radiance=0.0;\n#ifdef FLOOD_LIGHT\nflood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef FLOOD_LIGHT\nfloat ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);\n#else\nfloat shadowed_lighting_factor;\n#ifdef RENDER_CUTOFF\nshadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}\n#else\nshadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);\n#endif\ncolor.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);\n#endif\n#else\ncolor.rgb=apply_lighting(color.rgb,normal);\n#ifdef FLOOD_LIGHT\ncolor.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);\n#endif\n#endif\ncolor.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));\n#endif\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color,h);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nuniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nout vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nout highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec2 v_ao;\n#endif\n#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)\nout float v_flood_radius;out float v_has_floodlight;\n#endif\nout float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define highp float flood_light_wall_radius\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize highp float flood_light_wall_radius\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp float emissive_strength\nbase*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)\nv_normal=normal;\n#endif\nbase=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat cutoff=1.0;vec3 scaled_pos=pos;\n#ifdef RENDER_CUTOFF\nvec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\ngl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;\n#ifdef RENDER_SHADOWS\nvec3 shd_pos0=pos;vec3 shd_pos1=pos;\n#ifdef NORMAL_OFFSET\nvec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifndef LIGHTING_3D_MODE\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#endif\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\n#ifdef FLOOD_LIGHT\nfloat is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;\n#endif\nv_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);\n#else\nv_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#endif\n#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}'),fillExtrusionDepth:li("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nin vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp float line_width\n#pragma mapbox: define highp vec4 color\nout highp float v_depth;void main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp float line_width\n#pragma mapbox: initialize highp vec4 color\nbase*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nvec3 pos;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);\n#else\npos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}'),fillExtrusionPattern:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;in vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nin vec3 v_normal;\n#endif\nin highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color,height);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#include "_prelude_lighting.glsl"\nuniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;\n#ifdef RENDER_WALL_MODE\nin vec3 a_join_normal_inside;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\n#ifdef TERRAIN\nuniform int u_height_type;uniform int u_base_type;\n#endif\nout highp vec2 v_pos;out vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;out vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nout vec3 v_normal;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define highp float pixel_ratio\n#pragma mapbox: define highp float line_width\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize highp float pixel_ratio\n#pragma mapbox: initialize highp float line_width\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\n#ifdef RENDER_WALL_MODE\nvec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;\n#endif\nfloat hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_normal=normal;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}'),groundShadow:li('#include "_prelude_shadow.fragment.glsl"\nprecision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\nvoid main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);\n#ifdef RENDER_CUTOFF\nshadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));\n#endif\n#ifdef FOG\nshadow=mix(shadow,vec3(1.0),v_fog_opacity);\n#endif\n#ifdef INDICATOR_CUTOUT\nshadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);\n#endif\nglFragColor=vec4(shadow,1.0);}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);\n#endif\n}'),fillExtrusionGroundEffect:li("uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;\n#ifdef SDF_SUBPASS\nin highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}\n#ifdef FOG\nin highp float v_fog;\n#endif\n#endif\nvoid main() {\n#ifdef CLEAR_SUBPASS\nvec4 color=vec4(1.0);\n#ifdef CLEAR_FROM_TEXTURE\ncolor=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));\n#endif\nglFragColor=color;\n#else\n#ifdef SDF_SUBPASS\nhighp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;\n#ifdef FOG\nfog=v_fog;\n#endif\n#ifdef RENDER_CUTOFF\nfog*=v_cutoff_opacity;\n#endif\nglFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));\n#else\nvec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);\n#ifdef OVERDRAW_INSPECTOR\ncolor=vec4(1.0);\n#endif\nglFragColor=color;\n#endif\nHANDLE_WIREFRAME_DEBUG;\n#endif\n}",'#include "_prelude_fog.vertex.glsl"\nin highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;\n#ifdef SDF_SUBPASS\nout highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;\n#ifdef FOG\nout highp float v_fog;\n#endif\n#endif\nuniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;\n#pragma mapbox: define highp float flood_light_ground_radius\nconst float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {\n#pragma mapbox: initialize highp float flood_light_ground_radius\nvec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;\n#ifdef SDF_SUBPASS\nv_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);\n#ifdef FOG\nv_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);\n#endif\n#endif\nfloat hidden_by_landmark=0.0;\n#ifdef HAS_CENTROID\nhidden_by_landmark=a_hidden_by_landmark;\n#endif\nfloat isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n}'),hillshadePrepare:li("precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\nglFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);\n#endif\n#ifdef FOG\nglFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}'),line:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;\n#ifdef ELEVATED_ROADS\nin highp float v_road_z_offset;\n#endif\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;in vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nfloat luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trim_alpha=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}\n#endif\nif (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#ifdef ELEVATED_ROADS\nout_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);\n#else\nout_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\nout_color*=(alpha*opacity);\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color,v_z_offset);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define EXTRUDE_SCALE 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)\nin vec2 a_z_offset_width;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nin highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nin float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;\n#ifdef ELEVATED\nuniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {\n#ifdef ELEVATION_REFERENCE_SEA\nreturn 0.0;\n#else\nreturn elevation(apos);\n#endif\n}\n#endif\nout vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;\n#ifdef ELEVATED_ROADS\nout highp float v_road_z_offset;\n#endif\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float border_width\n#pragma mapbox: define lowp vec4 border_color\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float border_width\n#pragma mapbox: initialize lowp vec4 border_color\nfloat a_z_offset;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\na_z_offset=a_z_offset_width.x;\n#endif\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;\n#ifdef VARIABLE_LINE_WIDTH\nhalfwidth=(u_width_scale*a_z_offset_width.y)/2.0;\n#else\nhalfwidth=(u_width_scale*width)/2.0;\n#endif\noffset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;\n#ifdef ELEVATED_ROADS\nv_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;\n#ifdef CROSS_SLOPE_VERTICAL\nfloat top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);\n#else\n#ifdef CROSS_SLOPE_HORIZONTAL\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;\n#else\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;\n#endif\n#endif\ngl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifdef ELEVATED_ROADS\n#ifdef RENDER_SHADOWS\nvec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;\n#ifdef NORMAL_OFFSET\nvec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=a_z_offset;\n#endif\n}'),linePattern:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_shadow.fragment.glsl"\nuniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 v_uv;\n#endif\n#ifdef ELEVATED_ROADS\nin highp float v_road_z_offset;\n#endif\n#ifdef LINE_JOIN_NONE\nin vec2 v_pattern_data;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;\n#endif\nuniform float u_emissive_strength;\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}\n#endif\n#ifdef LINE_JOIN_NONE\nhighp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}\n#endif\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting_with_emission_ground(color,u_emissive_strength);\n#ifdef RENDER_SHADOWS\nfloat light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#ifdef ELEVATED_ROADS\ncolor.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);\n#else\ncolor.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}\n#ifdef INDICATOR_CUTOUT\ncolor=applyCutout(color,v_z_offset);\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\nin vec2 a_z_offset_width;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nin highp vec4 a_packed;\n#endif\nin highp float a_linesofar;\n#ifdef LINE_JOIN_NONE\nin highp vec3 a_pattern_data;out vec2 v_pattern_data;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\nuniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;\n#ifdef ELEVATED\nuniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {\n#ifdef ELEVATION_REFERENCE_SEA\nreturn 0.0;\n#else\nreturn elevation(apos);\n#endif\n}\n#endif\nout vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef RENDER_LINE_TRIM_OFFSET\nout highp vec4 v_uv;\n#endif\n#ifdef ELEVATED_ROADS\nout highp float v_road_z_offset;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;\n#endif\n#pragma mapbox: define mediump float blur\n#pragma mapbox: define mediump float opacity\n#pragma mapbox: define mediump float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define mediump float floorwidth\n#pragma mapbox: define mediump vec4 pattern\n#pragma mapbox: define mediump float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize mediump float blur\n#pragma mapbox: initialize mediump float opacity\n#pragma mapbox: initialize mediump float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize mediump float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize mediump float pixel_ratio\nfloat a_z_offset;\n#if defined(ELEVATED) || defined(ELEVATED_ROADS)\na_z_offset=a_z_offset_width.x;\n#endif\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;\n#ifdef ELEVATED_ROADS\nv_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;\n#else\n#ifdef ELEVATED\nvec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;\n#ifdef CROSS_SLOPE_VERTICAL\nfloat top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);\n#else\n#ifdef CROSS_SLOPE_HORIZONTAL\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;\n#else\nfloat ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;\n#endif\n#endif\ngl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);\n#else\ngl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);\n#endif\n#endif\n#ifdef ELEVATED_ROADS\n#ifdef RENDER_SHADOWS\nvec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;\n#ifdef NORMAL_OFFSET\nvec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();\n#endif\nv_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;\n#endif\n#endif\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_TRIM_OFFSET\nfloat a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);\n#ifdef LINE_JOIN_NONE\nv_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=a_z_offset;\n#endif\n}'),raster:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\n#include "_prelude_raster_array.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nin float v_split_fade;\n#endif\nuniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;\n#ifndef RASTER_ARRAY\nuniform highp sampler2D u_image0;uniform sampler2D u_image1;\n#endif\n#ifdef RASTER_COLOR\nuniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;\n#endif\nvoid main() {vec4 color0,color1,color;vec2 value;\n#ifdef RASTER_COLOR\n#ifdef RASTER_ARRAY\n#ifdef RASTER_ARRAY_LINEAR\nvalue=mix(\nraTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#else\nvalue=mix(\nraTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t\n);\n#endif\nif (value.y > 0.0) value.x/=value.y;\n#else\ncolor=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);\n#endif\ncolor=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;\n#else\ncolor0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);\n#endif\ncolor.a*=u_opacity;\n#ifdef GLOBE_POLES\ncolor.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);\n#endif\nvec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef PROJECTION_GLOBE_VIEW\nglFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));\n#endif\n#ifdef RENDER_CUTOFF\nglFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);\n#endif\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;in vec2 a_texture_pos;\n#endif\nout vec2 v_pos0;out vec2 v_pos1;out float v_depth;\n#ifdef PROJECTION_GLOBE_VIEW\nout float v_split_fade;\n#endif\nvoid main() {vec2 uv;\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);\n#endif\n#else\nfloat w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    \nv_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\ngl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;\n#ifdef RENDER_CUTOFF\nv_depth=gl_Position.z;\n#endif\n}'),rasterParticle:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;\n#endif\n#ifdef FOG\nhighp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));\n#endif\nglFragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\nuniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;\n#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8\nin vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n#else\nuv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n#endif\nv_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}'),rasterParticleDraw:li("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",'#include "_prelude_raster_particle.glsl"\nin float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(\nmod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}'),rasterParticleTexture:li("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:li('#include "_prelude_raster_particle.glsl"\nuniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(\nlinearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)\n);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}',"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:li('#include "_prelude_lighting.glsl"\n#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;\n#ifdef ICON_TRANSITION\nuniform float u_icon_transition;\n#endif\n#ifdef COLOR_ADJUSTMENT\nuniform mat4 u_color_adj_mat;\n#endif\n#ifdef INDICATOR_CUTOUT\nin highp float v_z_offset;\n#endif\nin vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nin vec2 v_tex_b;\n#endif\nin float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nin float is_sdf;in vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\nvec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];\n#ifdef RENDER_TEXT_AND_SYMBOL\nif (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nreturn;}\n#endif\n#ifdef RENDER_SDF\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;\n#else\n#ifdef ICON_TRANSITION\nvec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);\n#else\nout_color=texture(u_texture,v_tex_a);\n#endif\n#ifdef COLOR_ADJUSTMENT\nout_color=u_color_adj_mat*out_color;\n#endif\n#endif\nout_color*=opacity*fade_opacity;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting_with_emission_ground(out_color,emissive_strength);\n#endif\n#ifdef INDICATOR_CUTOUT\nout_color=applyCutout(out_color,v_z_offset);\n#endif\nglFragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_terrain.vertex.glsl"\nin vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;\n#ifdef Z_OFFSET\nin float a_auto_z_offset;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nin vec3 a_globe_anchor;in vec3 a_globe_normal;\n#endif\n#ifdef ICON_TRANSITION\nin vec2 a_texb;\n#endif\n#ifdef OCCLUSION_QUERIES\nin float a_occlusion_query_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nout highp float v_z_offset;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nout vec2 v_tex_a;\n#ifdef ICON_TRANSITION\nout vec2 v_tex_b;\n#endif\nout float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;\n#ifdef RENDER_TEXT_AND_SYMBOL\nout float is_sdf;out vec2 v_tex_a_icon;\n#endif\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\n#pragma mapbox: define lowp float emissive_strength\n#pragma mapbox: define lowp float occlusion_opacity\n#pragma mapbox: define lowp float z_offset\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\n#pragma mapbox: initialize lowp float emissive_strength\n#pragma mapbox: initialize lowp float occlusion_opacity\n#pragma mapbox: initialize lowp float z_offset\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);\n#ifdef Z_OFFSET\ne+=a_auto_z_offset;\n#endif\nvec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;\n#endif\nvec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\n#ifdef Z_OFFSET\nz+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#else\nz+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;\n#endif\nfloat occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;\n#ifdef DEPTH_OCCLUSION\nfloat depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;\n#endif\n#ifdef OCCLUSION_QUERIES\nfloat occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;\n#endif\nfloat alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);\n#endif\nfloat gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;\n#ifdef RENDER_TEXT_AND_SYMBOL\nis_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;\n#endif\n#ifdef ICON_TRANSITION\nv_tex_b=a_texb/u_texsize;\n#endif\n#ifdef INDICATOR_CUTOUT\nv_z_offset=e;\n#endif\n}'),terrainRaster:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;in vec2 v_pos0;\n#ifdef FOG\nin float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nin vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;\n#endif\nuniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;\n#ifdef LIGHTING_3D_MODE\nconst vec3 normal=vec3(0.0,0.0,1.0);\n#ifdef RENDER_SHADOWS\nfloat cutoffOpacity=1.0;\n#ifdef RENDER_CUTOFF\ncutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);\n#endif\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nvec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;\n#else\nfloat lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));\n#endif\n#else\nfloat lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;\n#endif\n#endif\n#else\ncolor=image_color;\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\nglFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;\n#ifdef FOG\nout float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;\n#endif\nvoid main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);\n#endif\n}'),terrainDepth:li("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",'#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}'),skybox:li('#include "_prelude_fog.fragment.glsl"\nin lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Rl),skyboxGradient:li('#include "_prelude_fog.fragment.glsl"\nin highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\n}',Rl),skyboxCapture:li("\nin highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}","in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\nraster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);\n#else\nraster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=vec4(raster.rgb*antialias,raster.a*antialias);\n#endif\n#else\ncolor=texture(u_image0,v_pos0);\n#ifdef LIGHTING_3D_MODE\n#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS\ncolor=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;\n#else\ncolor=apply_lighting_ground(color);\n#endif\n#endif\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ncolor*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_terrain.vertex.glsl"\nuniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nin vec3 a_globe_pos;in vec2 a_uv;\n#else\nin vec2 a_pos;\n#endif\nout vec2 v_pos0;void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);globe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}'),globeAtmosphere:li('#include "_prelude_fog.fragment.glsl"\nuniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {\n#ifdef ALPHA_PASS\nglFragColor=vec4(0,0,0,0);return;\n#else\n#ifdef NATIVE\nglFragColor=vec4(1,1,1,1);\n#else\nglFragColor=vec4(0,0,0,1);\n#endif\nreturn;\n#endif\n}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;\n#ifdef ALPHA_PASS\nfloat a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);\n#else\nvec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;\n#ifndef NATIVE\nc=dither(c,gl_FragCoord.xy+u_temporal_offset);\n#endif\nglFragColor=vec4(c*t,t);\n#endif\n}',"in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}"),model:li('#include "_prelude_fog.fragment.glsl"\n#include "_prelude_shadow.fragment.glsl"\n#include "_prelude_lighting.glsl"\nuniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;\n#ifdef RENDER_SHADOWS\nin highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;\n#endif\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nuniform vec4 u_occlusionTextureTransform;\n#endif\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#ifdef HAS_ATTRIBUTE_a_pbr\nin lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;\n#endif\n#ifdef HAS_TEXTURE_u_baseColorTexture\nuniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;\n#endif\n#ifdef HAS_TEXTURE_u_metallicRoughnessTexture\nuniform sampler2D u_metallicRoughnessTexture;\n#endif\n#ifdef HAS_TEXTURE_u_occlusionTexture\nuniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;\n#endif\n#ifdef HAS_TEXTURE_u_normalTexture\nuniform sampler2D u_normalTexture;\n#endif\n#ifdef HAS_TEXTURE_u_emissionTexture\nuniform sampler2D u_emissionTexture;\n#endif\n#ifdef APPLY_LUT_ON_GPU\nuniform highp sampler3D u_lutTexture;\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nin highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;\n#ifdef DEPTH_D24\nhighp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}\n#else\nhighp float unpack_depth_rgba(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}\n#endif\nbool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;\n#ifdef DEPTH_D24\nhighp float depth=unpack_depth(texture(u_depthTexture,coord).r);\n#else\nhighp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));\n#endif\nreturn v_depth > depth+0.0005;}\n#endif\n#define saturate(_x) clamp(_x,0.,1.)\nvec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)\n{\n#ifdef LIGHTING_3D_MODE\nvec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));\n#endif\nreturn apply_lighting(albedo,transformed_normal,lighting_factor);\n#else\nvec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;\n#endif\n}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;\n#ifdef HAS_ATTRIBUTE_a_color_3f\nalbedo*=vec4(color_3f,1.0);\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#else\n#ifdef HAS_ATTRIBUTE_a_color_4f\nalbedo*=color_4f;\n#endif\n#endif\n#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)\nvec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}\n#ifdef UNPREMULT_TEXTURE_IN_SHADER\nif(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;\n#endif\nif(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}\n#endif\nvec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);\n#ifdef APPLY_LUT_ON_GPU\ncolor=applyLUT(u_lutTexture,color);\n#endif\nreturn color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {\n#ifdef HAS_TEXTURE_u_normalTexture\nhighp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;\n#else\nreturn mat3(1.0);\n#endif\n}highp vec3 getNormal(){highp vec3 n;\n#ifdef HAS_ATTRIBUTE_a_normal_3f\nn=normalize(normal_3f);\n#else\nhighp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;\n#endif\n#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nvec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);\n#endif\nreturn n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;\n#ifdef HAS_ATTRIBUTE_a_pbr\nmat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;\n#endif\n#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) \nvec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;\n#endif\nconst float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)\n{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)\n{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)\n{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)\n{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)\n{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)\n{\n#ifdef LIGHTING_3D_MODE\nreturn mat.diffuseColor;\n#else\nreturn mat.diffuseColor/PI;\n#endif\n}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)\n{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)\n{vec3 env_light=vec3(0.65,0.65,0.65);\n#ifdef LIGHTING_3D_MODE\nfloat ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;\n#endif\nvec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)\n{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;\n#ifdef RENDER_SHADOWS\nlighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);\n#else\nlighting_factor=NdotL;\n#endif\nvec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;\n#if !defined(LIGHTING_3D_MODE)\nconst vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);\n#endif\ncolor*=intensityFactor;return color;}void main() {\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nif (isOccluded()) {discard;}\n#endif\nvec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;\n#ifdef LIGHTING_3D_MODE\nlightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;\n#endif\nvec4 finalColor;\n#ifdef DIFFUSE_SHADED\nvec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);\n#ifdef HAS_TEXTURE_u_occlusionTexture\nfloat ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;\n#endif\nfinalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;\n#else\nMaterial mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;\n#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\n#ifdef OCCLUSION_TEXTURE_TRANSFORM\nvec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;\n#else\nvec2 uv=uv_2f;\n#endif\nao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;\n#endif\nvec4 emissive=u_emissiveFactor;\n#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)\nemissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);\n#endif\n#ifdef APPLY_LUT_ON_GPU\nfloat emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;\n#endif\ncolor+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;\n#ifdef HAS_ATTRIBUTE_a_pbr\nfloat resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;\n#ifdef APPLY_LUT_ON_GPU\ncolor_mix=applyLUT(u_lutTexture,color_mix);\n#endif\ncolor=mix(color,color_mix,min(1.0,resEmission));\n#ifdef HAS_ATTRIBUTE_a_color_4f\nfloat distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);\n#endif\n#endif\nvec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);\n#endif\n#ifdef FOG\nfinalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));\n#endif\n#ifdef RENDER_CUTOFF\nfinalColor*=v_cutoff_opacity;\n#endif\n#ifdef INDICATOR_CUTOUT\nfinalColor=applyCutout(finalColor,v_position_height.w);\n#endif\nglFragColor=finalColor;\n#ifdef OVERDRAW_INSPECTOR\nglFragColor=vec4(1.0);\n#endif\nHANDLE_WIREFRAME_DEBUG;}','#include "_prelude_fog.vertex.glsl"\n#include "_prelude_shadow.vertex.glsl"\nin vec3 a_pos_3f;\n#pragma mapbox: define-attribute highp vec3 normal_3f\n#pragma mapbox: define-attribute highp vec2 uv_2f\n#pragma mapbox: define-attribute highp vec3 color_3f\n#pragma mapbox: define-attribute highp vec4 color_4f\n#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr\n#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength\nuniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_normal_matrix;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;\n#endif\nout vec4 v_position_height;out lowp vec4 v_color_mix;\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nout highp float v_depth;\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\nout lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;\n#endif\nvec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {\n#pragma mapbox: initialize-attribute highp vec3 normal_3f\n#pragma mapbox: initialize-attribute highp vec2 uv_2f\n#pragma mapbox: initialize-attribute highp vec3 color_3f\n#pragma mapbox: initialize-attribute highp vec4 color_4f\n#pragma mapbox: initialize-attribute-custom highp vec4 pbr\n#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength\nhighp mat4 normal_matrix;\n#ifdef INSTANCED_ARRAYS\nnormal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\nnormal_matrix=u_normal_matrix;\n#endif\nvec3 local_pos;mat3 rs;\n#ifdef MODEL_POSITION_ON_GPU\nvec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;\n#else\nlocal_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);\n#endif\nv_position_height.w=a_pos_3f.z;\n#ifdef HAS_ATTRIBUTE_a_pbr\nvec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(local_pos);\n#endif\n#ifdef RENDER_CUTOFF\nv_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);\n#endif\n#ifdef TERRAIN_FRAGMENT_OCCLUSION\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nfloat x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);\n#else\nnormal_3f=vec3(normal_matrix*vec4(normal_3f,0));\n#endif\n#endif\n#ifdef HAS_ATTRIBUTE_a_pbr\n#ifdef HAS_ATTRIBUTE_a_color_4f\nv_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);\n#ifdef NORMAL_OFFSET\n#ifdef HAS_ATTRIBUTE_a_normal_3f\n#ifdef MODEL_POSITION_ON_GPU\nvec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#else\nvec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();\n#endif\n#endif\n#endif\nv_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;\n#endif\n}'),modelDepth:li("in highp float v_depth;void main() {\n#ifndef DEPTH_TEXTURE\nglFragColor=pack_depth(v_depth);\n#endif\n}","in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;\n#ifdef MODEL_POSITION_ON_GPU\n#ifdef INSTANCED_ARRAYS\nin vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;\n#else\nuniform highp mat4 u_instance;\n#endif\nuniform highp mat4 u_node_matrix;\n#endif\nvoid main() {\n#ifdef MODEL_POSITION_ON_GPU\nhighp mat4 instance;\n#ifdef INSTANCED_ARRAYS\ninstance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);\n#else\ninstance=u_instance;\n#endif\nvec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);\n#else\ngl_Position=u_matrix*vec4(a_pos_3f,1);\n#endif\nv_depth=gl_Position.z/gl_Position.w;}"),stars:li("in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)\n{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}","\nin vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}"),snowParticle:li("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}","\nin highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; \nuniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; \nuniform float u_horizontalOscillationRate; \nuniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+\nlocalY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}"),rainParticle:li("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}","\nin highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; \nuniform float u_velocity; \nuniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; \npos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+\nlocalY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}"),vignette:li("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:li("uniform vec4 u_color;void main() {glFragColor=u_color;}",'#include "_prelude_terrain.vertex.glsl"\nin highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;\n#ifdef TERRAIN\nfloat e=elevation(world_pos.xy);world_pos.z+=e;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}')};function Ad(m,s){const c=m.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let g of c)if(g=g.trim(),"#"===g[0]&&g.includes("if")&&!g.includes("endif")){g=g.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const b=g.split(" ");for(const x of b)s.includes(x)||s.push(x)}}function li(m,s){const c=/#include\s+"([^"]+)"/g,g=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let b=s.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);b&&(b=b.map(N=>{const z=N.split(" ");return z[z.length-1]}),b=[...new Set(b)]);const x={},M=[],A=[];if(m=m.replace(c,(N,z)=>(A.push(z),"")),(s=s.replace(c,(N,z)=>(M.push(z),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let F=[...Wc];Ad(m,F),Ad(s,F);for(const N of[...M,...A])Nu[N]||console.error(`Undefined include: ${N}`),Pl[N]||(Pl[N]=[],Ad(Nu[N],Pl[N])),F=[...F,...Pl[N]];return{fragmentSource:m=m.replace(g,(N,z,H,j,G)=>(x[G]=!0,"define"===z?`\n#ifndef HAS_UNIFORM_u_${G}\nin ${H} ${j} ${G};\n#else\nuniform ${H} ${j} u_${G};\n#endif\n`:"initialize"===z?`\n#ifdef HAS_UNIFORM_u_${G}\n    ${H} ${j} ${G} = u_${G};\n#endif\n`:"define-attribute"===z?`\n#ifdef HAS_ATTRIBUTE_a_${G}\n    in ${H} ${j} ${G};\n#endif\n`:"initialize-attribute"===z?"":void 0)),vertexSource:s=s.replace(g,(N,z,H,j,G)=>{const J="float"===j?"vec2":j,Q=G.match(/color/)?"color":J;return"define-attribute-vertex-shader-only"===z?`\n#ifdef HAS_ATTRIBUTE_a_${G}\nin ${H} ${j} a_${G};\n#endif\n`:x[G]?"define"===z?`\n#ifndef HAS_UNIFORM_u_${G}\nuniform lowp float u_${G}_t;\nin ${H} ${J} a_${G};\nout ${H} ${j} ${G};\n#else\nuniform ${H} ${j} u_${G};\n#endif\n`:"initialize"===z?"vec4"===Q?`\n#ifndef HAS_UNIFORM_u_${G}\n    ${G} = a_${G};\n#else\n    ${H} ${j} ${G} = u_${G};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${G}\n    ${G} = unpack_mix_${Q}(a_${G}, u_${G}_t);\n#else\n    ${H} ${j} ${G} = u_${G};\n#endif\n`:"define-attribute"===z?`\n#ifdef HAS_ATTRIBUTE_a_${G}\n    in ${H} ${j} a_${G};\n    out ${H} ${j} ${G};\n#endif\n`:"initialize-attribute"===z?`\n#ifdef HAS_ATTRIBUTE_a_${G}\n    ${G} = a_${G};\n#endif\n`:void 0:"define"===z?`\n#ifndef HAS_UNIFORM_u_${G}\nuniform lowp float u_${G}_t;\nin ${H} ${J} a_${G};\n#else\nuniform ${H} ${j} u_${G};\n#endif\n`:"define-instanced"===z?"mat4"===Q?`\n#ifdef INSTANCED_ARRAYS\nin vec4 a_${G}0;\nin vec4 a_${G}1;\nin vec4 a_${G}2;\nin vec4 a_${G}3;\n#else\nuniform ${H} ${j} u_${G};\n#endif\n`:`\n#ifdef INSTANCED_ARRAYS\nin ${H} ${J} a_${G};\n#else\nuniform ${H} ${j} u_${G};\n#endif\n`:"initialize-attribute-custom"===z?`\n#ifdef HAS_ATTRIBUTE_a_${G}\n    ${H} ${j} ${G} = a_${G};\n#endif\n`:"vec4"===Q?`\n#ifndef HAS_UNIFORM_u_${G}\n    ${H} ${j} ${G} = a_${G};\n#else\n    ${H} ${j} ${G} = u_${G};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${G}\n    ${H} ${j} ${G} = unpack_mix_${Q}(a_${G}, u_${G}_t);\n#else\n    ${H} ${j} ${G} = u_${G};\n#endif\n`}),staticAttributes:b,usedDefines:F,vertexIncludes:M,fragmentIncludes:A}}class Rd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(s,c,g,b,x,M,A,F){this.context=s;let N=this.boundPaintVertexBuffers.length!==b.length;for(let H=0;!N&&H<b.length;H++)this.boundPaintVertexBuffers[H]!==b[H]&&(N=!0);let z=this.boundDynamicVertexBuffers.length!==A.length;for(let H=0;!z&&H<A.length;H++)this.boundDynamicVertexBuffers[H]!==A[H]&&(z=!0);if(!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==g||N||z||this.boundIndexBuffer!==x||this.boundVertexOffset!==M)this.freshBind(c,g,b,x,M,A,F);else{s.bindVertexArrayOES.set(this.vao);for(const H of A)H&&(H.bind(),F&&H.instanceCount&&H.setVertexAttribDivisor(s.gl,c,F));x&&x.dynamicDraw&&x.bind()}}freshBind(s,c,g,b,x,M,A){const F=s.numAttributes,N=this.context,z=N.gl;this.vao&&this.destroy(),this.vao=N.gl.createVertexArray(),N.bindVertexArrayOES.set(this.vao),this.boundProgram=s,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=g,this.boundIndexBuffer=b,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=M,c.enableAttributes(z,s),c.bind(),c.setVertexAttribPointers(z,s,x);for(const H of g)H.enableAttributes(z,s),H.bind(),H.setVertexAttribPointers(z,s,x);for(const H of M)H&&(H.enableAttributes(z,s),H.bind(),H.setVertexAttribPointers(z,s,x),A&&H.instanceCount&&H.setVertexAttribDivisor(z,s,A));b&&b.bind(),N.currentNumAttributes=F}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function vb(m,s){const c=Math.pow(2,s.canonical.z),g=s.canonical.y;return[new f.aa(0,g/c).toLngLat().lat,new f.aa(0,(g+1)/c).toLngLat().lat]}function lg(m,s,c,g,b,x,M){const A=m.context,F=A.gl,N=c.hillshadeFBO;if(!N)return;m.prepareDrawTile();const z=m.isTileAffectedByFog(s),H=m.getOrCreateProgram("hillshade",{overrideFog:z});A.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,N.colorAttachment.get());const j=((te,ne,le,me)=>{const pe=le.paint.get("hillshade-shadow-color"),xe="none"===le.paint.get("hillshade-shadow-color-use-theme").constantOr("default"),ve=le.paint.get("hillshade-highlight-color"),be="none"===le.paint.get("hillshade-highlight-color-use-theme").constantOr("default"),ye=le.paint.get("hillshade-accent-color"),Ee="none"===le.paint.get("hillshade-accent-color-use-theme").constantOr("default"),Re=le.paint.get("hillshade-emissive-strength");let Xe=f.ai(le.paint.get("hillshade-illumination-direction"));if("viewport"===le.paint.get("hillshade-illumination-anchor"))Xe-=te.transform.angle;else if(te.style&&te.style.enable3dLights()&&te.style.directionalLight){const Ae=te.style.directionalLight.properties.get("direction"),Be=f.cb(Ae.x,Ae.y,Ae.z);Xe=f.ai(Be[1])}const qe=!te.options.moving;return{u_matrix:me||te.transform.calculateProjMatrix(ne.tileID.toUnwrapped(),qe),u_image:0,u_latrange:vb(0,ne.tileID),u_light:[le.paint.get("hillshade-exaggeration"),Xe],u_shadow:pe.toRenderColor(xe?null:le.lut),u_highlight:ve.toRenderColor(be?null:le.lut),u_emissive_strength:Re,u_accent:ye.toRenderColor(Ee?null:le.lut)}})(m,c,g,m.terrain?s.projMatrix:null);m.uploadCommonUniforms(A,H,s.toUnwrapped());const{tileBoundsBuffer:G,tileBoundsIndexBuffer:J,tileBoundsSegments:Q}=m.getTileBoundsBuffers(c);H.draw(m,F.TRIANGLES,b,x,M,mn.disabled,j,g.id,G,J,Q)}function rf(m,s,c){if(!s.needsDEMTextureUpload)return;const g=m.context,b=g.gl;g.pixelStoreUnpackPremultiplyAlpha.set(!1),s.demTexture=s.demTexture||m.getTileTexture(c.stride);const x=c.getPixels();s.demTexture?s.demTexture.update(x,{premultiply:!1}):s.demTexture=new f.T(g,x,b.R32F,{premultiply:!1}),s.needsDEMTextureUpload=!1}function Eo(m,s,c){const g=m.context,b=g.gl;if(!s.dem)return;const x=s.dem;if(g.activeTexture.set(b.TEXTURE1),rf(m,s,x),!s.demTexture)return;s.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE);const M=x.dim;g.activeTexture.set(b.TEXTURE0);let A=s.hillshadeFBO;if(!A){const j=new f.T(g,{width:M,height:M,data:null},b.RGBA8);j.bind(b.LINEAR,b.CLAMP_TO_EDGE),A=s.hillshadeFBO=g.createFramebuffer(M,M,!0,"renderbuffer"),A.colorAttachment.set(j.texture)}g.bindFramebuffer.set(A.framebuffer),g.viewport.set([0,0,M,M]);const{tileBoundsBuffer:F,tileBoundsIndexBuffer:N,tileBoundsSegments:z}=m.getMercatorTileBoundsBuffers(),H=[];m.linearFloatFilteringSupported()&&H.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:H}).draw(m,b.TRIANGLES,on.disabled,Tn.disabled,An.unblended,mn.disabled,((j,G)=>{const J=G.stride,Q=f.ab.mat4.create();return f.ab.mat4.ortho(Q,0,f.ag,-f.ag,0,0,1),f.ab.mat4.translate(Q,Q,[0,-f.ag,0]),{u_matrix:Q,u_image:1,u_dimension:[J,J],u_zoom:j.overscaledZ}})(s.tileID,x),c.id,F,N,z),s.needsHillshadePrepare=!1}class tr{constructor(s){this.gl=s.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(s){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class W_ extends tr{getDefault(){return f.aj.transparent}set(s){const c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.clearColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class fw extends tr{getDefault(){return 1}set(s){(s!==this.current||this.dirty)&&(this.gl.clearDepth(s),this.current=s,this.dirty=!1)}}class pw extends tr{getDefault(){return 0}set(s){(s!==this.current||this.dirty)&&(this.gl.clearStencil(s),this.current=s,this.dirty=!1)}}class cg extends tr{getDefault(){return[!0,!0,!0,!0]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.colorMask(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class zu extends tr{getDefault(){return!0}set(s){(s!==this.current||this.dirty)&&(this.gl.depthMask(s),this.current=s,this.dirty=!1)}}class Pd extends tr{getDefault(){return 255}set(s){(s!==this.current||this.dirty)&&(this.gl.stencilMask(s),this.current=s,this.dirty=!1)}}class Z_ extends tr{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(s){const c=this.current;(s.func!==c.func||s.ref!==c.ref||s.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(s.func,s.ref,s.mask),this.current=s,this.dirty=!1)}}class bb extends tr{getDefault(){const s=this.gl;return[s.KEEP,s.KEEP,s.KEEP]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(s[0],s[1],s[2]),this.current=s,this.dirty=!1)}}class xb extends tr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=s,this.dirty=!1}}class Y_ extends tr{getDefault(){return[0,1]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||this.dirty)&&(this.gl.depthRange(s[0],s[1]),this.current=s,this.dirty=!1)}}class As extends tr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=s,this.dirty=!1}}class sf extends tr{getDefault(){return this.gl.LESS}set(s){(s!==this.current||this.dirty)&&(this.gl.depthFunc(s),this.current=s,this.dirty=!1)}}class Bu extends tr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.BLEND):c.disable(c.BLEND),this.current=s,this.dirty=!1}}class Jo extends tr{getDefault(){const s=this.gl;return[s.ONE,s.ZERO,s.ONE,s.ZERO]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.blendFuncSeparate(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class X_ extends tr{getDefault(){return f.aj.transparent}set(s){const c=this.current;(s.r!==c.r||s.g!==c.g||s.b!==c.b||s.a!==c.a||this.dirty)&&(this.gl.blendColor(s.r,s.g,s.b,s.a),this.current=s,this.dirty=!1)}}class dg extends tr{getDefault(){return this.gl.FUNC_ADD}set(s){(s!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(s,s),this.current=s,this.dirty=!1)}}class Do extends tr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;s?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=s,this.dirty=!1}}class ug extends tr{getDefault(){return this.gl.BACK}set(s){(s!==this.current||this.dirty)&&(this.gl.cullFace(s),this.current=s,this.dirty=!1)}}class K_ extends tr{getDefault(){return this.gl.CCW}set(s){(s!==this.current||this.dirty)&&(this.gl.frontFace(s),this.current=s,this.dirty=!1)}}let Od=class extends tr{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Q_ extends tr{getDefault(){return this.gl.TEXTURE0}set(s){(s!==this.current||this.dirty)&&(this.gl.activeTexture(s),this.current=s,this.dirty=!1)}}class J_ extends tr{getDefault(){const s=this.gl;return[0,0,s.drawingBufferWidth,s.drawingBufferHeight]}set(s){const c=this.current;(s[0]!==c[0]||s[1]!==c[1]||s[2]!==c[2]||s[3]!==c[3]||this.dirty)&&(this.gl.viewport(s[0],s[1],s[2],s[3]),this.current=s,this.dirty=!1)}}class hg extends tr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,s),this.current=s,this.dirty=!1}}class wb extends tr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Cb extends tr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,s),this.current=s,this.dirty=!1}}class af extends tr{getDefault(){return null}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class ey extends tr{getDefault(){return null}set(s){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,s),this.current=s,this.dirty=!1}}class fg extends tr{getDefault(){return null}set(s){this.gl&&(s!==this.current||this.dirty)&&(this.gl.bindVertexArray(s),this.current=s,this.dirty=!1)}}class Jr extends tr{getDefault(){return 4}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,s),this.current=s,this.dirty=!1}}class Jt extends tr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s),this.current=s,this.dirty=!1}}class Wn extends tr{getDefault(){return!1}set(s){if(s===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,s),this.current=s,this.dirty=!1}}class ao extends tr{constructor(s,c){super(s),this.context=s,this.parent=c}getDefault(){return null}}class cs extends ao{setDirty(){this.dirty=!0}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Oo extends ao{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,s),this.current=s,this.dirty=!1}}class Rs extends ao{attachment(){return this.gl.DEPTH_ATTACHMENT}set(s){if(s===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,this.attachment(),c.TEXTURE_2D,s,0),this.current=s,this.dirty=!1}}class Ol extends Oo{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const Vr=(m,s,c)=>({u_matrix:m,u_image0:0,u_skirt_height:s,u_ground_shadow_factor:c}),mo=(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:s,u_normalize_matrix:Float32Array.from(g),u_merc_matrix:c,u_zoom_transition:b,u_merc_center:x,u_image0:0,u_frustum_tl:M,u_frustum_tr:A,u_frustum_br:F,u_frustum_bl:N,u_globe_pos:z,u_globe_radius:H,u_viewport:j,u_grid_matrix:Q?Float32Array.from(Q):new Float32Array(9),u_skirt_height:G,u_far_z_cutoff:J});function ul(m,s){return null!=m&&null!=s&&!(!m.hasData()||!s.hasData())&&null!=m.demTexture&&null!=s.demTexture&&m.tileID.key!==s.tileID.key}const ti=new class{constructor(){this.operations={}}newMorphing(m,s,c,g,b){if(m in this.operations){const x=this.operations[m];x.to.tileID.key!==c.tileID.key&&(x.queued=c)}else this.operations[m]={startTime:g,phase:0,duration:b,from:s,to:c,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const s=this.operations[m];return{from:s.from,to:s.to,phase:s.phase}}update(m){for(const s in this.operations){const c=this.operations[s];for(c.phase=(m-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,m)){delete this.operations[s];break}}}_nextOp(m,s){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=s,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},wa={0:null,1:"TERRAIN_VERTEX_MORPHING"};function lf(m,s,c){if(0===s)return 0;const g=s<1&&514===c?.25/s:1;return 6*Math.pow(1.5,22-m)*Math.max(s,1)*g}function Ua(m,s){const c=1<<m.z;return!s&&(0===m.x||m.x===c-1)||0===m.y||m.y===c-1}const Ur=m=>({u_matrix:m});function hl(m,s,c,g,b){if(b>0){const x=f.q.now(),M=(x-m.timeAdded)/b,A=s?(x-s.timeAdded)/b:-1,F=c.getSource(),N=g.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),z=!s||Math.abs(s.tileID.overscaledZ-N)>Math.abs(m.tileID.overscaledZ-N),H=z&&m.refreshedUponExpiration?1:f.aw(z?M:1-A,0,1);return m.refreshedUponExpiration&&M>=1&&(m.refreshedUponExpiration=!1),s?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}class Vu extends sl{constructor(s){const c={type:"raster-dem",maxzoom:s.transform.maxZoom},g=new f.D(f.ci(),null),b=xr("mock-dem",c,g,s.style);super("mock-dem",b,!1),b.setEventedParent(this),this._sourceLoaded=!0}_loadTile(s,c){s.state="loaded",c(null)}}class gc extends sl{constructor(s){const c=xr("proxy",{type:"geojson",maxzoom:s.transform.maxZoom},new f.D(f.ci(),null),s.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=s,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(s,c,g){if(s.freezeTileCoverage)return;this.transform=s;const b=s.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,M)=>{if(x[M.key]="",!this._tiles[M.key]){const A=new Mu(M,this._source.tileSize*M.overscaleFactor(),s.tileZoom);A.state="loaded",this._tiles[M.key]=A}return x},{});for(const x in this._tiles)x in b||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(s){const c=this.proxyCachedFBO[s];if(void 0!==c){const g=Object.values(c);this.renderCachePool.push(...g),delete this.proxyCachedFBO[s]}}deallocRenderCache(){this.renderCache.forEach(s=>s.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Yc extends f.aG{constructor(s,c,g){super(s.overscaledZ,s.wrap,s.canonical.z,s.canonical.x,s.canonical.y),this.proxyTileKey=c,this.projMatrix=g}}class vp extends f.cJ{constructor(s,c){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},s.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),s.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=s,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[g,b,x]=function(){const N=new f.b4,z=new f.aU,H=131;N.reserve(17161),z.reserve(33800);const j=f.ag/128,G=f.ag+j/2,J=G+j;for(let te=-j;te<J;te+=j)for(let ne=-j;ne<J;ne+=j){const le=ne<0||ne>G||te<0||te>G?24575:0,me=f.aw(Math.round(ne),0,f.ag),pe=f.aw(Math.round(te),0,f.ag);N.emplaceBack(me+le,pe)}const Q=(te,ne)=>{const le=ne*H+te;z.emplaceBack(le+1,le,le+H),z.emplaceBack(le+H,le+H+1,le+1)};for(let te=1;te<129;te++)for(let ne=1;ne<129;ne++)Q(ne,te);return[0,129].forEach(te=>{for(let ne=0;ne<130;ne++)Q(ne,te),Q(te,ne)}),[N,z,32768]}(),M=s.context;this.gridBuffer=M.createVertexBuffer(g,f.b6.members),this.gridIndexBuffer=M.createIndexBuffer(b),this.gridSegments=f.b7.simpleSegment(0,0,g.length,b.length),this.gridNoSkirtSegments=f.b7.simpleSegment(0,0,g.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new gc(c.map),this.orthoMatrix=f.ab.mat4.create(),f.ab.mat4.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,f.ag,0,f.ag,0,1);const A=M.gl;this._overlapStencilMode=new Tn({func:A.GEQUAL,mask:255},0,255,A.KEEP,A.KEEP,A.REPLACE),this._previousZoom=s.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Vu(c.map),this._pendingGroundEffectLayers=[]}set style(s){s.on("data",this._onStyleDataEvent.bind(this)),this._style=s,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(s,c,g){if(s&&s.terrain){this._style!==s&&(this.style=s,this._evaluationZoom=void 0);const b=s.terrain.properties,x=0===s.terrain.drapeRenderMode,M=s.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=f.q.now();const A=s.terrain&&s.terrain.scope,F=b.get("source"),N=x?this._mockSourceCache:s.getSourceCache(F,A);if(!N)return void f.w(`Couldn't find terrain source "${F}".`);if(this.sourceCache=N,this._attenuationRange=s.terrain.getAttenuationRange(),this._exaggeration=M?this.calculateExaggeration(c):b.get("exaggeration"),!c.projection.requiresDraping&&M&&0===this._exaggeration)return void this._disable();this.enabled=!0;const z=()=>{this.sourceCache.used&&f.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const H=this.getScaledDemTileSize();this.sourceCache.update(c,H,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,z(),this._initializing=!0),z(),c.updateElevation(!0,g),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0,this._previousZoom=c.zoom}else this._disable()}calculateExaggeration(s){if(this._attenuationRange&&s.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(s.zoom);const c=this._previousCameraAltitude,g=s.getFreeCameraOptions().position.z/s.pixelsPerMeter*s.worldSize;this._previousCameraAltitude=g;const b=null!=c?g-c:Number.MAX_VALUE;if(Math.abs(b)<2)return this._exaggeration;const x=s.zoom,M=this._style.terrain;if(!this._previousUpdateTimestamp)return M.getExaggeration(x);let A=x-this._previousZoom;const F=this._previousUpdateTimestamp;let N=x;null!=this._evaluationZoom&&(N=this._evaluationZoom,Math.abs(x-N)>.5&&(A=.5*(x-N+A)),A*b<0&&(N+=A)),this._evaluationZoom=N;const z=M.getExaggeration(N),H=z===M.getExaggeration(Math.max(0,N-.1));if(H&&Math.abs(z-this._exaggeration)<.01)return z;let j=Math.min(.1,.00375*(this._updateTimestamp-F));return(H||z<.1||Math.abs(A)<1e-4)&&(j=Math.min(.2,4*j)),f.af(this._exaggeration,z,j)}resetTileLookupCache(s){this._findCoveringTileCache[s]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(s){s.coord&&"source"===s.dataType?this._clearRenderCacheForTile(s.sourceCacheId,s.coord):"style"===s.dataType&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const s in this._style._mergedSourceCaches)this._style._mergedSourceCaches[s].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(s=>s.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const s=2*this.proxySourceCache.getSource().tileSize;return[s,s]}set useVertexMorphing(s){this._useVertexMorphing=s}updateTileBinding(s){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,g=this.painter.transform;this._initializing&&(this._initializing=0===g._centerAltitude&&-1===this.getAtPointOrZero(f.aa.fromLngLat(g.center),-1),this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=c.getIds().map(F=>{const N=c.getTileByID(F).tileID;return N.projMatrix=g.calculateProjMatrix(N.toUnwrapped()),N});!function(F,N){const z=N.transform.pointCoordinate(N.transform.getCameraPoint()),H=new f.P(z.x,z.y);F.sort((j,G)=>{if(G.overscaledZ-j.overscaledZ)return G.overscaledZ-j.overscaledZ;const J=new f.P(j.canonical.x+(1<<j.canonical.z)*j.wrap,j.canonical.y),Q=new f.P(G.canonical.x+(1<<G.canonical.z)*G.wrap,G.canonical.y),te=H.mult(1<<j.canonical.z);return te.x-=.5,te.y-=.5,te.distSqr(J)-te.distSqr(Q)})}(b,this.painter);const x=this.proxyToSource||{};this.proxyToSource={},b.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};const M=this._style._mergedSourceCaches;for(const F in M){const N=M[F];if(!N.used||(N!==this.sourceCache&&this.resetTileLookupCache(N.id),this._setupProxiedCoordsForOrtho(N,s[F],x),N.usedForTerrain))continue;const z=s[F];N.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[c.id]=b.map(F=>new Yc(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1;const A={};this._visibleDemTiles=[];for(const F of this.proxyCoords){const N=this.terrainTileForTile[F.key];if(!N)continue;const z=N.tileID.key;z in A||(this._visibleDemTiles.push(N),A[z]=z)}}_assignTerrainTiles(s){this._initializing||s.forEach(c=>{if(this.terrainTileForTile[c.key])return;const g=this._findTileCoveringTileID(c,this.sourceCache);g&&(this.terrainTileForTile[c.key]=g)})}_prepareDEMTextures(){const s=this.painter.context,c=s.gl;for(const g in this.terrainTileForTile){const b=this.terrainTileForTile[g],x=b.dem;!x||b.demTexture&&!b.needsDEMTextureUpload||(s.activeTexture.set(c.TEXTURE1),rf(this.painter,b,x))}}_prepareDemTileUniforms(s,c,g,b){if(!c||null==c.demTexture)return!1;const x=s.tileID.canonical,M=Math.pow(2,c.tileID.canonical.z-x.z),A=b||"";return g[`u_dem_tl${A}`]=[x.x*M%1,x.y*M%1],g[`u_dem_scale${A}`]=M,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let s=0;const c=this._visibleDemTiles.reduce((g,b)=>{if(!b.dem)return g;const x=b.dem.tree.minimums[0];return x>0&&s++,g+x},0);return s?c/s:0}_updateEmptyDEMTexture(){const s=this.painter.context,c=s.gl;s.activeTexture.set(c.TEXTURE2);const g=this._getLoadedAreaMinimum(),b=new f.cK({width:1,height:1},new Float32Array([g]));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(b,{premultiply:!1}):x=this._emptyDEMTexture=new f.T(s,b,c.R32F,{premultiply:!1}),x}setupElevationDraw(s,c,g){const b=this.painter.context,x=b.gl,M={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};M.u_exaggeration=this.exaggeration();let A=null,F=null,N=1;if(g&&g.morphing&&this._useVertexMorphing){const G=g.morphing.srcDemTile,J=g.morphing.dstDemTile;N=g.morphing.phase,G&&J&&(this._prepareDemTileUniforms(s,G,M,"_prev")&&(F=G),this._prepareDemTileUniforms(s,J,M)&&(A=J))}const z=G=>G&&G.demTexture&&this.painter.linearFloatFilteringSupported()?x.LINEAR:x.NEAREST;let H=null;var j;if(this.enabled?F&&A?(H=A.demTexture,b.activeTexture.set(x.TEXTURE4),F.demTexture.bind(z(F),x.CLAMP_TO_EDGE),M.u_dem_lerp=N):(A=this.terrainTileForTile[s.tileID.key],H=this._prepareDemTileUniforms(s,A,M)?A.demTexture:this.emptyDEMTexture):H=this.emptyDEMTexture,b.activeTexture.set(x.TEXTURE2),H&&(M.u_dem_size=1===(j=H).size[0]?1:j.size[0]-2,H.bind(z(A),x.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(g&&g.useDepthForOcclusion,c,M),g&&g.useMeterToDem&&A){const G=(1<<A.tileID.canonical.z)*f.bH(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;M.u_meter_to_dem=G}if(g&&g.labelPlaneMatrixInv&&(M.u_label_plane_matrix_inv=g.labelPlaneMatrixInv),c.setTerrainUniformValues(b,M),"globe"===this.painter.transform.projection.name){const G=this.globeUniformValues(this.painter.transform,s.tileID.canonical,g&&g.useDenormalizedUpVectorScale);c.setGlobeUniformValues(b,G)}}globeUniformValues(s,c,g){const b=s.projection;return{u_tile_tl_up:b.upVector(c,0,0),u_tile_tr_up:b.upVector(c,f.ag,0),u_tile_br_up:b.upVector(c,f.ag,f.ag),u_tile_bl_up:b.upVector(c,0,f.ag),u_tile_up_scale:g?f.cL(1):b.upVectorScale(c,s.center.lat,s.worldSize).metersToTile}}renderToBackBuffer(s){const c=this.painter,g=this.painter.context;0!==s.length&&(g.bindFramebuffer.set(null),g.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(b,x,M,A,F){if("globe"===b.transform.projection.name)!function(N,z,H,j,G){const J=N.context,Q=J.gl;let te,ne;const le=N.transform,me=f.cC(N,J,le),pe=(Ae,Be)=>{if(ne===Be)return;const Ye=[wa[Be],"PROJECTION_GLOBE_VIEW"];me&&Ye.push("CUSTOM_ANTIALIASING");const pt=N.isTileAffectedByFog(Ae);te=N.getOrCreateProgram("globeRaster",{defines:Ye,overrideFog:pt}),ne=Be},xe=N.colorModeForRenderPass(),ve=new on(Q.LEQUAL,on.ReadWrite,N.depthRangeFor3D);ti.update(G);const be=f.cD(le),ye=[f.at(le.center.lng),f.aA(le.center.lat)],Ee=N.globeSharedBuffers,Re=[le.width*f.q.devicePixelRatio,le.height*f.q.devicePixelRatio],Xe=Float32Array.from(le.globeMatrix),qe={useDenormalizedUpVectorScale:!0};{const Ae=N.transform,Be=lf(Ae.zoom,z.exaggeration(),z.sourceCache._source.tileSize);ne=-1;const Ye=Q.TRIANGLES;for(const pt of j){const Ct=H.getTile(pt),He=Tn.disabled,dt=z.prevTerrainTileForTile[pt.key],Ke=z.terrainTileForTile[pt.key];ul(dt,Ke)&&ti.newMorphing(pt.key,dt,Ke,G,250),J.activeTexture.set(Q.TEXTURE0),Ct.texture&&Ct.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const bt=ti.getMorphValuesForProxy(pt.key),ht=bt?1:0;bt&&f.J(qe,{morphing:{srcDemTile:bt.from,dstDemTile:bt.to,phase:f.cB(bt.phase)}});const st=f.cE(pt.canonical),Pt=f.cF(st.getCenter().lat),Vt=f.cG(pt.canonical,st,Pt,Ae.worldSize/Ae._pixelsPerMercatorPixel),kt=f.bb(f.cH(pt.canonical)),Gt=mo(Ae.expandedFarZProjMatrix,Xe,be,kt,f.ae(Ae.zoom),ye,Ae.frustumCorners.TL,Ae.frustumCorners.TR,Ae.frustumCorners.BR,Ae.frustumCorners.BL,Ae.globeCenterInViewSpace,Ae.globeRadius,Re,Be,Ae._farZ,Vt);if(pe(pt,ht),te&&(z.setupElevationDraw(Ct,te,qe),N.uploadCommonUniforms(J,te,pt.toUnwrapped()),Ee)){const[hn,ln,sn]=Ee.getGridBuffers(Pt,0!==Be);te.draw(N,Ye,ve,He,xe,mn.backCCW,Gt,"globe_raster",hn,ln,sn)}}}if(Ee&&(N.renderDefaultNorthPole||N.renderDefaultSouthPole)){const Ae=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];me&&Ae.push("CUSTOM_ANTIALIASING"),te=N.getOrCreateProgram("globeRaster",{defines:Ae});for(const Be of j){const{x:Ye,y:pt,z:Ct}=Be.canonical,He=0===pt,dt=pt===(1<<Ct)-1,[Ke,bt,ht,st]=Ee.getPoleBuffers(Ct,!1);if(st&&(He||dt)){const Pt=H.getTile(Be);J.activeTexture.set(Q.TEXTURE0),Pt.texture&&Pt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);let Vt=f.cI(Ct,Ye,le);const kt=f.bb(f.cH(Be.canonical)),Gt=(hn,ln)=>hn.draw(N,Q.TRIANGLES,ve,Tn.disabled,xe,mn.disabled,mo(le.expandedFarZProjMatrix,Vt,Vt,kt,0,ye,le.frustumCorners.TL,le.frustumCorners.TR,le.frustumCorners.BR,le.frustumCorners.BL,le.globeCenterInViewSpace,le.globeRadius,Re,0,le._farZ),"globe_pole_raster",ln,ht,st);z.setupElevationDraw(Pt,te,qe),N.uploadCommonUniforms(J,te,Be.toUnwrapped()),He&&N.renderDefaultNorthPole&&Gt(te,Ke),dt&&N.renderDefaultSouthPole&&(Vt=f.ab.mat4.scale(f.ab.mat4.create(),Vt,[1,-1,1]),Gt(te,bt))}}}}(b,x,M,A,F);else{const N=b.context,z=N.gl;let H,j;const G=b.shadowRenderer,J=Gc(b,b.longestCutoffRange),Q=xe=>{if(j===xe)return;const ve=[];ve.push(wa[xe]),J.shouldRenderCutoff&&ve.push("RENDER_CUTOFF"),G&&(ve.push("RENDER_SHADOWS","DEPTH_TEXTURE"),G.useNormalOffset&&ve.push("NORMAL_OFFSET")),H=b.getOrCreateProgram("terrainRaster",{defines:ve}),j=xe},te=b.colorModeForRenderPass(),ne=new on(z.LEQUAL,on.ReadWrite,b.depthRangeFor3D);ti.update(F);const le=b.transform,me=lf(le.zoom,x.exaggeration(),x.sourceCache._source.tileSize);let pe=[0,0,0];if(G){const xe=b.style.directionalLight,ve=b.style.ambientLight;xe&&ve&&(pe=mp(b.style,xe,ve))}{j=-1;const xe=z.TRIANGLES,[ve,be]=[x.gridIndexBuffer,x.gridSegments];for(const ye of A){const Ee=M.getTile(ye),Re=Tn.disabled,Xe=x.prevTerrainTileForTile[ye.key],qe=x.terrainTileForTile[ye.key];ul(Xe,qe)&&ti.newMorphing(ye.key,Xe,qe,F,250),N.activeTexture.set(z.TEXTURE0),Ee.texture&&Ee.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const Ae=ti.getMorphValuesForProxy(ye.key),Be=Ae?1:0;let Ye;Ae&&(Ye={morphing:{srcDemTile:Ae.from,dstDemTile:Ae.to,phase:f.cB(Ae.phase)}});const pt=Vr(ye.projMatrix,Ua(ye.canonical,le.renderWorldCopies)?me/10:me,pe);if(Q(Be),!H)continue;x.setupElevationDraw(Ee,H,Ye);const Ct=ye.toUnwrapped();G&&G.setupShadows(Ct,H),b.uploadCommonUniforms(N,H,Ct,null,J),H.draw(b,xe,ne,Re,te,mn.backCCW,pt,"terrain_raster",x.gridBuffer,ve,be)}}}}(c,this,this.proxySourceCache,s,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),s.splice(0,s.length))}renderBatch(s){if(0===this._drapedRenderBatches.length)return s+1;this.renderingToTexture=!0;const c=this.painter,g=this.painter.context,b=this.proxySourceCache,x=this.proxiedCoords[b.id],M=this._drapedRenderBatches.shift(),A=c.style.order,F=[];let N=0;for(const z of x){const H=b.getTileByID(z.proxyTileKey),j=b.proxyCachedFBO[z.key]?b.proxyCachedFBO[z.key][s]:void 0,G=void 0!==j?b.renderCache[j]:this.pool[N++],J=void 0!==j;if(H.texture=G.tex,J&&!G.dirty){F.push(H.tileID);continue}let Q;g.bindFramebuffer.set(G.fb.framebuffer),this.renderedToTile=!1,G.dirty&&(g.clear({color:f.aj.transparent,stencil:0}),G.dirty=!1);for(let te=M.start;te<=M.end;++te){const ne=c.style._mergedLayers[A[te]];if(ne.isHidden(c.transform.zoom))continue;const le=c.style.getLayerSourceCache(ne),me=le?this.proxyToSource[z.key][le.id]:[z];if(!me)continue;const pe=me;g.viewport.set([0,0,G.fb.width,G.fb.height]),Q!==(le?le.id:null)&&(this._setupStencil(G,me,ne,le),Q=le?le.id:null),c.renderLayer(c,le,ne,pe)}if(0===this._drapedRenderBatches.length)for(const te of this._pendingGroundEffectLayers){const ne=c.style._mergedLayers[A[te]];if(ne.isHidden(c.transform.zoom))continue;const le=c.style.getLayerSourceCache(ne),me=le?this.proxyToSource[z.key][le.id]:[z];if(!me)continue;const pe=me;g.viewport.set([0,0,G.fb.width,G.fb.height]),Q!==(le?le.id:null)&&(this._setupStencil(G,me,ne,le),Q=le?le.id:null),c.renderLayer(c,le,ne,pe)}this.renderedToTile?(G.dirty=!0,F.push(H.tileID)):J||--N,5===N&&(N=0,this.renderToBackBuffer(F))}return this.renderToBackBuffer(F),this.renderingToTexture=!1,g.bindFramebuffer.set(null),g.viewport.set([0,0,c.width,c.height]),M.end+1}postRender(){}isLayerOrderingCorrect(s){const c=s.order.length;let g=-1,b=c;for(let x=0;x<c;++x)this._style.isLayerDraped(s._mergedLayers[s.order[x]])?g=Math.max(g,x):b=Math.min(b,x);return b>g}getMinElevationBelowMSL(){let s=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{s=Math.min(s,c.dem.tree.minimums[0])}),0===s?s:(s-30)*this._exaggeration}raycast(s,c,g){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const M=x.tileID,A=1<<M.overscaledZ,{x:F,y:N}=M.canonical,z=F/A,H=(F+1)/A,j=N/A,G=(N+1)/A;return{minx:z,miny:j,maxx:H,maxy:G,t:x.dem.tree.raycastRoot(z,j,H,G,s,c,g),tile:x}});b.sort((x,M)=>(null!==x.t?x.t:Number.MAX_VALUE)-(null!==M.t?M.t:Number.MAX_VALUE));for(const x of b){if(null==x.t)return null;const M=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,s,c,g);if(null!=M)return M}return null}_createFBO(){const s=this.painter.context,c=s.gl,g=this.drapeBufferSize;s.activeTexture.set(c.TEXTURE0);const b=new f.T(s,{width:g[0],height:g[1],data:null},c.RGBA8);b.bind(c.LINEAR,c.CLAMP_TO_EDGE);const x=s.createFramebuffer(g[0],g[1],!0,null);return x.colorAttachment.set(b.texture),x.depthAttachment=new Ol(s,x.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=s.createRenderbuffer(s.gl.DEPTH_STENCIL,g[0],g[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),s.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),s.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax),{fb:x,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const s in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[s].hasTransition())return!0;return this._style.order.some(s=>{const c=this._style._mergedLayers[s],g=c.isHidden(this.painter.transform.zoom);return"hillshade"===c.type||"custom"===c.type?!g&&c.shouldRedrape():!g&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let s=!1;for(const g of this._style.getSources())if(g instanceof B_){s=!0;break}if(!s)return;const c={};for(let g=0;g<this._style.order.length;++g){const b=this._style._mergedLayers[this._style.order[g]],x=this._style.getLayerSourceCache(b);if(x&&!c[x.id]&&!b.isHidden(this.painter.transform.zoom)&&"line"===b.type&&b.widthExpression()instanceof f.a9){c[x.id]=!0;for(const M of this.proxyCoords){const A=this.proxyToSource[M.key][x.id];if(A)for(const F of A)this._clearRenderCacheForTile(x.id,F)}}}}_clearRasterLayersFromRenderCache(){let s=!1;for(const g in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[g]._source instanceof Rr){s=!0;break}if(!s)return;const c={};for(let g=0;g<this._style.order.length;++g){const b=this._style._mergedLayers[this._style.order[g]],x=this._style.getLayerSourceCache(b);if(!x||c[x.id]||b.isHidden(this.painter.transform.zoom)||"raster"!==b.type)continue;const M=b.paint.get("raster-fade-duration");for(const A of this.proxyCoords){const F=this.proxyToSource[A.key][x.id];if(F)for(const N of F){const z=hl(x.getTile(N),x.findLoadedParent(N,0),x,this.painter.transform,M);(1!==z.opacity||0!==z.mix)&&this._clearRenderCacheForTile(x.id,N)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const s=this._style.order,c=s.length;if(0===c)return;const g=[];this._pendingGroundEffectLayers=[];let b,x=0,M=this._style._mergedLayers[s[x]];for(;!this._style.isLayerDraped(M)&&M.isHidden(this.painter.transform.zoom)&&++x<c;)M=this._style._mergedLayers[s[x]];for(;x<c;++x){const A=this._style._mergedLayers[s[x]];A.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(A)?void 0===b&&(b=x):("fill-extrusion"===A.type&&this._pendingGroundEffectLayers.push(x),void 0!==b&&(g.push({start:b,end:x-1}),b=void 0)))}if(void 0!==b&&g.push({start:b,end:x-1}),0!==g.length){const A=g[g.length-1];this._pendingGroundEffectLayers.every(F=>F>A.end)||f.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=g}_setupRenderCache(s){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const M=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let A=0;A<M.length;++A){const F=Object.values(M[A]);c.renderCachePool.push(...F)}}return}this._clearRasterLayersFromRenderCache();const g=this.proxyCoords,b=this._tilesDirty;for(let M=g.length-1;M>=0;M--){const A=g[M];if(c.getTileByID(A.key),void 0!==c.proxyCachedFBO[A.key]){const F=s[A.key],N=this.proxyToSource[A.key];let z=0;for(const H in N){const j=N[H],G=F[H];if(!G||G.length!==j.length||j.some((J,Q)=>J!==G[Q]||b[H]&&b[H].hasOwnProperty(J.key))){z=-1;break}++z}for(const H in c.proxyCachedFBO[A.key])c.renderCache[c.proxyCachedFBO[A.key][H]].dirty=z<0||z!==Object.values(F).length}}const x=[...this._drapedRenderBatches];x.sort((M,A)=>A.end-A.start-(M.end-M.start));for(const M of x)for(const A of g){if(c.proxyCachedFBO[A.key])continue;let F=c.renderCachePool.pop();void 0===F&&c.renderCache.length<50&&(F=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==F&&(c.proxyCachedFBO[A.key]={},c.proxyCachedFBO[A.key][M.start]=F,c.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(s,c,g,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,M=x.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let A;if(g.isTileClipped())A=c.length,this._overlapStencilMode.test={func:M.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);A=1,this._overlapStencilMode.test={func:M.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+A>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=A,this._overlapStencilMode.ref=this._stencilRef,g.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(s){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[s.key]),this._overlapStencilMode):Tn.disabled}_renderTileClippingMasks(s,c){const g=this.painter,b=this.painter.context,x=b.gl;g._tileClippingMaskIDs={},b.setColorMode(An.disabled),b.setDepthMode(on.disabled);const M=g.getOrCreateProgram("clippingMask");for(const A of s){const F=g._tileClippingMaskIDs[A.key]=--c;M.draw(g,x.TRIANGLES,on.disabled,new Tn({func:x.ALWAYS,mask:0},F,255,x.KEEP,x.KEEP,x.REPLACE),An.disabled,mn.disabled,Ur(A.projMatrix),"$clipping",g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}}pointCoordinate(s){const c=this.painter.transform;if(s.x<0||s.x>c.width||s.y<0||s.y>c.height)return null;const g=[s.x,s.y,1,1];f.ab.vec4.transformMat4(g,g,c.pixelMatrixInverse),f.ab.vec4.scale(g,g,1/g[3]),g[0]/=c.worldSize,g[1]/=c.worldSize;const b=c._camera.position,x=f.bH(1,c.center.lat),M=[b[0],b[1],b[2]/x,0],A=f.ab.vec3.subtract([],g.slice(0,3),M);f.ab.vec3.normalize(A,A);const F=this.raycast(M,A,this._exaggeration);return null!==F&&F?(f.ab.vec3.scaleAndAdd(M,M,A,F),M[3]=M[2],M[2]*=x,M):null}_setupProxiedCoordsForOrtho(s,c,g){if(s.getSource()instanceof f.aJ)return this._setupProxiedCoordsForImageSource(s,c,g);this._findCoveringTileCache[s.id]=this._findCoveringTileCache[s.id]||{};const b=this.proxiedCoords[s.id]=[],x=this.proxyCoords;for(let F=0;F<x.length;F++){const N=x[F],z=this._findTileCoveringTileID(N,s);if(z){const H=this._createProxiedId(N,z,g[N.key]&&g[N.key][s.id]);b.push(H),this.proxyToSource[N.key][s.id]=[H]}}let M=!1;const A=new Set;for(let F=0;F<c.length;F++){const N=s.getTile(c[F]);if(!N||!N.hasData())continue;const z=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if(z&&z.tileID.canonical.z!==N.tileID.canonical.z){const H=this.proxyToSource[z.tileID.key][s.id],j=this._createProxiedId(z.tileID,N,g[z.tileID.key]&&g[z.tileID.key][s.id]);H?H.splice(H.length-1,0,j):this.proxyToSource[z.tileID.key][s.id]=[j];const G=this.proxyToSource[z.tileID.key][s.id];A.has(G)||A.add(G),b.push(j),M=!0}}if(this._sourceTilesOverlap[s.id]=M,M&&this._debugParams.sortTilesHiZFirst)for(const F of A)F.sort((N,z)=>z.overscaledZ-N.overscaledZ)}_setupProxiedCoordsForImageSource(s,c,g){if(!s.getSource().loaded())return;const b=this.proxiedCoords[s.id]=[],x=this.proxyCoords,M=s.getSource(),A=M.tileID;if(!A)return;const F=new f.P(A.x,A.y)._div(1<<A.z),N=M.coordinates.map(f.aa.fromLngLat).reduce((H,j)=>(H.min.x=Math.min(H.min.x,j.x-F.x),H.min.y=Math.min(H.min.y,j.y-F.y),H.max.x=Math.max(H.max.x,j.x-F.x),H.max.y=Math.max(H.max.y,j.y-F.y),H),{min:new f.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new f.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),z=(H,j)=>{const G=H.wrap+H.canonical.x/(1<<H.canonical.z),J=H.canonical.y/(1<<H.canonical.z),Q=f.ag/(1<<H.canonical.z),te=j.wrap+j.canonical.x/(1<<j.canonical.z),ne=j.canonical.y/(1<<j.canonical.z);return G+Q<te+N.min.x||G>te+N.max.x||J+Q<ne+N.min.y||J>ne+N.max.y};for(let H=0;H<x.length;H++){const j=x[H];for(let G=0;G<c.length;G++){const J=s.getTile(c[G]);if(!J||!J.hasData()||z(j,J.tileID))continue;const Q=this._createProxiedId(j,J,g[j.key]&&g[j.key][s.id]),te=this.proxyToSource[j.key][s.id];te?te.push(Q):this.proxyToSource[j.key][s.id]=[Q],b.push(Q)}}}_createProxiedId(s,c,g){let b=this.orthoMatrix;if(g){const x=g.find(M=>M.key===c.tileID.key);if(x)return x}if(c.tileID.key!==s.key){const x=s.canonical.z-c.tileID.canonical.z;let M,A,F;b=f.ab.mat4.create();const N=c.tileID.wrap-s.wrap<<s.overscaledZ;x>0?(M=f.ag>>x,A=M*((c.tileID.canonical.x<<x)-s.canonical.x+N),F=M*((c.tileID.canonical.y<<x)-s.canonical.y)):(M=f.ag<<-x,A=f.ag*(c.tileID.canonical.x-(s.canonical.x+N<<-x)),F=f.ag*(c.tileID.canonical.y-(s.canonical.y<<-x))),f.ab.mat4.ortho(b,0,M,0,M,0,1),f.ab.mat4.translate(b,b,[A,F,0])}return new Yc(c.tileID,s.key,b)}_findTileCoveringTileID(s,c){let g=c.getTile(s);if(g&&g.hasData())return g;const b=this._findCoveringTileCache[c.id],x=b[s.key];if(g=x?c.getTileByID(x):null,g&&g.hasData()||null===x)return g;let M=g?g.tileID:s,A=M.overscaledZ;const F=c.getSource().minzoom,N=[];if(!x){const H=c.getSource().maxzoom;if(s.canonical.z>=H){const j=s.canonical.z-H;c.getSource().reparseOverscaled?(A=Math.max(s.canonical.z+2,c.transform.tileZoom),M=new f.aG(A,s.wrap,H,s.canonical.x>>j,s.canonical.y>>j)):0!==j&&(A=H,M=new f.aG(A,s.wrap,H,s.canonical.x>>j,s.canonical.y>>j))}M.key!==s.key&&(N.push(M.key),g=c.getTile(M))}const z=H=>{N.forEach(j=>{b[j]=H}),N.length=0};for(A-=1;A>=F&&(!g||!g.hasData());A--){g&&z(g.tileID.key);const H=M.calculateScaledKey(A);if(g=c.getTileByID(H),g&&g.hasData())break;const j=b[H];if(null===j)break;void 0===j?N.push(H):g=c.getTileByID(j)}return z(g?g.tileID.key:null),g&&g.hasData()?g:null}findDEMTileFor(s){return this.enabled?this._findTileCoveringTileID(s,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(s,c){let g=this._tilesDirty[s];g||(g=this._tilesDirty[s]={}),g[c.key]=!0}}function Fd(m,s,c){const g=function(A,F,N){const z=f.ab.vec3.dot(F,A),H=f.ab.vec3.dot(N,[.2126,.7152,.0722]),j=(J,Q,te)=>(1-te)*J+te*Q,G=j(1-.3*Math.min(H,1),1,Math.min(z+1,1));return j(.92,1,Math.asin(f.aw(F[2],-1,1))/Math.PI+.5)*G}(m,[0,0,1],s),b=[0,0,0];f.ab.vec3.scale(b,c.slice(0,3),g);const x=[0,0,0];f.ab.vec3.scale(x,s.slice(0,3),m[2]);const M=[0,0,0];return f.ab.vec3.add(M,b,x),f.cf(M)}const bp=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],Fl=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class Ca{static cacheKey(s,c,g,b){let x=`${c}${b?b.cacheKey:""}`;for(const M of g)s.usedDefines.includes(M)&&(x+=`/${M}`);return x}constructor(s,c,g,b,x,M){const A=s.gl;this.program=A.createProgram(),this.configuration=b,this.name=c,this.fixedDefines=[...M];const F=b?b.getBinderAttributes():[],N=(g.staticAttributes||[]).concat(F);let z=b?b.defines():[];z=z.concat(M.map(te=>`#define ${te}`));const H="#version 300 es\n";let j=H+z.concat("precision mediump float;",yp,nf.fragmentSource).join("\n");for(const te of g.fragmentIncludes)j+=`\n${Nu[te]}`;j+=`\n${g.fragmentSource}`;let G=H+z.concat("precision highp float;",yp,nf.vertexSource).join("\n");for(const te of g.vertexIncludes)G+=`\n${Nu[te]}`;this.forceManualRenderingForInstanceIDShaders=s.forceManualRenderingForInstanceIDShaders&&-1!==g.vertexSource.indexOf("gl_InstanceID"),this.forceManualRenderingForInstanceIDShaders&&(G+="\nuniform int u_instanceID;\n"),G+=`\n${g.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(G=G.replaceAll("gl_InstanceID","u_instanceID"));const J=A.createShader(A.FRAGMENT_SHADER);if(A.isContextLost())return void(this.failedToCreate=!0);A.shaderSource(J,j),A.compileShader(J),A.attachShader(this.program,J);const Q=A.createShader(A.VERTEX_SHADER);if(A.isContextLost())this.failedToCreate=!0;else{A.shaderSource(Q,G),A.compileShader(Q),A.attachShader(this.program,Q),this.attributes={},this.numAttributes=N.length;for(let te=0;te<this.numAttributes;te++)if(N[te]){const ne=N[te].startsWith("a_")?N[te]:`a_${N[te]}`;A.bindAttribLocation(this.program,te,ne),this.attributes[ne]=te}A.linkProgram(this.program),A.deleteShader(Q),A.deleteShader(J),this.fixedUniforms=x(s),this.binderUniforms=b?b.getUniforms(s):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms={u_instanceID:new f.bN(s)}),(M.includes("TERRAIN")||-1!==c.indexOf("symbol")||-1!==c.indexOf("circle"))&&(this.terrainUniforms={u_dem:new f.bN(te=s),u_dem_prev:new f.bN(te),u_dem_tl:new f.bK(te),u_dem_scale:new f.bM(te),u_dem_tl_prev:new f.bK(te),u_dem_scale_prev:new f.bM(te),u_dem_size:new f.bM(te),u_dem_lerp:new f.bM(te),u_exaggeration:new f.bM(te),u_depth:new f.bN(te),u_depth_size_inv:new f.bK(te),u_depth_range_unpack:new f.bK(te),u_occluder_half_size:new f.bM(te),u_occlusion_depth_offset:new f.bM(te),u_meter_to_dem:new f.bM(te),u_label_plane_matrix_inv:new f.bJ(te)}),M.includes("GLOBE")&&(this.globeUniforms=(te=>({u_tile_tl_up:new f.bL(te),u_tile_tr_up:new f.bL(te),u_tile_br_up:new f.bL(te),u_tile_bl_up:new f.bL(te),u_tile_up_scale:new f.bM(te)}))(s)),M.includes("FOG")&&(this.fogUniforms=(te=>({u_fog_matrix:new f.bJ(te),u_fog_range:new f.bK(te),u_fog_color:new f.ca(te),u_fog_horizon_blend:new f.bM(te),u_fog_vertical_limit:new f.bK(te),u_fog_temporal_offset:new f.bM(te),u_frustum_tl:new f.bL(te),u_frustum_tr:new f.bL(te),u_frustum_br:new f.bL(te),u_frustum_bl:new f.bL(te),u_globe_pos:new f.bL(te),u_globe_radius:new f.bM(te),u_globe_transition:new f.bM(te),u_is_globe:new f.bN(te),u_viewport:new f.bK(te)}))(s)),M.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(te=>({u_cutoff_params:new f.ca(te)}))(s)),M.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(te=>({u_lighting_ambient_color:new f.bL(te),u_lighting_directional_dir:new f.bL(te),u_lighting_directional_color:new f.bL(te),u_ground_radiance:new f.bL(te)}))(s)),M.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(te=>({u_light_matrix_0:new f.bJ(te),u_light_matrix_1:new f.bJ(te),u_fade_range:new f.bK(te),u_shadow_normal_offset:new f.bL(te),u_shadow_intensity:new f.bM(te),u_shadow_texel_size:new f.bM(te),u_shadow_map_resolution:new f.bM(te),u_shadow_direction:new f.bL(te),u_shadow_bias:new f.bL(te),u_shadowmap_0:new f.bN(te),u_shadowmap_1:new f.bN(te)}))(s))}var te}setTerrainUniformValues(s,c){if(!this.terrainUniforms)return;const g=this.terrainUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const b in c)g[b]&&g[b].set(this.program,b,c[b])}}setGlobeUniformValues(s,c){if(!this.globeUniforms)return;const g=this.globeUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const b in c)g[b]&&g[b].set(this.program,b,c[b])}}setFogUniformValues(s,c){if(!this.fogUniforms)return;const g=this.fogUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const b in c)g[b].set(this.program,b,c[b])}}setCutoffUniformValues(s,c){if(!this.cutoffUniforms)return;const g=this.cutoffUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const b in c)g[b].set(this.program,b,c[b])}}setLightsUniformValues(s,c){if(!this.lightsUniforms)return;const g=this.lightsUniforms;if(!this.failedToCreate){s.program.set(this.program);for(const b in c)g[b].set(this.program,b,c[b])}}setShadowUniformValues(s,c){if(this.failedToCreate||!this.shadowUniforms)return;const g=this.shadowUniforms;s.program.set(this.program);for(const b in c)g[b].set(this.program,b,c[b])}_drawDebugWireframe(s,c,g,b,x,M,A,F,N,z){const H=s.options.wireframe;if(!1===H.terrain&&!1===H.layers2D&&!1===H.layers3D)return;const j=s.context;if(!(H.terrain&&("terrainRaster"===this.name||"globeRaster"===this.name)||!(!H.layers2D||s._terrain&&s._terrain.renderingToTexture)&&bp.includes(this.name)||H.layers3D&&Fl.includes(this.name)))return;const G=j.gl,J=s.wireframeDebugCache.getLinesFromTrianglesBuffer(s.frameCounter,x,j);if(!J)return;const Q=[...this.fixedDefines];Q.push("DEBUG_WIREFRAME");const te=s.getOrCreateProgram(this.name,{config:this.configuration,defines:Q});j.program.set(te.program);const ne=(pe,xe,ve)=>{if(xe[pe]&&ve[pe])for(const be in xe[pe])ve[pe][be]&&ve[pe][be].set(ve.program,be,xe[pe][be].current)};N&&N.setUniforms(te.program,j,te.binderUniforms,A,{zoom:F}),ne("fixedUniforms",this,te),ne("terrainUniforms",this,te),ne("globeUniforms",this,te),ne("fogUniforms",this,te),ne("lightsUniforms",this,te),ne("shadowUniforms",this,te),J.bind(),j.setColorMode(new An([G.ONE,G.ONE_MINUS_SRC_ALPHA,G.ZERO,G.ONE],f.aj.transparent,[!0,!0,!0,!1])),j.setDepthMode(new on(c.func===G.LESS?G.LEQUAL:c.func,on.ReadOnly,c.range)),j.setStencilMode(Tn.disabled);const le=3*M.primitiveLength*2,me=3*M.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const pe=z||1;for(let xe=0;xe<pe;++xe)te.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",xe),G.drawElements(G.LINES,le,G.UNSIGNED_SHORT,me)}else z&&z>1?G.drawElementsInstanced(G.LINES,le,G.UNSIGNED_SHORT,me,z):G.drawElements(G.LINES,le,G.UNSIGNED_SHORT,me);x.bind(),j.program.set(this.program),j.setDepthMode(c),j.setStencilMode(g),j.setColorMode(b)}checkUniforms(s,c,g){if(this.fixedDefines.includes(c))for(const b of Object.keys(g))if(!g[b].initialized)throw new Error(`Program '${this.name}', from draw '${s}': uniform ${b} not set but required by ${c} being defined`)}draw(s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te){const ne=s.context,le=ne.gl;if(this.failedToCreate)return;ne.program.set(this.program),ne.setDepthMode(g),ne.setStencilMode(b),ne.setColorMode(x),ne.setCullFace(M);for(const xe of Object.keys(this.fixedUniforms))this.fixedUniforms[xe].set(this.program,xe,A[xe]);J&&J.setUniforms(this.program,ne,this.binderUniforms,j,{zoom:G});const me={[le.POINTS]:1,[le.LINES]:2,[le.TRIANGLES]:3,[le.LINE_STRIP]:1}[c];this.checkUniforms(F,"RENDER_SHADOWS",this.shadowUniforms);const pe=te&&te>0?1:void 0;for(const xe of H.get()){const ve=xe.vaos||(xe.vaos={});if((ve[F]||(ve[F]=new Rd)).bind(ne,this,N,J?J.getPaintVertexBuffers():[],z,xe.vertexOffset,Q||[],pe),this.forceManualRenderingForInstanceIDShaders){const be=te||1;for(let ye=0;ye<be;++ye)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",ye),z?le.drawElements(c,xe.primitiveLength*me,le.UNSIGNED_SHORT,xe.primitiveOffset*me*2):le.drawArrays(c,xe.vertexOffset,xe.vertexLength)}else te&&te>1?le.drawElementsInstanced(c,xe.primitiveLength*me,le.UNSIGNED_SHORT,xe.primitiveOffset*me*2,te):z?le.drawElements(c,xe.primitiveLength*me,le.UNSIGNED_SHORT,xe.primitiveOffset*me*2):le.drawArrays(c,xe.vertexOffset,xe.vertexLength);c===le.TRIANGLES&&z&&this._drawDebugWireframe(s,g,b,x,z,xe,j,G,J,te)}}}function Mn(m,s){const c=Math.pow(2,s.tileID.overscaledZ),g=s.tileSize*Math.pow(2,m.transform.tileZoom)/c,b=g*(s.tileID.canonical.x+s.tileID.wrap*c),x=g*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture?s.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/f.ar(s,1,m.transform.tileZoom),u_pixel_coord_upper:[b>>16,x>>16],u_pixel_coord_lower:[65535&b,65535&x]}}const Uu={terrain:0,flat:1},Xc=f.ab.mat4.create(),ja=(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te,ne)=>{const le=s.style.light,me=le.properties.get("position"),pe=[me.x,me.y,me.z],xe=f.ab.mat3.create();"viewport"===le.properties.get("anchor")&&(f.ab.mat3.fromRotation(xe,-s.transform.angle),f.ab.vec3.transformMat3(pe,pe,xe));const ve=le.properties.get("color"),be=s.transform,ye={u_matrix:m,u_lightpos:pe,u_lightintensity:le.properties.get("intensity"),u_lightcolor:[ve.r,ve.g,ve.b],u_vertical_gradient:+c,u_opacity:g,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Xc,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Uu[N],u_base_type:Uu[z],u_ao:b,u_edge_radius:x,u_width_scale:M,u_flood_light_color:J,u_vertical_scale:Q,u_flood_light_intensity:te,u_ground_shadow_factor:ne};return"globe"===be.projection.name&&(ye.u_tile_id=[A.canonical.x,A.canonical.y,1<<A.canonical.z],ye.u_zoom_transition=H,ye.u_inv_rot_matrix=G,ye.u_merc_center=j,ye.u_up_dir=be.projection.upVector(new f.bT(0,0,0),j[0]*f.ag,j[1]*f.ag),ye.u_height_lift=F),ye},cf=(m,s,c,g,b,x)=>({u_matrix:m,u_edge_radius:s,u_width_scale:c,u_vertical_scale:g,u_height_type:Uu[b],u_base_type:Uu[x]}),_c=(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te)=>{const ne=ja(m,s,c,g,b,x,M,A,N,z,H,j,G,J,Q,te,1,[0,0,0]),le={u_height_factor:-Math.pow(2,A.overscaledZ)/F.tileSize/8};return f.l(ne,Mn(s,F),le)},io=(m,s)=>({u_matrix:m,u_emissive_strength:s}),Kc=(m,s,c,g)=>f.l(io(m,s),Mn(c,g)),go=(m,s,c)=>({u_matrix:m,u_world:c,u_emissive_strength:s}),Io=(m,s,c,g,b)=>f.l(Kc(m,s,c,g),{u_world:b}),df=(m,s,c,g)=>{const b=f.ag/c.tileSize;return{u_matrix:m,u_camera_to_center_distance:s.getCameraToCenterDistance(g),u_extrude_scale:[s.pixelsToGLUnits[0]/b,s.pixelsToGLUnits[1]/b]}},Ll=(m,s,c=1)=>({u_matrix:m,u_color:s.toRenderColor(null),u_overlay:0,u_overlay_scale:c}),xp=f.ab.mat4.create(),Nl=(m,s,c,g,b,x,M)=>{const A=m.transform,F="globe"===A.projection.name,N=F?f.cN(A.zoom,s.canonical)*A._pixelsPerMercatorPixel:f.ar(c,1,x),z={u_matrix:s.projMatrix,u_extrude_scale:N,u_intensity:M,u_inv_rot_matrix:xp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(F){z.u_inv_rot_matrix=g,z.u_merc_center=b,z.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],z.u_zoom_transition=f.ae(A.zoom);const H=b[0]*f.ag,j=b[1]*f.ag;z.u_up_dir=A.projection.upVector(new f.bT(0,0,0),H,j)}return z};function zl(m,[s,c,g,b],[x,M]){if(x===M)return[0,0,0,0];const A=255*(m-1)/(m*(M-x));return[s*A,c*A,g*A,b*A]}function uf(m,s,[c,g]){return c===g?0:.5/m+(s-c)*(m-1)/(m*(g-c))}const Zt=(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te,ne,le,me,pe)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:c,u_merc_matrix:g,u_grid_matrix:b,u_tl_parent:x,u_scale_parent:N,u_fade_t:z.mix,u_opacity:z.opacity*H.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:H.paint.get("raster-brightness-min"),u_brightness_high:H.paint.get("raster-brightness-max"),u_saturation_factor:f.cO(H.paint.get("raster-saturation")),u_contrast_factor:f.cP(H.paint.get("raster-contrast")),u_spin_weights:pg(H.paint.get("raster-hue-rotate")),u_perspective_transform:j,u_raster_elevation:G,u_zoom_transition:M,u_merc_center:A,u_cutoff_params:F,u_colorization_mix:zl(f.cQ,Q,ne),u_colorization_offset:uf(f.cQ,te,ne),u_color_ramp:J,u_texture_offset:[me/(le+2*me),le/(le+2*me)],u_texture_res:[le+2*me,le+2*me],u_emissive_strength:pe});function pg(m){m*=Math.PI/180;const s=Math.sin(m),c=Math.cos(m);return[(2*c+1)/3,(-Math.sqrt(3)*s-c+1)/3,(Math.sqrt(3)*s-c+1)/3]}const Ld=.05,ju=(m,s,c,g,b,x,M,A,F,N,z,H)=>({u_matrix:m,u_normalize_matrix:s,u_globe_matrix:c,u_merc_matrix:g,u_grid_matrix:b,u_tl_parent:x,u_scale_parent:N,u_fade_t:z.mix,u_opacity:z.opacity,u_image0:0,u_image1:1,u_raster_elevation:H,u_zoom_transition:M,u_merc_center:A,u_cutoff_params:F}),Qc=(m,s,c,g,b,x,M,A,F,N)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_tile_offset:c,u_velocity:g,u_color_ramp:x,u_velocity_res:b,u_max_speed:M,u_uv_offset:A,u_data_scale:[255*F[0],255*F[1]],u_data_offset:N,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ld,Ld]}),rn=(m,s,c,g,b,x,M,A,F,N)=>({u_particle_texture:m,u_particle_texture_side_len:s,u_velocity:c,u_velocity_res:g,u_max_speed:b,u_speed_factor:x,u_reset_rate:M,u_rand_seed:Math.random(),u_uv_offset:A,u_data_scale:[255*F[0],255*F[1]],u_data_offset:N,u_particle_pos_scale:1.1,u_particle_pos_offset:[Ld,Ld]}),ty=f.ab.mat4.create(),mw=(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te,ne,le,me,pe,xe)=>{const ve=b.transform,be={u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:s?s.uSizeT:0,u_size:s?s.uSize:0,u_camera_to_center_distance:ve.getCameraToCenterDistance(le),u_rotate_symbol:+c,u_aspect_ratio:ve.width/ve.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:M,u_coord_matrix:A,u_is_text:+N,u_elevation_from_sea:F?1:0,u_pitch_with_map:+g,u_texsize:z,u_texsize_icon:H,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ty,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:ty,u_up_vector:[0,-1,0],u_color_adj_mat:me,u_icon_transition:pe||0,u_gamma_scale:g?b.transform.getCameraToCenterDistance(le)*Math.cos(b.terrain?0:b.transform._pitch):1,u_device_pixel_ratio:f.q.devicePixelRatio,u_is_halo:+j,u_scale_factor:xe||1};return"globe"===le.name&&(be.u_tile_id=[G.canonical.x,G.canonical.y,1<<G.canonical.z],be.u_zoom_transition=J,be.u_inv_rot_matrix=te,be.u_merc_center=Q,be.u_camera_forward=ve._camera.forward(),be.u_ecef_origin=f.cR(ve.globeMatrix,G.toUnwrapped()),be.u_tile_matrix=Float32Array.from(ve.globeMatrix),be.u_up_vector=ne),be},gw=(m,s,c,g)=>({u_matrix:m,u_emissive_strength:s,u_opacity:c,u_color:g}),ny=(m,s,c,g,b,x,M,A,F)=>f.l(function(N,z,H,j,G,J){const{width:Q,height:te}=j.imageManager.getPixelSize(z),ne=Math.pow(2,J.tileID.overscaledZ),le=J.tileSize*Math.pow(2,j.transform.tileZoom)/ne,me=le*(J.tileID.canonical.x+J.tileID.wrap*ne),pe=le*J.tileID.canonical.y;return{u_image:0,u_pattern_tl:H.tl,u_pattern_br:H.br,u_texsize:[Q,te],u_pattern_size:H.displaySize,u_pattern_units_to_pixels:G?[j.transform.width,-1*j.transform.height]:[1/f.ar(J,1,j.transform.tileZoom),1/f.ar(J,1,j.transform.tileZoom)],u_pixel_coord_upper:[me>>16,pe>>16],u_pixel_coord_lower:[65535&me,65535&pe]}}(0,x,M,g,A,F),{u_matrix:m,u_emissive_strength:s,u_opacity:c}),iy=new Float32Array(f.ab.mat4.identity([])),ry=(m,s,c,g,b,x,M,A,F,N,z,H,j,G=[0,0,0],J)=>{const Q=b.style.light,te=Q.properties.get("position"),ne=[-te.x,-te.y,te.z],le=f.ab.mat3.create();"viewport"===Q.properties.get("anchor")&&(f.ab.mat3.fromRotation(le,-b.transform.angle),f.ab.vec3.transformMat3(ne,ne,le));const me="MASK"===z.alphaMode,pe=Q.properties.get("color").toRenderColor(null),xe=j.paint.get("model-ambient-occlusion-intensity"),ve=j.paint.get("model-color").constantOr(f.aj.white).toRenderColor(null),be=j.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:m,u_lighting_matrix:s,u_normal_matrix:c,u_node_matrix:g||iy,u_lightpos:ne,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[pe.r,pe.g,pe.b],u_camera_pos:G,u_opacity:x,u_baseTextureIsAlpha:0,u_alphaMask:+me,u_alphaCutoff:z.alphaCutoff,u_baseColorFactor:[M.r,M.g,M.b,M.a],u_emissiveFactor:[A[0],A[1],A[2],1],u_metallicFactor:F,u_roughnessFactor:N,u_baseColorTexture:Kr_BaseColor,u_metallicRoughnessTexture:Kr_MetallicRoughness,u_normalTexture:Kr_Normal,u_occlusionTexture:Kr_Occlusion,u_emissionTexture:Kr_Emission,u_lutTexture:Kr_LUT,u_color_mix:[ve.r,ve.g,ve.b,be],u_aoIntensity:xe,u_emissive_strength:H,u_occlusionTextureTransform:J||[0,0,0,0]}},_w=(m,s=iy,c=iy)=>({u_matrix:m,u_instance:s,u_node_matrix:c}),RT={fillExtrusion:m=>({u_matrix:new f.bJ(m),u_lightpos:new f.bL(m),u_lightintensity:new f.bM(m),u_lightcolor:new f.bL(m),u_vertical_gradient:new f.bM(m),u_opacity:new f.bM(m),u_edge_radius:new f.bM(m),u_width_scale:new f.bM(m),u_ao:new f.bK(m),u_height_type:new f.bN(m),u_base_type:new f.bN(m),u_tile_id:new f.bL(m),u_zoom_transition:new f.bM(m),u_inv_rot_matrix:new f.bJ(m),u_merc_center:new f.bK(m),u_up_dir:new f.bL(m),u_height_lift:new f.bM(m),u_flood_light_color:new f.bL(m),u_vertical_scale:new f.bM(m),u_flood_light_intensity:new f.bM(m),u_ground_shadow_factor:new f.bL(m)}),fillExtrusionDepth:m=>({u_matrix:new f.bJ(m),u_edge_radius:new f.bM(m),u_width_scale:new f.bM(m),u_vertical_scale:new f.bM(m),u_height_type:new f.bN(m),u_base_type:new f.bN(m)}),fillExtrusionPattern:m=>({u_matrix:new f.bJ(m),u_lightpos:new f.bL(m),u_lightintensity:new f.bM(m),u_lightcolor:new f.bL(m),u_vertical_gradient:new f.bM(m),u_height_factor:new f.bM(m),u_edge_radius:new f.bM(m),u_width_scale:new f.bM(m),u_ao:new f.bK(m),u_height_type:new f.bN(m),u_base_type:new f.bN(m),u_tile_id:new f.bL(m),u_zoom_transition:new f.bM(m),u_inv_rot_matrix:new f.bJ(m),u_merc_center:new f.bK(m),u_up_dir:new f.bL(m),u_height_lift:new f.bM(m),u_image:new f.bN(m),u_texsize:new f.bK(m),u_pixel_coord_upper:new f.bK(m),u_pixel_coord_lower:new f.bK(m),u_tile_units_to_pixels:new f.bM(m),u_opacity:new f.bM(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new f.bJ(m),u_opacity:new f.bM(m),u_ao_pass:new f.bM(m),u_meter_to_tile:new f.bM(m),u_ao:new f.bK(m),u_flood_light_intensity:new f.bM(m),u_flood_light_color:new f.bL(m),u_attenuation:new f.bM(m),u_edge_radius:new f.bM(m),u_fb:new f.bN(m),u_fb_size:new f.bM(m),u_dynamic_offset:new f.bM(m)}),fill:m=>({u_matrix:new f.bJ(m),u_emissive_strength:new f.bM(m)}),fillPattern:m=>({u_matrix:new f.bJ(m),u_emissive_strength:new f.bM(m),u_image:new f.bN(m),u_texsize:new f.bK(m),u_pixel_coord_upper:new f.bK(m),u_pixel_coord_lower:new f.bK(m),u_tile_units_to_pixels:new f.bM(m)}),fillOutline:m=>({u_matrix:new f.bJ(m),u_emissive_strength:new f.bM(m),u_world:new f.bK(m)}),fillOutlinePattern:m=>({u_matrix:new f.bJ(m),u_emissive_strength:new f.bM(m),u_world:new f.bK(m),u_image:new f.bN(m),u_texsize:new f.bK(m),u_pixel_coord_upper:new f.bK(m),u_pixel_coord_lower:new f.bK(m),u_tile_units_to_pixels:new f.bM(m)}),circle:f.cS,collisionBox:m=>({u_matrix:new f.bJ(m),u_camera_to_center_distance:new f.bM(m),u_extrude_scale:new f.bK(m)}),collisionCircle:m=>({u_matrix:new f.bJ(m),u_inv_matrix:new f.bJ(m),u_camera_to_center_distance:new f.bM(m),u_viewport_size:new f.bK(m)}),debug:m=>({u_color:new f.cz(m),u_matrix:new f.bJ(m),u_overlay:new f.bN(m),u_overlay_scale:new f.bM(m)}),clippingMask:m=>({u_matrix:new f.bJ(m)}),heatmap:m=>({u_extrude_scale:new f.bM(m),u_intensity:new f.bM(m),u_matrix:new f.bJ(m),u_inv_rot_matrix:new f.bJ(m),u_merc_center:new f.bK(m),u_tile_id:new f.bL(m),u_zoom_transition:new f.bM(m),u_up_dir:new f.bL(m)}),heatmapTexture:m=>({u_image:new f.bN(m),u_color_ramp:new f.bN(m),u_opacity:new f.bM(m)}),hillshade:m=>({u_matrix:new f.bJ(m),u_image:new f.bN(m),u_latrange:new f.bK(m),u_light:new f.bK(m),u_shadow:new f.cz(m),u_highlight:new f.cz(m),u_emissive_strength:new f.bM(m),u_accent:new f.cz(m)}),hillshadePrepare:m=>({u_matrix:new f.bJ(m),u_image:new f.bN(m),u_dimension:new f.bK(m),u_zoom:new f.bM(m)}),line:f.cT,linePattern:f.cU,raster:m=>({u_matrix:new f.bJ(m),u_normalize_matrix:new f.bJ(m),u_globe_matrix:new f.bJ(m),u_merc_matrix:new f.bJ(m),u_grid_matrix:new f.cA(m),u_tl_parent:new f.bK(m),u_scale_parent:new f.bM(m),u_fade_t:new f.bM(m),u_opacity:new f.bM(m),u_image0:new f.bN(m),u_image1:new f.bN(m),u_brightness_low:new f.bM(m),u_brightness_high:new f.bM(m),u_saturation_factor:new f.bM(m),u_contrast_factor:new f.bM(m),u_spin_weights:new f.bL(m),u_perspective_transform:new f.bK(m),u_raster_elevation:new f.bM(m),u_zoom_transition:new f.bM(m),u_merc_center:new f.bK(m),u_cutoff_params:new f.ca(m),u_colorization_mix:new f.ca(m),u_colorization_offset:new f.bM(m),u_color_ramp:new f.bN(m),u_texture_offset:new f.bK(m),u_texture_res:new f.bK(m),u_emissive_strength:new f.bM(m)}),rasterParticle:m=>({u_matrix:new f.bJ(m),u_normalize_matrix:new f.bJ(m),u_globe_matrix:new f.bJ(m),u_merc_matrix:new f.bJ(m),u_grid_matrix:new f.cA(m),u_tl_parent:new f.bK(m),u_scale_parent:new f.bM(m),u_fade_t:new f.bM(m),u_opacity:new f.bM(m),u_image0:new f.bN(m),u_image1:new f.bN(m),u_raster_elevation:new f.bM(m),u_zoom_transition:new f.bM(m),u_merc_center:new f.bK(m),u_cutoff_params:new f.ca(m)}),rasterParticleTexture:m=>({u_texture:new f.bN(m),u_opacity:new f.bM(m)}),rasterParticleDraw:m=>({u_particle_texture:new f.bN(m),u_particle_texture_side_len:new f.bM(m),u_tile_offset:new f.bK(m),u_velocity:new f.bN(m),u_color_ramp:new f.bN(m),u_velocity_res:new f.bK(m),u_max_speed:new f.bM(m),u_uv_offset:new f.bK(m),u_data_scale:new f.bK(m),u_data_offset:new f.bM(m),u_particle_pos_scale:new f.bM(m),u_particle_pos_offset:new f.bK(m)}),rasterParticleUpdate:m=>({u_particle_texture:new f.bN(m),u_particle_texture_side_len:new f.bM(m),u_velocity:new f.bN(m),u_velocity_res:new f.bK(m),u_max_speed:new f.bM(m),u_speed_factor:new f.bM(m),u_reset_rate:new f.bM(m),u_rand_seed:new f.bM(m),u_uv_offset:new f.bK(m),u_data_scale:new f.bK(m),u_data_offset:new f.bM(m),u_particle_pos_scale:new f.bM(m),u_particle_pos_offset:new f.bK(m)}),symbol:m=>({u_is_size_zoom_constant:new f.bN(m),u_is_size_feature_constant:new f.bN(m),u_size_t:new f.bM(m),u_size:new f.bM(m),u_camera_to_center_distance:new f.bM(m),u_rotate_symbol:new f.bN(m),u_aspect_ratio:new f.bM(m),u_fade_change:new f.bM(m),u_matrix:new f.bJ(m),u_label_plane_matrix:new f.bJ(m),u_coord_matrix:new f.bJ(m),u_is_text:new f.bN(m),u_elevation_from_sea:new f.bN(m),u_pitch_with_map:new f.bN(m),u_texsize:new f.bK(m),u_texsize_icon:new f.bK(m),u_texture:new f.bN(m),u_texture_icon:new f.bN(m),u_gamma_scale:new f.bM(m),u_device_pixel_ratio:new f.bM(m),u_tile_id:new f.bL(m),u_zoom_transition:new f.bM(m),u_inv_rot_matrix:new f.bJ(m),u_merc_center:new f.bK(m),u_camera_forward:new f.bL(m),u_tile_matrix:new f.bJ(m),u_up_vector:new f.bL(m),u_ecef_origin:new f.bL(m),u_is_halo:new f.bN(m),u_icon_transition:new f.bM(m),u_color_adj_mat:new f.bJ(m),u_scale_factor:new f.bM(m)}),background:m=>({u_matrix:new f.bJ(m),u_emissive_strength:new f.bM(m),u_opacity:new f.bM(m),u_color:new f.cz(m)}),backgroundPattern:m=>({u_matrix:new f.bJ(m),u_emissive_strength:new f.bM(m),u_opacity:new f.bM(m),u_image:new f.bN(m),u_pattern_tl:new f.bK(m),u_pattern_br:new f.bK(m),u_texsize:new f.bK(m),u_pattern_size:new f.bK(m),u_pixel_coord_upper:new f.bK(m),u_pixel_coord_lower:new f.bK(m),u_pattern_units_to_pixels:new f.bK(m)}),terrainRaster:m=>({u_matrix:new f.bJ(m),u_image0:new f.bN(m),u_skirt_height:new f.bM(m),u_ground_shadow_factor:new f.bL(m)}),skybox:m=>({u_matrix:new f.bJ(m),u_sun_direction:new f.bL(m),u_cubemap:new f.bN(m),u_opacity:new f.bM(m),u_temporal_offset:new f.bM(m)}),skyboxGradient:m=>({u_matrix:new f.bJ(m),u_color_ramp:new f.bN(m),u_center_direction:new f.bL(m),u_radius:new f.bM(m),u_opacity:new f.bM(m),u_temporal_offset:new f.bM(m)}),skyboxCapture:m=>({u_matrix_3f:new f.cA(m),u_sun_direction:new f.bL(m),u_sun_intensity:new f.bM(m),u_color_tint_r:new f.ca(m),u_color_tint_m:new f.ca(m),u_luminance:new f.bM(m)}),globeRaster:m=>({u_proj_matrix:new f.bJ(m),u_globe_matrix:new f.bJ(m),u_normalize_matrix:new f.bJ(m),u_merc_matrix:new f.bJ(m),u_zoom_transition:new f.bM(m),u_merc_center:new f.bK(m),u_image0:new f.bN(m),u_grid_matrix:new f.cA(m),u_skirt_height:new f.bM(m),u_far_z_cutoff:new f.bM(m),u_frustum_tl:new f.bL(m),u_frustum_tr:new f.bL(m),u_frustum_br:new f.bL(m),u_frustum_bl:new f.bL(m),u_globe_pos:new f.bL(m),u_globe_radius:new f.bM(m),u_viewport:new f.bK(m)}),globeAtmosphere:m=>({u_frustum_tl:new f.bL(m),u_frustum_tr:new f.bL(m),u_frustum_br:new f.bL(m),u_frustum_bl:new f.bL(m),u_horizon:new f.bM(m),u_transition:new f.bM(m),u_fadeout_range:new f.bM(m),u_color:new f.ca(m),u_high_color:new f.ca(m),u_space_color:new f.ca(m),u_temporal_offset:new f.bM(m),u_horizon_angle:new f.bM(m)}),model:m=>({u_matrix:new f.bJ(m),u_lighting_matrix:new f.bJ(m),u_normal_matrix:new f.bJ(m),u_node_matrix:new f.bJ(m),u_lightpos:new f.bL(m),u_lightintensity:new f.bM(m),u_lightcolor:new f.bL(m),u_camera_pos:new f.bL(m),u_opacity:new f.bM(m),u_baseColorFactor:new f.ca(m),u_emissiveFactor:new f.ca(m),u_metallicFactor:new f.bM(m),u_roughnessFactor:new f.bM(m),u_baseTextureIsAlpha:new f.bN(m),u_alphaMask:new f.bN(m),u_alphaCutoff:new f.bM(m),u_baseColorTexture:new f.bN(m),u_metallicRoughnessTexture:new f.bN(m),u_normalTexture:new f.bN(m),u_occlusionTexture:new f.bN(m),u_emissionTexture:new f.bN(m),u_lutTexture:new f.bN(m),u_color_mix:new f.ca(m),u_aoIntensity:new f.bM(m),u_emissive_strength:new f.bM(m),u_occlusionTextureTransform:new f.ca(m)}),modelDepth:m=>({u_matrix:new f.bJ(m),u_instance:new f.bJ(m),u_node_matrix:new f.bJ(m)}),groundShadow:m=>({u_matrix:new f.bJ(m),u_ground_shadow_factor:new f.bL(m)}),stars:m=>({u_matrix:new f.bJ(m),u_up:new f.bL(m),u_right:new f.bL(m),u_intensity_multiplier:new f.bM(m)}),snowParticle:m=>({u_modelview:new f.bJ(m),u_projection:new f.bJ(m),u_time:new f.bM(m),u_cam_pos:new f.bL(m),u_velocityConeAperture:new f.bM(m),u_velocity:new f.bM(m),u_horizontalOscillationRadius:new f.bM(m),u_horizontalOscillationRate:new f.bM(m),u_boxSize:new f.bM(m),u_billboardSize:new f.bM(m),u_simpleShapeParameters:new f.bK(m),u_screenSize:new f.bK(m),u_thinningCenterPos:new f.bK(m),u_thinningShape:new f.bL(m),u_thinningAffectedRatio:new f.bM(m),u_thinningParticleOffset:new f.bM(m),u_particleColor:new f.ca(m),u_direction:new f.bL(m)}),rainParticle:m=>({u_modelview:new f.bJ(m),u_projection:new f.bJ(m),u_time:new f.bM(m),u_cam_pos:new f.bL(m),u_texScreen:new f.bN(m),u_velocityConeAperture:new f.bM(m),u_velocity:new f.bM(m),u_boxSize:new f.bM(m),u_rainDropletSize:new f.bK(m),u_distortionStrength:new f.bM(m),u_rainDirection:new f.bL(m),u_color:new f.ca(m),u_screenSize:new f.bK(m),u_thinningCenterPos:new f.bK(m),u_thinningShape:new f.bL(m),u_thinningAffectedRatio:new f.bM(m),u_thinningParticleOffset:new f.bM(m),u_shapeDirectionalPower:new f.bM(m),u_shapeNormalPower:new f.bM(m),u_mode:new f.bM(m)}),vignette:m=>({u_vignetteShape:new f.bL(m),u_vignetteColor:new f.ca(m)}),occlusion:m=>({u_matrix:new f.bJ(m),u_anchorPos:new f.bL(m),u_screenSizePx:new f.bK(m),u_occluderSizePx:new f.bK(m),u_color:new f.ca(m)})};let oy=(()=>{class m{constructor(c,g,b,x){this.id=m.uniqueIdxCounter,m.uniqueIdxCounter++,this.context=c;const M=c.gl;this.buffer=M.createBuffer(),this.dynamicDraw=!!b,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),M.bufferData(M.ELEMENT_ARRAY_BUFFER,g.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||x||g.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){this.id=m.uniqueIdxCounter,m.uniqueIdxCounter++;const g=this.context.gl;this.context.unbindVAO(),this.bind(),g.bufferSubData(g.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}return m.uniqueIdxCounter=0,m})();const Tb={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Mb{constructor(s,c,g,b,x,M){this.length=c.length,this.attributes=g,this.itemSize=c.bytesPerElement,this.dynamicDraw=b,this.instanceCount=M,this.context=s;const A=s.gl;this.buffer=A.createBuffer(),s.bindVertexBuffer.set(this.buffer),A.bufferData(A.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?A.DYNAMIC_DRAW:A.STATIC_DRAW),this.dynamicDraw||x||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(s){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,s.arrayBuffer)}enableAttributes(s,c){for(let g=0;g<this.attributes.length;g++){const b=c.attributes[this.attributes[g].name];void 0!==b&&s.enableVertexAttribArray(b)}}setVertexAttribPointers(s,c,g){for(let b=0;b<this.attributes.length;b++){const x=this.attributes[b],M=c.attributes[x.name];void 0!==M&&s.vertexAttribPointer(M,x.components,s[Tb[x.type]],!1,this.itemSize,x.offset+this.itemSize*(g||0))}}setVertexAttribDivisor(s,c,g){for(let b=0;b<this.attributes.length;b++){const x=c.attributes[this.attributes[b].name];void 0!==x&&this.instanceCount&&this.instanceCount>0&&s.vertexAttribDivisor(x,g)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class wp{constructor(s,c,g,b,x){this.context=s,this.width=c,this.height=g;const M=this.framebuffer=s.gl.createFramebuffer();b&&(this.colorAttachment=new cs(s,M)),x&&(this.depthAttachmentType=x,this.depthAttachment="renderbuffer"===x?new Oo(s,M):new Rs(s,M))}destroy(){const s=this.context.gl;if(this.colorAttachment){const c=this.colorAttachment.get();c&&s.deleteTexture(c)}if(this.depthAttachment&&this.depthAttachmentType)if("renderbuffer"===this.depthAttachmentType){const c=this.depthAttachment.get();c&&s.deleteRenderbuffer(c)}else{const c=this.depthAttachment.get();c&&s.deleteTexture(c)}s.deleteFramebuffer(this.framebuffer)}}class ea{constructor(s,c){this.gl=s,this.clearColor=new W_(this),this.clearDepth=new fw(this),this.clearStencil=new pw(this),this.colorMask=new cg(this),this.depthMask=new zu(this),this.stencilMask=new Pd(this),this.stencilFunc=new Z_(this),this.stencilOp=new bb(this),this.stencilTest=new xb(this),this.depthRange=new Y_(this),this.depthTest=new As(this),this.depthFunc=new sf(this),this.blend=new Bu(this),this.blendFunc=new Jo(this),this.blendColor=new X_(this),this.blendEquation=new dg(this),this.cullFace=new Do(this),this.cullFaceSide=new ug(this),this.frontFace=new K_(this),this.program=new Od(this),this.activeTexture=new Q_(this),this.viewport=new J_(this),this.bindFramebuffer=new hg(this),this.bindRenderbuffer=new wb(this),this.bindTexture=new Cb(this),this.bindVertexBuffer=new af(this),this.bindElementBuffer=new ey(this),this.bindVertexArrayOES=new fg(this),this.pixelStoreUnpack=new Jr(this),this.pixelStoreUnpackPremultiplyAlpha=new Jt(this),this.pixelStoreUnpackFlipY=new Wn(this),this.options=c?{...c}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=s.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=s.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=s.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=s.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=c&&!!c.forceManualRenderingForInstanceIDShaders||this.renderer&&-1!==this.renderer.indexOf("PowerVR"),this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=s.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=s.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=s.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),this.maxPointSize=s.getParameter(s.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(s,c,g){return new oy(this,s,c,g)}createVertexBuffer(s,c,g,b,x){return new Mb(this,s,c,g,b,x)}createRenderbuffer(s,c,g){const b=this.gl,x=b.createRenderbuffer();return this.bindRenderbuffer.set(x),b.renderbufferStorage(b.RENDERBUFFER,s,c,g),this.bindRenderbuffer.set(null),x}createFramebuffer(s,c,g,b){return new wp(this,s,c,g,b)}clear({color:s,depth:c,stencil:g,colorMask:b}){const x=this.gl;let M=0;s&&(M|=x.COLOR_BUFFER_BIT,this.clearColor.set(s),this.colorMask.set(b||[!0,!0,!0,!0])),void 0!==c&&(M|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==g&&(M|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(g),this.stencilMask.set(255)),x.clear(M)}setCullFace(s){!1===s.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(s.mode),this.frontFace.set(s.frontFace))}setDepthMode(s){s.func!==this.gl.ALWAYS||s.mask?(this.depthTest.set(!0),this.depthFunc.set(s.func),this.depthMask.set(s.mask),this.depthRange.set(s.range)):this.depthTest.set(!1)}setStencilMode(s){s.test.func!==this.gl.ALWAYS||s.mask?(this.stencilTest.set(!0),this.stencilMask.set(s.mask),this.stencilOp.set([s.fail,s.depthFail,s.pass]),this.stencilFunc.set({func:s.test.func,ref:s.ref,mask:s.test.mask})):this.stencilTest.set(!1)}setColorMode(s){f.bn(s.blendFunction,An.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(s.blendFunction),this.blendColor.set(s.blendColor),s.blendEquation?this.blendEquation.set(s.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(s.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let yc;function Sb(m,s,c,g,b,x,M){const A=m.context,F=A.gl,N=m.transform,z=m.getOrCreateProgram("collisionBox"),H=[];let j=0,G=0;for(let pe=0;pe<g.length;pe++){const xe=g[pe],ve=s.getTile(xe),be=ve.getBucket(c);if(!be)continue;const ye=Xr(xe,be,N);let Ee=ye;0===b[0]&&0===b[1]||(Ee=m.translatePosMatrix(ye,ve,b,x));const Re=M?be.textCollisionBox:be.iconCollisionBox,Xe=be.collisionCircleArray;if(Xe.length>0){const qe=f.ab.mat4.create(),Ae=Ee;f.ab.mat4.mul(qe,be.placementInvProjMatrix,N.glCoordMatrix),f.ab.mat4.mul(qe,qe,be.placementViewportMatrix),H.push({circleArray:Xe,circleOffset:G,transform:Ae,invTransform:qe,projection:be.getProjection()}),j+=Xe.length/4,G=j}Re&&(m.terrain&&m.terrain.setupElevationDraw(ve,z),z.draw(m,F.LINES,on.disabled,Tn.disabled,m.colorModeForRenderPass(),mn.disabled,df(Ee,N,ve,be.getProjection()),c.id,Re.layoutVertexBuffer,Re.indexBuffer,Re.segments,null,N.zoom,null,[Re.collisionVertexBuffer,Re.collisionVertexBufferExt]))}if(!M||!H.length)return;const J=m.getOrCreateProgram("collisionCircle"),Q=new f.cV;Q.resize(4*j),Q._trim();let te=0;for(const pe of H)for(let xe=0;xe<pe.circleArray.length/4;xe++){const ve=4*xe,be=pe.circleArray[ve+0],ye=pe.circleArray[ve+1],Ee=pe.circleArray[ve+2],Re=pe.circleArray[ve+3];Q.emplace(te++,be,ye,Ee,Re,0),Q.emplace(te++,be,ye,Ee,Re,1),Q.emplace(te++,be,ye,Ee,Re,2),Q.emplace(te++,be,ye,Ee,Re,3)}(!yc||yc.length<2*j)&&(yc=function(pe){const xe=2*pe,ve=new f.aU;ve.resize(xe),ve._trim();for(let be=0;be<xe;be++){const ye=6*be;ve.uint16[ye+0]=4*be+0,ve.uint16[ye+1]=4*be+1,ve.uint16[ye+2]=4*be+2,ve.uint16[ye+3]=4*be+2,ve.uint16[ye+4]=4*be+3,ve.uint16[ye+5]=4*be+0}return ve}(j));const ne=A.createIndexBuffer(yc,!0),le=A.createVertexBuffer(Q,f.cW.members,!0);for(const pe of H){const xe={u_matrix:pe.transform,u_inv_matrix:pe.invTransform,u_camera_to_center_distance:(me=N).getCameraToCenterDistance(pe.projection),u_viewport_size:[me.width,me.height]};J.draw(m,F.TRIANGLES,on.disabled,Tn.disabled,m.colorModeForRenderPass(),mn.disabled,xe,c.id,le,ne,f.b7.simpleSegment(0,2*pe.circleOffset,pe.circleArray.length,pe.circleArray.length/2),null,N.zoom)}var me;le.destroy(),ne.destroy()}const Cp=f.ab.mat4.create();function sy(m){const s=m._camera.getWorldToCamera(m.worldSize,1),c=f.ab.mat4.multiply([],s,m.globeMatrix);f.ab.mat4.invert(c,c);const g=[0,0,0],b=[0,1,0,0];return f.ab.vec4.transformMat4(b,b,c),g[0]=b[0],g[1]=b[1],g[2]=b[2],f.ab.vec3.normalize(g,g),g}function ay({width:m,height:s,anchor:c,textOffset:g,textScale:b},x){const{horizontalAlign:M,verticalAlign:A}=f.bD(c),F=-(M-.5)*m,N=-(A-.5)*s,z=f.bC(c,g);return new f.P((F/b+z[0])*x,(N/b+z[1])*x)}function ly(m,s,c,g,b,x,M,A,F,N,z){const H=m.text.placedSymbolArray,j=m.text.dynamicLayoutVertexArray,G=m.icon.dynamicLayoutVertexArray,J={},Q=m.getProjection(),te=Zh(A,Q,x),ne=x.elevation,le=Q.upVectorScale(A.canonical,x.center.lat,x.worldSize).metersToTile;j.clear();for(let me=0;me<H.length;me++){const pe=H.get(me),{tileAnchorX:xe,tileAnchorY:ve,numGlyphs:be}=pe,ye=pe.hidden||!pe.crossTileID||m.allowVerticalPlacement&&!pe.placedOrientation?null:g[pe.crossTileID];if(ye){let Ee=0,Re=0,Xe=0;if(ne){const Ke=ne?ne.getAtTileOffset(A,xe,ve):0,[bt,ht,st]=Q.upVector(A.canonical,xe,ve);Ee=Ke*bt*le,Re=Ke*ht*le,Xe=Ke*st*le}let[qe,Ae,Be,Ye]=ur(pe.projectedAnchorX+Ee,pe.projectedAnchorY+Re,pe.projectedAnchorZ+Xe,c?te:M);const pt=ct(x.getCameraToCenterDistance(Q),Ye);let Ct=b.evaluateSizeForFeature(m.textSizeData,N,pe)*pt/f.bw;c&&(Ct*=m.tilePixelRatio/F);const He=ay(ye,Ct);c?(({x:qe,y:Ae,z:Be}=Q.projectTilePoint(xe+He.x,ve+He.y,A.canonical)),[qe,Ae,Be]=ur(qe+Ee,Ae+Re,Be+Xe,M)):(s&&He._rotate(-x.angle),qe+=He.x,Ae+=He.y,Be=0);const dt=m.allowVerticalPlacement&&pe.placedOrientation===f.bq.vertical?Math.PI/2:0;for(let Ke=0;Ke<be;Ke++)f.bt(j,qe,Ae,Be,dt);z&&pe.associatedIconIndex>=0&&(J[pe.associatedIconIndex]={x:qe,y:Ae,z:Be,angle:dt})}else qh(be,j)}if(z){G.clear();const me=m.icon.placedSymbolArray;for(let pe=0;pe<me.length;pe++){const xe=me.get(pe),{numGlyphs:ve}=xe,be=J[pe];if(xe.hidden||!be)qh(ve,G);else{const{x:ye,y:Ee,z:Re,angle:Xe}=be;for(let qe=0;qe<ve;qe++)f.bt(G,ye,Ee,Re,Xe)}}m.icon.dynamicLayoutVertexBuffer.updateData(G)}m.text.dynamicLayoutVertexBuffer.updateData(j)}function sr(m,s,c,g,b,x,M={}){const A=c.paint.get("icon-translate"),F=c.paint.get("text-translate"),N=c.paint.get("icon-translate-anchor"),z=c.paint.get("text-translate-anchor"),H=c.layout.get("icon-rotation-alignment"),j=c.layout.get("text-rotation-alignment"),G=c.layout.get("icon-pitch-alignment"),J=c.layout.get("text-pitch-alignment"),Q=c.layout.get("icon-keep-upright"),te=c.layout.get("text-keep-upright"),ne=c.paint.get("icon-color-saturation"),le=c.paint.get("icon-color-contrast"),me=c.paint.get("icon-color-brightness-min"),pe=c.paint.get("icon-color-brightness-max"),xe="sea"===c.layout.get("symbol-elevation-reference"),ve=m.context,be=ve.gl,ye=m.transform,Ee="map"===H,Re="map"===j,Xe="map"===G,qe="map"===J,Ae=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let Be=!1;const Ye=m.depthModeForSublayer(0,on.ReadOnly),pt=[f.at(ye.center.lng),f.aA(ye.center.lat)],Ct=c.layout.get("text-variable-anchor"),He="globe"===ye.projection.name,dt=[],Ke=[0,-1,0];for(const bt of g){const ht=s.getTile(bt),st=ht.getBucket(c);if(!st||"mercator"===st.projection.name&&He||st.fullyClipped)continue;const Pt="globe"===st.projection.name,Vt=Pt?f.ae(ye.zoom):0,kt=Zh(bt,st.getProjection(),ye),Gt=ye.calculatePixelsToTileUnitsMatrix(ht),hn=Ct&&st.hasTextData(),ln=st.hasIconTextFit()&&hn&&st.hasIconData(),sn=st.getProjection().createInversionMatrix(ye,bt.canonical),Dt=gn=>{ye.depthOcclusionForSymbolsAndCircles&&(c.hasInitialOcclusionOpacityProperties||m.terrain)&&(gn.push("DEPTH_D24"),gn.push("DEPTH_OCCLUSION"))},si=()=>{const gn=Ee&&"point"!==c.layout.get("symbol-placement"),Si=[];Dt(Si);const Lr=gn||ln,Yo=c.paint.get("icon-image-cross-fade").constantOr(0);m.terrainRenderModeElevated()&&Xe&&Si.push("PITCH_WITH_MAP_TERRAIN"),Pt&&(Si.push("PROJECTION_GLOBE_VIEW"),Lr&&Si.push("PROJECTED_POS_ON_VIEWPORT")),Yo>0&&Si.push("ICON_TRANSITION"),st.icon.zOffsetVertexBuffer&&Si.push("Z_OFFSET"),0===ne&&0===le&&0===me&&1===pe||Si.push("COLOR_ADJUSTMENT"),st.sdfIcons&&Si.push("RENDER_SDF");const Fs=st.icon.programConfigurations.get(c.id),us=m.getOrCreateProgram("symbol",{config:Fs,defines:Si}),ko=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],to=st.iconSizeData,Gr=f.bp(to,ye.zoom),pr=Xe||0!==ye.pitch,nr=al(kt,ht.tileID.canonical,Xe,Ee,ye,st.getProjection(),Gt),Ci=as(kt,ht.tileID.canonical,Xe,Ee,ye,st.getProjection(),Gt),Zi=m.translatePosMatrix(Ci,ht,A,N,!0),Fo=m.translatePosMatrix(kt,ht,A,N),ar=Lr?Cp:nr,Ms=Ee&&!Xe&&!gn;let ml=Ke;!He&&!ye.mercatorFromTransition||Ee||(ml=sy(ye));const Ls=Pt?ml:Ke,rd=c.getColorAdjustmentMatrix(ne,le,me,pe),wc=mw(to.kind,Gr,Ms,Xe,m,Fo,ar,Zi,xe,!1,ko,[0,0],!0,bt,Vt,pt,sn,Ls,st.getProjection(),rd,Yo),Ss=ht.imageAtlasTexture?ht.imageAtlasTexture:null,hs=1!==c.layout.get("icon-size").constantOr(0)||st.iconsNeedLinear,In=st.sdfIcons||m.options.rotating||m.options.zooming||hs||pr?be.LINEAR:be.NEAREST,gl=st.sdfIcons&&0!==c.paint.get("icon-halo-width").constantOr(1),nh=m.terrain&&Xe&&gn?f.ab.mat4.invert(f.ab.mat4.create(),nr):Cp;if(gn&&st.icon){const od=ye.elevation,ih=od?od.getAtTileOffsetFunc(bt,ye.center.lat,ye.worldSize,st.getProjection()):null,Dg=Hc(kt,ht.tileID.canonical,Xe,Ee,ye,st.getProjection(),Gt);$h(st,kt,m,!1,Dg,Ci,Xe,Q,ih,bt)}return{program:us,buffers:st.icon,uniformValues:wc,atlasTexture:Ss,atlasTextureIcon:null,atlasInterpolation:In,atlasInterpolationIcon:null,isSDF:st.sdfIcons,hasHalo:gl,tile:ht,labelPlaneMatrixInv:nh}},jn=()=>{const gn=Re&&"point"!==c.layout.get("symbol-placement"),Si=[],Lr=gn||Ct||ln;m.terrainRenderModeElevated()&&qe&&Si.push("PITCH_WITH_MAP_TERRAIN"),Pt&&(Si.push("PROJECTION_GLOBE_VIEW"),Lr&&Si.push("PROJECTED_POS_ON_VIEWPORT")),st.text.zOffsetVertexBuffer&&Si.push("Z_OFFSET"),st.iconsInText&&Si.push("RENDER_TEXT_AND_SYMBOL"),Si.push("RENDER_SDF"),Dt(Si);const Yo=st.text.programConfigurations.get(c.id),Fs=m.getOrCreateProgram("symbol",{config:Yo,defines:Si});let us,ko=[0,0],to=null;const Gr=st.textSizeData;st.iconsInText&&(ko=ht.imageAtlasTexture?ht.imageAtlasTexture.size:[0,0],to=ht.imageAtlasTexture?ht.imageAtlasTexture:null,us=qe||0!==ye.pitch||m.options.rotating||m.options.zooming||"composite"===Gr.kind||"camera"===Gr.kind?be.LINEAR:be.NEAREST);const pr=ht.glyphAtlasTexture?ht.glyphAtlasTexture.size:[0,0],nr=c.layout.get("text-size-scale-range"),Ci=f.aw(m.scaleFactor,nr[0],nr[1]),Zi=f.bp(Gr,ye.zoom,Ci),Fo=al(kt,ht.tileID.canonical,qe,Re,ye,st.getProjection(),Gt),ar=as(kt,ht.tileID.canonical,qe,Re,ye,st.getProjection(),Gt),Ms=m.translatePosMatrix(ar,ht,F,z,!0),ml=m.translatePosMatrix(kt,ht,F,z),Ls=Lr?Cp:Fo,rd=Re&&!qe&&!gn;let wc=Ke;!He&&!ye.mercatorFromTransition||Re||(wc=sy(ye));const Ss=mw(Gr.kind,Zi,rd,qe,m,ml,Ls,Ms,xe,!0,pr,ko,!0,bt,Vt,pt,sn,Pt?wc:Ke,st.getProjection(),null,null,Ci),hs=ht.glyphAtlasTexture?ht.glyphAtlasTexture:null,In=be.LINEAR,gl=0!==c.paint.get("text-halo-width").constantOr(1),nh=m.terrain&&qe&&gn?f.ab.mat4.invert(f.ab.mat4.create(),Fo):Cp;if(gn&&st.text){const od=ye.elevation,ih=od?od.getAtTileOffsetFunc(bt,ye.center.lat,ye.worldSize,st.getProjection()):null,Dg=Hc(kt,ht.tileID.canonical,qe,Re,ye,st.getProjection(),Gt);$h(st,kt,m,!0,Dg,ar,qe,te,ih,bt)}return{program:Fs,buffers:st.text,uniformValues:Ss,atlasTexture:hs,atlasTextureIcon:to,atlasInterpolation:In,atlasInterpolationIcon:us,isSDF:!0,hasHalo:gl,tile:ht,labelPlaneMatrixInv:nh}},hr=st.icon.segments.get().length,fr=st.text.segments.get().length,Fi=hr&&!M.onlyText?si():null,ji=fr&&!M.onlyIcons?jn():null,Zn=c.paint.get("icon-opacity").constantOr(1),Ht=c.paint.get("text-opacity").constantOr(1);if(Ae&&st.canOverlap){Be=!0;const gn=Zn&&!M.onlyText?st.icon.segments.get():[],Si=Ht&&!M.onlyIcons?st.text.segments.get():[];for(const Lr of gn)dt.push({segments:new f.b7([Lr]),sortKey:Lr.sortKey,state:Fi});for(const Lr of Si)dt.push({segments:new f.b7([Lr]),sortKey:Lr.sortKey,state:ji})}else M.onlyText||dt.push({segments:Zn?st.icon.segments:new f.b7([]),sortKey:0,state:Fi}),M.onlyIcons||dt.push({segments:Ht?st.text.segments:new f.b7([]),sortKey:0,state:ji})}Be&&dt.sort((bt,ht)=>bt.sortKey-ht.sortKey);for(const bt of dt){const ht=bt.state;if(ht)if(m.terrain?m.terrain.setupElevationDraw(ht.tile,ht.program,{useDepthForOcclusion:ye.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:ht.labelPlaneMatrixInv}):m.setupDepthForOcclusion(ye.depthOcclusionForSymbolsAndCircles,ht.program),ve.activeTexture.set(be.TEXTURE0),ht.atlasTexture&&ht.atlasTexture.bind(ht.atlasInterpolation,be.CLAMP_TO_EDGE,!0),ht.atlasTextureIcon&&(ve.activeTexture.set(be.TEXTURE1),ht.atlasTextureIcon&&ht.atlasTextureIcon.bind(ht.atlasInterpolationIcon,be.CLAMP_TO_EDGE,!0)),m.uploadCommonLightUniforms(m.context,ht.program),ht.hasHalo){const st=ht.uniformValues;st.u_is_halo=1,_r(ht.buffers,bt.segments,c,m,ht.program,Ye,b,x,st,2),st.u_is_halo=0}else{if(ht.isSDF){const st=ht.uniformValues;ht.hasHalo&&(st.u_is_halo=1,_r(ht.buffers,bt.segments,c,m,ht.program,Ye,b,x,st,1)),st.u_is_halo=0}_r(ht.buffers,bt.segments,c,m,ht.program,Ye,b,x,ht.uniformValues,1)}}}function _r(m,s,c,g,b,x,M,A,F,N){const z=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer];b.draw(g,g.context.gl.TRIANGLES,x,M,A,mn.disabled,F,c.id,m.layoutVertexBuffer,m.indexBuffer,s,c.paint,g.transform.zoom,m.programConfigurations.get(c.id),z,N)}function Tp(m,s,c,g,b,x,M){const A=m.context.gl,F=c.paint.get("fill-pattern"),N=c.is3D(),z=N?m.stencilModeFor3D():Tn.disabled,H=F&&F.constantOr(1);let j,G,J,Q,te;M?(G=H&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=A.LINES):(G=H?"fillPattern":"fill",j=A.TRIANGLES);for(const ne of g){const le=s.getTile(ne);if(H&&!le.patternsLoaded())continue;const me=le.getBucket(c);if(!me)continue;m.prepareDrawTile();const pe=me.programConfigurations.get(c.id),xe=m.isTileAffectedByFog(ne),ve=m.getOrCreateProgram(G,{config:pe,overrideFog:xe});H&&(m.context.activeTexture.set(A.TEXTURE0),le.imageAtlasTexture&&le.imageAtlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE),pe.updatePaintBuffers());const be=F.constantOr(null);if(be&&le.imageAtlas){const Re=le.imageAtlas,Xe=f.A.from(be),qe=Re.patternPositions[Xe.getSerializedPrimary()];qe&&pe.setConstantPatternPositions(qe)}const ye=m.translatePosMatrix(ne.projMatrix,le,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor")),Ee=c.paint.get("fill-emissive-strength");if(M){Q=me.indexBuffer2,te=me.segments2;const Re=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[A.drawingBufferWidth,A.drawingBufferHeight];J="fillOutlinePattern"===G&&H?Io(ye,Ee,m,le,Re):go(ye,Ee,Re)}else Q=me.indexBuffer,te=me.segments,J=H?Kc(ye,Ee,m,le):io(ye,Ee);m.uploadCommonUniforms(m.context,ve,ne.toUnwrapped()),ve.draw(m,j,b,N?z:m.stencilModeForClipping(ne),x,mn.disabled,J,c.id,me.layoutVertexBuffer,Q,te,c.paint,m.transform.zoom,pe,void 0)}}function hf(m,s,c,g,b,x,M,A){c.resetLayerRenderingStats(m);const F=m.context,N=F.gl,z=m.transform,H=c.paint.get("fill-extrusion-pattern"),j=H.constantOr(1),G=c.paint.get("fill-extrusion-opacity"),J=m.style.enable3dLights(),Q=c.paint.get(J&&!j?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),te=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),Q],ne=c.layout.get("fill-extrusion-edge-radius"),le=ne>0&&!c.paint.get("fill-extrusion-rounded-roof"),me=le?0:ne,pe="globe"===z.projection.name?f.d3():0,xe="globe"===z.projection.name,ve=xe?f.ae(z.zoom):0,be=[f.at(z.center.lng),f.aA(z.center.lat)],ye="none"===c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default"),Ee=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(ye?null:c.lut).toArray01().slice(0,3),Re=c.paint.get("fill-extrusion-flood-light-intensity"),Xe=c.paint.get("fill-extrusion-vertical-scale"),qe=0!==c.paint.get("fill-extrusion-line-width").constantOr(1),Ae=c.paint.get("fill-extrusion-height-alignment"),Be=c.paint.get("fill-extrusion-base-alignment"),Ye=Gc(m,c.paint.get("fill-extrusion-cutoff-fade-range")),pt=[];let Ct;xe&&pt.push("PROJECTION_GLOBE_VIEW"),te[0]>0&&pt.push("FAUX_AO"),le&&pt.push("ZERO_ROOF_RADIUS"),A&&pt.push("HAS_CENTROID"),Re>0&&pt.push("FLOOD_LIGHT"),Ye.shouldRenderCutoff&&pt.push("RENDER_CUTOFF"),qe&&pt.push("RENDER_WALL_MODE");const He="shadow"===m.renderPass,dt=m.shadowRenderer,Ke=He&&!!dt;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let bt=[0,0,0];if(dt){const Pt=m.style.directionalLight,Vt=m.style.ambientLight;Pt&&Vt&&(bt=mp(m.style,Pt,Vt)),He||(pt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),dt.useNormalOffset&&pt.push("NORMAL_OFFSET")),Ct=pt.concat(["SHADOWS_SINGLE_CASCADE"])}const ht=Ke?"fillExtrusionDepth":j?"fillExtrusionPattern":"fillExtrusion",st=c.getLayerRenderingStats();for(const Pt of g){const Vt=s.getTile(Pt),kt=Vt.getBucket(c);if(!kt||kt.projection.name!==z.projection.name)continue;let Gt=!1;dt&&(Gt=0===dt.getMaxCascadeForTile(Pt.toUnwrapped()));const hn=m.isTileAffectedByFog(Pt),ln=kt.programConfigurations.get(c.id),sn=m.getOrCreateProgram(ht,{config:ln,defines:Gt?Ct:pt,overrideFog:hn});if(m.terrain&&m.terrain.setupElevationDraw(Vt,sn,{useMeterToDem:!0}),!kt.centroidVertexBuffer){const ji=sn.attributes.a_centroid_pos;void 0!==ji&&N.vertexAttrib2f(ji,0,0)}!He&&dt&&dt.setupShadows(Vt.tileID.toUnwrapped(),sn,"vector-tile",Vt.tileID.overscaledZ),j&&(m.context.activeTexture.set(N.TEXTURE0),Vt.imageAtlasTexture&&Vt.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),ln.updatePaintBuffers());const Dt=H.constantOr(null);if(Dt&&Vt.imageAtlas){const ji=Vt.imageAtlas,Zn=f.A.from(Dt),Ht=ji.patternPositions[Zn.getSerializedPrimary()];Ht&&ln.setConstantPatternPositions(Ht)}const si=c.paint.get("fill-extrusion-vertical-gradient"),jn=1/kt.tileToMeter;let hr;if(He&&dt){if(ta(Vt.tileID,kt,m))continue;const ji=dt.calculateShadowPassMatrixFromTile(Vt.tileID.toUnwrapped());hr=cf(ji,me,jn,Xe,Ae,Be)}else{const ji=m.translatePosMatrix(Pt.expandedProjMatrix,Vt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Zn=z.projection.createInversionMatrix(z,Pt.canonical);hr=j?_c(ji,m,si,G,te,me,jn,Pt,Vt,pe,Ae,Be,ve,be,Zn,Ee,Xe):ja(ji,m,si,G,te,me,jn,Pt,pe,Ae,Be,ve,be,Zn,Ee,Xe,Re,bt)}m.uploadCommonUniforms(F,sn,Pt.toUnwrapped(),null,Ye);let fr=kt.segments;if("mercator"===z.projection.name&&!He&&(fr=kt.getVisibleSegments(Vt.tileID,m.terrain,m.transform.getFrustum(0)),!fr.get().length))continue;if(st)if(He)for(const ji of fr.get())st.numRenderedVerticesInShadowPass+=ji.primitiveLength;else for(const ji of fr.get())st.numRenderedVerticesInTransparentPass+=ji.primitiveLength;const Fi=[];(m.terrain||A)&&Fi.push(kt.centroidVertexBuffer),xe&&Fi.push(kt.layoutVertexExtBuffer),qe&&Fi.push(kt.wallVertexBuffer),sn.draw(m,F.gl.TRIANGLES,b,x,M,mn.backCCW,hr,c.id,kt.layoutVertexBuffer,kt.indexBuffer,fr,c.paint,m.transform.zoom,ln,Fi)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}function Nd(m,s,c,g,b,x,M,A,F,N,z,H,j,G,J,Q,te,ne,le){const me=m.context,pe=me.gl,xe=m.transform,ve=m.transform.zoom,be=[],ye=Gc(m,c.paint.get("fill-extrusion-cutoff-fade-range"));"clear"===N?(be.push("CLEAR_SUBPASS"),le&&(be.push("CLEAR_FROM_TEXTURE"),me.activeTexture.set(pe.TEXTURE0),le.bind(pe.LINEAR,pe.CLAMP_TO_EDGE))):"sdf"===N&&be.push("SDF_SUBPASS"),te&&be.push("HAS_CENTROID"),ye.shouldRenderCutoff&&be.push("RENDER_CUTOFF");const Ee=c.layout.get("fill-extrusion-edge-radius"),Re=(Xe,qe,Ae,Be,Ye)=>{const pt=qe.programConfigurations.get(c.id),Ct=m.isTileAffectedByFog(Xe),He=m.getOrCreateProgram("fillExtrusionGroundEffect",{config:pt,defines:be,overrideFog:Ct}),dt=((bt,ht,st,Pt,Vt,kt,Gt,hn,ln,sn,Dt)=>({u_matrix:ht,u_opacity:st,u_ao_pass:Pt?1:0,u_meter_to_tile:Vt,u_ao:kt,u_flood_light_intensity:Gt,u_flood_light_color:hn,u_attenuation:ln,u_edge_radius:sn,u_fb:0,u_fb_size:Dt,u_dynamic_offset:1}))(0,Be,z,F,Ye,[H,j*Ye],G,J,Q,ve>=17?0:Ee*Ye,le?le.size[0]:0),Ke=[];te&&Ke.push(qe.hiddenByLandmarkVertexBuffer),m.uploadCommonUniforms(me,He,Xe.toUnwrapped(),null,ye),He.draw(m,me.gl.TRIANGLES,b,x,M,A,dt,c.id,qe.vertexBuffer,qe.indexBuffer,Ae,c.paint,ve,pt,Ke)};for(const Xe of g){const qe=s.getTile(Xe),Ae=qe.getBucket(c);if(!Ae||Ae.projection.name!==xe.projection.name||!Ae.groundEffect||Ae.groundEffect&&!Ae.groundEffect.hasData())continue;const Be=Ae.groundEffect,Ye=1/Ae.tileToMeter;{const pt=m.translatePosMatrix(Xe.projMatrix,qe,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Ct=Be.getDefaultSegment();Re(Xe,Be,Ct,pt,Ye)}if(ne)for(let pt=0;pt<4;pt++){const Ct=f.d4[pt](Xe),He=s.getTile(Ct);if(!He)continue;const dt=He.getBucket(c);if(!dt||dt.projection.name!==xe.projection.name||!dt.groundEffect||dt.groundEffect&&!dt.groundEffect.hasData())continue;const Ke=dt.groundEffect;let bt,ht;0===pt?(bt=[-f.ag,0,0],ht=1):1===pt?(bt=[f.ag,0,0],ht=0):2===pt?(bt=[0,-f.ag,0],ht=3):(bt=[0,f.ag,0],ht=2);const st=Ke.regionSegments[ht];if(!st)continue;const Pt=new Float32Array(16);f.ab.mat4.translate(Pt,Xe.projMatrix,bt),Re(Xe,Ke,st,m.translatePosMatrix(Pt,qe,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Ye)}}}function cy(m,s,c,g,b,x,M){0===g.centroidVertexArray.length&&g.createCentroidsBuffer();const A=x?x.findDEMTileFor(c):null;if(!(A&&A.dem||M))return;x&&A&&A.dem&&g.selfDEMTileTimestamp!==A.dem._timestamp&&(g.borderDoneWithNeighborZ=[-1,-1,-1,-1],g.selfDEMTileTimestamp=A.dem._timestamp);const F=ne=>new f.P(Math.ceil((ne+f.d7)*f.d8),0),N=ne=>{const le=s.getSource().minzoom,me=xe=>{const ve=s.getTileByID(xe);if(ve&&ve.hasData())return ve.getBucket(b)},pe=[0,-1,1];for(const xe of pe){if(ne.overscaledZ+xe<le)continue;const ve=me(ne.calculateScaledKey(ne.overscaledZ+xe));if(ve)return ve}},z=[0,0,0],H=(ne,le)=>(z[0]=Math.min(ne.min.y,le.min.y),z[1]=Math.max(ne.max.y,le.max.y),z[2]=f.ag-le.min.x>ne.max.x?le.min.x-f.ag:ne.max.x,z),j=(ne,le)=>(z[0]=Math.min(ne.min.x,le.min.x),z[1]=Math.max(ne.max.x,le.max.x),z[2]=f.ag-le.min.y>ne.max.y?le.min.y-f.ag:ne.max.y,z),G=[(ne,le)=>H(ne,le),(ne,le)=>H(le,ne),(ne,le)=>j(ne,le),(ne,le)=>j(le,ne)],J=(ne,le,me,pe,xe,ve,be)=>{if(!x)return 0;const ye=[[ve?me:ne,ve?ne:me,0],[ve?me:le,ve?le:me,0]],Ee=be<0?f.ag+be:be,Re=[ve?Ee:(ne+le)/2,ve?(ne+le)/2:Ee,0];return 0===me&&be<0||0!==me&&be>0?x.getForTilePoints(xe,[Re],!0,pe):ye.push(Re),x.getForTilePoints(c,ye,!0,A),Math.max(ye[0][2],ye[1][2],Re[2])/x.exaggeration()};for(let ne=0;ne<4;ne++){const le=g.borderFeatureIndices[ne];if(0===le.length)continue;const me=f.d4[ne](c),pe=N(me);if(!(pe&&pe instanceof f.d5))continue;const xe=x?x.findDEMTileFor(me):null;if(!(xe&&xe.dem||M)||(x&&xe&&xe.dem&&g.borderDEMTileTimestamp[ne]!==xe.dem._timestamp&&(g.borderDoneWithNeighborZ[ne]=-1,g.borderDEMTileTimestamp[ne]=xe.dem._timestamp),g.borderDoneWithNeighborZ[ne]===pe.canonical.z))continue;0===pe.centroidVertexArray.length&&pe.createCentroidsBuffer();const ve=(ne<2?1:5)-ne,be=pe.borderDoneWithNeighborZ[ve]!==g.canonical.z,ye=pe.borderFeatureIndices[ve];let Ee=0;if(g.canonical.z!==pe.canonical.z){for(const Re of le)g.showCentroid(g.featuresOnBorder[Re]);if(be)for(const Re of ye)pe.showCentroid(pe.featuresOnBorder[Re]);g.borderDoneWithNeighborZ[ne]=pe.canonical.z,pe.borderDoneWithNeighborZ[ve]=g.canonical.z}for(const Re of le){const Xe=g.featuresOnBorder[Re],qe=g.centroidData[Xe.centroidDataIndex],Ae=Xe.borders[ne];let Be;for(;Ee<ye.length;){Be=pe.featuresOnBorder[ye[Ee]];const Ye=Be.borders[ve];if(Ye[1]>Ae[0]+3||Ye[0]>Ae[0]-3)break;pe.showCentroid(Be),Ee++}if(Be&&Ee<ye.length){const Ye=Ee;let pt=0;for(;!(Be.borders[ve][0]>Ae[1]-3)&&(pt++,++Ee!==ye.length);)Be=pe.featuresOnBorder[ye[Ee]];Be=pe.featuresOnBorder[ye[Ye]];let Ct=!1;if(pt>=1){const Ke=Be.borders[ve];Math.abs(Ae[0]-Ke[0])<3&&Math.abs(Ae[1]-Ke[1])<3&&(pt=1,Ct=!0,Ee=Ye+1)}else if(0===pt){g.showCentroid(Xe);continue}const He=pe.centroidData[Be.centroidDataIndex];M&&Ct&&(((Q=qe).flags|(te=He).flags)&f.d6?(Q.flags|=f.d6,te.flags|=f.d6):(Q.flags&=~f.d6,te.flags&=~f.d6));const dt=Xe.intersectsCount()>1||Be.intersectsCount()>1;if(pt>1)Ee=Ye,qe.centroidXY=He.centroidXY=new f.P(0,0);else if(xe&&xe.dem&&!dt){const Ke=G[ne](qe,He),bt=ne%2?f.ag-1:0,ht=J(Ke[0],Math.min(f.ag-1,Ke[1]),bt,xe,me,ne<2,Ke[2]);qe.centroidXY=He.centroidXY=F(ht)}else dt?qe.centroidXY=He.centroidXY=new f.P(0,0):(qe.centroidXY=g.encodeBorderCentroid(Xe),He.centroidXY=pe.encodeBorderCentroid(Be));g.writeCentroidToBuffer(qe),pe.writeCentroidToBuffer(He)}else g.showCentroid(Xe)}g.borderDoneWithNeighborZ[ne]=pe.canonical.z,pe.borderDoneWithNeighborZ[ve]=g.canonical.z}var Q,te;(g.needsCentroidUpdate||!g.centroidVertexBuffer&&0!==g.centroidVertexArray.length)&&g.uploadCentroid(m)}const Eb=[1,0,0],dy=[0,1,0],ff=[0,0,1];function ta(m,s,c){const g=c.transform,b=c.shadowRenderer;if(!b)return!0;const x=m.toUnwrapped(),M=g.tileSize*b._cascades[c.currentShadowCascade].scale;let A=s.maxHeight;if(g.elevation){const Q=g.elevation.getMinMaxForTile(m);Q&&(A+=Q.max)}const F=[...b.shadowDirection];F[2]=-F[2];const N=b.computeSimplifiedTileShadowVolume(x,A,M,F);if(!N)return!1;const z=[Eb,dy,ff,F,[F[0],0,F[2]],[0,F[1],F[2]]],H="globe"===g.projection.name,j=g.scaleZoom(M),G=f.bR.fromInvProjectionMatrix(g.invProjMatrix,g.worldSize,j,!H),J=b.getCurrentCascadeFrustum();return 0===G.intersectsPrecise(N.vertices,N.planes,z)||0===J.intersectsPrecise(N.vertices,N.planes,z)}function wt(m){return[m[0]*f.d9,m[1]*f.d9,m[2]*f.d9,0]}function jt(m,s,c,g,b,x,M,A,F){const N=g.getSource(),z=c.globeSharedBuffers;if(!z)return;let H,j,G;if(s&&(H=g.getTile(s)),N instanceof f.aJ?(j=N.texture,G=f.cI(0,0,c.transform)):H&&s&&(j=H.texture,G=f.cI(s.canonical.z,s.canonical.x,c.transform)),!j||!G)return;m||(G=f.ab.mat4.scale(f.ab.mat4.create(),G,[1,-1,1]));const J=c.context,Q=J.gl,te="nearest"===b.paint.get("raster-resampling")?Q.NEAREST:Q.LINEAR,ne=c.colorModeForDrapableLayerRenderPass(x),le=M.defines;le.push("GLOBE_POLES");const me=new on(Q.LEQUAL,on.ReadWrite,c.depthRangeFor3D),pe=Float32Array.from(c.transform.expandedFarZProjMatrix),xe=Float32Array.from(f.bb(f.cH(new f.bT(0,0,0))));c.terrain&&c.terrain.prepareDrawTile(),J.activeTexture.set(Q.TEXTURE0),j.bind(te,Q.CLAMP_TO_EDGE),J.activeTexture.set(Q.TEXTURE1),j.bind(te,Q.CLAMP_TO_EDGE),j.useMipmap&&J.extTextureFilterAnisotropic&&c.transform.pitch>20&&Q.texParameterf(Q.TEXTURE_2D,J.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,J.extTextureFilterAnisotropicMax);const[ve,be,ye,Ee]=s?z.getPoleBuffers(s.canonical.z,!1):z.getPoleBuffers(0,!0),Re=b.paint.get("raster-elevation");let Xe;m?(Xe=ve,c.renderDefaultNorthPole=0!==Re):(Xe=be,c.renderDefaultSouthPole=0!==Re);const qe=wt(M.mix),Ae=(Ye=pe,pt=xe,Ct=G,He=f.ae(c.transform.zoom),Ke=b,ht=Re,Pt=qe,Vt=M.offset,kt=M.range,Gt=x,Zt(Ye,pt,Ct,new Float32Array(16),new Float32Array(9),[0,0],He,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Ke,[0,0],ht,2,Pt,Vt,kt,1,0,Gt)),Be=c.getOrCreateProgram("raster",{defines:le});var Ye,pt,Ct,He,Ke,ht,Pt,Vt,kt,Gt;c.uploadCommonUniforms(J,Be,null),Be.draw(c,Q.TRIANGLES,me,F,ne,A,Ae,b.id,Xe,ye,Ee)}function Ki(m){const s=m._nearZ,c=m.projection.farthestPixelDistance(m),g=c-s,b=.2*m.height,x=s+b;return[s,c,(x-b-s)/g,(x-s)/g]}function Pr(m,s,c,g){if(m)return s instanceof Sd&&m instanceof j_?s.getTextureDescriptor(m,c,!0):{texture:m.texture,mix:wt(g.mix),offset:g.offset,buffer:0,tileSize:1}}var Ge=f.da([{name:"a_index",type:"Int16",components:1}]);class Ps{constructor(s,c,g,b){const x={width:g[0],height:g[1],data:null},M=s.gl;this.targetColorTexture=new f.T(s,x,M.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new f.T(s,x,M.RGBA8,{useMipmap:!1}),this.context=s,this.updateParticleTexture(c,b),this.lastInvalidatedAt=0}updateParticleTexture(s,c){if(this.particleTextureDimension===c.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const g=this.context.gl,b=c.width*c.height;this.particleTexture0=new f.T(this.context,c,g.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new f.T(this.context,c,g.RGBA8,{premultiply:!1,useMipmap:!1});const x=new f.db;x.reserve(b);for(let M=0;M<b;M++)x.emplaceBack(M);this.particleIndexBuffer=this.context.createVertexBuffer(x,Ge.members,!0),this.particleSegment=f.b7.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=c.width}update(s){return!(this.lastInvalidatedAt<s&&(this.lastInvalidatedAt=f.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function mg(m,s,c){if(!m)return null;const g=s.getTextureDescriptor(m,c,!0);if(!g)return null;let{texture:b,mix:x,offset:M,tileSize:A,buffer:F,format:N}=g;if(!b||!N)return null;let z=!1;return"uint32"===N&&(z=!0,x[3]=0,x=zl(f.dc,x,[0,c.paint.get("raster-particle-max-speed")]),M=uf(f.dc,M,[0,c.paint.get("raster-particle-max-speed")])),{texture:b,textureOffset:[F/(A+2*F),A/(A+2*F)],tileSize:A,scalarData:z,scale:x,offset:M,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[N]]}}function zd(m){const s=m._nearZ,c=m.projection.farthestPixelDistance(m),g=c-s,b=.2*m.height,x=s+b;return[s,c,(x-b-s)/g,(x-s)/g]}const Bd=new f.aj(1,0,0,1),Ta=new f.aj(0,1,0,1),Db=new f.aj(0,0,1,1),Vd=new f.aj(1,0,1,1),yw=new f.aj(0,1,1,1);function ws(m,s,c,g,b,x,M){const A=m.context,F=m.transform,N=A.gl,z="globe"===F.projection.name,H=z?["PROJECTION_GLOBE_VIEW"]:[];let j=f.ab.mat4.clone(c.projMatrix);if(z&&f.ae(F.zoom)>0){const qe=f.ba(c.canonical,F),Ae=f.dd(qe);j=f.ab.mat4.multiply(new Float32Array(16),F.globeMatrix,Ae),f.ab.mat4.multiply(j,F.projMatrix,j)}const G=f.ab.mat4.create();G[12]+=2*b/(f.q.devicePixelRatio*F.width),G[13]+=2*x/(f.q.devicePixelRatio*F.height),f.ab.mat4.multiply(j,G,j);const J=m.getOrCreateProgram("debug",{defines:H}),Q=s.getTileByID(c.key);m.terrain&&m.terrain.setupElevationDraw(Q,J);const te=on.disabled,ne=Tn.disabled,le=m.colorModeForRenderPass();A.activeTexture.set(N.TEXTURE0),m.emptyTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),z?Q._makeGlobeTileDebugBuffers(m.context,F):Q._makeDebugTileBoundsBuffers(m.context,F.projection);const pe=Q._tileDebugBuffer||m.debugBuffer,xe=Q._tileDebugIndexBuffer||m.debugIndexBuffer,ve=Q._tileDebugSegments||m.debugSegments;if(J.draw(m,N.LINE_STRIP,te,ne,le,mn.disabled,Ll(j,g),"$debug",pe,xe,ve,null,null,null,[Q._globeTileDebugBorderBuffer]),M){const qe=Q.latestRawTileData,Ae=Math.floor((qe&&qe.byteLength||0)/1024);let Be=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Be+=` => ${c.overscaledZ}`),Be+=` ${Q.state}`,Be+=` ${Ae}kb`,function(Ye,pt){Ye.initDebugOverlayCanvas();const Ct=Ye.debugOverlayCanvas,He=Ye.context.gl,dt=Ye.debugOverlayCanvas.getContext("2d");dt.clearRect(0,0,Ct.width,Ct.height),dt.shadowColor="white",dt.shadowBlur=2,dt.lineWidth=1.5,dt.strokeStyle="white",dt.textBaseline="top",dt.font="bold 36px Open Sans, sans-serif",dt.fillText(pt,5,5),dt.strokeText(pt,5,5),Ye.debugOverlayTexture.update(Ct),Ye.debugOverlayTexture.bind(He.LINEAR,He.CLAMP_TO_EDGE)}(m,Be)}const be=s.getTile(c).tileSize,ye=512/Math.min(be,512)*(c.overscaledZ/F.zoom)*.5,Ee=Q._tileDebugTextBuffer||m.debugBuffer,Re=Q._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Xe=Q._tileDebugTextSegments||m.debugSegments;J.draw(m,N.TRIANGLES,te,ne,An.alphaBlended,mn.disabled,Ll(j,f.aj.transparent,ye),"$debug",Ee,Re,Xe,null,null,null,[Q._globeTileDebugTextBuffer])}function gg(m,s,c,g){$u(m,0,s+c/2,m.transform.width,c,g)}function Hu(m,s,c,g){$u(m,s-c/2,0,c,m.transform.height,g)}function $u(m,s,c,g,b,x){const M=m.context,A=M.gl;A.enable(A.SCISSOR_TEST),A.scissor(s*f.q.devicePixelRatio,c*f.q.devicePixelRatio,g*f.q.devicePixelRatio,b*f.q.devicePixelRatio),M.clear({color:x}),A.disable(A.SCISSOR_TEST)}const Mp=f.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:_g}=Mp;function na(m,s,c,g){m.emplaceBack(s,c,g)}class Ud{constructor(s){this.vertexArray=new f.de,this.indices=new f.aU,na(this.vertexArray,-1,-1,1),na(this.vertexArray,1,-1,1),na(this.vertexArray,-1,1,1),na(this.vertexArray,1,1,1),na(this.vertexArray,-1,-1,-1),na(this.vertexArray,1,-1,-1),na(this.vertexArray,-1,1,-1),na(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=s.createVertexBuffer(this.vertexArray,_g),this.indexBuffer=s.createIndexBuffer(this.indices),this.segment=f.b7.simpleSegment(0,0,36,12)}}function Cs(m,s,c,g,b,x){const M=m.context.gl,A=s.paint.get("sky-atmosphere-color"),F=s.paint.get("sky-atmosphere-halo-color"),N=s.paint.get("sky-atmosphere-sun-intensity"),z={u_matrix_3f:f.ab.mat3.fromMat4(f.ab.mat3.create(),g),u_sun_direction:b,u_sun_intensity:N,u_color_tint_r:[(J=A).r,J.g,J.b,J.a],u_color_tint_m:[(Q=F).r,Q.g,Q.b,Q.a],u_luminance:5e-5};var J,Q;M.framebufferTexture2D(M.FRAMEBUFFER,M.COLOR_ATTACHMENT0,M.TEXTURE_CUBE_MAP_POSITIVE_X+x,s.skyboxTexture,0),c.draw(m,M.TRIANGLES,on.disabled,Tn.disabled,An.unblended,mn.frontCW,z,"skyboxCapture",s.skyboxGeometry.vertexBuffer,s.skyboxGeometry.indexBuffer,s.skyboxGeometry.segment)}const vc=f.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class wi{constructor(s){const c=new f.df;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const g=new f.aU;g.emplaceBack(0,1,2),g.emplaceBack(2,3,0),this.vertexBuffer=s.createVertexBuffer(c,vc.members),this.indexBuffer=s.createIndexBuffer(g),this.segments=f.b7.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const ds=f.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class uy{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Gu{constructor(s){this.colorModeAlphaBlendedWriteRGB=new An([1,771,1,771],f.aj.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new An([1,0,1,0],f.aj.transparent,[!1,!1,!1,!0]),this.params=new uy,this.updateNeeded=!0,s.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),s.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),s.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(s){const c=s.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new wi(c);const g=this.params.sizeRange,b=this.params.intensityRange,x=function(z){const H=f.di(30),j=[];for(let G=0;G<z;++G){const J=2*Math.PI*H(),Q=Math.acos(1-2*H())-.5*Math.PI;j.push(f.ab.vec3.fromValues(Math.cos(Q)*Math.cos(J),Math.cos(Q)*Math.sin(J),Math.sin(Q)))}return j}(this.params.starsCount),M=f.di(300),A=new f.dg,F=new f.aU;let N=0;for(let z=0;z<x.length;++z){const H=f.ab.vec3.scale([],x[z],200),j=Math.max(0,1+.01*g*(1*M()-.5)),G=Math.max(0,1+.01*b*(1*M()-.5));A.emplaceBack(H[0],H[1],H[2],-1,-1,j,G),A.emplaceBack(H[0],H[1],H[2],1,-1,j,G),A.emplaceBack(H[0],H[1],H[2],1,1,j,G),A.emplaceBack(H[0],H[1],H[2],-1,1,j,G),F.emplaceBack(N+0,N+1,N+2),F.emplaceBack(N+0,N+2,N+3),N+=4}this.starsVx=c.createVertexBuffer(A,ds.members),this.starsIdx=c.createIndexBuffer(F),this.starsSegments=f.b7.simpleSegment(0,0,A.length,F.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(s,c){const g=s.context,b=g.gl,x=s.transform,M=new on(b.LEQUAL,on.ReadOnly,[0,1]),A=f.ae(x.zoom),F=s.style.getLut(c.scope),N="none"===c.properties.get("color-use-theme"),z=c.properties.get("color").toRenderColor(N?null:F).toArray01(),H="none"===c.properties.get("high-color-use-theme"),j=c.properties.get("high-color").toRenderColor(H?null:F).toArray01(),G="none"===c.properties.get("space-color-use-theme"),J=c.properties.get("space-color").toRenderColor(G?null:F).toArray01PremultipliedAlpha(),Q=5e-4,te=f.dh(c.properties.get("horizon-blend"),0,1,Q,.25),ne=f.cC(s,g,x)&&te===Q?x.worldSize/(2*Math.PI*1.025)-1:x.globeRadius,le=s.frameCounter/1e3%1,me=f.ab.vec3.length(x.globeCenterInViewSpace),pe=Math.sqrt(Math.pow(me,2)-Math.pow(ne,2)),xe=Math.acos(pe/me),ve=be=>{const ye="globe"===x.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];be&&ye.push("ALPHA_PASS");const Ee=s.getOrCreateProgram("globeAtmosphere",{defines:ye}),Re=((qe,Ae,Be,Ye,pt,Ct,He,dt,Ke,bt,ht,st)=>({u_frustum_tl:qe,u_frustum_tr:Ae,u_frustum_br:Be,u_frustum_bl:Ye,u_horizon:pt,u_transition:Ct,u_fadeout_range:He,u_color:dt,u_high_color:Ke,u_space_color:bt,u_temporal_offset:ht,u_horizon_angle:st}))(x.frustumCorners.TL,x.frustumCorners.TR,x.frustumCorners.BR,x.frustumCorners.BL,x.frustumCorners.horizon,A,te,z,j,J,le,xe);s.uploadCommonUniforms(g,Ee);const Xe=this.atmosphereBuffer;Xe&&Ee.draw(s,b.TRIANGLES,M,Tn.disabled,be?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,mn.backCW,Re,be?"atmosphere_glow_alpha":"atmosphere_glow",Xe.vertexBuffer,Xe.indexBuffer,Xe.segments)};ve(!1),ve(!0)}drawStars(s,c){const g=f.aw(c.properties.get("star-intensity"),0,1);if(0===g)return;const b=s.context,x=b.gl,M=s.transform,A=s.getOrCreateProgram("stars"),F=f.ab.quat.identity([]);f.ab.quat.rotateX(F,F,-M._pitch),f.ab.quat.rotateZ(F,F,-M.angle),f.ab.quat.rotateX(F,F,f.ai(M._center.lat)),f.ab.quat.rotateY(F,F,-f.ai(M._center.lng));const N=f.ab.mat4.fromQuat(new Float32Array(16),F),z=f.ab.mat4.multiply([],M.starsProjMatrix,N),H=f.ab.mat3.fromMat4([],N),j=f.ab.mat3.invert([],H),G=[0,1,0];f.ab.vec3.transformMat3(G,G,j),f.ab.vec3.scale(G,G,this.params.sizeMultiplier);const J=[1,0,0];f.ab.vec3.transformMat3(J,J,j),f.ab.vec3.scale(J,J,this.params.sizeMultiplier);const Q=(te=G,ne=J,le=g,{u_matrix:Float32Array.from(z),u_up:te,u_right:ne,u_intensity_multiplier:le});var te,ne,le;s.uploadCommonUniforms(b,A),this.starsVx&&this.starsIdx&&A.draw(s,x.TRIANGLES,on.disabled,Tn.disabled,this.colorModeAlphaBlendedWriteRGB,mn.disabled,Q,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function yr(m,s){const c=[...m],g=s.cameraWorldSizeForFog/s.worldSize,b=f.ab.mat4.identity([]);return f.ab.mat4.scale(b,b,[g,g,1]),f.ab.mat4.multiply(c,b,c),f.ab.mat4.multiply(c,s.worldToFogMatrix,c),c}function Ri(m,s,c,g,b){const x=c.material,M=g.context,{baseColorTexture:A,metallicRoughnessTexture:F}=x.pbrMetallicRoughness,{normalTexture:N,occlusionTexture:z,emissionTexture:H}=x;function j(J,Q,te){if(J&&(m.push(Q),M.activeTexture.set(M.gl.TEXTURE0+te),J.gfxTexture)){const{minFilter:ne,magFilter:le,wrapS:me,wrapT:pe}=J.sampler;J.gfxTexture.bindExtraParam(ne,le,me,pe)}}j(A,"HAS_TEXTURE_u_baseColorTexture",Kr_BaseColor),j(F,"HAS_TEXTURE_u_metallicRoughnessTexture",Kr_MetallicRoughness),j(N,"HAS_TEXTURE_u_normalTexture",Kr_Normal),j(z,"HAS_TEXTURE_u_occlusionTexture",Kr_Occlusion),j(H,"HAS_TEXTURE_u_emissionTexture",Kr_Emission),b&&(b.texture||(b.texture=new f.dk(g.context,b.image,[b.image.height,b.image.height,b.image.height],M.gl.RGBA8)),M.activeTexture.set(M.gl.TEXTURE0+Kr_LUT),b.texture&&b.texture.bind(M.gl.LINEAR,M.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),c.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),s.push(c.texcoordBuffer)),c.colorBuffer&&(m.push(12===c.colorBuffer.itemSize?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),s.push(c.colorBuffer)),c.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),s.push(c.normalBuffer)),c.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),s.push(c.pbrBuffer)),"OPAQUE"!==x.alphaMode&&"MASK"!==x.alphaMode||m.push("UNPREMULT_TEXTURE_IN_SHADER"),x.defined||m.push("DIFFUSE_SHADED"),m.push("USE_STANDARD_DERIVATIVES");const G=g.shadowRenderer;G&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),G.useNormalOffset&&m.push("NORMAL_OFFSET"))}function Sp(m,s,c,g,b,x){const M=c.paint.get("model-opacity").constantOr(1),A=s.context,F=new on(s.context.gl.LEQUAL,on.ReadWrite,s.depthRangeFor3D),N=s.transform,z=m.mesh,H=z.material,j=H.pbrMetallicRoughness,G=s.style.fog;let J;J="pixels"===s.transform.projection.zAxisUnit?[...m.nodeModelMatrix]:f.ab.mat4.multiply([],g.zScaleMatrix,m.nodeModelMatrix),f.ab.mat4.multiply(J,g.negCameraPosMatrix,J);const Q=f.ab.mat4.invert([],J);f.ab.mat4.transpose(Q,Q);const te="none"===c.paint.get("model-color-use-theme").constantOr("default"),ne=c.paint.get("model-emissive-strength").constantOr(0),le=ry(new Float32Array(m.worldViewProjection),new Float32Array(J),new Float32Array(Q),null,s,M,j.baseColorFactor.toRenderColor(null),H.emissiveFactor,j.metallicFactor,j.roughnessFactor,H,ne,c),me={defines:[]},pe=[],xe=s.shadowRenderer;xe&&(xe.useNormalOffset=!1),Ri(me.defines,pe,z,s,te?null:c.lut);let ve=null;if(G){const Ee=yr(m.nodeModelMatrix,s.transform);if(ve=new Float32Array(Ee),"globe"!==N.projection.name){const Re=z.aabb.min,Xe=z.aabb.max,[qe,Ae]=G.getOpacityForBounds(Ee,Re[0],Re[1],Xe[0],Xe[1]);me.overrideFog=qe>=Mt||Ae>=Mt}}const be=Gc(s,c.paint.get("model-cutoff-fade-range"));be.shouldRenderCutoff&&me.defines.push("RENDER_CUTOFF");const ye=s.getOrCreateProgram("model",me);s.uploadCommonUniforms(A,ye,null,ve,be),"shadow"!==s.renderPass&&xe&&xe.setupShadowsFromMatrix(m.nodeModelMatrix,ye),ye.draw(s,A.gl.TRIANGLES,F,b,x,z.material.doubleSided?mn.disabled:mn.backCCW,le,c.id,z.vertexBuffer,z.indexBuffer,z.segments,c.paint,s.transform.zoom,void 0,pe)}function Jc(m,s,c,g,b,x,M){let A;A="globe"===m.projection.name?f.dl(c,m):[...c],f.ab.mat4.multiply(A,A,s.matrix);const F=f.ab.mat4.multiply([],g,A);if(s.meshes)for(const N of s.meshes){if("BLEND"!==N.material.alphaMode){M.push({mesh:N,depth:0,modelIndex:b,worldViewProjection:F,nodeModelMatrix:A});continue}const z=f.ab.vec3.transformMat4([],N.centroid,F);z[2]>0&&x.push({mesh:N,depth:z[2],modelIndex:b,worldViewProjection:F,nodeModelMatrix:A})}if(s.children)for(const N of s.children)Jc(m,N,c,g,b,x,M)}function qu(m,s,c,g){const b=c.shadowRenderer;if(!b)return;const x=b.getShadowPassDepthMode(),M=b.getShadowPassColorMode(),A=b.calculateShadowPassMatrixFromMatrix(s),F=_w(A);c.getOrCreateProgram("modelDepth",{defines:c._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(c,c.context.gl.TRIANGLES,x,Tn.disabled,M,mn.backCCW,F,g.id,m.vertexBuffer,m.indexBuffer,m.segments,g.paint,c.transform.zoom,void 0,void 0)}function fl(m,s,c){const g=s.updateZoomBasedPaintProperties(),b=function(x,M,A){let F,N,z,H=x.terrain?x.terrain.exaggeration():0;if(x.terrain&&H>0){const j=x.terrain,G=j.findDEMTileFor(A);G&&G.dem?F=f.dn.create(j,A,G):H=0}if(0===H&&(M.terrainElevationMin=0,M.terrainElevationMax=0),H===M.validForExaggeration&&(0===H||F&&F._demTile&&F._demTile.tileID===M.validForDEMTile.id&&F._dem._timestamp===M.validForDEMTile.timestamp))return!1;for(const j in M.instancesPerModel){const G=M.instancesPerModel[j];for(let J=0;J<G.instancedDataArray.length;++J){const Q=(F?H*F.getElevationAt(0|G.instancedDataArray.float32[16*J],0|G.instancedDataArray.float32[16*J+1],!0,!0):0)+G.instancesEvaluatedElevation[J];G.instancedDataArray.float32[16*J+6]=Q,N=N?Math.min(M.terrainElevationMin,Q):Q,z=z?Math.max(M.terrainElevationMax,Q):Q}}return M.terrainElevationMin=N||0,M.terrainElevationMax=z||0,M.validForExaggeration=H,M.validForDEMTile=F&&F._demTile?{id:F._demTile.tileID,timestamp:F._dem._timestamp}:{id:void 0,timestamp:0},!0}(m,s,c);(g||b)&&(s.uploaded=!1,s.upload(m.context))}const pl={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new f.cd([0,0,0],[f.ag,f.ag,0])};function hy(m,s){const c=1<<m.canonical.z,g=s.getFreeCameraOptions().position,b=s.elevation,x=m.canonical.x/c,M=(m.canonical.x+1)/c,A=m.canonical.y/c,F=(m.canonical.y+1)/c;let N=s._centerAltitude;if(b){const G=b.getMinMaxForTile(m);G&&G.max>N&&(N=G.max)}const z=f.aw(g.x,x,M)-g.x,H=f.aw(g.y,A,F)-g.y,j=f.bH(N,s.center.lat)-g.z;return s._zoomFromMercatorZ(Math.sqrt(z*z+H*H+j*j))}function ed(m,s,c,g,b,x,M){const A=m.context,F="shadow"===m.renderPass,N=m.shadowRenderer,z=F&&N?N.getShadowPassDepthMode():new on(A.gl.LEQUAL,on.ReadWrite,m.depthRangeFor3D),H=m.isTileAffectedByFog(x);if(c.meshes)for(const j of c.meshes){const G=["MODEL_POSITION_ON_GPU"],J=[];let Q,te,ne;g.instancedDataArray.length>20&&G.push("INSTANCED_ARRAYS");const le=Gc(m,s.paint.get("model-cutoff-fade-range"));if(le.shouldRenderCutoff&&G.push("RENDER_CUTOFF"),F&&N)Q=m.getOrCreateProgram("modelDepth",{defines:G}),te=_w(M.shadowTileMatrix,M.shadowTileMatrix,Float32Array.from(c.matrix)),ne=N.getShadowPassColorMode();else{Ri(G,J,j,m,"none"===s.paint.get("model-color-use-theme").constantOr("default")?null:s.lut),Q=m.getOrCreateProgram("model",{defines:G,overrideFog:H});const pe=j.material,xe=pe.pbrMetallicRoughness,ve=s.paint.get("model-opacity").constantOr(1),be=s.paint.get("model-emissive-strength").constantOr(0);te=ry(x.expandedProjMatrix,Float32Array.from(c.matrix),new Float32Array(16),null,m,ve,xe.baseColorFactor.toRenderColor(null),pe.emissiveFactor,xe.metallicFactor,xe.roughnessFactor,pe,be,s,b),N&&(M.shadowUniformsInitialized?Q.setShadowUniformValues(A,N.getShadowUniformValues()):(N.setupShadows(x.toUnwrapped(),Q,"model-tile",x.overscaledZ),M.shadowUniformsInitialized=!0)),ne=le.shouldRenderCutoff||ve<1||"OPAQUE"!==pe.alphaMode?An.alphaBlended:An.unblended}m.uploadCommonUniforms(A,Q,x.toUnwrapped(),null,le);const me=j.material.doubleSided?mn.disabled:mn.backCCW;if(g.instancedDataArray.length>20)J.push(g.instancedDataBuffer),Q.draw(m,A.gl.TRIANGLES,z,Tn.disabled,ne,me,te,s.id,j.vertexBuffer,j.indexBuffer,j.segments,s.paint,m.transform.zoom,void 0,J,g.instancedDataArray.length);else{const pe=F?"u_instance":"u_normal_matrix";for(let xe=0;xe<g.instancedDataArray.length;++xe)te[pe]=new Float32Array(g.instancedDataArray.arrayBuffer,64*xe,16),Q.draw(m,A.gl.TRIANGLES,z,Tn.disabled,ne,me,te,s.id,j.vertexBuffer,j.indexBuffer,j.segments,s.paint,m.transform.zoom,void 0,J)}}if(c.children)for(const j of c.children)ed(m,s,j,g,b,x,M)}const jd=[1,-1,1];function Hd(m,s,c,g){if(!c.modelManager)return!0;const b=c.modelManager;if(!c.shadowRenderer)return!0;const x=c.shadowRenderer,M=s.aabb;let A=!0,F=m.maxHeight;if(0===F){let z=0;for(const H in m.instancesPerModel){const j=b.getModel(H,g);j?z=Math.max(z,Math.max(Math.max(j.aabb.max[0],j.aabb.max[1]),j.aabb.max[2])):A=!1}F=m.maxScale*z*1.41+m.maxVerticalOffset,A&&(m.maxHeight=F)}M.max[2]=F,M.min[2]+=m.terrainElevationMin,M.max[2]+=m.terrainElevationMax,f.ab.vec3.transformMat4(M.min,M.min,s.tileMatrix),f.ab.vec3.transformMat4(M.max,M.max,s.tileMatrix);const N=M.intersects(x.getCurrentCascadeFrustum());return 0===c.currentShadowCascade&&(m.isInsideFirstShadowMapFrustum=2===N),0===N}function yt(m,s){const c=m.uniformValues.u_cutoff_params[0],g=m.uniformValues.u_cutoff_params[1],b=m.uniformValues.u_cutoff_params[2],x=m.uniformValues.u_cutoff_params[3];return g===c||x===b?1:f.aw(((s-c)/(g-c)-b)/(x-b),0,1)}function fi(m,s,c,g){if(s.pitch<20)return 1;const b=s.getWorldToCameraMatrix();f.ab.mat4.multiply(b,b,m);const x=f.ab.vec4.fromValues(c.min[0],c.min[1],c.min[2],1);let M=f.ab.vec4.transformMat4(f.ab.vec4.create(),x,b),A=M,F=M;x[1]=c.max[1],M=f.ab.vec4.transformMat4(f.ab.vec4.create(),x,b),A=M[1]<A[1]?M:A,F=M[1]>F[1]?M:F,x[0]=c.max[0],M=f.ab.vec4.transformMat4(f.ab.vec4.create(),x,b),A=M[1]<A[1]?M:A,F=M[1]>F[1]?M:F,x[1]=c.min[1],M=f.ab.vec4.transformMat4(f.ab.vec4.create(),x,b),A=M[1]<A[1]?M:A,F=M[1]>F[1]?M:F;const N=f.aw(g[0],0,1),z=100*s.pixelsPerMeter*f.aw(g[1],0,1),H=f.aw(g[2],0,1),j=f.ab.vec4.lerp(f.ab.vec4.create(),A,F,N),G=Math.tan(.5*s.fovX),J=-j[2]*G;if(0===z)return j[1]<-Math.abs(J)?H:1;const Q=(-Math.abs(J)-j[1])/z,te=(le,me,pe)=>(1-pe)*le+pe*me,ne=f.aw(te(1,H,Q),H,1);return te(1,ne,f.aw((s.pitch-20)/20,0,1))}class Di{}class Ii{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(s,c,g){{const H=this._storage.get(c.id);if(H)return H.lastUsedFrameIdx=s,H.buf}const b=g.gl,x=b.getBufferParameter(b.ELEMENT_ARRAY_BUFFER,b.BUFFER_SIZE),M=new ArrayBuffer(x),A=new Int16Array(M);b.getBufferSubData(b.ELEMENT_ARRAY_BUFFER,0,new Int16Array(M));const F=new f.dq;for(let H=0;H<x/2;H+=3){const j=A[H],G=A[H+1],J=A[H+2];F.emplaceBack(j,G),F.emplaceBack(G,J),F.emplaceBack(J,j)}const N=g.bindVertexArrayOES.current,z=new Di;return z.buf=new oy(g,F),z.lastUsedFrameIdx=s,this._storage.set(c.id,z),g.bindVertexArrayOES.set(N),z.buf}update(s){for(const[c,g]of this._storage)s-g.lastUsedFrameIdx>30&&(g.buf.destroy(),this._storage.delete(c))}destroy(){for(const[s,c]of this._storage)c.buf.destroy(),this._storage.delete(s)}}class Bi{constructor(s){this.occluderSize=30,this.depthOffset=-1e-4,s.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),s.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const td=f.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class Wu{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class ia{constructor(s,c){this.revealStart=11,this.revealRange=2,s.registerParameter(this,[...c,"Reveal"],"revealStart",{min:0,max:17,step:.05}),s.registerParameter(this,[...c,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Ep=f.da([{type:"Float32",name:"a_pos_2f",components:2}]);class Dp{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(s,c){const g=s.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const M=new f.dr,A=new f.aU;M.emplaceBack(-1,-1),M.emplaceBack(1,-1),M.emplaceBack(1,1),M.emplaceBack(-1,1),A.emplaceBack(0,1,2),A.emplaceBack(0,2,3),this.vignetteVx=s.context.createVertexBuffer(M,Ep.members),this.vignetteIdx=s.context.createIndexBuffer(A)}const b=f.b7.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){s.uploadCommonUniforms(s.context,g);const M={u_vignetteShape:(x={vignetteShape:[c.start,c.range,Math.pow(10,c.fadePower)],vignetteColor:[c.color.r,c.color.g,c.color.b,c.color.a*c.strength]}).vignetteShape,u_vignetteColor:x.vignetteColor};g.draw(s,s.context.gl.TRIANGLES,on.disabled,Tn.disabled,An.alphaBlended,mn.disabled,M,"vignette",this.vignetteVx,this.vignetteIdx,b,{})}var x}}class es{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(s,c){const g=s.getFreeCameraOptions().position,b=g.toAltitude(),x=g.toLngLat(),M=f.ai(x.lng),A=f.ai(x.lat),F=s.pixelsPerMeter/c,N=M*f.ds,z=f.ds*Math.log(Math.tan(Math.PI/4+A/2));if(void 0===this._offsetXPrev)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const H=-this._offsetYPrev+z,j=-this._elevationPrev+b;this._accumulatedOffsetX+=(-this._offsetXPrev+N)*F,this._accumulatedOffsetY+=H*F,this._accumulatedElevation+=j*F,this._offsetXPrev=N,this._offsetYPrev=z,this._elevationPrev=b}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function fy(m,s){return[-(m[0]-Math.floor(m[0]/s)*s),-(m[1]-Math.floor(m[1]/s)*s),-(m[2]-Math.floor(m[2]/s)*s)]}function py(m){const s=f.di(1323123451230),c=[];for(let g=0;g<m;++g){const b=2*s()-1,x=2*s()-1,M=2*s()-1;c.push(f.ab.vec3.fromValues(b,x,M))}return c}function Ha(m,s,c,g,b){const x=f.aw((b-c)/(g-c),0,1);return(1-x)*m+x*s}class nd{constructor(s){this._movement=new es,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new Dp,this._ppmScaleFactor=s}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(s,c){const g=s.transform;this._movement.update(g,this._ppmScaleFactor);const b=g.starsProjMatrix,x=f.ab.quat.identity([]);f.ab.quat.rotateX(x,x,f.ai(90)-g._pitch),f.ab.quat.rotateZ(x,x,-g.angle);const M=f.ab.mat4.fromQuat(new Float32Array(16),x),A=f.ab.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),F=f.ab.mat4.transpose([],A),N=f.ab.mat4.multiply([],F,M),z=Date.now()/1e3;return this._accumulatedTimeFromStart+=(z-this._prevTime)*c,this._prevTime=z,{projectionMatrix:b,modelviewMatrix:N}}}class pf extends nd{constructor(s){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new ia(s.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(s){const c=s.context;if(!this.particlesVx){const g=py(this.particlesCount),b=new f.dt,x=new f.aU;let M=0;const A=f.di(1323123451230);for(let F=0;F<g.length;++F){const N=g[F],z=[2*A()-1,A(),A(),A()];b.emplaceBack(N[0],N[1],N[2],-1,-1,...z),b.emplaceBack(N[0],N[1],N[2],1,-1,...z),b.emplaceBack(N[0],N[1],N[2],1,1,...z),b.emplaceBack(N[0],N[1],N[2],-1,1,...z),x.emplaceBack(M+0,M+1,M+2),x.emplaceBack(M+0,M+2,M+3),M+=4}this.particlesVx=c.createVertexBuffer(b,td.members),this.particlesIdx=c.createIndexBuffer(x)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.rain)return;const c=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},g=s.transform.zoom;if(c.revealStart>g)return;const b=Ha(0,1,c.revealStart,c.revealStart+c.revealRange,g);if(!this.particlesVx||!this.particlesIdx)return;const x=structuredClone(this._params);let M=[-x.direction.x,x.direction.y,-100];f.ab.vec3.normalize(M,M);const A=structuredClone(this._vignetteParams);A.strength*=b,x.overrideStyleParameters||(x.intensity=s.style.rain.state.density,x.timeFactor=s.style.rain.state.intensity,x.color=structuredClone(s.style.rain.state.color),M=structuredClone(s.style.rain.state.direction),x.screenThinning.intensity=s.style.rain.state.centerThinning,x.dropletSizeX=s.style.rain.state.dropletSize[0],x.dropletSizeYScale=s.style.rain.state.dropletSize[1]/s.style.rain.state.dropletSize[0],x.distortionStrength=100*s.style.rain.state.distortionStrength,A.strength=1,A.color=structuredClone(s.style.rain.state.vignetteColor));const F=this.updateOnRender(s,x.timeFactor),N=s.context,z=N.gl,H=s.transform;this.screenTexture&&this.screenTexture.size[0]===s.width&&this.screenTexture.size[1]===s.height||(this.screenTexture=new f.T(N,{width:s.width,height:s.height,data:null},z.RGBA8)),x.distortionStrength>0&&(N.activeTexture.set(z.TEXTURE0),this.screenTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),z.copyTexSubImage2D(z.TEXTURE_2D,0,0,0,0,0,s.width,s.height));const j=s.getOrCreateProgram("rainParticle");s.uploadCommonUniforms(N,j),N.activeTexture.set(z.TEXTURE0),this.screenTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const G=[x.color.r,x.color.g,x.color.b,x.color.a],J=(Q,te)=>{const ne=fy(this._movement.getPosition(),Q),le=x.dropletSizeX,me=x.dropletSizeX*x.dropletSizeYScale,pe=s.width/2,xe=s.height/2,ve=Ha(0,x.screenThinning.start,0,1,x.screenThinning.intensity),be=Ha(.001,x.screenThinning.range,0,1,x.screenThinning.intensity),ye=Ha(0,x.screenThinning.particleOffset,0,1,x.screenThinning.intensity),Ee=(Re={modelview:F.modelviewMatrix,projection:F.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ne,velocityConeAperture:x.velocityConeAperture,velocity:x.velocity,boxSize:Q,rainDropletSize:[le,me],distortionStrength:x.distortionStrength,rainDirection:M,color:G,screenSize:[H.width,H.height],thinningCenterPos:[pe,xe],thinningShape:[ve,be,Math.pow(10,x.screenThinning.fadePower)],thinningAffectedRatio:x.screenThinning.affectedRatio,thinningParticleOffset:ye,shapeDirectionalPower:x.shapeDirPower,shapeNormalPower:x.shapeNormalPower,mode:te?0:1},{u_modelview:Float32Array.from(Re.modelview),u_projection:Float32Array.from(Re.projection),u_time:Re.time,u_cam_pos:Re.camPos,u_texScreen:0,u_velocityConeAperture:Re.velocityConeAperture,u_velocity:Re.velocity,u_boxSize:Re.boxSize,u_rainDropletSize:Re.rainDropletSize,u_distortionStrength:Re.distortionStrength,u_rainDirection:Re.rainDirection,u_color:Re.color,u_screenSize:Re.screenSize,u_thinningCenterPos:Re.thinningCenterPos,u_thinningShape:Re.thinningShape,u_thinningAffectedRatio:Re.thinningAffectedRatio,u_thinningParticleOffset:Re.thinningParticleOffset,u_shapeDirectionalPower:Re.shapeDirectionalPower,u_shapeNormalPower:Re.shapeNormalPower,u_mode:Re.mode});var Re;const Xe=Math.round(b*x.intensity*this.particlesCount),qe=f.b7.simpleSegment(0,0,4*Xe,2*Xe);j.draw(s,z.TRIANGLES,on.disabled,Tn.disabled,An.alphaBlended,mn.disabled,Ee,"rain_particles",this.particlesVx,this.particlesIdx,qe,{})};x.distortionStrength>0&&J(x.boxSize,!0),J(x.boxSize,!1),this._vignette.draw(s,A)}}const Ts=f.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Bl extends nd{constructor(s){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new ia(s.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(s){const c=s.context;if(!this.particlesVx){const g=py(this.particlesCount),b=new f.du,x=new f.aU;let M=0;const A=f.di(1323123451230);for(let F=0;F<g.length;++F){const N=g[F],z=A(),H=A(),j=A(),G=[F/g.length,z,H,j],J=[A(),A()];b.emplaceBack(N[0],N[1],N[2],-1,-1,...G,...J),b.emplaceBack(N[0],N[1],N[2],1,-1,...G,...J),b.emplaceBack(N[0],N[1],N[2],1,1,...G,...J),b.emplaceBack(N[0],N[1],N[2],-1,1,...G,...J),x.emplaceBack(M+0,M+1,M+2),x.emplaceBack(M+0,M+2,M+3),M+=4}this.particlesVx=c.createVertexBuffer(b,Ts.members),this.particlesIdx=c.createIndexBuffer(x)}}draw(s){if(!this._params.overrideStyleParameters&&!s.style.snow)return;const c=structuredClone(this._params);let g=[-c.direction.x,c.direction.y,-100];f.ab.vec3.normalize(g,g);const b=structuredClone(this._vignetteParams),x=c.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},M=s.transform.zoom;if(x.revealStart>M)return;const A=Ha(0,1,x.revealStart,x.revealStart+x.revealRange,M);b.strength*=A,c.overrideStyleParameters||(c.intensity=s.style.snow.state.density,c.timeFactor=s.style.snow.state.intensity,c.color=structuredClone(s.style.snow.state.color),g=structuredClone(s.style.snow.state.direction),c.screenThinning.intensity=s.style.snow.state.centerThinning,c.billboardSize=2.79*s.style.snow.state.flakeSize,b.strength=1,b.color=structuredClone(s.style.snow.state.vignetteColor));const F=this.updateOnRender(s,c.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const N=s.context,z=N.gl,H=s.transform,j=s.getOrCreateProgram("snowParticle");s.uploadCommonUniforms(N,j),((G,J,Q)=>{const te=fy(this._movement.getPosition(),G),ne=H.width/2,le=H.height/2,me=Ha(0,Q.screenThinning.start,0,1,Q.screenThinning.intensity),pe=Ha(.001,Q.screenThinning.range,0,1,Q.screenThinning.intensity),xe=Ha(0,Q.screenThinning.particleOffset,0,1,Q.screenThinning.intensity),ve=(be={modelview:F.modelviewMatrix,projection:F.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:te,velocityConeAperture:Q.velocityConeAperture,velocity:Q.velocity,horizontalOscillationRadius:Q.horizontalOscillationRadius,horizontalOscillationRate:Q.horizontalOscillationRate,boxSize:G,billboardSize:1*Q.billboardSize,simpleShapeParameters:[Q.shapeFadeStart,Q.shapeFadePower],screenSize:[H.width,H.height],thinningCenterPos:[ne,le],thinningShape:[me,pe,Math.pow(10,Q.screenThinning.fadePower)],thinningAffectedRatio:Q.screenThinning.affectedRatio,thinningParticleOffset:xe,color:[Q.color.r,Q.color.g,Q.color.b,Q.color.a],direction:g},{u_modelview:Float32Array.from(be.modelview),u_projection:Float32Array.from(be.projection),u_time:be.time,u_cam_pos:be.camPos,u_velocityConeAperture:be.velocityConeAperture,u_velocity:be.velocity,u_horizontalOscillationRadius:be.horizontalOscillationRadius,u_horizontalOscillationRate:be.horizontalOscillationRate,u_boxSize:be.boxSize,u_billboardSize:be.billboardSize,u_simpleShapeParameters:be.simpleShapeParameters,u_screenSize:be.screenSize,u_thinningCenterPos:be.thinningCenterPos,u_thinningShape:be.thinningShape,u_thinningAffectedRatio:be.thinningAffectedRatio,u_thinningParticleOffset:be.thinningParticleOffset,u_particleColor:be.color,u_direction:be.direction});var be;const ye=Math.round(A*Q.intensity*this.particlesCount),Ee=f.b7.simpleSegment(0,0,4*ye,2*ye);this.particlesVx&&this.particlesIdx&&j.draw(s,z.TRIANGLES,on.disabled,Tn.disabled,An.alphaBlended,mn.disabled,ve,"snow_particles",this.particlesVx,this.particlesIdx,Ee,{})})(c.boxSize,0,c),this._vignette.draw(s,b)}}const bc={symbol:function(m,s,c,g,b){if("translucent"!==m.renderPass)return;const x=Tn.disabled,M=m.colorModeForRenderPass(),A=c.layout.get("text-variable-anchor"),F=c.layout.get("text-size-scale-range"),N=f.aw(m.scaleFactor,F[0],F[1]);A&&function(j,G,J,Q,te,ne,le,me){const pe=G.transform,xe="map"===te,ve="map"===ne;for(const be of j){const ye=Q.getTile(be),Ee=ye.getBucket(J);if(!Ee||!Ee.text||!Ee.text.segments.get().length)continue;const Re=f.bp(Ee.textSizeData,pe.zoom,me),Xe=Zh(be,Ee.getProjection(),pe),qe=pe.calculatePixelsToTileUnitsMatrix(ye),Ae=al(Xe,ye.tileID.canonical,ve,xe,pe,Ee.getProjection(),qe),Be=Ee.hasIconTextFit()&&Ee.hasIconData();if(Re){const Ye=Math.pow(2,pe.zoom-ye.tileID.overscaledZ);ly(Ee,xe,ve,le,f.cX,pe,Ae,be,Ye,Re,Be)}}}(g,m,c,s,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),b,N);const z=0!==c.paint.get("icon-opacity").constantOr(1),H=0!==c.paint.get("text-opacity").constantOr(1);void 0!==c.layout.get("symbol-sort-key").constantOr(1)&&(z||H)?sr(m,s,c,g,x,M):(z&&sr(m,s,c,g,x,M,{onlyIcons:!0}),H&&sr(m,s,c,g,x,M,{onlyText:!0})),s.map.showCollisionBoxes&&(Sb(m,s,c,g,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Sb(m,s,c,g,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(m,s,c,g){if("translucent"!==m.renderPass)return;const b=c.paint.get("circle-opacity"),x=c.paint.get("circle-stroke-width"),M=c.paint.get("circle-stroke-opacity"),A=void 0!==c.layout.get("circle-sort-key").constantOr(1),F=c.paint.get("circle-emissive-strength");if(0===b.constantOr(1)&&(0===x.constantOr(1)||0===M.constantOr(1)))return;const N=m.context,z=N.gl,H=m.transform,j=m.depthModeForSublayer(0,on.ReadOnly),G=Tn.disabled,J=m.colorModeForDrapableLayerRenderPass(F),Q="globe"===H.projection.name,te=[f.at(H.center.lng),f.aA(H.center.lat)],ne=[];for(let me=0;me<g.length;me++){const pe=g[me],xe=s.getTile(pe),ve=xe.getBucket(c);if(!ve||ve.projection.name!==H.projection.name)continue;const be=ve.programConfigurations.get(c.id),ye=f.cY(c),Ee=m.isTileAffectedByFog(pe);Q&&ye.push("PROJECTION_GLOBE_VIEW"),ye.push("DEPTH_D24"),m.terrain&&H.depthOcclusionForSymbolsAndCircles&&ye.push("DEPTH_OCCLUSION");const Re=m.getOrCreateProgram("circle",{config:be,defines:ye,overrideFog:Ee}),Xe=ve.layoutVertexBuffer,qe=ve.globeExtVertexBuffer,Ae=ve.indexBuffer,Be=H.projection.createInversionMatrix(H,pe.canonical),Ye={programConfiguration:be,program:Re,layoutVertexBuffer:Xe,globeExtVertexBuffer:qe,indexBuffer:Ae,uniformValues:f.cZ(m,pe,xe,Be,te,c),tile:xe};if(A){const pt=ve.segments.get();for(const Ct of pt)ne.push({segments:new f.b7([Ct]),sortKey:Ct.sortKey,state:Ye})}else ne.push({segments:ve.segments,sortKey:0,state:Ye})}A&&ne.sort((me,pe)=>me.sortKey-pe.sortKey);const le={useDepthForOcclusion:H.depthOcclusionForSymbolsAndCircles};for(const me of ne){const{programConfiguration:pe,program:xe,layoutVertexBuffer:ve,globeExtVertexBuffer:be,indexBuffer:ye,uniformValues:Ee,tile:Re}=me.state,Xe=me.segments;m.terrain&&m.terrain.setupElevationDraw(Re,xe,le),m.uploadCommonUniforms(N,xe,Re.tileID.toUnwrapped()),xe.draw(m,z.TRIANGLES,j,G,J,mn.disabled,Ee,c.id,ve,ye,Xe,c.paint,H.zoom,pe,[be])}},heatmap:function(m,s,c,g){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const b=m.context,x=b.gl,M=Tn.disabled,A=new An([x.ONE,x.ONE,x.ONE,x.ONE],f.aj.transparent,[!0,!0,!0,!0]);(function(G,J,Q,te){const ne=G.gl,le=J.width*te,me=J.height*te;G.activeTexture.set(ne.TEXTURE1),G.viewport.set([0,0,le,me]);let pe=Q.heatmapFbo;if(!pe||pe&&(pe.width!==le||pe.height!==me)){pe&&pe.destroy();const xe=ne.createTexture();ne.bindTexture(ne.TEXTURE_2D,xe),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),pe=Q.heatmapFbo=G.createFramebuffer(le,me,!0,null),function(ve,be,ye,Ee,Re,Xe){const qe=ve.gl;qe.texImage2D(qe.TEXTURE_2D,0,ve.extRenderToTextureHalfFloat?qe.RGBA16F:qe.RGBA,Re,Xe,0,qe.RGBA,ve.extRenderToTextureHalfFloat?qe.HALF_FLOAT:qe.UNSIGNED_BYTE,null),Ee.colorAttachment.set(ye)}(G,0,xe,pe,le,me)}else ne.bindTexture(ne.TEXTURE_2D,pe.colorAttachment.get()),G.bindFramebuffer.set(pe.framebuffer)})(b,m,c,"globe"===m.transform.projection.name?.5:.25),b.clear({color:f.aj.transparent});const F=m.transform,N="globe"===F.projection.name,z=N?["PROJECTION_GLOBE_VIEW"]:[],H=N?mn.frontCCW:mn.disabled,j=[f.at(F.center.lng),f.aA(F.center.lat)];for(let G=0;G<g.length;G++){const J=g[G];if(s.hasRenderableParent(J))continue;const Q=s.getTile(J),te=Q.getBucket(c);if(!te||te.projection.name!==F.projection.name)continue;const ne=m.isTileAffectedByFog(J),le=te.programConfigurations.get(c.id),me=m.getOrCreateProgram("heatmap",{config:le,defines:z,overrideFog:ne}),{zoom:pe}=m.transform;m.terrain&&m.terrain.setupElevationDraw(Q,me),m.uploadCommonUniforms(b,me,J.toUnwrapped());const xe=F.projection.createInversionMatrix(F,J.canonical);me.draw(m,x.TRIANGLES,on.disabled,M,A,H,Nl(m,J,Q,xe,j,pe,c.paint.get("heatmap-intensity")),c.id,te.layoutVertexBuffer,te.indexBuffer,te.segments,c.paint,m.transform.zoom,le,N?[te.globeExtVertexBuffer]:null)}b.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(b,x){const M=b.context,A=M.gl,F=x.heatmapFbo;if(!F)return;M.activeTexture.set(A.TEXTURE0),A.bindTexture(A.TEXTURE_2D,F.colorAttachment.get()),M.activeTexture.set(A.TEXTURE1);let N=x.colorRampTexture;N||(N=x.colorRampTexture=new f.T(M,x.colorRamp,A.RGBA8)),N.bind(A.LINEAR,A.CLAMP_TO_EDGE),b.getOrCreateProgram("heatmapTexture").draw(b,A.TRIANGLES,on.disabled,Tn.disabled,b.colorModeForRenderPass(),mn.disabled,{u_image:0,u_color_ramp:1,u_opacity:x.paint.get("heatmap-opacity")},x.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,x.paint,b.transform.zoom)}(m,c))},line:function(m,s,c,g){if("translucent"!==m.renderPass)return;const b=c.paint.get("line-opacity"),x=c.paint.get("line-width");if(0===b.constantOr(1)||0===x.constantOr(1))return;const M=c.paint.get("line-emissive-strength"),A=c.paint.get("line-occlusion-opacity"),F=c.layout.get("line-elevation-reference"),N="meters"===c.layout.get("line-width-unit"),z="sea"===F,H=m.context,j=H.gl,G=!c.isDraped();if(G&&"globe"===m.transform.projection.name)return;const J=c.layout.get("line-cross-slope"),Q=void 0!==J,te=J<1,ne=G?new on(m.depthOcclusion?j.GREATER:j.LEQUAL,on.ReadOnly,m.depthRangeFor3D):m.depthModeForSublayer(0,on.ReadOnly),le=m.colorModeForDrapableLayerRenderPass(M),me=m.terrain&&m.terrain.renderingToTexture,pe=me?1:f.q.devicePixelRatio,xe=c.paint.get("line-dasharray"),ve=xe.constantOr(1),be=c.layout.get("line-cap"),ye=xe.constantOr(null),Ee=be.constantOr(null),Re=c.paint.get("line-pattern"),Xe=Re.constantOr(1),qe=Re.constantOr(null),Ae=c.paint.get("line-opacity").constantOr(1);let Be=!Xe&&1!==Ae||m.depthOcclusion&&A>0&&A<1;const Ye=c.paint.get("line-gradient"),pt=Xe?"linePattern":"line",Ct=f.c_(c);let He;if(me&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(Be=!1),0!==A&&m.depthOcclusion){const Ke=c.paint._values["line-opacity"];Ke&&Ke.value&&"constant"===Ke.value.kind?He=Ke.value:f.w(`Occlusion opacity for layer ${c.id} is supported only when line-opacity isn't data-driven.`)}if(G&&(m.forceTerrainMode=!0),!G&&0!==A&&m.terrain&&!me)return void f.w(`Occlusion opacity for layer ${c.id} is supported on terrain only if the layer has line-z-offset enabled.`);const dt=Be&&G?m.stencilModeFor3D():Tn.disabled;G&&(Ct.push("ELEVATED"),Q&&Ct.push(te?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),z&&Ct.push("ELEVATION_REFERENCE_SEA")),"constant"!==x.value.kind&&!1===x.value.isLineProgressConstant&&Ct.push("VARIABLE_LINE_WIDTH");for(const Ke of g){const bt=s.getTile(Ke);if(Xe&&!bt.patternsLoaded())continue;const ht=bt.getBucket(c);if(!ht)continue;m.prepareDrawTile();const st=ht.programConfigurations.get(c.id),Pt=m.isTileAffectedByFog(Ke),Vt=m.getOrCreateProgram(pt,{config:st,defines:Ct,overrideFog:Pt,overrideRtt:!G&&void 0});if(qe&&bt.imageAtlas){const jn=f.A.from(qe),hr=bt.imageAtlas.patternPositions[jn.getSerializedPrimary()];hr&&st.setConstantPatternPositions(hr)}if(!Xe&&ye&&Ee&&bt.lineAtlas){const jn=bt.lineAtlas.getDash(ye,Ee);jn&&st.setConstantPatternPositions(jn)}let[kt,Gt]=c.paint.get("line-trim-offset");("round"===Ee||"square"===Ee)&&kt!==Gt&&(0===kt&&(kt-=1),1===Gt&&(Gt+=1));const hn=me?Ke.projMatrix:null,ln=N?1/ht.tileToMeter/f.ar(bt,1,m.transform.zoom):1,sn=N?1/ht.tileToMeter/f.ar(bt,1,Math.floor(m.transform.zoom)):1,Dt=Xe?f.c$(m,bt,c,hn,pe,ln,sn,[kt,Gt]):f.d0(m,bt,c,hn,ht.lineClipsArray.length,pe,ln,sn,[kt,Gt]);if(Ye){const jn=ht.gradients[c.id];let hr=jn.texture;if(c.gradientVersion!==jn.version){let fr=256;if(c.stepInterpolant){const Fi=s.getSource().maxzoom,ji=Ke.canonical.z===Fi?Math.ceil(1<<m.transform.maxZoom-Ke.canonical.z):1;fr=f.aw(f.d1(ht.maxLineLength/f.ag*1024*ji),256,H.maxTextureSize)}jn.gradient=f.d2({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:fr,image:jn.gradient||void 0,clips:ht.lineClipsArray}),jn.texture?jn.texture.update(jn.gradient):jn.texture=new f.T(H,jn.gradient,j.RGBA8),jn.version=c.gradientVersion,hr=jn.texture}H.activeTexture.set(j.TEXTURE1),hr.bind(c.stepInterpolant?j.NEAREST:j.LINEAR,j.CLAMP_TO_EDGE)}ve&&(H.activeTexture.set(j.TEXTURE0),bt.lineAtlasTexture&&bt.lineAtlasTexture.bind(j.LINEAR,j.REPEAT),st.updatePaintBuffers()),Xe&&(H.activeTexture.set(j.TEXTURE0),bt.imageAtlasTexture&&bt.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),st.updatePaintBuffers()),G&&!z&&m.terrain.setupElevationDraw(bt,Vt),m.uploadCommonUniforms(H,Vt,Ke.toUnwrapped());const si=jn=>{null!=He&&(He.value=Ae*A),Vt.draw(m,j.TRIANGLES,ne,jn,le,mn.disabled,Dt,c.id,ht.layoutVertexBuffer,ht.indexBuffer,ht.segments,c.paint,m.transform.zoom,st,[ht.layoutVertexBuffer2,ht.patternVertexBuffer,ht.zOffsetVertexBuffer]),null!=He&&(He.value=Ae)};if(Be&&!G){const jn=m.stencilModeForClipping(Ke).ref;0===jn&&me&&H.clear({stencil:0});const hr={func:j.EQUAL,mask:255};Dt.u_alpha_discard_threshold=.8,si(new Tn(hr,jn,255,j.KEEP,j.KEEP,j.INVERT)),Dt.u_alpha_discard_threshold=0,si(new Tn(hr,jn,255,j.KEEP,j.KEEP,j.KEEP))}else Be&&G&&(Dt.u_alpha_discard_threshold=.001),si(G?dt:m.stencilModeForClipping(Ke))}G&&(m.forceTerrainMode=!1),Be&&(m.resetStencilClippingMasks(),me&&H.clear({stencil:0})),0===A||m.depthOcclusion||me||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,s,c,g){const b=c.paint.get("fill-color"),x=c.paint.get("fill-opacity"),M=c.is3D(),A=new on(m.context.gl.LEQUAL,on.ReadWrite,m.depthRangeFor3D);if(0===x.constantOr(1))return;const F=c.paint.get("fill-emissive-strength"),N=m.colorModeForDrapableLayerRenderPass(F),z=c.paint.get("fill-pattern"),H=m.opaquePassEnabledForLayer()&&!z.constantOr(1)&&1===b.constantOr(f.aj.transparent).a&&1===x.constantOr(0)?"opaque":"translucent";if(m.renderPass===H){const j=M?A:m.depthModeForSublayer(1,"opaque"===m.renderPass?on.ReadWrite:on.ReadOnly);Tp(m,s,c,g,j,N,!1)}if(!M&&"translucent"===m.renderPass&&c.paint.get("fill-antialias")){const j=M?A:m.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,on.ReadOnly);Tp(m,s,c,g,j,N,!0)}},"fill-extrusion":function(m,s,c,g){const b=c.paint.get("fill-extrusion-opacity"),x=m.context,M=x.gl,A=m.terrain,F=A&&A.renderingToTexture;if(0===b)return;const N=m.conflationActive&&m.style.isLayerClipped(c,s.getSource()),z=m.style.order.indexOf(c.fqid);if(N&&function(H,j,G,J,Q){for(const te of J){const ne=j.getTile(te).getBucket(G);ne&&(ne.updateReplacement(te,H.replacementSource,Q),ne.uploadCentroid(H.context))}}(m,s,c,g,z),A||N)for(const H of g){const j=s.getTile(H).getBucket(c);j&&cy(m.context,s,H,j,c,A,N)}if("shadow"===m.renderPass&&m.shadowRenderer){const H=m.shadowRenderer;if(A&&b<.65&&c._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof f.a9)return;const j=H.getShadowPassDepthMode(),G=H.getShadowPassColorMode();hf(m,s,c,g,j,Tn.disabled,G,N)}else if("translucent"===m.renderPass){const H=!c.paint.get("fill-extrusion-pattern").constantOr(1),j=c.paint.get("fill-extrusion-color").constantOr(f.aj.white);if(!F&&0!==j.a){const G=new on(m.context.gl.LEQUAL,on.ReadWrite,m.depthRangeFor3D);1===b&&H?hf(m,s,c,g,G,Tn.disabled,An.unblended,N):(hf(m,s,c,g,G,Tn.disabled,An.disabled,N),hf(m,s,c,g,G,m.stencilModeFor3D(),m.colorModeForRenderPass(),N),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&H&&(!A&&"globe"!==m.transform.projection.name||F)){const G=c.paint.get("fill-extrusion-opacity"),J=c.paint.get("fill-extrusion-ambient-occlusion-intensity"),Q=c.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),te=c.paint.get("fill-extrusion-flood-light-intensity"),ne="none"===c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default"),le=c.paint.get("fill-extrusion-flood-light-color").toRenderColor(ne?null:c.lut).toArray01().slice(0,3),me=J>0&&Q>0,pe=te>0,xe=(be,ye,Ee)=>(1-Ee)*be+Ee*ye,ve=be=>{const ye=m.depthModeForSublayer(1,on.ReadOnly,M.LEQUAL,!0),Ee=c.paint.get(be?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Re=xe(.1,3,Ee),Xe=m._showOverdrawInspector;if(!Xe){const qe=new Tn({func:M.ALWAYS,mask:255},255,255,M.KEEP,M.KEEP,M.REPLACE),Ae=new An([M.ONE,M.ONE,M.ONE,M.ONE],f.aj.transparent,[!1,!1,!1,!0],M.MIN);Nd(m,s,c,g,ye,qe,Ae,mn.disabled,be,"sdf",G,J,Q,te,le,Re,N,!1)}{const qe=Xe?Tn.disabled:new Tn({func:M.EQUAL,mask:255},255,255,M.KEEP,M.DECR,M.DECR),Ae=Xe?m.colorModeForRenderPass():new An([M.ONE_MINUS_DST_ALPHA,M.DST_ALPHA,M.ONE,M.ONE],f.aj.transparent,[!0,!0,!0,!0]);Nd(m,s,c,g,ye,qe,Ae,mn.disabled,be,"color",G,J,Q,te,le,Re,N,!1)}};if(F){const be=(ye,Ee,Re)=>{const Xe=m.depthModeForSublayer(1,on.ReadOnly,M.LEQUAL,!1),qe=c.paint.get(ye?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ae=xe(.1,3,qe);{const Be=new An([M.ONE,M.ONE,M.ONE,M.ONE],f.aj.transparent,[!1,!1,!1,!0]);Nd(m,s,c,g,Xe,Tn.disabled,Be,mn.disabled,ye,"clear",G,J,Q,te,le,Ae,N,Ee)}{const Be=new Tn({func:M.ALWAYS,mask:255},255,255,M.KEEP,M.KEEP,M.REPLACE),Ye=new An([M.ONE,M.ONE,M.ONE,M.ONE],f.aj.transparent,[!1,!1,!1,!0],M.MIN);Nd(m,s,c,g,Xe,Be,Ye,mn.disabled,ye,"sdf",G,J,Q,te,le,Ae,N,Ee)}{const Be=ye?M.ZERO:M.ONE_MINUS_DST_ALPHA,Ye=new Tn({func:M.EQUAL,mask:255},255,255,M.KEEP,M.DECR,M.DECR),pt=new An([Be,M.DST_ALPHA,M.ONE_MINUS_DST_ALPHA,M.ZERO],f.aj.transparent,[!0,!0,!0,!0]);Nd(m,s,c,g,Xe,Ye,pt,mn.disabled,ye,"color",G,J,Q,te,le,Ae,N,Ee)}{const Be=new An([M.ONE,M.ONE,M.ONE,ye?M.ZERO:M.ONE],f.aj.transparent,[!1,!1,!1,!0],ye?M.FUNC_ADD:M.MAX);Nd(m,s,c,g,Xe,Tn.disabled,Be,mn.disabled,ye,"clear",G,J,Q,te,le,Ae,N,Ee,Re)}};if(me||pe){let ye;if(m.prepareDrawTile(),A){const Ee=A.drapeBufferSize[0],Re=A.drapeBufferSize[1];ye=A.framebufferCopyTexture,ye&&(!ye||ye.size[0]===Ee&&ye.size[1]===Re)||(ye&&ye.destroy(),ye=A.framebufferCopyTexture=new f.T(x,new f.r({width:Ee,height:Re}),M.RGBA8)),ye.bind(M.LINEAR,M.CLAMP_TO_EDGE),M.copyTexSubImage2D(M.TEXTURE_2D,0,0,0,0,0,Ee,Re)}me&&be(!0,!1,ye),pe&&be(!1,!0,ye)}}else me&&ve(!0),pe&&ve(!1),(me||pe)&&m.resetStencilClippingMasks()}}},hillshade:function(m,s,c,g){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass||m.style.disableElevatedTerrain)return;const b=m.context,x=m.terrain&&m.terrain.renderingToTexture,[M,A]="translucent"!==m.renderPass||x?[{},g]:m.stencilConfigForOverlap(g);for(const F of A){const N=s.getTile(F);if(N.needsHillshadePrepare&&"offscreen"===m.renderPass)Eo(m,N,c);else if("translucent"===m.renderPass){const z=m.depthModeForSublayer(0,on.ReadOnly),H=c.paint.get("hillshade-emissive-strength"),j=m.colorModeForDrapableLayerRenderPass(H),G=x&&m.terrain?m.terrain.stencilModeForRTTOverlap(F):M[F.overscaledZ];lg(m,F,N,c,z,G,j)}}b.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,s,c,g,b,x){if("translucent"!==m.renderPass||0===c.paint.get("raster-opacity"))return;const M="globe"===m.transform.projection.name,A=0!==c.paint.get("raster-elevation"),F=A&&M;if(m.renderElevatedRasterBackface&&!F)return;const N=m.context,z=N.gl,H=s.getSource(),j=function(ve,be,ye,Ee){const Re=be.paint.get("raster-color"),Xe="raster-array"===ve.type,qe=[],Ae=be.paint.get("raster-resampling"),Be=be.paint.get("raster-color-mix");let Ye=be.paint.get("raster-color-range");const pt=[Be[0],Be[1],Be[2],0],Ct=Be[3];let He="nearest"===Ae?Ee.NEAREST:Ee.LINEAR;if(Xe&&(qe.push("RASTER_ARRAY"),Re||qe.push("RASTER_COLOR"),"linear"===Ae&&qe.push("RASTER_ARRAY_LINEAR"),He=Ee.NEAREST,!Ye&&ve.rasterLayers)){const dt=ve.rasterLayers.find(({id:Ke})=>Ke===be.sourceLayer);dt&&dt.fields&&dt.fields.range&&(Ye=dt.fields.range)}if(Ye=Ye||[0,1],Re){qe.push("RASTER_COLOR"),ye.activeTexture.set(Ee.TEXTURE2),be.updateColorRamp(Ye);let dt=be.colorRampTexture;dt||(dt=be.colorRampTexture=new f.T(ye,be.colorRamp,Ee.RGBA8)),dt.bind(Ee.LINEAR,Ee.CLAMP_TO_EDGE)}return{mix:pt,range:Ye,offset:Ct,defines:qe,resampling:He}}(H,c,N,z);if(H instanceof f.aJ&&!g.length&&!M)return;const G=c.paint.get("raster-emissive-strength"),J=m.colorModeForDrapableLayerRenderPass(G),Q=m.terrain&&m.terrain.renderingToTexture,te=!m.options.moving,ne="nearest"===c.paint.get("raster-resampling")?z.NEAREST:z.LINEAR;if(H instanceof f.aJ&&!g.length&&(H.onNorthPole||H.onSouthPole)){const ve=A?m.stencilModeFor3D():Tn.disabled;return void jt(!!H.onNorthPole,null,m,s,c,G,j,mn.disabled,ve)}if(!g.length)return;const[le,me]=H instanceof f.aJ||Q?[{},g]:m.stencilConfigForOverlap(g),pe=me[me.length-1].overscaledZ;F&&j.defines.push("PROJECTION_GLOBE_VIEW"),A&&j.defines.push("RENDER_CUTOFF");const xe=(ve,be,ye)=>{for(const Ee of ve){const Re=Ee.toUnwrapped(),Xe=s.getTile(Ee);if(Q&&(!Xe||!Xe.hasData()))continue;N.activeTexture.set(z.TEXTURE0);const qe=Pr(Xe,H,c,j);if(!qe||!qe.texture)continue;const{texture:Ae,mix:Be,offset:Ye,tileSize:pt,buffer:Ct}=qe;let He,dt;Q?(He=on.disabled,dt=Ee.projMatrix):A?(He=new on(z.LEQUAL,on.ReadWrite,m.depthRangeFor3D),dt=M?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(Re,te)):(He=m.depthModeForSublayer(Ee.overscaledZ-pe,1===c.paint.get("raster-opacity")?on.ReadWrite:on.ReadOnly,z.LESS),dt=m.transform.calculateProjMatrix(Re,te));const Ke=m.terrain&&Q?m.terrain.stencilModeForRTTOverlap(Ee):le[Ee.overscaledZ],bt=x?0:c.paint.get("raster-fade-duration");Xe.registerFadeDuration(bt);const ht=s.findLoadedParent(Ee,0),st=hl(Xe,ht,s,m.transform,bt);let Pt,Vt;m.terrain&&m.terrain.prepareDrawTile(),N.activeTexture.set(z.TEXTURE0),Ae.bind(ne,z.CLAMP_TO_EDGE),N.activeTexture.set(z.TEXTURE1),ht?(ht.texture&&ht.texture.bind(ne,z.CLAMP_TO_EDGE),Pt=Math.pow(2,ht.tileID.overscaledZ-Xe.tileID.overscaledZ),Vt=[Xe.tileID.canonical.x*Pt%1,Xe.tileID.canonical.y*Pt%1]):Ae.bind(ne,z.CLAMP_TO_EDGE),Ae.useMipmap&&N.extTextureFilterAnisotropic&&m.transform.pitch>20&&z.texParameterf(z.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax);const kt=m.transform;let Gt;const hn=A?Ki(kt):[0,0,0,0];let ln,sn,Dt,si,jn,hr=0;if(F&&H instanceof f.aJ&&H.coordinates.length>3)ln=Float32Array.from(f.bb(f.cH(new f.bT(0,0,0)))),sn=Float32Array.from(kt.globeMatrix),Dt=Float32Array.from(f.cD(kt)),si=[f.at(kt.center.lng),f.aA(kt.center.lat)],Gt=H.elevatedGlobePerspectiveTransform,jn=H.elevatedGlobeGridMatrix||new Float32Array(9);else if(F){const Zn=f.cE(Ee.canonical);hr=f.cF(Zn.getCenter().lat),ln=Float32Array.from(f.bb(f.cH(Ee.canonical))),sn=Float32Array.from(kt.globeMatrix),Dt=Float32Array.from(f.cD(kt)),si=[f.at(kt.center.lng),f.aA(kt.center.lat)],Gt=[0,0],jn=Float32Array.from(f.cG(Ee.canonical,Zn,hr,kt.worldSize/kt._pixelsPerMercatorPixel))}else Gt=H instanceof f.aJ?H.perspectiveTransform:[0,0],ln=new Float32Array(16),sn=new Float32Array(9),Dt=new Float32Array(16),si=[0,0],jn=new Float32Array(9);const fr=Zt(dt,ln,sn,Dt,jn,Vt||[0,0],f.ae(m.transform.zoom),si,hn,Pt||1,st,c,Gt,A?c.paint.get("raster-elevation"):0,2,Be,Ye,j.range,pt,Ct,G),Fi=m.isTileAffectedByFog(Ee),ji=m.getOrCreateProgram("raster",{defines:j.defines,overrideFog:Fi});if(m.uploadCommonUniforms(N,ji,Re),H instanceof f.aJ){const Zn=H.elevatedGlobeVertexBuffer,Ht=H.elevatedGlobeIndexBuffer;if(Q||!M)H.boundsBuffer&&H.boundsSegments&&ji.draw(m,z.TRIANGLES,He,Tn.disabled,J,mn.disabled,fr,c.id,H.boundsBuffer,m.quadTriangleIndexBuffer,H.boundsSegments);else if(Zn&&Ht){const gn=kt.zoom<=f.c6?H.elevatedGlobeSegments:H.getSegmentsForLongitude(kt.center.lng);gn&&ji.draw(m,z.TRIANGLES,He,Tn.disabled,J,be,fr,c.id,Zn,Ht,gn)}}else if(F){He=new on(z.LEQUAL,on.ReadOnly,m.depthRangeFor3D);const Zn=m.globeSharedBuffers;if(Zn){const[Ht,gn,Si]=Zn.getGridBuffers(hr,!1);ji.draw(m,z.TRIANGLES,He,ye||Ke,m.colorModeForRenderPass(),be,fr,c.id,Ht,gn,Si)}}else{const{tileBoundsBuffer:Zn,tileBoundsIndexBuffer:Ht,tileBoundsSegments:gn}=m.getTileBoundsBuffers(Xe);ji.draw(m,z.TRIANGLES,He,Ke,J,mn.disabled,fr,c.id,Zn,Ht,gn)}}if(!(H instanceof f.aJ)&&F)for(const Ee of ve){const Re=Ee.canonical.y===(1<<Ee.canonical.z)-1;0===Ee.canonical.y&&jt(!0,Ee,m,s,c,G,j,be,ye||Tn.disabled),Re&&jt(!1,Ee,m,s,c,G,j,be===mn.frontCW?mn.backCW:mn.frontCW,ye||Tn.disabled)}};F?xe(me,m.renderElevatedRasterBackface?mn.backCW:mn.frontCW,m.stencilModeFor3D()):xe(me,mn.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,s,c,g,b,x){"offscreen"===m.renderPass&&function(M,A,F,N){if(!N.length)return;const z=M.context,H=z.gl,j=A.getSource();if(!(j instanceof Sd))return;const G=Math.ceil(Math.sqrt(F.paint.get("raster-particle-count")));let J=F.particlePositionRGBAImage;if(!J||J.width!==G){const me=function(pe){const xe=pe*pe,ve=new Uint8Array(4*xe),be=function(Ee){return Ee|=0,Ee=Math.imul(2747636419^Ee,2654435769),Ee=Math.imul(Ee^Ee>>>16,2654435769),((Ee=Math.imul(Ee^Ee>>>16,2654435769))>>>0)/4294967296},ye=1/1.1;for(let Ee=0;Ee<xe;Ee++){const Re=ye*(be(2*Ee+0)+Ld),Xe=ye*(be(2*Ee+1)+Ld),qe=255*Re%1,Ae=255*Xe%1,Be=qe,Ye=Xe-Ae/255,pt=Ae;ve[4*Ee+0]=255*(Re-qe/255),ve[4*Ee+1]=255*Be,ve[4*Ee+2]=255*Ye,ve[4*Ee+3]=255*pt}return ve}(G);J=F.particlePositionRGBAImage=new f.r({width:G,height:G},me)}let Q=F.particleFramebuffer;Q?Q.width!==G&&(Q.destroy(),Q=F.particleFramebuffer=z.createFramebuffer(G,G,!0,null)):Q=F.particleFramebuffer=z.createFramebuffer(G,G,!0,null);const te=[];for(const me of N){const pe=A.getTile(me);if(!(pe instanceof j_))continue;const xe=mg(pe,j,F);if(!xe)continue;const ve=[pe.tileSize,pe.tileSize];let be=F.tileFramebuffer;be||(be=F.tileFramebuffer=z.createFramebuffer(ve[0],ve[1],!0,null));let ye=pe.rasterParticleState;ye||(ye=pe.rasterParticleState=new Ps(z,me,ve,J));const Ee=ye.update(F.lastInvalidatedAt);ye.particleTextureDimension!==G&&ye.updateParticleTexture(me,J);const Re=ye.targetColorTexture;ye.targetColorTexture=ye.backgroundColorTexture,ye.backgroundColorTexture=Re;const Xe=ye.particleTexture0;ye.particleTexture0=ye.particleTexture1,ye.particleTexture1=Xe,te.push([me,xe,ye,Ee])}if(0===te.length)return;const ne=f.q.now(),le=F.previousDrawTimestamp?.001*(ne-F.previousDrawTimestamp):.0167;if(F.previousDrawTimestamp=ne,F.hasColorMap()){z.activeTexture.set(H.TEXTURE0+2);let me=F.colorRampTexture;me||(me=F.colorRampTexture=new f.T(z,F.colorRamp,H.RGBA8)),me.bind(H.LINEAR,H.CLAMP_TO_EDGE)}z.bindFramebuffer.set(F.tileFramebuffer.framebuffer),function(me,pe,xe){const ve=me.context,be=ve.gl,ye=pe.tileFramebuffer;ve.activeTexture.set(be.TEXTURE0);const Ee={u_texture:0,u_opacity:1.05*(Xe=pe.paint.get("raster-particle-fade-opacity-factor"))/(Xe+.05)},Re=me.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Xe;for(const qe of xe){const[,,Ae,Be]=qe;ye.colorAttachment.set(Ae.targetColorTexture.texture),ve.viewport.set([0,0,ye.width,ye.height]),ve.clear({color:f.aj.transparent}),Be&&(Ae.backgroundColorTexture.bind(be.NEAREST,be.CLAMP_TO_EDGE),Re.draw(me,be.TRIANGLES,on.disabled,Tn.disabled,An.alphaBlended,mn.disabled,Ee,pe.id,me.viewportBuffer,me.quadTriangleIndexBuffer,me.viewportSegments))}}(M,F,te),function(me,pe,xe,ve){const be=me.context,ye=be.gl,Ee=xe.tileFramebuffer,Re="globe"===me.transform.projection.name,Xe=xe.paint.get("raster-particle-max-speed");for(const qe of ve){const[Ae,Be,Ye]=qe;be.activeTexture.set(ye.TEXTURE0+0),Be.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),Ee.colorAttachment.set(Ye.targetColorTexture.texture);const pt=me.getOrCreateProgram("rasterParticleDraw",{defines:Be.defines,overrideFog:!1});be.activeTexture.set(ye.TEXTURE0+1);const Ct=Be.scalarData?[]:[0,1,2,3].map(Ke=>f.d4[Ke](Ae));Ct.push(Ae);const He=Ae.canonical.x,dt=Ae.canonical.y;for(const Ke of Ct){const bt=pe.getTile(Re?Ke.wrapped():Ke);if(!bt)continue;const ht=bt.rasterParticleState;if(!ht)continue;const st=Ke.canonical.x+(1<<Ke.canonical.z)*(Ke.wrap-Ae.wrap),Pt=Ke.canonical.y;ht.particleTexture0.bind(ye.NEAREST,ye.CLAMP_TO_EDGE);const Vt=Qc(1,ht.particleTexture0.size[0],[st-He,Pt-dt],0,Be.texture.size,2,Xe,Be.textureOffset,Be.scale,Be.offset);pt.draw(me,ye.POINTS,on.disabled,Tn.disabled,An.alphaBlended,mn.disabled,Vt,xe.id,ht.particleIndexBuffer,void 0,ht.particleSegment)}}}(M,A,F,te),z.bindFramebuffer.set(F.particleFramebuffer.framebuffer),function(me,pe,xe,ve){const be=me.context,ye=be.gl,Ee=pe.paint.get("raster-particle-max-speed"),Re=ve*pe.paint.get("raster-particle-speed-factor")*.15,Xe=(Ae=.01+1*pe.paint.get("raster-particle-reset-rate-factor"),Math.pow(Ae,6)),qe=pe.particleFramebuffer;var Ae;be.viewport.set([0,0,qe.width,qe.height]);for(const Ae of xe){const[,Be,Ye]=Ae;be.activeTexture.set(ye.TEXTURE0+0),Be.texture.bind(ye.LINEAR,ye.CLAMP_TO_EDGE),be.activeTexture.set(ye.TEXTURE0+1);const pt=Ye.particleTexture0;pt.bind(ye.NEAREST,ye.CLAMP_TO_EDGE);const Ct=rn(1,pt.size[0],0,Be.texture.size,Ee,Re,Xe,Be.textureOffset,Be.scale,Be.offset);qe.colorAttachment.set(Ye.particleTexture1.texture),be.clear({color:f.aj.transparent}),me.getOrCreateProgram("rasterParticleUpdate",{defines:Be.defines}).draw(me,ye.TRIANGLES,on.disabled,Tn.disabled,An.unblended,mn.disabled,Ct,pe.id,me.viewportBuffer,me.quadTriangleIndexBuffer,me.viewportSegments)}}(M,F,te,le)}(m,s,c,g),"translucent"===m.renderPass&&(function(M,A,F,N){const H=M.context,j=H.gl,G=A.getSource().tileSize,J=5*(1-f.ac(f.bY,f.bY+1,M.transform.zoom))*G+F.paint.get("raster-particle-elevation"),Q=!M.options.moving,te="globe"===M.transform.projection.name;if(!N.length)return;const[ne,le]=M.stencilConfigForOverlap(N),me=[];te&&me.push("PROJECTION_GLOBE_VIEW");const pe=M.stencilModeFor3D();for(const xe of le){const ve=xe.toUnwrapped(),be=A.getTile(xe);if(!be.rasterParticleState)continue;const ye=be.rasterParticleState,Ee=100;be.registerFadeDuration(Ee);const Re=A.findLoadedParent(xe,0),Xe=hl(be,Re,A,M.transform,Ee);let qe,Ae;M.terrain&&M.terrain.prepareDrawTile(),H.activeTexture.set(j.TEXTURE0),ye.targetColorTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),H.activeTexture.set(j.TEXTURE1),Re&&Re.rasterParticleState?(Re.rasterParticleState.targetColorTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),qe=Math.pow(2,Re.tileID.overscaledZ-be.tileID.overscaledZ),Ae=[be.tileID.canonical.x*qe%1,be.tileID.canonical.y*qe%1]):ye.targetColorTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE);const Be=te?Float32Array.from(M.transform.expandedFarZProjMatrix):M.transform.calculateProjMatrix(ve,Q),Ye=M.transform,pt=zd(Ye),Ct=f.cE(xe.canonical),He=f.cF(Ct.getCenter().lat);let dt,Ke,bt,ht,st;te?(dt=Float32Array.from(f.bb(f.cH(xe.canonical))),Ke=Float32Array.from(Ye.globeMatrix),bt=Float32Array.from(f.cD(Ye)),ht=[f.at(Ye.center.lng),f.aA(Ye.center.lat)],st=Float32Array.from(f.cG(xe.canonical,Ct,He,Ye.worldSize/Ye._pixelsPerMercatorPixel))):(dt=new Float32Array(16),Ke=new Float32Array(9),bt=new Float32Array(16),ht=[0,0],st=new Float32Array(9));const Pt=ju(Be,dt,Ke,bt,st,Ae||[0,0],f.ae(M.transform.zoom),ht,pt,qe||1,Xe,J),Vt=M.isTileAffectedByFog(xe),kt=M.getOrCreateProgram("rasterParticle",{defines:me,overrideFog:Vt});if(M.uploadCommonUniforms(H,kt,ve),te){const Gt=new on(j.LEQUAL,on.ReadOnly,M.depthRangeFor3D),hn=0,ln=M.globeSharedBuffers;if(ln){const[sn,Dt,si]=ln.getGridBuffers(He,0!==hn);kt.draw(M,j.TRIANGLES,Gt,pe,An.alphaBlended,M.renderElevatedRasterBackface?mn.frontCCW:mn.backCCW,Pt,F.id,sn,Dt,si)}}else{const Gt=M.depthModeForSublayer(0,on.ReadOnly),hn=ne[xe.overscaledZ],{tileBoundsBuffer:ln,tileBoundsIndexBuffer:sn,tileBoundsSegments:Dt}=M.getTileBoundsBuffers(be);kt.draw(M,j.TRIANGLES,Gt,hn,An.alphaBlended,mn.disabled,Pt,F.id,ln,sn,Dt)}}M.resetStencilClippingMasks()}(m,s,c,g),m.style.map.triggerRepaint())},background:function(m,s,c,g){const b=c.paint.get("background-color"),x="none"===c.paint.get("background-color-use-theme").constantOr("default"),M=c.paint.get("background-opacity"),A=c.paint.get("background-emissive-strength"),F="viewport"===c.paint.get("background-pitch-alignment");if(0===M)return;const N=m.context,z=N.gl,H=m.transform,j=H.tileSize,G=c.paint.get("background-pattern");let J;if(void 0!==G&&(null===G||(J=m.imageManager.getPattern(G.toString(),c.scope,m.style.getLut(c.scope)),!J)))return;const Q=!G&&1===b.a&&1===M&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==Q)return;const te=Tn.disabled,ne=m.depthModeForSublayer(0,"opaque"===Q?on.ReadWrite:on.ReadOnly),le=m.colorModeForDrapableLayerRenderPass(A),me=G?"backgroundPattern":"background";let pe,xe=g;if(xe||(pe=m.getBackgroundTiles(),xe=Object.values(pe).map(ve=>ve.tileID)),G&&(N.activeTexture.set(z.TEXTURE0),m.imageManager.bind(m.context,c.scope)),F){const ve=m.getOrCreateProgram(me,{overrideFog:!1,overrideRtt:!0}),be=new Float32Array(f.ab.mat4.identity([])),ye=new f.aG(0,0,0,0,0),Ee=G?ny(be,A,M,m,0,c.scope,J,F,{tileID:ye,tileSize:j}):gw(be,A,M,b.toRenderColor(x?null:c.lut));ve.draw(m,z.TRIANGLES,ne,te,le,mn.disabled,Ee,c.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(const ve of xe){const be=m.isTileAffectedByFog(ve),ye=m.getOrCreateProgram(me,{overrideFog:be}),Ee=ve.toUnwrapped(),Re=g?ve.projMatrix:m.transform.calculateProjMatrix(Ee);m.prepareDrawTile();const Xe=s?s.getTile(ve):pe?pe[ve.key]:new Mu(ve,j,H.zoom,m),qe=G?ny(Re,A,M,m,0,c.scope,J,F,{tileID:ve,tileSize:j}):gw(Re,A,M,b.toRenderColor(x?null:c.lut));m.uploadCommonUniforms(N,ye,Ee);const{tileBoundsBuffer:Ae,tileBoundsIndexBuffer:Be,tileBoundsSegments:Ye}=m.getTileBoundsBuffers(Xe);ye.draw(m,z.TRIANGLES,ne,te,le,mn.disabled,qe,c.id,Ae,Be,Ye)}},sky:function(m,s,c){const g=m._atmosphere?f.ae(m.transform.zoom):1,b=c.paint.get("sky-opacity")*g;if(0===b)return;const x=m.context,M=c.paint.get("sky-type"),A=new on(x.gl.LEQUAL,on.ReadOnly,[0,1]),F=m.frameCounter/1e3%1;"atmosphere"===M?"offscreen"===m.renderPass?c.needsSkyboxCapture(m)&&(function(N,z){const G=N.context,J=G.gl;let Q=z.skyboxFbo;if(!Q){Q=z.skyboxFbo=G.createFramebuffer(32,32,!0,null),z.skyboxGeometry=new Ud(G),z.skyboxTexture=G.gl.createTexture(),J.bindTexture(J.TEXTURE_CUBE_MAP,z.skyboxTexture),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_S,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_WRAP_T,J.CLAMP_TO_EDGE),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MIN_FILTER,J.LINEAR),J.texParameteri(J.TEXTURE_CUBE_MAP,J.TEXTURE_MAG_FILTER,J.LINEAR);for(let me=0;me<6;++me)J.texImage2D(J.TEXTURE_CUBE_MAP_POSITIVE_X+me,0,J.RGBA,32,32,0,J.RGBA,J.UNSIGNED_BYTE,null)}G.bindFramebuffer.set(Q.framebuffer),G.viewport.set([0,0,32,32]);const te=z.getCenter(N,!0),ne=N.getOrCreateProgram("skyboxCapture"),le=new Float64Array(16);f.ab.mat4.identity(le),f.ab.mat4.rotateY(le,le,.5*-Math.PI),Cs(N,z,ne,le,te,0),f.ab.mat4.identity(le),f.ab.mat4.rotateY(le,le,.5*Math.PI),Cs(N,z,ne,le,te,1),f.ab.mat4.identity(le),f.ab.mat4.rotateX(le,le,.5*-Math.PI),Cs(N,z,ne,le,te,2),f.ab.mat4.identity(le),f.ab.mat4.rotateX(le,le,.5*Math.PI),Cs(N,z,ne,le,te,3),f.ab.mat4.identity(le),Cs(N,z,ne,le,te,4),f.ab.mat4.identity(le),f.ab.mat4.rotateY(le,le,Math.PI),Cs(N,z,ne,le,te,5),G.viewport.set([0,0,N.width,N.height])}(m,c),c.markSkyboxValid(m)):"sky"===m.renderPass&&function(N,z,H,j,G){const J=N.context,Q=J.gl,te=N.transform,ne=N.getOrCreateProgram("skybox");J.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_CUBE_MAP,z.skyboxTexture);const le=((me,pe,xe,ve,be)=>({u_matrix:me,u_sun_direction:pe,u_cubemap:0,u_opacity:ve,u_temporal_offset:be}))(te.skyboxMatrix,z.getCenter(N,!1),0,j,G);N.uploadCommonUniforms(J,ne),ne.draw(N,Q.TRIANGLES,H,Tn.disabled,N.colorModeForRenderPass(),mn.backCW,le,"skybox",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(m,c,A,b,F):"gradient"===M&&"sky"===m.renderPass&&function(N,z,H,j,G){const J=N.context,Q=J.gl,te=N.transform,ne=N.getOrCreateProgram("skyboxGradient");z.skyboxGeometry||(z.skyboxGeometry=new Ud(J)),J.activeTexture.set(Q.TEXTURE0);let le=z.colorRampTexture;le||(le=z.colorRampTexture=new f.T(J,z.colorRamp,Q.RGBA8)),le.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const me=(pe=te.skyboxMatrix,xe=z.getCenter(N,!1),ve=z.paint.get("sky-gradient-radius"),be=j,ye=G,{u_matrix:pe,u_color_ramp:0,u_center_direction:xe,u_radius:f.ai(ve),u_opacity:be,u_temporal_offset:ye});var pe,xe,ve,be,ye;N.uploadCommonUniforms(J,ne),ne.draw(N,Q.TRIANGLES,H,Tn.disabled,N.colorModeForRenderPass(),mn.backCW,me,"skyboxGradient",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(m,c,A,b,F)},debug:function(m,s,c,g,b,x){for(let M=0;M<c.length;M++)if(b){const N=new f.aj(.8*g.r,.8*g.g,.8*g.b,1);ws(m,s,c[M],g,-1,-1,x),ws(m,s,c[M],g,-1,1,x),ws(m,s,c[M],g,1,1,x),ws(m,s,c[M],g,1,-1,x),ws(m,s,c[M],N,0,0,x)}else ws(m,s,c[M],g,0,0,x)},custom:function(m,s,c,g){const b=m.context,x=c.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||"offscreen"===m.renderPass)&&c.isDraped(s)){if("offscreen"===m.renderPass){const M=x.prerender;if(M){if(m.setCustomLayerDefaults(),b.setColorMode(m.colorModeForRenderPass()),"globe"===m.transform.projection.name){const A=m.transform.pointMerc;M.call(x,b.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),f.ae(m.transform.zoom),[A.x,A.y],m.transform.pixelsPerMeterRatio)}else M.call(x,b.gl,m.transform.customLayerMatrix());b.setDirty(),m.setBaseState()}}else if("translucent"===m.renderPass){if(m.terrain&&m.terrain.renderingToTexture){const A=x.renderToTile;if(A){const F=g[0].canonical,N=new f.aa(F.x+g[0].wrap*(1<<F.z),F.y,F.z);b.setDepthMode(on.disabled),b.setStencilMode(Tn.disabled),b.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),A.call(x,b.gl,N),b.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),b.setColorMode(m.colorModeForRenderPass()),b.setStencilMode(Tn.disabled);const M="3d"===x.renderingMode?new on(m.context.gl.LEQUAL,on.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,on.ReadOnly);if(b.setDepthMode(M),"globe"===m.transform.projection.name){const A=m.transform.pointMerc;x.render(b.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),f.ae(m.transform.zoom),[A.x,A.y],m.transform.pixelsPerMeterRatio)}else x.render(b.gl,m.transform.customLayerMatrix());b.setDirty(),m.setBaseState(),b.bindFramebuffer.set(null)}}else f.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,s,c,g){if("opaque"===m.renderPass)return;const b=c.paint.get("model-opacity").constantOr(1);if(0===b)return;const x=c.paint.get("model-cast-shadows");if("shadow"===m.renderPass&&(!x||m.terrain&&b<.65&&c._transitionablePaint._values["model-opacity"].value.expression instanceof f.a9))return;const M=m.shadowRenderer,A=c.paint.get("model-receive-shadows");M&&(M.useNormalOffset=!0,A||(M.enabled=!1));const F=()=>{M&&(M.useNormalOffset=!0,A||(M.enabled=!0))},N=s.getSource();if("light-beam"===m.renderPass&&"batched-model"!==N.type)return;if("vector"===N.type||"geojson"===N.type)return function(ne,le,me,pe,xe){const ve=ne.transform;if("mercator"!==ve.projection.name)return void f.w(`Drawing 3D models for ${ve.projection.name} projection is not yet implemented`);const be=ve.getFreeCameraOptions().position;if(!ne.modelManager)return;const ye=ne.modelManager;me.modelManager=ye;const Ee=ne.shadowRenderer;if(!me._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const Re=me._unevaluatedLayout._values["model-id"],Xe={...me.layout.get("model-id").parameters},qe=ne.style.order.indexOf(me.fqid);for(const Ae of pe){const Be=le.getTile(Ae).getBucket(me);if(!Be||Be.projection.name!==ve.projection.name)continue;const Ye=Be.getModelUris();Ye&&!Be.modelsRequested&&(ye.addModelsFromBucket(Ye,xe),Be.modelsRequested=!0);const pt=hy(Ae,ve);Xe.zoom=pt;const Ct=Re.possiblyEvaluate(Xe);if(fl(ne,Be,Ae),pl.shadowUniformsInitialized=!1,pl.useSingleShadowCascade=!!Ee&&0===Ee.getMaxCascadeForTile(Ae.toUnwrapped()),"shadow"===ne.renderPass&&Ee){if(1===ne.currentShadowCascade&&Be.isInsideFirstShadowMapFrustum)continue;const Ke=ve.calculatePosMatrix(Ae.toUnwrapped(),ve.worldSize);if(pl.tileMatrix.set(Ke),pl.shadowTileMatrix=Float32Array.from(Ee.calculateShadowPassMatrixFromMatrix(Ke)),pl.aabb.min.fill(0),pl.aabb.max[0]=pl.aabb.max[1]=f.ag,pl.aabb.max[2]=0,Hd(Be,pl,ne,me.scope))continue}const He=1<<Ae.canonical.z,dt=[((be.x-Ae.wrap)*He-Ae.canonical.x)*f.ag,(be.y*He-Ae.canonical.y)*f.ag,be.z*He*f.ag];ne.conflationActive&&Object.keys(Be.instancesPerModel).length>0&&ne.style.isLayerClipped(me,le.getSource())&&Be.updateReplacement(Ae,ne.replacementSource,qe,xe)&&(Be.uploaded=!1,Be.upload(ne.context));for(let Ke in Be.instancesPerModel){const bt=Be.instancesPerModel[Ke];bt.features.length>0&&(Ke=Ct.evaluate(bt.features[0].feature,{}));const ht=ye.getModel(Ke,xe);if(ht&&ht.uploaded)for(const st of ht.nodes)ed(ne,me,st,bt,dt,Ae,pl)}}}(m,s,c,g,"vector"===N.type?c.scope:""),void F();if(!N.loaded())return;if("batched-model"===N.type)return function(ne,le,me,pe){me.resetLayerRenderingStats(ne);const xe=ne.context,ve=ne.transform,be=ne.style.fog,ye=ne.shadowRenderer;if("mercator"!==ve.projection.name)return void f.w(`Drawing 3D landmark models for ${ve.projection.name} projection is not yet implemented`);const Ee=ne.transform.getFreeCameraOptions().position,Re=f.ab.vec3.scale([],[Ee.x,Ee.y,Ee.z],ne.transform.worldSize),Xe=f.ab.vec3.negate([],Re),qe=f.ab.mat4.identity([]),Ae=f.dj(ve.center.lat,ve.zoom),Be=f.ab.mat4.fromScaling([],[1,1,1/Ae]);f.ab.mat4.translate(qe,qe,Xe);const Ye=me.paint.get("model-opacity").constantOr(1),pt=new on(xe.gl.LEQUAL,on.ReadWrite,ne.depthRangeFor3D),Ct=new on(xe.gl.LEQUAL,on.ReadOnly,ne.depthRangeFor3D),He=new f.cd([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),dt="shadow"===ne.renderPass,Ke=dt&&ye?ye.getCurrentCascadeFrustum():ve.getFrustum(ve.scaleZoom(ve.worldSize)),bt=me.paint.get("model-front-cutoff"),ht=bt[2]<1,st=Gc(ne,me.paint.get("model-cutoff-fade-range")),Pt=me.getLayerRenderingStats();(function(Vt,kt,Gt,hn){const ln=Vt.terrain?Vt.terrain.exaggeration():0,sn=Vt.transform.zoom;for(const Dt of hn){const si=kt.getTile(Dt).getBucket(Gt);si&&(Vt.conflationActive&&si.updateReplacement(Dt,Vt.replacementSource),si.evaluateScale(Vt,Gt),Vt.terrain&&ln>0&&si.elevationUpdate(Vt.terrain,ln,Dt,Gt.source),si.needsReEvaluation(Vt,sn,Gt)&&si.evaluate(Gt))}})(ne,le,me,pe),function(){let Vt,kt,Gt;ht?(Vt=pe.length-1,kt=-1,Gt=-1):(Vt=0,kt=pe.length,Gt=1);const hn=new Float64Array(16),ln=f.ab.vec3.create(),sn=new f.P(0,0);for(let Dt=Vt;Dt!==kt;Dt+=Gt){const si=pe[Dt],jn=le.getTile(si).getBucket(me);if(!jn||!jn.uploaded)continue;let hr=!1;ye&&(hr=0===ye.getMaxCascadeForTile(si.toUnwrapped()));const fr=ve.calculatePosMatrix(si.toUnwrapped(),ve.worldSize),Fi=jn.modelTraits;!dt&&ht&&(f.ab.mat4.invert(hn,fr),f.ab.vec3.transformMat4(ln,Re,hn),sn.x=ln[0],sn.y=ln[1]);const ji=[];for(const Zn of jn.getNodesInfo()){if(Zn.hiddenByReplacement||!Zn.node.meshes)continue;const Ht=Zn.node;let gn=0;ne.terrain&&Ht.elevation&&(gn=Ht.elevation*ne.terrain.exaggeration());const Si=(()=>{const Ci=Zn.aabb;return He.min=[...Ci.min],He.max=[...Ci.max],He.min[2]+=gn,He.max[2]+=gn,f.ab.vec3.transformMat4(He.min,He.min,fr),f.ab.vec3.transformMat4(He.max,He.max,fr),He})(),Lr=Zn.evaluatedScale;if(Lr[0]<=1&&Lr[1]<=1&&Lr[2]<=1&&0===Si.intersects(Ke))continue;if(!dt&&ht){const Ci=.16666666666666666;Zn.cameraCollisionOpacity=Re[0]>Si.min[0]&&Re[0]<Si.max[0]&&Re[1]>Si.min[1]&&Re[1]<Si.max[1]&&Re[2]*Ae<Si.max[2]&&Ht.footprint&&f.bA(sn,Ht.footprint)?Math.max(Zn.cameraCollisionOpacity-Ci,0):Math.min(1,Zn.cameraCollisionOpacity+Ci)}const Yo=[...fr],Fs=Ht.anchor?Ht.anchor[0]:0,us=Ht.anchor?Ht.anchor[1]:0;f.ab.mat4.translate(Yo,Yo,[Fs*(Lr[0]-1),us*(Lr[1]-1),gn]),f.ab.vec3.exactEquals(Lr,f.dm)||f.ab.mat4.scale(Yo,Yo,Lr);const ko=f.ab.mat4.multiply([],Yo,Ht.matrix),to=f.ab.mat4.multiply([],ve.expandedFarZProjMatrix,ko),Gr=f.ab.mat4.multiply([],ve.expandedFarZProjMatrix,Yo),pr=f.ab.vec4.transformMat4([],[Fs,us,gn,1],to)[2];Ht.hidden=!1;let nr=Ye;dt||(ht&&(nr*=Zn.cameraCollisionOpacity,nr*=fi(Yo,ve,Zn.aabb,bt)),nr*=yt(st,pr)),0!==nr?ji.push({nodeInfo:Zn,depth:pr,opacity:nr,wvpForNode:to,wvpForTile:Gr,nodeModelMatrix:ko,tileModelMatrix:Yo}):Ht.hidden=!0}dt||ji.sort((Zn,Ht)=>!ht||1===Zn.opacity&&1===Ht.opacity?Zn.depth<Ht.depth?-1:1:1===Zn.opacity?-1:1===Ht.opacity?1:Zn.depth>Ht.depth?-1:1);for(const Zn of ji){const Ht=Zn.nodeInfo,gn=Ht.node;let Si=f.ab.mat4.multiply([],Be,Zn.tileModelMatrix);f.ab.mat4.multiply(Si,qe,Si);const Lr=f.ab.mat4.invert([],Si);f.ab.mat4.transpose(Lr,Lr),f.ab.mat4.scale(Lr,Lr,jd),Si=f.ab.mat4.multiply(Si,Si,gn.matrix);const Yo="light-beam"===ne.renderPass,Fs="none"===me.paint.get("model-color-use-theme").constantOr("default"),us=Fi&f.dp.HasMapboxMeshFeatures,ko=us?0:Ht.evaluatedRMEA[0][2];for(let to=0;to<gn.meshes.length;++to){const Gr=gn.meshes[to],pr=to===gn.lightMeshIndex;let nr=Zn.wvpForNode;if(pr){if(!Yo&&!ne.terrain&&ne.shadowRenderer){ne.currentLayer<ne.firstLightBeamLayer&&(ne.firstLightBeamLayer=ne.currentLayer);continue}nr=Zn.wvpForTile}else if(Yo)continue;const Ci={defines:[]},Zi=[];if(!dt&&ye&&(ye.useNormalOffset=!!Gr.normalBuffer),Ri(Ci.defines,Zi,Gr,ne,Fs?null:me.lut),us||Ci.defines.push("DIFFUSE_SHADED"),hr&&Ci.defines.push("SHADOWS_SINGLE_CASCADE"),Pt&&(dt?Pt.numRenderedVerticesInShadowPass+=Gr.vertexArray.length:Pt.numRenderedVerticesInTransparentPass+=Gr.vertexArray.length),dt){qu(Gr,Zn.nodeModelMatrix,ne,me);continue}let Fo=null;if(be){const wc=yr(Zn.nodeModelMatrix,ne.transform);if(Fo=new Float32Array(wc),"globe"!==ve.projection.name){const Ss=Gr.aabb.min,hs=Gr.aabb.max,[In,gl]=be.getOpacityForBounds(wc,Ss[0],Ss[1],hs[0],hs[1]);Ci.overrideFog=In>=Mt||gl>=Mt}}const ar=Gr.material;let Ms;ar.occlusionTexture&&ar.occlusionTexture.offsetScale&&(Ms=ar.occlusionTexture.offsetScale,Ci.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ml=ne.getOrCreateProgram("model",Ci);!dt&&ye&&ye.setupShadowsFromMatrix(Zn.tileModelMatrix,ml,ye.useNormalOffset),ne.uploadCommonUniforms(xe,ml,null,Fo);const Ls=ar.pbrMetallicRoughness;Ls.metallicFactor=.9,Ls.roughnessFactor=.5;const rd=ry(new Float32Array(nr),new Float32Array(Si),new Float32Array(Lr),new Float32Array(gn.matrix),ne,Zn.opacity,Ls.baseColorFactor.toRenderColor(null),ar.emissiveFactor,Ls.metallicFactor,Ls.roughnessFactor,ar,ko,me,[0,0,0],Ms);!pr&&(Ht.hasTranslucentParts||Zn.opacity<1)&&ml.draw(ne,xe.gl.TRIANGLES,pt,Tn.disabled,An.disabled,mn.backCCW,rd,me.id,Gr.vertexBuffer,Gr.indexBuffer,Gr.segments,me.paint,ne.transform.zoom,void 0,Zi),ml.draw(ne,xe.gl.TRIANGLES,pr?Ct:pt,Tn.disabled,pr||Zn.opacity<1||Ht.hasTranslucentParts?An.alphaBlended:An.unblended,mn.backCCW,rd,me.id,Gr.vertexBuffer,Gr.indexBuffer,Gr.segments,me.paint,ne.transform.zoom,void 0,Zi)}}}}()}(m,s,c,g),void F();if("model"!==N.type)return;const z=N.getModels(),H=[],j=m.transform.getFreeCameraOptions().position,G=f.ab.vec3.scale([],[j.x,j.y,j.z],m.transform.worldSize);f.ab.vec3.negate(G,G);const J=[],Q=[];let te=0;for(const ne of z){const le=c.paint.get("model-rotation").constantOr(null),me=c.paint.get("model-scale").constantOr(null),pe=c.paint.get("model-translation").constantOr(null);ne.computeModelMatrix(m,le,me,pe,!0,!0,!1);const xe=f.ab.mat4.identity([]),ve=f.dj(ne.position.lat,m.transform.zoom),be=f.ab.mat4.fromScaling([],[1,1,1/ve]);f.ab.mat4.translate(xe,xe,G),H.push({zScaleMatrix:be,negCameraPosMatrix:xe});for(const ye of ne.nodes)Jc(m.transform,ye,ne.matrix,m.transform.expandedFarZProjMatrix,te,J,Q);te++}if(J.sort((ne,le)=>le.depth-ne.depth),"shadow"!==m.renderPass){if(1===b)for(const ne of Q)Sp(ne,m,c,H[ne.modelIndex],Tn.disabled,m.colorModeForRenderPass());else{for(const ne of Q)Sp(ne,m,c,H[ne.modelIndex],Tn.disabled,An.disabled);for(const ne of Q)Sp(ne,m,c,H[ne.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(const ne of J)Sp(ne,m,c,H[ne.modelIndex],Tn.disabled,m.colorModeForRenderPass());F()}else{for(const ne of Q)qu(ne.mesh,ne.nodeModelMatrix,m,c);for(const ne of J)qu(ne.mesh,ne.nodeModelMatrix,m,c);F()}}},ra={model:function(m,s,c){const g=s.getSource();if(!g.loaded())return;if("vector"===g.type||"geojson"===g.type)return void(c.modelManager&&c.modelManager.upload(c,"vector"===g.type?m.scope:""));if("batched-model"===g.type||"model"!==g.type)return;const b=g.getModels();for(const x of b)x.upload(c.context)},raster:function(m,s,c){const g=s.getSource();if(!(g instanceof Sd&&g.loaded()))return;const b=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!b)return;const x=m.paint.get("raster-array-band")||g.getInitialBand(b);if(null==x)return;const M=s.getIds().map(A=>s.getTileByID(A));for(const A of M)A.updateNeeded(b,x)&&g.prepareTile(A,b,x)},"raster-particle":function(m,s,c){const g=s.getSource();if(!(g instanceof Sd&&g.loaded()))return;const b=m.sourceLayer||g.rasterLayerIds&&g.rasterLayerIds[0];if(!b)return;const x=m.paint.get("raster-particle-array-band")||g.getInitialBand(b);if(null==x)return;const M=s.getIds().map(A=>s.getTileByID(A));for(const A of M)A.updateNeeded(b,x)&&g.prepareTile(A,b,x)}};class Vl{constructor(s,c,g,b,x){this.context=new ea(s,c),this.transform=g,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=x,this._timeStamp=f.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const M=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const F of M)this._debugParams.enabledLayers[F]=!0;x.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),x.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),x.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),x.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),x.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const F of M)x.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],F);this.occlusionParams=new Bi(x),this.setup(),this.numSublayers=sl.maxUnderzooming+sl.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new f.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new cl(this),this._wireframeDebugCache=new Ii,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const A=new f.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new f.T(this.context,A,s.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=b}updateTerrain(s,c){const g=!!s&&!!s.terrain&&this.transform.projection.supportsTerrain;if(!(g||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new vp(this,s));const b=this._terrain;this.transform.elevation=g?b:null,b.update(s,this.transform,c),this.transform.elevation&&!b.enabled&&(this.transform.elevation=null)}_updateFog(s){const c=s.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[g,b]=c.getFovAdjustedRange(this.transform._fov);if(g>b)return void(this.transform.fogCullDistSq=null);const x=g+.78*(b-g);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(s){s&&!this._terrain&&(this._terrain=new vp(this,this.style)),this._forceTerrainMode=s}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(s,c){if(this.width=s*f.q.devicePixelRatio,this.height=c*f.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const g of this.style.order)this.style._mergedLayers[g].resize()}setup(){const s=this.context,c=new f.b4;c.emplaceBack(0,0),c.emplaceBack(f.ag,0),c.emplaceBack(0,f.ag),c.emplaceBack(f.ag,f.ag),this.tileExtentBuffer=s.createVertexBuffer(c,f.b6.members),this.tileExtentSegments=f.b7.simpleSegment(0,0,4,2);const g=new f.b4;g.emplaceBack(0,0),g.emplaceBack(f.ag,0),g.emplaceBack(0,f.ag),g.emplaceBack(f.ag,f.ag),this.debugBuffer=s.createVertexBuffer(g,f.b6.members),this.debugSegments=f.b7.simpleSegment(0,0,4,5);const b=new f.b4;b.emplaceBack(-1,-1),b.emplaceBack(1,-1),b.emplaceBack(-1,1),b.emplaceBack(1,1),this.viewportBuffer=s.createVertexBuffer(b,f.b6.members),this.viewportSegments=f.b7.simpleSegment(0,0,4,2);const x=new f.aT;x.emplaceBack(0,0,0,0),x.emplaceBack(f.ag,0,f.ag,0),x.emplaceBack(0,f.ag,0,f.ag),x.emplaceBack(f.ag,f.ag,f.ag,f.ag),this.mercatorBoundsBuffer=s.createVertexBuffer(x,f.b9.members),this.mercatorBoundsSegments=f.b7.simpleSegment(0,0,4,2);const M=new f.aU;M.emplaceBack(0,1,2),M.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=s.createIndexBuffer(M);const A=new f.b5;for(const N of[0,1,3,2,0])A.emplaceBack(N);this.debugIndexBuffer=s.createIndexBuffer(A),this.emptyTexture=new f.T(s,new f.r({width:1,height:1},Uint8Array.of(0,0,0,0)),s.gl.RGBA8),this.identityMat=f.ab.mat4.create();const F=this.context.gl;this.stencilClearMode=new Tn({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(s){return s._makeTileBoundsBuffers(this.context,this.transform.projection),s._tileBoundsBuffer?{tileBoundsBuffer:s._tileBoundsBuffer,tileBoundsIndexBuffer:s._tileBoundsIndexBuffer,tileBoundsSegments:s._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const s=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,s.TRIANGLES,on.disabled,this.stencilClearMode,An.disabled,mn.disabled,Ur(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(s,c,g){if(!c||this.currentStencilSource===c.id||!s.isTileClipped()||!g||0===g.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let A=!1;for(const F of g)if(void 0===this._tileClippingMaskIDs[F.key]){A=!0;break}if(!A)return}this.currentStencilSource=c.id;const b=this.context,x=b.gl;this.nextStencilID+g.length>256&&this.clearStencil(),b.setColorMode(An.disabled),b.setDepthMode(on.disabled);const M=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const A of g){const F=c.getTile(A),N=this._tileClippingMaskIDs[A.key]=this.nextStencilID++,{tileBoundsBuffer:z,tileBoundsIndexBuffer:H,tileBoundsSegments:j}=this.getTileBoundsBuffers(F);M.draw(this,x.TRIANGLES,on.disabled,new Tn({func:x.ALWAYS,mask:0},N,255,x.KEEP,x.KEEP,x.REPLACE),An.disabled,mn.disabled,Ur(A.projMatrix),"$clipping",z,H,j)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const s=this.nextStencilID++,c=this.context.gl;return new Tn({func:c.NOTEQUAL,mask:255},s,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(s){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(s);const c=this.context.gl;return new Tn({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[s.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(s){const c=this.context.gl,g=s.sort((M,A)=>A.overscaledZ-M.overscaledZ),b=g[g.length-1].overscaledZ,x=g[0].overscaledZ-b+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const M={};for(let A=0;A<x;A++)M[A+b]=new Tn({func:c.GEQUAL,mask:255},A+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=x,[M,g]}return[{[b]:Tn.disabled},g]}colorModeForRenderPass(){const s=this.context.gl;return this._showOverdrawInspector?new An([s.CONSTANT_COLOR,s.ONE,s.CONSTANT_COLOR,s.ONE],new f.aj(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?An.unblended:An.alphaBlended}colorModeForDrapableLayerRenderPass(s){const c=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&"translucent"===this.renderPass?new An([c.ONE,c.ONE_MINUS_SRC_ALPHA,c.CONSTANT_ALPHA,c.ONE_MINUS_SRC_ALPHA],new f.aj(0,0,0,void 0===s?0:s),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(s,c,g,b=!1){if(this.depthOcclusion)return new on(this.context.gl.GREATER,on.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!b)return on.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+s)*this.depthEpsilon;return new on(g||this.context.gl.LEQUAL,c,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const s=this.context.gl,c=Math.ceil(this.width),g=Math.ceil(this.height),b=this.context.bindFramebuffer.get(),x=s.getParameter(s.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===c&&this.depthFBO.height===g||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),0!==c&&0!==g&&(this.depthFBO=new wp(this.context,c,g,!1,"texture"),this.depthTexture=new f.T(this.context,{width:c,height:g,data:null},s.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(b),s.bindTexture(s.TEXTURE_2D,x),this.depthFBO&&(s.bindFramebuffer(s.READ_FRAMEBUFFER,null),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),s.blitFramebuffer(0,0,c,g,0,0,c,g,s.DEPTH_BUFFER_BIT,s.NEAREST),s.bindFramebuffer(s.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(0===this._dt?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((s,c)=>s+c/this._fpsHistory.length,0))}render(s,c){const g=f.q.now();this._dt=g-this._timeStamp,this._timeStamp=g,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=s.map.repaint,this.style=s,this.options=c;const b=this.style._mergedLayers,x=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(Ae=>{const Be=b[Ae];return!(Be.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Be.type]});let M=!1,A=!1;for(const Ae of x){const Be=b[Ae];"circle"===Be.type&&(M=!0),"symbol"===Be.type&&(Be.hasInitialOcclusionOpacityProperties?A=!0:M=!0)}const F=x.map(Ae=>b[Ae]),N=this.style._mergedSourceCaches;this.imageManager=s.imageManager,this.modelManager=s.modelManager,this.symbolFadeChange=s.placement.symbolFadeChange(f.q.now()),this.imageManager.beginFrame();let z=0,H=!1;for(const Ae in N){const Be=N[Ae];Be.used&&(Be.prepare(this.context),Be.getSource().usedInConflation&&++z)}let j=!1;for(const Ae of F)Ae.isHidden(this.transform.zoom)||("clip"===Ae.type&&(j=!0),this.prepareLayer(Ae));const G={},J={},Q={},te={},ne={};for(const Ae in N){const Be=N[Ae];G[Ae]=Be.getVisibleCoordinates(),J[Ae]=G[Ae].slice().reverse(),Q[Ae]=Be.getVisibleCoordinates(!0).reverse(),te[Ae]=Be.getShadowCasterCoordinates(),ne[Ae]=Be.sortCoordinatesByDistance(G[Ae])}const le=Ae=>{const Be=this.style.getLayerSourceCache(Ae);return Be&&Be.used?Be.getSource():null};if(z||j||this._clippingActiveLastFrame){const Ae=[],Be=[];let Ye=0;for(const pt of F)this.isSourceForClippingOrConflation(pt,le(pt))&&(Ae.push(pt),Be.push(Ye)),Ye++;if(Ae&&(j||Ae.length>1)||this._clippingActiveLastFrame){j=!1;const pt=[];for(let Ct=0;Ct<Ae.length;Ct++){const He=Ae[Ct],dt=Be[Ct],Ke=this.style.getLayerSourceCache(He);if(!Ke||!Ke.used||!Ke.getSource().usedInConflation&&"clip"!==He.type)continue;let bt=f.dx,ht=f.by.None;const st=[];let Pt=!0;if("clip"===He.type){bt=dt;for(const Vt of He.layout.get("clip-layer-types"))ht|="model"===Vt?f.by.Model:"symbol"===Vt?f.by.Symbol:f.by.FillExtrusion;for(const Vt of He.layout.get("clip-layer-scope"))st.push(Vt);He.isHidden(this.transform.zoom)?Pt=!1:j=!0}Pt&&pt.push({layer:He.fqid,cache:Ke,order:bt,clipMask:ht,clipScope:st})}this.replacementSource.setSources(pt),H=!0}}this._clippingActiveLastFrame=j,H||this.replacementSource.clear(),this.conflationActive=H,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let Ae=0;Ae<F.length;Ae++){const Be=F[Ae],Ye=Be.cutoffRange();if(this.longestCutoffRange=Math.max(Ye,this.longestCutoffRange),Ye>0){const pt=le(Be);pt&&(this.minCutoffZoom=Math.max(pt.minzoom,this.minCutoffZoom)),Be.minzoom&&(this.minCutoffZoom=Math.max(Be.minzoom,this.minCutoffZoom))}Be.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=Ae),this._lastOcclusionLayer=Ae)}const me=this.style&&this.style.fog;me?(this._fogVisible=0!==me.getOpacity(this.transform.pitch),this._fogVisible&&"globe"!==this.transform.projection.name&&(this._fogVisible=me.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(Q),this.opaquePassCutoff=0);const pe=this._shadowRenderer;if(pe){pe.updateShadowParameters(this.transform,this.style.directionalLight);for(const Ae in N)for(const Be of G[Ae]){let Ye={min:0,max:0};this.terrain&&(Ye=this.terrain.getMinMaxForTile(Be)||Ye),pe.addShadowReceiver(Be.toUnwrapped(),Ye.min,Ye.max)}}"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new f.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Gu(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const xe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),ve=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(xe&&!this._snow&&(this._snow=new Bl(this)),!xe&&this._snow&&(this._snow.destroy(),delete this._snow),ve&&!this._rain&&(this._rain=new pf(this)),!ve&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Nc.has(this.context.gl))return;this.renderPass="offscreen";for(const Ae of F){const Be=s.getLayerSourceCache(Ae);if(!Ae.hasOffscreenPass()||Ae.isHidden(this.transform.zoom))continue;const Ye=Be?J[Be.id]:void 0;("custom"===Ae.type||"raster"===Ae.type||"raster-particle"===Ae.type||Ae.isSky()||Ye&&Ye.length)&&this.renderLayer(this,Be,Ae,Ye)}this.depthRangeFor3D=[0,1-(F.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,te)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const be="globe"===this.transform.projection.name||this.transform.isHorizonVisible(),ye=(()=>{if(c.showOverdrawInspector)return f.aj.black;const Ae=this.style.fog;if(Ae&&this.transform.projection.supportsFog){const Be=this.style.getLut(Ae.scope);if(!be){const Ye="none"===Ae.properties.get("color-use-theme"),pt=Ae.properties.get("color").toRenderColor(Ye?null:Be).toArray01();return new f.aj(...pt)}if(be){const Ye="none"===Ae.properties.get("space-color-use-theme"),pt=Ae.properties.get("space-color").toRenderColor(Ye?null:Be).toArray01();return new f.aj(...pt)}}return f.aj.transparent})();if(this.context.clear({color:ye,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&be&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const Ae=F[this.currentLayer],Be=s.getLayerSourceCache(Ae);if(Ae.isSky())continue;const Ye=Be?(Ae.is3D()?ne:J)[Be.id]:void 0;this._renderTileClippingMasks(Ae,Be,Ye),this.renderLayer(this,Be,Ae,Ye)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&be&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||f.ae(this.transform.zoom)>0)&&("globe"===this.transform.projection.name||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const Ae=F[this.currentLayer],Be=s.getLayerSourceCache(Ae);Ae.isSky()&&this.renderLayer(this,Be,Ae,Be?J[Be.id]:void 0)}function Ee(Ae,Be){let Ye;return Be&&(Ye=("symbol"===Ae.type?Q:Ae.is3D()?ne:J)[Be.id]),Ye}if(this.renderPass="translucent","globe"===this.transform.projection.name){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<x.length;){const Ae=F[this.currentLayer];if("raster"===Ae.type||"raster-particle"===Ae.type){const Be=s.getLayerSourceCache(Ae);this.renderLayer(this,Be,Ae,Ee(Ae,Be))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let Re=0;pe&&(Re=pe.getShadowCastingLayerCount());let Xe=!1,qe=-1;for(let Ae=0;Ae<x.length;++Ae){const Be=F[Ae];Be.isHidden(this.transform.zoom)||Be.is3D()&&(qe=Ae)}for(A&&-1===qe&&(M=!0);this.currentLayer<x.length;){const Ae=F[this.currentLayer],Be=s.getLayerSourceCache(Ae);if(Ae.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(Ae)){if(Ae.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(M&&!Xe&&this.terrain&&!this.transform.isOrthographic&&(Xe=!0,this.blitDepth()),A&&-1!==qe&&this.currentLayer===qe+1&&!this.transform.isOrthographic&&this.blitDepth(),Ae.is3D()||this.terrain||this._renderTileClippingMasks(Ae,Be,Be?G[Be.id]:void 0),this.renderLayer(this,Be,Ae,Ee(Ae,Be)),!this.terrain&&pe&&Re>0&&Ae.hasShadowPass()&&0==--Re&&(pe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const Ye=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=Ye;this.currentLayer++){const pt=F[this.currentLayer];if(!pt.hasLightBeamPass())continue;const Ct=s.getLayerSourceCache(pt);this.renderLayer(this,Ct,pt,Ct?J[Ct.id]:void 0)}this.currentLayer=Ye,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const Ye=this.currentLayer;this.depthOcclusion=!0;for(const pt of this.layersWithOcclusionOpacity){this.currentLayer=pt;const Ct=F[this.currentLayer],He=s.getLayerSourceCache(Ct),dt=He?J[He.id]:void 0;Ct.is3D()||this.terrain||this._renderTileClippingMasks(Ct,He,He?G[He.id]:void 0),this.renderLayer(this,He,Ct,dt)}this.depthOcclusion=!1,this.currentLayer=Ye,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let Ae=null;F.forEach(Be=>{const Ye=s.getLayerSourceCache(Be);Ye&&!Be.isHidden(this.transform.zoom)&&Ye.getVisibleCoordinates().length&&(!Ae||Ae.getSource().maxzoom<Ye.getSource().maxzoom)&&(Ae=Ye)}),Ae&&this.options.showTileBoundaries&&bc.debug(this,Ae,Ae.getVisibleCoordinates(),f.aj.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&bc.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new f.aj(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(Ae){const Be=Ae.transform.padding;gg(Ae,Ae.transform.height-(Be.top||0),3,Bd),gg(Ae,Be.bottom||0,3,Ta),Hu(Ae,Be.left||0,3,Db),Hu(Ae,Ae.transform.width-(Be.right||0),3,Vd);const Ye=Ae.transform.centerPoint;var pt,Ct,He,dt;$u(pt=Ae,(Ct=Ye.x)-1,(He=Ae.transform.height-Ye.y)-10,2,20,dt=yw),$u(pt,Ct-10,He-1,20,2,dt)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),H||(this.conflationActive=!1)}prepareLayer(s){this.gpuTimingStart(s);const{unsupportedLayers:c}=this.transform.projection,g=!c||!c.includes(s.type);if(ra[s.type]&&(g||this.terrain&&"custom"===s.type)){const b=this.style.getLayerSourceCache(s);ra[s.type](s,b,this)}this.gpuTimingEnd()}renderLayer(s,c,g,b){g.isHidden(this.transform.zoom)||("background"===g.type||"sky"===g.type||"custom"===g.type||"model"===g.type||"raster"===g.type||"raster-particle"===g.type||b&&b.length)&&(this.id=g.id,this.gpuTimingStart(g),s.transform.projection.unsupportedLayers&&s.transform.projection.unsupportedLayers.includes(g.type)&&(!s.terrain||"custom"!==g.type)||"clip"===g.type||bc[g.type](s,c,g,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(s){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery,g=this.context.gl;let b=this.gpuTimers[s.id];b||(b=this.gpuTimers[s.id]={calls:0,cpuTime:0,query:g.createQuery()}),b.calls++,g.beginQuery(c.TIME_ELAPSED_EXT,b.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const s=this.context.extTimerQuery,c=this.context.gl,g=c.createQuery();this.deferredRenderGpuTimeQueries.push(g),c.beginQuery(s.TIME_ELAPSED_EXT,g)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const s=this.gpuTimers;return this.gpuTimers={},s}collectDeferredRenderGpuQueries(){const s=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],s}queryGpuTimers(s){const c={};for(const g in s){const b=s[g],x=this.context.extTimerQuery,M=x.getQueryParameter(b.query,this.context.gl.QUERY_RESULT)/1e6;x.deleteQueryEXT(b.query),c[g]=M}return c}queryGpuTimeDeferredRender(s){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.gl;let g=0;for(const b of s)g+=c.getQueryParameter(b,c.QUERY_RESULT)/1e6,c.deleteQuery(b);return g}translatePosMatrix(s,c,g,b,x){if(!g[0]&&!g[1])return s;const M=x?"map"===b?this.transform.angle:0:"viewport"===b?-this.transform.angle:0;if(M){const N=Math.sin(M),z=Math.cos(M);g=[g[0]*z-g[1]*N,g[0]*N+g[1]*z]}const A=[x?g[0]:f.ar(c,g[0],this.transform.zoom),x?g[1]:f.ar(c,g[1],this.transform.zoom),0],F=new Float32Array(16);return f.ab.mat4.translate(F,s,A),F}saveTileTexture(s){const c=s.size[0],g=this._tileTextures[c];g?g.push(s):this._tileTextures[c]=[s]}getTileTexture(s){const c=this._tileTextures[s];return c&&c.length>0?c.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return null!=this.context.extTextureFloatLinear}currentGlobalDefines(s,c,g){const b=void 0===g?this.terrain&&this.terrain.renderingToTexture:g,x=[];return this.style&&this.style.enable3dLights()&&("globeRaster"===s||"terrainRaster"===s?(x.push("LIGHTING_3D_MODE"),x.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):b||x.push("LIGHTING_3D_MODE")),"shadow"===this.renderPass&&(this._shadowMapDebug||x.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(x.push("TERRAIN"),this.linearFloatFilteringSupported()&&x.push("TERRAIN_DEM_FLOAT_FORMAT")),"globe"===this.transform.projection.name&&x.push("GLOBE"),!this._fogVisible||b||void 0!==c&&!c||x.push("FOG","FOG_DITHERING"),b&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}getOrCreateProgram(s,c){this.cache=this.cache||{};const g=c&&c.defines||[],b=c&&c.config,x=this.currentGlobalDefines(s,c&&c.overrideFog,c&&c.overrideRtt).concat(g),M=Ca.cacheKey(Zc[s],s,x,b);return this.cache[M]||(this.cache[M]=new Ca(this.context,s,Zc[s],b,RT[s],x)),this.cache[M]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const s=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(s.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new f.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(s,c){if(this.style.enable3dLights()){const g=this.style.directionalLight,b=this.style.ambientLight;if(g&&b){const x=((M,A,F)=>{const N=M.properties.get("direction"),z="none"===M.properties.get("color-use-theme"),H=M.properties.get("color").toRenderColor(z?null:F.getLut(M.scope)).toArray01(),j=M.properties.get("intensity"),G="none"===A.properties.get("color-use-theme"),J=A.properties.get("color").toRenderColor(G?null:F.getLut(A.scope)).toArray01(),Q=A.properties.get("intensity"),te=[N.x,N.y,N.z],ne=f.cM(J,Q),le=f.cM(H,j);return{u_lighting_ambient_color:ne,u_lighting_directional_dir:te,u_lighting_directional_color:le,u_ground_radiance:Fd(te,le,ne)}})(g,b,this.style);c.setLightsUniformValues(s,x)}}}uploadCommonUniforms(s,c,g,b,x){if(this.uploadCommonLightUniforms(s,c),this.terrain&&this.terrain.renderingToTexture)return;const M=this.style.fog;if(M){const A=M.getOpacity(this.transform.pitch),F=((N,z,H,j,G,J,Q,te,ne,le,me,pe)=>{const xe=N.transform,ve="none"===z.properties.get("color-use-theme"),be=z.properties.get("color").toRenderColor(ve?null:N.style.getLut(z.scope)).toArray01();be[3]=j;const ye=N.frameCounter/1e3%1,[Ee,Re]=z.properties.get("vertical-range");return{u_fog_matrix:H?xe.calculateFogTileMatrix(H):pe||N.identityMat,u_fog_range:z.getFovAdjustedRange(xe._fov),u_fog_color:be,u_fog_horizon_blend:z.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(Ee,Re),Re],u_fog_temporal_offset:ye,u_frustum_tl:G,u_frustum_tr:J,u_frustum_br:Q,u_frustum_bl:te,u_globe_pos:ne,u_globe_radius:le,u_viewport:me,u_globe_transition:f.ae(xe.zoom),u_is_globe:+("globe"===xe.projection.name)}})(this,M,g,A,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*f.q.devicePixelRatio,this.transform.height*f.q.devicePixelRatio],b);c.setFogUniformValues(s,F)}x&&c.setCutoffUniformValues(s,x.uniformValues)}setTileLoadedFlag(s){this.tileLoaded=s}saveCanvasCopy(){const s=this.canvasCopy();s&&(this.frameCopies.push(s),this.tileLoaded=!1)}canvasCopy(){const s=this.context.gl,c=s.createTexture();return s.bindTexture(s.TEXTURE_2D,c),s.copyTexImage2D(s.TEXTURE_2D,0,s.RGBA,0,0,s.drawingBufferWidth,s.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const s=this.style&&this.style.fog;return!!s&&0!==s.getOpacity(this.transform.pitch)}getBackgroundTiles(){const s=this._backgroundTiles,c=this._backgroundTiles={},g=this.transform.coveringTiles({tileSize:512});for(const b of g)c[b.key]=s[b.key]||new Mu(b,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(s,c){return!(!s.is3D()||"clip"!==s.type&&(s.minzoom&&s.minzoom>this.transform.zoom||(this.style._clipLayerPresent||"building"!==s.sourceLayer)&&(!c||"batched-model"!==c.type)))}isTileAffectedByFog(s){if(!this.style||!this.style.fog)return!1;if("globe"===this.transform.projection.name)return!0;let c=this._cachedTileFogOpacities[s.key];return c||(this._cachedTileFogOpacities[s.key]=c=this.style.fog.getOpacityForTile(s)),c[0]>=Mt||c[1]>=Mt}setupDepthForOcclusion(s,c,g){const b=this.context,x=b.gl,M=!!g;var A;g||(g={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),b.activeTexture.set(x.TEXTURE3),s&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),g.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],g.u_depth_range_unpack=[2/((A=this.depthRangeFor3D)[1]-A[0]),-1-2*A[0]/(A[1]-A[0])],g.u_occluder_half_size=.5*this.occlusionParams.occluderSize,g.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),b.activeTexture.set(x.TEXTURE0),M||c.setTerrainUniformValues(b,g)}}function yg(m,s){let c=!1,g=null;const b=()=>{g=null,c&&(m(),g=setTimeout(b,s),c=!1)};return()=>(c=!0,g||b(),g)}class Ip{constructor(s){this._hashName=s&&encodeURIComponent(s),f.aP(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=yg(this._updateHashUnthrottled.bind(this),300)}addTo(s){return this._map=s,window.addEventListener("hashchange",this._onHashChange,!1),s.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const s=this._map;if(!s)return"";const c=vg(s);if(this._hashName){const g=this._hashName;let b=!1;const x=location.hash.slice(1).split("&").map(M=>{const A=M.split("=")[0];return A===g?(b=!0,`${A}=${c}`):M}).filter(M=>M);return b||x.push(`${g}=${c}`),`#${x.join("&")}`}return`#${c}`}_getCurrentHash(){const s=location.hash.replace("#","");if(this._hashName){let c;return s.split("&").map(g=>g.split("=")).forEach(g=>{g[0]===this._hashName&&(c=g)}),(c&&c[1]||"").split("/")}return s.split("/")}_onHashChange(){const s=this._map;if(!s)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(g=>isNaN(g))){const g=s.dragRotate.isEnabled()&&s.touchZoomRotate.isEnabled()?+(c[3]||0):s.getBearing();return s.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:g,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function vg(m,s){const c=m.getCenter(),g=Math.round(100*m.getZoom())/100,b=Math.ceil((g*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,b),M=Math.round(c.lng*x)/x,A=Math.round(c.lat*x)/x,F=m.getBearing(),N=m.getPitch();let z=s?`/${M}/${A}/${g}`:`${g}/${A}/${M}`;return(F||N)&&(z+="/"+Math.round(10*F)/10),N&&(z+=`/${Math.round(N)}`),z}const mf={linearity:.3,easing:f.dy(0,0,.3,1)},bg=f.l({deceleration:2500,maxSpeed:1400},mf),xg=f.l({deceleration:20,maxSpeed:1400},mf),wg=f.l({deceleration:1e3,maxSpeed:360},mf),kp=f.l({deceleration:1e3,maxSpeed:90},mf);class Ib{constructor(s){this._map=s,this.clear()}clear(){this._inertiaBuffer=[]}record(s){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.q.now(),settings:s})}_drainInertiaBuffer(){const s=this._inertiaBuffer,c=f.q.now();for(;s.length>0&&c-s[0].time>160;)s.shift()}_onMoveEnd(s){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new f.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)c.zoom+=x.zoomDelta||0,c.bearing+=x.bearingDelta||0,c.pitch+=x.pitchDelta||0,x.panDelta&&c.pan._add(x.panDelta),x.around&&(c.around=x.around),x.pinchAround&&(c.pinchAround=x.pinchAround);const g=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(c.pan.mag()){const x=Zu(c.pan.mag(),g,f.l({},bg,s||{}));b.offset=c.pan.mult(x.amount/c.pan.mag()),b.center=this._map.transform.center,gf(b,x)}if(c.zoom){const x=Zu(c.zoom,g,xg);b.zoom=this._map.transform.zoom+x.amount,gf(b,x)}if(c.bearing){const x=Zu(c.bearing,g,wg);b.bearing=this._map.transform.bearing+f.aw(x.amount,-179,179),gf(b,x)}if(c.pitch){const x=Zu(c.pitch,g,kp);b.pitch=this._map.transform.pitch+x.amount,gf(b,x)}if(b.zoom||b.bearing){const x=void 0===c.pinchAround?c.around:c.pinchAround;b.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),b.noMoveStart=!0,b}}function gf(m,s){(!m.duration||m.duration<s.duration)&&(m.duration=s.duration,m.easing=s.easing)}function Zu(m,s,c){const{maxSpeed:g,linearity:b,deceleration:x}=c,M=f.aw(m*b/(s/1e3),-g,g),A=Math.abs(M)/(x*b);return{easing:c.easing,duration:1e3*A,amount:M*(A/2)}}class oa extends f.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,g,b={}){const x=el(c.getCanvasContainer(),g),M=c.unproject(x);super(s,f.l({point:x,lngLat:M,originalEvent:g},b)),this._defaultPrevented=!1,this.target=c}}class _f extends f.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c,g){const b="touchend"===s?g.changedTouches:g.touches,x=tl(c.getCanvasContainer(),b),M=x.map(F=>c.unproject(F)),A=x.reduce((F,N,z,H)=>F.add(N.div(H.length)),new f.P(0,0));super(s,{points:x,point:A,lngLats:M,lngLat:c.unproject(A),originalEvent:g}),this._defaultPrevented=!1}}class my extends f.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(s,c){super("wheel",{originalEvent:c}),this._defaultPrevented=!1}}class gy{constructor(s,c){this._map=s,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(s){return this._firePreventable(new my(this._map,s))}mousedown(s,c){return this._mousedownPos=c,this._firePreventable(new oa(s.type,this._map,s))}mouseup(s){this._map.fire(new oa(s.type,this._map,s))}preclick(s){const c=f.l({},s);c.type="preclick",this._map.fire(new oa(c.type,this._map,c))}click(s,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(s),this._map.fire(new oa(s.type,this._map,s)))}dblclick(s){return this._firePreventable(new oa(s.type,this._map,s))}mouseover(s){this._map.fire(new oa(s.type,this._map,s))}mouseout(s){this._map.fire(new oa(s.type,this._map,s))}touchstart(s){return this._firePreventable(new _f(s.type,this._map,s))}touchmove(s){this._map.fire(new _f(s.type,this._map,s))}touchend(s){this._map.fire(new _f(s.type,this._map,s))}touchcancel(s){this._map.fire(new _f(s.type,this._map,s))}_firePreventable(s){if(this._map.fire(s),s.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Cg{constructor(s){this._map=s}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(s){this._map.fire(new oa(s.type,this._map,s))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new oa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(s){this._delayContextMenu?this._contextMenuEvent=s:this._map.fire(new oa(s.type,this._map,s)),this._map.listens("contextmenu")&&s.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kb{constructor(s,c){this._map=s,this._el=s.getCanvasContainer(),this._container=s.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(s,c){this.isEnabled()&&s.shiftKey&&0===s.button&&($i(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(s,c){if(!this._active)return;const g=c,b=this._startPos,x=this._lastPos;if(!b||!x||x.equals(g)||!this._box&&g.dist(b)<this._clickTolerance)return;this._lastPos=g,this._box||(this._box=Oi("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",s));const M=Math.min(b.x,g.x),A=Math.max(b.x,g.x),F=Math.min(b.y,g.y),N=Math.max(b.y,g.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${M}px,${F}px)`,this._box.style.width=A-M+"px",this._box.style.height=N-F+"px")})}mouseupWindow(s,c){if(!this._active)return;const g=this._startPos,b=c;if(g&&0===s.button){if(this.reset(),bn(),g.x!==b.x||g.y!==b.y)return this._map.fire(new f.z("boxzoomend",{originalEvent:s})),{cameraAnimation:x=>x.fitScreenCoordinates(g,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",s)}}keydown(s){this._active&&27===s.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",s))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Fh(),delete this._startPos,delete this._lastPos}_fireEvent(s,c){return this._map.fire(new f.z(s,{originalEvent:c}))}}function ts(m,s){const c={};for(let g=0;g<m.length;g++)c[m[g].identifier]=s[g];return c}class Yu{constructor(s){this.reset(),this.numTouches=s.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(s,c,g){(this.centroid||g.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=s.timeStamp),g.length===this.numTouches&&(this.centroid=function(b){const x=new f.P(0,0);for(const M of b)x._add(M);return x.div(b.length)}(c),this.touches=ts(g,c)))}touchmove(s,c,g){if(this.aborted||!this.centroid)return;const b=ts(g,c);for(const x in this.touches){const M=b[x];(!M||M.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(s,c,g){if((!this.centroid||s.timeStamp-this.startTime>500)&&(this.aborted=!0),0===g.length){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class ni{constructor(s){this.singleTap=new Yu(s),this.numTaps=s.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(s,c,g){this.singleTap.touchstart(s,c,g)}touchmove(s,c,g){this.singleTap.touchmove(s,c,g)}touchend(s,c,g){const b=this.singleTap.touchend(s,c,g);if(b){const x=s.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(b)<30;if(x&&M||this.reset(),this.count++,this.lastTime=s.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Ma{constructor(){this._zoomIn=new ni({numTouches:1,numTaps:2}),this._zoomOut=new ni({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(s,c,g){this._zoomIn.touchstart(s,c,g),this._zoomOut.touchstart(s,c,g)}touchmove(s,c,g){this._zoomIn.touchmove(s,c,g),this._zoomOut.touchmove(s,c,g)}touchend(s,c,g){const b=this._zoomIn.touchend(s,c,g),x=this._zoomOut.touchend(s,c,g);return b?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()+1,around:M.unproject(b)},{originalEvent:s})}):x?(this._active=!0,s.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:M=>M.easeTo({duration:300,zoom:M.getZoom()-1,around:M.unproject(x)},{originalEvent:s})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const vw={0:1,2:2};class Xu{constructor(s){this.reset(),this._clickTolerance=s.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(s,c){return!1}_move(s,c){return{}}mousedown(s,c){if(this._lastPoint)return;const g=xn(s);this._correctButton(s,g)&&(this._lastPoint=c,this._eventButton=g)}mousemoveWindow(s,c){const g=this._lastPoint;if(g)if(s.preventDefault(),null!=this._eventButton&&function(b,x){const M=vw[x];return void 0===b.buttons||(b.buttons&M)!==M}(s,this._eventButton))this.reset();else if(this._moved||!(c.dist(g)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(g,c)}mouseupWindow(s){this._lastPoint&&xn(s)===this._eventButton&&(this._moved&&bn(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ap extends Xu{mousedown(s,c){super.mousedown(s,c),this._lastPoint&&(this._active=!0)}_correctButton(s,c){return 0===c&&!s.ctrlKey}_move(s,c){return{around:c,panDelta:c.sub(s)}}}class Tg extends Xu{_correctButton(s,c){return 0===c&&s.ctrlKey||2===c}_move(s,c){const g=.8*(c.x-s.x);if(g)return this._active=!0,{bearingDelta:g}}contextmenu(s){s.preventDefault()}}class Rp extends Xu{_correctButton(s,c){return 0===c&&s.ctrlKey||2===c}_move(s,c){const g=-.5*(c.y-s.y);if(g)return this._active=!0,{pitchDelta:g}}contextmenu(s){s.preventDefault()}}class $d{constructor(s,c){this._map=s,this._el=s.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),f.aP(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new f.P(0,0)}touchstart(s,c,g){return this._calculateTransform(s,c,g)}touchmove(s,c,g){if(this._active&&!(g.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===g.length&&!f.dz())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return s.cancelable&&s.preventDefault(),this._calculateTransform(s,c,g)}}touchend(s,c,g){this._calculateTransform(s,c,g),this._active&&g.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(s,c,g){g.length>0&&(this._active=!0);const b=ts(g,c),x=new f.P(0,0),M=new f.P(0,0);let A=0;for(const N in b){const z=b[N],H=this._touches[N];H&&(x._add(z),M._add(z.sub(H)),A++,b[N]=z)}if(this._touches=b,A<this._minTouches||!M.mag())return;const F=M.div(A);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(A),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Oi("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Wo{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(s){}_move(s,c,g){return{}}touchstart(s,c,g){this._firstTwoTouches||g.length<2||(this._firstTwoTouches=[g[0].identifier,g[1].identifier],this._start([c[0],c[1]]))}touchmove(s,c,g){const b=this._firstTwoTouches;if(!b)return;s.preventDefault();const[x,M]=b,A=Ku(g,c,x),F=Ku(g,c,M);if(!A||!F)return;const N=this._aroundCenter?null:A.add(F).div(2);return this._move([A,F],N,s)}touchend(s,c,g){if(!this._firstTwoTouches)return;const[b,x]=this._firstTwoTouches,M=Ku(g,c,b),A=Ku(g,c,x);M&&A||(this._active&&bn(),this.reset())}touchcancel(){this.reset()}enable(s){this._enabled=!0,this._aroundCenter=!!s&&"center"===s.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ku(m,s,c){for(let g=0;g<m.length;g++)if(m[g].identifier===c)return s[g]}function Fr(m,s){return Math.log(m/s)/Math.LN2}class $a extends Wo{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(s){this._startDistance=this._distance=s[0].dist(s[1])}_move(s,c){const g=this._distance;if(this._distance=s[0].dist(s[1]),this._active||!(Math.abs(Fr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fr(this._distance,g),pinchAround:c}}}function Qu(m,s){return 180*m.angleWith(s)/Math.PI}class yf extends Wo{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(s){this._startVector=this._vector=s[0].sub(s[1]),this._minDiameter=s[0].dist(s[1])}_move(s,c){const g=this._vector;if(this._vector=s[0].sub(s[1]),g&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Qu(this._vector,g),pinchAround:c}}_isBelowThreshold(s){this._minDiameter=Math.min(this._minDiameter,s.mag());const c=25/(Math.PI*this._minDiameter)*360,g=this._startVector;if(!g)return!1;const b=Qu(s,g);return Math.abs(b)<c}}function Pp(m){return Math.abs(m.y)>Math.abs(m.x)}class Ab extends Wo{constructor(s){super(),this._map=s}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(s){this._lastPoints=s,Pp(s[0].sub(s[1]))&&(this._valid=!1)}_move(s,c,g){const b=this._lastPoints;if(!b)return;const x=s[0].sub(b[0]),M=s[1].sub(b[1]);return this._map._cooperativeGestures&&!f.dz()&&g.touches.length<3||(this._valid=this.gestureBeginsVertically(x,M,g.timeStamp),!this._valid)?void 0:(this._lastPoints=s,this._active=!0,{pitchDelta:(x.y+M.y)/2*-.5})}gestureBeginsVertically(s,c,g){if(void 0!==this._valid)return this._valid;const b=s.mag()>=2,x=c.mag()>=2;if(!b&&!x)return;if(!b||!x)return null==this._firstMove&&(this._firstMove=g),g-this._firstMove<100&&void 0;const M=s.y>0==c.y>0;return Pp(s)&&Pp(c)&&M}}const Op={panStep:100,bearingStep:15,pitchStep:10};class vf{constructor(){const s=Op;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(s){if(s.altKey||s.ctrlKey||s.metaKey)return;let c=0,g=0,b=0,x=0,M=0;switch(s.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:s.shiftKey?g=-1:(s.preventDefault(),x=-1);break;case 39:s.shiftKey?g=1:(s.preventDefault(),x=1);break;case 38:s.shiftKey?b=1:(s.preventDefault(),M=-1);break;case 40:s.shiftKey?b=-1:(s.preventDefault(),M=1);break;default:return}return this._rotationDisabled&&(g=0,b=0),{cameraAnimation:A=>{const F=A.getZoom();A.easeTo({duration:300,easeId:"keyboardHandler",easing:Fp,zoom:c?Math.round(F)+c*(s.shiftKey?2:1):F,bearing:A.getBearing()+g*this._bearingStep,pitch:A.getPitch()+b*this._pitchStep,offset:[-x*this._panStep,-M*this._panStep],center:A.getCenter()},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Fp(m){return m*(2-m)}const Mg=4.000244140625,Lp=1/450;class Gd{constructor(s,c){this._map=s,this._el=s.getCanvasContainer(),this._handler=c,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Lp,f.aP(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(s){this._defaultZoomRate=s}setWheelZoomRate(s){this._wheelZoomRate=s}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(s){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!s&&"center"===s.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(s){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(s.ctrlKey||s.metaKey||this.isZooming()||f.dz()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=s.deltaMode===WheelEvent.DOM_DELTA_LINE?40*s.deltaY:s.deltaY;const g=f.q.now(),b=g-(this._lastWheelEventTime||0);this._lastWheelEventTime=g,0!==c&&c%Mg==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=c,this._timeout=window.setTimeout(this._onTimeout,40,s)):this._type||(this._type=Math.abs(b*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),s.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=s,this._delta-=c,this._active||this._start(s)),s.preventDefault()}_onTimeout(s){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(s)}_start(s){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=el(this._el,s);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const s=this._map.transform;"wheel"===this._type&&s.projection.wrap&&(s._center.lng>=180||s._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>s._terrainEnabled()&&this._aroundCoord?s.computeZoomRelativeTo(this._aroundCoord):s.zoom;if(0!==this._delta){const N="wheel"===this._type&&Math.abs(this._delta)>Mg?this._wheelZoomRate:this._defaultZoomRate;let z=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&0!==z&&(z=1/z);const H=c(),j=Math.pow(2,H),G="number"==typeof this._targetZoom?s.zoomScale(this._targetZoom):j;this._targetZoom=Math.min(s.maxZoom,Math.max(s.minZoom,s.scaleZoom(G*z))),"wheel"===this._type&&(this._startZoom=H,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const g="number"==typeof this._targetZoom?this._targetZoom:c(),b=this._startZoom,x=this._easing;let M,A=!1;if("wheel"===this._type&&b&&x){const N=Math.min((f.q.now()-this._lastWheelEventTime)/200,1),z=x(N);M=f.af(b,g,z),N<1?this._frameId||(this._frameId=!0):A=!0}else M=g,A=!0;this._active=!0,A&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let F=M-c();return F*this._lastDelta<0&&(F=0),{noInertia:!0,needsRenderFrame:!A,zoomDelta:F,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(s){let c=f.dA;if(this._prevEase){const g=this._prevEase,b=(f.q.now()-g.start)/g.duration,x=g.easing(b+.01)-g.easing(b),M=.27/Math.sqrt(x*x+1e-4)*.01,A=Math.sqrt(.0729-M*M);c=f.dy(M,A,.25,1)}return this._prevEase={start:f.q.now(),duration:s,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Oi("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class bf{constructor(s,c){this._clickZoom=s,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class id{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(s,c){return s.preventDefault(),{cameraAnimation:g=>{g.easeTo({duration:300,zoom:g.getZoom()+(s.shiftKey?-1:1),around:g.unproject(c)},{originalEvent:s})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ul{constructor(){this._tap=new ni({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(s,c,g){this._swipePoint||(this._tapTime&&s.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?g.length>0&&(this._swipePoint=c[0],this._swipeTouch=g[0].identifier):this._tap.touchstart(s,c,g))}touchmove(s,c,g){if(this._tapTime){if(this._swipePoint){if(g[0].identifier!==this._swipeTouch)return;const b=c[0],x=b.y-this._swipePoint.y;return this._swipePoint=b,s.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(s,c,g)}touchend(s,c,g){this._tapTime?this._swipePoint&&0===g.length&&this.reset():this._tap.touchend(s,c,g)&&(this._tapTime=s.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ju{constructor(s,c,g){this._el=s,this._mousePan=c,this._touchPan=g}enable(s){this._inertiaOptions=s||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class xf{constructor(s,c,g){this._pitchWithRotate=s.pitchWithRotate,this._mouseRotate=c,this._mousePitch=g}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class xc{constructor(s,c,g,b){this._el=s,this._touchZoom=c,this._touchRotate=g,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(s){this._touchZoom.enable(s),this._rotationDisabled||this._touchRotate.enable(s),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Np=m=>m.zoom||m.drag||m.pitch||m.rotate;class Rb extends f.z{}class zp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(s,c){const g=f.ab.vec3.sub([],c,s);this.radius=f.ab.vec3.length(g[2]<0?f.ab.vec3.div([],g,this.constants):[g[0],g[1],0])}projectRay(s){f.ab.vec3.div(s,s,this.constants),f.ab.vec3.normalize(s,s),f.ab.vec3.mul(s,s,this.constants);const c=f.ab.vec3.scale([],s,this.radius);if(c[2]>0){const g=f.ab.vec3.scale([],[0,0,1],f.ab.vec3.dot(c,[0,0,1])),b=f.ab.vec3.scale([],f.ab.vec3.normalize([],[c[0],c[1],0]),this.radius),x=f.ab.vec3.add([],c,f.ab.vec3.scale([],f.ab.vec3.sub([],f.ab.vec3.add([],b,g),c),2));c[0]=x[0],c[1]=x[1]}return c}}function Bp(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class Sg{constructor(s,c){this._map=s,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ib(s),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new zp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),f.aP(["handleEvent","handleWindowEvent"],this);const g=this._el;this._listeners=[[g,"touchstart",{passive:!0}],[g,"touchmove",{passive:!1}],[g,"touchend",void 0],[g,"touchcancel",void 0],[g,"mousedown",void 0],[g,"mousemove",void 0],[g,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[g,"mouseover",void 0],[g,"mouseout",void 0],[g,"dblclick",void 0],[g,"click",void 0],[g,"keydown",{capture:!1}],[g,"keyup",void 0],[g,"wheel",{passive:!1}],[g,"contextmenu",void 0],[window,"blur",void 0]];for(const[b,x,M]of this._listeners){const A=b===document?this.handleWindowEvent:this.handleEvent;b.addEventListener(x,A,M)}}destroy(){for(const[s,c,g]of this._listeners){const b=s===document?this.handleWindowEvent:this.handleEvent;s.removeEventListener(c,b,g)}}_addDefaultHandlers(s){const c=this._map,g=c.getCanvasContainer();this._add("mapEvent",new gy(c,s));const b=c.boxZoom=new kb(c,s);this._add("boxZoom",b);const x=new Ma,M=new id;c.doubleClickZoom=new bf(M,x),this._add("tapZoom",x),this._add("clickZoom",M);const A=new Ul;this._add("tapDragZoom",A);const F=c.touchPitch=new Ab(c);this._add("touchPitch",F);const N=new Tg(s),z=new Rp(s);c.dragRotate=new xf(s,N,z),this._add("mouseRotate",N,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const H=new Ap(s),j=new $d(c,s);c.dragPan=new Ju(g,H,j),this._add("mousePan",H),this._add("touchPan",j,["touchZoom","touchRotate"]);const G=new yf,J=new $a;c.touchZoomRotate=new xc(g,J,G,A),this._add("touchRotate",G,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Cg(c));const Q=c.scrollZoom=new Gd(c,this);this._add("scrollZoom",Q,["mousePan"]);const te=c.keyboard=new vf;this._add("keyboard",te);for(const ne of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])s.interactive&&s[ne]&&c[ne].enable(s[ne])}_add(s,c,g){this._handlers.push({handlerName:s,handler:c,allowed:g}),this._handlersById[s]=c}stop(s){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},s),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:s}of this._handlers)if(s.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Np(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(s,c,g){for(const b in s)if(b!==g&&(!c||c.indexOf(b)<0))return!0;return!1}handleWindowEvent(s){this.handleEvent(s,`${s.type}Window`)}_getMapTouches(s){const c=[];for(const g of s)this._el.contains(g.target)&&c.push(g);return c}handleEvent(s,c){this._updatingCamera=!0;const g="renderFrame"===s.type,b=g?void 0:s,x={needsRenderFrame:!1},M={},A={},F=s.touches?this._getMapTouches(s.touches):void 0,N=F?tl(this._el,F):g?void 0:el(this._el,s);for(const{handlerName:j,handler:G,allowed:J}of this._handlers){if(!G.isEnabled())continue;let Q;this._blockedByActive(A,J,j)?G.reset():G[c||s.type]&&(Q=G[c||s.type](s,N,F),this.mergeHandlerResult(x,M,Q,j,b),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()),(Q||G.isActive())&&(A[j]=G)}const z={};for(const j in this._previousActiveHandlers)A[j]||(z[j]=b);this._previousActiveHandlers=A,(Object.keys(z).length||Bp(x))&&(this._changes.push([x,M,z]),this._triggerRenderFrame()),(Object.keys(A).length||Bp(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:H}=x;H&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],H(this._map))}mergeHandlerResult(s,c,g,b,x){if(!g)return;f.l(s,g);const M={handlerName:b,originalEvent:g.originalEvent||x};void 0!==g.zoomDelta&&(c.zoom=M),void 0!==g.panDelta&&(c.drag=M),void 0!==g.pitchDelta&&(c.pitch=M),void 0!==g.bearingDelta&&(c.rotate=M)}_applyChanges(){const s={},c={},g={};for(const[b,x,M]of this._changes)b.panDelta&&(s.panDelta=(s.panDelta||new f.P(0,0))._add(b.panDelta)),b.zoomDelta&&(s.zoomDelta=(s.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(s.bearingDelta=(s.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(s.pitchDelta=(s.pitchDelta||0)+b.pitchDelta),void 0!==b.around&&(s.around=b.around),void 0!==b.aroundCoord&&(s.aroundCoord=b.aroundCoord),void 0!==b.pinchAround&&(s.pinchAround=b.pinchAround),b.noInertia&&(s.noInertia=b.noInertia),f.l(c,x),f.l(g,M);this._updateMapTransform(s,c,g),this._changes=[]}_updateMapTransform(s,c,g){const b=this._map,x=b.transform,M=le=>[le.x,le.y,le.z];if((()=>{const me=this._eventsInProgress.drag;return me&&!this._handlersById[me.handlerName].isActive()})()&&!Bp(s)){const le=x.zoom;x.cameraElevationReference="sea",null!=this._originalZoom&&x._orthographicProjectionAtLowPitch&&"globe"!==x.projection.name&&0===x.pitch?(x.cameraElevationReference="ground",x.zoom=this._originalZoom):(x.recenterOnTerrain(),x.cameraElevationReference="ground"),le!==x.zoom&&this._map._update(!0)}if(x._isCameraConstrained&&b._stop(!0),!Bp(s))return void this._fireEvents(c,g,!0);let{panDelta:A,zoomDelta:F,bearingDelta:N,pitchDelta:z,around:H,aroundCoord:j,pinchAround:G}=s;x._isCameraConstrained&&(F>0&&(F=0),x._isCameraConstrained=!1),void 0!==G&&(H=G),(F||(()=>c.drag&&!this._eventsInProgress.drag)())&&H&&(this._dragOrigin=M(x.pointCoordinate3D(H)),this._originalZoom=x.zoom,this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",b._stop(!0),H=H||b.transform.centerPoint,N&&(x.bearing+=N),z&&(x.pitch+=z),x._updateCameraState();const J=[0,0,0];if(A)if("mercator"===x.projection.name){const le=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(H).dir),me=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(H.sub(A)).dir);J[0]=me[0]-le[0],J[1]=me[1]-le[1]}else{const le=x.pointCoordinate(H);if("globe"===x.projection.name){A=A.rotate(-x.angle);const me=x._pixelsPerMercatorPixel/x.worldSize;J[0]=-A.x*f.dB(f.aS(le.y))*me,J[1]=-A.y*f.dB(x.center.lat)*me}else{const me=x.pointCoordinate(H.sub(A));le&&me&&(J[0]=me.x-le.x,J[1]=me.y-le.y)}}const Q=x.zoom,te=[0,0,0];if(F){const le=M(j||x.pointCoordinate3D(H)),me={dir:f.ab.vec3.normalize([],f.ab.vec3.sub([],le,x._camera.position))};if(me.dir[2]<0){const pe=x.zoomDeltaToMovement(le,F);f.ab.vec3.scale(te,me.dir,pe)}}const ne=f.ab.vec3.add(J,J,te);x._translateCameraConstrained(ne),F&&Math.abs(x.zoom-Q)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),s.noInertia||this._inertia.record(s),this._fireEvents(c,g,!0)}_fireEvents(s,c,g){const b=Np(this._eventsInProgress),x=Np(s),M={};for(const z in s){const{originalEvent:H}=s[z];this._eventsInProgress[z]||(M[`${z}start`]=H),this._eventsInProgress[z]=s[z]}!b&&x&&this._fireEvent("movestart",x.originalEvent);for(const z in M)this._fireEvent(z,M[z]);x&&this._fireEvent("move",x.originalEvent);for(const z in s){const{originalEvent:H}=s[z];this._fireEvent(z,H)}const A={};let F;for(const z in this._eventsInProgress){const{handlerName:H,originalEvent:j}=this._eventsInProgress[z];this._handlersById[H].isActive()||(delete this._eventsInProgress[z],F=c[H]||j,A[`${z}end`]=F)}for(const z in A)this._fireEvent(z,A[z]);const N=Np(this._eventsInProgress);if(g&&(b||x)&&!N){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=j=>0!==j&&-this._bearingSnap<j&&j<this._bearingSnap;z?(H(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:F})):(this._map.fire(new f.z("moveend",{originalEvent:F})),H(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(s,c){this._map.fire(new f.z(s,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(s=>{this._frameId=void 0,this.handleEvent(new Rb("renderFrame",{timeStamp:s})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const _o="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Vp extends f.E{constructor(s,c){super(),this._moving=!1,this._zooming=!1,this.transform=s,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=!1!==c.respectPrefersReducedMotion,f.aP(["_renderFrameCallback"],this)}getCenter(){return new f.bO(this.transform.center.lng,this.transform.center.lat)}setCenter(s,c){return this.jumpTo({center:s},c)}panBy(s,c,g){return s=f.P.convert(s).mult(-1),this.panTo(this.transform.center,f.l({offset:s},c),g)}panTo(s,c,g){return this.easeTo(f.l({center:s},c),g)}getZoom(){return this.transform.zoom}setZoom(s,c){return this.jumpTo({zoom:s},c),this}zoomTo(s,c,g){return this.easeTo(f.l({zoom:s},c),g)}zoomIn(s,c){return this.zoomTo(this.getZoom()+1,s,c),this}zoomOut(s,c){return this.zoomTo(this.getZoom()-1,s,c),this}getBearing(){return this.transform.bearing}setBearing(s,c){return this.jumpTo({bearing:s},c),this}getPadding(){return this.transform.padding}setPadding(s,c){return this.jumpTo({padding:s},c),this}rotateTo(s,c,g){return this.easeTo(f.l({bearing:s},c),g)}resetNorth(s,c){return this.rotateTo(0,f.l({duration:1e3},s),c),this}resetNorthPitch(s,c){return this.easeTo(f.l({bearing:0,pitch:0,duration:1e3},s),c),this}snapToNorth(s,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(s,c):this}getPitch(){return this.transform.pitch}setPitch(s,c){return this.jumpTo({pitch:s},c),this}cameraForBounds(s,c){s=f.az.convert(s);const g=c&&c.bearing||0,b=c&&c.pitch||0,x=s.getNorthWest(),M=s.getSouthEast();return this._cameraForBounds(this.transform,x,M,g,b,c)}_extendPadding(s){const c={top:0,right:0,bottom:0,left:0};return null==s?f.l({},c,this.transform.padding):"number"==typeof s?{top:s,bottom:s,right:s,left:s}:f.l({},c,s)}_extendCameraOptions(s){return(s=f.l({offset:[0,0],maxZoom:this.transform.maxZoom},s)).padding=this._extendPadding(s.padding),s}_minimumAABBFrustumDistance(s,c){const g=c.max[0]-c.min[0],b=c.max[1]-c.min[1];return g/b>s.aspect?g/(2*Math.tan(.5*s.fovX)*s.aspect):b/(2*Math.tan(.5*s.fovY)*s.aspect)}_cameraForBoundsOnGlobe(s,c,g,b,x,M){const A=s.clone(),F=this._extendCameraOptions(M);A.bearing=b,A.pitch=x;const N=f.bO.convert(c),z=f.bO.convert(g),H=.5*(N.lat+z.lat),j=.5*(N.lng+z.lng),G=f.dC(H,j),J=f.ab.vec3.normalize([],G),Q=f.ab.vec3.normalize([],f.ab.vec3.cross([],J,[0,1,0])),te=f.ab.vec3.cross([],Q,J),ne=[Q[0],Q[1],Q[2],0,te[0],te[1],te[2],0,J[0],J[1],J[2],0,0,0,0,1],le=[G,f.dC(N.lat,N.lng),f.dC(z.lat,N.lng),f.dC(z.lat,z.lng),f.dC(N.lat,z.lng),f.dC(H,N.lng),f.dC(H,z.lng),f.dC(N.lat,j),f.dC(z.lat,j)];let me=f.cd.fromPoints(le.map(Ke=>[f.ab.vec3.dot(Q,Ke),f.ab.vec3.dot(te,Ke),f.ab.vec3.dot(J,Ke)]));const pe=f.ab.vec3.transformMat4([],me.center,ne);0===f.ab.vec3.squaredLength(pe)&&f.ab.vec3.set(pe,0,0,1),f.ab.vec3.normalize(pe,pe),f.ab.vec3.scale(pe,pe,f.ax),A.center=f.dD(pe);const xe=A.getWorldToCameraMatrix(),ve=f.ab.mat4.invert(new Float64Array(16),xe);me=f.cd.applyTransform(me,f.ab.mat4.multiply([],xe,ne));const be=this._extendAABB(me,A,F,b);if(!be)return void f.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");me=be,f.ab.vec3.transformMat4(pe,pe,xe);const ye=.5*(me.max[2]-me.min[2]),Ee=this._minimumAABBFrustumDistance(A,me),Re=f.ab.vec3.scale([],[0,0,1],ye),Xe=f.ab.vec3.add(Re,pe,Re),qe=Ee+(0===A.pitch?0:f.ab.vec3.distance(pe,Xe)),Ae=A.globeCenterInViewSpace,Be=f.ab.vec3.sub([],pe,[Ae[0],Ae[1],Ae[2]]);f.ab.vec3.normalize(Be,Be),f.ab.vec3.scale(Be,Be,qe);const Ye=f.ab.vec3.add([],pe,Be);f.ab.vec3.transformMat4(Ye,Ye,ve);const pt=f.ds/f.ax,Ct=f.ab.vec3.length(Ye),He=f.bH(Math.max(Ct*pt-f.ds,Number.EPSILON),0),dt=Math.min(A.zoomFromMercatorZAdjusted(He),F.maxZoom);return dt>.5*(f.c6+f.bY)?(A.setProjection({name:"mercator"}),A.zoom=dt,this._cameraForBounds(A,c,g,b,x,M)):{center:A.center,zoom:dt,bearing:b,pitch:x}}_extendAABB(s,c,g,b){const x=.5*((g.padding.left||0)+(g.padding.right||0)),M=.5*((g.padding.top||0)+(g.padding.bottom||0)),A=M,F=x,N=x,z=M,H=c.width-(F+N),j=c.height-(A+z),G=f.ab.vec3.sub([],s.max,s.min),J=Math.min(H/G[0],j/G[1]),Q=Math.min(c.scaleZoom(c.scale*J),g.maxZoom);if(isNaN(Q))return null;const te=c.scale/c.zoomScale(Q),ne=new f.cd([s.min[0]-F*te,s.min[1]-z*te,s.min[2]],[s.max[0]+N*te,s.max[1]+A*te,s.max[2]]),le=("number"==typeof g.offset.x&&"number"==typeof g.offset.y?new f.P(g.offset.x,g.offset.y):f.P.convert(g.offset)).rotate(-f.ai(b));return ne.center[0]-=le.x*te,ne.center[1]+=le.y*te,ne}queryTerrainElevation(s,c){const g=this.transform.elevation;return g?(c=f.l({},{exaggerated:!0},c),g.getAtPoint(f.aa.fromLngLat(s),null,c.exaggerated)):null}_cameraForBounds(s,c,g,b,x,M){if("globe"===s.projection.name)return this._cameraForBoundsOnGlobe(s,c,g,b,x,M);const A=s.clone(),F=this._extendCameraOptions(M);A.bearing=b,A.pitch=x;const N=f.bO.convert(c),z=f.bO.convert(g),H=new f.bO(N.lng,z.lat),j=new f.bO(z.lng,N.lat),G=A.project(N),J=A.project(z),Q=this.queryTerrainElevation(N),te=this.queryTerrainElevation(z),ne=this.queryTerrainElevation(H),le=this.queryTerrainElevation(j),me=[[G.x,G.y,Math.min(Q||0,te||0,ne||0,le||0)],[J.x,J.y,Math.max(Q||0,te||0,ne||0,le||0)]];let pe=f.cd.fromPoints(me);const xe=A.getWorldToCameraMatrix(),ve=f.ab.mat4.invert(new Float64Array(16),xe);pe=f.cd.applyTransform(pe,xe);const be=this._extendAABB(pe,A,F,b);if(!be)return void f.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");pe=be;const ye=.5*f.ab.vec3.sub([],pe.max,pe.min)[2],Ee=this._minimumAABBFrustumDistance(A,pe),Re=[0,0,1,0];f.ab.vec4.transformMat4(Re,Re,xe),f.ab.vec4.normalize(Re,Re);const Xe=f.ab.vec3.scale([],Re,Ee+ye),qe=f.ab.vec3.add([],pe.center,Xe);f.ab.vec3.transformMat4(pe.center,pe.center,ve),f.ab.vec3.transformMat4(qe,qe,ve);const Ae=A.unproject(new f.P(pe.center[0],pe.center[1])),Be=f.dE(A.projection,Ae),Ye=Math.pow(2,Be),pt=Math.min(A._zoomFromMercatorZ(qe[2]*A.pixelsPerMeter*Ye/A.worldSize),F.maxZoom);return A.mercatorFromTransition&&pt<.5*(f.c6+f.bY)?(A.setProjection({name:"globe"}),A.zoom=pt,this._cameraForBounds(A,c,g,b,x,M)):{center:Ae,zoom:pt,bearing:b,pitch:x}}fitBounds(s,c,g){const b=this.cameraForBounds(s,c);return this._fitInternal(b,c,g)}fitScreenCoordinates(s,c,g,b,x){const M=f.P.convert(s),A=f.P.convert(c),F=new f.P(Math.min(M.x,A.x),Math.min(M.y,A.y)),N=new f.P(Math.max(M.x,A.x),Math.max(M.y,A.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(M,A))return this;const z=this.transform.pointLocation3D(F),H=this.transform.pointLocation3D(N),j=this.transform.pointLocation3D(new f.P(F.x,N.y)),G=this.transform.pointLocation3D(new f.P(N.x,F.y)),J=[Math.min(z.lng,H.lng,j.lng,G.lng),Math.min(z.lat,H.lat,j.lat,G.lat)],Q=[Math.max(z.lng,H.lng,j.lng,G.lng),Math.max(z.lat,H.lat,j.lat,G.lat)],te=b&&b.pitch?b.pitch:this.getPitch(),ne=this._cameraForBounds(this.transform,J,Q,g,te,b);return this._fitInternal(ne,b,x)}_fitInternal(s,c,g){return s?(c=f.l(s,c)).linear?this.easeTo(c,g):this.flyTo(c,g):this}jumpTo(s,c){this.stop();const g=s.preloadOnly?this.transform.clone():this.transform;let b=!1,x=!1,M=!1;"zoom"in s&&g.zoom!==+s.zoom&&(b=!0,g.zoom=+s.zoom),void 0!==s.center&&(g.center=f.bO.convert(s.center)),"bearing"in s&&g.bearing!==+s.bearing&&(x=!0,g.bearing=+s.bearing),"pitch"in s&&g.pitch!==+s.pitch&&(M=!0,g.pitch=+s.pitch);const A="number"==typeof s.padding?this._extendPadding(s.padding):s.padding;if(null!=s.padding&&!g.isPaddingEqual(A))if(!1===s.retainPadding){const F=g.clone();F.padding=A,g.setLocationAtPoint(g.center,F.centerPoint)}else g.padding=A;return s.preloadOnly?(this._preloadTiles(g),this):(this.fire(new f.z("movestart",c)).fire(new f.z("move",c)),b&&this.fire(new f.z("zoomstart",c)).fire(new f.z("zoom",c)).fire(new f.z("zoomend",c)),x&&this.fire(new f.z("rotatestart",c)).fire(new f.z("rotate",c)).fire(new f.z("rotateend",c)),M&&this.fire(new f.z("pitchstart",c)).fire(new f.z("pitch",c)).fire(new f.z("pitchend",c)),this.fire(new f.z("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||f.w(_o),this.transform.getFreeCameraOptions()}setFreeCameraOptions(s,c){const g=this.transform;if(!g.projection.supportsFreeCamera)return f.w(_o),this;this.stop();const b=g.zoom,x=g.pitch,M=g.bearing;g.setFreeCameraOptions(s);const A=b!==g.zoom,F=x!==g.pitch,N=M!==g.bearing;return this.fire(new f.z("movestart",c)).fire(new f.z("move",c)),A&&this.fire(new f.z("zoomstart",c)).fire(new f.z("zoom",c)).fire(new f.z("zoomend",c)),N&&this.fire(new f.z("rotatestart",c)).fire(new f.z("rotate",c)).fire(new f.z("rotateend",c)),F&&this.fire(new f.z("pitchstart",c)).fire(new f.z("pitch",c)).fire(new f.z("pitchend",c)),this.fire(new f.z("moveend",c)),this}easeTo(s,c){this._stop(!1,s.easeId),(!1===(s=f.l({offset:[0,0],duration:500,easing:f.dA},s)).animate||this._prefersReducedMotion(s))&&(s.duration=0);const g=this.transform,b=this.getZoom(),x=this.getBearing(),M=this.getPitch(),A=this.getPadding(),F="zoom"in s?+s.zoom:b,N="bearing"in s?this._normalizeBearing(s.bearing,x):x,z="pitch"in s?+s.pitch:M,H=this._extendPadding(s.padding),j=f.P.convert(s.offset);let G,J,Q;if("globe"===g.projection.name){const Re=f.aa.fromLngLat(g.center),Xe=j.rotate(-g.angle);Re.x+=Xe.x/g.worldSize,Re.y+=Xe.y/g.worldSize;const qe=Re.toLngLat(),Ae=f.bO.convert(s.center||qe);this._normalizeCenter(Ae),G=g.centerPoint.add(Xe),J=new f.P(Re.x,Re.y).mult(g.worldSize),Q=new f.P(f.at(Ae.lng),f.aA(Ae.lat)).mult(g.worldSize).sub(J)}else{G=g.centerPoint.add(j);const Re=g.pointLocation(G),Xe=f.bO.convert(s.center||Re);this._normalizeCenter(Xe),J=g.project(Re),Q=g.project(Xe).sub(J)}const te=g.zoomScale(F-b);let ne,le;s.around&&(ne=f.bO.convert(s.around),le=g.locationPoint(ne));const me=this._zooming||F!==b,pe=this._rotating||x!==N,xe=this._pitching||z!==M,ve=!g.isPaddingEqual(H),be=!1===s.retainPadding?g.clone():g,ye=Re=>Xe=>{if(me&&(Re.zoom=f.af(b,F,Xe)),pe&&(Re.bearing=f.af(x,N,Xe)),xe&&(Re.pitch=f.af(M,z,Xe)),ve&&(be.interpolatePadding(A,H,Xe),G=be.centerPoint.add(j)),ne)Re.setLocationAtPoint(ne,le);else{const qe=Re.zoomScale(Re.zoom-b),Ae=F>b?Math.min(2,te):Math.max(.5,te),Be=Math.pow(Ae,1-Xe),Ye=Re.unproject(J.add(Q.mult(Xe*Be)).mult(qe));Re.setLocationAtPoint(Re.renderWorldCopies?Ye.wrap():Ye,G)}return s.preloadOnly||this._fireMoveEvents(c),Re};if(s.preloadOnly){const Re=this._emulate(ye,s.duration,g);return this._preloadTiles(Re),this}const Ee={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=me,this._rotating=pe,this._pitching=xe,this._padding=ve,this._easeId=s.easeId,this._prepareEase(c,s.noMoveStart,Ee),this._ease(ye(g),Re=>{"sea"===g.cameraElevationReference&&g.recenterOnTerrain(),this._afterEase(c,Re)},s),this}_prepareEase(s,c,g={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&0===this.transform.pitch&&"globe"!==this.transform.projection.name&&(this.transform.cameraElevationReference="ground"),c||g.moving||this.fire(new f.z("movestart",s)),this._zooming&&!g.zooming&&this.fire(new f.z("zoomstart",s)),this._rotating&&!g.rotating&&this.fire(new f.z("rotatestart",s)),this._pitching&&!g.pitching&&this.fire(new f.z("pitchstart",s))}_fireMoveEvents(s){this.fire(new f.z("move",s)),this._zooming&&this.fire(new f.z("zoom",s)),this._rotating&&this.fire(new f.z("rotate",s)),this._pitching&&this.fire(new f.z("pitch",s))}_afterEase(s,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const g=this._zooming,b=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,g&&this.fire(new f.z("zoomend",s)),b&&this.fire(new f.z("rotateend",s)),x&&this.fire(new f.z("pitchend",s)),this.fire(new f.z("moveend",s))}flyTo(s,c){if(this._prefersReducedMotion(s)){const Ke=f.ay(s,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Ke,c)}this.stop(),s=f.l({offset:[0,0],speed:1.2,curve:1.42,easing:f.dA},s);const g=this.transform,b=this.getZoom(),x=this.getBearing(),M=this.getPitch(),A=this.getPadding(),F="zoom"in s?f.aw(+s.zoom,g.minZoom,g.maxZoom):b,N="bearing"in s?this._normalizeBearing(s.bearing,x):x,z="pitch"in s?+s.pitch:M,H=this._extendPadding(s.padding),j=g.zoomScale(F-b),G=f.P.convert(s.offset);let J=g.centerPoint.add(G);const Q=g.pointLocation(J),te=f.bO.convert(s.center||Q);this._normalizeCenter(te);const ne=g.project(Q),le=g.project(te).sub(ne);let me=s.curve;const pe=Math.max(g.width,g.height),xe=pe/j,ve=le.mag();if("minZoom"in s){const Ke=f.aw(Math.min(s.minZoom,b,F),g.minZoom,g.maxZoom),bt=pe/g.zoomScale(Ke-b);me=Math.sqrt(bt/ve*2)}const be=me*me;function ye(Ke){const bt=(xe*xe-pe*pe+(Ke?-1:1)*be*be*ve*ve)/(2*(Ke?xe:pe)*be*ve);return Math.log(Math.sqrt(bt*bt+1)-bt)}function Ee(Ke){return(Math.exp(Ke)-Math.exp(-Ke))/2}function Re(Ke){return(Math.exp(Ke)+Math.exp(-Ke))/2}const Xe=ye(0);let qe=function(Ke){return Re(Xe)/Re(Xe+me*Ke)},Ae=function(Ke){return pe*((Re(Xe)*(Ee(bt=Xe+me*Ke)/Re(bt))-Ee(Xe))/be)/ve;var bt},Be=(ye(1)-Xe)/me;if(Math.abs(ve)<1e-6||!isFinite(Be)){if(Math.abs(pe-xe)<1e-6)return this.easeTo(s,c);const Ke=xe<pe?-1:1;Be=Math.abs(Math.log(xe/pe))/me,Ae=function(){return 0},qe=function(bt){return Math.exp(Ke*me*bt)}}s.duration="duration"in s?+s.duration:1e3*Be/("screenSpeed"in s?+s.screenSpeed/me:+s.speed),s.maxDuration&&s.duration>s.maxDuration&&(s.duration=0);const Ye=x!==N,pt=z!==M,Ct=!g.isPaddingEqual(H),He=!1===s.retainPadding?g.clone():g,dt=Ke=>bt=>{const ht=bt*Be,st=1/qe(ht);Ke.zoom=1===bt?F:b+Ke.scaleZoom(st),Ye&&(Ke.bearing=f.af(x,N,bt)),pt&&(Ke.pitch=f.af(M,z,bt)),Ct&&(He.interpolatePadding(A,H,bt),J=He.centerPoint.add(G));const Pt=1===bt?te:Ke.unproject(ne.add(le.mult(Ae(ht))).mult(st));return Ke.setLocationAtPoint(Ke.renderWorldCopies?Pt.wrap():Pt,J),Ke._updateCameraOnTerrain(),s.preloadOnly||this._fireMoveEvents(c),Ke};if(s.preloadOnly){const Ke=this._emulate(dt,s.duration,g);return this._preloadTiles(Ke),this}return this._zooming=!0,this._rotating=Ye,this._pitching=pt,this._padding=Ct,this._prepareEase(c,!1),this._ease(dt(g),()=>this._afterEase(c),s),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(s){}_cancelRenderFrame(s){}_stop(s,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const g=this._onEaseEnd;this._onEaseEnd=void 0,g.call(this,c)}if(!s){const g=this.handlers;g&&g.stop(!1)}return this}_ease(s,c,g){!1===g.animate||0===g.duration?(s(1),c()):(this._easeStart=f.q.now(),this._easeOptions=g,this._onEaseFrame=s,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const s=Math.min((f.q.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(s)),s<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(s,c){s=f.bF(s,-180,180);const g=Math.abs(s-c);return Math.abs(s-360-c)<g&&(s-=360),Math.abs(s+360-c)<g&&(s+=360),s}_normalizeCenter(s){const c=this.transform;if(c.maxBounds||"globe"!==c.projection.name&&!c.renderWorldCopies)return;const g=s.lng-c.center.lng;s.lng+=g>180?-360:g<-180?360:0}_prefersReducedMotion(s){return this._respectPrefersReducedMotion&&f.q.prefersReducedMotion&&!(s&&s.essential)}_emulate(s,c,g){const b=Math.ceil(15*c/1e3),x=[],M=s(g.clone());for(let A=0;A<=b;A++){const F=M(A/b);x.push(F.clone())}return x}_preloadTiles(s,c){}}class eh{constructor(s={}){this.options=s,f.aP(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(s){const c=this.options&&this.options.compact,g=s._getUIString("AttributionControl.ToggleAttribution");this._map=s,this._container=Oi("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Oi("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",g);const b=Oi("span","mapboxgl-ctrl-icon",this._compactButton);return b.setAttribute("aria-hidden","true"),b.setAttribute("title",g),this._innerContainer=Oi("div","mapboxgl-ctrl-attrib-inner",this._container),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let s=this._editLink;s||(s=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||f.e.ACCESS_TOKEN}];if(s){const g=c.reduce((b,x,M)=>(x.value&&(b+=`${x.key}=${x.value}${M<c.length-1?"&":""}`),b),"?");s.href=`${f.e.FEEDBACK_URL}/${g}#${vg(this._map,!0)}`,s.rel="noopener nofollow"}}_updateData(s){!s||"metadata"!==s.sourceDataType&&"visibility"!==s.sourceDataType&&"style"!==s.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let s=[];if(this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const c=this._map.style._mergedSourceCaches;for(const b in c){const x=c[b];if(x.used){const M=x.getSource();M.attribution&&s.indexOf(M.attribution)<0&&s.push(M.attribution)}}s.sort((b,x)=>b.length-x.length),s=s.filter((b,x)=>{for(let M=x+1;M<s.length;M++)if(s[M].indexOf(b)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?s=[...this.options.customAttribution,...s]:s.unshift(this.options.customAttribution));const g=s.join(" | ");g!==this._attribHTML&&(this._attribHTML=g,s.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Pb{constructor(){f.aP(["_updateLogo","_updateCompact"],this)}onAdd(s){this._map=s,this._container=Oi("div","mapboxgl-ctrl");const c=Oi("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(s){s&&"metadata"!==s.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const s=this._map.style._sourceCaches;if(0===Object.entries(s).length)return!0;for(const c in s){const g=s[c].getSource();if(g.hasOwnProperty("mapbox_logo")&&!g.mapbox_logo)return!1}return!0}_updateCompact(){const s=this._container.children;if(s.length){const c=s[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class jl{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(s){const c=++this._id;return this._queue.push({callback:s,id:c,cancelled:!1}),c}remove(s){const c=this._currentlyRunning,g=c?this._queue.concat(c):this._queue;for(const b of g)if(b.id===s)return void(b.cancelled=!0)}run(s=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const g of c)if(!g.cancelled&&(g.callback(s),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class _y{constructor(s){this.jumpTo(s)}getValue(s){if(s<=this._startTime)return this._start;if(s>=this._endTime)return this._end;const c=f.cB((s-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(s){return s>=this._startTime&&s<=this._endTime}jumpTo(s){this._startTime=-1/0,this._endTime=-1/0,this._start=s,this._end=s}easeTo(s,c,g){this._start=this.getValue(c),this._end=s,this._startTime=c,this._endTime=c+g}}const Sa={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},sa=["mouseenter","mouseover","mouseleave","mouseout"];class wf extends f.z{constructor(s,c,g,b){const{point:x,lngLat:M,originalEvent:A,target:F}=s;super(s.type,{point:x,lngLat:M,originalEvent:A,target:F}),this.preventDefault=()=>{s.preventDefault()},this.id=c,this.interaction=g,this.feature=b}}class qd{constructor(s){this.map=s,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.delegatedHandlers=new Map,this.handleType=this.handleType.bind(this)}add(s,c){if(this.typeById.has(s))throw new Error(`Interaction id "${s}" already exists.`);const{type:g,filter:b}=c;b&&this.filters.set(s,f.aZ(b));const x=this.interactionsByType.get(g)||new Map;if(0===x.size){if(sa.includes(g)){const{mousemove:M,mouseout:A}=this._createDelegatedHandlers(s,c);this.map.on("mousemove",M),this.map.on("mouseout",A),this.delegatedHandlers.set(s,{mousemove:M,mouseout:A})}else this.map.on(g,this.handleType);this.interactionsByType.set(g,x)}x.set(s,c),this.typeById.set(s,g)}get(s){const c=this.typeById.get(s);if(!c)return;const g=this.interactionsByType.get(c);return g?g.get(s):void 0}remove(s){const c=this.typeById.get(s);if(!c)return;this.typeById.delete(s),this.filters.delete(s);const g=this.interactionsByType.get(c);if(g){if(g.delete(s),this.delegatedHandlers.has(s)){const{mousemove:b,mouseout:x}=this.delegatedHandlers.get(s);this.map.off("mousemove",b),this.map.off("mouseout",x),this.delegatedHandlers.delete(s)}0===g.size&&this.map.off(c,this.handleType)}}queryTargets(s,c){const g=[];for(const[b,x]of c)x.target&&g.push({targetId:b,target:x.target,filter:this.filters.get(b)});return this.map.style.queryRenderedTargets(s,g,this.map.transform)}handleType(s,c){const g=this.interactionsByType.get(s.type),b=Array.from(g).reverse();c=c||this.queryTargets(s.point,b);let x=!1;for(const M of c){for(const[A,F]of b){if(!F.target)continue;const N=M.variants?M.variants[A]:null;if(N){for(const z of N){const H=new f.cw(M,z);if(!1!==F.handler(new wf(s,A,F,H))){x=!0;break}}if(x)break}}if(x)break}if(!x)for(const[M,A]of b){const{handler:F,target:N}=A;if(!N&&!1!==F(new wf(s,M,A,null)))break}}_createDelegatedHandlers(s,c){switch(c.type){case"mouseenter":case"mouseover":{let g=!1,b=new Set;return{mousemove:x=>{const M=this.queryTargets(x.point,[[s,c]]),A=new Set;if(!M.length)return g=!1,void b.clear();const F=[];for(const N of M)b.has(N.id)||(A.add(N.id),F.push(N));g&&!F.length||(g=!0,b=A,x.type=c.type,this.handleType(x,F))},mouseout:()=>{g=!1,b.clear()}}}case"mouseleave":case"mouseout":{let g=[];return{mousemove:b=>{const x=this.queryTargets(b.point,[[s,c]]);if(!x.length)return b.type=c.type,this.handleType(b,g),void(g=x);const M=[],A=new Set(x.map(F=>F.id));for(const F of g)A.has(F.id)||M.push(F);M.length&&(b.type=c.type,this.handleType(b,M)),g=x},mouseout:b=>{g.length&&(b.type=c.type,this.handleType(b,g),g=[])}}}}}}function th(m,s){if(Array.isArray(m)&&Array.isArray(s)){const c=new Set(m),g=new Set(s);return c.size===g.size&&m.every(b=>g.has(b))}return f.bn(m,s)}const yy={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},ii={showCompass:!0,showZoom:!0,visualizePitch:!1};class Wd{constructor(s,c,g=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Tg({clickTolerance:s.dragRotate._mouseRotate._clickTolerance}),this.map=s,g&&(this.mousePitch=new Rp({clickTolerance:s.dragRotate._mousePitch._clickTolerance})),f.aP(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(s,c){this.mouseRotate.mousedown(s,c),this.mousePitch&&this.mousePitch.mousedown(s,c),$i()}move(s,c){const g=this.map,b=this.mouseRotate.mousemoveWindow(s,c),x=b&&b.bearingDelta;if(x&&g.setBearing(g.getBearing()+x),this.mousePitch){const M=this.mousePitch.mousemoveWindow(s,c),A=M&&M.pitchDelta;A&&g.setPitch(g.getPitch()+A)}}off(){const s=this.element;s.removeEventListener("mousedown",this.mousedown),s.removeEventListener("touchstart",this.touchstart,{passive:!1}),s.removeEventListener("touchmove",this.touchmove),s.removeEventListener("touchend",this.touchend),s.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Fh(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(s){this.down(f.l({},s,{ctrlKey:!0,preventDefault:()=>s.preventDefault()}),el(this.element,s)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(s){this.move(s,el(this.element,s))}mouseup(s){this.mouseRotate.mouseupWindow(s),this.mousePitch&&this.mousePitch.mouseupWindow(s),this.offTemp()}touchstart(s){1!==s.targetTouches.length?this.reset():(this._startPos=this._lastPos=tl(this.element,s.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>s.preventDefault()},this._startPos))}touchmove(s){1!==s.targetTouches.length?this.reset():(this._lastPos=tl(this.element,s.targetTouches)[0],this.move({preventDefault:()=>s.preventDefault()},this._lastPos))}touchend(s){0===s.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Up(m,s,c){if(m=new f.bO(m.lng,m.lat),s){const g=new f.bO(m.lng-360,m.lat),b=new f.bO(m.lng+360,m.lat),x=360*Math.ceil(Math.abs(m.lng-c.center.lng)/360),M=c.locationPoint(m).distSqr(s),A=s.x<0||s.y<0||s.x>c.width||s.y>c.height;c.locationPoint(g).distSqr(s)<M&&(A||Math.abs(g.lng-c.center.lng)<x)?m=g:c.locationPoint(b).distSqr(s)<M&&(A||Math.abs(b.lng-c.center.lng)<x)&&(m=b)}for(;Math.abs(m.lng-c.center.lng)>180;){const g=c.locationPoint(m);if(g.x>=0&&g.y>=0&&g.x<=c.width&&g.y<=c.height)break;m.lng>c.center.lng?m.lng-=360:m.lng+=360}return m}const jp={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Cf extends f.E{constructor(s,c){if(super(),(s instanceof HTMLElement||c)&&(s=f.l({element:s},c)),f.aP(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=s&&s.anchor||"center",this._color=s&&s.color||"#3FB1CE",this._scale=s&&s.scale||1,this._draggable=s&&s.draggable||!1,this._clickTolerance=s&&s.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=s&&s.rotation||0,this._rotationAlignment=s&&s.rotationAlignment||"auto",this._pitchAlignment=s&&s.pitchAlignment&&s.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=s&&s.occludedOpacity||.2,s&&s.element)this._element=s.element,this._offset=f.P.convert(s&&s.offset||[0,0]);else{this._defaultMarker=!0,this._element=Oi("div");const x=41,M=27,A=ss("svg",{display:"block",height:x*this._scale+"px",width:M*this._scale+"px",viewBox:`0 0 ${M} ${x}`},this._element),F=ss("radialGradient",{id:"shadowGradient"},ss("defs",{},A));ss("stop",{offset:"10%","stop-opacity":.4},F),ss("stop",{offset:"100%","stop-opacity":.05},F),ss("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},A),ss("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},A),ss("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},A),ss("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},A),this._offset=f.P.convert(s&&s.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const g=this._element.classList;for(const x in jp)g.remove(`mapboxgl-marker-anchor-${x}`);g.add(`mapboxgl-marker-anchor-${this._anchor}`);const b=s&&s.className?s.className.trim().split(/\s+/):[];g.add(...b),this._popup=null}addTo(s){return s===this._map||(this.remove(),this._map=s,s.getCanvasContainer().appendChild(this._element),s.on("move",this._updateMoving),s.on("moveend",this._update),s.on("remove",this._clearFadeTimer),s._addMarker(this),this.setDraggable(this._draggable),this._update(),s.on("click",this._onMapClick)),this}remove(){const s=this._map;return s&&(s.off("click",this._onMapClick),s.off("move",this._updateMoving),s.off("moveend",this._update),s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler),s.off("mouseup",this._onUp),s.off("touchend",this._onUp),s.off("mousemove",this._onMove),s.off("touchmove",this._onMove),s.off("remove",this._clearFadeTimer),s._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(s){return this._lngLat=f.bO.convert(s),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(s){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),s){if(!("offset"in s.options)){const b=Math.sqrt(Math.pow(13.5,2)/2);s.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[b,-1*(24.6+b)],"bottom-right":[-b,-1*(24.6+b)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=s,s._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(s){const c=s.code,g=s.charCode||s.keyCode;"Space"!==c&&"Enter"!==c&&32!==g&&13!==g||this.togglePopup()}_onMapClick(s){const c=s.originalEvent.target,g=this._element;this._popup&&(c===g||g.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const s=this._popup;return s?(s.isOpen()?(s.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(s.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const s=this._map,c=this._pos;if(!s||!c)return!1;const g=s.unproject(c),b=s.getFreeCameraOptions();if(!b.position)return!1;const x=b.position.toLngLat();return x.distanceTo(g)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const s=this._map;if(!s)return;const c=this._pos;if(!c||c.x<0||c.x>s.transform.width||c.y<0||c.y>s.transform.height)return void this._clearFadeTimer();const g=s.unproject(c);let b;s._showingGlobe()&&f.dH(s.transform,this._lngLat)?b=0:(b=1-s._queryFogOpacity(g),s.transform._terrainEnabled()&&s.getTerrain()&&this._behindTerrain()&&(b*=this._occludedOpacity)),this._element.style.opacity=`${b}`,this._element.style.pointerEvents=b>0?"auto":"none",this._popup&&this._popup._setOpacity(b),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const s=this._pos;if(!s||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${s.x}px,${s.y}px)\n            ${jp[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const s=this._pos,c=this._map,g=this.getPitchAlignment();if(!c||!s||"map"!==g)return"";if(!c._showingGlobe()){const F=c.getPitch();return F?`rotateX(${F}deg)`:""}const b=f.c4(f.dI(c.transform,this._lngLat)),x=s.sub(f.dJ(c.transform)),M=Math.abs(x.x)+Math.abs(x.y);if(0===M)return"";const A=b/M;return`rotateX(${-x.y*A}deg) rotateY(${x.x*A}deg)`}_calculateZTransform(){const s=this._pos,c=this._map;if(!c||!s)return"";let g=0;const b=this.getRotationAlignment();if("map"===b)if(c._showingGlobe()){const x=c.project(new f.bO(this._lngLat.lng,this._lngLat.lat+.001)),M=c.project(new f.bO(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);g=f.c4(Math.atan2(M.y,M.x))-90}else g=-c.getBearing();else if("horizon"===b){const x=f.ac(4,6,c.getZoom()),M=f.dJ(c.transform);M.y+=x*c.transform.height;const A=s.sub(M),F=f.c4(Math.atan2(A.y,A.x));g=(F>90?F-270:F+90)*(1-x)}return g+=this._rotation,g?`rotateZ(${g}deg)`:""}_update(s){cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Up(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===s?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(s){return this._offset=f.P.convert(s),this._update(),this}addClassName(s){return this._element.classList.add(s),this}removeClassName(s){return this._element.classList.remove(s),this}toggleClassName(s){return this._element.classList.toggle(s)}_onMove(s){const c=this._map;if(!c)return;const g=this._pointerdownPos,b=this._positionDelta;if(g&&b){if(!this._isDragging){const x=this._clickTolerance||c._clickTolerance;if(s.point.dist(g)<x)return;this._isDragging=!0}this._pos=s.point.sub(b),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new f.z("dragstart"))),this.fire(new f.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const s=this._map;s&&(s.off("mousemove",this._onMove),s.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new f.z("dragend")),this._state="inactive"}_addDragHandler(s){const c=this._map,g=this._pos;c&&g&&this._element.contains(s.originalEvent.target)&&(s.preventDefault(),this._positionDelta=s.point.sub(g),this._pointerdownPos=s.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(s){this._draggable=!!s;const c=this._map;return c&&(s?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(s){return this._rotation=s||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(s){return this._rotationAlignment=s||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(s){return this._pitchAlignment=s||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(s){return this._occludedOpacity=s||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Hl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},$l={maxWidth:100,unit:"metric"},Os={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},aa={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Zo=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Eg(m=new f.P(0,0),s="bottom"){if("number"==typeof m){const c=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(s){case"top":return new f.P(0,m);case"top-left":return new f.P(c,c);case"top-right":return new f.P(-c,c);case"bottom":return new f.P(0,-m);case"bottom-left":return new f.P(c,-c);case"bottom-right":return new f.P(-c,-c);case"left":return new f.P(m,0);case"right":return new f.P(-m,0)}return new f.P(0,0)}return m instanceof f.P||Array.isArray(m)?f.P.convert(m):f.P.convert(m[s]||[0,0])}return{version:To,supported:mr.supported,setRTLTextPlugin:f.dK,getRTLTextPluginStatus:f.dL,Map:class extends Vp{constructor(m){xi.mark(Gs.create);const s=m;if(null!=(m=f.l({},yy,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&f.dF(window)&&(m.antialias=!1,f.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new fc(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new jl,this._domRenderTaskQueue=new jl,this._controls=[],this._markers=[],this._popups=[],this._mapId=f.aV(),this._locale=f.l({},Sa,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new _y(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new vu(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?{...m.contextCreateOptions}:{},"string"==typeof m.container){const c=document.getElementById(m.container);if(!c)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=c}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&f.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,f.aP(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new Wu),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Sg(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||f.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this.indoor=new hw(this),m.hash&&(this._hash=new Ip("string"==typeof m.hash&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){null==s.center&&null==s.zoom||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});const c=m.bounds;c&&(this.resize(),this.fitBounds(c,f.l({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new eh({customAttribution:m.customAttribution})),this._logoControl=new Pb,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",c=>{this._update("style"===c.dataType),this.fire(new f.z(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new f.z(`${c.dataType}dataloading`,c))}),this._interactions=new qd(this)}_getMapId(){return this._mapId}addControl(m,s){if(void 0===s&&(s=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new f.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=m.onAdd(this);this._controls.push(m);const g=this._controlPositions[s];return-1!==s.indexOf("bottom")?g.insertBefore(c,g.firstChild):g.appendChild(c),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new f.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const s=this._controls.indexOf(m);return s>-1&&this._controls.splice(s,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const s=!this._moving;return s&&this.fire(new f.z("movestart",m)).fire(new f.z("move",m)),this.fire(new f.z("resize",m)),s&&this.fire(new f.z("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(f.az.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new f.z("zoomstart")).fire(new f.z("zoom")).fire(new f.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new f.z("zoomstart")).fire(new f.z("zoom")).fire(new f.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new f.z("pitchstart")).fire(new f.z("pitch")).fire(new f.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new f.z("pitchstart")).fire(new f.z("pitch")).fire(new f.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(s=>"symbol"===s.type),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return"auto"===m?navigator.language:Array.isArray(m)?0===m.length?void 0:m.map(s=>"auto"===s?navigator.language:s):m}setLanguage(m){const s=this._parseLanguage(m);if(!this.style||s===this._language)return this;this._language=s,this.style.reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(m){return this._lazyInitEmptyStyle(),m?"string"==typeof m&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const m=this.transform,s=m.projection.name;let c;"globe"===s&&m.zoom>=f.bY?(m.setMercatorFromTransition(),c=!0):"mercator"===s&&m.zoom<f.bY&&(m.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,s){return this._updateProjection(m||s||{name:"mercator"})}_updateProjection(m){let s;return s="globe"===m.name&&this.transform.zoom>=f.bY?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),s&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m){return this.transform.locationPoint3D(f.bO.convert(m))}unproject(m){return this.transform.pointLocation3D(f.P.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,s,c){const g=b=>{let x=[];if(Array.isArray(s)){const M=s.filter(A=>this.getLayer(A));x=M.length?this.queryRenderedFeatures(b,{layers:M}):[]}else x=this.queryRenderedFeatures(b,{target:s});return x};if("mouseenter"===m||"mouseover"===m){let b=!1;return{listener:c,targets:s,delegates:{mousemove:M=>{const A=g(M.point);A.length?b||(b=!0,c.call(this,new oa(m,this,M.originalEvent,{features:A}))):b=!1},mouseout:()=>{b=!1}}}}if("mouseleave"===m||"mouseout"===m){let b=!1;return{listener:c,targets:s,delegates:{mousemove:A=>{g(A.point).length?b=!0:b&&(b=!1,c.call(this,new oa(m,this,A.originalEvent)))},mouseout:A=>{b&&(b=!1,c.call(this,new oa(m,this,A.originalEvent)))}}}}{const b=x=>{const M=g(x.point);M.length&&(x.features=M,c.call(this,x),delete x.features)};return{listener:c,targets:s,delegates:{[m]:b}}}}on(m,s,c){if("function"==typeof s||void 0===c)return super.on(m,s);if("string"==typeof s&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(m,s,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(g);for(const b in g.delegates)this.on(b,g.delegates[b]);return this}once(m,s,c){if("function"==typeof s||void 0===c)return super.once(m,s);if("string"==typeof s&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._createDelegatedListener(m,s,c);for(const b in g.delegates)this.once(b,g.delegates[b]);return this}off(m,s,c){if("function"==typeof s||void 0===c)return super.off(m,s);if("string"==typeof s&&(s=[s]),!this._areTargetsValid(s))return this;const g=this._delegatedListeners?this._delegatedListeners[m]:void 0;return g&&(b=>{for(let x=0;x<b.length;x++){const M=b[x];if(M.listener===c&&th(M.targets,s)){for(const A in M.delegates)this.off(A,M.delegates[A]);return b.splice(x,1),this}}})(g),this}queryRenderedFeatures(m,s){if(!this.style)return[];if(void 0===m||m instanceof f.P||Array.isArray(m)||void 0!==s||(s=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!s){const x=this.style.queryRenderedFeatures(m,void 0,this.transform),M=this.style.queryRenderedFeatureset(m,void 0,this.transform);return x.concat(M)}let c=!0;if(s.target&&(c=this._isTargetValid(s.target),c&&!s.layers))return this.style.queryRenderedFeatureset(m,s,this.transform);let g=!0;if(s.layers&&Array.isArray(s.layers)){for(const x of s.layers)if(!this._isValidId(x)){g=!1;break}if(g&&!s.target)return this.style.queryRenderedFeatures(m,s,this.transform)}let b=[];return g&&(b=b.concat(this.style.queryRenderedFeatures(m,s,this.transform))),c&&(b=b.concat(this.style.queryRenderedFeatureset(m,s,this.transform))),b}querySourceFeatures(m,s){return!m||"string"==typeof m&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,s)}isPointOnSurface(m){const{name:s}=this.transform.projection;return"globe"!==s&&"mercator"!==s&&f.w(`${s} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(f.P.convert(m))}addInteraction(m,s){return this._interactions.add(m,s),this}removeInteraction(m){return this._interactions.remove(m),this}setStyle(m,s){return s=f.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},s),this.style&&m&&!1!==s.diff&&s.localFontFamily===this._localFontFamily&&s.localIdeographFontFamily===this._localIdeographFontFamily&&!s.config?(this.style._diffStyle(m,(c,g)=>{c?(f.w(`Unable to perform style diff: ${String(c.message||c.error||c)}. Rebuilding the style from scratch.`),this._updateStyle(m,s)):g&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=s.localIdeographFontFamily,this._localFontFamily=s.localFontFamily,this._updateStyle(m,s))}_getUIString(m){const s=this._locale[m];if(null==s)throw new Error(`Missing UI string '${m}'`);return s}_updateStyle(m,s){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){const c=f.l({},s);s&&s.config&&(c.initialConfig=s.config,delete c.config),this.style=new Qr(this,c).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Qr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(f.w("There is no style added to the map."),!1)}_isValidId(m){return null==m?(this.fire(new f.y(new Error("IDs can't be empty."))),!1):!f.cr(m)||(this.fire(new f.y(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(const s of m)if(!this._isValidId(s))return!1;return!0}return this._isTargetValid(m)}addSource(m,s){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,s),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,s,c){this._lazyInitEmptyStyle(),this.style.addSourceType(m,s,c)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,s,{pixelRatio:c=1,sdf:g=!1,stretchX:b,stretchY:x,content:M}={}){if(this._lazyInitEmptyStyle(),s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap){const{width:A,height:F,data:N}=f.q.getImageData(s);this.style.addImage(m,{data:new f.r({width:A,height:F},N),pixelRatio:c,stretchX:b,stretchY:x,content:M,sdf:g,version:0,usvg:!1})}else if(void 0===s.width||void 0===s.height)this.fire(new f.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:A,height:F}=s,N=s;this.style.addImage(m,{data:new f.r({width:A,height:F},new Uint8Array(N.data)),pixelRatio:c,stretchX:b,stretchY:x,content:M,sdf:g,usvg:!1,version:0,userImage:N}),N.onAdd&&N.onAdd(this,m)}}updateImage(m,s){this._lazyInitEmptyStyle();const c=this.style.getImage(m);if(!c)return void this.fire(new f.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const g=s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap?f.q.getImageData(s):s,{width:b,height:x,data:M}=g;if(void 0===b||void 0===x)return void this.fire(new f.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(b!==(c.usvg?c.icon.usvg_tree.width:c.data.width)||x!==(c.usvg?c.icon.usvg_tree.height:c.data.height))return void this.fire(new f.y(new Error(`The width and height of the updated image (${b}, ${x})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`)));const A=!(s instanceof HTMLImageElement||ImageBitmap&&s instanceof ImageBitmap);let F=!1;c.usvg?(c.data=new f.r({width:b,height:x},new Uint8Array(M)),c.usvg=!1,c.icon=void 0,F=!0):c.data.replace(M,A),this.style.updateImage(m,c,F)}hasImage(m){return m?!!this.style&&!!this.style.getImage(m):(this.fire(new f.y(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,s){f.o(this._requestManager.transformRequest(m,f.R.Image),(c,g)=>{s(c,g instanceof HTMLImageElement?f.q.getImageData(g):g)})}listImages(){return this.style.listImages()}addModel(m,s){this._lazyInitEmptyStyle(),this.style.addModel(m,s)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new f.y(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,s){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,s),this._update(!0)):this}getSlot(m){const s=this.getLayer(m);return s&&s.slot||null}setSlot(m,s){return this.style.setSlot(m,s),this.style.mergeLayers(),this._update(!0)}addImport(m,s){return this.style.addImport(m,s),this}updateImport(m,s){return"string"!=typeof s&&s.id!==m?(this.removeImport(m),this.addImport(s)):(this.style.updateImport(m,s),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,s){return this.style.moveImport(m,s),this._update(!0)}moveLayer(m,s){return this._isValidId(m)?(this.style.moveLayer(m,s),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;const s=this.style.getOwnLayer(m);return s?"custom"===s.type?s.implementation:s.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,s,c){return this._isValidId(m)?(this.style.setLayerZoomRange(m,s,c),this._update(!0)):this}setFilter(m,s,c={}){return this._isValidId(m)?(this.style.setFilter(m,s,c),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,s,c,g={}){return this._isValidId(m)?(this.style.setPaintProperty(m,s,c,g),this._update(!0)):this}getPaintProperty(m,s){return this._isValidId(m)?this.style.getPaintProperty(m,s):null}setLayoutProperty(m,s,c,g={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,s,c,g),this._update(!0)):this}getLayoutProperty(m,s){return this._isValidId(m)?this.style.getLayoutProperty(m,s):null}getSchema(m){return this.style.getSchema(m)}setSchema(m,s){return this.style.setSchema(m,s),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,s){return this.style.setConfig(m,s),this._update(!0)}getConfigProperty(m,s){return this.style.getConfigProperty(m,s)}setConfigProperty(m,s,c){return this.style.setConfigProperty(m,s,c),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&1===m.length&&"flat"===m[0].type){const s=m[0];s.properties?this.style.setFlatLight(s.properties,s.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const m=this.style.getLights()||[];return 0===m.length&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,s={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,s){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,s),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch("orthographic"===m["camera-projection"]))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(f.bO.convert(m),this.transform):0}setFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,s),this._update())}removeFeatureState(m,s){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,s),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,s=this._container.getBoundingClientRect().height||300;let c,g,b,x=this._container;for(;x&&(!g||!b);){const M=window.getComputedStyle(x).transform;M&&"none"!==M&&(c=M.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(g=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(b=c[3])),x=x.parentElement}this._containerWidth=g?Math.abs(m/g):m,this._containerHeight=b?Math.abs(s/b):s}_detectMissingCSS(){"rgb(250, 128, 114)"!==window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&f.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=Oi("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const s=this._canvasContainer=Oi("div","mapboxgl-canvas-container",m);this._canvas=Oi("canvas","mapboxgl-canvas",s),this._interactive&&(s.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=Oi("div","mapboxgl-control-container",m),g=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(b=>{g[b]=Oi("div",`mapboxgl-ctrl-${b}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,s){const c=f.q.devicePixelRatio||1;this._canvas.width=c*Math.ceil(m),this._canvas.height=c*Math.ceil(s),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${s}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const s=this._markers.indexOf(m);-1!==s&&this._markers.splice(s,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const s=this._popups.indexOf(m);-1!==s&&this._popups.splice(s,1)}_setupPainter(){const m=f.l({},mr.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),s=this._canvas.getContext("webgl2",m);s?(bu(s,!0),this.painter=new Vl(s,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",c=>{"source"===c.dataType&&this.painter.setTileLoadedFlag(!0)}),f.m.testSupport(s)):this.fire(new f.y(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.z("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new f.z("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let s;this.fire(new f.z("renderstart")),++this._frameId;const c=this.painter.context.extTimerQuery,g=f.q.now(),b=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(s=b.createQuery(),b.beginQuery(c.TIME_ELAPSED_EXT,s)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const N=this.transform.zoom,z=this.transform.pitch,H=f.q.now(),j=new f.a8(N,{now:H,fadeDuration:x,pitch:z,transition:this.style.transition});this.style.update(j)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let M=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),M=this._updateAverageElevation(g),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):M=this._updateAverageElevation(g);const A=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),A&&(this._placementDirty=A.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new f.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,xi.mark(Gs.load),this.fire(new f.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),s){const N=f.q.now()-g;b.endQuery(c.TIME_ELAPSED_EXT),setTimeout(()=>{const z=b.getQueryParameter(s,b.QUERY_RESULT)/1e6;b.deleteQuery(s),this.fire(new f.z("gpu-timing-frame",{cpuTime:N,gpuTime:z}))},50)}if(this.listens("gpu-timing-layer")){const N=this.painter.collectGpuTimers();setTimeout(()=>{const z=this.painter.queryGpuTimers(N);this.fire(new f.z("gpu-timing-layer",{layerTimes:z}))},50)}if(this.listens("gpu-timing-deferred-render")){const N=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const z=this.painter.queryGpuTimeDeferredRender(N);this.fire(new f.z("gpu-timing-deferred-render",{gpuTime:z}))},50)}const F=this._sourcesDirty||this._styleDirty||this._placementDirty||M;if(F||this._repaint)this.triggerRepaint();else{const N=this.idle();if(N&&(M=this._updateAverageElevation(g,!0)),M)this.triggerRepaint();else if(this._triggerFrame(!1),N&&(this.fire(new f.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const z=this._calculateSpeedIndex();this.fire(new f.z("speedindexcompleted",{speedIndex:z})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,xi.mark(Gs.fullLoad),this._performanceMetricsCollection&&Ym(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const s of this._markers)m&&!this.getRenderWorldCopies()&&(s._lngLat=s._lngLat.wrap()),s._update();for(const s of this._popups)!m||this.getRenderWorldCopies()||s._trackPointer||(s._lngLat=s._lngLat.wrap()),s._update()}_updateAverageElevation(m,s=!1){const c=b=>(this.transform.averageElevation=b,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);const g=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(g||(s||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const b=this.transform.averageElevation;let x=this.transform.sampleAverageElevation();null!=this.transform.elevation&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=m;const M=Math.abs(b-x);if(M>1){if(this._isInitialLoad||g)return this._averageElevation.jumpTo(x),c(x);this._averageElevation.easeTo(x,m,300)}else if(M>1e-4)return this._averageElevation.jumpTo(x),c(x)}return!!this._averageElevation.isEasing(m)&&c(this._averageElevation.getValue(m))}_authenticate(){Oe(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===nl||401===m.status)){const s=this.painter.context.gl;bu(s,!1),this._logoControl instanceof Pb&&this._logoControl._updateLogo(),s&&s.clear(s.DEPTH_BUFFER_BIT|s.COLOR_BUFFER_BIT|s.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new f.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Nh(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&qs(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),s=this.painter.getCanvasCopiesAndTimestamps();s.timeStamps.push(performance.now());const c=this.painter.context.gl,g=c.createFramebuffer();function b(x){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,x,0);const M=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,M),M}return c.bindFramebuffer(c.FRAMEBUFFER,g),this._canvasPixelComparison(b(m),s.canvasCopies.map(b),s.timeStamps)}_canvasPixelComparison(m,s,c){let g=c[1]-c[0];const b=m.length/4;for(let x=0;x<s.length;x++){const M=s[x];let A=0;for(let F=0;F<M.length;F+=4)M[F]===m[F]&&M[F+1]===m[F+1]&&M[F+2]===m[F+2]&&M[F+3]===m[F+3]&&(A+=1);g+=(c[x+2]-c[x+1])*(1-A/b)}return g}remove(){this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Nc.delete(this.painter.context.gl),Bh.remove(),Fn.remove(),this._removed=!0,this.fire(new f.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=f.q.frame(s=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(s)}))}_preloadTiles(m){const s=this.style?this.style.getSourceCaches():[];return f.bl(s,(c,g)=>c._preloadTiles(m,g),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){"hidden"===document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,s){f.dG(m,s)}get version(){return To}},NavigationControl:class{constructor(m={}){this.options=f.l({},ii,m),this._container=Oi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",s=>s.preventDefault()),this.options.showZoom&&(f.aP(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",s=>{this._map&&this._map.zoomIn({},{originalEvent:s})}),Oi("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",s=>{this._map&&this._map.zoomOut({},{originalEvent:s})}),Oi("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(f.aP(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",s=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:s}):c.resetNorth({},{originalEvent:s}))}),this._compassIcon=Oi("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const s=m.getZoom(),c=s===m.getMaxZoom(),g=s===m.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=g,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",g.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const s=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=s)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Wd(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,s){const c=Oi("button",m,this._container);return c.type="button",c.addEventListener("click",s),c}_setButtonTitle(m,s){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${s}`);m.setAttribute("aria-label",c),m.firstElementChild&&m.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends f.E{constructor(m={}){super();const s=navigator.geolocation;this.options=f.l({geolocation:s},Hl,m),f.aP(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=yg(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=Oi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const s=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,m(c)};void 0!==this._supportsGeolocation?m(this._supportsGeolocation):void 0!==navigator.permissions?navigator.permissions.query({name:"geolocation"}).then(c=>s("denied"!==c.state)).catch(()=>s()):s()}_isOutOfMapMaxBounds(m){const s=this._map.getMaxBounds(),c=m.coords;return!!s&&(c.longitude<s.getWest()||c.longitude>s.getEast()||c.latitude<s.getSouth()||c.latitude>s.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new f.z("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new f.z("geolocate",m)),this._finish()}}_updateCamera(m){const s=new f.bO(m.coords.longitude,m.coords.latitude),c=m.coords.accuracy,g=this._map.getBearing(),b=f.l({bearing:g},this.options.fitBoundsOptions);this._map.fitBounds(s.toBounds(c),b,{geolocateSource:!0})}_updateMarker(m){if(m){const s=new f.bO(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(s).addTo(this._map),this._userLocationDotMarker.setLngLat(s).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,s=f.bH(1,m._center.lat)*m.worldSize,c=Math.ceil(2*this._accuracy*s);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new f.z("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",s=>s.preventDefault()),this._geolocateButton=Oi("button","mapboxgl-ctrl-geolocate",this._container),Oi("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===m){f.w("Geolocation support is not available so the GeolocateControl will be disabled.");const s=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}else{const s=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",s),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",s)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Oi("div","mapboxgl-user-location"),this._dotElement.appendChild(Oi("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Oi("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Cf({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Oi("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Cf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",s=>{s.geolocateSource||"ACTIVE_LOCK"!==this._watchState||s.originalEvent&&"resize"===s.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new f.z("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:!0===m.absolute&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return f.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new f.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(s=>{"granted"===s&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:eh,ScaleControl:class{constructor(m={}){this.options=f.l({},$l,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),f.aP(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,s=this._map,c=s._containerHeight/2,g=s._containerWidth/2-m/2,b=s.unproject([g,c]),x=s.unproject([g+m,c]),M=b.distanceTo(x);if("imperial"===this.options.unit){const A=3.2808*M;A>5280?this._setScale(m,A/5280,"mile"):this._setScale(m,A,"foot")}else"nautical"===this.options.unit?this._setScale(m,M/1852,"nautical-mile"):M>=1e3?this._setScale(m,M/1e3,"kilometer"):this._setScale(m,M,"meter")}_setScale(m,s,c){this._map._requestDomTask(()=>{const g=function(x){const M=Math.pow(10,`${Math.floor(x)}`.length-1);let A=x/M;return A=A>=10?10:A>=5?5:A>=3?3:A>=2?2:A>=1?1:function(F){const N=Math.pow(10,Math.ceil(-Math.log(F)/Math.LN10));return Math.round(F*N)/N}(A),M*A}(s),b=g/s;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(g):`${g}&nbsp;${Os[c]}`,this._container.style.width=m*b+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=Oi("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:f.w("Full screen control 'container' must be a DOM element.")),f.aP(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=Oi("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",f.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=Oi("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Oi("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends f.E{constructor(m){super(),this.options=f.l(Object.create(aa),m),f.aP(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new f.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new f.z("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=f.bO.convert(m),this._pos=null,this._trackPointer=!1,this._update();const s=this._map;return s&&(s.on("move",this._update),s.off("mousemove",this._onMouseEvent),s._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const s=document.createDocumentFragment(),c=document.createElement("body");let g;for(c.innerHTML=m;g=c.firstChild,g;)s.appendChild(g);return this.setDOMContent(s)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let s=this._content;if(s)for(;s.hasChildNodes();)s.firstChild&&s.removeChild(s.firstChild);else s=this._content=Oi("div","mapboxgl-popup-content",this._container||void 0);if(s.appendChild(m),this.options.closeButton){const c=this._closeButton=Oi("button","mapboxgl-popup-close-button",s);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let s;return this._classList.delete(m)?s=!1:(this._classList.add(m),s=!0),this._updateClassList(),s}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const s=this._map,c=this._container,g=this._pos;if(!s||!c||!g)return"bottom";const b=c.offsetWidth,x=c.offsetHeight,M=g.x<b/2,A=g.x>s.transform.width-b/2;if(g.y+m<x)return M?"top-left":A?"top-right":"top";if(g.y>s.transform.height-x){if(M)return"bottom-left";if(A)return"bottom-right"}return M?"left":A?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const s=[...this._classList];s.push("mapboxgl-popup"),this._anchor&&s.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&s.push("mapboxgl-popup-track-pointer"),m.className=s.join(" ")}_update(m){const s=this._map,c=this._content;if(!s||!this._lngLat&&!this._trackPointer||!c)return;let g=this._container;if(g||(g=this._container=Oi("div","mapboxgl-popup",s.getContainer()),this._tip=Oi("div","mapboxgl-popup-tip",g),g.appendChild(c)),this.options.maxWidth&&g.style.maxWidth!==this.options.maxWidth&&(g.style.maxWidth=this.options.maxWidth),s.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Up(this._lngLat,this._pos,s.transform)),!this._trackPointer||m){const b=this._pos=this._trackPointer&&m instanceof f.P?m:s.project(this._lngLat),x=Eg(this.options.offset),M=this._anchor=this._getAnchor(x.y),A=Eg(this.options.offset,M),F=b.add(A).round();s._requestDomTask(()=>{this._container&&M&&(this._container.style.transform=`${jp[M]} translate(${F.x}px,${F.y}px)`)})}if(!this._marker&&s._showingGlobe()){const b=f.dH(s.transform,this._lngLat)?0:1;this._setOpacity(b)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(Zo);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Cf,Style:Qr,LngLat:f.bO,LngLatBounds:f.az,Point:f.P,MercatorCoordinate:f.aa,FreeCameraOptions:Jh,Evented:f.E,config:f.e,prewarm:f.dM,clearPrewarmedResources:f.dN,get accessToken(){return f.e.ACCESS_TOKEN},set accessToken(m){f.e.ACCESS_TOKEN=m},get baseApiUrl(){return f.e.API_URL},set baseApiUrl(m){f.e.API_URL=m},get workerCount(){return f.dO.workerCount},set workerCount(m){f.dO.workerCount=m},get maxParallelImageRequests(){return f.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){f.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){f.dP(m)},get workerUrl(){return f.dQ.workerUrl},set workerUrl(m){f.dQ.workerUrl=m},get workerClass(){return f.dQ.workerClass},set workerClass(m){f.dQ.workerClass=m},get workerParams(){return f.dQ.workerParams},set workerParams(m){f.dQ.workerParams=m},get dracoUrl(){return f.dR()},set dracoUrl(m){f.dS(m)},get meshoptUrl(){return f.dT()},set meshoptUrl(m){f.dU(m)},setNow:f.q.setNow,restoreNow:f.q.restoreNow}}),Zm}()}},lw=>{lw(lw.s=340)}]);